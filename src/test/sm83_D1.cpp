// File autogenerated by ./scripts/generate_tests_sm83.py
#include <test/include/acutest.h>

#include <cpu/include/instruction_ld.hpp>
#include <cpu/include/registers.hpp>
#include <memory/include/memory.hpp>

using namespace pgb::common;
using namespace pgb::memory;
using namespace pgb::cpu;

static auto registers = RegisterFile();
static auto mmap      = MemoryMap(registers, MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);


#define WriteRegisterWord(register, value) do { auto result = mmap.WriteWord(register, value); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); } while(0)
#define WriteRegisterByte(register, value) do { auto result = mmap.WriteByte(register, value); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); } while(0)
#define WriteRegisterFlag(value) do { TEST_ASSERT(static_cast<const Byte>(mmap.WriteFlagByte(static_cast<const Byte&>(value))) == 0x00); } while(0)
#define WriteMemory(address, value) do { auto result = mmap.WriteByte(address, value); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); } while(0)

#define CheckRegisterWord(register, value) do { auto result = mmap.ReadWord(register); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); TEST_ASSERT(static_cast<const Word&>(result) == value); } while(0)
#define CheckRegisterByte(register, value) do { auto result = mmap.ReadByte(register); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); TEST_ASSERT(static_cast<const Byte&>(result) == value); } while(0)
#define CheckRegisterFlag(value) do { TEST_ASSERT_(static_cast<const Byte>(mmap.ReadFlagByte()) == value, "%hhx != %hhx", static_cast<const Byte>(mmap.ReadFlagByte()).data, value); } while(0)
#define CheckMemory(address, value) do { auto result = mmap.ReadByte(address); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); TEST_ASSERT_(static_cast<const Byte&>(result) == value, "%hhu != %hhu", static_cast<const Byte&>(result).data, value); } while(0)

static_assert(instruction::InstructionRegistryNoPrefix::Callbacks[0xD1] != nullptr);
static_assert(instruction::InstructionRegistryNoPrefix::Ticks[0xD1] != 0);

const bool skip_test_D1_0000 = false;
const bool skip_test_D1_0001 = false;
const bool skip_test_D1_0002 = false;
const bool skip_test_D1_0003 = false;
const bool skip_test_D1_0004 = false;
const bool skip_test_D1_0005 = false;
const bool skip_test_D1_0006 = false;
const bool skip_test_D1_0007 = false;
const bool skip_test_D1_0008 = false;
const bool skip_test_D1_0009 = false;
const bool skip_test_D1_000A = false;
const bool skip_test_D1_000B = false;
const bool skip_test_D1_000C = false;
const bool skip_test_D1_000D = false;
const bool skip_test_D1_000E = false;
const bool skip_test_D1_000F = false;
const bool skip_test_D1_0010 = false;
const bool skip_test_D1_0011 = false;
const bool skip_test_D1_0012 = false;
const bool skip_test_D1_0013 = false;
const bool skip_test_D1_0014 = false;
const bool skip_test_D1_0015 = false;
const bool skip_test_D1_0016 = false;
const bool skip_test_D1_0017 = false;
const bool skip_test_D1_0018 = false;
const bool skip_test_D1_0019 = false;
const bool skip_test_D1_001A = false;
const bool skip_test_D1_001B = false;
const bool skip_test_D1_001C = false;
const bool skip_test_D1_001D = false;
const bool skip_test_D1_001E = false;
const bool skip_test_D1_001F = false;
const bool skip_test_D1_0020 = false;
const bool skip_test_D1_0021 = false;
const bool skip_test_D1_0022 = false;
const bool skip_test_D1_0023 = false;
const bool skip_test_D1_0024 = false;
const bool skip_test_D1_0025 = false;
const bool skip_test_D1_0026 = false;
const bool skip_test_D1_0027 = false;
const bool skip_test_D1_0028 = false;
const bool skip_test_D1_0029 = false;
const bool skip_test_D1_002A = false;
const bool skip_test_D1_002B = false;
const bool skip_test_D1_002C = false;
const bool skip_test_D1_002D = false;
const bool skip_test_D1_002E = false;
const bool skip_test_D1_002F = false;
const bool skip_test_D1_0030 = false;
const bool skip_test_D1_0031 = false;
const bool skip_test_D1_0032 = false;
const bool skip_test_D1_0033 = false;
const bool skip_test_D1_0034 = false;
const bool skip_test_D1_0035 = true;
const bool skip_test_D1_0036 = false;
const bool skip_test_D1_0037 = false;
const bool skip_test_D1_0038 = false;
const bool skip_test_D1_0039 = false;
const bool skip_test_D1_003A = false;
const bool skip_test_D1_003B = false;
const bool skip_test_D1_003C = false;
const bool skip_test_D1_003D = false;
const bool skip_test_D1_003E = false;
const bool skip_test_D1_003F = false;
const bool skip_test_D1_0040 = false;
const bool skip_test_D1_0041 = false;
const bool skip_test_D1_0042 = false;
const bool skip_test_D1_0043 = false;
const bool skip_test_D1_0044 = false;
const bool skip_test_D1_0045 = false;
const bool skip_test_D1_0046 = false;
const bool skip_test_D1_0047 = false;
const bool skip_test_D1_0048 = false;
const bool skip_test_D1_0049 = false;
const bool skip_test_D1_004A = false;
const bool skip_test_D1_004B = false;
const bool skip_test_D1_004C = false;
const bool skip_test_D1_004D = false;
const bool skip_test_D1_004E = false;
const bool skip_test_D1_004F = false;
const bool skip_test_D1_0050 = false;
const bool skip_test_D1_0051 = false;
const bool skip_test_D1_0052 = false;
const bool skip_test_D1_0053 = false;
const bool skip_test_D1_0054 = false;
const bool skip_test_D1_0055 = false;
const bool skip_test_D1_0056 = false;
const bool skip_test_D1_0057 = false;
const bool skip_test_D1_0058 = false;
const bool skip_test_D1_0059 = false;
const bool skip_test_D1_005A = false;
const bool skip_test_D1_005B = false;
const bool skip_test_D1_005C = false;
const bool skip_test_D1_005D = false;
const bool skip_test_D1_005E = false;
const bool skip_test_D1_005F = false;
const bool skip_test_D1_0060 = false;
const bool skip_test_D1_0061 = false;
const bool skip_test_D1_0062 = false;
const bool skip_test_D1_0063 = false;
const bool skip_test_D1_0064 = false;
const bool skip_test_D1_0065 = false;
const bool skip_test_D1_0066 = false;
const bool skip_test_D1_0067 = false;
const bool skip_test_D1_0068 = false;
const bool skip_test_D1_0069 = false;
const bool skip_test_D1_006A = false;
const bool skip_test_D1_006B = false;
const bool skip_test_D1_006C = false;
const bool skip_test_D1_006D = false;
const bool skip_test_D1_006E = false;
const bool skip_test_D1_006F = false;
const bool skip_test_D1_0070 = false;
const bool skip_test_D1_0071 = false;
const bool skip_test_D1_0072 = false;
const bool skip_test_D1_0073 = false;
const bool skip_test_D1_0074 = false;
const bool skip_test_D1_0075 = false;
const bool skip_test_D1_0076 = false;
const bool skip_test_D1_0077 = false;
const bool skip_test_D1_0078 = false;
const bool skip_test_D1_0079 = false;
const bool skip_test_D1_007A = false;
const bool skip_test_D1_007B = false;
const bool skip_test_D1_007C = false;
const bool skip_test_D1_007D = false;
const bool skip_test_D1_007E = false;
const bool skip_test_D1_007F = false;
const bool skip_test_D1_0080 = false;
const bool skip_test_D1_0081 = false;
const bool skip_test_D1_0082 = false;
const bool skip_test_D1_0083 = false;
const bool skip_test_D1_0084 = false;
const bool skip_test_D1_0085 = false;
const bool skip_test_D1_0086 = false;
const bool skip_test_D1_0087 = false;
const bool skip_test_D1_0088 = false;
const bool skip_test_D1_0089 = false;
const bool skip_test_D1_008A = false;
const bool skip_test_D1_008B = false;
const bool skip_test_D1_008C = false;
const bool skip_test_D1_008D = false;
const bool skip_test_D1_008E = false;
const bool skip_test_D1_008F = false;
const bool skip_test_D1_0090 = false;
const bool skip_test_D1_0091 = false;
const bool skip_test_D1_0092 = false;
const bool skip_test_D1_0093 = true;
const bool skip_test_D1_0094 = false;
const bool skip_test_D1_0095 = false;
const bool skip_test_D1_0096 = false;
const bool skip_test_D1_0097 = false;
const bool skip_test_D1_0098 = false;
const bool skip_test_D1_0099 = false;
const bool skip_test_D1_009A = false;
const bool skip_test_D1_009B = false;
const bool skip_test_D1_009C = false;
const bool skip_test_D1_009D = false;
const bool skip_test_D1_009E = false;
const bool skip_test_D1_009F = false;
const bool skip_test_D1_00A0 = false;
const bool skip_test_D1_00A1 = false;
const bool skip_test_D1_00A2 = false;
const bool skip_test_D1_00A3 = false;
const bool skip_test_D1_00A4 = false;
const bool skip_test_D1_00A5 = false;
const bool skip_test_D1_00A6 = false;
const bool skip_test_D1_00A7 = false;
const bool skip_test_D1_00A8 = false;
const bool skip_test_D1_00A9 = false;
const bool skip_test_D1_00AA = false;
const bool skip_test_D1_00AB = false;
const bool skip_test_D1_00AC = false;
const bool skip_test_D1_00AD = false;
const bool skip_test_D1_00AE = false;
const bool skip_test_D1_00AF = false;
const bool skip_test_D1_00B0 = false;
const bool skip_test_D1_00B1 = false;
const bool skip_test_D1_00B2 = false;
const bool skip_test_D1_00B3 = false;
const bool skip_test_D1_00B4 = false;
const bool skip_test_D1_00B5 = false;
const bool skip_test_D1_00B6 = false;
const bool skip_test_D1_00B7 = false;
const bool skip_test_D1_00B8 = false;
const bool skip_test_D1_00B9 = false;
const bool skip_test_D1_00BA = false;
const bool skip_test_D1_00BB = false;
const bool skip_test_D1_00BC = false;
const bool skip_test_D1_00BD = false;
const bool skip_test_D1_00BE = false;
const bool skip_test_D1_00BF = false;
const bool skip_test_D1_00C0 = false;
const bool skip_test_D1_00C1 = false;
const bool skip_test_D1_00C2 = false;
const bool skip_test_D1_00C3 = false;
const bool skip_test_D1_00C4 = false;
const bool skip_test_D1_00C5 = false;
const bool skip_test_D1_00C6 = false;
const bool skip_test_D1_00C7 = false;
const bool skip_test_D1_00C8 = false;
const bool skip_test_D1_00C9 = false;
const bool skip_test_D1_00CA = false;
const bool skip_test_D1_00CB = false;
const bool skip_test_D1_00CC = false;
const bool skip_test_D1_00CD = false;
const bool skip_test_D1_00CE = false;
const bool skip_test_D1_00CF = false;
const bool skip_test_D1_00D0 = false;
const bool skip_test_D1_00D1 = false;
const bool skip_test_D1_00D2 = false;
const bool skip_test_D1_00D3 = false;
const bool skip_test_D1_00D4 = false;
const bool skip_test_D1_00D5 = false;
const bool skip_test_D1_00D6 = false;
const bool skip_test_D1_00D7 = false;
const bool skip_test_D1_00D8 = false;
const bool skip_test_D1_00D9 = false;
const bool skip_test_D1_00DA = false;
const bool skip_test_D1_00DB = false;
const bool skip_test_D1_00DC = false;
const bool skip_test_D1_00DD = false;
const bool skip_test_D1_00DE = false;
const bool skip_test_D1_00DF = false;
const bool skip_test_D1_00E0 = false;
const bool skip_test_D1_00E1 = false;
const bool skip_test_D1_00E2 = false;
const bool skip_test_D1_00E3 = false;
const bool skip_test_D1_00E4 = false;
const bool skip_test_D1_00E5 = false;
const bool skip_test_D1_00E6 = false;
const bool skip_test_D1_00E7 = false;
const bool skip_test_D1_00E8 = false;
const bool skip_test_D1_00E9 = false;
const bool skip_test_D1_00EA = false;
const bool skip_test_D1_00EB = false;
const bool skip_test_D1_00EC = false;
const bool skip_test_D1_00ED = false;
const bool skip_test_D1_00EE = false;
const bool skip_test_D1_00EF = false;
const bool skip_test_D1_00F0 = false;
const bool skip_test_D1_00F1 = false;
const bool skip_test_D1_00F2 = false;
const bool skip_test_D1_00F3 = false;
const bool skip_test_D1_00F4 = false;
const bool skip_test_D1_00F5 = false;
const bool skip_test_D1_00F6 = false;
const bool skip_test_D1_00F7 = false;
const bool skip_test_D1_00F8 = false;
const bool skip_test_D1_00F9 = false;
const bool skip_test_D1_00FA = false;
const bool skip_test_D1_00FB = false;
const bool skip_test_D1_00FC = false;
const bool skip_test_D1_00FD = false;
const bool skip_test_D1_00FE = false;
const bool skip_test_D1_00FF = false;
const bool skip_test_D1_0100 = false;
const bool skip_test_D1_0101 = false;
const bool skip_test_D1_0102 = false;
const bool skip_test_D1_0103 = false;
const bool skip_test_D1_0104 = false;
const bool skip_test_D1_0105 = false;
const bool skip_test_D1_0106 = false;
const bool skip_test_D1_0107 = false;
const bool skip_test_D1_0108 = false;
const bool skip_test_D1_0109 = false;
const bool skip_test_D1_010A = false;
const bool skip_test_D1_010B = false;
const bool skip_test_D1_010C = false;
const bool skip_test_D1_010D = false;
const bool skip_test_D1_010E = false;
const bool skip_test_D1_010F = false;
const bool skip_test_D1_0110 = false;
const bool skip_test_D1_0111 = false;
const bool skip_test_D1_0112 = false;
const bool skip_test_D1_0113 = false;
const bool skip_test_D1_0114 = false;
const bool skip_test_D1_0115 = false;
const bool skip_test_D1_0116 = false;
const bool skip_test_D1_0117 = false;
const bool skip_test_D1_0118 = false;
const bool skip_test_D1_0119 = false;
const bool skip_test_D1_011A = false;
const bool skip_test_D1_011B = false;
const bool skip_test_D1_011C = false;
const bool skip_test_D1_011D = false;
const bool skip_test_D1_011E = false;
const bool skip_test_D1_011F = false;
const bool skip_test_D1_0120 = false;
const bool skip_test_D1_0121 = false;
const bool skip_test_D1_0122 = false;
const bool skip_test_D1_0123 = false;
const bool skip_test_D1_0124 = false;
const bool skip_test_D1_0125 = false;
const bool skip_test_D1_0126 = false;
const bool skip_test_D1_0127 = false;
const bool skip_test_D1_0128 = false;
const bool skip_test_D1_0129 = false;
const bool skip_test_D1_012A = false;
const bool skip_test_D1_012B = false;
const bool skip_test_D1_012C = false;
const bool skip_test_D1_012D = false;
const bool skip_test_D1_012E = false;
const bool skip_test_D1_012F = false;
const bool skip_test_D1_0130 = false;
const bool skip_test_D1_0131 = false;
const bool skip_test_D1_0132 = false;
const bool skip_test_D1_0133 = false;
const bool skip_test_D1_0134 = false;
const bool skip_test_D1_0135 = false;
const bool skip_test_D1_0136 = false;
const bool skip_test_D1_0137 = false;
const bool skip_test_D1_0138 = false;
const bool skip_test_D1_0139 = false;
const bool skip_test_D1_013A = false;
const bool skip_test_D1_013B = false;
const bool skip_test_D1_013C = false;
const bool skip_test_D1_013D = false;
const bool skip_test_D1_013E = false;
const bool skip_test_D1_013F = false;
const bool skip_test_D1_0140 = false;
const bool skip_test_D1_0141 = false;
const bool skip_test_D1_0142 = false;
const bool skip_test_D1_0143 = false;
const bool skip_test_D1_0144 = false;
const bool skip_test_D1_0145 = false;
const bool skip_test_D1_0146 = false;
const bool skip_test_D1_0147 = false;
const bool skip_test_D1_0148 = false;
const bool skip_test_D1_0149 = false;
const bool skip_test_D1_014A = false;
const bool skip_test_D1_014B = false;
const bool skip_test_D1_014C = false;
const bool skip_test_D1_014D = false;
const bool skip_test_D1_014E = false;
const bool skip_test_D1_014F = false;
const bool skip_test_D1_0150 = false;
const bool skip_test_D1_0151 = false;
const bool skip_test_D1_0152 = false;
const bool skip_test_D1_0153 = false;
const bool skip_test_D1_0154 = false;
const bool skip_test_D1_0155 = false;
const bool skip_test_D1_0156 = false;
const bool skip_test_D1_0157 = false;
const bool skip_test_D1_0158 = false;
const bool skip_test_D1_0159 = false;
const bool skip_test_D1_015A = false;
const bool skip_test_D1_015B = false;
const bool skip_test_D1_015C = false;
const bool skip_test_D1_015D = false;
const bool skip_test_D1_015E = false;
const bool skip_test_D1_015F = false;
const bool skip_test_D1_0160 = false;
const bool skip_test_D1_0161 = false;
const bool skip_test_D1_0162 = false;
const bool skip_test_D1_0163 = false;
const bool skip_test_D1_0164 = false;
const bool skip_test_D1_0165 = false;
const bool skip_test_D1_0166 = false;
const bool skip_test_D1_0167 = false;
const bool skip_test_D1_0168 = false;
const bool skip_test_D1_0169 = false;
const bool skip_test_D1_016A = false;
const bool skip_test_D1_016B = false;
const bool skip_test_D1_016C = false;
const bool skip_test_D1_016D = false;
const bool skip_test_D1_016E = false;
const bool skip_test_D1_016F = false;
const bool skip_test_D1_0170 = false;
const bool skip_test_D1_0171 = false;
const bool skip_test_D1_0172 = false;
const bool skip_test_D1_0173 = false;
const bool skip_test_D1_0174 = false;
const bool skip_test_D1_0175 = false;
const bool skip_test_D1_0176 = false;
const bool skip_test_D1_0177 = false;
const bool skip_test_D1_0178 = false;
const bool skip_test_D1_0179 = false;
const bool skip_test_D1_017A = false;
const bool skip_test_D1_017B = false;
const bool skip_test_D1_017C = false;
const bool skip_test_D1_017D = false;
const bool skip_test_D1_017E = false;
const bool skip_test_D1_017F = false;
const bool skip_test_D1_0180 = false;
const bool skip_test_D1_0181 = false;
const bool skip_test_D1_0182 = false;
const bool skip_test_D1_0183 = false;
const bool skip_test_D1_0184 = false;
const bool skip_test_D1_0185 = false;
const bool skip_test_D1_0186 = false;
const bool skip_test_D1_0187 = false;
const bool skip_test_D1_0188 = false;
const bool skip_test_D1_0189 = false;
const bool skip_test_D1_018A = false;
const bool skip_test_D1_018B = false;
const bool skip_test_D1_018C = false;
const bool skip_test_D1_018D = false;
const bool skip_test_D1_018E = false;
const bool skip_test_D1_018F = false;
const bool skip_test_D1_0190 = false;
const bool skip_test_D1_0191 = false;
const bool skip_test_D1_0192 = false;
const bool skip_test_D1_0193 = false;
const bool skip_test_D1_0194 = false;
const bool skip_test_D1_0195 = false;
const bool skip_test_D1_0196 = false;
const bool skip_test_D1_0197 = false;
const bool skip_test_D1_0198 = false;
const bool skip_test_D1_0199 = false;
const bool skip_test_D1_019A = false;
const bool skip_test_D1_019B = false;
const bool skip_test_D1_019C = false;
const bool skip_test_D1_019D = false;
const bool skip_test_D1_019E = false;
const bool skip_test_D1_019F = false;
const bool skip_test_D1_01A0 = false;
const bool skip_test_D1_01A1 = false;
const bool skip_test_D1_01A2 = false;
const bool skip_test_D1_01A3 = false;
const bool skip_test_D1_01A4 = false;
const bool skip_test_D1_01A5 = false;
const bool skip_test_D1_01A6 = false;
const bool skip_test_D1_01A7 = false;
const bool skip_test_D1_01A8 = false;
const bool skip_test_D1_01A9 = false;
const bool skip_test_D1_01AA = false;
const bool skip_test_D1_01AB = false;
const bool skip_test_D1_01AC = false;
const bool skip_test_D1_01AD = false;
const bool skip_test_D1_01AE = false;
const bool skip_test_D1_01AF = false;
const bool skip_test_D1_01B0 = false;
const bool skip_test_D1_01B1 = false;
const bool skip_test_D1_01B2 = false;
const bool skip_test_D1_01B3 = false;
const bool skip_test_D1_01B4 = false;
const bool skip_test_D1_01B5 = false;
const bool skip_test_D1_01B6 = false;
const bool skip_test_D1_01B7 = false;
const bool skip_test_D1_01B8 = false;
const bool skip_test_D1_01B9 = false;
const bool skip_test_D1_01BA = false;
const bool skip_test_D1_01BB = false;
const bool skip_test_D1_01BC = false;
const bool skip_test_D1_01BD = false;
const bool skip_test_D1_01BE = false;
const bool skip_test_D1_01BF = false;
const bool skip_test_D1_01C0 = false;
const bool skip_test_D1_01C1 = false;
const bool skip_test_D1_01C2 = false;
const bool skip_test_D1_01C3 = false;
const bool skip_test_D1_01C4 = false;
const bool skip_test_D1_01C5 = false;
const bool skip_test_D1_01C6 = false;
const bool skip_test_D1_01C7 = false;
const bool skip_test_D1_01C8 = false;
const bool skip_test_D1_01C9 = false;
const bool skip_test_D1_01CA = false;
const bool skip_test_D1_01CB = false;
const bool skip_test_D1_01CC = false;
const bool skip_test_D1_01CD = false;
const bool skip_test_D1_01CE = false;
const bool skip_test_D1_01CF = false;
const bool skip_test_D1_01D0 = false;
const bool skip_test_D1_01D1 = false;
const bool skip_test_D1_01D2 = false;
const bool skip_test_D1_01D3 = false;
const bool skip_test_D1_01D4 = false;
const bool skip_test_D1_01D5 = false;
const bool skip_test_D1_01D6 = false;
const bool skip_test_D1_01D7 = false;
const bool skip_test_D1_01D8 = false;
const bool skip_test_D1_01D9 = false;
const bool skip_test_D1_01DA = false;
const bool skip_test_D1_01DB = false;
const bool skip_test_D1_01DC = false;
const bool skip_test_D1_01DD = false;
const bool skip_test_D1_01DE = false;
const bool skip_test_D1_01DF = false;
const bool skip_test_D1_01E0 = false;
const bool skip_test_D1_01E1 = false;
const bool skip_test_D1_01E2 = false;
const bool skip_test_D1_01E3 = false;
const bool skip_test_D1_01E4 = false;
const bool skip_test_D1_01E5 = false;
const bool skip_test_D1_01E6 = false;
const bool skip_test_D1_01E7 = false;
const bool skip_test_D1_01E8 = false;
const bool skip_test_D1_01E9 = false;
const bool skip_test_D1_01EA = false;
const bool skip_test_D1_01EB = false;
const bool skip_test_D1_01EC = false;
const bool skip_test_D1_01ED = false;
const bool skip_test_D1_01EE = false;
const bool skip_test_D1_01EF = false;
const bool skip_test_D1_01F0 = false;
const bool skip_test_D1_01F1 = false;
const bool skip_test_D1_01F2 = false;
const bool skip_test_D1_01F3 = false;
const bool skip_test_D1_01F4 = false;
const bool skip_test_D1_01F5 = false;
const bool skip_test_D1_01F6 = false;
const bool skip_test_D1_01F7 = false;
const bool skip_test_D1_01F8 = false;
const bool skip_test_D1_01F9 = false;
const bool skip_test_D1_01FA = false;
const bool skip_test_D1_01FB = false;
const bool skip_test_D1_01FC = false;
const bool skip_test_D1_01FD = false;
const bool skip_test_D1_01FE = false;
const bool skip_test_D1_01FF = false;
const bool skip_test_D1_0200 = false;
const bool skip_test_D1_0201 = false;
const bool skip_test_D1_0202 = false;
const bool skip_test_D1_0203 = false;
const bool skip_test_D1_0204 = false;
const bool skip_test_D1_0205 = false;
const bool skip_test_D1_0206 = false;
const bool skip_test_D1_0207 = false;
const bool skip_test_D1_0208 = false;
const bool skip_test_D1_0209 = false;
const bool skip_test_D1_020A = false;
const bool skip_test_D1_020B = false;
const bool skip_test_D1_020C = false;
const bool skip_test_D1_020D = false;
const bool skip_test_D1_020E = false;
const bool skip_test_D1_020F = false;
const bool skip_test_D1_0210 = false;
const bool skip_test_D1_0211 = false;
const bool skip_test_D1_0212 = false;
const bool skip_test_D1_0213 = false;
const bool skip_test_D1_0214 = false;
const bool skip_test_D1_0215 = false;
const bool skip_test_D1_0216 = false;
const bool skip_test_D1_0217 = false;
const bool skip_test_D1_0218 = false;
const bool skip_test_D1_0219 = false;
const bool skip_test_D1_021A = false;
const bool skip_test_D1_021B = false;
const bool skip_test_D1_021C = false;
const bool skip_test_D1_021D = false;
const bool skip_test_D1_021E = false;
const bool skip_test_D1_021F = false;
const bool skip_test_D1_0220 = false;
const bool skip_test_D1_0221 = false;
const bool skip_test_D1_0222 = false;
const bool skip_test_D1_0223 = false;
const bool skip_test_D1_0224 = false;
const bool skip_test_D1_0225 = false;
const bool skip_test_D1_0226 = false;
const bool skip_test_D1_0227 = false;
const bool skip_test_D1_0228 = false;
const bool skip_test_D1_0229 = false;
const bool skip_test_D1_022A = false;
const bool skip_test_D1_022B = false;
const bool skip_test_D1_022C = false;
const bool skip_test_D1_022D = false;
const bool skip_test_D1_022E = false;
const bool skip_test_D1_022F = false;
const bool skip_test_D1_0230 = false;
const bool skip_test_D1_0231 = false;
const bool skip_test_D1_0232 = false;
const bool skip_test_D1_0233 = false;
const bool skip_test_D1_0234 = false;
const bool skip_test_D1_0235 = false;
const bool skip_test_D1_0236 = false;
const bool skip_test_D1_0237 = false;
const bool skip_test_D1_0238 = false;
const bool skip_test_D1_0239 = false;
const bool skip_test_D1_023A = false;
const bool skip_test_D1_023B = false;
const bool skip_test_D1_023C = false;
const bool skip_test_D1_023D = false;
const bool skip_test_D1_023E = false;
const bool skip_test_D1_023F = false;
const bool skip_test_D1_0240 = false;
const bool skip_test_D1_0241 = false;
const bool skip_test_D1_0242 = false;
const bool skip_test_D1_0243 = false;
const bool skip_test_D1_0244 = false;
const bool skip_test_D1_0245 = false;
const bool skip_test_D1_0246 = false;
const bool skip_test_D1_0247 = false;
const bool skip_test_D1_0248 = false;
const bool skip_test_D1_0249 = false;
const bool skip_test_D1_024A = false;
const bool skip_test_D1_024B = false;
const bool skip_test_D1_024C = false;
const bool skip_test_D1_024D = false;
const bool skip_test_D1_024E = false;
const bool skip_test_D1_024F = false;
const bool skip_test_D1_0250 = false;
const bool skip_test_D1_0251 = false;
const bool skip_test_D1_0252 = false;
const bool skip_test_D1_0253 = false;
const bool skip_test_D1_0254 = false;
const bool skip_test_D1_0255 = false;
const bool skip_test_D1_0256 = false;
const bool skip_test_D1_0257 = false;
const bool skip_test_D1_0258 = false;
const bool skip_test_D1_0259 = false;
const bool skip_test_D1_025A = false;
const bool skip_test_D1_025B = false;
const bool skip_test_D1_025C = false;
const bool skip_test_D1_025D = false;
const bool skip_test_D1_025E = true;
const bool skip_test_D1_025F = false;
const bool skip_test_D1_0260 = false;
const bool skip_test_D1_0261 = false;
const bool skip_test_D1_0262 = false;
const bool skip_test_D1_0263 = false;
const bool skip_test_D1_0264 = false;
const bool skip_test_D1_0265 = false;
const bool skip_test_D1_0266 = false;
const bool skip_test_D1_0267 = false;
const bool skip_test_D1_0268 = false;
const bool skip_test_D1_0269 = false;
const bool skip_test_D1_026A = false;
const bool skip_test_D1_026B = false;
const bool skip_test_D1_026C = false;
const bool skip_test_D1_026D = false;
const bool skip_test_D1_026E = false;
const bool skip_test_D1_026F = false;
const bool skip_test_D1_0270 = false;
const bool skip_test_D1_0271 = false;
const bool skip_test_D1_0272 = false;
const bool skip_test_D1_0273 = false;
const bool skip_test_D1_0274 = false;
const bool skip_test_D1_0275 = false;
const bool skip_test_D1_0276 = false;
const bool skip_test_D1_0277 = false;
const bool skip_test_D1_0278 = false;
const bool skip_test_D1_0279 = false;
const bool skip_test_D1_027A = false;
const bool skip_test_D1_027B = false;
const bool skip_test_D1_027C = false;
const bool skip_test_D1_027D = false;
const bool skip_test_D1_027E = false;
const bool skip_test_D1_027F = false;
const bool skip_test_D1_0280 = false;
const bool skip_test_D1_0281 = false;
const bool skip_test_D1_0282 = false;
const bool skip_test_D1_0283 = false;
const bool skip_test_D1_0284 = false;
const bool skip_test_D1_0285 = false;
const bool skip_test_D1_0286 = false;
const bool skip_test_D1_0287 = false;
const bool skip_test_D1_0288 = false;
const bool skip_test_D1_0289 = false;
const bool skip_test_D1_028A = false;
const bool skip_test_D1_028B = false;
const bool skip_test_D1_028C = false;
const bool skip_test_D1_028D = false;
const bool skip_test_D1_028E = false;
const bool skip_test_D1_028F = false;
const bool skip_test_D1_0290 = false;
const bool skip_test_D1_0291 = false;
const bool skip_test_D1_0292 = false;
const bool skip_test_D1_0293 = false;
const bool skip_test_D1_0294 = false;
const bool skip_test_D1_0295 = false;
const bool skip_test_D1_0296 = false;
const bool skip_test_D1_0297 = false;
const bool skip_test_D1_0298 = false;
const bool skip_test_D1_0299 = false;
const bool skip_test_D1_029A = false;
const bool skip_test_D1_029B = false;
const bool skip_test_D1_029C = false;
const bool skip_test_D1_029D = false;
const bool skip_test_D1_029E = false;
const bool skip_test_D1_029F = false;
const bool skip_test_D1_02A0 = false;
const bool skip_test_D1_02A1 = false;
const bool skip_test_D1_02A2 = false;
const bool skip_test_D1_02A3 = false;
const bool skip_test_D1_02A4 = false;
const bool skip_test_D1_02A5 = false;
const bool skip_test_D1_02A6 = false;
const bool skip_test_D1_02A7 = false;
const bool skip_test_D1_02A8 = false;
const bool skip_test_D1_02A9 = false;
const bool skip_test_D1_02AA = false;
const bool skip_test_D1_02AB = false;
const bool skip_test_D1_02AC = false;
const bool skip_test_D1_02AD = false;
const bool skip_test_D1_02AE = false;
const bool skip_test_D1_02AF = false;
const bool skip_test_D1_02B0 = false;
const bool skip_test_D1_02B1 = false;
const bool skip_test_D1_02B2 = false;
const bool skip_test_D1_02B3 = false;
const bool skip_test_D1_02B4 = false;
const bool skip_test_D1_02B5 = false;
const bool skip_test_D1_02B6 = false;
const bool skip_test_D1_02B7 = false;
const bool skip_test_D1_02B8 = false;
const bool skip_test_D1_02B9 = false;
const bool skip_test_D1_02BA = false;
const bool skip_test_D1_02BB = false;
const bool skip_test_D1_02BC = false;
const bool skip_test_D1_02BD = false;
const bool skip_test_D1_02BE = false;
const bool skip_test_D1_02BF = false;
const bool skip_test_D1_02C0 = false;
const bool skip_test_D1_02C1 = false;
const bool skip_test_D1_02C2 = false;
const bool skip_test_D1_02C3 = false;
const bool skip_test_D1_02C4 = false;
const bool skip_test_D1_02C5 = false;
const bool skip_test_D1_02C6 = false;
const bool skip_test_D1_02C7 = false;
const bool skip_test_D1_02C8 = false;
const bool skip_test_D1_02C9 = false;
const bool skip_test_D1_02CA = false;
const bool skip_test_D1_02CB = false;
const bool skip_test_D1_02CC = false;
const bool skip_test_D1_02CD = false;
const bool skip_test_D1_02CE = false;
const bool skip_test_D1_02CF = false;
const bool skip_test_D1_02D0 = false;
const bool skip_test_D1_02D1 = false;
const bool skip_test_D1_02D2 = false;
const bool skip_test_D1_02D3 = false;
const bool skip_test_D1_02D4 = false;
const bool skip_test_D1_02D5 = false;
const bool skip_test_D1_02D6 = false;
const bool skip_test_D1_02D7 = false;
const bool skip_test_D1_02D8 = false;
const bool skip_test_D1_02D9 = false;
const bool skip_test_D1_02DA = false;
const bool skip_test_D1_02DB = false;
const bool skip_test_D1_02DC = false;
const bool skip_test_D1_02DD = false;
const bool skip_test_D1_02DE = false;
const bool skip_test_D1_02DF = false;
const bool skip_test_D1_02E0 = false;
const bool skip_test_D1_02E1 = false;
const bool skip_test_D1_02E2 = false;
const bool skip_test_D1_02E3 = false;
const bool skip_test_D1_02E4 = false;
const bool skip_test_D1_02E5 = false;
const bool skip_test_D1_02E6 = false;
const bool skip_test_D1_02E7 = false;
const bool skip_test_D1_02E8 = false;
const bool skip_test_D1_02E9 = false;
const bool skip_test_D1_02EA = false;
const bool skip_test_D1_02EB = false;
const bool skip_test_D1_02EC = false;
const bool skip_test_D1_02ED = false;
const bool skip_test_D1_02EE = false;
const bool skip_test_D1_02EF = false;
const bool skip_test_D1_02F0 = false;
const bool skip_test_D1_02F1 = false;
const bool skip_test_D1_02F2 = false;
const bool skip_test_D1_02F3 = false;
const bool skip_test_D1_02F4 = false;
const bool skip_test_D1_02F5 = false;
const bool skip_test_D1_02F6 = false;
const bool skip_test_D1_02F7 = false;
const bool skip_test_D1_02F8 = false;
const bool skip_test_D1_02F9 = false;
const bool skip_test_D1_02FA = false;
const bool skip_test_D1_02FB = false;
const bool skip_test_D1_02FC = false;
const bool skip_test_D1_02FD = false;
const bool skip_test_D1_02FE = false;
const bool skip_test_D1_02FF = false;
const bool skip_test_D1_0300 = false;
const bool skip_test_D1_0301 = false;
const bool skip_test_D1_0302 = false;
const bool skip_test_D1_0303 = false;
const bool skip_test_D1_0304 = false;
const bool skip_test_D1_0305 = false;
const bool skip_test_D1_0306 = false;
const bool skip_test_D1_0307 = false;
const bool skip_test_D1_0308 = false;
const bool skip_test_D1_0309 = false;
const bool skip_test_D1_030A = false;
const bool skip_test_D1_030B = false;
const bool skip_test_D1_030C = false;
const bool skip_test_D1_030D = false;
const bool skip_test_D1_030E = false;
const bool skip_test_D1_030F = false;
const bool skip_test_D1_0310 = false;
const bool skip_test_D1_0311 = false;
const bool skip_test_D1_0312 = false;
const bool skip_test_D1_0313 = false;
const bool skip_test_D1_0314 = false;
const bool skip_test_D1_0315 = false;
const bool skip_test_D1_0316 = false;
const bool skip_test_D1_0317 = false;
const bool skip_test_D1_0318 = false;
const bool skip_test_D1_0319 = false;
const bool skip_test_D1_031A = false;
const bool skip_test_D1_031B = false;
const bool skip_test_D1_031C = false;
const bool skip_test_D1_031D = false;
const bool skip_test_D1_031E = false;
const bool skip_test_D1_031F = false;
const bool skip_test_D1_0320 = false;
const bool skip_test_D1_0321 = false;
const bool skip_test_D1_0322 = false;
const bool skip_test_D1_0323 = false;
const bool skip_test_D1_0324 = false;
const bool skip_test_D1_0325 = false;
const bool skip_test_D1_0326 = false;
const bool skip_test_D1_0327 = false;
const bool skip_test_D1_0328 = false;
const bool skip_test_D1_0329 = false;
const bool skip_test_D1_032A = false;
const bool skip_test_D1_032B = false;
const bool skip_test_D1_032C = false;
const bool skip_test_D1_032D = false;
const bool skip_test_D1_032E = false;
const bool skip_test_D1_032F = false;
const bool skip_test_D1_0330 = false;
const bool skip_test_D1_0331 = false;
const bool skip_test_D1_0332 = false;
const bool skip_test_D1_0333 = false;
const bool skip_test_D1_0334 = false;
const bool skip_test_D1_0335 = false;
const bool skip_test_D1_0336 = false;
const bool skip_test_D1_0337 = false;
const bool skip_test_D1_0338 = false;
const bool skip_test_D1_0339 = false;
const bool skip_test_D1_033A = false;
const bool skip_test_D1_033B = false;
const bool skip_test_D1_033C = false;
const bool skip_test_D1_033D = false;
const bool skip_test_D1_033E = false;
const bool skip_test_D1_033F = true;
const bool skip_test_D1_0340 = false;
const bool skip_test_D1_0341 = false;
const bool skip_test_D1_0342 = false;
const bool skip_test_D1_0343 = false;
const bool skip_test_D1_0344 = false;
const bool skip_test_D1_0345 = false;
const bool skip_test_D1_0346 = false;
const bool skip_test_D1_0347 = false;
const bool skip_test_D1_0348 = false;
const bool skip_test_D1_0349 = false;
const bool skip_test_D1_034A = false;
const bool skip_test_D1_034B = false;
const bool skip_test_D1_034C = false;
const bool skip_test_D1_034D = false;
const bool skip_test_D1_034E = false;
const bool skip_test_D1_034F = false;
const bool skip_test_D1_0350 = false;
const bool skip_test_D1_0351 = false;
const bool skip_test_D1_0352 = false;
const bool skip_test_D1_0353 = false;
const bool skip_test_D1_0354 = false;
const bool skip_test_D1_0355 = false;
const bool skip_test_D1_0356 = false;
const bool skip_test_D1_0357 = false;
const bool skip_test_D1_0358 = false;
const bool skip_test_D1_0359 = false;
const bool skip_test_D1_035A = false;
const bool skip_test_D1_035B = false;
const bool skip_test_D1_035C = false;
const bool skip_test_D1_035D = false;
const bool skip_test_D1_035E = false;
const bool skip_test_D1_035F = false;
const bool skip_test_D1_0360 = false;
const bool skip_test_D1_0361 = false;
const bool skip_test_D1_0362 = false;
const bool skip_test_D1_0363 = false;
const bool skip_test_D1_0364 = false;
const bool skip_test_D1_0365 = false;
const bool skip_test_D1_0366 = false;
const bool skip_test_D1_0367 = false;
const bool skip_test_D1_0368 = false;
const bool skip_test_D1_0369 = false;
const bool skip_test_D1_036A = false;
const bool skip_test_D1_036B = false;
const bool skip_test_D1_036C = false;
const bool skip_test_D1_036D = false;
const bool skip_test_D1_036E = false;
const bool skip_test_D1_036F = false;
const bool skip_test_D1_0370 = false;
const bool skip_test_D1_0371 = false;
const bool skip_test_D1_0372 = false;
const bool skip_test_D1_0373 = false;
const bool skip_test_D1_0374 = false;
const bool skip_test_D1_0375 = false;
const bool skip_test_D1_0376 = false;
const bool skip_test_D1_0377 = false;
const bool skip_test_D1_0378 = false;
const bool skip_test_D1_0379 = false;
const bool skip_test_D1_037A = false;
const bool skip_test_D1_037B = false;
const bool skip_test_D1_037C = false;
const bool skip_test_D1_037D = false;
const bool skip_test_D1_037E = false;
const bool skip_test_D1_037F = false;
const bool skip_test_D1_0380 = false;
const bool skip_test_D1_0381 = false;
const bool skip_test_D1_0382 = false;
const bool skip_test_D1_0383 = false;
const bool skip_test_D1_0384 = false;
const bool skip_test_D1_0385 = false;
const bool skip_test_D1_0386 = false;
const bool skip_test_D1_0387 = false;
const bool skip_test_D1_0388 = false;
const bool skip_test_D1_0389 = false;
const bool skip_test_D1_038A = false;
const bool skip_test_D1_038B = false;
const bool skip_test_D1_038C = false;
const bool skip_test_D1_038D = false;
const bool skip_test_D1_038E = false;
const bool skip_test_D1_038F = false;
const bool skip_test_D1_0390 = false;
const bool skip_test_D1_0391 = false;
const bool skip_test_D1_0392 = false;
const bool skip_test_D1_0393 = false;
const bool skip_test_D1_0394 = false;
const bool skip_test_D1_0395 = false;
const bool skip_test_D1_0396 = false;
const bool skip_test_D1_0397 = false;
const bool skip_test_D1_0398 = false;
const bool skip_test_D1_0399 = false;
const bool skip_test_D1_039A = false;
const bool skip_test_D1_039B = false;
const bool skip_test_D1_039C = false;
const bool skip_test_D1_039D = false;
const bool skip_test_D1_039E = false;
const bool skip_test_D1_039F = false;
const bool skip_test_D1_03A0 = false;
const bool skip_test_D1_03A1 = false;
const bool skip_test_D1_03A2 = false;
const bool skip_test_D1_03A3 = false;
const bool skip_test_D1_03A4 = false;
const bool skip_test_D1_03A5 = false;
const bool skip_test_D1_03A6 = false;
const bool skip_test_D1_03A7 = false;
const bool skip_test_D1_03A8 = false;
const bool skip_test_D1_03A9 = false;
const bool skip_test_D1_03AA = false;
const bool skip_test_D1_03AB = false;
const bool skip_test_D1_03AC = false;
const bool skip_test_D1_03AD = false;
const bool skip_test_D1_03AE = false;
const bool skip_test_D1_03AF = false;
const bool skip_test_D1_03B0 = false;
const bool skip_test_D1_03B1 = false;
const bool skip_test_D1_03B2 = false;
const bool skip_test_D1_03B3 = false;
const bool skip_test_D1_03B4 = false;
const bool skip_test_D1_03B5 = false;
const bool skip_test_D1_03B6 = false;
const bool skip_test_D1_03B7 = false;
const bool skip_test_D1_03B8 = false;
const bool skip_test_D1_03B9 = false;
const bool skip_test_D1_03BA = false;
const bool skip_test_D1_03BB = false;
const bool skip_test_D1_03BC = false;
const bool skip_test_D1_03BD = false;
const bool skip_test_D1_03BE = false;
const bool skip_test_D1_03BF = false;
const bool skip_test_D1_03C0 = false;
const bool skip_test_D1_03C1 = false;
const bool skip_test_D1_03C2 = false;
const bool skip_test_D1_03C3 = false;
const bool skip_test_D1_03C4 = false;
const bool skip_test_D1_03C5 = false;
const bool skip_test_D1_03C6 = false;
const bool skip_test_D1_03C7 = false;
const bool skip_test_D1_03C8 = false;
const bool skip_test_D1_03C9 = false;
const bool skip_test_D1_03CA = false;
const bool skip_test_D1_03CB = false;
const bool skip_test_D1_03CC = false;
const bool skip_test_D1_03CD = false;
const bool skip_test_D1_03CE = false;
const bool skip_test_D1_03CF = false;
const bool skip_test_D1_03D0 = false;
const bool skip_test_D1_03D1 = false;
const bool skip_test_D1_03D2 = false;
const bool skip_test_D1_03D3 = false;
const bool skip_test_D1_03D4 = false;
const bool skip_test_D1_03D5 = false;
const bool skip_test_D1_03D6 = false;
const bool skip_test_D1_03D7 = false;
const bool skip_test_D1_03D8 = false;
const bool skip_test_D1_03D9 = false;
const bool skip_test_D1_03DA = false;
const bool skip_test_D1_03DB = false;
const bool skip_test_D1_03DC = false;
const bool skip_test_D1_03DD = false;
const bool skip_test_D1_03DE = false;
const bool skip_test_D1_03DF = false;
const bool skip_test_D1_03E0 = false;
const bool skip_test_D1_03E1 = false;
const bool skip_test_D1_03E2 = false;
const bool skip_test_D1_03E3 = false;
const bool skip_test_D1_03E4 = false;
const bool skip_test_D1_03E5 = false;
const bool skip_test_D1_03E6 = false;
const bool skip_test_D1_03E7 = false;
void test_D1_0000(void);
void test_D1_0001(void);
void test_D1_0002(void);
void test_D1_0003(void);
void test_D1_0004(void);
void test_D1_0005(void);
void test_D1_0006(void);
void test_D1_0007(void);
void test_D1_0008(void);
void test_D1_0009(void);
void test_D1_000A(void);
void test_D1_000B(void);
void test_D1_000C(void);
void test_D1_000D(void);
void test_D1_000E(void);
void test_D1_000F(void);
void test_D1_0010(void);
void test_D1_0011(void);
void test_D1_0012(void);
void test_D1_0013(void);
void test_D1_0014(void);
void test_D1_0015(void);
void test_D1_0016(void);
void test_D1_0017(void);
void test_D1_0018(void);
void test_D1_0019(void);
void test_D1_001A(void);
void test_D1_001B(void);
void test_D1_001C(void);
void test_D1_001D(void);
void test_D1_001E(void);
void test_D1_001F(void);
void test_D1_0020(void);
void test_D1_0021(void);
void test_D1_0022(void);
void test_D1_0023(void);
void test_D1_0024(void);
void test_D1_0025(void);
void test_D1_0026(void);
void test_D1_0027(void);
void test_D1_0028(void);
void test_D1_0029(void);
void test_D1_002A(void);
void test_D1_002B(void);
void test_D1_002C(void);
void test_D1_002D(void);
void test_D1_002E(void);
void test_D1_002F(void);
void test_D1_0030(void);
void test_D1_0031(void);
void test_D1_0032(void);
void test_D1_0033(void);
void test_D1_0034(void);
void test_D1_0035(void);
void test_D1_0036(void);
void test_D1_0037(void);
void test_D1_0038(void);
void test_D1_0039(void);
void test_D1_003A(void);
void test_D1_003B(void);
void test_D1_003C(void);
void test_D1_003D(void);
void test_D1_003E(void);
void test_D1_003F(void);
void test_D1_0040(void);
void test_D1_0041(void);
void test_D1_0042(void);
void test_D1_0043(void);
void test_D1_0044(void);
void test_D1_0045(void);
void test_D1_0046(void);
void test_D1_0047(void);
void test_D1_0048(void);
void test_D1_0049(void);
void test_D1_004A(void);
void test_D1_004B(void);
void test_D1_004C(void);
void test_D1_004D(void);
void test_D1_004E(void);
void test_D1_004F(void);
void test_D1_0050(void);
void test_D1_0051(void);
void test_D1_0052(void);
void test_D1_0053(void);
void test_D1_0054(void);
void test_D1_0055(void);
void test_D1_0056(void);
void test_D1_0057(void);
void test_D1_0058(void);
void test_D1_0059(void);
void test_D1_005A(void);
void test_D1_005B(void);
void test_D1_005C(void);
void test_D1_005D(void);
void test_D1_005E(void);
void test_D1_005F(void);
void test_D1_0060(void);
void test_D1_0061(void);
void test_D1_0062(void);
void test_D1_0063(void);
void test_D1_0064(void);
void test_D1_0065(void);
void test_D1_0066(void);
void test_D1_0067(void);
void test_D1_0068(void);
void test_D1_0069(void);
void test_D1_006A(void);
void test_D1_006B(void);
void test_D1_006C(void);
void test_D1_006D(void);
void test_D1_006E(void);
void test_D1_006F(void);
void test_D1_0070(void);
void test_D1_0071(void);
void test_D1_0072(void);
void test_D1_0073(void);
void test_D1_0074(void);
void test_D1_0075(void);
void test_D1_0076(void);
void test_D1_0077(void);
void test_D1_0078(void);
void test_D1_0079(void);
void test_D1_007A(void);
void test_D1_007B(void);
void test_D1_007C(void);
void test_D1_007D(void);
void test_D1_007E(void);
void test_D1_007F(void);
void test_D1_0080(void);
void test_D1_0081(void);
void test_D1_0082(void);
void test_D1_0083(void);
void test_D1_0084(void);
void test_D1_0085(void);
void test_D1_0086(void);
void test_D1_0087(void);
void test_D1_0088(void);
void test_D1_0089(void);
void test_D1_008A(void);
void test_D1_008B(void);
void test_D1_008C(void);
void test_D1_008D(void);
void test_D1_008E(void);
void test_D1_008F(void);
void test_D1_0090(void);
void test_D1_0091(void);
void test_D1_0092(void);
void test_D1_0093(void);
void test_D1_0094(void);
void test_D1_0095(void);
void test_D1_0096(void);
void test_D1_0097(void);
void test_D1_0098(void);
void test_D1_0099(void);
void test_D1_009A(void);
void test_D1_009B(void);
void test_D1_009C(void);
void test_D1_009D(void);
void test_D1_009E(void);
void test_D1_009F(void);
void test_D1_00A0(void);
void test_D1_00A1(void);
void test_D1_00A2(void);
void test_D1_00A3(void);
void test_D1_00A4(void);
void test_D1_00A5(void);
void test_D1_00A6(void);
void test_D1_00A7(void);
void test_D1_00A8(void);
void test_D1_00A9(void);
void test_D1_00AA(void);
void test_D1_00AB(void);
void test_D1_00AC(void);
void test_D1_00AD(void);
void test_D1_00AE(void);
void test_D1_00AF(void);
void test_D1_00B0(void);
void test_D1_00B1(void);
void test_D1_00B2(void);
void test_D1_00B3(void);
void test_D1_00B4(void);
void test_D1_00B5(void);
void test_D1_00B6(void);
void test_D1_00B7(void);
void test_D1_00B8(void);
void test_D1_00B9(void);
void test_D1_00BA(void);
void test_D1_00BB(void);
void test_D1_00BC(void);
void test_D1_00BD(void);
void test_D1_00BE(void);
void test_D1_00BF(void);
void test_D1_00C0(void);
void test_D1_00C1(void);
void test_D1_00C2(void);
void test_D1_00C3(void);
void test_D1_00C4(void);
void test_D1_00C5(void);
void test_D1_00C6(void);
void test_D1_00C7(void);
void test_D1_00C8(void);
void test_D1_00C9(void);
void test_D1_00CA(void);
void test_D1_00CB(void);
void test_D1_00CC(void);
void test_D1_00CD(void);
void test_D1_00CE(void);
void test_D1_00CF(void);
void test_D1_00D0(void);
void test_D1_00D1(void);
void test_D1_00D2(void);
void test_D1_00D3(void);
void test_D1_00D4(void);
void test_D1_00D5(void);
void test_D1_00D6(void);
void test_D1_00D7(void);
void test_D1_00D8(void);
void test_D1_00D9(void);
void test_D1_00DA(void);
void test_D1_00DB(void);
void test_D1_00DC(void);
void test_D1_00DD(void);
void test_D1_00DE(void);
void test_D1_00DF(void);
void test_D1_00E0(void);
void test_D1_00E1(void);
void test_D1_00E2(void);
void test_D1_00E3(void);
void test_D1_00E4(void);
void test_D1_00E5(void);
void test_D1_00E6(void);
void test_D1_00E7(void);
void test_D1_00E8(void);
void test_D1_00E9(void);
void test_D1_00EA(void);
void test_D1_00EB(void);
void test_D1_00EC(void);
void test_D1_00ED(void);
void test_D1_00EE(void);
void test_D1_00EF(void);
void test_D1_00F0(void);
void test_D1_00F1(void);
void test_D1_00F2(void);
void test_D1_00F3(void);
void test_D1_00F4(void);
void test_D1_00F5(void);
void test_D1_00F6(void);
void test_D1_00F7(void);
void test_D1_00F8(void);
void test_D1_00F9(void);
void test_D1_00FA(void);
void test_D1_00FB(void);
void test_D1_00FC(void);
void test_D1_00FD(void);
void test_D1_00FE(void);
void test_D1_00FF(void);
void test_D1_0100(void);
void test_D1_0101(void);
void test_D1_0102(void);
void test_D1_0103(void);
void test_D1_0104(void);
void test_D1_0105(void);
void test_D1_0106(void);
void test_D1_0107(void);
void test_D1_0108(void);
void test_D1_0109(void);
void test_D1_010A(void);
void test_D1_010B(void);
void test_D1_010C(void);
void test_D1_010D(void);
void test_D1_010E(void);
void test_D1_010F(void);
void test_D1_0110(void);
void test_D1_0111(void);
void test_D1_0112(void);
void test_D1_0113(void);
void test_D1_0114(void);
void test_D1_0115(void);
void test_D1_0116(void);
void test_D1_0117(void);
void test_D1_0118(void);
void test_D1_0119(void);
void test_D1_011A(void);
void test_D1_011B(void);
void test_D1_011C(void);
void test_D1_011D(void);
void test_D1_011E(void);
void test_D1_011F(void);
void test_D1_0120(void);
void test_D1_0121(void);
void test_D1_0122(void);
void test_D1_0123(void);
void test_D1_0124(void);
void test_D1_0125(void);
void test_D1_0126(void);
void test_D1_0127(void);
void test_D1_0128(void);
void test_D1_0129(void);
void test_D1_012A(void);
void test_D1_012B(void);
void test_D1_012C(void);
void test_D1_012D(void);
void test_D1_012E(void);
void test_D1_012F(void);
void test_D1_0130(void);
void test_D1_0131(void);
void test_D1_0132(void);
void test_D1_0133(void);
void test_D1_0134(void);
void test_D1_0135(void);
void test_D1_0136(void);
void test_D1_0137(void);
void test_D1_0138(void);
void test_D1_0139(void);
void test_D1_013A(void);
void test_D1_013B(void);
void test_D1_013C(void);
void test_D1_013D(void);
void test_D1_013E(void);
void test_D1_013F(void);
void test_D1_0140(void);
void test_D1_0141(void);
void test_D1_0142(void);
void test_D1_0143(void);
void test_D1_0144(void);
void test_D1_0145(void);
void test_D1_0146(void);
void test_D1_0147(void);
void test_D1_0148(void);
void test_D1_0149(void);
void test_D1_014A(void);
void test_D1_014B(void);
void test_D1_014C(void);
void test_D1_014D(void);
void test_D1_014E(void);
void test_D1_014F(void);
void test_D1_0150(void);
void test_D1_0151(void);
void test_D1_0152(void);
void test_D1_0153(void);
void test_D1_0154(void);
void test_D1_0155(void);
void test_D1_0156(void);
void test_D1_0157(void);
void test_D1_0158(void);
void test_D1_0159(void);
void test_D1_015A(void);
void test_D1_015B(void);
void test_D1_015C(void);
void test_D1_015D(void);
void test_D1_015E(void);
void test_D1_015F(void);
void test_D1_0160(void);
void test_D1_0161(void);
void test_D1_0162(void);
void test_D1_0163(void);
void test_D1_0164(void);
void test_D1_0165(void);
void test_D1_0166(void);
void test_D1_0167(void);
void test_D1_0168(void);
void test_D1_0169(void);
void test_D1_016A(void);
void test_D1_016B(void);
void test_D1_016C(void);
void test_D1_016D(void);
void test_D1_016E(void);
void test_D1_016F(void);
void test_D1_0170(void);
void test_D1_0171(void);
void test_D1_0172(void);
void test_D1_0173(void);
void test_D1_0174(void);
void test_D1_0175(void);
void test_D1_0176(void);
void test_D1_0177(void);
void test_D1_0178(void);
void test_D1_0179(void);
void test_D1_017A(void);
void test_D1_017B(void);
void test_D1_017C(void);
void test_D1_017D(void);
void test_D1_017E(void);
void test_D1_017F(void);
void test_D1_0180(void);
void test_D1_0181(void);
void test_D1_0182(void);
void test_D1_0183(void);
void test_D1_0184(void);
void test_D1_0185(void);
void test_D1_0186(void);
void test_D1_0187(void);
void test_D1_0188(void);
void test_D1_0189(void);
void test_D1_018A(void);
void test_D1_018B(void);
void test_D1_018C(void);
void test_D1_018D(void);
void test_D1_018E(void);
void test_D1_018F(void);
void test_D1_0190(void);
void test_D1_0191(void);
void test_D1_0192(void);
void test_D1_0193(void);
void test_D1_0194(void);
void test_D1_0195(void);
void test_D1_0196(void);
void test_D1_0197(void);
void test_D1_0198(void);
void test_D1_0199(void);
void test_D1_019A(void);
void test_D1_019B(void);
void test_D1_019C(void);
void test_D1_019D(void);
void test_D1_019E(void);
void test_D1_019F(void);
void test_D1_01A0(void);
void test_D1_01A1(void);
void test_D1_01A2(void);
void test_D1_01A3(void);
void test_D1_01A4(void);
void test_D1_01A5(void);
void test_D1_01A6(void);
void test_D1_01A7(void);
void test_D1_01A8(void);
void test_D1_01A9(void);
void test_D1_01AA(void);
void test_D1_01AB(void);
void test_D1_01AC(void);
void test_D1_01AD(void);
void test_D1_01AE(void);
void test_D1_01AF(void);
void test_D1_01B0(void);
void test_D1_01B1(void);
void test_D1_01B2(void);
void test_D1_01B3(void);
void test_D1_01B4(void);
void test_D1_01B5(void);
void test_D1_01B6(void);
void test_D1_01B7(void);
void test_D1_01B8(void);
void test_D1_01B9(void);
void test_D1_01BA(void);
void test_D1_01BB(void);
void test_D1_01BC(void);
void test_D1_01BD(void);
void test_D1_01BE(void);
void test_D1_01BF(void);
void test_D1_01C0(void);
void test_D1_01C1(void);
void test_D1_01C2(void);
void test_D1_01C3(void);
void test_D1_01C4(void);
void test_D1_01C5(void);
void test_D1_01C6(void);
void test_D1_01C7(void);
void test_D1_01C8(void);
void test_D1_01C9(void);
void test_D1_01CA(void);
void test_D1_01CB(void);
void test_D1_01CC(void);
void test_D1_01CD(void);
void test_D1_01CE(void);
void test_D1_01CF(void);
void test_D1_01D0(void);
void test_D1_01D1(void);
void test_D1_01D2(void);
void test_D1_01D3(void);
void test_D1_01D4(void);
void test_D1_01D5(void);
void test_D1_01D6(void);
void test_D1_01D7(void);
void test_D1_01D8(void);
void test_D1_01D9(void);
void test_D1_01DA(void);
void test_D1_01DB(void);
void test_D1_01DC(void);
void test_D1_01DD(void);
void test_D1_01DE(void);
void test_D1_01DF(void);
void test_D1_01E0(void);
void test_D1_01E1(void);
void test_D1_01E2(void);
void test_D1_01E3(void);
void test_D1_01E4(void);
void test_D1_01E5(void);
void test_D1_01E6(void);
void test_D1_01E7(void);
void test_D1_01E8(void);
void test_D1_01E9(void);
void test_D1_01EA(void);
void test_D1_01EB(void);
void test_D1_01EC(void);
void test_D1_01ED(void);
void test_D1_01EE(void);
void test_D1_01EF(void);
void test_D1_01F0(void);
void test_D1_01F1(void);
void test_D1_01F2(void);
void test_D1_01F3(void);
void test_D1_01F4(void);
void test_D1_01F5(void);
void test_D1_01F6(void);
void test_D1_01F7(void);
void test_D1_01F8(void);
void test_D1_01F9(void);
void test_D1_01FA(void);
void test_D1_01FB(void);
void test_D1_01FC(void);
void test_D1_01FD(void);
void test_D1_01FE(void);
void test_D1_01FF(void);
void test_D1_0200(void);
void test_D1_0201(void);
void test_D1_0202(void);
void test_D1_0203(void);
void test_D1_0204(void);
void test_D1_0205(void);
void test_D1_0206(void);
void test_D1_0207(void);
void test_D1_0208(void);
void test_D1_0209(void);
void test_D1_020A(void);
void test_D1_020B(void);
void test_D1_020C(void);
void test_D1_020D(void);
void test_D1_020E(void);
void test_D1_020F(void);
void test_D1_0210(void);
void test_D1_0211(void);
void test_D1_0212(void);
void test_D1_0213(void);
void test_D1_0214(void);
void test_D1_0215(void);
void test_D1_0216(void);
void test_D1_0217(void);
void test_D1_0218(void);
void test_D1_0219(void);
void test_D1_021A(void);
void test_D1_021B(void);
void test_D1_021C(void);
void test_D1_021D(void);
void test_D1_021E(void);
void test_D1_021F(void);
void test_D1_0220(void);
void test_D1_0221(void);
void test_D1_0222(void);
void test_D1_0223(void);
void test_D1_0224(void);
void test_D1_0225(void);
void test_D1_0226(void);
void test_D1_0227(void);
void test_D1_0228(void);
void test_D1_0229(void);
void test_D1_022A(void);
void test_D1_022B(void);
void test_D1_022C(void);
void test_D1_022D(void);
void test_D1_022E(void);
void test_D1_022F(void);
void test_D1_0230(void);
void test_D1_0231(void);
void test_D1_0232(void);
void test_D1_0233(void);
void test_D1_0234(void);
void test_D1_0235(void);
void test_D1_0236(void);
void test_D1_0237(void);
void test_D1_0238(void);
void test_D1_0239(void);
void test_D1_023A(void);
void test_D1_023B(void);
void test_D1_023C(void);
void test_D1_023D(void);
void test_D1_023E(void);
void test_D1_023F(void);
void test_D1_0240(void);
void test_D1_0241(void);
void test_D1_0242(void);
void test_D1_0243(void);
void test_D1_0244(void);
void test_D1_0245(void);
void test_D1_0246(void);
void test_D1_0247(void);
void test_D1_0248(void);
void test_D1_0249(void);
void test_D1_024A(void);
void test_D1_024B(void);
void test_D1_024C(void);
void test_D1_024D(void);
void test_D1_024E(void);
void test_D1_024F(void);
void test_D1_0250(void);
void test_D1_0251(void);
void test_D1_0252(void);
void test_D1_0253(void);
void test_D1_0254(void);
void test_D1_0255(void);
void test_D1_0256(void);
void test_D1_0257(void);
void test_D1_0258(void);
void test_D1_0259(void);
void test_D1_025A(void);
void test_D1_025B(void);
void test_D1_025C(void);
void test_D1_025D(void);
void test_D1_025E(void);
void test_D1_025F(void);
void test_D1_0260(void);
void test_D1_0261(void);
void test_D1_0262(void);
void test_D1_0263(void);
void test_D1_0264(void);
void test_D1_0265(void);
void test_D1_0266(void);
void test_D1_0267(void);
void test_D1_0268(void);
void test_D1_0269(void);
void test_D1_026A(void);
void test_D1_026B(void);
void test_D1_026C(void);
void test_D1_026D(void);
void test_D1_026E(void);
void test_D1_026F(void);
void test_D1_0270(void);
void test_D1_0271(void);
void test_D1_0272(void);
void test_D1_0273(void);
void test_D1_0274(void);
void test_D1_0275(void);
void test_D1_0276(void);
void test_D1_0277(void);
void test_D1_0278(void);
void test_D1_0279(void);
void test_D1_027A(void);
void test_D1_027B(void);
void test_D1_027C(void);
void test_D1_027D(void);
void test_D1_027E(void);
void test_D1_027F(void);
void test_D1_0280(void);
void test_D1_0281(void);
void test_D1_0282(void);
void test_D1_0283(void);
void test_D1_0284(void);
void test_D1_0285(void);
void test_D1_0286(void);
void test_D1_0287(void);
void test_D1_0288(void);
void test_D1_0289(void);
void test_D1_028A(void);
void test_D1_028B(void);
void test_D1_028C(void);
void test_D1_028D(void);
void test_D1_028E(void);
void test_D1_028F(void);
void test_D1_0290(void);
void test_D1_0291(void);
void test_D1_0292(void);
void test_D1_0293(void);
void test_D1_0294(void);
void test_D1_0295(void);
void test_D1_0296(void);
void test_D1_0297(void);
void test_D1_0298(void);
void test_D1_0299(void);
void test_D1_029A(void);
void test_D1_029B(void);
void test_D1_029C(void);
void test_D1_029D(void);
void test_D1_029E(void);
void test_D1_029F(void);
void test_D1_02A0(void);
void test_D1_02A1(void);
void test_D1_02A2(void);
void test_D1_02A3(void);
void test_D1_02A4(void);
void test_D1_02A5(void);
void test_D1_02A6(void);
void test_D1_02A7(void);
void test_D1_02A8(void);
void test_D1_02A9(void);
void test_D1_02AA(void);
void test_D1_02AB(void);
void test_D1_02AC(void);
void test_D1_02AD(void);
void test_D1_02AE(void);
void test_D1_02AF(void);
void test_D1_02B0(void);
void test_D1_02B1(void);
void test_D1_02B2(void);
void test_D1_02B3(void);
void test_D1_02B4(void);
void test_D1_02B5(void);
void test_D1_02B6(void);
void test_D1_02B7(void);
void test_D1_02B8(void);
void test_D1_02B9(void);
void test_D1_02BA(void);
void test_D1_02BB(void);
void test_D1_02BC(void);
void test_D1_02BD(void);
void test_D1_02BE(void);
void test_D1_02BF(void);
void test_D1_02C0(void);
void test_D1_02C1(void);
void test_D1_02C2(void);
void test_D1_02C3(void);
void test_D1_02C4(void);
void test_D1_02C5(void);
void test_D1_02C6(void);
void test_D1_02C7(void);
void test_D1_02C8(void);
void test_D1_02C9(void);
void test_D1_02CA(void);
void test_D1_02CB(void);
void test_D1_02CC(void);
void test_D1_02CD(void);
void test_D1_02CE(void);
void test_D1_02CF(void);
void test_D1_02D0(void);
void test_D1_02D1(void);
void test_D1_02D2(void);
void test_D1_02D3(void);
void test_D1_02D4(void);
void test_D1_02D5(void);
void test_D1_02D6(void);
void test_D1_02D7(void);
void test_D1_02D8(void);
void test_D1_02D9(void);
void test_D1_02DA(void);
void test_D1_02DB(void);
void test_D1_02DC(void);
void test_D1_02DD(void);
void test_D1_02DE(void);
void test_D1_02DF(void);
void test_D1_02E0(void);
void test_D1_02E1(void);
void test_D1_02E2(void);
void test_D1_02E3(void);
void test_D1_02E4(void);
void test_D1_02E5(void);
void test_D1_02E6(void);
void test_D1_02E7(void);
void test_D1_02E8(void);
void test_D1_02E9(void);
void test_D1_02EA(void);
void test_D1_02EB(void);
void test_D1_02EC(void);
void test_D1_02ED(void);
void test_D1_02EE(void);
void test_D1_02EF(void);
void test_D1_02F0(void);
void test_D1_02F1(void);
void test_D1_02F2(void);
void test_D1_02F3(void);
void test_D1_02F4(void);
void test_D1_02F5(void);
void test_D1_02F6(void);
void test_D1_02F7(void);
void test_D1_02F8(void);
void test_D1_02F9(void);
void test_D1_02FA(void);
void test_D1_02FB(void);
void test_D1_02FC(void);
void test_D1_02FD(void);
void test_D1_02FE(void);
void test_D1_02FF(void);
void test_D1_0300(void);
void test_D1_0301(void);
void test_D1_0302(void);
void test_D1_0303(void);
void test_D1_0304(void);
void test_D1_0305(void);
void test_D1_0306(void);
void test_D1_0307(void);
void test_D1_0308(void);
void test_D1_0309(void);
void test_D1_030A(void);
void test_D1_030B(void);
void test_D1_030C(void);
void test_D1_030D(void);
void test_D1_030E(void);
void test_D1_030F(void);
void test_D1_0310(void);
void test_D1_0311(void);
void test_D1_0312(void);
void test_D1_0313(void);
void test_D1_0314(void);
void test_D1_0315(void);
void test_D1_0316(void);
void test_D1_0317(void);
void test_D1_0318(void);
void test_D1_0319(void);
void test_D1_031A(void);
void test_D1_031B(void);
void test_D1_031C(void);
void test_D1_031D(void);
void test_D1_031E(void);
void test_D1_031F(void);
void test_D1_0320(void);
void test_D1_0321(void);
void test_D1_0322(void);
void test_D1_0323(void);
void test_D1_0324(void);
void test_D1_0325(void);
void test_D1_0326(void);
void test_D1_0327(void);
void test_D1_0328(void);
void test_D1_0329(void);
void test_D1_032A(void);
void test_D1_032B(void);
void test_D1_032C(void);
void test_D1_032D(void);
void test_D1_032E(void);
void test_D1_032F(void);
void test_D1_0330(void);
void test_D1_0331(void);
void test_D1_0332(void);
void test_D1_0333(void);
void test_D1_0334(void);
void test_D1_0335(void);
void test_D1_0336(void);
void test_D1_0337(void);
void test_D1_0338(void);
void test_D1_0339(void);
void test_D1_033A(void);
void test_D1_033B(void);
void test_D1_033C(void);
void test_D1_033D(void);
void test_D1_033E(void);
void test_D1_033F(void);
void test_D1_0340(void);
void test_D1_0341(void);
void test_D1_0342(void);
void test_D1_0343(void);
void test_D1_0344(void);
void test_D1_0345(void);
void test_D1_0346(void);
void test_D1_0347(void);
void test_D1_0348(void);
void test_D1_0349(void);
void test_D1_034A(void);
void test_D1_034B(void);
void test_D1_034C(void);
void test_D1_034D(void);
void test_D1_034E(void);
void test_D1_034F(void);
void test_D1_0350(void);
void test_D1_0351(void);
void test_D1_0352(void);
void test_D1_0353(void);
void test_D1_0354(void);
void test_D1_0355(void);
void test_D1_0356(void);
void test_D1_0357(void);
void test_D1_0358(void);
void test_D1_0359(void);
void test_D1_035A(void);
void test_D1_035B(void);
void test_D1_035C(void);
void test_D1_035D(void);
void test_D1_035E(void);
void test_D1_035F(void);
void test_D1_0360(void);
void test_D1_0361(void);
void test_D1_0362(void);
void test_D1_0363(void);
void test_D1_0364(void);
void test_D1_0365(void);
void test_D1_0366(void);
void test_D1_0367(void);
void test_D1_0368(void);
void test_D1_0369(void);
void test_D1_036A(void);
void test_D1_036B(void);
void test_D1_036C(void);
void test_D1_036D(void);
void test_D1_036E(void);
void test_D1_036F(void);
void test_D1_0370(void);
void test_D1_0371(void);
void test_D1_0372(void);
void test_D1_0373(void);
void test_D1_0374(void);
void test_D1_0375(void);
void test_D1_0376(void);
void test_D1_0377(void);
void test_D1_0378(void);
void test_D1_0379(void);
void test_D1_037A(void);
void test_D1_037B(void);
void test_D1_037C(void);
void test_D1_037D(void);
void test_D1_037E(void);
void test_D1_037F(void);
void test_D1_0380(void);
void test_D1_0381(void);
void test_D1_0382(void);
void test_D1_0383(void);
void test_D1_0384(void);
void test_D1_0385(void);
void test_D1_0386(void);
void test_D1_0387(void);
void test_D1_0388(void);
void test_D1_0389(void);
void test_D1_038A(void);
void test_D1_038B(void);
void test_D1_038C(void);
void test_D1_038D(void);
void test_D1_038E(void);
void test_D1_038F(void);
void test_D1_0390(void);
void test_D1_0391(void);
void test_D1_0392(void);
void test_D1_0393(void);
void test_D1_0394(void);
void test_D1_0395(void);
void test_D1_0396(void);
void test_D1_0397(void);
void test_D1_0398(void);
void test_D1_0399(void);
void test_D1_039A(void);
void test_D1_039B(void);
void test_D1_039C(void);
void test_D1_039D(void);
void test_D1_039E(void);
void test_D1_039F(void);
void test_D1_03A0(void);
void test_D1_03A1(void);
void test_D1_03A2(void);
void test_D1_03A3(void);
void test_D1_03A4(void);
void test_D1_03A5(void);
void test_D1_03A6(void);
void test_D1_03A7(void);
void test_D1_03A8(void);
void test_D1_03A9(void);
void test_D1_03AA(void);
void test_D1_03AB(void);
void test_D1_03AC(void);
void test_D1_03AD(void);
void test_D1_03AE(void);
void test_D1_03AF(void);
void test_D1_03B0(void);
void test_D1_03B1(void);
void test_D1_03B2(void);
void test_D1_03B3(void);
void test_D1_03B4(void);
void test_D1_03B5(void);
void test_D1_03B6(void);
void test_D1_03B7(void);
void test_D1_03B8(void);
void test_D1_03B9(void);
void test_D1_03BA(void);
void test_D1_03BB(void);
void test_D1_03BC(void);
void test_D1_03BD(void);
void test_D1_03BE(void);
void test_D1_03BF(void);
void test_D1_03C0(void);
void test_D1_03C1(void);
void test_D1_03C2(void);
void test_D1_03C3(void);
void test_D1_03C4(void);
void test_D1_03C5(void);
void test_D1_03C6(void);
void test_D1_03C7(void);
void test_D1_03C8(void);
void test_D1_03C9(void);
void test_D1_03CA(void);
void test_D1_03CB(void);
void test_D1_03CC(void);
void test_D1_03CD(void);
void test_D1_03CE(void);
void test_D1_03CF(void);
void test_D1_03D0(void);
void test_D1_03D1(void);
void test_D1_03D2(void);
void test_D1_03D3(void);
void test_D1_03D4(void);
void test_D1_03D5(void);
void test_D1_03D6(void);
void test_D1_03D7(void);
void test_D1_03D8(void);
void test_D1_03D9(void);
void test_D1_03DA(void);
void test_D1_03DB(void);
void test_D1_03DC(void);
void test_D1_03DD(void);
void test_D1_03DE(void);
void test_D1_03DF(void);
void test_D1_03E0(void);
void test_D1_03E1(void);
void test_D1_03E2(void);
void test_D1_03E3(void);
void test_D1_03E4(void);
void test_D1_03E5(void);
void test_D1_03E6(void);
void test_D1_03E7(void);
TEST_LIST = {
    { "D1_0000", test_D1_0000 },
    { "D1_0001", test_D1_0001 },
    { "D1_0002", test_D1_0002 },
    { "D1_0003", test_D1_0003 },
    { "D1_0004", test_D1_0004 },
    { "D1_0005", test_D1_0005 },
    { "D1_0006", test_D1_0006 },
    { "D1_0007", test_D1_0007 },
    { "D1_0008", test_D1_0008 },
    { "D1_0009", test_D1_0009 },
    { "D1_000A", test_D1_000A },
    { "D1_000B", test_D1_000B },
    { "D1_000C", test_D1_000C },
    { "D1_000D", test_D1_000D },
    { "D1_000E", test_D1_000E },
    { "D1_000F", test_D1_000F },
    { "D1_0010", test_D1_0010 },
    { "D1_0011", test_D1_0011 },
    { "D1_0012", test_D1_0012 },
    { "D1_0013", test_D1_0013 },
    { "D1_0014", test_D1_0014 },
    { "D1_0015", test_D1_0015 },
    { "D1_0016", test_D1_0016 },
    { "D1_0017", test_D1_0017 },
    { "D1_0018", test_D1_0018 },
    { "D1_0019", test_D1_0019 },
    { "D1_001A", test_D1_001A },
    { "D1_001B", test_D1_001B },
    { "D1_001C", test_D1_001C },
    { "D1_001D", test_D1_001D },
    { "D1_001E", test_D1_001E },
    { "D1_001F", test_D1_001F },
    { "D1_0020", test_D1_0020 },
    { "D1_0021", test_D1_0021 },
    { "D1_0022", test_D1_0022 },
    { "D1_0023", test_D1_0023 },
    { "D1_0024", test_D1_0024 },
    { "D1_0025", test_D1_0025 },
    { "D1_0026", test_D1_0026 },
    { "D1_0027", test_D1_0027 },
    { "D1_0028", test_D1_0028 },
    { "D1_0029", test_D1_0029 },
    { "D1_002A", test_D1_002A },
    { "D1_002B", test_D1_002B },
    { "D1_002C", test_D1_002C },
    { "D1_002D", test_D1_002D },
    { "D1_002E", test_D1_002E },
    { "D1_002F", test_D1_002F },
    { "D1_0030", test_D1_0030 },
    { "D1_0031", test_D1_0031 },
    { "D1_0032", test_D1_0032 },
    { "D1_0033", test_D1_0033 },
    { "D1_0034", test_D1_0034 },
    { "D1_0035", test_D1_0035 },
    { "D1_0036", test_D1_0036 },
    { "D1_0037", test_D1_0037 },
    { "D1_0038", test_D1_0038 },
    { "D1_0039", test_D1_0039 },
    { "D1_003A", test_D1_003A },
    { "D1_003B", test_D1_003B },
    { "D1_003C", test_D1_003C },
    { "D1_003D", test_D1_003D },
    { "D1_003E", test_D1_003E },
    { "D1_003F", test_D1_003F },
    { "D1_0040", test_D1_0040 },
    { "D1_0041", test_D1_0041 },
    { "D1_0042", test_D1_0042 },
    { "D1_0043", test_D1_0043 },
    { "D1_0044", test_D1_0044 },
    { "D1_0045", test_D1_0045 },
    { "D1_0046", test_D1_0046 },
    { "D1_0047", test_D1_0047 },
    { "D1_0048", test_D1_0048 },
    { "D1_0049", test_D1_0049 },
    { "D1_004A", test_D1_004A },
    { "D1_004B", test_D1_004B },
    { "D1_004C", test_D1_004C },
    { "D1_004D", test_D1_004D },
    { "D1_004E", test_D1_004E },
    { "D1_004F", test_D1_004F },
    { "D1_0050", test_D1_0050 },
    { "D1_0051", test_D1_0051 },
    { "D1_0052", test_D1_0052 },
    { "D1_0053", test_D1_0053 },
    { "D1_0054", test_D1_0054 },
    { "D1_0055", test_D1_0055 },
    { "D1_0056", test_D1_0056 },
    { "D1_0057", test_D1_0057 },
    { "D1_0058", test_D1_0058 },
    { "D1_0059", test_D1_0059 },
    { "D1_005A", test_D1_005A },
    { "D1_005B", test_D1_005B },
    { "D1_005C", test_D1_005C },
    { "D1_005D", test_D1_005D },
    { "D1_005E", test_D1_005E },
    { "D1_005F", test_D1_005F },
    { "D1_0060", test_D1_0060 },
    { "D1_0061", test_D1_0061 },
    { "D1_0062", test_D1_0062 },
    { "D1_0063", test_D1_0063 },
    { "D1_0064", test_D1_0064 },
    { "D1_0065", test_D1_0065 },
    { "D1_0066", test_D1_0066 },
    { "D1_0067", test_D1_0067 },
    { "D1_0068", test_D1_0068 },
    { "D1_0069", test_D1_0069 },
    { "D1_006A", test_D1_006A },
    { "D1_006B", test_D1_006B },
    { "D1_006C", test_D1_006C },
    { "D1_006D", test_D1_006D },
    { "D1_006E", test_D1_006E },
    { "D1_006F", test_D1_006F },
    { "D1_0070", test_D1_0070 },
    { "D1_0071", test_D1_0071 },
    { "D1_0072", test_D1_0072 },
    { "D1_0073", test_D1_0073 },
    { "D1_0074", test_D1_0074 },
    { "D1_0075", test_D1_0075 },
    { "D1_0076", test_D1_0076 },
    { "D1_0077", test_D1_0077 },
    { "D1_0078", test_D1_0078 },
    { "D1_0079", test_D1_0079 },
    { "D1_007A", test_D1_007A },
    { "D1_007B", test_D1_007B },
    { "D1_007C", test_D1_007C },
    { "D1_007D", test_D1_007D },
    { "D1_007E", test_D1_007E },
    { "D1_007F", test_D1_007F },
    { "D1_0080", test_D1_0080 },
    { "D1_0081", test_D1_0081 },
    { "D1_0082", test_D1_0082 },
    { "D1_0083", test_D1_0083 },
    { "D1_0084", test_D1_0084 },
    { "D1_0085", test_D1_0085 },
    { "D1_0086", test_D1_0086 },
    { "D1_0087", test_D1_0087 },
    { "D1_0088", test_D1_0088 },
    { "D1_0089", test_D1_0089 },
    { "D1_008A", test_D1_008A },
    { "D1_008B", test_D1_008B },
    { "D1_008C", test_D1_008C },
    { "D1_008D", test_D1_008D },
    { "D1_008E", test_D1_008E },
    { "D1_008F", test_D1_008F },
    { "D1_0090", test_D1_0090 },
    { "D1_0091", test_D1_0091 },
    { "D1_0092", test_D1_0092 },
    { "D1_0093", test_D1_0093 },
    { "D1_0094", test_D1_0094 },
    { "D1_0095", test_D1_0095 },
    { "D1_0096", test_D1_0096 },
    { "D1_0097", test_D1_0097 },
    { "D1_0098", test_D1_0098 },
    { "D1_0099", test_D1_0099 },
    { "D1_009A", test_D1_009A },
    { "D1_009B", test_D1_009B },
    { "D1_009C", test_D1_009C },
    { "D1_009D", test_D1_009D },
    { "D1_009E", test_D1_009E },
    { "D1_009F", test_D1_009F },
    { "D1_00A0", test_D1_00A0 },
    { "D1_00A1", test_D1_00A1 },
    { "D1_00A2", test_D1_00A2 },
    { "D1_00A3", test_D1_00A3 },
    { "D1_00A4", test_D1_00A4 },
    { "D1_00A5", test_D1_00A5 },
    { "D1_00A6", test_D1_00A6 },
    { "D1_00A7", test_D1_00A7 },
    { "D1_00A8", test_D1_00A8 },
    { "D1_00A9", test_D1_00A9 },
    { "D1_00AA", test_D1_00AA },
    { "D1_00AB", test_D1_00AB },
    { "D1_00AC", test_D1_00AC },
    { "D1_00AD", test_D1_00AD },
    { "D1_00AE", test_D1_00AE },
    { "D1_00AF", test_D1_00AF },
    { "D1_00B0", test_D1_00B0 },
    { "D1_00B1", test_D1_00B1 },
    { "D1_00B2", test_D1_00B2 },
    { "D1_00B3", test_D1_00B3 },
    { "D1_00B4", test_D1_00B4 },
    { "D1_00B5", test_D1_00B5 },
    { "D1_00B6", test_D1_00B6 },
    { "D1_00B7", test_D1_00B7 },
    { "D1_00B8", test_D1_00B8 },
    { "D1_00B9", test_D1_00B9 },
    { "D1_00BA", test_D1_00BA },
    { "D1_00BB", test_D1_00BB },
    { "D1_00BC", test_D1_00BC },
    { "D1_00BD", test_D1_00BD },
    { "D1_00BE", test_D1_00BE },
    { "D1_00BF", test_D1_00BF },
    { "D1_00C0", test_D1_00C0 },
    { "D1_00C1", test_D1_00C1 },
    { "D1_00C2", test_D1_00C2 },
    { "D1_00C3", test_D1_00C3 },
    { "D1_00C4", test_D1_00C4 },
    { "D1_00C5", test_D1_00C5 },
    { "D1_00C6", test_D1_00C6 },
    { "D1_00C7", test_D1_00C7 },
    { "D1_00C8", test_D1_00C8 },
    { "D1_00C9", test_D1_00C9 },
    { "D1_00CA", test_D1_00CA },
    { "D1_00CB", test_D1_00CB },
    { "D1_00CC", test_D1_00CC },
    { "D1_00CD", test_D1_00CD },
    { "D1_00CE", test_D1_00CE },
    { "D1_00CF", test_D1_00CF },
    { "D1_00D0", test_D1_00D0 },
    { "D1_00D1", test_D1_00D1 },
    { "D1_00D2", test_D1_00D2 },
    { "D1_00D3", test_D1_00D3 },
    { "D1_00D4", test_D1_00D4 },
    { "D1_00D5", test_D1_00D5 },
    { "D1_00D6", test_D1_00D6 },
    { "D1_00D7", test_D1_00D7 },
    { "D1_00D8", test_D1_00D8 },
    { "D1_00D9", test_D1_00D9 },
    { "D1_00DA", test_D1_00DA },
    { "D1_00DB", test_D1_00DB },
    { "D1_00DC", test_D1_00DC },
    { "D1_00DD", test_D1_00DD },
    { "D1_00DE", test_D1_00DE },
    { "D1_00DF", test_D1_00DF },
    { "D1_00E0", test_D1_00E0 },
    { "D1_00E1", test_D1_00E1 },
    { "D1_00E2", test_D1_00E2 },
    { "D1_00E3", test_D1_00E3 },
    { "D1_00E4", test_D1_00E4 },
    { "D1_00E5", test_D1_00E5 },
    { "D1_00E6", test_D1_00E6 },
    { "D1_00E7", test_D1_00E7 },
    { "D1_00E8", test_D1_00E8 },
    { "D1_00E9", test_D1_00E9 },
    { "D1_00EA", test_D1_00EA },
    { "D1_00EB", test_D1_00EB },
    { "D1_00EC", test_D1_00EC },
    { "D1_00ED", test_D1_00ED },
    { "D1_00EE", test_D1_00EE },
    { "D1_00EF", test_D1_00EF },
    { "D1_00F0", test_D1_00F0 },
    { "D1_00F1", test_D1_00F1 },
    { "D1_00F2", test_D1_00F2 },
    { "D1_00F3", test_D1_00F3 },
    { "D1_00F4", test_D1_00F4 },
    { "D1_00F5", test_D1_00F5 },
    { "D1_00F6", test_D1_00F6 },
    { "D1_00F7", test_D1_00F7 },
    { "D1_00F8", test_D1_00F8 },
    { "D1_00F9", test_D1_00F9 },
    { "D1_00FA", test_D1_00FA },
    { "D1_00FB", test_D1_00FB },
    { "D1_00FC", test_D1_00FC },
    { "D1_00FD", test_D1_00FD },
    { "D1_00FE", test_D1_00FE },
    { "D1_00FF", test_D1_00FF },
    { "D1_0100", test_D1_0100 },
    { "D1_0101", test_D1_0101 },
    { "D1_0102", test_D1_0102 },
    { "D1_0103", test_D1_0103 },
    { "D1_0104", test_D1_0104 },
    { "D1_0105", test_D1_0105 },
    { "D1_0106", test_D1_0106 },
    { "D1_0107", test_D1_0107 },
    { "D1_0108", test_D1_0108 },
    { "D1_0109", test_D1_0109 },
    { "D1_010A", test_D1_010A },
    { "D1_010B", test_D1_010B },
    { "D1_010C", test_D1_010C },
    { "D1_010D", test_D1_010D },
    { "D1_010E", test_D1_010E },
    { "D1_010F", test_D1_010F },
    { "D1_0110", test_D1_0110 },
    { "D1_0111", test_D1_0111 },
    { "D1_0112", test_D1_0112 },
    { "D1_0113", test_D1_0113 },
    { "D1_0114", test_D1_0114 },
    { "D1_0115", test_D1_0115 },
    { "D1_0116", test_D1_0116 },
    { "D1_0117", test_D1_0117 },
    { "D1_0118", test_D1_0118 },
    { "D1_0119", test_D1_0119 },
    { "D1_011A", test_D1_011A },
    { "D1_011B", test_D1_011B },
    { "D1_011C", test_D1_011C },
    { "D1_011D", test_D1_011D },
    { "D1_011E", test_D1_011E },
    { "D1_011F", test_D1_011F },
    { "D1_0120", test_D1_0120 },
    { "D1_0121", test_D1_0121 },
    { "D1_0122", test_D1_0122 },
    { "D1_0123", test_D1_0123 },
    { "D1_0124", test_D1_0124 },
    { "D1_0125", test_D1_0125 },
    { "D1_0126", test_D1_0126 },
    { "D1_0127", test_D1_0127 },
    { "D1_0128", test_D1_0128 },
    { "D1_0129", test_D1_0129 },
    { "D1_012A", test_D1_012A },
    { "D1_012B", test_D1_012B },
    { "D1_012C", test_D1_012C },
    { "D1_012D", test_D1_012D },
    { "D1_012E", test_D1_012E },
    { "D1_012F", test_D1_012F },
    { "D1_0130", test_D1_0130 },
    { "D1_0131", test_D1_0131 },
    { "D1_0132", test_D1_0132 },
    { "D1_0133", test_D1_0133 },
    { "D1_0134", test_D1_0134 },
    { "D1_0135", test_D1_0135 },
    { "D1_0136", test_D1_0136 },
    { "D1_0137", test_D1_0137 },
    { "D1_0138", test_D1_0138 },
    { "D1_0139", test_D1_0139 },
    { "D1_013A", test_D1_013A },
    { "D1_013B", test_D1_013B },
    { "D1_013C", test_D1_013C },
    { "D1_013D", test_D1_013D },
    { "D1_013E", test_D1_013E },
    { "D1_013F", test_D1_013F },
    { "D1_0140", test_D1_0140 },
    { "D1_0141", test_D1_0141 },
    { "D1_0142", test_D1_0142 },
    { "D1_0143", test_D1_0143 },
    { "D1_0144", test_D1_0144 },
    { "D1_0145", test_D1_0145 },
    { "D1_0146", test_D1_0146 },
    { "D1_0147", test_D1_0147 },
    { "D1_0148", test_D1_0148 },
    { "D1_0149", test_D1_0149 },
    { "D1_014A", test_D1_014A },
    { "D1_014B", test_D1_014B },
    { "D1_014C", test_D1_014C },
    { "D1_014D", test_D1_014D },
    { "D1_014E", test_D1_014E },
    { "D1_014F", test_D1_014F },
    { "D1_0150", test_D1_0150 },
    { "D1_0151", test_D1_0151 },
    { "D1_0152", test_D1_0152 },
    { "D1_0153", test_D1_0153 },
    { "D1_0154", test_D1_0154 },
    { "D1_0155", test_D1_0155 },
    { "D1_0156", test_D1_0156 },
    { "D1_0157", test_D1_0157 },
    { "D1_0158", test_D1_0158 },
    { "D1_0159", test_D1_0159 },
    { "D1_015A", test_D1_015A },
    { "D1_015B", test_D1_015B },
    { "D1_015C", test_D1_015C },
    { "D1_015D", test_D1_015D },
    { "D1_015E", test_D1_015E },
    { "D1_015F", test_D1_015F },
    { "D1_0160", test_D1_0160 },
    { "D1_0161", test_D1_0161 },
    { "D1_0162", test_D1_0162 },
    { "D1_0163", test_D1_0163 },
    { "D1_0164", test_D1_0164 },
    { "D1_0165", test_D1_0165 },
    { "D1_0166", test_D1_0166 },
    { "D1_0167", test_D1_0167 },
    { "D1_0168", test_D1_0168 },
    { "D1_0169", test_D1_0169 },
    { "D1_016A", test_D1_016A },
    { "D1_016B", test_D1_016B },
    { "D1_016C", test_D1_016C },
    { "D1_016D", test_D1_016D },
    { "D1_016E", test_D1_016E },
    { "D1_016F", test_D1_016F },
    { "D1_0170", test_D1_0170 },
    { "D1_0171", test_D1_0171 },
    { "D1_0172", test_D1_0172 },
    { "D1_0173", test_D1_0173 },
    { "D1_0174", test_D1_0174 },
    { "D1_0175", test_D1_0175 },
    { "D1_0176", test_D1_0176 },
    { "D1_0177", test_D1_0177 },
    { "D1_0178", test_D1_0178 },
    { "D1_0179", test_D1_0179 },
    { "D1_017A", test_D1_017A },
    { "D1_017B", test_D1_017B },
    { "D1_017C", test_D1_017C },
    { "D1_017D", test_D1_017D },
    { "D1_017E", test_D1_017E },
    { "D1_017F", test_D1_017F },
    { "D1_0180", test_D1_0180 },
    { "D1_0181", test_D1_0181 },
    { "D1_0182", test_D1_0182 },
    { "D1_0183", test_D1_0183 },
    { "D1_0184", test_D1_0184 },
    { "D1_0185", test_D1_0185 },
    { "D1_0186", test_D1_0186 },
    { "D1_0187", test_D1_0187 },
    { "D1_0188", test_D1_0188 },
    { "D1_0189", test_D1_0189 },
    { "D1_018A", test_D1_018A },
    { "D1_018B", test_D1_018B },
    { "D1_018C", test_D1_018C },
    { "D1_018D", test_D1_018D },
    { "D1_018E", test_D1_018E },
    { "D1_018F", test_D1_018F },
    { "D1_0190", test_D1_0190 },
    { "D1_0191", test_D1_0191 },
    { "D1_0192", test_D1_0192 },
    { "D1_0193", test_D1_0193 },
    { "D1_0194", test_D1_0194 },
    { "D1_0195", test_D1_0195 },
    { "D1_0196", test_D1_0196 },
    { "D1_0197", test_D1_0197 },
    { "D1_0198", test_D1_0198 },
    { "D1_0199", test_D1_0199 },
    { "D1_019A", test_D1_019A },
    { "D1_019B", test_D1_019B },
    { "D1_019C", test_D1_019C },
    { "D1_019D", test_D1_019D },
    { "D1_019E", test_D1_019E },
    { "D1_019F", test_D1_019F },
    { "D1_01A0", test_D1_01A0 },
    { "D1_01A1", test_D1_01A1 },
    { "D1_01A2", test_D1_01A2 },
    { "D1_01A3", test_D1_01A3 },
    { "D1_01A4", test_D1_01A4 },
    { "D1_01A5", test_D1_01A5 },
    { "D1_01A6", test_D1_01A6 },
    { "D1_01A7", test_D1_01A7 },
    { "D1_01A8", test_D1_01A8 },
    { "D1_01A9", test_D1_01A9 },
    { "D1_01AA", test_D1_01AA },
    { "D1_01AB", test_D1_01AB },
    { "D1_01AC", test_D1_01AC },
    { "D1_01AD", test_D1_01AD },
    { "D1_01AE", test_D1_01AE },
    { "D1_01AF", test_D1_01AF },
    { "D1_01B0", test_D1_01B0 },
    { "D1_01B1", test_D1_01B1 },
    { "D1_01B2", test_D1_01B2 },
    { "D1_01B3", test_D1_01B3 },
    { "D1_01B4", test_D1_01B4 },
    { "D1_01B5", test_D1_01B5 },
    { "D1_01B6", test_D1_01B6 },
    { "D1_01B7", test_D1_01B7 },
    { "D1_01B8", test_D1_01B8 },
    { "D1_01B9", test_D1_01B9 },
    { "D1_01BA", test_D1_01BA },
    { "D1_01BB", test_D1_01BB },
    { "D1_01BC", test_D1_01BC },
    { "D1_01BD", test_D1_01BD },
    { "D1_01BE", test_D1_01BE },
    { "D1_01BF", test_D1_01BF },
    { "D1_01C0", test_D1_01C0 },
    { "D1_01C1", test_D1_01C1 },
    { "D1_01C2", test_D1_01C2 },
    { "D1_01C3", test_D1_01C3 },
    { "D1_01C4", test_D1_01C4 },
    { "D1_01C5", test_D1_01C5 },
    { "D1_01C6", test_D1_01C6 },
    { "D1_01C7", test_D1_01C7 },
    { "D1_01C8", test_D1_01C8 },
    { "D1_01C9", test_D1_01C9 },
    { "D1_01CA", test_D1_01CA },
    { "D1_01CB", test_D1_01CB },
    { "D1_01CC", test_D1_01CC },
    { "D1_01CD", test_D1_01CD },
    { "D1_01CE", test_D1_01CE },
    { "D1_01CF", test_D1_01CF },
    { "D1_01D0", test_D1_01D0 },
    { "D1_01D1", test_D1_01D1 },
    { "D1_01D2", test_D1_01D2 },
    { "D1_01D3", test_D1_01D3 },
    { "D1_01D4", test_D1_01D4 },
    { "D1_01D5", test_D1_01D5 },
    { "D1_01D6", test_D1_01D6 },
    { "D1_01D7", test_D1_01D7 },
    { "D1_01D8", test_D1_01D8 },
    { "D1_01D9", test_D1_01D9 },
    { "D1_01DA", test_D1_01DA },
    { "D1_01DB", test_D1_01DB },
    { "D1_01DC", test_D1_01DC },
    { "D1_01DD", test_D1_01DD },
    { "D1_01DE", test_D1_01DE },
    { "D1_01DF", test_D1_01DF },
    { "D1_01E0", test_D1_01E0 },
    { "D1_01E1", test_D1_01E1 },
    { "D1_01E2", test_D1_01E2 },
    { "D1_01E3", test_D1_01E3 },
    { "D1_01E4", test_D1_01E4 },
    { "D1_01E5", test_D1_01E5 },
    { "D1_01E6", test_D1_01E6 },
    { "D1_01E7", test_D1_01E7 },
    { "D1_01E8", test_D1_01E8 },
    { "D1_01E9", test_D1_01E9 },
    { "D1_01EA", test_D1_01EA },
    { "D1_01EB", test_D1_01EB },
    { "D1_01EC", test_D1_01EC },
    { "D1_01ED", test_D1_01ED },
    { "D1_01EE", test_D1_01EE },
    { "D1_01EF", test_D1_01EF },
    { "D1_01F0", test_D1_01F0 },
    { "D1_01F1", test_D1_01F1 },
    { "D1_01F2", test_D1_01F2 },
    { "D1_01F3", test_D1_01F3 },
    { "D1_01F4", test_D1_01F4 },
    { "D1_01F5", test_D1_01F5 },
    { "D1_01F6", test_D1_01F6 },
    { "D1_01F7", test_D1_01F7 },
    { "D1_01F8", test_D1_01F8 },
    { "D1_01F9", test_D1_01F9 },
    { "D1_01FA", test_D1_01FA },
    { "D1_01FB", test_D1_01FB },
    { "D1_01FC", test_D1_01FC },
    { "D1_01FD", test_D1_01FD },
    { "D1_01FE", test_D1_01FE },
    { "D1_01FF", test_D1_01FF },
    { "D1_0200", test_D1_0200 },
    { "D1_0201", test_D1_0201 },
    { "D1_0202", test_D1_0202 },
    { "D1_0203", test_D1_0203 },
    { "D1_0204", test_D1_0204 },
    { "D1_0205", test_D1_0205 },
    { "D1_0206", test_D1_0206 },
    { "D1_0207", test_D1_0207 },
    { "D1_0208", test_D1_0208 },
    { "D1_0209", test_D1_0209 },
    { "D1_020A", test_D1_020A },
    { "D1_020B", test_D1_020B },
    { "D1_020C", test_D1_020C },
    { "D1_020D", test_D1_020D },
    { "D1_020E", test_D1_020E },
    { "D1_020F", test_D1_020F },
    { "D1_0210", test_D1_0210 },
    { "D1_0211", test_D1_0211 },
    { "D1_0212", test_D1_0212 },
    { "D1_0213", test_D1_0213 },
    { "D1_0214", test_D1_0214 },
    { "D1_0215", test_D1_0215 },
    { "D1_0216", test_D1_0216 },
    { "D1_0217", test_D1_0217 },
    { "D1_0218", test_D1_0218 },
    { "D1_0219", test_D1_0219 },
    { "D1_021A", test_D1_021A },
    { "D1_021B", test_D1_021B },
    { "D1_021C", test_D1_021C },
    { "D1_021D", test_D1_021D },
    { "D1_021E", test_D1_021E },
    { "D1_021F", test_D1_021F },
    { "D1_0220", test_D1_0220 },
    { "D1_0221", test_D1_0221 },
    { "D1_0222", test_D1_0222 },
    { "D1_0223", test_D1_0223 },
    { "D1_0224", test_D1_0224 },
    { "D1_0225", test_D1_0225 },
    { "D1_0226", test_D1_0226 },
    { "D1_0227", test_D1_0227 },
    { "D1_0228", test_D1_0228 },
    { "D1_0229", test_D1_0229 },
    { "D1_022A", test_D1_022A },
    { "D1_022B", test_D1_022B },
    { "D1_022C", test_D1_022C },
    { "D1_022D", test_D1_022D },
    { "D1_022E", test_D1_022E },
    { "D1_022F", test_D1_022F },
    { "D1_0230", test_D1_0230 },
    { "D1_0231", test_D1_0231 },
    { "D1_0232", test_D1_0232 },
    { "D1_0233", test_D1_0233 },
    { "D1_0234", test_D1_0234 },
    { "D1_0235", test_D1_0235 },
    { "D1_0236", test_D1_0236 },
    { "D1_0237", test_D1_0237 },
    { "D1_0238", test_D1_0238 },
    { "D1_0239", test_D1_0239 },
    { "D1_023A", test_D1_023A },
    { "D1_023B", test_D1_023B },
    { "D1_023C", test_D1_023C },
    { "D1_023D", test_D1_023D },
    { "D1_023E", test_D1_023E },
    { "D1_023F", test_D1_023F },
    { "D1_0240", test_D1_0240 },
    { "D1_0241", test_D1_0241 },
    { "D1_0242", test_D1_0242 },
    { "D1_0243", test_D1_0243 },
    { "D1_0244", test_D1_0244 },
    { "D1_0245", test_D1_0245 },
    { "D1_0246", test_D1_0246 },
    { "D1_0247", test_D1_0247 },
    { "D1_0248", test_D1_0248 },
    { "D1_0249", test_D1_0249 },
    { "D1_024A", test_D1_024A },
    { "D1_024B", test_D1_024B },
    { "D1_024C", test_D1_024C },
    { "D1_024D", test_D1_024D },
    { "D1_024E", test_D1_024E },
    { "D1_024F", test_D1_024F },
    { "D1_0250", test_D1_0250 },
    { "D1_0251", test_D1_0251 },
    { "D1_0252", test_D1_0252 },
    { "D1_0253", test_D1_0253 },
    { "D1_0254", test_D1_0254 },
    { "D1_0255", test_D1_0255 },
    { "D1_0256", test_D1_0256 },
    { "D1_0257", test_D1_0257 },
    { "D1_0258", test_D1_0258 },
    { "D1_0259", test_D1_0259 },
    { "D1_025A", test_D1_025A },
    { "D1_025B", test_D1_025B },
    { "D1_025C", test_D1_025C },
    { "D1_025D", test_D1_025D },
    { "D1_025E", test_D1_025E },
    { "D1_025F", test_D1_025F },
    { "D1_0260", test_D1_0260 },
    { "D1_0261", test_D1_0261 },
    { "D1_0262", test_D1_0262 },
    { "D1_0263", test_D1_0263 },
    { "D1_0264", test_D1_0264 },
    { "D1_0265", test_D1_0265 },
    { "D1_0266", test_D1_0266 },
    { "D1_0267", test_D1_0267 },
    { "D1_0268", test_D1_0268 },
    { "D1_0269", test_D1_0269 },
    { "D1_026A", test_D1_026A },
    { "D1_026B", test_D1_026B },
    { "D1_026C", test_D1_026C },
    { "D1_026D", test_D1_026D },
    { "D1_026E", test_D1_026E },
    { "D1_026F", test_D1_026F },
    { "D1_0270", test_D1_0270 },
    { "D1_0271", test_D1_0271 },
    { "D1_0272", test_D1_0272 },
    { "D1_0273", test_D1_0273 },
    { "D1_0274", test_D1_0274 },
    { "D1_0275", test_D1_0275 },
    { "D1_0276", test_D1_0276 },
    { "D1_0277", test_D1_0277 },
    { "D1_0278", test_D1_0278 },
    { "D1_0279", test_D1_0279 },
    { "D1_027A", test_D1_027A },
    { "D1_027B", test_D1_027B },
    { "D1_027C", test_D1_027C },
    { "D1_027D", test_D1_027D },
    { "D1_027E", test_D1_027E },
    { "D1_027F", test_D1_027F },
    { "D1_0280", test_D1_0280 },
    { "D1_0281", test_D1_0281 },
    { "D1_0282", test_D1_0282 },
    { "D1_0283", test_D1_0283 },
    { "D1_0284", test_D1_0284 },
    { "D1_0285", test_D1_0285 },
    { "D1_0286", test_D1_0286 },
    { "D1_0287", test_D1_0287 },
    { "D1_0288", test_D1_0288 },
    { "D1_0289", test_D1_0289 },
    { "D1_028A", test_D1_028A },
    { "D1_028B", test_D1_028B },
    { "D1_028C", test_D1_028C },
    { "D1_028D", test_D1_028D },
    { "D1_028E", test_D1_028E },
    { "D1_028F", test_D1_028F },
    { "D1_0290", test_D1_0290 },
    { "D1_0291", test_D1_0291 },
    { "D1_0292", test_D1_0292 },
    { "D1_0293", test_D1_0293 },
    { "D1_0294", test_D1_0294 },
    { "D1_0295", test_D1_0295 },
    { "D1_0296", test_D1_0296 },
    { "D1_0297", test_D1_0297 },
    { "D1_0298", test_D1_0298 },
    { "D1_0299", test_D1_0299 },
    { "D1_029A", test_D1_029A },
    { "D1_029B", test_D1_029B },
    { "D1_029C", test_D1_029C },
    { "D1_029D", test_D1_029D },
    { "D1_029E", test_D1_029E },
    { "D1_029F", test_D1_029F },
    { "D1_02A0", test_D1_02A0 },
    { "D1_02A1", test_D1_02A1 },
    { "D1_02A2", test_D1_02A2 },
    { "D1_02A3", test_D1_02A3 },
    { "D1_02A4", test_D1_02A4 },
    { "D1_02A5", test_D1_02A5 },
    { "D1_02A6", test_D1_02A6 },
    { "D1_02A7", test_D1_02A7 },
    { "D1_02A8", test_D1_02A8 },
    { "D1_02A9", test_D1_02A9 },
    { "D1_02AA", test_D1_02AA },
    { "D1_02AB", test_D1_02AB },
    { "D1_02AC", test_D1_02AC },
    { "D1_02AD", test_D1_02AD },
    { "D1_02AE", test_D1_02AE },
    { "D1_02AF", test_D1_02AF },
    { "D1_02B0", test_D1_02B0 },
    { "D1_02B1", test_D1_02B1 },
    { "D1_02B2", test_D1_02B2 },
    { "D1_02B3", test_D1_02B3 },
    { "D1_02B4", test_D1_02B4 },
    { "D1_02B5", test_D1_02B5 },
    { "D1_02B6", test_D1_02B6 },
    { "D1_02B7", test_D1_02B7 },
    { "D1_02B8", test_D1_02B8 },
    { "D1_02B9", test_D1_02B9 },
    { "D1_02BA", test_D1_02BA },
    { "D1_02BB", test_D1_02BB },
    { "D1_02BC", test_D1_02BC },
    { "D1_02BD", test_D1_02BD },
    { "D1_02BE", test_D1_02BE },
    { "D1_02BF", test_D1_02BF },
    { "D1_02C0", test_D1_02C0 },
    { "D1_02C1", test_D1_02C1 },
    { "D1_02C2", test_D1_02C2 },
    { "D1_02C3", test_D1_02C3 },
    { "D1_02C4", test_D1_02C4 },
    { "D1_02C5", test_D1_02C5 },
    { "D1_02C6", test_D1_02C6 },
    { "D1_02C7", test_D1_02C7 },
    { "D1_02C8", test_D1_02C8 },
    { "D1_02C9", test_D1_02C9 },
    { "D1_02CA", test_D1_02CA },
    { "D1_02CB", test_D1_02CB },
    { "D1_02CC", test_D1_02CC },
    { "D1_02CD", test_D1_02CD },
    { "D1_02CE", test_D1_02CE },
    { "D1_02CF", test_D1_02CF },
    { "D1_02D0", test_D1_02D0 },
    { "D1_02D1", test_D1_02D1 },
    { "D1_02D2", test_D1_02D2 },
    { "D1_02D3", test_D1_02D3 },
    { "D1_02D4", test_D1_02D4 },
    { "D1_02D5", test_D1_02D5 },
    { "D1_02D6", test_D1_02D6 },
    { "D1_02D7", test_D1_02D7 },
    { "D1_02D8", test_D1_02D8 },
    { "D1_02D9", test_D1_02D9 },
    { "D1_02DA", test_D1_02DA },
    { "D1_02DB", test_D1_02DB },
    { "D1_02DC", test_D1_02DC },
    { "D1_02DD", test_D1_02DD },
    { "D1_02DE", test_D1_02DE },
    { "D1_02DF", test_D1_02DF },
    { "D1_02E0", test_D1_02E0 },
    { "D1_02E1", test_D1_02E1 },
    { "D1_02E2", test_D1_02E2 },
    { "D1_02E3", test_D1_02E3 },
    { "D1_02E4", test_D1_02E4 },
    { "D1_02E5", test_D1_02E5 },
    { "D1_02E6", test_D1_02E6 },
    { "D1_02E7", test_D1_02E7 },
    { "D1_02E8", test_D1_02E8 },
    { "D1_02E9", test_D1_02E9 },
    { "D1_02EA", test_D1_02EA },
    { "D1_02EB", test_D1_02EB },
    { "D1_02EC", test_D1_02EC },
    { "D1_02ED", test_D1_02ED },
    { "D1_02EE", test_D1_02EE },
    { "D1_02EF", test_D1_02EF },
    { "D1_02F0", test_D1_02F0 },
    { "D1_02F1", test_D1_02F1 },
    { "D1_02F2", test_D1_02F2 },
    { "D1_02F3", test_D1_02F3 },
    { "D1_02F4", test_D1_02F4 },
    { "D1_02F5", test_D1_02F5 },
    { "D1_02F6", test_D1_02F6 },
    { "D1_02F7", test_D1_02F7 },
    { "D1_02F8", test_D1_02F8 },
    { "D1_02F9", test_D1_02F9 },
    { "D1_02FA", test_D1_02FA },
    { "D1_02FB", test_D1_02FB },
    { "D1_02FC", test_D1_02FC },
    { "D1_02FD", test_D1_02FD },
    { "D1_02FE", test_D1_02FE },
    { "D1_02FF", test_D1_02FF },
    { "D1_0300", test_D1_0300 },
    { "D1_0301", test_D1_0301 },
    { "D1_0302", test_D1_0302 },
    { "D1_0303", test_D1_0303 },
    { "D1_0304", test_D1_0304 },
    { "D1_0305", test_D1_0305 },
    { "D1_0306", test_D1_0306 },
    { "D1_0307", test_D1_0307 },
    { "D1_0308", test_D1_0308 },
    { "D1_0309", test_D1_0309 },
    { "D1_030A", test_D1_030A },
    { "D1_030B", test_D1_030B },
    { "D1_030C", test_D1_030C },
    { "D1_030D", test_D1_030D },
    { "D1_030E", test_D1_030E },
    { "D1_030F", test_D1_030F },
    { "D1_0310", test_D1_0310 },
    { "D1_0311", test_D1_0311 },
    { "D1_0312", test_D1_0312 },
    { "D1_0313", test_D1_0313 },
    { "D1_0314", test_D1_0314 },
    { "D1_0315", test_D1_0315 },
    { "D1_0316", test_D1_0316 },
    { "D1_0317", test_D1_0317 },
    { "D1_0318", test_D1_0318 },
    { "D1_0319", test_D1_0319 },
    { "D1_031A", test_D1_031A },
    { "D1_031B", test_D1_031B },
    { "D1_031C", test_D1_031C },
    { "D1_031D", test_D1_031D },
    { "D1_031E", test_D1_031E },
    { "D1_031F", test_D1_031F },
    { "D1_0320", test_D1_0320 },
    { "D1_0321", test_D1_0321 },
    { "D1_0322", test_D1_0322 },
    { "D1_0323", test_D1_0323 },
    { "D1_0324", test_D1_0324 },
    { "D1_0325", test_D1_0325 },
    { "D1_0326", test_D1_0326 },
    { "D1_0327", test_D1_0327 },
    { "D1_0328", test_D1_0328 },
    { "D1_0329", test_D1_0329 },
    { "D1_032A", test_D1_032A },
    { "D1_032B", test_D1_032B },
    { "D1_032C", test_D1_032C },
    { "D1_032D", test_D1_032D },
    { "D1_032E", test_D1_032E },
    { "D1_032F", test_D1_032F },
    { "D1_0330", test_D1_0330 },
    { "D1_0331", test_D1_0331 },
    { "D1_0332", test_D1_0332 },
    { "D1_0333", test_D1_0333 },
    { "D1_0334", test_D1_0334 },
    { "D1_0335", test_D1_0335 },
    { "D1_0336", test_D1_0336 },
    { "D1_0337", test_D1_0337 },
    { "D1_0338", test_D1_0338 },
    { "D1_0339", test_D1_0339 },
    { "D1_033A", test_D1_033A },
    { "D1_033B", test_D1_033B },
    { "D1_033C", test_D1_033C },
    { "D1_033D", test_D1_033D },
    { "D1_033E", test_D1_033E },
    { "D1_033F", test_D1_033F },
    { "D1_0340", test_D1_0340 },
    { "D1_0341", test_D1_0341 },
    { "D1_0342", test_D1_0342 },
    { "D1_0343", test_D1_0343 },
    { "D1_0344", test_D1_0344 },
    { "D1_0345", test_D1_0345 },
    { "D1_0346", test_D1_0346 },
    { "D1_0347", test_D1_0347 },
    { "D1_0348", test_D1_0348 },
    { "D1_0349", test_D1_0349 },
    { "D1_034A", test_D1_034A },
    { "D1_034B", test_D1_034B },
    { "D1_034C", test_D1_034C },
    { "D1_034D", test_D1_034D },
    { "D1_034E", test_D1_034E },
    { "D1_034F", test_D1_034F },
    { "D1_0350", test_D1_0350 },
    { "D1_0351", test_D1_0351 },
    { "D1_0352", test_D1_0352 },
    { "D1_0353", test_D1_0353 },
    { "D1_0354", test_D1_0354 },
    { "D1_0355", test_D1_0355 },
    { "D1_0356", test_D1_0356 },
    { "D1_0357", test_D1_0357 },
    { "D1_0358", test_D1_0358 },
    { "D1_0359", test_D1_0359 },
    { "D1_035A", test_D1_035A },
    { "D1_035B", test_D1_035B },
    { "D1_035C", test_D1_035C },
    { "D1_035D", test_D1_035D },
    { "D1_035E", test_D1_035E },
    { "D1_035F", test_D1_035F },
    { "D1_0360", test_D1_0360 },
    { "D1_0361", test_D1_0361 },
    { "D1_0362", test_D1_0362 },
    { "D1_0363", test_D1_0363 },
    { "D1_0364", test_D1_0364 },
    { "D1_0365", test_D1_0365 },
    { "D1_0366", test_D1_0366 },
    { "D1_0367", test_D1_0367 },
    { "D1_0368", test_D1_0368 },
    { "D1_0369", test_D1_0369 },
    { "D1_036A", test_D1_036A },
    { "D1_036B", test_D1_036B },
    { "D1_036C", test_D1_036C },
    { "D1_036D", test_D1_036D },
    { "D1_036E", test_D1_036E },
    { "D1_036F", test_D1_036F },
    { "D1_0370", test_D1_0370 },
    { "D1_0371", test_D1_0371 },
    { "D1_0372", test_D1_0372 },
    { "D1_0373", test_D1_0373 },
    { "D1_0374", test_D1_0374 },
    { "D1_0375", test_D1_0375 },
    { "D1_0376", test_D1_0376 },
    { "D1_0377", test_D1_0377 },
    { "D1_0378", test_D1_0378 },
    { "D1_0379", test_D1_0379 },
    { "D1_037A", test_D1_037A },
    { "D1_037B", test_D1_037B },
    { "D1_037C", test_D1_037C },
    { "D1_037D", test_D1_037D },
    { "D1_037E", test_D1_037E },
    { "D1_037F", test_D1_037F },
    { "D1_0380", test_D1_0380 },
    { "D1_0381", test_D1_0381 },
    { "D1_0382", test_D1_0382 },
    { "D1_0383", test_D1_0383 },
    { "D1_0384", test_D1_0384 },
    { "D1_0385", test_D1_0385 },
    { "D1_0386", test_D1_0386 },
    { "D1_0387", test_D1_0387 },
    { "D1_0388", test_D1_0388 },
    { "D1_0389", test_D1_0389 },
    { "D1_038A", test_D1_038A },
    { "D1_038B", test_D1_038B },
    { "D1_038C", test_D1_038C },
    { "D1_038D", test_D1_038D },
    { "D1_038E", test_D1_038E },
    { "D1_038F", test_D1_038F },
    { "D1_0390", test_D1_0390 },
    { "D1_0391", test_D1_0391 },
    { "D1_0392", test_D1_0392 },
    { "D1_0393", test_D1_0393 },
    { "D1_0394", test_D1_0394 },
    { "D1_0395", test_D1_0395 },
    { "D1_0396", test_D1_0396 },
    { "D1_0397", test_D1_0397 },
    { "D1_0398", test_D1_0398 },
    { "D1_0399", test_D1_0399 },
    { "D1_039A", test_D1_039A },
    { "D1_039B", test_D1_039B },
    { "D1_039C", test_D1_039C },
    { "D1_039D", test_D1_039D },
    { "D1_039E", test_D1_039E },
    { "D1_039F", test_D1_039F },
    { "D1_03A0", test_D1_03A0 },
    { "D1_03A1", test_D1_03A1 },
    { "D1_03A2", test_D1_03A2 },
    { "D1_03A3", test_D1_03A3 },
    { "D1_03A4", test_D1_03A4 },
    { "D1_03A5", test_D1_03A5 },
    { "D1_03A6", test_D1_03A6 },
    { "D1_03A7", test_D1_03A7 },
    { "D1_03A8", test_D1_03A8 },
    { "D1_03A9", test_D1_03A9 },
    { "D1_03AA", test_D1_03AA },
    { "D1_03AB", test_D1_03AB },
    { "D1_03AC", test_D1_03AC },
    { "D1_03AD", test_D1_03AD },
    { "D1_03AE", test_D1_03AE },
    { "D1_03AF", test_D1_03AF },
    { "D1_03B0", test_D1_03B0 },
    { "D1_03B1", test_D1_03B1 },
    { "D1_03B2", test_D1_03B2 },
    { "D1_03B3", test_D1_03B3 },
    { "D1_03B4", test_D1_03B4 },
    { "D1_03B5", test_D1_03B5 },
    { "D1_03B6", test_D1_03B6 },
    { "D1_03B7", test_D1_03B7 },
    { "D1_03B8", test_D1_03B8 },
    { "D1_03B9", test_D1_03B9 },
    { "D1_03BA", test_D1_03BA },
    { "D1_03BB", test_D1_03BB },
    { "D1_03BC", test_D1_03BC },
    { "D1_03BD", test_D1_03BD },
    { "D1_03BE", test_D1_03BE },
    { "D1_03BF", test_D1_03BF },
    { "D1_03C0", test_D1_03C0 },
    { "D1_03C1", test_D1_03C1 },
    { "D1_03C2", test_D1_03C2 },
    { "D1_03C3", test_D1_03C3 },
    { "D1_03C4", test_D1_03C4 },
    { "D1_03C5", test_D1_03C5 },
    { "D1_03C6", test_D1_03C6 },
    { "D1_03C7", test_D1_03C7 },
    { "D1_03C8", test_D1_03C8 },
    { "D1_03C9", test_D1_03C9 },
    { "D1_03CA", test_D1_03CA },
    { "D1_03CB", test_D1_03CB },
    { "D1_03CC", test_D1_03CC },
    { "D1_03CD", test_D1_03CD },
    { "D1_03CE", test_D1_03CE },
    { "D1_03CF", test_D1_03CF },
    { "D1_03D0", test_D1_03D0 },
    { "D1_03D1", test_D1_03D1 },
    { "D1_03D2", test_D1_03D2 },
    { "D1_03D3", test_D1_03D3 },
    { "D1_03D4", test_D1_03D4 },
    { "D1_03D5", test_D1_03D5 },
    { "D1_03D6", test_D1_03D6 },
    { "D1_03D7", test_D1_03D7 },
    { "D1_03D8", test_D1_03D8 },
    { "D1_03D9", test_D1_03D9 },
    { "D1_03DA", test_D1_03DA },
    { "D1_03DB", test_D1_03DB },
    { "D1_03DC", test_D1_03DC },
    { "D1_03DD", test_D1_03DD },
    { "D1_03DE", test_D1_03DE },
    { "D1_03DF", test_D1_03DF },
    { "D1_03E0", test_D1_03E0 },
    { "D1_03E1", test_D1_03E1 },
    { "D1_03E2", test_D1_03E2 },
    { "D1_03E3", test_D1_03E3 },
    { "D1_03E4", test_D1_03E4 },
    { "D1_03E5", test_D1_03E5 },
    { "D1_03E6", test_D1_03E6 },
    { "D1_03E7", test_D1_03E7 },
    {NULL, NULL}
};

void test_D1_0000()
{
    if (skip_test_D1_0000)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5CDF);
    WriteRegisterWord(RegisterType::SP, 0x497E);
    WriteRegisterByte(RegisterType::A, 0x42);
    WriteRegisterByte(RegisterType::B, 0xFD);
    WriteRegisterByte(RegisterType::C, 0x21);
    WriteRegisterByte(RegisterType::D, 0xF3);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x6A);
    WriteRegisterByte(RegisterType::L, 0x41);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5CDF, 0xD1);
    WriteMemory(0x497F, 0x77);
    WriteMemory(0x497E, 0x47);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x42);
    CheckRegisterByte(RegisterType::B, 0xFD);
    CheckRegisterByte(RegisterType::C, 0x21);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0x47);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x6A);
    CheckRegisterByte(RegisterType::L, 0x41);
    CheckRegisterWord(RegisterType::PC, 0x5CE0);
    CheckRegisterWord(RegisterType::SP, 0x4980);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x497E, 0x47);
    CheckMemory(0x497F, 0x77);
    CheckMemory(0x5CDF, 0xD1);
}

void test_D1_0001()
{
    if (skip_test_D1_0001)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x45CE);
    WriteRegisterWord(RegisterType::SP, 0x3B46);
    WriteRegisterByte(RegisterType::A, 0x7D);
    WriteRegisterByte(RegisterType::B, 0xA1);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0xEA);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x3B);
    WriteRegisterByte(RegisterType::L, 0x7C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x45CE, 0xD1);
    WriteMemory(0x3B47, 0xD5);
    WriteMemory(0x3B46, 0x14);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7D);
    CheckRegisterByte(RegisterType::B, 0xA1);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0xD5);
    CheckRegisterByte(RegisterType::E, 0x14);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x3B);
    CheckRegisterByte(RegisterType::L, 0x7C);
    CheckRegisterWord(RegisterType::PC, 0x45CF);
    CheckRegisterWord(RegisterType::SP, 0x3B48);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3B46, 0x14);
    CheckMemory(0x3B47, 0xD5);
    CheckMemory(0x45CE, 0xD1);
}

void test_D1_0002()
{
    if (skip_test_D1_0002)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9B38);
    WriteRegisterWord(RegisterType::SP, 0x3CF4);
    WriteRegisterByte(RegisterType::A, 0x4F);
    WriteRegisterByte(RegisterType::B, 0x92);
    WriteRegisterByte(RegisterType::C, 0x11);
    WriteRegisterByte(RegisterType::D, 0xB1);
    WriteRegisterByte(RegisterType::E, 0x4E);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xA8);
    WriteRegisterByte(RegisterType::L, 0x9B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9B38, 0xD1);
    WriteMemory(0x3CF5, 0x84);
    WriteMemory(0x3CF4, 0xC8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4F);
    CheckRegisterByte(RegisterType::B, 0x92);
    CheckRegisterByte(RegisterType::C, 0x11);
    CheckRegisterByte(RegisterType::D, 0x84);
    CheckRegisterByte(RegisterType::E, 0xC8);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xA8);
    CheckRegisterByte(RegisterType::L, 0x9B);
    CheckRegisterWord(RegisterType::PC, 0x9B39);
    CheckRegisterWord(RegisterType::SP, 0x3CF6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3CF4, 0xC8);
    CheckMemory(0x3CF5, 0x84);
    CheckMemory(0x9B38, 0xD1);
}

void test_D1_0003()
{
    if (skip_test_D1_0003)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x270F);
    WriteRegisterWord(RegisterType::SP, 0x7092);
    WriteRegisterByte(RegisterType::A, 0xFE);
    WriteRegisterByte(RegisterType::B, 0x71);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0x72);
    WriteRegisterByte(RegisterType::E, 0x33);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x13);
    WriteRegisterByte(RegisterType::L, 0x1A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7093, 0x63);
    WriteMemory(0x7092, 0xB6);
    WriteMemory(0x270F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFE);
    CheckRegisterByte(RegisterType::B, 0x71);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0x63);
    CheckRegisterByte(RegisterType::E, 0xB6);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x13);
    CheckRegisterByte(RegisterType::L, 0x1A);
    CheckRegisterWord(RegisterType::PC, 0x2710);
    CheckRegisterWord(RegisterType::SP, 0x7094);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x270F, 0xD1);
    CheckMemory(0x7092, 0xB6);
    CheckMemory(0x7093, 0x63);
}

void test_D1_0004()
{
    if (skip_test_D1_0004)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6250);
    WriteRegisterWord(RegisterType::SP, 0x3291);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0xB8);
    WriteRegisterByte(RegisterType::C, 0xF3);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0x64);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xA9);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6250, 0xD1);
    WriteMemory(0x3292, 0xC3);
    WriteMemory(0x3291, 0xE6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0xB8);
    CheckRegisterByte(RegisterType::C, 0xF3);
    CheckRegisterByte(RegisterType::D, 0xC3);
    CheckRegisterByte(RegisterType::E, 0xE6);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xA9);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0x6251);
    CheckRegisterWord(RegisterType::SP, 0x3293);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3291, 0xE6);
    CheckMemory(0x3292, 0xC3);
    CheckMemory(0x6250, 0xD1);
}

void test_D1_0005()
{
    if (skip_test_D1_0005)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFB6A);
    WriteRegisterWord(RegisterType::SP, 0x8F12);
    WriteRegisterByte(RegisterType::A, 0x96);
    WriteRegisterByte(RegisterType::B, 0xA7);
    WriteRegisterByte(RegisterType::C, 0x5E);
    WriteRegisterByte(RegisterType::D, 0xF1);
    WriteRegisterByte(RegisterType::E, 0x43);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x18);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFB6A, 0xD1);
    WriteMemory(0x8F13, 0x30);
    WriteMemory(0x8F12, 0xC3);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x96);
    CheckRegisterByte(RegisterType::B, 0xA7);
    CheckRegisterByte(RegisterType::C, 0x5E);
    CheckRegisterByte(RegisterType::D, 0x30);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x18);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0xFB6B);
    CheckRegisterWord(RegisterType::SP, 0x8F14);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8F12, 0xC3);
    CheckMemory(0x8F13, 0x30);
    CheckMemory(0xFB6A, 0xD1);
}

void test_D1_0006()
{
    if (skip_test_D1_0006)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1352);
    WriteRegisterWord(RegisterType::SP, 0xB143);
    WriteRegisterByte(RegisterType::A, 0x33);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0x2C);
    WriteRegisterByte(RegisterType::D, 0x80);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x87);
    WriteRegisterByte(RegisterType::L, 0x85);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB144, 0x90);
    WriteMemory(0xB143, 0xD7);
    WriteMemory(0x1352, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x33);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0x2C);
    CheckRegisterByte(RegisterType::D, 0x90);
    CheckRegisterByte(RegisterType::E, 0xD7);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x87);
    CheckRegisterByte(RegisterType::L, 0x85);
    CheckRegisterWord(RegisterType::PC, 0x1353);
    CheckRegisterWord(RegisterType::SP, 0xB145);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1352, 0xD1);
    CheckMemory(0xB143, 0xD7);
    CheckMemory(0xB144, 0x90);
}

void test_D1_0007()
{
    if (skip_test_D1_0007)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x842C);
    WriteRegisterWord(RegisterType::SP, 0xDA3A);
    WriteRegisterByte(RegisterType::A, 0x9F);
    WriteRegisterByte(RegisterType::B, 0x07);
    WriteRegisterByte(RegisterType::C, 0xAA);
    WriteRegisterByte(RegisterType::D, 0xF2);
    WriteRegisterByte(RegisterType::E, 0x54);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x02);
    WriteRegisterByte(RegisterType::L, 0xE0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDA3B, 0x10);
    WriteMemory(0xDA3A, 0x68);
    WriteMemory(0x842C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9F);
    CheckRegisterByte(RegisterType::B, 0x07);
    CheckRegisterByte(RegisterType::C, 0xAA);
    CheckRegisterByte(RegisterType::D, 0x10);
    CheckRegisterByte(RegisterType::E, 0x68);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x02);
    CheckRegisterByte(RegisterType::L, 0xE0);
    CheckRegisterWord(RegisterType::PC, 0x842D);
    CheckRegisterWord(RegisterType::SP, 0xDA3C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x842C, 0xD1);
    CheckMemory(0xDA3A, 0x68);
    CheckMemory(0xDA3B, 0x10);
}

void test_D1_0008()
{
    if (skip_test_D1_0008)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2327);
    WriteRegisterWord(RegisterType::SP, 0xFF7D);
    WriteRegisterByte(RegisterType::A, 0x16);
    WriteRegisterByte(RegisterType::B, 0x58);
    WriteRegisterByte(RegisterType::C, 0xB4);
    WriteRegisterByte(RegisterType::D, 0x90);
    WriteRegisterByte(RegisterType::E, 0x6D);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x1D);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF7E, 0x28);
    WriteMemory(0xFF7D, 0xED);
    WriteMemory(0x2327, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x16);
    CheckRegisterByte(RegisterType::B, 0x58);
    CheckRegisterByte(RegisterType::C, 0xB4);
    CheckRegisterByte(RegisterType::D, 0x28);
    CheckRegisterByte(RegisterType::E, 0xED);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x1D);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0x2328);
    CheckRegisterWord(RegisterType::SP, 0xFF7F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2327, 0xD1);
    CheckMemory(0xFF7D, 0xED);
    CheckMemory(0xFF7E, 0x28);
}

void test_D1_0009()
{
    if (skip_test_D1_0009)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD60);
    WriteRegisterWord(RegisterType::SP, 0xB045);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x25);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCD60, 0xD1);
    WriteMemory(0xB046, 0x2A);
    WriteMemory(0xB045, 0x5F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0x2A);
    CheckRegisterByte(RegisterType::E, 0x5F);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x25);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0xCD61);
    CheckRegisterWord(RegisterType::SP, 0xB047);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB045, 0x5F);
    CheckMemory(0xB046, 0x2A);
    CheckMemory(0xCD60, 0xD1);
}

void test_D1_000A()
{
    if (skip_test_D1_000A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x074E);
    WriteRegisterWord(RegisterType::SP, 0x9838);
    WriteRegisterByte(RegisterType::A, 0x52);
    WriteRegisterByte(RegisterType::B, 0x86);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0x01);
    WriteRegisterByte(RegisterType::E, 0xDA);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0x3E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9839, 0xCD);
    WriteMemory(0x9838, 0x95);
    WriteMemory(0x074E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x52);
    CheckRegisterByte(RegisterType::B, 0x86);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0xCD);
    CheckRegisterByte(RegisterType::E, 0x95);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0x3E);
    CheckRegisterWord(RegisterType::PC, 0x074F);
    CheckRegisterWord(RegisterType::SP, 0x983A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x074E, 0xD1);
    CheckMemory(0x9838, 0x95);
    CheckMemory(0x9839, 0xCD);
}

void test_D1_000B()
{
    if (skip_test_D1_000B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x19BC);
    WriteRegisterWord(RegisterType::SP, 0x83A3);
    WriteRegisterByte(RegisterType::A, 0x2D);
    WriteRegisterByte(RegisterType::B, 0x1F);
    WriteRegisterByte(RegisterType::C, 0x3C);
    WriteRegisterByte(RegisterType::D, 0x00);
    WriteRegisterByte(RegisterType::E, 0xCC);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0xE6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x83A4, 0x98);
    WriteMemory(0x83A3, 0x31);
    WriteMemory(0x19BC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2D);
    CheckRegisterByte(RegisterType::B, 0x1F);
    CheckRegisterByte(RegisterType::C, 0x3C);
    CheckRegisterByte(RegisterType::D, 0x98);
    CheckRegisterByte(RegisterType::E, 0x31);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0xE6);
    CheckRegisterWord(RegisterType::PC, 0x19BD);
    CheckRegisterWord(RegisterType::SP, 0x83A5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x19BC, 0xD1);
    CheckMemory(0x83A3, 0x31);
    CheckMemory(0x83A4, 0x98);
}

void test_D1_000C()
{
    if (skip_test_D1_000C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1298);
    WriteRegisterWord(RegisterType::SP, 0x8ABF);
    WriteRegisterByte(RegisterType::A, 0xBC);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x9F);
    WriteRegisterByte(RegisterType::D, 0x50);
    WriteRegisterByte(RegisterType::E, 0x75);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC4);
    WriteRegisterByte(RegisterType::L, 0x3E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8AC0, 0x08);
    WriteMemory(0x8ABF, 0x2E);
    WriteMemory(0x1298, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBC);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x9F);
    CheckRegisterByte(RegisterType::D, 0x08);
    CheckRegisterByte(RegisterType::E, 0x2E);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC4);
    CheckRegisterByte(RegisterType::L, 0x3E);
    CheckRegisterWord(RegisterType::PC, 0x1299);
    CheckRegisterWord(RegisterType::SP, 0x8AC1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1298, 0xD1);
    CheckMemory(0x8ABF, 0x2E);
    CheckMemory(0x8AC0, 0x08);
}

void test_D1_000D()
{
    if (skip_test_D1_000D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2846);
    WriteRegisterWord(RegisterType::SP, 0x0D1B);
    WriteRegisterByte(RegisterType::A, 0x64);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0xE8);
    WriteRegisterByte(RegisterType::D, 0x1F);
    WriteRegisterByte(RegisterType::E, 0xAC);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x47);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2846, 0xD1);
    WriteMemory(0x0D1C, 0x88);
    WriteMemory(0x0D1B, 0xA0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x64);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0xE8);
    CheckRegisterByte(RegisterType::D, 0x88);
    CheckRegisterByte(RegisterType::E, 0xA0);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x47);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0x2847);
    CheckRegisterWord(RegisterType::SP, 0x0D1D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0D1B, 0xA0);
    CheckMemory(0x0D1C, 0x88);
    CheckMemory(0x2846, 0xD1);
}

void test_D1_000E()
{
    if (skip_test_D1_000E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x03FB);
    WriteRegisterWord(RegisterType::SP, 0xFD19);
    WriteRegisterByte(RegisterType::A, 0x3F);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0x5B);
    WriteRegisterByte(RegisterType::D, 0x8A);
    WriteRegisterByte(RegisterType::E, 0x62);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xB5);
    WriteRegisterByte(RegisterType::L, 0xDD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFD1A, 0xE8);
    WriteMemory(0xFD19, 0x8A);
    WriteMemory(0x03FB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3F);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0x5B);
    CheckRegisterByte(RegisterType::D, 0xE8);
    CheckRegisterByte(RegisterType::E, 0x8A);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xB5);
    CheckRegisterByte(RegisterType::L, 0xDD);
    CheckRegisterWord(RegisterType::PC, 0x03FC);
    CheckRegisterWord(RegisterType::SP, 0xFD1B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x03FB, 0xD1);
    CheckMemory(0xFD19, 0x8A);
    CheckMemory(0xFD1A, 0xE8);
}

void test_D1_000F()
{
    if (skip_test_D1_000F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB654);
    WriteRegisterWord(RegisterType::SP, 0x3236);
    WriteRegisterByte(RegisterType::A, 0xD2);
    WriteRegisterByte(RegisterType::B, 0xFA);
    WriteRegisterByte(RegisterType::C, 0xFA);
    WriteRegisterByte(RegisterType::D, 0xFA);
    WriteRegisterByte(RegisterType::E, 0xE8);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xF0);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB654, 0xD1);
    WriteMemory(0x3237, 0x36);
    WriteMemory(0x3236, 0xDB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD2);
    CheckRegisterByte(RegisterType::B, 0xFA);
    CheckRegisterByte(RegisterType::C, 0xFA);
    CheckRegisterByte(RegisterType::D, 0x36);
    CheckRegisterByte(RegisterType::E, 0xDB);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xF0);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0xB655);
    CheckRegisterWord(RegisterType::SP, 0x3238);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3236, 0xDB);
    CheckMemory(0x3237, 0x36);
    CheckMemory(0xB654, 0xD1);
}

void test_D1_0010()
{
    if (skip_test_D1_0010)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4162);
    WriteRegisterWord(RegisterType::SP, 0x8E4F);
    WriteRegisterByte(RegisterType::A, 0x7E);
    WriteRegisterByte(RegisterType::B, 0xA7);
    WriteRegisterByte(RegisterType::C, 0xE7);
    WriteRegisterByte(RegisterType::D, 0x50);
    WriteRegisterByte(RegisterType::E, 0x14);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xAB);
    WriteRegisterByte(RegisterType::L, 0x6D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x8E50, 0x29);
    WriteMemory(0x8E4F, 0x8E);
    WriteMemory(0x4162, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7E);
    CheckRegisterByte(RegisterType::B, 0xA7);
    CheckRegisterByte(RegisterType::C, 0xE7);
    CheckRegisterByte(RegisterType::D, 0x29);
    CheckRegisterByte(RegisterType::E, 0x8E);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xAB);
    CheckRegisterByte(RegisterType::L, 0x6D);
    CheckRegisterWord(RegisterType::PC, 0x4163);
    CheckRegisterWord(RegisterType::SP, 0x8E51);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4162, 0xD1);
    CheckMemory(0x8E4F, 0x8E);
    CheckMemory(0x8E50, 0x29);
}

void test_D1_0011()
{
    if (skip_test_D1_0011)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x15BD);
    WriteRegisterWord(RegisterType::SP, 0xE64B);
    WriteRegisterByte(RegisterType::A, 0x01);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0xA6);
    WriteRegisterByte(RegisterType::D, 0x48);
    WriteRegisterByte(RegisterType::E, 0x31);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x64);
    WriteRegisterByte(RegisterType::L, 0xB9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE64C, 0x18);
    WriteMemory(0xE64B, 0x6D);
    WriteMemory(0x15BD, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x01);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0xA6);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0x6D);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x64);
    CheckRegisterByte(RegisterType::L, 0xB9);
    CheckRegisterWord(RegisterType::PC, 0x15BE);
    CheckRegisterWord(RegisterType::SP, 0xE64D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x15BD, 0xD1);
    CheckMemory(0xE64B, 0x6D);
    CheckMemory(0xE64C, 0x18);
}

void test_D1_0012()
{
    if (skip_test_D1_0012)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFB0B);
    WriteRegisterWord(RegisterType::SP, 0xC30C);
    WriteRegisterByte(RegisterType::A, 0xAA);
    WriteRegisterByte(RegisterType::B, 0xDD);
    WriteRegisterByte(RegisterType::C, 0x4F);
    WriteRegisterByte(RegisterType::D, 0x44);
    WriteRegisterByte(RegisterType::E, 0x92);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x89);
    WriteRegisterByte(RegisterType::L, 0x9F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFB0B, 0xD1);
    WriteMemory(0xC30D, 0x6B);
    WriteMemory(0xC30C, 0x48);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAA);
    CheckRegisterByte(RegisterType::B, 0xDD);
    CheckRegisterByte(RegisterType::C, 0x4F);
    CheckRegisterByte(RegisterType::D, 0x6B);
    CheckRegisterByte(RegisterType::E, 0x48);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x89);
    CheckRegisterByte(RegisterType::L, 0x9F);
    CheckRegisterWord(RegisterType::PC, 0xFB0C);
    CheckRegisterWord(RegisterType::SP, 0xC30E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC30C, 0x48);
    CheckMemory(0xC30D, 0x6B);
    CheckMemory(0xFB0B, 0xD1);
}

void test_D1_0013()
{
    if (skip_test_D1_0013)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8FB6);
    WriteRegisterWord(RegisterType::SP, 0x2EDC);
    WriteRegisterByte(RegisterType::A, 0xFC);
    WriteRegisterByte(RegisterType::B, 0x7E);
    WriteRegisterByte(RegisterType::C, 0x9B);
    WriteRegisterByte(RegisterType::D, 0x1E);
    WriteRegisterByte(RegisterType::E, 0x62);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x36);
    WriteRegisterByte(RegisterType::L, 0xFF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8FB6, 0xD1);
    WriteMemory(0x2EDD, 0x6C);
    WriteMemory(0x2EDC, 0xC0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFC);
    CheckRegisterByte(RegisterType::B, 0x7E);
    CheckRegisterByte(RegisterType::C, 0x9B);
    CheckRegisterByte(RegisterType::D, 0x6C);
    CheckRegisterByte(RegisterType::E, 0xC0);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x36);
    CheckRegisterByte(RegisterType::L, 0xFF);
    CheckRegisterWord(RegisterType::PC, 0x8FB7);
    CheckRegisterWord(RegisterType::SP, 0x2EDE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2EDC, 0xC0);
    CheckMemory(0x2EDD, 0x6C);
    CheckMemory(0x8FB6, 0xD1);
}

void test_D1_0014()
{
    if (skip_test_D1_0014)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1D66);
    WriteRegisterWord(RegisterType::SP, 0xD62E);
    WriteRegisterByte(RegisterType::A, 0x39);
    WriteRegisterByte(RegisterType::B, 0xBA);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0x4F);
    WriteRegisterByte(RegisterType::E, 0xF4);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xDC);
    WriteRegisterByte(RegisterType::L, 0x90);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD62F, 0x67);
    WriteMemory(0xD62E, 0x51);
    WriteMemory(0x1D66, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x39);
    CheckRegisterByte(RegisterType::B, 0xBA);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0x67);
    CheckRegisterByte(RegisterType::E, 0x51);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xDC);
    CheckRegisterByte(RegisterType::L, 0x90);
    CheckRegisterWord(RegisterType::PC, 0x1D67);
    CheckRegisterWord(RegisterType::SP, 0xD630);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1D66, 0xD1);
    CheckMemory(0xD62E, 0x51);
    CheckMemory(0xD62F, 0x67);
}

void test_D1_0015()
{
    if (skip_test_D1_0015)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x67FB);
    WriteRegisterWord(RegisterType::SP, 0x5919);
    WriteRegisterByte(RegisterType::A, 0x18);
    WriteRegisterByte(RegisterType::B, 0xEB);
    WriteRegisterByte(RegisterType::C, 0x70);
    WriteRegisterByte(RegisterType::D, 0xA4);
    WriteRegisterByte(RegisterType::E, 0x8D);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xBC);
    WriteRegisterByte(RegisterType::L, 0xF1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x67FB, 0xD1);
    WriteMemory(0x591A, 0x22);
    WriteMemory(0x5919, 0xC8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x18);
    CheckRegisterByte(RegisterType::B, 0xEB);
    CheckRegisterByte(RegisterType::C, 0x70);
    CheckRegisterByte(RegisterType::D, 0x22);
    CheckRegisterByte(RegisterType::E, 0xC8);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xBC);
    CheckRegisterByte(RegisterType::L, 0xF1);
    CheckRegisterWord(RegisterType::PC, 0x67FC);
    CheckRegisterWord(RegisterType::SP, 0x591B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5919, 0xC8);
    CheckMemory(0x591A, 0x22);
    CheckMemory(0x67FB, 0xD1);
}

void test_D1_0016()
{
    if (skip_test_D1_0016)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x33EE);
    WriteRegisterWord(RegisterType::SP, 0x9715);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0x32);
    WriteRegisterByte(RegisterType::C, 0x5E);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0x18);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x03);
    WriteRegisterByte(RegisterType::L, 0x73);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9716, 0xDD);
    WriteMemory(0x9715, 0x84);
    WriteMemory(0x33EE, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0x32);
    CheckRegisterByte(RegisterType::C, 0x5E);
    CheckRegisterByte(RegisterType::D, 0xDD);
    CheckRegisterByte(RegisterType::E, 0x84);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x03);
    CheckRegisterByte(RegisterType::L, 0x73);
    CheckRegisterWord(RegisterType::PC, 0x33EF);
    CheckRegisterWord(RegisterType::SP, 0x9717);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x33EE, 0xD1);
    CheckMemory(0x9715, 0x84);
    CheckMemory(0x9716, 0xDD);
}

void test_D1_0017()
{
    if (skip_test_D1_0017)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3F7B);
    WriteRegisterWord(RegisterType::SP, 0x5B73);
    WriteRegisterByte(RegisterType::A, 0xBA);
    WriteRegisterByte(RegisterType::B, 0x28);
    WriteRegisterByte(RegisterType::C, 0xEC);
    WriteRegisterByte(RegisterType::D, 0x14);
    WriteRegisterByte(RegisterType::E, 0x71);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x4D);
    WriteRegisterByte(RegisterType::L, 0x67);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5B74, 0xB8);
    WriteMemory(0x5B73, 0xD4);
    WriteMemory(0x3F7B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBA);
    CheckRegisterByte(RegisterType::B, 0x28);
    CheckRegisterByte(RegisterType::C, 0xEC);
    CheckRegisterByte(RegisterType::D, 0xB8);
    CheckRegisterByte(RegisterType::E, 0xD4);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x4D);
    CheckRegisterByte(RegisterType::L, 0x67);
    CheckRegisterWord(RegisterType::PC, 0x3F7C);
    CheckRegisterWord(RegisterType::SP, 0x5B75);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3F7B, 0xD1);
    CheckMemory(0x5B73, 0xD4);
    CheckMemory(0x5B74, 0xB8);
}

void test_D1_0018()
{
    if (skip_test_D1_0018)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCB88);
    WriteRegisterWord(RegisterType::SP, 0x9AF0);
    WriteRegisterByte(RegisterType::A, 0x01);
    WriteRegisterByte(RegisterType::B, 0x8A);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0x9D);
    WriteRegisterByte(RegisterType::E, 0x39);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xCF);
    WriteRegisterByte(RegisterType::L, 0x0F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCB88, 0xD1);
    WriteMemory(0x9AF1, 0x33);
    WriteMemory(0x9AF0, 0xB6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x01);
    CheckRegisterByte(RegisterType::B, 0x8A);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0x33);
    CheckRegisterByte(RegisterType::E, 0xB6);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xCF);
    CheckRegisterByte(RegisterType::L, 0x0F);
    CheckRegisterWord(RegisterType::PC, 0xCB89);
    CheckRegisterWord(RegisterType::SP, 0x9AF2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9AF0, 0xB6);
    CheckMemory(0x9AF1, 0x33);
    CheckMemory(0xCB88, 0xD1);
}

void test_D1_0019()
{
    if (skip_test_D1_0019)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5ACA);
    WriteRegisterWord(RegisterType::SP, 0x9991);
    WriteRegisterByte(RegisterType::A, 0x1E);
    WriteRegisterByte(RegisterType::B, 0x7A);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0xC0);
    WriteRegisterByte(RegisterType::E, 0x0D);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x1B);
    WriteRegisterByte(RegisterType::L, 0x78);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9992, 0xC6);
    WriteMemory(0x9991, 0x23);
    WriteMemory(0x5ACA, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1E);
    CheckRegisterByte(RegisterType::B, 0x7A);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0x23);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x1B);
    CheckRegisterByte(RegisterType::L, 0x78);
    CheckRegisterWord(RegisterType::PC, 0x5ACB);
    CheckRegisterWord(RegisterType::SP, 0x9993);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5ACA, 0xD1);
    CheckMemory(0x9991, 0x23);
    CheckMemory(0x9992, 0xC6);
}

void test_D1_001A()
{
    if (skip_test_D1_001A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBA31);
    WriteRegisterWord(RegisterType::SP, 0xE4DF);
    WriteRegisterByte(RegisterType::A, 0x21);
    WriteRegisterByte(RegisterType::B, 0xAD);
    WriteRegisterByte(RegisterType::C, 0x74);
    WriteRegisterByte(RegisterType::D, 0x7F);
    WriteRegisterByte(RegisterType::E, 0x38);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x06);
    WriteRegisterByte(RegisterType::L, 0x51);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE4E0, 0xF8);
    WriteMemory(0xE4DF, 0xF4);
    WriteMemory(0xBA31, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x21);
    CheckRegisterByte(RegisterType::B, 0xAD);
    CheckRegisterByte(RegisterType::C, 0x74);
    CheckRegisterByte(RegisterType::D, 0xF8);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x06);
    CheckRegisterByte(RegisterType::L, 0x51);
    CheckRegisterWord(RegisterType::PC, 0xBA32);
    CheckRegisterWord(RegisterType::SP, 0xE4E1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBA31, 0xD1);
    CheckMemory(0xE4DF, 0xF4);
    CheckMemory(0xE4E0, 0xF8);
}

void test_D1_001B()
{
    if (skip_test_D1_001B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB67E);
    WriteRegisterWord(RegisterType::SP, 0x0B00);
    WriteRegisterByte(RegisterType::A, 0xD8);
    WriteRegisterByte(RegisterType::B, 0xCD);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0x85);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x26);
    WriteRegisterByte(RegisterType::L, 0x9A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB67E, 0xD1);
    WriteMemory(0x0B01, 0xB5);
    WriteMemory(0x0B00, 0x61);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD8);
    CheckRegisterByte(RegisterType::B, 0xCD);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0xB5);
    CheckRegisterByte(RegisterType::E, 0x61);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x26);
    CheckRegisterByte(RegisterType::L, 0x9A);
    CheckRegisterWord(RegisterType::PC, 0xB67F);
    CheckRegisterWord(RegisterType::SP, 0x0B02);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0B00, 0x61);
    CheckMemory(0x0B01, 0xB5);
    CheckMemory(0xB67E, 0xD1);
}

void test_D1_001C()
{
    if (skip_test_D1_001C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3146);
    WriteRegisterWord(RegisterType::SP, 0x60BE);
    WriteRegisterByte(RegisterType::A, 0xF7);
    WriteRegisterByte(RegisterType::B, 0x8C);
    WriteRegisterByte(RegisterType::C, 0x91);
    WriteRegisterByte(RegisterType::D, 0xB9);
    WriteRegisterByte(RegisterType::E, 0x09);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xBC);
    WriteRegisterByte(RegisterType::L, 0xB8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x60BF, 0x95);
    WriteMemory(0x60BE, 0x6C);
    WriteMemory(0x3146, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF7);
    CheckRegisterByte(RegisterType::B, 0x8C);
    CheckRegisterByte(RegisterType::C, 0x91);
    CheckRegisterByte(RegisterType::D, 0x95);
    CheckRegisterByte(RegisterType::E, 0x6C);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xBC);
    CheckRegisterByte(RegisterType::L, 0xB8);
    CheckRegisterWord(RegisterType::PC, 0x3147);
    CheckRegisterWord(RegisterType::SP, 0x60C0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3146, 0xD1);
    CheckMemory(0x60BE, 0x6C);
    CheckMemory(0x60BF, 0x95);
}

void test_D1_001D()
{
    if (skip_test_D1_001D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1C53);
    WriteRegisterWord(RegisterType::SP, 0x2CD3);
    WriteRegisterByte(RegisterType::A, 0x09);
    WriteRegisterByte(RegisterType::B, 0xEA);
    WriteRegisterByte(RegisterType::C, 0xC2);
    WriteRegisterByte(RegisterType::D, 0x45);
    WriteRegisterByte(RegisterType::E, 0x0E);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x18);
    WriteRegisterByte(RegisterType::L, 0x65);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2CD4, 0xE4);
    WriteMemory(0x2CD3, 0x74);
    WriteMemory(0x1C53, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x09);
    CheckRegisterByte(RegisterType::B, 0xEA);
    CheckRegisterByte(RegisterType::C, 0xC2);
    CheckRegisterByte(RegisterType::D, 0xE4);
    CheckRegisterByte(RegisterType::E, 0x74);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x18);
    CheckRegisterByte(RegisterType::L, 0x65);
    CheckRegisterWord(RegisterType::PC, 0x1C54);
    CheckRegisterWord(RegisterType::SP, 0x2CD5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1C53, 0xD1);
    CheckMemory(0x2CD3, 0x74);
    CheckMemory(0x2CD4, 0xE4);
}

void test_D1_001E()
{
    if (skip_test_D1_001E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD01B);
    WriteRegisterWord(RegisterType::SP, 0xEBF6);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0x2C);
    WriteRegisterByte(RegisterType::C, 0xBA);
    WriteRegisterByte(RegisterType::D, 0xC7);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xB5);
    WriteRegisterByte(RegisterType::L, 0xA9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEBF7, 0xE5);
    WriteMemory(0xEBF6, 0x13);
    WriteMemory(0xD01B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0x2C);
    CheckRegisterByte(RegisterType::C, 0xBA);
    CheckRegisterByte(RegisterType::D, 0xE5);
    CheckRegisterByte(RegisterType::E, 0x13);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xB5);
    CheckRegisterByte(RegisterType::L, 0xA9);
    CheckRegisterWord(RegisterType::PC, 0xD01C);
    CheckRegisterWord(RegisterType::SP, 0xEBF8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD01B, 0xD1);
    CheckMemory(0xEBF6, 0x13);
    CheckMemory(0xEBF7, 0xE5);
}

void test_D1_001F()
{
    if (skip_test_D1_001F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x32DF);
    WriteRegisterWord(RegisterType::SP, 0xCF24);
    WriteRegisterByte(RegisterType::A, 0xE5);
    WriteRegisterByte(RegisterType::B, 0x97);
    WriteRegisterByte(RegisterType::C, 0xAA);
    WriteRegisterByte(RegisterType::D, 0x43);
    WriteRegisterByte(RegisterType::E, 0x0D);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0x74);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCF25, 0x26);
    WriteMemory(0xCF24, 0xDE);
    WriteMemory(0x32DF, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE5);
    CheckRegisterByte(RegisterType::B, 0x97);
    CheckRegisterByte(RegisterType::C, 0xAA);
    CheckRegisterByte(RegisterType::D, 0x26);
    CheckRegisterByte(RegisterType::E, 0xDE);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0x74);
    CheckRegisterWord(RegisterType::PC, 0x32E0);
    CheckRegisterWord(RegisterType::SP, 0xCF26);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x32DF, 0xD1);
    CheckMemory(0xCF24, 0xDE);
    CheckMemory(0xCF25, 0x26);
}

void test_D1_0020()
{
    if (skip_test_D1_0020)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAD15);
    WriteRegisterWord(RegisterType::SP, 0x5DDC);
    WriteRegisterByte(RegisterType::A, 0xB6);
    WriteRegisterByte(RegisterType::B, 0x9A);
    WriteRegisterByte(RegisterType::C, 0x98);
    WriteRegisterByte(RegisterType::D, 0xBA);
    WriteRegisterByte(RegisterType::E, 0x0D);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x3C);
    WriteRegisterByte(RegisterType::L, 0x03);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xAD15, 0xD1);
    WriteMemory(0x5DDD, 0xD0);
    WriteMemory(0x5DDC, 0xF0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB6);
    CheckRegisterByte(RegisterType::B, 0x9A);
    CheckRegisterByte(RegisterType::C, 0x98);
    CheckRegisterByte(RegisterType::D, 0xD0);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x3C);
    CheckRegisterByte(RegisterType::L, 0x03);
    CheckRegisterWord(RegisterType::PC, 0xAD16);
    CheckRegisterWord(RegisterType::SP, 0x5DDE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5DDC, 0xF0);
    CheckMemory(0x5DDD, 0xD0);
    CheckMemory(0xAD15, 0xD1);
}

void test_D1_0021()
{
    if (skip_test_D1_0021)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3FAC);
    WriteRegisterWord(RegisterType::SP, 0x07B4);
    WriteRegisterByte(RegisterType::A, 0x14);
    WriteRegisterByte(RegisterType::B, 0xF1);
    WriteRegisterByte(RegisterType::C, 0xA1);
    WriteRegisterByte(RegisterType::D, 0x42);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x98);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x3FAC, 0xD1);
    WriteMemory(0x07B5, 0x1C);
    WriteMemory(0x07B4, 0x9F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x14);
    CheckRegisterByte(RegisterType::B, 0xF1);
    CheckRegisterByte(RegisterType::C, 0xA1);
    CheckRegisterByte(RegisterType::D, 0x1C);
    CheckRegisterByte(RegisterType::E, 0x9F);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x98);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0x3FAD);
    CheckRegisterWord(RegisterType::SP, 0x07B6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x07B4, 0x9F);
    CheckMemory(0x07B5, 0x1C);
    CheckMemory(0x3FAC, 0xD1);
}

void test_D1_0022()
{
    if (skip_test_D1_0022)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBABF);
    WriteRegisterWord(RegisterType::SP, 0x4A5A);
    WriteRegisterByte(RegisterType::A, 0x53);
    WriteRegisterByte(RegisterType::B, 0xB4);
    WriteRegisterByte(RegisterType::C, 0xCE);
    WriteRegisterByte(RegisterType::D, 0x21);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x50);
    WriteRegisterByte(RegisterType::L, 0xBE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBABF, 0xD1);
    WriteMemory(0x4A5B, 0x18);
    WriteMemory(0x4A5A, 0xC9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x53);
    CheckRegisterByte(RegisterType::B, 0xB4);
    CheckRegisterByte(RegisterType::C, 0xCE);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0xC9);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x50);
    CheckRegisterByte(RegisterType::L, 0xBE);
    CheckRegisterWord(RegisterType::PC, 0xBAC0);
    CheckRegisterWord(RegisterType::SP, 0x4A5C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4A5A, 0xC9);
    CheckMemory(0x4A5B, 0x18);
    CheckMemory(0xBABF, 0xD1);
}

void test_D1_0023()
{
    if (skip_test_D1_0023)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6FF0);
    WriteRegisterWord(RegisterType::SP, 0x4D3B);
    WriteRegisterByte(RegisterType::A, 0xE6);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0xC5);
    WriteRegisterByte(RegisterType::D, 0x54);
    WriteRegisterByte(RegisterType::E, 0x93);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0x3D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6FF0, 0xD1);
    WriteMemory(0x4D3C, 0xDF);
    WriteMemory(0x4D3B, 0xFA);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE6);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0xC5);
    CheckRegisterByte(RegisterType::D, 0xDF);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0x3D);
    CheckRegisterWord(RegisterType::PC, 0x6FF1);
    CheckRegisterWord(RegisterType::SP, 0x4D3D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4D3B, 0xFA);
    CheckMemory(0x4D3C, 0xDF);
    CheckMemory(0x6FF0, 0xD1);
}

void test_D1_0024()
{
    if (skip_test_D1_0024)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4DAC);
    WriteRegisterWord(RegisterType::SP, 0x82A2);
    WriteRegisterByte(RegisterType::A, 0x62);
    WriteRegisterByte(RegisterType::B, 0xED);
    WriteRegisterByte(RegisterType::C, 0xEC);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0x72);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x95);
    WriteRegisterByte(RegisterType::L, 0xD3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x82A3, 0xA8);
    WriteMemory(0x82A2, 0xE7);
    WriteMemory(0x4DAC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x62);
    CheckRegisterByte(RegisterType::B, 0xED);
    CheckRegisterByte(RegisterType::C, 0xEC);
    CheckRegisterByte(RegisterType::D, 0xA8);
    CheckRegisterByte(RegisterType::E, 0xE7);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x95);
    CheckRegisterByte(RegisterType::L, 0xD3);
    CheckRegisterWord(RegisterType::PC, 0x4DAD);
    CheckRegisterWord(RegisterType::SP, 0x82A4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4DAC, 0xD1);
    CheckMemory(0x82A2, 0xE7);
    CheckMemory(0x82A3, 0xA8);
}

void test_D1_0025()
{
    if (skip_test_D1_0025)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3420);
    WriteRegisterWord(RegisterType::SP, 0xF169);
    WriteRegisterByte(RegisterType::A, 0x67);
    WriteRegisterByte(RegisterType::B, 0x7B);
    WriteRegisterByte(RegisterType::C, 0xA5);
    WriteRegisterByte(RegisterType::D, 0x36);
    WriteRegisterByte(RegisterType::E, 0xBA);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x40);
    WriteRegisterByte(RegisterType::L, 0x88);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF16A, 0x77);
    WriteMemory(0xF169, 0xBD);
    WriteMemory(0x3420, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x67);
    CheckRegisterByte(RegisterType::B, 0x7B);
    CheckRegisterByte(RegisterType::C, 0xA5);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0xBD);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x40);
    CheckRegisterByte(RegisterType::L, 0x88);
    CheckRegisterWord(RegisterType::PC, 0x3421);
    CheckRegisterWord(RegisterType::SP, 0xF16B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3420, 0xD1);
    CheckMemory(0xF169, 0xBD);
    CheckMemory(0xF16A, 0x77);
}

void test_D1_0026()
{
    if (skip_test_D1_0026)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBD4F);
    WriteRegisterWord(RegisterType::SP, 0x4E13);
    WriteRegisterByte(RegisterType::A, 0x1B);
    WriteRegisterByte(RegisterType::B, 0x7E);
    WriteRegisterByte(RegisterType::C, 0x10);
    WriteRegisterByte(RegisterType::D, 0x1F);
    WriteRegisterByte(RegisterType::E, 0x8C);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBD4F, 0xD1);
    WriteMemory(0x4E14, 0xAD);
    WriteMemory(0x4E13, 0xC1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1B);
    CheckRegisterByte(RegisterType::B, 0x7E);
    CheckRegisterByte(RegisterType::C, 0x10);
    CheckRegisterByte(RegisterType::D, 0xAD);
    CheckRegisterByte(RegisterType::E, 0xC1);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0xBD50);
    CheckRegisterWord(RegisterType::SP, 0x4E15);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4E13, 0xC1);
    CheckMemory(0x4E14, 0xAD);
    CheckMemory(0xBD4F, 0xD1);
}

void test_D1_0027()
{
    if (skip_test_D1_0027)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x73E3);
    WriteRegisterWord(RegisterType::SP, 0x4B80);
    WriteRegisterByte(RegisterType::A, 0x7C);
    WriteRegisterByte(RegisterType::B, 0x1C);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0x21);
    WriteRegisterByte(RegisterType::E, 0xD0);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xB7);
    WriteRegisterByte(RegisterType::L, 0x47);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x73E3, 0xD1);
    WriteMemory(0x4B81, 0x75);
    WriteMemory(0x4B80, 0x0B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7C);
    CheckRegisterByte(RegisterType::B, 0x1C);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0x75);
    CheckRegisterByte(RegisterType::E, 0x0B);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xB7);
    CheckRegisterByte(RegisterType::L, 0x47);
    CheckRegisterWord(RegisterType::PC, 0x73E4);
    CheckRegisterWord(RegisterType::SP, 0x4B82);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4B80, 0x0B);
    CheckMemory(0x4B81, 0x75);
    CheckMemory(0x73E3, 0xD1);
}

void test_D1_0028()
{
    if (skip_test_D1_0028)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6E2B);
    WriteRegisterWord(RegisterType::SP, 0xF244);
    WriteRegisterByte(RegisterType::A, 0xE6);
    WriteRegisterByte(RegisterType::B, 0xD2);
    WriteRegisterByte(RegisterType::C, 0x84);
    WriteRegisterByte(RegisterType::D, 0xCC);
    WriteRegisterByte(RegisterType::E, 0x0C);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xF1);
    WriteRegisterByte(RegisterType::L, 0x37);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF245, 0xC2);
    WriteMemory(0xF244, 0x43);
    WriteMemory(0x6E2B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE6);
    CheckRegisterByte(RegisterType::B, 0xD2);
    CheckRegisterByte(RegisterType::C, 0x84);
    CheckRegisterByte(RegisterType::D, 0xC2);
    CheckRegisterByte(RegisterType::E, 0x43);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xF1);
    CheckRegisterByte(RegisterType::L, 0x37);
    CheckRegisterWord(RegisterType::PC, 0x6E2C);
    CheckRegisterWord(RegisterType::SP, 0xF246);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6E2B, 0xD1);
    CheckMemory(0xF244, 0x43);
    CheckMemory(0xF245, 0xC2);
}

void test_D1_0029()
{
    if (skip_test_D1_0029)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFF51);
    WriteRegisterWord(RegisterType::SP, 0xF27A);
    WriteRegisterByte(RegisterType::A, 0x29);
    WriteRegisterByte(RegisterType::B, 0x0D);
    WriteRegisterByte(RegisterType::C, 0x9A);
    WriteRegisterByte(RegisterType::D, 0x0E);
    WriteRegisterByte(RegisterType::E, 0x28);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x01);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF51, 0xD1);
    WriteMemory(0xF27B, 0x05);
    WriteMemory(0xF27A, 0x79);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x29);
    CheckRegisterByte(RegisterType::B, 0x0D);
    CheckRegisterByte(RegisterType::C, 0x9A);
    CheckRegisterByte(RegisterType::D, 0x05);
    CheckRegisterByte(RegisterType::E, 0x79);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x01);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0xFF52);
    CheckRegisterWord(RegisterType::SP, 0xF27C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF27A, 0x79);
    CheckMemory(0xF27B, 0x05);
    CheckMemory(0xFF51, 0xD1);
}

void test_D1_002A()
{
    if (skip_test_D1_002A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC33A);
    WriteRegisterWord(RegisterType::SP, 0x6968);
    WriteRegisterByte(RegisterType::A, 0x11);
    WriteRegisterByte(RegisterType::B, 0xC7);
    WriteRegisterByte(RegisterType::C, 0xBD);
    WriteRegisterByte(RegisterType::D, 0x1B);
    WriteRegisterByte(RegisterType::E, 0x2A);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xCF);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC33A, 0xD1);
    WriteMemory(0x6969, 0x4E);
    WriteMemory(0x6968, 0xB3);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x11);
    CheckRegisterByte(RegisterType::B, 0xC7);
    CheckRegisterByte(RegisterType::C, 0xBD);
    CheckRegisterByte(RegisterType::D, 0x4E);
    CheckRegisterByte(RegisterType::E, 0xB3);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xCF);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0xC33B);
    CheckRegisterWord(RegisterType::SP, 0x696A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6968, 0xB3);
    CheckMemory(0x6969, 0x4E);
    CheckMemory(0xC33A, 0xD1);
}

void test_D1_002B()
{
    if (skip_test_D1_002B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7092);
    WriteRegisterWord(RegisterType::SP, 0x0F26);
    WriteRegisterByte(RegisterType::A, 0x0D);
    WriteRegisterByte(RegisterType::B, 0x9C);
    WriteRegisterByte(RegisterType::C, 0x81);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0x65);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xFF);
    WriteRegisterByte(RegisterType::L, 0x68);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7092, 0xD1);
    WriteMemory(0x0F27, 0x2A);
    WriteMemory(0x0F26, 0x00);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0D);
    CheckRegisterByte(RegisterType::B, 0x9C);
    CheckRegisterByte(RegisterType::C, 0x81);
    CheckRegisterByte(RegisterType::D, 0x2A);
    CheckRegisterByte(RegisterType::E, 0x00);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xFF);
    CheckRegisterByte(RegisterType::L, 0x68);
    CheckRegisterWord(RegisterType::PC, 0x7093);
    CheckRegisterWord(RegisterType::SP, 0x0F28);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0F26, 0x00);
    CheckMemory(0x0F27, 0x2A);
    CheckMemory(0x7092, 0xD1);
}

void test_D1_002C()
{
    if (skip_test_D1_002C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7129);
    WriteRegisterWord(RegisterType::SP, 0x442E);
    WriteRegisterByte(RegisterType::A, 0x29);
    WriteRegisterByte(RegisterType::B, 0x37);
    WriteRegisterByte(RegisterType::C, 0xD8);
    WriteRegisterByte(RegisterType::D, 0xA3);
    WriteRegisterByte(RegisterType::E, 0x8A);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x6D);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7129, 0xD1);
    WriteMemory(0x442F, 0x64);
    WriteMemory(0x442E, 0xA2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x29);
    CheckRegisterByte(RegisterType::B, 0x37);
    CheckRegisterByte(RegisterType::C, 0xD8);
    CheckRegisterByte(RegisterType::D, 0x64);
    CheckRegisterByte(RegisterType::E, 0xA2);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x6D);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0x712A);
    CheckRegisterWord(RegisterType::SP, 0x4430);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x442E, 0xA2);
    CheckMemory(0x442F, 0x64);
    CheckMemory(0x7129, 0xD1);
}

void test_D1_002D()
{
    if (skip_test_D1_002D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9217);
    WriteRegisterWord(RegisterType::SP, 0xD480);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0x8A);
    WriteRegisterByte(RegisterType::C, 0x06);
    WriteRegisterByte(RegisterType::D, 0x86);
    WriteRegisterByte(RegisterType::E, 0xB8);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x52);
    WriteRegisterByte(RegisterType::L, 0x0E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD481, 0x1B);
    WriteMemory(0xD480, 0xBD);
    WriteMemory(0x9217, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0x8A);
    CheckRegisterByte(RegisterType::C, 0x06);
    CheckRegisterByte(RegisterType::D, 0x1B);
    CheckRegisterByte(RegisterType::E, 0xBD);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x52);
    CheckRegisterByte(RegisterType::L, 0x0E);
    CheckRegisterWord(RegisterType::PC, 0x9218);
    CheckRegisterWord(RegisterType::SP, 0xD482);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9217, 0xD1);
    CheckMemory(0xD480, 0xBD);
    CheckMemory(0xD481, 0x1B);
}

void test_D1_002E()
{
    if (skip_test_D1_002E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0A61);
    WriteRegisterWord(RegisterType::SP, 0xCC2D);
    WriteRegisterByte(RegisterType::A, 0x19);
    WriteRegisterByte(RegisterType::B, 0xE0);
    WriteRegisterByte(RegisterType::C, 0x84);
    WriteRegisterByte(RegisterType::D, 0x05);
    WriteRegisterByte(RegisterType::E, 0xB8);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xC8);
    WriteRegisterByte(RegisterType::L, 0xE8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCC2E, 0x84);
    WriteMemory(0xCC2D, 0xBC);
    WriteMemory(0x0A61, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x19);
    CheckRegisterByte(RegisterType::B, 0xE0);
    CheckRegisterByte(RegisterType::C, 0x84);
    CheckRegisterByte(RegisterType::D, 0x84);
    CheckRegisterByte(RegisterType::E, 0xBC);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xC8);
    CheckRegisterByte(RegisterType::L, 0xE8);
    CheckRegisterWord(RegisterType::PC, 0x0A62);
    CheckRegisterWord(RegisterType::SP, 0xCC2F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0A61, 0xD1);
    CheckMemory(0xCC2D, 0xBC);
    CheckMemory(0xCC2E, 0x84);
}

void test_D1_002F()
{
    if (skip_test_D1_002F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6599);
    WriteRegisterWord(RegisterType::SP, 0x20CC);
    WriteRegisterByte(RegisterType::A, 0xF4);
    WriteRegisterByte(RegisterType::B, 0x11);
    WriteRegisterByte(RegisterType::C, 0x42);
    WriteRegisterByte(RegisterType::D, 0xB4);
    WriteRegisterByte(RegisterType::E, 0x87);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0xED);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6599, 0xD1);
    WriteMemory(0x20CD, 0x48);
    WriteMemory(0x20CC, 0xB0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF4);
    CheckRegisterByte(RegisterType::B, 0x11);
    CheckRegisterByte(RegisterType::C, 0x42);
    CheckRegisterByte(RegisterType::D, 0x48);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0xED);
    CheckRegisterWord(RegisterType::PC, 0x659A);
    CheckRegisterWord(RegisterType::SP, 0x20CE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x20CC, 0xB0);
    CheckMemory(0x20CD, 0x48);
    CheckMemory(0x6599, 0xD1);
}

void test_D1_0030()
{
    if (skip_test_D1_0030)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0F2C);
    WriteRegisterWord(RegisterType::SP, 0x0000);
    WriteRegisterByte(RegisterType::A, 0x81);
    WriteRegisterByte(RegisterType::B, 0x13);
    WriteRegisterByte(RegisterType::C, 0x0F);
    WriteRegisterByte(RegisterType::D, 0xE8);
    WriteRegisterByte(RegisterType::E, 0xF1);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xAE);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x0F2C, 0xD1);
    WriteMemory(0x0001, 0x1F);
    WriteMemory(0x0000, 0xA6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x81);
    CheckRegisterByte(RegisterType::B, 0x13);
    CheckRegisterByte(RegisterType::C, 0x0F);
    CheckRegisterByte(RegisterType::D, 0x1F);
    CheckRegisterByte(RegisterType::E, 0xA6);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xAE);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0x0F2D);
    CheckRegisterWord(RegisterType::SP, 0x0002);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0000, 0xA6);
    CheckMemory(0x0001, 0x1F);
    CheckMemory(0x0F2C, 0xD1);
}

void test_D1_0031()
{
    if (skip_test_D1_0031)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3B05);
    WriteRegisterWord(RegisterType::SP, 0xF46D);
    WriteRegisterByte(RegisterType::A, 0x6B);
    WriteRegisterByte(RegisterType::B, 0x23);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0xBE);
    WriteRegisterByte(RegisterType::E, 0x65);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0x93);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF46E, 0x6D);
    WriteMemory(0xF46D, 0x4D);
    WriteMemory(0x3B05, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6B);
    CheckRegisterByte(RegisterType::B, 0x23);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0x6D);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0x93);
    CheckRegisterWord(RegisterType::PC, 0x3B06);
    CheckRegisterWord(RegisterType::SP, 0xF46F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3B05, 0xD1);
    CheckMemory(0xF46D, 0x4D);
    CheckMemory(0xF46E, 0x6D);
}

void test_D1_0032()
{
    if (skip_test_D1_0032)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4239);
    WriteRegisterWord(RegisterType::SP, 0x47BE);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0x27);
    WriteRegisterByte(RegisterType::D, 0x7D);
    WriteRegisterByte(RegisterType::E, 0xC4);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x32);
    WriteRegisterByte(RegisterType::L, 0xA2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x47BF, 0x1B);
    WriteMemory(0x47BE, 0x2D);
    WriteMemory(0x4239, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0x27);
    CheckRegisterByte(RegisterType::D, 0x1B);
    CheckRegisterByte(RegisterType::E, 0x2D);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x32);
    CheckRegisterByte(RegisterType::L, 0xA2);
    CheckRegisterWord(RegisterType::PC, 0x423A);
    CheckRegisterWord(RegisterType::SP, 0x47C0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4239, 0xD1);
    CheckMemory(0x47BE, 0x2D);
    CheckMemory(0x47BF, 0x1B);
}

void test_D1_0033()
{
    if (skip_test_D1_0033)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2414);
    WriteRegisterWord(RegisterType::SP, 0xFDB4);
    WriteRegisterByte(RegisterType::A, 0x1D);
    WriteRegisterByte(RegisterType::B, 0x64);
    WriteRegisterByte(RegisterType::C, 0xB7);
    WriteRegisterByte(RegisterType::D, 0xCD);
    WriteRegisterByte(RegisterType::E, 0xF1);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xAC);
    WriteRegisterByte(RegisterType::L, 0xFC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFDB5, 0x02);
    WriteMemory(0xFDB4, 0xD1);
    WriteMemory(0x2414, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1D);
    CheckRegisterByte(RegisterType::B, 0x64);
    CheckRegisterByte(RegisterType::C, 0xB7);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xAC);
    CheckRegisterByte(RegisterType::L, 0xFC);
    CheckRegisterWord(RegisterType::PC, 0x2415);
    CheckRegisterWord(RegisterType::SP, 0xFDB6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2414, 0xD1);
    CheckMemory(0xFDB4, 0xD1);
    CheckMemory(0xFDB5, 0x02);
}

void test_D1_0034()
{
    if (skip_test_D1_0034)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x619A);
    WriteRegisterWord(RegisterType::SP, 0xD4A8);
    WriteRegisterByte(RegisterType::A, 0x52);
    WriteRegisterByte(RegisterType::B, 0x2D);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0x8D);
    WriteRegisterByte(RegisterType::E, 0x8E);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x99);
    WriteRegisterByte(RegisterType::L, 0x50);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD4A9, 0x73);
    WriteMemory(0xD4A8, 0xEA);
    WriteMemory(0x619A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x52);
    CheckRegisterByte(RegisterType::B, 0x2D);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0x73);
    CheckRegisterByte(RegisterType::E, 0xEA);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x99);
    CheckRegisterByte(RegisterType::L, 0x50);
    CheckRegisterWord(RegisterType::PC, 0x619B);
    CheckRegisterWord(RegisterType::SP, 0xD4AA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x619A, 0xD1);
    CheckMemory(0xD4A8, 0xEA);
    CheckMemory(0xD4A9, 0x73);
}

void test_D1_0035()
{
    if (skip_test_D1_0035)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFEFC);
    WriteRegisterWord(RegisterType::SP, 0x2563);
    WriteRegisterByte(RegisterType::A, 0x9A);
    WriteRegisterByte(RegisterType::B, 0xE0);
    WriteRegisterByte(RegisterType::C, 0xD8);
    WriteRegisterByte(RegisterType::D, 0x6D);
    WriteRegisterByte(RegisterType::E, 0x88);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x00);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFEFC, 0xD1);
    WriteMemory(0x2564, 0xDB);
    WriteMemory(0x2563, 0x6F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9A);
    CheckRegisterByte(RegisterType::B, 0xE0);
    CheckRegisterByte(RegisterType::C, 0xD8);
    CheckRegisterByte(RegisterType::D, 0xDB);
    CheckRegisterByte(RegisterType::E, 0x6F);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x00);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0xFEFD);
    CheckRegisterWord(RegisterType::SP, 0x2565);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2563, 0x6F);
    CheckMemory(0x2564, 0xDB);
    CheckMemory(0xFEFC, 0xD1);
}

void test_D1_0036()
{
    if (skip_test_D1_0036)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4404);
    WriteRegisterWord(RegisterType::SP, 0x6558);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0x59);
    WriteRegisterByte(RegisterType::C, 0x9D);
    WriteRegisterByte(RegisterType::D, 0x98);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x91);
    WriteRegisterByte(RegisterType::L, 0xC4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6559, 0xA2);
    WriteMemory(0x6558, 0x6B);
    WriteMemory(0x4404, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0x59);
    CheckRegisterByte(RegisterType::C, 0x9D);
    CheckRegisterByte(RegisterType::D, 0xA2);
    CheckRegisterByte(RegisterType::E, 0x6B);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x91);
    CheckRegisterByte(RegisterType::L, 0xC4);
    CheckRegisterWord(RegisterType::PC, 0x4405);
    CheckRegisterWord(RegisterType::SP, 0x655A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4404, 0xD1);
    CheckMemory(0x6558, 0x6B);
    CheckMemory(0x6559, 0xA2);
}

void test_D1_0037()
{
    if (skip_test_D1_0037)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD487);
    WriteRegisterWord(RegisterType::SP, 0xF312);
    WriteRegisterByte(RegisterType::A, 0x6A);
    WriteRegisterByte(RegisterType::B, 0x50);
    WriteRegisterByte(RegisterType::C, 0x45);
    WriteRegisterByte(RegisterType::D, 0x36);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x70);
    WriteRegisterByte(RegisterType::L, 0x9A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF313, 0x7D);
    WriteMemory(0xF312, 0x66);
    WriteMemory(0xD487, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6A);
    CheckRegisterByte(RegisterType::B, 0x50);
    CheckRegisterByte(RegisterType::C, 0x45);
    CheckRegisterByte(RegisterType::D, 0x7D);
    CheckRegisterByte(RegisterType::E, 0x66);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x70);
    CheckRegisterByte(RegisterType::L, 0x9A);
    CheckRegisterWord(RegisterType::PC, 0xD488);
    CheckRegisterWord(RegisterType::SP, 0xF314);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD487, 0xD1);
    CheckMemory(0xF312, 0x66);
    CheckMemory(0xF313, 0x7D);
}

void test_D1_0038()
{
    if (skip_test_D1_0038)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBB50);
    WriteRegisterWord(RegisterType::SP, 0xD8D2);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0xF7);
    WriteRegisterByte(RegisterType::D, 0x39);
    WriteRegisterByte(RegisterType::E, 0xD3);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xFE);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD8D3, 0x3E);
    WriteMemory(0xD8D2, 0xE3);
    WriteMemory(0xBB50, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0xF7);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0xE3);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xFE);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0xBB51);
    CheckRegisterWord(RegisterType::SP, 0xD8D4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBB50, 0xD1);
    CheckMemory(0xD8D2, 0xE3);
    CheckMemory(0xD8D3, 0x3E);
}

void test_D1_0039()
{
    if (skip_test_D1_0039)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6D4C);
    WriteRegisterWord(RegisterType::SP, 0x650B);
    WriteRegisterByte(RegisterType::A, 0x63);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0x19);
    WriteRegisterByte(RegisterType::E, 0xBE);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xC5);
    WriteRegisterByte(RegisterType::L, 0xCE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6D4C, 0xD1);
    WriteMemory(0x650C, 0x48);
    WriteMemory(0x650B, 0x3A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x63);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0x48);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xC5);
    CheckRegisterByte(RegisterType::L, 0xCE);
    CheckRegisterWord(RegisterType::PC, 0x6D4D);
    CheckRegisterWord(RegisterType::SP, 0x650D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x650B, 0x3A);
    CheckMemory(0x650C, 0x48);
    CheckMemory(0x6D4C, 0xD1);
}

void test_D1_003A()
{
    if (skip_test_D1_003A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBAD5);
    WriteRegisterWord(RegisterType::SP, 0x38EE);
    WriteRegisterByte(RegisterType::A, 0x75);
    WriteRegisterByte(RegisterType::B, 0x77);
    WriteRegisterByte(RegisterType::C, 0xCC);
    WriteRegisterByte(RegisterType::D, 0x9D);
    WriteRegisterByte(RegisterType::E, 0xED);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0xF6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBAD5, 0xD1);
    WriteMemory(0x38EF, 0xA6);
    WriteMemory(0x38EE, 0xD0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x75);
    CheckRegisterByte(RegisterType::B, 0x77);
    CheckRegisterByte(RegisterType::C, 0xCC);
    CheckRegisterByte(RegisterType::D, 0xA6);
    CheckRegisterByte(RegisterType::E, 0xD0);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0xF6);
    CheckRegisterWord(RegisterType::PC, 0xBAD6);
    CheckRegisterWord(RegisterType::SP, 0x38F0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x38EE, 0xD0);
    CheckMemory(0x38EF, 0xA6);
    CheckMemory(0xBAD5, 0xD1);
}

void test_D1_003B()
{
    if (skip_test_D1_003B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA888);
    WriteRegisterWord(RegisterType::SP, 0xE39E);
    WriteRegisterByte(RegisterType::A, 0x22);
    WriteRegisterByte(RegisterType::B, 0xA9);
    WriteRegisterByte(RegisterType::C, 0x9C);
    WriteRegisterByte(RegisterType::D, 0x24);
    WriteRegisterByte(RegisterType::E, 0xC3);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xA6);
    WriteRegisterByte(RegisterType::L, 0x86);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE39F, 0xF8);
    WriteMemory(0xE39E, 0x6E);
    WriteMemory(0xA888, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x22);
    CheckRegisterByte(RegisterType::B, 0xA9);
    CheckRegisterByte(RegisterType::C, 0x9C);
    CheckRegisterByte(RegisterType::D, 0xF8);
    CheckRegisterByte(RegisterType::E, 0x6E);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xA6);
    CheckRegisterByte(RegisterType::L, 0x86);
    CheckRegisterWord(RegisterType::PC, 0xA889);
    CheckRegisterWord(RegisterType::SP, 0xE3A0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA888, 0xD1);
    CheckMemory(0xE39E, 0x6E);
    CheckMemory(0xE39F, 0xF8);
}

void test_D1_003C()
{
    if (skip_test_D1_003C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x35E2);
    WriteRegisterWord(RegisterType::SP, 0x8FD5);
    WriteRegisterByte(RegisterType::A, 0x98);
    WriteRegisterByte(RegisterType::B, 0x5B);
    WriteRegisterByte(RegisterType::C, 0xD3);
    WriteRegisterByte(RegisterType::D, 0xFB);
    WriteRegisterByte(RegisterType::E, 0x71);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xE4);
    WriteRegisterByte(RegisterType::L, 0x52);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x8FD6, 0x70);
    WriteMemory(0x8FD5, 0x4D);
    WriteMemory(0x35E2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x98);
    CheckRegisterByte(RegisterType::B, 0x5B);
    CheckRegisterByte(RegisterType::C, 0xD3);
    CheckRegisterByte(RegisterType::D, 0x70);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xE4);
    CheckRegisterByte(RegisterType::L, 0x52);
    CheckRegisterWord(RegisterType::PC, 0x35E3);
    CheckRegisterWord(RegisterType::SP, 0x8FD7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x35E2, 0xD1);
    CheckMemory(0x8FD5, 0x4D);
    CheckMemory(0x8FD6, 0x70);
}

void test_D1_003D()
{
    if (skip_test_D1_003D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3A0D);
    WriteRegisterWord(RegisterType::SP, 0xC25B);
    WriteRegisterByte(RegisterType::A, 0xE4);
    WriteRegisterByte(RegisterType::B, 0x6B);
    WriteRegisterByte(RegisterType::C, 0xB8);
    WriteRegisterByte(RegisterType::D, 0x6F);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x35);
    WriteRegisterByte(RegisterType::L, 0xF8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC25C, 0xF5);
    WriteMemory(0xC25B, 0x88);
    WriteMemory(0x3A0D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE4);
    CheckRegisterByte(RegisterType::B, 0x6B);
    CheckRegisterByte(RegisterType::C, 0xB8);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x35);
    CheckRegisterByte(RegisterType::L, 0xF8);
    CheckRegisterWord(RegisterType::PC, 0x3A0E);
    CheckRegisterWord(RegisterType::SP, 0xC25D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3A0D, 0xD1);
    CheckMemory(0xC25B, 0x88);
    CheckMemory(0xC25C, 0xF5);
}

void test_D1_003E()
{
    if (skip_test_D1_003E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA94B);
    WriteRegisterWord(RegisterType::SP, 0x0828);
    WriteRegisterByte(RegisterType::A, 0x75);
    WriteRegisterByte(RegisterType::B, 0x74);
    WriteRegisterByte(RegisterType::C, 0xBF);
    WriteRegisterByte(RegisterType::D, 0xBD);
    WriteRegisterByte(RegisterType::E, 0x08);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xE6);
    WriteRegisterByte(RegisterType::L, 0xB6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA94B, 0xD1);
    WriteMemory(0x0829, 0xFF);
    WriteMemory(0x0828, 0x83);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x75);
    CheckRegisterByte(RegisterType::B, 0x74);
    CheckRegisterByte(RegisterType::C, 0xBF);
    CheckRegisterByte(RegisterType::D, 0xFF);
    CheckRegisterByte(RegisterType::E, 0x83);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xE6);
    CheckRegisterByte(RegisterType::L, 0xB6);
    CheckRegisterWord(RegisterType::PC, 0xA94C);
    CheckRegisterWord(RegisterType::SP, 0x082A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0828, 0x83);
    CheckMemory(0x0829, 0xFF);
    CheckMemory(0xA94B, 0xD1);
}

void test_D1_003F()
{
    if (skip_test_D1_003F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE93E);
    WriteRegisterWord(RegisterType::SP, 0x5824);
    WriteRegisterByte(RegisterType::A, 0xED);
    WriteRegisterByte(RegisterType::B, 0x10);
    WriteRegisterByte(RegisterType::C, 0x89);
    WriteRegisterByte(RegisterType::D, 0xB2);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xE4);
    WriteRegisterByte(RegisterType::L, 0x04);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE93E, 0xD1);
    WriteMemory(0x5825, 0x4A);
    WriteMemory(0x5824, 0x0D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xED);
    CheckRegisterByte(RegisterType::B, 0x10);
    CheckRegisterByte(RegisterType::C, 0x89);
    CheckRegisterByte(RegisterType::D, 0x4A);
    CheckRegisterByte(RegisterType::E, 0x0D);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xE4);
    CheckRegisterByte(RegisterType::L, 0x04);
    CheckRegisterWord(RegisterType::PC, 0xE93F);
    CheckRegisterWord(RegisterType::SP, 0x5826);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5824, 0x0D);
    CheckMemory(0x5825, 0x4A);
    CheckMemory(0xE93E, 0xD1);
}

void test_D1_0040()
{
    if (skip_test_D1_0040)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD257);
    WriteRegisterWord(RegisterType::SP, 0x45CD);
    WriteRegisterByte(RegisterType::A, 0xB9);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0xF8);
    WriteRegisterByte(RegisterType::D, 0x6E);
    WriteRegisterByte(RegisterType::E, 0x80);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xE5);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD257, 0xD1);
    WriteMemory(0x45CE, 0xC2);
    WriteMemory(0x45CD, 0x2F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB9);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0xF8);
    CheckRegisterByte(RegisterType::D, 0xC2);
    CheckRegisterByte(RegisterType::E, 0x2F);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xE5);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0xD258);
    CheckRegisterWord(RegisterType::SP, 0x45CF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x45CD, 0x2F);
    CheckMemory(0x45CE, 0xC2);
    CheckMemory(0xD257, 0xD1);
}

void test_D1_0041()
{
    if (skip_test_D1_0041)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFAF4);
    WriteRegisterWord(RegisterType::SP, 0x4B6A);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0xB7);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x54);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFAF4, 0xD1);
    WriteMemory(0x4B6B, 0x80);
    WriteMemory(0x4B6A, 0xFA);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0x80);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x54);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0xFAF5);
    CheckRegisterWord(RegisterType::SP, 0x4B6C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4B6A, 0xFA);
    CheckMemory(0x4B6B, 0x80);
    CheckMemory(0xFAF4, 0xD1);
}

void test_D1_0042()
{
    if (skip_test_D1_0042)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7126);
    WriteRegisterWord(RegisterType::SP, 0x3367);
    WriteRegisterByte(RegisterType::A, 0x8E);
    WriteRegisterByte(RegisterType::B, 0x26);
    WriteRegisterByte(RegisterType::C, 0xC6);
    WriteRegisterByte(RegisterType::D, 0xC2);
    WriteRegisterByte(RegisterType::E, 0xC6);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x6B);
    WriteRegisterByte(RegisterType::L, 0x5E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7126, 0xD1);
    WriteMemory(0x3368, 0x91);
    WriteMemory(0x3367, 0x77);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8E);
    CheckRegisterByte(RegisterType::B, 0x26);
    CheckRegisterByte(RegisterType::C, 0xC6);
    CheckRegisterByte(RegisterType::D, 0x91);
    CheckRegisterByte(RegisterType::E, 0x77);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x6B);
    CheckRegisterByte(RegisterType::L, 0x5E);
    CheckRegisterWord(RegisterType::PC, 0x7127);
    CheckRegisterWord(RegisterType::SP, 0x3369);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3367, 0x77);
    CheckMemory(0x3368, 0x91);
    CheckMemory(0x7126, 0xD1);
}

void test_D1_0043()
{
    if (skip_test_D1_0043)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE8C8);
    WriteRegisterWord(RegisterType::SP, 0x329F);
    WriteRegisterByte(RegisterType::A, 0xBE);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0x98);
    WriteRegisterByte(RegisterType::D, 0x15);
    WriteRegisterByte(RegisterType::E, 0x8E);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0xE2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE8C8, 0xD1);
    WriteMemory(0x32A0, 0xF9);
    WriteMemory(0x329F, 0xDC);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBE);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0x98);
    CheckRegisterByte(RegisterType::D, 0xF9);
    CheckRegisterByte(RegisterType::E, 0xDC);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0xE2);
    CheckRegisterWord(RegisterType::PC, 0xE8C9);
    CheckRegisterWord(RegisterType::SP, 0x32A1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x329F, 0xDC);
    CheckMemory(0x32A0, 0xF9);
    CheckMemory(0xE8C8, 0xD1);
}

void test_D1_0044()
{
    if (skip_test_D1_0044)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x447A);
    WriteRegisterWord(RegisterType::SP, 0x5FAE);
    WriteRegisterByte(RegisterType::A, 0x97);
    WriteRegisterByte(RegisterType::B, 0xB8);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0x51);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xB7);
    WriteRegisterByte(RegisterType::L, 0xD3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5FAF, 0xD4);
    WriteMemory(0x5FAE, 0x0D);
    WriteMemory(0x447A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x97);
    CheckRegisterByte(RegisterType::B, 0xB8);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0xD4);
    CheckRegisterByte(RegisterType::E, 0x0D);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xB7);
    CheckRegisterByte(RegisterType::L, 0xD3);
    CheckRegisterWord(RegisterType::PC, 0x447B);
    CheckRegisterWord(RegisterType::SP, 0x5FB0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x447A, 0xD1);
    CheckMemory(0x5FAE, 0x0D);
    CheckMemory(0x5FAF, 0xD4);
}

void test_D1_0045()
{
    if (skip_test_D1_0045)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCCF0);
    WriteRegisterWord(RegisterType::SP, 0xFADB);
    WriteRegisterByte(RegisterType::A, 0x03);
    WriteRegisterByte(RegisterType::B, 0x17);
    WriteRegisterByte(RegisterType::C, 0xA2);
    WriteRegisterByte(RegisterType::D, 0xA5);
    WriteRegisterByte(RegisterType::E, 0x92);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xB3);
    WriteRegisterByte(RegisterType::L, 0x96);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFADC, 0xE8);
    WriteMemory(0xFADB, 0xE3);
    WriteMemory(0xCCF0, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x03);
    CheckRegisterByte(RegisterType::B, 0x17);
    CheckRegisterByte(RegisterType::C, 0xA2);
    CheckRegisterByte(RegisterType::D, 0xE8);
    CheckRegisterByte(RegisterType::E, 0xE3);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xB3);
    CheckRegisterByte(RegisterType::L, 0x96);
    CheckRegisterWord(RegisterType::PC, 0xCCF1);
    CheckRegisterWord(RegisterType::SP, 0xFADD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCCF0, 0xD1);
    CheckMemory(0xFADB, 0xE3);
    CheckMemory(0xFADC, 0xE8);
}

void test_D1_0046()
{
    if (skip_test_D1_0046)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3C8D);
    WriteRegisterWord(RegisterType::SP, 0x1DC8);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0x38);
    WriteRegisterByte(RegisterType::C, 0xE3);
    WriteRegisterByte(RegisterType::D, 0x6F);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xD9);
    WriteRegisterByte(RegisterType::L, 0x35);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x3C8D, 0xD1);
    WriteMemory(0x1DC9, 0x9B);
    WriteMemory(0x1DC8, 0x73);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0x38);
    CheckRegisterByte(RegisterType::C, 0xE3);
    CheckRegisterByte(RegisterType::D, 0x9B);
    CheckRegisterByte(RegisterType::E, 0x73);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xD9);
    CheckRegisterByte(RegisterType::L, 0x35);
    CheckRegisterWord(RegisterType::PC, 0x3C8E);
    CheckRegisterWord(RegisterType::SP, 0x1DCA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1DC8, 0x73);
    CheckMemory(0x1DC9, 0x9B);
    CheckMemory(0x3C8D, 0xD1);
}

void test_D1_0047()
{
    if (skip_test_D1_0047)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x588C);
    WriteRegisterWord(RegisterType::SP, 0x1541);
    WriteRegisterByte(RegisterType::A, 0xEB);
    WriteRegisterByte(RegisterType::B, 0x11);
    WriteRegisterByte(RegisterType::C, 0x4A);
    WriteRegisterByte(RegisterType::D, 0x15);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x57);
    WriteRegisterByte(RegisterType::L, 0xCB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x588C, 0xD1);
    WriteMemory(0x1542, 0x4A);
    WriteMemory(0x1541, 0xB0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEB);
    CheckRegisterByte(RegisterType::B, 0x11);
    CheckRegisterByte(RegisterType::C, 0x4A);
    CheckRegisterByte(RegisterType::D, 0x4A);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x57);
    CheckRegisterByte(RegisterType::L, 0xCB);
    CheckRegisterWord(RegisterType::PC, 0x588D);
    CheckRegisterWord(RegisterType::SP, 0x1543);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1541, 0xB0);
    CheckMemory(0x1542, 0x4A);
    CheckMemory(0x588C, 0xD1);
}

void test_D1_0048()
{
    if (skip_test_D1_0048)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x977A);
    WriteRegisterWord(RegisterType::SP, 0x5284);
    WriteRegisterByte(RegisterType::A, 0x1E);
    WriteRegisterByte(RegisterType::B, 0x71);
    WriteRegisterByte(RegisterType::C, 0x92);
    WriteRegisterByte(RegisterType::D, 0xC5);
    WriteRegisterByte(RegisterType::E, 0x78);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xA9);
    WriteRegisterByte(RegisterType::L, 0x03);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x977A, 0xD1);
    WriteMemory(0x5285, 0xB4);
    WriteMemory(0x5284, 0x1A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1E);
    CheckRegisterByte(RegisterType::B, 0x71);
    CheckRegisterByte(RegisterType::C, 0x92);
    CheckRegisterByte(RegisterType::D, 0xB4);
    CheckRegisterByte(RegisterType::E, 0x1A);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xA9);
    CheckRegisterByte(RegisterType::L, 0x03);
    CheckRegisterWord(RegisterType::PC, 0x977B);
    CheckRegisterWord(RegisterType::SP, 0x5286);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5284, 0x1A);
    CheckMemory(0x5285, 0xB4);
    CheckMemory(0x977A, 0xD1);
}

void test_D1_0049()
{
    if (skip_test_D1_0049)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0A4D);
    WriteRegisterWord(RegisterType::SP, 0xC5E8);
    WriteRegisterByte(RegisterType::A, 0x54);
    WriteRegisterByte(RegisterType::B, 0xA5);
    WriteRegisterByte(RegisterType::C, 0xD9);
    WriteRegisterByte(RegisterType::D, 0x0E);
    WriteRegisterByte(RegisterType::E, 0xBE);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x90);
    WriteRegisterByte(RegisterType::L, 0xAB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC5E9, 0xE2);
    WriteMemory(0xC5E8, 0xCC);
    WriteMemory(0x0A4D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x54);
    CheckRegisterByte(RegisterType::B, 0xA5);
    CheckRegisterByte(RegisterType::C, 0xD9);
    CheckRegisterByte(RegisterType::D, 0xE2);
    CheckRegisterByte(RegisterType::E, 0xCC);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x90);
    CheckRegisterByte(RegisterType::L, 0xAB);
    CheckRegisterWord(RegisterType::PC, 0x0A4E);
    CheckRegisterWord(RegisterType::SP, 0xC5EA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0A4D, 0xD1);
    CheckMemory(0xC5E8, 0xCC);
    CheckMemory(0xC5E9, 0xE2);
}

void test_D1_004A()
{
    if (skip_test_D1_004A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0751);
    WriteRegisterWord(RegisterType::SP, 0x18B3);
    WriteRegisterByte(RegisterType::A, 0x3A);
    WriteRegisterByte(RegisterType::B, 0xA2);
    WriteRegisterByte(RegisterType::C, 0x66);
    WriteRegisterByte(RegisterType::D, 0xC7);
    WriteRegisterByte(RegisterType::E, 0xC2);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xBB);
    WriteRegisterByte(RegisterType::L, 0x1F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x18B4, 0xD6);
    WriteMemory(0x18B3, 0xBD);
    WriteMemory(0x0751, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3A);
    CheckRegisterByte(RegisterType::B, 0xA2);
    CheckRegisterByte(RegisterType::C, 0x66);
    CheckRegisterByte(RegisterType::D, 0xD6);
    CheckRegisterByte(RegisterType::E, 0xBD);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xBB);
    CheckRegisterByte(RegisterType::L, 0x1F);
    CheckRegisterWord(RegisterType::PC, 0x0752);
    CheckRegisterWord(RegisterType::SP, 0x18B5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0751, 0xD1);
    CheckMemory(0x18B3, 0xBD);
    CheckMemory(0x18B4, 0xD6);
}

void test_D1_004B()
{
    if (skip_test_D1_004B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5A93);
    WriteRegisterWord(RegisterType::SP, 0xFC0F);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0x22);
    WriteRegisterByte(RegisterType::C, 0xAF);
    WriteRegisterByte(RegisterType::D, 0x18);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x42);
    WriteRegisterByte(RegisterType::L, 0xAE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFC10, 0xF1);
    WriteMemory(0xFC0F, 0x34);
    WriteMemory(0x5A93, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0x22);
    CheckRegisterByte(RegisterType::C, 0xAF);
    CheckRegisterByte(RegisterType::D, 0xF1);
    CheckRegisterByte(RegisterType::E, 0x34);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x42);
    CheckRegisterByte(RegisterType::L, 0xAE);
    CheckRegisterWord(RegisterType::PC, 0x5A94);
    CheckRegisterWord(RegisterType::SP, 0xFC11);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5A93, 0xD1);
    CheckMemory(0xFC0F, 0x34);
    CheckMemory(0xFC10, 0xF1);
}

void test_D1_004C()
{
    if (skip_test_D1_004C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD48);
    WriteRegisterWord(RegisterType::SP, 0xF031);
    WriteRegisterByte(RegisterType::A, 0xED);
    WriteRegisterByte(RegisterType::B, 0x84);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0xA3);
    WriteRegisterByte(RegisterType::E, 0x8D);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xEC);
    WriteRegisterByte(RegisterType::L, 0xE8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF032, 0xE8);
    WriteMemory(0xF031, 0x44);
    WriteMemory(0xCD48, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xED);
    CheckRegisterByte(RegisterType::B, 0x84);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0xE8);
    CheckRegisterByte(RegisterType::E, 0x44);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xEC);
    CheckRegisterByte(RegisterType::L, 0xE8);
    CheckRegisterWord(RegisterType::PC, 0xCD49);
    CheckRegisterWord(RegisterType::SP, 0xF033);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCD48, 0xD1);
    CheckMemory(0xF031, 0x44);
    CheckMemory(0xF032, 0xE8);
}

void test_D1_004D()
{
    if (skip_test_D1_004D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x117A);
    WriteRegisterWord(RegisterType::SP, 0xF24E);
    WriteRegisterByte(RegisterType::A, 0x99);
    WriteRegisterByte(RegisterType::B, 0x9D);
    WriteRegisterByte(RegisterType::C, 0xF3);
    WriteRegisterByte(RegisterType::D, 0xF2);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x70);
    WriteRegisterByte(RegisterType::L, 0x45);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF24F, 0x80);
    WriteMemory(0xF24E, 0xEA);
    WriteMemory(0x117A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x99);
    CheckRegisterByte(RegisterType::B, 0x9D);
    CheckRegisterByte(RegisterType::C, 0xF3);
    CheckRegisterByte(RegisterType::D, 0x80);
    CheckRegisterByte(RegisterType::E, 0xEA);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x70);
    CheckRegisterByte(RegisterType::L, 0x45);
    CheckRegisterWord(RegisterType::PC, 0x117B);
    CheckRegisterWord(RegisterType::SP, 0xF250);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x117A, 0xD1);
    CheckMemory(0xF24E, 0xEA);
    CheckMemory(0xF24F, 0x80);
}

void test_D1_004E()
{
    if (skip_test_D1_004E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDCD4);
    WriteRegisterWord(RegisterType::SP, 0xD1EF);
    WriteRegisterByte(RegisterType::A, 0xA6);
    WriteRegisterByte(RegisterType::B, 0xF3);
    WriteRegisterByte(RegisterType::C, 0xFC);
    WriteRegisterByte(RegisterType::D, 0x70);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x7B);
    WriteRegisterByte(RegisterType::L, 0x27);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDCD4, 0xD1);
    WriteMemory(0xD1F0, 0x23);
    WriteMemory(0xD1EF, 0x86);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA6);
    CheckRegisterByte(RegisterType::B, 0xF3);
    CheckRegisterByte(RegisterType::C, 0xFC);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0x86);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x7B);
    CheckRegisterByte(RegisterType::L, 0x27);
    CheckRegisterWord(RegisterType::PC, 0xDCD5);
    CheckRegisterWord(RegisterType::SP, 0xD1F1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD1EF, 0x86);
    CheckMemory(0xD1F0, 0x23);
    CheckMemory(0xDCD4, 0xD1);
}

void test_D1_004F()
{
    if (skip_test_D1_004F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFAB7);
    WriteRegisterWord(RegisterType::SP, 0x1585);
    WriteRegisterByte(RegisterType::A, 0xD5);
    WriteRegisterByte(RegisterType::B, 0xE5);
    WriteRegisterByte(RegisterType::C, 0x3D);
    WriteRegisterByte(RegisterType::D, 0xF0);
    WriteRegisterByte(RegisterType::E, 0x92);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xAF);
    WriteRegisterByte(RegisterType::L, 0xEB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFAB7, 0xD1);
    WriteMemory(0x1586, 0x9B);
    WriteMemory(0x1585, 0xE7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD5);
    CheckRegisterByte(RegisterType::B, 0xE5);
    CheckRegisterByte(RegisterType::C, 0x3D);
    CheckRegisterByte(RegisterType::D, 0x9B);
    CheckRegisterByte(RegisterType::E, 0xE7);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xAF);
    CheckRegisterByte(RegisterType::L, 0xEB);
    CheckRegisterWord(RegisterType::PC, 0xFAB8);
    CheckRegisterWord(RegisterType::SP, 0x1587);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1585, 0xE7);
    CheckMemory(0x1586, 0x9B);
    CheckMemory(0xFAB7, 0xD1);
}

void test_D1_0050()
{
    if (skip_test_D1_0050)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD234);
    WriteRegisterWord(RegisterType::SP, 0xC5B4);
    WriteRegisterByte(RegisterType::A, 0x01);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0xB3);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0x4B);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xCE);
    WriteRegisterByte(RegisterType::L, 0xD8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD234, 0xD1);
    WriteMemory(0xC5B5, 0x13);
    WriteMemory(0xC5B4, 0xC5);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x01);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0xB3);
    CheckRegisterByte(RegisterType::D, 0x13);
    CheckRegisterByte(RegisterType::E, 0xC5);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xCE);
    CheckRegisterByte(RegisterType::L, 0xD8);
    CheckRegisterWord(RegisterType::PC, 0xD235);
    CheckRegisterWord(RegisterType::SP, 0xC5B6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC5B4, 0xC5);
    CheckMemory(0xC5B5, 0x13);
    CheckMemory(0xD234, 0xD1);
}

void test_D1_0051()
{
    if (skip_test_D1_0051)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4440);
    WriteRegisterWord(RegisterType::SP, 0x9814);
    WriteRegisterByte(RegisterType::A, 0xAF);
    WriteRegisterByte(RegisterType::B, 0xD2);
    WriteRegisterByte(RegisterType::C, 0x22);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0x33);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0xF3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9815, 0xF5);
    WriteMemory(0x9814, 0x93);
    WriteMemory(0x4440, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAF);
    CheckRegisterByte(RegisterType::B, 0xD2);
    CheckRegisterByte(RegisterType::C, 0x22);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x93);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0xF3);
    CheckRegisterWord(RegisterType::PC, 0x4441);
    CheckRegisterWord(RegisterType::SP, 0x9816);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4440, 0xD1);
    CheckMemory(0x9814, 0x93);
    CheckMemory(0x9815, 0xF5);
}

void test_D1_0052()
{
    if (skip_test_D1_0052)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x75CF);
    WriteRegisterWord(RegisterType::SP, 0x48A4);
    WriteRegisterByte(RegisterType::A, 0x0A);
    WriteRegisterByte(RegisterType::B, 0x60);
    WriteRegisterByte(RegisterType::C, 0x99);
    WriteRegisterByte(RegisterType::D, 0xD9);
    WriteRegisterByte(RegisterType::E, 0xCE);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x69);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x75CF, 0xD1);
    WriteMemory(0x48A5, 0xAC);
    WriteMemory(0x48A4, 0xD0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0A);
    CheckRegisterByte(RegisterType::B, 0x60);
    CheckRegisterByte(RegisterType::C, 0x99);
    CheckRegisterByte(RegisterType::D, 0xAC);
    CheckRegisterByte(RegisterType::E, 0xD0);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x69);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0x75D0);
    CheckRegisterWord(RegisterType::SP, 0x48A6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x48A4, 0xD0);
    CheckMemory(0x48A5, 0xAC);
    CheckMemory(0x75CF, 0xD1);
}

void test_D1_0053()
{
    if (skip_test_D1_0053)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD1B2);
    WriteRegisterWord(RegisterType::SP, 0x9D29);
    WriteRegisterByte(RegisterType::A, 0xAF);
    WriteRegisterByte(RegisterType::B, 0x56);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0x50);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xE7);
    WriteRegisterByte(RegisterType::L, 0x36);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD1B2, 0xD1);
    WriteMemory(0x9D2A, 0x9F);
    WriteMemory(0x9D29, 0xC0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAF);
    CheckRegisterByte(RegisterType::B, 0x56);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0xC0);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xE7);
    CheckRegisterByte(RegisterType::L, 0x36);
    CheckRegisterWord(RegisterType::PC, 0xD1B3);
    CheckRegisterWord(RegisterType::SP, 0x9D2B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9D29, 0xC0);
    CheckMemory(0x9D2A, 0x9F);
    CheckMemory(0xD1B2, 0xD1);
}

void test_D1_0054()
{
    if (skip_test_D1_0054)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4132);
    WriteRegisterWord(RegisterType::SP, 0x8B9E);
    WriteRegisterByte(RegisterType::A, 0x9D);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0x52);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x4D);
    WriteRegisterByte(RegisterType::L, 0x22);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8B9F, 0x65);
    WriteMemory(0x8B9E, 0x76);
    WriteMemory(0x4132, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9D);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0x76);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x4D);
    CheckRegisterByte(RegisterType::L, 0x22);
    CheckRegisterWord(RegisterType::PC, 0x4133);
    CheckRegisterWord(RegisterType::SP, 0x8BA0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4132, 0xD1);
    CheckMemory(0x8B9E, 0x76);
    CheckMemory(0x8B9F, 0x65);
}

void test_D1_0055()
{
    if (skip_test_D1_0055)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0C41);
    WriteRegisterWord(RegisterType::SP, 0xA172);
    WriteRegisterByte(RegisterType::A, 0x29);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0xFA);
    WriteRegisterByte(RegisterType::D, 0xB5);
    WriteRegisterByte(RegisterType::E, 0x4A);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0x48);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA173, 0x92);
    WriteMemory(0xA172, 0x3A);
    WriteMemory(0x0C41, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x29);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0xFA);
    CheckRegisterByte(RegisterType::D, 0x92);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0x48);
    CheckRegisterWord(RegisterType::PC, 0x0C42);
    CheckRegisterWord(RegisterType::SP, 0xA174);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0C41, 0xD1);
    CheckMemory(0xA172, 0x3A);
    CheckMemory(0xA173, 0x92);
}

void test_D1_0056()
{
    if (skip_test_D1_0056)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0FE5);
    WriteRegisterWord(RegisterType::SP, 0xE19D);
    WriteRegisterByte(RegisterType::A, 0x49);
    WriteRegisterByte(RegisterType::B, 0xE2);
    WriteRegisterByte(RegisterType::C, 0x3A);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD1);
    WriteRegisterByte(RegisterType::L, 0x0A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE19E, 0xC1);
    WriteMemory(0xE19D, 0x31);
    WriteMemory(0x0FE5, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x49);
    CheckRegisterByte(RegisterType::B, 0xE2);
    CheckRegisterByte(RegisterType::C, 0x3A);
    CheckRegisterByte(RegisterType::D, 0xC1);
    CheckRegisterByte(RegisterType::E, 0x31);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD1);
    CheckRegisterByte(RegisterType::L, 0x0A);
    CheckRegisterWord(RegisterType::PC, 0x0FE6);
    CheckRegisterWord(RegisterType::SP, 0xE19F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0FE5, 0xD1);
    CheckMemory(0xE19D, 0x31);
    CheckMemory(0xE19E, 0xC1);
}

void test_D1_0057()
{
    if (skip_test_D1_0057)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6C67);
    WriteRegisterWord(RegisterType::SP, 0x0471);
    WriteRegisterByte(RegisterType::A, 0x04);
    WriteRegisterByte(RegisterType::B, 0x2D);
    WriteRegisterByte(RegisterType::C, 0xC1);
    WriteRegisterByte(RegisterType::D, 0xAD);
    WriteRegisterByte(RegisterType::E, 0x54);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x33);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6C67, 0xD1);
    WriteMemory(0x0472, 0x3A);
    WriteMemory(0x0471, 0xFD);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x04);
    CheckRegisterByte(RegisterType::B, 0x2D);
    CheckRegisterByte(RegisterType::C, 0xC1);
    CheckRegisterByte(RegisterType::D, 0x3A);
    CheckRegisterByte(RegisterType::E, 0xFD);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x33);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0x6C68);
    CheckRegisterWord(RegisterType::SP, 0x0473);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0471, 0xFD);
    CheckMemory(0x0472, 0x3A);
    CheckMemory(0x6C67, 0xD1);
}

void test_D1_0058()
{
    if (skip_test_D1_0058)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6C95);
    WriteRegisterWord(RegisterType::SP, 0x0DA3);
    WriteRegisterByte(RegisterType::A, 0x16);
    WriteRegisterByte(RegisterType::B, 0x58);
    WriteRegisterByte(RegisterType::C, 0xA7);
    WriteRegisterByte(RegisterType::D, 0x19);
    WriteRegisterByte(RegisterType::E, 0x04);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0xBB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6C95, 0xD1);
    WriteMemory(0x0DA4, 0xD2);
    WriteMemory(0x0DA3, 0x6A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x16);
    CheckRegisterByte(RegisterType::B, 0x58);
    CheckRegisterByte(RegisterType::C, 0xA7);
    CheckRegisterByte(RegisterType::D, 0xD2);
    CheckRegisterByte(RegisterType::E, 0x6A);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0xBB);
    CheckRegisterWord(RegisterType::PC, 0x6C96);
    CheckRegisterWord(RegisterType::SP, 0x0DA5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0DA3, 0x6A);
    CheckMemory(0x0DA4, 0xD2);
    CheckMemory(0x6C95, 0xD1);
}

void test_D1_0059()
{
    if (skip_test_D1_0059)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC9FF);
    WriteRegisterWord(RegisterType::SP, 0x7B4A);
    WriteRegisterByte(RegisterType::A, 0xE3);
    WriteRegisterByte(RegisterType::B, 0xD5);
    WriteRegisterByte(RegisterType::C, 0x93);
    WriteRegisterByte(RegisterType::D, 0x44);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC0);
    WriteRegisterByte(RegisterType::L, 0xA1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC9FF, 0xD1);
    WriteMemory(0x7B4B, 0xD3);
    WriteMemory(0x7B4A, 0xE4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE3);
    CheckRegisterByte(RegisterType::B, 0xD5);
    CheckRegisterByte(RegisterType::C, 0x93);
    CheckRegisterByte(RegisterType::D, 0xD3);
    CheckRegisterByte(RegisterType::E, 0xE4);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC0);
    CheckRegisterByte(RegisterType::L, 0xA1);
    CheckRegisterWord(RegisterType::PC, 0xCA00);
    CheckRegisterWord(RegisterType::SP, 0x7B4C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7B4A, 0xE4);
    CheckMemory(0x7B4B, 0xD3);
    CheckMemory(0xC9FF, 0xD1);
}

void test_D1_005A()
{
    if (skip_test_D1_005A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC7DE);
    WriteRegisterWord(RegisterType::SP, 0xDBDE);
    WriteRegisterByte(RegisterType::A, 0x45);
    WriteRegisterByte(RegisterType::B, 0x55);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0xF9);
    WriteRegisterByte(RegisterType::E, 0x2D);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xCA);
    WriteRegisterByte(RegisterType::L, 0x0B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDBDF, 0xD6);
    WriteMemory(0xDBDE, 0x4E);
    WriteMemory(0xC7DE, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x45);
    CheckRegisterByte(RegisterType::B, 0x55);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0xD6);
    CheckRegisterByte(RegisterType::E, 0x4E);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xCA);
    CheckRegisterByte(RegisterType::L, 0x0B);
    CheckRegisterWord(RegisterType::PC, 0xC7DF);
    CheckRegisterWord(RegisterType::SP, 0xDBE0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC7DE, 0xD1);
    CheckMemory(0xDBDE, 0x4E);
    CheckMemory(0xDBDF, 0xD6);
}

void test_D1_005B()
{
    if (skip_test_D1_005B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x061E);
    WriteRegisterWord(RegisterType::SP, 0xA9EB);
    WriteRegisterByte(RegisterType::A, 0x27);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0xF1);
    WriteRegisterByte(RegisterType::D, 0x04);
    WriteRegisterByte(RegisterType::E, 0xF7);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x26);
    WriteRegisterByte(RegisterType::L, 0x48);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA9EC, 0x4F);
    WriteMemory(0xA9EB, 0xD1);
    WriteMemory(0x061E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x27);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0xF1);
    CheckRegisterByte(RegisterType::D, 0x4F);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x26);
    CheckRegisterByte(RegisterType::L, 0x48);
    CheckRegisterWord(RegisterType::PC, 0x061F);
    CheckRegisterWord(RegisterType::SP, 0xA9ED);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x061E, 0xD1);
    CheckMemory(0xA9EB, 0xD1);
    CheckMemory(0xA9EC, 0x4F);
}

void test_D1_005C()
{
    if (skip_test_D1_005C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFC77);
    WriteRegisterWord(RegisterType::SP, 0x80CF);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0x85);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0x18);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x1A);
    WriteRegisterByte(RegisterType::L, 0x8E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFC77, 0xD1);
    WriteMemory(0x80D0, 0x30);
    WriteMemory(0x80CF, 0x3A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0x85);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0x30);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x1A);
    CheckRegisterByte(RegisterType::L, 0x8E);
    CheckRegisterWord(RegisterType::PC, 0xFC78);
    CheckRegisterWord(RegisterType::SP, 0x80D1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x80CF, 0x3A);
    CheckMemory(0x80D0, 0x30);
    CheckMemory(0xFC77, 0xD1);
}

void test_D1_005D()
{
    if (skip_test_D1_005D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x851A);
    WriteRegisterWord(RegisterType::SP, 0x3DBF);
    WriteRegisterByte(RegisterType::A, 0x1C);
    WriteRegisterByte(RegisterType::B, 0x42);
    WriteRegisterByte(RegisterType::C, 0x10);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0x56);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0xA7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x851A, 0xD1);
    WriteMemory(0x3DC0, 0x2D);
    WriteMemory(0x3DBF, 0xA6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1C);
    CheckRegisterByte(RegisterType::B, 0x42);
    CheckRegisterByte(RegisterType::C, 0x10);
    CheckRegisterByte(RegisterType::D, 0x2D);
    CheckRegisterByte(RegisterType::E, 0xA6);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0xA7);
    CheckRegisterWord(RegisterType::PC, 0x851B);
    CheckRegisterWord(RegisterType::SP, 0x3DC1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3DBF, 0xA6);
    CheckMemory(0x3DC0, 0x2D);
    CheckMemory(0x851A, 0xD1);
}

void test_D1_005E()
{
    if (skip_test_D1_005E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB4A7);
    WriteRegisterWord(RegisterType::SP, 0x4D10);
    WriteRegisterByte(RegisterType::A, 0x5A);
    WriteRegisterByte(RegisterType::B, 0xD4);
    WriteRegisterByte(RegisterType::C, 0x99);
    WriteRegisterByte(RegisterType::D, 0x25);
    WriteRegisterByte(RegisterType::E, 0x31);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x58);
    WriteRegisterByte(RegisterType::L, 0x84);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB4A7, 0xD1);
    WriteMemory(0x4D11, 0x2F);
    WriteMemory(0x4D10, 0x9D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5A);
    CheckRegisterByte(RegisterType::B, 0xD4);
    CheckRegisterByte(RegisterType::C, 0x99);
    CheckRegisterByte(RegisterType::D, 0x2F);
    CheckRegisterByte(RegisterType::E, 0x9D);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x58);
    CheckRegisterByte(RegisterType::L, 0x84);
    CheckRegisterWord(RegisterType::PC, 0xB4A8);
    CheckRegisterWord(RegisterType::SP, 0x4D12);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4D10, 0x9D);
    CheckMemory(0x4D11, 0x2F);
    CheckMemory(0xB4A7, 0xD1);
}

void test_D1_005F()
{
    if (skip_test_D1_005F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x301B);
    WriteRegisterWord(RegisterType::SP, 0x0AB4);
    WriteRegisterByte(RegisterType::A, 0xEA);
    WriteRegisterByte(RegisterType::B, 0xE7);
    WriteRegisterByte(RegisterType::C, 0x82);
    WriteRegisterByte(RegisterType::D, 0x8D);
    WriteRegisterByte(RegisterType::E, 0x82);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xDA);
    WriteRegisterByte(RegisterType::L, 0xAE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x301B, 0xD1);
    WriteMemory(0x0AB5, 0x99);
    WriteMemory(0x0AB4, 0x5C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEA);
    CheckRegisterByte(RegisterType::B, 0xE7);
    CheckRegisterByte(RegisterType::C, 0x82);
    CheckRegisterByte(RegisterType::D, 0x99);
    CheckRegisterByte(RegisterType::E, 0x5C);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xDA);
    CheckRegisterByte(RegisterType::L, 0xAE);
    CheckRegisterWord(RegisterType::PC, 0x301C);
    CheckRegisterWord(RegisterType::SP, 0x0AB6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0AB4, 0x5C);
    CheckMemory(0x0AB5, 0x99);
    CheckMemory(0x301B, 0xD1);
}

void test_D1_0060()
{
    if (skip_test_D1_0060)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEF47);
    WriteRegisterWord(RegisterType::SP, 0xEE99);
    WriteRegisterByte(RegisterType::A, 0x15);
    WriteRegisterByte(RegisterType::B, 0xDD);
    WriteRegisterByte(RegisterType::C, 0xE0);
    WriteRegisterByte(RegisterType::D, 0x2C);
    WriteRegisterByte(RegisterType::E, 0x28);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xC2);
    WriteRegisterByte(RegisterType::L, 0x98);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEF47, 0xD1);
    WriteMemory(0xEE9A, 0xED);
    WriteMemory(0xEE99, 0x58);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x15);
    CheckRegisterByte(RegisterType::B, 0xDD);
    CheckRegisterByte(RegisterType::C, 0xE0);
    CheckRegisterByte(RegisterType::D, 0xED);
    CheckRegisterByte(RegisterType::E, 0x58);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xC2);
    CheckRegisterByte(RegisterType::L, 0x98);
    CheckRegisterWord(RegisterType::PC, 0xEF48);
    CheckRegisterWord(RegisterType::SP, 0xEE9B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xEE99, 0x58);
    CheckMemory(0xEE9A, 0xED);
    CheckMemory(0xEF47, 0xD1);
}

void test_D1_0061()
{
    if (skip_test_D1_0061)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB758);
    WriteRegisterWord(RegisterType::SP, 0x6166);
    WriteRegisterByte(RegisterType::A, 0x41);
    WriteRegisterByte(RegisterType::B, 0x69);
    WriteRegisterByte(RegisterType::C, 0x7B);
    WriteRegisterByte(RegisterType::D, 0x70);
    WriteRegisterByte(RegisterType::E, 0x38);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xDE);
    WriteRegisterByte(RegisterType::L, 0xF6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB758, 0xD1);
    WriteMemory(0x6167, 0x27);
    WriteMemory(0x6166, 0xF7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x41);
    CheckRegisterByte(RegisterType::B, 0x69);
    CheckRegisterByte(RegisterType::C, 0x7B);
    CheckRegisterByte(RegisterType::D, 0x27);
    CheckRegisterByte(RegisterType::E, 0xF7);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xDE);
    CheckRegisterByte(RegisterType::L, 0xF6);
    CheckRegisterWord(RegisterType::PC, 0xB759);
    CheckRegisterWord(RegisterType::SP, 0x6168);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6166, 0xF7);
    CheckMemory(0x6167, 0x27);
    CheckMemory(0xB758, 0xD1);
}

void test_D1_0062()
{
    if (skip_test_D1_0062)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1FF3);
    WriteRegisterWord(RegisterType::SP, 0x9325);
    WriteRegisterByte(RegisterType::A, 0xFE);
    WriteRegisterByte(RegisterType::B, 0x81);
    WriteRegisterByte(RegisterType::C, 0x3B);
    WriteRegisterByte(RegisterType::D, 0xB8);
    WriteRegisterByte(RegisterType::E, 0x64);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xD7);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9326, 0x37);
    WriteMemory(0x9325, 0x6C);
    WriteMemory(0x1FF3, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFE);
    CheckRegisterByte(RegisterType::B, 0x81);
    CheckRegisterByte(RegisterType::C, 0x3B);
    CheckRegisterByte(RegisterType::D, 0x37);
    CheckRegisterByte(RegisterType::E, 0x6C);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xD7);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0x1FF4);
    CheckRegisterWord(RegisterType::SP, 0x9327);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1FF3, 0xD1);
    CheckMemory(0x9325, 0x6C);
    CheckMemory(0x9326, 0x37);
}

void test_D1_0063()
{
    if (skip_test_D1_0063)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x396C);
    WriteRegisterWord(RegisterType::SP, 0xA230);
    WriteRegisterByte(RegisterType::A, 0x2B);
    WriteRegisterByte(RegisterType::B, 0x2A);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x14);
    WriteRegisterByte(RegisterType::E, 0xD3);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xB3);
    WriteRegisterByte(RegisterType::L, 0x1E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA231, 0x76);
    WriteMemory(0xA230, 0xA7);
    WriteMemory(0x396C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2B);
    CheckRegisterByte(RegisterType::B, 0x2A);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0x76);
    CheckRegisterByte(RegisterType::E, 0xA7);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xB3);
    CheckRegisterByte(RegisterType::L, 0x1E);
    CheckRegisterWord(RegisterType::PC, 0x396D);
    CheckRegisterWord(RegisterType::SP, 0xA232);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x396C, 0xD1);
    CheckMemory(0xA230, 0xA7);
    CheckMemory(0xA231, 0x76);
}

void test_D1_0064()
{
    if (skip_test_D1_0064)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5635);
    WriteRegisterWord(RegisterType::SP, 0x63F7);
    WriteRegisterByte(RegisterType::A, 0x2C);
    WriteRegisterByte(RegisterType::B, 0xEB);
    WriteRegisterByte(RegisterType::C, 0xCD);
    WriteRegisterByte(RegisterType::D, 0x4E);
    WriteRegisterByte(RegisterType::E, 0x85);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x8D);
    WriteRegisterByte(RegisterType::L, 0x14);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x63F8, 0x3D);
    WriteMemory(0x63F7, 0xAA);
    WriteMemory(0x5635, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2C);
    CheckRegisterByte(RegisterType::B, 0xEB);
    CheckRegisterByte(RegisterType::C, 0xCD);
    CheckRegisterByte(RegisterType::D, 0x3D);
    CheckRegisterByte(RegisterType::E, 0xAA);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x8D);
    CheckRegisterByte(RegisterType::L, 0x14);
    CheckRegisterWord(RegisterType::PC, 0x5636);
    CheckRegisterWord(RegisterType::SP, 0x63F9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5635, 0xD1);
    CheckMemory(0x63F7, 0xAA);
    CheckMemory(0x63F8, 0x3D);
}

void test_D1_0065()
{
    if (skip_test_D1_0065)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB012);
    WriteRegisterWord(RegisterType::SP, 0x33A4);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0xE8);
    WriteRegisterByte(RegisterType::D, 0x21);
    WriteRegisterByte(RegisterType::E, 0x5D);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0x97);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB012, 0xD1);
    WriteMemory(0x33A5, 0xBA);
    WriteMemory(0x33A4, 0x81);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0xE8);
    CheckRegisterByte(RegisterType::D, 0xBA);
    CheckRegisterByte(RegisterType::E, 0x81);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0x97);
    CheckRegisterWord(RegisterType::PC, 0xB013);
    CheckRegisterWord(RegisterType::SP, 0x33A6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x33A4, 0x81);
    CheckMemory(0x33A5, 0xBA);
    CheckMemory(0xB012, 0xD1);
}

void test_D1_0066()
{
    if (skip_test_D1_0066)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF3B6);
    WriteRegisterWord(RegisterType::SP, 0x36F9);
    WriteRegisterByte(RegisterType::A, 0xA9);
    WriteRegisterByte(RegisterType::B, 0x9B);
    WriteRegisterByte(RegisterType::C, 0xB3);
    WriteRegisterByte(RegisterType::D, 0x8E);
    WriteRegisterByte(RegisterType::E, 0xF3);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x71);
    WriteRegisterByte(RegisterType::L, 0x04);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF3B6, 0xD1);
    WriteMemory(0x36FA, 0xD0);
    WriteMemory(0x36F9, 0x38);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA9);
    CheckRegisterByte(RegisterType::B, 0x9B);
    CheckRegisterByte(RegisterType::C, 0xB3);
    CheckRegisterByte(RegisterType::D, 0xD0);
    CheckRegisterByte(RegisterType::E, 0x38);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x71);
    CheckRegisterByte(RegisterType::L, 0x04);
    CheckRegisterWord(RegisterType::PC, 0xF3B7);
    CheckRegisterWord(RegisterType::SP, 0x36FB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x36F9, 0x38);
    CheckMemory(0x36FA, 0xD0);
    CheckMemory(0xF3B6, 0xD1);
}

void test_D1_0067()
{
    if (skip_test_D1_0067)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA57E);
    WriteRegisterWord(RegisterType::SP, 0xAC48);
    WriteRegisterByte(RegisterType::A, 0x70);
    WriteRegisterByte(RegisterType::B, 0xE2);
    WriteRegisterByte(RegisterType::C, 0x17);
    WriteRegisterByte(RegisterType::D, 0xB3);
    WriteRegisterByte(RegisterType::E, 0x48);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xE6);
    WriteRegisterByte(RegisterType::L, 0x10);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAC49, 0x8F);
    WriteMemory(0xAC48, 0x9A);
    WriteMemory(0xA57E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x70);
    CheckRegisterByte(RegisterType::B, 0xE2);
    CheckRegisterByte(RegisterType::C, 0x17);
    CheckRegisterByte(RegisterType::D, 0x8F);
    CheckRegisterByte(RegisterType::E, 0x9A);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xE6);
    CheckRegisterByte(RegisterType::L, 0x10);
    CheckRegisterWord(RegisterType::PC, 0xA57F);
    CheckRegisterWord(RegisterType::SP, 0xAC4A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA57E, 0xD1);
    CheckMemory(0xAC48, 0x9A);
    CheckMemory(0xAC49, 0x8F);
}

void test_D1_0068()
{
    if (skip_test_D1_0068)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4FF7);
    WriteRegisterWord(RegisterType::SP, 0x560D);
    WriteRegisterByte(RegisterType::A, 0xE1);
    WriteRegisterByte(RegisterType::B, 0x4E);
    WriteRegisterByte(RegisterType::C, 0xB1);
    WriteRegisterByte(RegisterType::D, 0x4D);
    WriteRegisterByte(RegisterType::E, 0x1A);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xA1);
    WriteRegisterByte(RegisterType::L, 0xE0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x560E, 0x91);
    WriteMemory(0x560D, 0x62);
    WriteMemory(0x4FF7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE1);
    CheckRegisterByte(RegisterType::B, 0x4E);
    CheckRegisterByte(RegisterType::C, 0xB1);
    CheckRegisterByte(RegisterType::D, 0x91);
    CheckRegisterByte(RegisterType::E, 0x62);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xA1);
    CheckRegisterByte(RegisterType::L, 0xE0);
    CheckRegisterWord(RegisterType::PC, 0x4FF8);
    CheckRegisterWord(RegisterType::SP, 0x560F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4FF7, 0xD1);
    CheckMemory(0x560D, 0x62);
    CheckMemory(0x560E, 0x91);
}

void test_D1_0069()
{
    if (skip_test_D1_0069)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7CFD);
    WriteRegisterWord(RegisterType::SP, 0xFC2E);
    WriteRegisterByte(RegisterType::A, 0x50);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0x91);
    WriteRegisterByte(RegisterType::D, 0x30);
    WriteRegisterByte(RegisterType::E, 0xBC);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x9C);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFC2F, 0x5B);
    WriteMemory(0xFC2E, 0x83);
    WriteMemory(0x7CFD, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x50);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0x91);
    CheckRegisterByte(RegisterType::D, 0x5B);
    CheckRegisterByte(RegisterType::E, 0x83);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x9C);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0x7CFE);
    CheckRegisterWord(RegisterType::SP, 0xFC30);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7CFD, 0xD1);
    CheckMemory(0xFC2E, 0x83);
    CheckMemory(0xFC2F, 0x5B);
}

void test_D1_006A()
{
    if (skip_test_D1_006A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1B5D);
    WriteRegisterWord(RegisterType::SP, 0x2182);
    WriteRegisterByte(RegisterType::A, 0x47);
    WriteRegisterByte(RegisterType::B, 0x20);
    WriteRegisterByte(RegisterType::C, 0xAD);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0x2D);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x90);
    WriteRegisterByte(RegisterType::L, 0x13);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2183, 0x10);
    WriteMemory(0x2182, 0x08);
    WriteMemory(0x1B5D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x47);
    CheckRegisterByte(RegisterType::B, 0x20);
    CheckRegisterByte(RegisterType::C, 0xAD);
    CheckRegisterByte(RegisterType::D, 0x10);
    CheckRegisterByte(RegisterType::E, 0x08);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x90);
    CheckRegisterByte(RegisterType::L, 0x13);
    CheckRegisterWord(RegisterType::PC, 0x1B5E);
    CheckRegisterWord(RegisterType::SP, 0x2184);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1B5D, 0xD1);
    CheckMemory(0x2182, 0x08);
    CheckMemory(0x2183, 0x10);
}

void test_D1_006B()
{
    if (skip_test_D1_006B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x792A);
    WriteRegisterWord(RegisterType::SP, 0xFC81);
    WriteRegisterByte(RegisterType::A, 0x96);
    WriteRegisterByte(RegisterType::B, 0x8D);
    WriteRegisterByte(RegisterType::C, 0xD2);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0xF1);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xBA);
    WriteRegisterByte(RegisterType::L, 0xD1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFC82, 0xE5);
    WriteMemory(0xFC81, 0x4E);
    WriteMemory(0x792A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x96);
    CheckRegisterByte(RegisterType::B, 0x8D);
    CheckRegisterByte(RegisterType::C, 0xD2);
    CheckRegisterByte(RegisterType::D, 0xE5);
    CheckRegisterByte(RegisterType::E, 0x4E);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xBA);
    CheckRegisterByte(RegisterType::L, 0xD1);
    CheckRegisterWord(RegisterType::PC, 0x792B);
    CheckRegisterWord(RegisterType::SP, 0xFC83);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x792A, 0xD1);
    CheckMemory(0xFC81, 0x4E);
    CheckMemory(0xFC82, 0xE5);
}

void test_D1_006C()
{
    if (skip_test_D1_006C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB464);
    WriteRegisterWord(RegisterType::SP, 0x27DD);
    WriteRegisterByte(RegisterType::A, 0x4F);
    WriteRegisterByte(RegisterType::B, 0xE1);
    WriteRegisterByte(RegisterType::C, 0x49);
    WriteRegisterByte(RegisterType::D, 0x1C);
    WriteRegisterByte(RegisterType::E, 0x82);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x13);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB464, 0xD1);
    WriteMemory(0x27DE, 0xDB);
    WriteMemory(0x27DD, 0x95);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4F);
    CheckRegisterByte(RegisterType::B, 0xE1);
    CheckRegisterByte(RegisterType::C, 0x49);
    CheckRegisterByte(RegisterType::D, 0xDB);
    CheckRegisterByte(RegisterType::E, 0x95);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x13);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0xB465);
    CheckRegisterWord(RegisterType::SP, 0x27DF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x27DD, 0x95);
    CheckMemory(0x27DE, 0xDB);
    CheckMemory(0xB464, 0xD1);
}

void test_D1_006D()
{
    if (skip_test_D1_006D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xABEC);
    WriteRegisterWord(RegisterType::SP, 0xCA08);
    WriteRegisterByte(RegisterType::A, 0x3C);
    WriteRegisterByte(RegisterType::B, 0xC1);
    WriteRegisterByte(RegisterType::C, 0x3F);
    WriteRegisterByte(RegisterType::D, 0x9E);
    WriteRegisterByte(RegisterType::E, 0xAA);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xFF);
    WriteRegisterByte(RegisterType::L, 0x79);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCA09, 0xB0);
    WriteMemory(0xCA08, 0x8C);
    WriteMemory(0xABEC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3C);
    CheckRegisterByte(RegisterType::B, 0xC1);
    CheckRegisterByte(RegisterType::C, 0x3F);
    CheckRegisterByte(RegisterType::D, 0xB0);
    CheckRegisterByte(RegisterType::E, 0x8C);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xFF);
    CheckRegisterByte(RegisterType::L, 0x79);
    CheckRegisterWord(RegisterType::PC, 0xABED);
    CheckRegisterWord(RegisterType::SP, 0xCA0A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xABEC, 0xD1);
    CheckMemory(0xCA08, 0x8C);
    CheckMemory(0xCA09, 0xB0);
}

void test_D1_006E()
{
    if (skip_test_D1_006E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4177);
    WriteRegisterWord(RegisterType::SP, 0x74A6);
    WriteRegisterByte(RegisterType::A, 0xE1);
    WriteRegisterByte(RegisterType::B, 0x17);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0x11);
    WriteRegisterByte(RegisterType::E, 0x3C);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xD7);
    WriteRegisterByte(RegisterType::L, 0x6F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x74A7, 0x39);
    WriteMemory(0x74A6, 0x65);
    WriteMemory(0x4177, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE1);
    CheckRegisterByte(RegisterType::B, 0x17);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0x39);
    CheckRegisterByte(RegisterType::E, 0x65);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xD7);
    CheckRegisterByte(RegisterType::L, 0x6F);
    CheckRegisterWord(RegisterType::PC, 0x4178);
    CheckRegisterWord(RegisterType::SP, 0x74A8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4177, 0xD1);
    CheckMemory(0x74A6, 0x65);
    CheckMemory(0x74A7, 0x39);
}

void test_D1_006F()
{
    if (skip_test_D1_006F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8604);
    WriteRegisterWord(RegisterType::SP, 0x69DA);
    WriteRegisterByte(RegisterType::A, 0x3F);
    WriteRegisterByte(RegisterType::B, 0x71);
    WriteRegisterByte(RegisterType::C, 0x7A);
    WriteRegisterByte(RegisterType::D, 0xF4);
    WriteRegisterByte(RegisterType::E, 0x7E);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x09);
    WriteRegisterByte(RegisterType::L, 0xA4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x8604, 0xD1);
    WriteMemory(0x69DB, 0xBA);
    WriteMemory(0x69DA, 0xC7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3F);
    CheckRegisterByte(RegisterType::B, 0x71);
    CheckRegisterByte(RegisterType::C, 0x7A);
    CheckRegisterByte(RegisterType::D, 0xBA);
    CheckRegisterByte(RegisterType::E, 0xC7);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x09);
    CheckRegisterByte(RegisterType::L, 0xA4);
    CheckRegisterWord(RegisterType::PC, 0x8605);
    CheckRegisterWord(RegisterType::SP, 0x69DC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x69DA, 0xC7);
    CheckMemory(0x69DB, 0xBA);
    CheckMemory(0x8604, 0xD1);
}

void test_D1_0070()
{
    if (skip_test_D1_0070)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x426F);
    WriteRegisterWord(RegisterType::SP, 0x56FA);
    WriteRegisterByte(RegisterType::A, 0xB1);
    WriteRegisterByte(RegisterType::B, 0xF8);
    WriteRegisterByte(RegisterType::C, 0x2E);
    WriteRegisterByte(RegisterType::D, 0xCA);
    WriteRegisterByte(RegisterType::E, 0x6E);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xF4);
    WriteRegisterByte(RegisterType::L, 0xFD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x56FB, 0x52);
    WriteMemory(0x56FA, 0xC2);
    WriteMemory(0x426F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB1);
    CheckRegisterByte(RegisterType::B, 0xF8);
    CheckRegisterByte(RegisterType::C, 0x2E);
    CheckRegisterByte(RegisterType::D, 0x52);
    CheckRegisterByte(RegisterType::E, 0xC2);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xF4);
    CheckRegisterByte(RegisterType::L, 0xFD);
    CheckRegisterWord(RegisterType::PC, 0x4270);
    CheckRegisterWord(RegisterType::SP, 0x56FC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x426F, 0xD1);
    CheckMemory(0x56FA, 0xC2);
    CheckMemory(0x56FB, 0x52);
}

void test_D1_0071()
{
    if (skip_test_D1_0071)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6768);
    WriteRegisterWord(RegisterType::SP, 0xBE0D);
    WriteRegisterByte(RegisterType::A, 0x4D);
    WriteRegisterByte(RegisterType::B, 0x7D);
    WriteRegisterByte(RegisterType::C, 0xCF);
    WriteRegisterByte(RegisterType::D, 0xC1);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x07);
    WriteRegisterByte(RegisterType::L, 0x9C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBE0E, 0xCA);
    WriteMemory(0xBE0D, 0x8D);
    WriteMemory(0x6768, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4D);
    CheckRegisterByte(RegisterType::B, 0x7D);
    CheckRegisterByte(RegisterType::C, 0xCF);
    CheckRegisterByte(RegisterType::D, 0xCA);
    CheckRegisterByte(RegisterType::E, 0x8D);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x07);
    CheckRegisterByte(RegisterType::L, 0x9C);
    CheckRegisterWord(RegisterType::PC, 0x6769);
    CheckRegisterWord(RegisterType::SP, 0xBE0F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6768, 0xD1);
    CheckMemory(0xBE0D, 0x8D);
    CheckMemory(0xBE0E, 0xCA);
}

void test_D1_0072()
{
    if (skip_test_D1_0072)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7730);
    WriteRegisterWord(RegisterType::SP, 0xA50D);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0x4C);
    WriteRegisterByte(RegisterType::C, 0x67);
    WriteRegisterByte(RegisterType::D, 0x83);
    WriteRegisterByte(RegisterType::E, 0xC1);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xAC);
    WriteRegisterByte(RegisterType::L, 0xFF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA50E, 0x12);
    WriteMemory(0xA50D, 0x83);
    WriteMemory(0x7730, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0x4C);
    CheckRegisterByte(RegisterType::C, 0x67);
    CheckRegisterByte(RegisterType::D, 0x12);
    CheckRegisterByte(RegisterType::E, 0x83);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xAC);
    CheckRegisterByte(RegisterType::L, 0xFF);
    CheckRegisterWord(RegisterType::PC, 0x7731);
    CheckRegisterWord(RegisterType::SP, 0xA50F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7730, 0xD1);
    CheckMemory(0xA50D, 0x83);
    CheckMemory(0xA50E, 0x12);
}

void test_D1_0073()
{
    if (skip_test_D1_0073)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFBC8);
    WriteRegisterWord(RegisterType::SP, 0xCBF9);
    WriteRegisterByte(RegisterType::A, 0x25);
    WriteRegisterByte(RegisterType::B, 0xEB);
    WriteRegisterByte(RegisterType::C, 0xD0);
    WriteRegisterByte(RegisterType::D, 0x30);
    WriteRegisterByte(RegisterType::E, 0xB9);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x34);
    WriteRegisterByte(RegisterType::L, 0xF8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFBC8, 0xD1);
    WriteMemory(0xCBFA, 0x30);
    WriteMemory(0xCBF9, 0xF7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x25);
    CheckRegisterByte(RegisterType::B, 0xEB);
    CheckRegisterByte(RegisterType::C, 0xD0);
    CheckRegisterByte(RegisterType::D, 0x30);
    CheckRegisterByte(RegisterType::E, 0xF7);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x34);
    CheckRegisterByte(RegisterType::L, 0xF8);
    CheckRegisterWord(RegisterType::PC, 0xFBC9);
    CheckRegisterWord(RegisterType::SP, 0xCBFB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCBF9, 0xF7);
    CheckMemory(0xCBFA, 0x30);
    CheckMemory(0xFBC8, 0xD1);
}

void test_D1_0074()
{
    if (skip_test_D1_0074)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x268F);
    WriteRegisterWord(RegisterType::SP, 0xB954);
    WriteRegisterByte(RegisterType::A, 0x7F);
    WriteRegisterByte(RegisterType::B, 0x3A);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0x64);
    WriteRegisterByte(RegisterType::E, 0xB9);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x73);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB955, 0xF6);
    WriteMemory(0xB954, 0xC1);
    WriteMemory(0x268F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7F);
    CheckRegisterByte(RegisterType::B, 0x3A);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0xF6);
    CheckRegisterByte(RegisterType::E, 0xC1);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x73);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0x2690);
    CheckRegisterWord(RegisterType::SP, 0xB956);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x268F, 0xD1);
    CheckMemory(0xB954, 0xC1);
    CheckMemory(0xB955, 0xF6);
}

void test_D1_0075()
{
    if (skip_test_D1_0075)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x64EC);
    WriteRegisterWord(RegisterType::SP, 0x4614);
    WriteRegisterByte(RegisterType::A, 0x00);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x1D);
    WriteRegisterByte(RegisterType::D, 0x71);
    WriteRegisterByte(RegisterType::E, 0x33);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x27);
    WriteRegisterByte(RegisterType::L, 0x44);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x64EC, 0xD1);
    WriteMemory(0x4615, 0x33);
    WriteMemory(0x4614, 0x00);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x00);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x1D);
    CheckRegisterByte(RegisterType::D, 0x33);
    CheckRegisterByte(RegisterType::E, 0x00);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x27);
    CheckRegisterByte(RegisterType::L, 0x44);
    CheckRegisterWord(RegisterType::PC, 0x64ED);
    CheckRegisterWord(RegisterType::SP, 0x4616);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4614, 0x00);
    CheckMemory(0x4615, 0x33);
    CheckMemory(0x64EC, 0xD1);
}

void test_D1_0076()
{
    if (skip_test_D1_0076)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x24EB);
    WriteRegisterWord(RegisterType::SP, 0xDC29);
    WriteRegisterByte(RegisterType::A, 0x64);
    WriteRegisterByte(RegisterType::B, 0x48);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0x00);
    WriteRegisterByte(RegisterType::E, 0xEC);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xFF);
    WriteRegisterByte(RegisterType::L, 0x02);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDC2A, 0x88);
    WriteMemory(0xDC29, 0x88);
    WriteMemory(0x24EB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x64);
    CheckRegisterByte(RegisterType::B, 0x48);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0x88);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xFF);
    CheckRegisterByte(RegisterType::L, 0x02);
    CheckRegisterWord(RegisterType::PC, 0x24EC);
    CheckRegisterWord(RegisterType::SP, 0xDC2B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x24EB, 0xD1);
    CheckMemory(0xDC29, 0x88);
    CheckMemory(0xDC2A, 0x88);
}

void test_D1_0077()
{
    if (skip_test_D1_0077)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x559A);
    WriteRegisterWord(RegisterType::SP, 0xC291);
    WriteRegisterByte(RegisterType::A, 0x39);
    WriteRegisterByte(RegisterType::B, 0x53);
    WriteRegisterByte(RegisterType::C, 0xCF);
    WriteRegisterByte(RegisterType::D, 0x88);
    WriteRegisterByte(RegisterType::E, 0x20);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0xC3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC292, 0x71);
    WriteMemory(0xC291, 0xC5);
    WriteMemory(0x559A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x39);
    CheckRegisterByte(RegisterType::B, 0x53);
    CheckRegisterByte(RegisterType::C, 0xCF);
    CheckRegisterByte(RegisterType::D, 0x71);
    CheckRegisterByte(RegisterType::E, 0xC5);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0xC3);
    CheckRegisterWord(RegisterType::PC, 0x559B);
    CheckRegisterWord(RegisterType::SP, 0xC293);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x559A, 0xD1);
    CheckMemory(0xC291, 0xC5);
    CheckMemory(0xC292, 0x71);
}

void test_D1_0078()
{
    if (skip_test_D1_0078)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6E13);
    WriteRegisterWord(RegisterType::SP, 0xF747);
    WriteRegisterByte(RegisterType::A, 0x28);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0xE8);
    WriteRegisterByte(RegisterType::D, 0x56);
    WriteRegisterByte(RegisterType::E, 0x7D);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x6D);
    WriteRegisterByte(RegisterType::L, 0x4C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF748, 0xB1);
    WriteMemory(0xF747, 0x0F);
    WriteMemory(0x6E13, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x28);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0xE8);
    CheckRegisterByte(RegisterType::D, 0xB1);
    CheckRegisterByte(RegisterType::E, 0x0F);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x6D);
    CheckRegisterByte(RegisterType::L, 0x4C);
    CheckRegisterWord(RegisterType::PC, 0x6E14);
    CheckRegisterWord(RegisterType::SP, 0xF749);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6E13, 0xD1);
    CheckMemory(0xF747, 0x0F);
    CheckMemory(0xF748, 0xB1);
}

void test_D1_0079()
{
    if (skip_test_D1_0079)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9F98);
    WriteRegisterWord(RegisterType::SP, 0x7C0C);
    WriteRegisterByte(RegisterType::A, 0x15);
    WriteRegisterByte(RegisterType::B, 0xBA);
    WriteRegisterByte(RegisterType::C, 0x85);
    WriteRegisterByte(RegisterType::D, 0xFC);
    WriteRegisterByte(RegisterType::E, 0x64);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xEE);
    WriteRegisterByte(RegisterType::L, 0x16);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9F98, 0xD1);
    WriteMemory(0x7C0D, 0xDD);
    WriteMemory(0x7C0C, 0x74);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x15);
    CheckRegisterByte(RegisterType::B, 0xBA);
    CheckRegisterByte(RegisterType::C, 0x85);
    CheckRegisterByte(RegisterType::D, 0xDD);
    CheckRegisterByte(RegisterType::E, 0x74);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xEE);
    CheckRegisterByte(RegisterType::L, 0x16);
    CheckRegisterWord(RegisterType::PC, 0x9F99);
    CheckRegisterWord(RegisterType::SP, 0x7C0E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7C0C, 0x74);
    CheckMemory(0x7C0D, 0xDD);
    CheckMemory(0x9F98, 0xD1);
}

void test_D1_007A()
{
    if (skip_test_D1_007A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEF62);
    WriteRegisterWord(RegisterType::SP, 0x9AC7);
    WriteRegisterByte(RegisterType::A, 0x90);
    WriteRegisterByte(RegisterType::B, 0x3E);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0x42);
    WriteRegisterByte(RegisterType::E, 0xC1);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xE3);
    WriteRegisterByte(RegisterType::L, 0xEC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEF62, 0xD1);
    WriteMemory(0x9AC8, 0x7B);
    WriteMemory(0x9AC7, 0xB8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x90);
    CheckRegisterByte(RegisterType::B, 0x3E);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0x7B);
    CheckRegisterByte(RegisterType::E, 0xB8);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xE3);
    CheckRegisterByte(RegisterType::L, 0xEC);
    CheckRegisterWord(RegisterType::PC, 0xEF63);
    CheckRegisterWord(RegisterType::SP, 0x9AC9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9AC7, 0xB8);
    CheckMemory(0x9AC8, 0x7B);
    CheckMemory(0xEF62, 0xD1);
}

void test_D1_007B()
{
    if (skip_test_D1_007B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB16E);
    WriteRegisterWord(RegisterType::SP, 0xE6C6);
    WriteRegisterByte(RegisterType::A, 0x8B);
    WriteRegisterByte(RegisterType::B, 0x42);
    WriteRegisterByte(RegisterType::C, 0x2C);
    WriteRegisterByte(RegisterType::D, 0x13);
    WriteRegisterByte(RegisterType::E, 0xE8);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x8D);
    WriteRegisterByte(RegisterType::L, 0xC0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE6C7, 0xAA);
    WriteMemory(0xE6C6, 0x05);
    WriteMemory(0xB16E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8B);
    CheckRegisterByte(RegisterType::B, 0x42);
    CheckRegisterByte(RegisterType::C, 0x2C);
    CheckRegisterByte(RegisterType::D, 0xAA);
    CheckRegisterByte(RegisterType::E, 0x05);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x8D);
    CheckRegisterByte(RegisterType::L, 0xC0);
    CheckRegisterWord(RegisterType::PC, 0xB16F);
    CheckRegisterWord(RegisterType::SP, 0xE6C8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB16E, 0xD1);
    CheckMemory(0xE6C6, 0x05);
    CheckMemory(0xE6C7, 0xAA);
}

void test_D1_007C()
{
    if (skip_test_D1_007C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x280F);
    WriteRegisterWord(RegisterType::SP, 0x0C07);
    WriteRegisterByte(RegisterType::A, 0x06);
    WriteRegisterByte(RegisterType::B, 0xD3);
    WriteRegisterByte(RegisterType::C, 0x72);
    WriteRegisterByte(RegisterType::D, 0xE0);
    WriteRegisterByte(RegisterType::E, 0x02);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xBE);
    WriteRegisterByte(RegisterType::L, 0x82);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x280F, 0xD1);
    WriteMemory(0x0C08, 0x43);
    WriteMemory(0x0C07, 0x31);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x06);
    CheckRegisterByte(RegisterType::B, 0xD3);
    CheckRegisterByte(RegisterType::C, 0x72);
    CheckRegisterByte(RegisterType::D, 0x43);
    CheckRegisterByte(RegisterType::E, 0x31);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xBE);
    CheckRegisterByte(RegisterType::L, 0x82);
    CheckRegisterWord(RegisterType::PC, 0x2810);
    CheckRegisterWord(RegisterType::SP, 0x0C09);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0C07, 0x31);
    CheckMemory(0x0C08, 0x43);
    CheckMemory(0x280F, 0xD1);
}

void test_D1_007D()
{
    if (skip_test_D1_007D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8683);
    WriteRegisterWord(RegisterType::SP, 0xB6F5);
    WriteRegisterByte(RegisterType::A, 0xBF);
    WriteRegisterByte(RegisterType::B, 0xAE);
    WriteRegisterByte(RegisterType::C, 0x78);
    WriteRegisterByte(RegisterType::D, 0xA3);
    WriteRegisterByte(RegisterType::E, 0xA7);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x0D);
    WriteRegisterByte(RegisterType::L, 0x1F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB6F6, 0x68);
    WriteMemory(0xB6F5, 0x0D);
    WriteMemory(0x8683, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBF);
    CheckRegisterByte(RegisterType::B, 0xAE);
    CheckRegisterByte(RegisterType::C, 0x78);
    CheckRegisterByte(RegisterType::D, 0x68);
    CheckRegisterByte(RegisterType::E, 0x0D);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x0D);
    CheckRegisterByte(RegisterType::L, 0x1F);
    CheckRegisterWord(RegisterType::PC, 0x8684);
    CheckRegisterWord(RegisterType::SP, 0xB6F7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8683, 0xD1);
    CheckMemory(0xB6F5, 0x0D);
    CheckMemory(0xB6F6, 0x68);
}

void test_D1_007E()
{
    if (skip_test_D1_007E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x32BA);
    WriteRegisterWord(RegisterType::SP, 0x0AE6);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0x9C);
    WriteRegisterByte(RegisterType::D, 0xBA);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x9C);
    WriteRegisterByte(RegisterType::L, 0x2E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x32BA, 0xD1);
    WriteMemory(0x0AE7, 0x2B);
    WriteMemory(0x0AE6, 0x68);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0x9C);
    CheckRegisterByte(RegisterType::D, 0x2B);
    CheckRegisterByte(RegisterType::E, 0x68);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x9C);
    CheckRegisterByte(RegisterType::L, 0x2E);
    CheckRegisterWord(RegisterType::PC, 0x32BB);
    CheckRegisterWord(RegisterType::SP, 0x0AE8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0AE6, 0x68);
    CheckMemory(0x0AE7, 0x2B);
    CheckMemory(0x32BA, 0xD1);
}

void test_D1_007F()
{
    if (skip_test_D1_007F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE1D5);
    WriteRegisterWord(RegisterType::SP, 0x18ED);
    WriteRegisterByte(RegisterType::A, 0xF7);
    WriteRegisterByte(RegisterType::B, 0xFE);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0x48);
    WriteRegisterByte(RegisterType::E, 0x98);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x07);
    WriteRegisterByte(RegisterType::L, 0x04);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE1D5, 0xD1);
    WriteMemory(0x18EE, 0x01);
    WriteMemory(0x18ED, 0x1B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF7);
    CheckRegisterByte(RegisterType::B, 0xFE);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0x01);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x07);
    CheckRegisterByte(RegisterType::L, 0x04);
    CheckRegisterWord(RegisterType::PC, 0xE1D6);
    CheckRegisterWord(RegisterType::SP, 0x18EF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x18ED, 0x1B);
    CheckMemory(0x18EE, 0x01);
    CheckMemory(0xE1D5, 0xD1);
}

void test_D1_0080()
{
    if (skip_test_D1_0080)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB37D);
    WriteRegisterWord(RegisterType::SP, 0x325F);
    WriteRegisterByte(RegisterType::A, 0x1C);
    WriteRegisterByte(RegisterType::B, 0x8B);
    WriteRegisterByte(RegisterType::C, 0xA4);
    WriteRegisterByte(RegisterType::D, 0x14);
    WriteRegisterByte(RegisterType::E, 0x50);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xCA);
    WriteRegisterByte(RegisterType::L, 0xA7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB37D, 0xD1);
    WriteMemory(0x3260, 0xBD);
    WriteMemory(0x325F, 0x0C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1C);
    CheckRegisterByte(RegisterType::B, 0x8B);
    CheckRegisterByte(RegisterType::C, 0xA4);
    CheckRegisterByte(RegisterType::D, 0xBD);
    CheckRegisterByte(RegisterType::E, 0x0C);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xCA);
    CheckRegisterByte(RegisterType::L, 0xA7);
    CheckRegisterWord(RegisterType::PC, 0xB37E);
    CheckRegisterWord(RegisterType::SP, 0x3261);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x325F, 0x0C);
    CheckMemory(0x3260, 0xBD);
    CheckMemory(0xB37D, 0xD1);
}

void test_D1_0081()
{
    if (skip_test_D1_0081)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7E4B);
    WriteRegisterWord(RegisterType::SP, 0xB861);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0x4E);
    WriteRegisterByte(RegisterType::D, 0xA0);
    WriteRegisterByte(RegisterType::E, 0xA7);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x57);
    WriteRegisterByte(RegisterType::L, 0xF7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB862, 0x0C);
    WriteMemory(0xB861, 0x36);
    WriteMemory(0x7E4B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0x4E);
    CheckRegisterByte(RegisterType::D, 0x0C);
    CheckRegisterByte(RegisterType::E, 0x36);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x57);
    CheckRegisterByte(RegisterType::L, 0xF7);
    CheckRegisterWord(RegisterType::PC, 0x7E4C);
    CheckRegisterWord(RegisterType::SP, 0xB863);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7E4B, 0xD1);
    CheckMemory(0xB861, 0x36);
    CheckMemory(0xB862, 0x0C);
}

void test_D1_0082()
{
    if (skip_test_D1_0082)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1D17);
    WriteRegisterWord(RegisterType::SP, 0xC826);
    WriteRegisterByte(RegisterType::A, 0xE3);
    WriteRegisterByte(RegisterType::B, 0xFF);
    WriteRegisterByte(RegisterType::C, 0xBE);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0xC5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC827, 0xD0);
    WriteMemory(0xC826, 0x7E);
    WriteMemory(0x1D17, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE3);
    CheckRegisterByte(RegisterType::B, 0xFF);
    CheckRegisterByte(RegisterType::C, 0xBE);
    CheckRegisterByte(RegisterType::D, 0xD0);
    CheckRegisterByte(RegisterType::E, 0x7E);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0xC5);
    CheckRegisterWord(RegisterType::PC, 0x1D18);
    CheckRegisterWord(RegisterType::SP, 0xC828);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1D17, 0xD1);
    CheckMemory(0xC826, 0x7E);
    CheckMemory(0xC827, 0xD0);
}

void test_D1_0083()
{
    if (skip_test_D1_0083)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9FF1);
    WriteRegisterWord(RegisterType::SP, 0xE6B4);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0x2B);
    WriteRegisterByte(RegisterType::C, 0xFA);
    WriteRegisterByte(RegisterType::D, 0x55);
    WriteRegisterByte(RegisterType::E, 0xCA);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x72);
    WriteRegisterByte(RegisterType::L, 0x0F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE6B5, 0xE1);
    WriteMemory(0xE6B4, 0x0B);
    WriteMemory(0x9FF1, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0x2B);
    CheckRegisterByte(RegisterType::C, 0xFA);
    CheckRegisterByte(RegisterType::D, 0xE1);
    CheckRegisterByte(RegisterType::E, 0x0B);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x72);
    CheckRegisterByte(RegisterType::L, 0x0F);
    CheckRegisterWord(RegisterType::PC, 0x9FF2);
    CheckRegisterWord(RegisterType::SP, 0xE6B6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9FF1, 0xD1);
    CheckMemory(0xE6B4, 0x0B);
    CheckMemory(0xE6B5, 0xE1);
}

void test_D1_0084()
{
    if (skip_test_D1_0084)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x85D6);
    WriteRegisterWord(RegisterType::SP, 0x5846);
    WriteRegisterByte(RegisterType::A, 0x98);
    WriteRegisterByte(RegisterType::B, 0x1D);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0x66);
    WriteRegisterByte(RegisterType::E, 0xED);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xBA);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x85D6, 0xD1);
    WriteMemory(0x5847, 0xCB);
    WriteMemory(0x5846, 0xD2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x98);
    CheckRegisterByte(RegisterType::B, 0x1D);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0xCB);
    CheckRegisterByte(RegisterType::E, 0xD2);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xBA);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0x85D7);
    CheckRegisterWord(RegisterType::SP, 0x5848);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5846, 0xD2);
    CheckMemory(0x5847, 0xCB);
    CheckMemory(0x85D6, 0xD1);
}

void test_D1_0085()
{
    if (skip_test_D1_0085)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB4D6);
    WriteRegisterWord(RegisterType::SP, 0x5F45);
    WriteRegisterByte(RegisterType::A, 0x07);
    WriteRegisterByte(RegisterType::B, 0xA6);
    WriteRegisterByte(RegisterType::C, 0x1E);
    WriteRegisterByte(RegisterType::D, 0xF8);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xF2);
    WriteRegisterByte(RegisterType::L, 0xC8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB4D6, 0xD1);
    WriteMemory(0x5F46, 0xBB);
    WriteMemory(0x5F45, 0x2E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x07);
    CheckRegisterByte(RegisterType::B, 0xA6);
    CheckRegisterByte(RegisterType::C, 0x1E);
    CheckRegisterByte(RegisterType::D, 0xBB);
    CheckRegisterByte(RegisterType::E, 0x2E);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xF2);
    CheckRegisterByte(RegisterType::L, 0xC8);
    CheckRegisterWord(RegisterType::PC, 0xB4D7);
    CheckRegisterWord(RegisterType::SP, 0x5F47);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5F45, 0x2E);
    CheckMemory(0x5F46, 0xBB);
    CheckMemory(0xB4D6, 0xD1);
}

void test_D1_0086()
{
    if (skip_test_D1_0086)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6C03);
    WriteRegisterWord(RegisterType::SP, 0x579B);
    WriteRegisterByte(RegisterType::A, 0xAF);
    WriteRegisterByte(RegisterType::B, 0xBF);
    WriteRegisterByte(RegisterType::C, 0x1C);
    WriteRegisterByte(RegisterType::D, 0x8F);
    WriteRegisterByte(RegisterType::E, 0xEA);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6C03, 0xD1);
    WriteMemory(0x579C, 0xD9);
    WriteMemory(0x579B, 0x34);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAF);
    CheckRegisterByte(RegisterType::B, 0xBF);
    CheckRegisterByte(RegisterType::C, 0x1C);
    CheckRegisterByte(RegisterType::D, 0xD9);
    CheckRegisterByte(RegisterType::E, 0x34);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0x6C04);
    CheckRegisterWord(RegisterType::SP, 0x579D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x579B, 0x34);
    CheckMemory(0x579C, 0xD9);
    CheckMemory(0x6C03, 0xD1);
}

void test_D1_0087()
{
    if (skip_test_D1_0087)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA361);
    WriteRegisterWord(RegisterType::SP, 0x9576);
    WriteRegisterByte(RegisterType::A, 0x4E);
    WriteRegisterByte(RegisterType::B, 0x24);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x5C);
    WriteRegisterByte(RegisterType::E, 0x82);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x94);
    WriteRegisterByte(RegisterType::L, 0x1C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA361, 0xD1);
    WriteMemory(0x9577, 0xCA);
    WriteMemory(0x9576, 0x17);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4E);
    CheckRegisterByte(RegisterType::B, 0x24);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0xCA);
    CheckRegisterByte(RegisterType::E, 0x17);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x94);
    CheckRegisterByte(RegisterType::L, 0x1C);
    CheckRegisterWord(RegisterType::PC, 0xA362);
    CheckRegisterWord(RegisterType::SP, 0x9578);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9576, 0x17);
    CheckMemory(0x9577, 0xCA);
    CheckMemory(0xA361, 0xD1);
}

void test_D1_0088()
{
    if (skip_test_D1_0088)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF6F0);
    WriteRegisterWord(RegisterType::SP, 0xDCB7);
    WriteRegisterByte(RegisterType::A, 0xF6);
    WriteRegisterByte(RegisterType::B, 0x22);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0x05);
    WriteRegisterByte(RegisterType::E, 0xD3);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x95);
    WriteRegisterByte(RegisterType::L, 0x95);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF6F0, 0xD1);
    WriteMemory(0xDCB8, 0x3C);
    WriteMemory(0xDCB7, 0x3D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF6);
    CheckRegisterByte(RegisterType::B, 0x22);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0x3C);
    CheckRegisterByte(RegisterType::E, 0x3D);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x95);
    CheckRegisterByte(RegisterType::L, 0x95);
    CheckRegisterWord(RegisterType::PC, 0xF6F1);
    CheckRegisterWord(RegisterType::SP, 0xDCB9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDCB7, 0x3D);
    CheckMemory(0xDCB8, 0x3C);
    CheckMemory(0xF6F0, 0xD1);
}

void test_D1_0089()
{
    if (skip_test_D1_0089)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDE4B);
    WriteRegisterWord(RegisterType::SP, 0xCAFD);
    WriteRegisterByte(RegisterType::A, 0xEB);
    WriteRegisterByte(RegisterType::B, 0xAD);
    WriteRegisterByte(RegisterType::C, 0xB2);
    WriteRegisterByte(RegisterType::D, 0xF1);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x89);
    WriteRegisterByte(RegisterType::L, 0xA2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDE4B, 0xD1);
    WriteMemory(0xCAFE, 0xDF);
    WriteMemory(0xCAFD, 0x5A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEB);
    CheckRegisterByte(RegisterType::B, 0xAD);
    CheckRegisterByte(RegisterType::C, 0xB2);
    CheckRegisterByte(RegisterType::D, 0xDF);
    CheckRegisterByte(RegisterType::E, 0x5A);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x89);
    CheckRegisterByte(RegisterType::L, 0xA2);
    CheckRegisterWord(RegisterType::PC, 0xDE4C);
    CheckRegisterWord(RegisterType::SP, 0xCAFF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCAFD, 0x5A);
    CheckMemory(0xCAFE, 0xDF);
    CheckMemory(0xDE4B, 0xD1);
}

void test_D1_008A()
{
    if (skip_test_D1_008A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD493);
    WriteRegisterWord(RegisterType::SP, 0xBF0D);
    WriteRegisterByte(RegisterType::A, 0x10);
    WriteRegisterByte(RegisterType::B, 0xDD);
    WriteRegisterByte(RegisterType::C, 0x76);
    WriteRegisterByte(RegisterType::D, 0x04);
    WriteRegisterByte(RegisterType::E, 0xCE);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x94);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD493, 0xD1);
    WriteMemory(0xBF0E, 0xEA);
    WriteMemory(0xBF0D, 0xC4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x10);
    CheckRegisterByte(RegisterType::B, 0xDD);
    CheckRegisterByte(RegisterType::C, 0x76);
    CheckRegisterByte(RegisterType::D, 0xEA);
    CheckRegisterByte(RegisterType::E, 0xC4);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x94);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0xD494);
    CheckRegisterWord(RegisterType::SP, 0xBF0F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBF0D, 0xC4);
    CheckMemory(0xBF0E, 0xEA);
    CheckMemory(0xD493, 0xD1);
}

void test_D1_008B()
{
    if (skip_test_D1_008B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x357C);
    WriteRegisterWord(RegisterType::SP, 0x633C);
    WriteRegisterByte(RegisterType::A, 0xB9);
    WriteRegisterByte(RegisterType::B, 0xCF);
    WriteRegisterByte(RegisterType::C, 0x61);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xAE);
    WriteRegisterByte(RegisterType::L, 0x77);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x633D, 0xDB);
    WriteMemory(0x633C, 0x0C);
    WriteMemory(0x357C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB9);
    CheckRegisterByte(RegisterType::B, 0xCF);
    CheckRegisterByte(RegisterType::C, 0x61);
    CheckRegisterByte(RegisterType::D, 0xDB);
    CheckRegisterByte(RegisterType::E, 0x0C);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xAE);
    CheckRegisterByte(RegisterType::L, 0x77);
    CheckRegisterWord(RegisterType::PC, 0x357D);
    CheckRegisterWord(RegisterType::SP, 0x633E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x357C, 0xD1);
    CheckMemory(0x633C, 0x0C);
    CheckMemory(0x633D, 0xDB);
}

void test_D1_008C()
{
    if (skip_test_D1_008C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x78EB);
    WriteRegisterWord(RegisterType::SP, 0x6FC8);
    WriteRegisterByte(RegisterType::A, 0xBA);
    WriteRegisterByte(RegisterType::B, 0x49);
    WriteRegisterByte(RegisterType::C, 0x9F);
    WriteRegisterByte(RegisterType::D, 0x2F);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xE9);
    WriteRegisterByte(RegisterType::L, 0x27);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x78EB, 0xD1);
    WriteMemory(0x6FC9, 0xBE);
    WriteMemory(0x6FC8, 0xBE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBA);
    CheckRegisterByte(RegisterType::B, 0x49);
    CheckRegisterByte(RegisterType::C, 0x9F);
    CheckRegisterByte(RegisterType::D, 0xBE);
    CheckRegisterByte(RegisterType::E, 0xBE);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xE9);
    CheckRegisterByte(RegisterType::L, 0x27);
    CheckRegisterWord(RegisterType::PC, 0x78EC);
    CheckRegisterWord(RegisterType::SP, 0x6FCA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6FC8, 0xBE);
    CheckMemory(0x6FC9, 0xBE);
    CheckMemory(0x78EB, 0xD1);
}

void test_D1_008D()
{
    if (skip_test_D1_008D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0799);
    WriteRegisterWord(RegisterType::SP, 0x15FA);
    WriteRegisterByte(RegisterType::A, 0x33);
    WriteRegisterByte(RegisterType::B, 0x73);
    WriteRegisterByte(RegisterType::C, 0x05);
    WriteRegisterByte(RegisterType::D, 0x66);
    WriteRegisterByte(RegisterType::E, 0xCB);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x4D);
    WriteRegisterByte(RegisterType::L, 0xC6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x15FB, 0x7D);
    WriteMemory(0x15FA, 0x9C);
    WriteMemory(0x0799, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x33);
    CheckRegisterByte(RegisterType::B, 0x73);
    CheckRegisterByte(RegisterType::C, 0x05);
    CheckRegisterByte(RegisterType::D, 0x7D);
    CheckRegisterByte(RegisterType::E, 0x9C);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x4D);
    CheckRegisterByte(RegisterType::L, 0xC6);
    CheckRegisterWord(RegisterType::PC, 0x079A);
    CheckRegisterWord(RegisterType::SP, 0x15FC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0799, 0xD1);
    CheckMemory(0x15FA, 0x9C);
    CheckMemory(0x15FB, 0x7D);
}

void test_D1_008E()
{
    if (skip_test_D1_008E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x00EF);
    WriteRegisterWord(RegisterType::SP, 0x8AD6);
    WriteRegisterByte(RegisterType::A, 0xAC);
    WriteRegisterByte(RegisterType::B, 0x1C);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0x1D);
    WriteRegisterByte(RegisterType::E, 0x5B);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x47);
    WriteRegisterByte(RegisterType::L, 0xE6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x8AD7, 0x8C);
    WriteMemory(0x8AD6, 0xD1);
    WriteMemory(0x00EF, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAC);
    CheckRegisterByte(RegisterType::B, 0x1C);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x47);
    CheckRegisterByte(RegisterType::L, 0xE6);
    CheckRegisterWord(RegisterType::PC, 0x00F0);
    CheckRegisterWord(RegisterType::SP, 0x8AD8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x00EF, 0xD1);
    CheckMemory(0x8AD6, 0xD1);
    CheckMemory(0x8AD7, 0x8C);
}

void test_D1_008F()
{
    if (skip_test_D1_008F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC8DF);
    WriteRegisterWord(RegisterType::SP, 0xDB8C);
    WriteRegisterByte(RegisterType::A, 0x51);
    WriteRegisterByte(RegisterType::B, 0x62);
    WriteRegisterByte(RegisterType::C, 0x13);
    WriteRegisterByte(RegisterType::D, 0x46);
    WriteRegisterByte(RegisterType::E, 0x1F);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x4C);
    WriteRegisterByte(RegisterType::L, 0x0B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDB8D, 0x3F);
    WriteMemory(0xDB8C, 0x42);
    WriteMemory(0xC8DF, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x51);
    CheckRegisterByte(RegisterType::B, 0x62);
    CheckRegisterByte(RegisterType::C, 0x13);
    CheckRegisterByte(RegisterType::D, 0x3F);
    CheckRegisterByte(RegisterType::E, 0x42);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x4C);
    CheckRegisterByte(RegisterType::L, 0x0B);
    CheckRegisterWord(RegisterType::PC, 0xC8E0);
    CheckRegisterWord(RegisterType::SP, 0xDB8E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC8DF, 0xD1);
    CheckMemory(0xDB8C, 0x42);
    CheckMemory(0xDB8D, 0x3F);
}

void test_D1_0090()
{
    if (skip_test_D1_0090)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD84B);
    WriteRegisterWord(RegisterType::SP, 0x3EBC);
    WriteRegisterByte(RegisterType::A, 0xE4);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0x32);
    WriteRegisterByte(RegisterType::D, 0x92);
    WriteRegisterByte(RegisterType::E, 0x23);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0xA4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD84B, 0xD1);
    WriteMemory(0x3EBD, 0xEB);
    WriteMemory(0x3EBC, 0x6E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE4);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0x32);
    CheckRegisterByte(RegisterType::D, 0xEB);
    CheckRegisterByte(RegisterType::E, 0x6E);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0xA4);
    CheckRegisterWord(RegisterType::PC, 0xD84C);
    CheckRegisterWord(RegisterType::SP, 0x3EBE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3EBC, 0x6E);
    CheckMemory(0x3EBD, 0xEB);
    CheckMemory(0xD84B, 0xD1);
}

void test_D1_0091()
{
    if (skip_test_D1_0091)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x75CA);
    WriteRegisterWord(RegisterType::SP, 0x2FB0);
    WriteRegisterByte(RegisterType::A, 0x59);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0xC2);
    WriteRegisterByte(RegisterType::D, 0xD6);
    WriteRegisterByte(RegisterType::E, 0x04);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0x04);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x75CA, 0xD1);
    WriteMemory(0x2FB1, 0xAD);
    WriteMemory(0x2FB0, 0x74);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x59);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0xC2);
    CheckRegisterByte(RegisterType::D, 0xAD);
    CheckRegisterByte(RegisterType::E, 0x74);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0x04);
    CheckRegisterWord(RegisterType::PC, 0x75CB);
    CheckRegisterWord(RegisterType::SP, 0x2FB2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2FB0, 0x74);
    CheckMemory(0x2FB1, 0xAD);
    CheckMemory(0x75CA, 0xD1);
}

void test_D1_0092()
{
    if (skip_test_D1_0092)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x51DD);
    WriteRegisterWord(RegisterType::SP, 0xA6A9);
    WriteRegisterByte(RegisterType::A, 0x51);
    WriteRegisterByte(RegisterType::B, 0xAC);
    WriteRegisterByte(RegisterType::C, 0x79);
    WriteRegisterByte(RegisterType::D, 0x04);
    WriteRegisterByte(RegisterType::E, 0xC9);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC3);
    WriteRegisterByte(RegisterType::L, 0x78);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA6AA, 0xCD);
    WriteMemory(0xA6A9, 0xCC);
    WriteMemory(0x51DD, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x51);
    CheckRegisterByte(RegisterType::B, 0xAC);
    CheckRegisterByte(RegisterType::C, 0x79);
    CheckRegisterByte(RegisterType::D, 0xCD);
    CheckRegisterByte(RegisterType::E, 0xCC);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC3);
    CheckRegisterByte(RegisterType::L, 0x78);
    CheckRegisterWord(RegisterType::PC, 0x51DE);
    CheckRegisterWord(RegisterType::SP, 0xA6AB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x51DD, 0xD1);
    CheckMemory(0xA6A9, 0xCC);
    CheckMemory(0xA6AA, 0xCD);
}

void test_D1_0093()
{
    if (skip_test_D1_0093)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFEAA);
    WriteRegisterWord(RegisterType::SP, 0x7299);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0x96);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0x6E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFEAA, 0xD1);
    WriteMemory(0x729A, 0x3D);
    WriteMemory(0x7299, 0xDB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0x96);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0x3D);
    CheckRegisterByte(RegisterType::E, 0xDB);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0x6E);
    CheckRegisterWord(RegisterType::PC, 0xFEAB);
    CheckRegisterWord(RegisterType::SP, 0x729B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7299, 0xDB);
    CheckMemory(0x729A, 0x3D);
    CheckMemory(0xFEAA, 0xD1);
}

void test_D1_0094()
{
    if (skip_test_D1_0094)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0D2C);
    WriteRegisterWord(RegisterType::SP, 0x0D40);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0x0D);
    WriteRegisterByte(RegisterType::C, 0xC3);
    WriteRegisterByte(RegisterType::D, 0xB3);
    WriteRegisterByte(RegisterType::E, 0x2F);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0xE9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x0D41, 0xDC);
    WriteMemory(0x0D40, 0xFA);
    WriteMemory(0x0D2C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0x0D);
    CheckRegisterByte(RegisterType::C, 0xC3);
    CheckRegisterByte(RegisterType::D, 0xDC);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0xE9);
    CheckRegisterWord(RegisterType::PC, 0x0D2D);
    CheckRegisterWord(RegisterType::SP, 0x0D42);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0D2C, 0xD1);
    CheckMemory(0x0D40, 0xFA);
    CheckMemory(0x0D41, 0xDC);
}

void test_D1_0095()
{
    if (skip_test_D1_0095)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD123);
    WriteRegisterWord(RegisterType::SP, 0x51DA);
    WriteRegisterByte(RegisterType::A, 0x67);
    WriteRegisterByte(RegisterType::B, 0x81);
    WriteRegisterByte(RegisterType::C, 0x55);
    WriteRegisterByte(RegisterType::D, 0x60);
    WriteRegisterByte(RegisterType::E, 0x90);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xFE);
    WriteRegisterByte(RegisterType::L, 0x86);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD123, 0xD1);
    WriteMemory(0x51DB, 0xA3);
    WriteMemory(0x51DA, 0x1D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x67);
    CheckRegisterByte(RegisterType::B, 0x81);
    CheckRegisterByte(RegisterType::C, 0x55);
    CheckRegisterByte(RegisterType::D, 0xA3);
    CheckRegisterByte(RegisterType::E, 0x1D);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xFE);
    CheckRegisterByte(RegisterType::L, 0x86);
    CheckRegisterWord(RegisterType::PC, 0xD124);
    CheckRegisterWord(RegisterType::SP, 0x51DC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x51DA, 0x1D);
    CheckMemory(0x51DB, 0xA3);
    CheckMemory(0xD123, 0xD1);
}

void test_D1_0096()
{
    if (skip_test_D1_0096)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6302);
    WriteRegisterWord(RegisterType::SP, 0xC32B);
    WriteRegisterByte(RegisterType::A, 0x03);
    WriteRegisterByte(RegisterType::B, 0x46);
    WriteRegisterByte(RegisterType::C, 0xF5);
    WriteRegisterByte(RegisterType::D, 0xE5);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xA5);
    WriteRegisterByte(RegisterType::L, 0xF4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC32C, 0x57);
    WriteMemory(0xC32B, 0x81);
    WriteMemory(0x6302, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x03);
    CheckRegisterByte(RegisterType::B, 0x46);
    CheckRegisterByte(RegisterType::C, 0xF5);
    CheckRegisterByte(RegisterType::D, 0x57);
    CheckRegisterByte(RegisterType::E, 0x81);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xA5);
    CheckRegisterByte(RegisterType::L, 0xF4);
    CheckRegisterWord(RegisterType::PC, 0x6303);
    CheckRegisterWord(RegisterType::SP, 0xC32D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6302, 0xD1);
    CheckMemory(0xC32B, 0x81);
    CheckMemory(0xC32C, 0x57);
}

void test_D1_0097()
{
    if (skip_test_D1_0097)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE6B8);
    WriteRegisterWord(RegisterType::SP, 0xA08E);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0x8D);
    WriteRegisterByte(RegisterType::C, 0x24);
    WriteRegisterByte(RegisterType::D, 0x51);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xC8);
    WriteRegisterByte(RegisterType::L, 0xBC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE6B8, 0xD1);
    WriteMemory(0xA08F, 0xC6);
    WriteMemory(0xA08E, 0x8E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0x8D);
    CheckRegisterByte(RegisterType::C, 0x24);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0x8E);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xC8);
    CheckRegisterByte(RegisterType::L, 0xBC);
    CheckRegisterWord(RegisterType::PC, 0xE6B9);
    CheckRegisterWord(RegisterType::SP, 0xA090);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA08E, 0x8E);
    CheckMemory(0xA08F, 0xC6);
    CheckMemory(0xE6B8, 0xD1);
}

void test_D1_0098()
{
    if (skip_test_D1_0098)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5F26);
    WriteRegisterWord(RegisterType::SP, 0x1F64);
    WriteRegisterByte(RegisterType::A, 0x31);
    WriteRegisterByte(RegisterType::B, 0x5D);
    WriteRegisterByte(RegisterType::C, 0xEF);
    WriteRegisterByte(RegisterType::D, 0x4D);
    WriteRegisterByte(RegisterType::E, 0xB1);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xBB);
    WriteRegisterByte(RegisterType::L, 0xAF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5F26, 0xD1);
    WriteMemory(0x1F65, 0xE8);
    WriteMemory(0x1F64, 0xD9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x31);
    CheckRegisterByte(RegisterType::B, 0x5D);
    CheckRegisterByte(RegisterType::C, 0xEF);
    CheckRegisterByte(RegisterType::D, 0xE8);
    CheckRegisterByte(RegisterType::E, 0xD9);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xBB);
    CheckRegisterByte(RegisterType::L, 0xAF);
    CheckRegisterWord(RegisterType::PC, 0x5F27);
    CheckRegisterWord(RegisterType::SP, 0x1F66);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1F64, 0xD9);
    CheckMemory(0x1F65, 0xE8);
    CheckMemory(0x5F26, 0xD1);
}

void test_D1_0099()
{
    if (skip_test_D1_0099)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE321);
    WriteRegisterWord(RegisterType::SP, 0x14DD);
    WriteRegisterByte(RegisterType::A, 0x13);
    WriteRegisterByte(RegisterType::B, 0xB4);
    WriteRegisterByte(RegisterType::C, 0x9F);
    WriteRegisterByte(RegisterType::D, 0x1C);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0x69);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE321, 0xD1);
    WriteMemory(0x14DE, 0xE3);
    WriteMemory(0x14DD, 0xCD);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x13);
    CheckRegisterByte(RegisterType::B, 0xB4);
    CheckRegisterByte(RegisterType::C, 0x9F);
    CheckRegisterByte(RegisterType::D, 0xE3);
    CheckRegisterByte(RegisterType::E, 0xCD);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0x69);
    CheckRegisterWord(RegisterType::PC, 0xE322);
    CheckRegisterWord(RegisterType::SP, 0x14DF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x14DD, 0xCD);
    CheckMemory(0x14DE, 0xE3);
    CheckMemory(0xE321, 0xD1);
}

void test_D1_009A()
{
    if (skip_test_D1_009A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1555);
    WriteRegisterWord(RegisterType::SP, 0xEA1D);
    WriteRegisterByte(RegisterType::A, 0x2D);
    WriteRegisterByte(RegisterType::B, 0x6A);
    WriteRegisterByte(RegisterType::C, 0x0F);
    WriteRegisterByte(RegisterType::D, 0xC4);
    WriteRegisterByte(RegisterType::E, 0x88);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xAC);
    WriteRegisterByte(RegisterType::L, 0xDC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEA1E, 0x9A);
    WriteMemory(0xEA1D, 0xC8);
    WriteMemory(0x1555, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2D);
    CheckRegisterByte(RegisterType::B, 0x6A);
    CheckRegisterByte(RegisterType::C, 0x0F);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0xC8);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xAC);
    CheckRegisterByte(RegisterType::L, 0xDC);
    CheckRegisterWord(RegisterType::PC, 0x1556);
    CheckRegisterWord(RegisterType::SP, 0xEA1F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1555, 0xD1);
    CheckMemory(0xEA1D, 0xC8);
    CheckMemory(0xEA1E, 0x9A);
}

void test_D1_009B()
{
    if (skip_test_D1_009B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x13A4);
    WriteRegisterWord(RegisterType::SP, 0x93F9);
    WriteRegisterByte(RegisterType::A, 0xA4);
    WriteRegisterByte(RegisterType::B, 0x13);
    WriteRegisterByte(RegisterType::C, 0x61);
    WriteRegisterByte(RegisterType::D, 0x3D);
    WriteRegisterByte(RegisterType::E, 0x4D);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x2E);
    WriteRegisterByte(RegisterType::L, 0x9F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x93FA, 0xFE);
    WriteMemory(0x93F9, 0xDF);
    WriteMemory(0x13A4, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA4);
    CheckRegisterByte(RegisterType::B, 0x13);
    CheckRegisterByte(RegisterType::C, 0x61);
    CheckRegisterByte(RegisterType::D, 0xFE);
    CheckRegisterByte(RegisterType::E, 0xDF);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x2E);
    CheckRegisterByte(RegisterType::L, 0x9F);
    CheckRegisterWord(RegisterType::PC, 0x13A5);
    CheckRegisterWord(RegisterType::SP, 0x93FB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x13A4, 0xD1);
    CheckMemory(0x93F9, 0xDF);
    CheckMemory(0x93FA, 0xFE);
}

void test_D1_009C()
{
    if (skip_test_D1_009C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5F62);
    WriteRegisterWord(RegisterType::SP, 0x9CC7);
    WriteRegisterByte(RegisterType::A, 0x4B);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0xB2);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0xEB);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x45);
    WriteRegisterByte(RegisterType::L, 0xE8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9CC8, 0xA7);
    WriteMemory(0x9CC7, 0xE0);
    WriteMemory(0x5F62, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4B);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0xB2);
    CheckRegisterByte(RegisterType::D, 0xA7);
    CheckRegisterByte(RegisterType::E, 0xE0);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x45);
    CheckRegisterByte(RegisterType::L, 0xE8);
    CheckRegisterWord(RegisterType::PC, 0x5F63);
    CheckRegisterWord(RegisterType::SP, 0x9CC9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5F62, 0xD1);
    CheckMemory(0x9CC7, 0xE0);
    CheckMemory(0x9CC8, 0xA7);
}

void test_D1_009D()
{
    if (skip_test_D1_009D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB68E);
    WriteRegisterWord(RegisterType::SP, 0xD16C);
    WriteRegisterByte(RegisterType::A, 0xD2);
    WriteRegisterByte(RegisterType::B, 0x62);
    WriteRegisterByte(RegisterType::C, 0xF4);
    WriteRegisterByte(RegisterType::D, 0xD5);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0xFE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD16D, 0xA1);
    WriteMemory(0xD16C, 0x3F);
    WriteMemory(0xB68E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD2);
    CheckRegisterByte(RegisterType::B, 0x62);
    CheckRegisterByte(RegisterType::C, 0xF4);
    CheckRegisterByte(RegisterType::D, 0xA1);
    CheckRegisterByte(RegisterType::E, 0x3F);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0xFE);
    CheckRegisterWord(RegisterType::PC, 0xB68F);
    CheckRegisterWord(RegisterType::SP, 0xD16E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB68E, 0xD1);
    CheckMemory(0xD16C, 0x3F);
    CheckMemory(0xD16D, 0xA1);
}

void test_D1_009E()
{
    if (skip_test_D1_009E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x533E);
    WriteRegisterWord(RegisterType::SP, 0xC69B);
    WriteRegisterByte(RegisterType::A, 0x49);
    WriteRegisterByte(RegisterType::B, 0x0C);
    WriteRegisterByte(RegisterType::C, 0xD5);
    WriteRegisterByte(RegisterType::D, 0x65);
    WriteRegisterByte(RegisterType::E, 0x90);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC69C, 0x41);
    WriteMemory(0xC69B, 0x16);
    WriteMemory(0x533E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x49);
    CheckRegisterByte(RegisterType::B, 0x0C);
    CheckRegisterByte(RegisterType::C, 0xD5);
    CheckRegisterByte(RegisterType::D, 0x41);
    CheckRegisterByte(RegisterType::E, 0x16);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0x533F);
    CheckRegisterWord(RegisterType::SP, 0xC69D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x533E, 0xD1);
    CheckMemory(0xC69B, 0x16);
    CheckMemory(0xC69C, 0x41);
}

void test_D1_009F()
{
    if (skip_test_D1_009F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE5EB);
    WriteRegisterWord(RegisterType::SP, 0xF87A);
    WriteRegisterByte(RegisterType::A, 0xE5);
    WriteRegisterByte(RegisterType::B, 0x0C);
    WriteRegisterByte(RegisterType::C, 0xCF);
    WriteRegisterByte(RegisterType::D, 0x4B);
    WriteRegisterByte(RegisterType::E, 0xF9);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x31);
    WriteRegisterByte(RegisterType::L, 0x11);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF87B, 0x4D);
    WriteMemory(0xF87A, 0x5C);
    WriteMemory(0xE5EB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE5);
    CheckRegisterByte(RegisterType::B, 0x0C);
    CheckRegisterByte(RegisterType::C, 0xCF);
    CheckRegisterByte(RegisterType::D, 0x4D);
    CheckRegisterByte(RegisterType::E, 0x5C);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x31);
    CheckRegisterByte(RegisterType::L, 0x11);
    CheckRegisterWord(RegisterType::PC, 0xE5EC);
    CheckRegisterWord(RegisterType::SP, 0xF87C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE5EB, 0xD1);
    CheckMemory(0xF87A, 0x5C);
    CheckMemory(0xF87B, 0x4D);
}

void test_D1_00A0()
{
    if (skip_test_D1_00A0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE4D9);
    WriteRegisterWord(RegisterType::SP, 0xBE03);
    WriteRegisterByte(RegisterType::A, 0xE1);
    WriteRegisterByte(RegisterType::B, 0x26);
    WriteRegisterByte(RegisterType::C, 0xA1);
    WriteRegisterByte(RegisterType::D, 0x53);
    WriteRegisterByte(RegisterType::E, 0x51);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xE9);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE4D9, 0xD1);
    WriteMemory(0xBE04, 0x0D);
    WriteMemory(0xBE03, 0x4D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE1);
    CheckRegisterByte(RegisterType::B, 0x26);
    CheckRegisterByte(RegisterType::C, 0xA1);
    CheckRegisterByte(RegisterType::D, 0x0D);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xE9);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0xE4DA);
    CheckRegisterWord(RegisterType::SP, 0xBE05);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBE03, 0x4D);
    CheckMemory(0xBE04, 0x0D);
    CheckMemory(0xE4D9, 0xD1);
}

void test_D1_00A1()
{
    if (skip_test_D1_00A1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2E32);
    WriteRegisterWord(RegisterType::SP, 0x0559);
    WriteRegisterByte(RegisterType::A, 0x4A);
    WriteRegisterByte(RegisterType::B, 0xA3);
    WriteRegisterByte(RegisterType::C, 0x92);
    WriteRegisterByte(RegisterType::D, 0xB3);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x5C);
    WriteRegisterByte(RegisterType::L, 0xD7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2E32, 0xD1);
    WriteMemory(0x055A, 0x4A);
    WriteMemory(0x0559, 0xC2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4A);
    CheckRegisterByte(RegisterType::B, 0xA3);
    CheckRegisterByte(RegisterType::C, 0x92);
    CheckRegisterByte(RegisterType::D, 0x4A);
    CheckRegisterByte(RegisterType::E, 0xC2);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x5C);
    CheckRegisterByte(RegisterType::L, 0xD7);
    CheckRegisterWord(RegisterType::PC, 0x2E33);
    CheckRegisterWord(RegisterType::SP, 0x055B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0559, 0xC2);
    CheckMemory(0x055A, 0x4A);
    CheckMemory(0x2E32, 0xD1);
}

void test_D1_00A2()
{
    if (skip_test_D1_00A2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCCAE);
    WriteRegisterWord(RegisterType::SP, 0x2D10);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0xD6);
    WriteRegisterByte(RegisterType::C, 0x0E);
    WriteRegisterByte(RegisterType::D, 0x1F);
    WriteRegisterByte(RegisterType::E, 0xBA);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x35);
    WriteRegisterByte(RegisterType::L, 0xC3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCCAE, 0xD1);
    WriteMemory(0x2D11, 0xC0);
    WriteMemory(0x2D10, 0xF0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0xD6);
    CheckRegisterByte(RegisterType::C, 0x0E);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x35);
    CheckRegisterByte(RegisterType::L, 0xC3);
    CheckRegisterWord(RegisterType::PC, 0xCCAF);
    CheckRegisterWord(RegisterType::SP, 0x2D12);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2D10, 0xF0);
    CheckMemory(0x2D11, 0xC0);
    CheckMemory(0xCCAE, 0xD1);
}

void test_D1_00A3()
{
    if (skip_test_D1_00A3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x55CE);
    WriteRegisterWord(RegisterType::SP, 0xC761);
    WriteRegisterByte(RegisterType::A, 0x54);
    WriteRegisterByte(RegisterType::B, 0x95);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0x87);
    WriteRegisterByte(RegisterType::E, 0xAA);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xF5);
    WriteRegisterByte(RegisterType::L, 0xC6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC762, 0x3B);
    WriteMemory(0xC761, 0xBF);
    WriteMemory(0x55CE, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x54);
    CheckRegisterByte(RegisterType::B, 0x95);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0x3B);
    CheckRegisterByte(RegisterType::E, 0xBF);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xF5);
    CheckRegisterByte(RegisterType::L, 0xC6);
    CheckRegisterWord(RegisterType::PC, 0x55CF);
    CheckRegisterWord(RegisterType::SP, 0xC763);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x55CE, 0xD1);
    CheckMemory(0xC761, 0xBF);
    CheckMemory(0xC762, 0x3B);
}

void test_D1_00A4()
{
    if (skip_test_D1_00A4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAE6F);
    WriteRegisterWord(RegisterType::SP, 0x529E);
    WriteRegisterByte(RegisterType::A, 0x7F);
    WriteRegisterByte(RegisterType::B, 0xAD);
    WriteRegisterByte(RegisterType::C, 0xF3);
    WriteRegisterByte(RegisterType::D, 0x73);
    WriteRegisterByte(RegisterType::E, 0xAE);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x97);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAE6F, 0xD1);
    WriteMemory(0x529F, 0x81);
    WriteMemory(0x529E, 0x28);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7F);
    CheckRegisterByte(RegisterType::B, 0xAD);
    CheckRegisterByte(RegisterType::C, 0xF3);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0x28);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x97);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0xAE70);
    CheckRegisterWord(RegisterType::SP, 0x52A0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x529E, 0x28);
    CheckMemory(0x529F, 0x81);
    CheckMemory(0xAE6F, 0xD1);
}

void test_D1_00A5()
{
    if (skip_test_D1_00A5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2718);
    WriteRegisterWord(RegisterType::SP, 0x9BD0);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0xCF);
    WriteRegisterByte(RegisterType::D, 0x85);
    WriteRegisterByte(RegisterType::E, 0x14);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x70);
    WriteRegisterByte(RegisterType::L, 0x66);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9BD1, 0x33);
    WriteMemory(0x9BD0, 0x52);
    WriteMemory(0x2718, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0xCF);
    CheckRegisterByte(RegisterType::D, 0x33);
    CheckRegisterByte(RegisterType::E, 0x52);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x70);
    CheckRegisterByte(RegisterType::L, 0x66);
    CheckRegisterWord(RegisterType::PC, 0x2719);
    CheckRegisterWord(RegisterType::SP, 0x9BD2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2718, 0xD1);
    CheckMemory(0x9BD0, 0x52);
    CheckMemory(0x9BD1, 0x33);
}

void test_D1_00A6()
{
    if (skip_test_D1_00A6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x13F6);
    WriteRegisterWord(RegisterType::SP, 0xDBE8);
    WriteRegisterByte(RegisterType::A, 0x39);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0x14);
    WriteRegisterByte(RegisterType::D, 0x20);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xEC);
    WriteRegisterByte(RegisterType::L, 0x41);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDBE9, 0x6C);
    WriteMemory(0xDBE8, 0x8F);
    WriteMemory(0x13F6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x39);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0x14);
    CheckRegisterByte(RegisterType::D, 0x6C);
    CheckRegisterByte(RegisterType::E, 0x8F);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xEC);
    CheckRegisterByte(RegisterType::L, 0x41);
    CheckRegisterWord(RegisterType::PC, 0x13F7);
    CheckRegisterWord(RegisterType::SP, 0xDBEA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x13F6, 0xD1);
    CheckMemory(0xDBE8, 0x8F);
    CheckMemory(0xDBE9, 0x6C);
}

void test_D1_00A7()
{
    if (skip_test_D1_00A7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB9E8);
    WriteRegisterWord(RegisterType::SP, 0xC8E1);
    WriteRegisterByte(RegisterType::A, 0x79);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0x72);
    WriteRegisterByte(RegisterType::D, 0x7E);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x85);
    WriteRegisterByte(RegisterType::L, 0x8E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC8E2, 0x5C);
    WriteMemory(0xC8E1, 0xB4);
    WriteMemory(0xB9E8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x79);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0x72);
    CheckRegisterByte(RegisterType::D, 0x5C);
    CheckRegisterByte(RegisterType::E, 0xB4);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x85);
    CheckRegisterByte(RegisterType::L, 0x8E);
    CheckRegisterWord(RegisterType::PC, 0xB9E9);
    CheckRegisterWord(RegisterType::SP, 0xC8E3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB9E8, 0xD1);
    CheckMemory(0xC8E1, 0xB4);
    CheckMemory(0xC8E2, 0x5C);
}

void test_D1_00A8()
{
    if (skip_test_D1_00A8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3C36);
    WriteRegisterWord(RegisterType::SP, 0x051C);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0xD8);
    WriteRegisterByte(RegisterType::D, 0x33);
    WriteRegisterByte(RegisterType::E, 0xBE);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xE7);
    WriteRegisterByte(RegisterType::L, 0xEA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x3C36, 0xD1);
    WriteMemory(0x051D, 0xB8);
    WriteMemory(0x051C, 0xEF);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0xD8);
    CheckRegisterByte(RegisterType::D, 0xB8);
    CheckRegisterByte(RegisterType::E, 0xEF);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xE7);
    CheckRegisterByte(RegisterType::L, 0xEA);
    CheckRegisterWord(RegisterType::PC, 0x3C37);
    CheckRegisterWord(RegisterType::SP, 0x051E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x051C, 0xEF);
    CheckMemory(0x051D, 0xB8);
    CheckMemory(0x3C36, 0xD1);
}

void test_D1_00A9()
{
    if (skip_test_D1_00A9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDB86);
    WriteRegisterWord(RegisterType::SP, 0x3CC0);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0xF2);
    WriteRegisterByte(RegisterType::C, 0xAC);
    WriteRegisterByte(RegisterType::D, 0xCF);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xC4);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDB86, 0xD1);
    WriteMemory(0x3CC1, 0xC0);
    WriteMemory(0x3CC0, 0x3E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0xF2);
    CheckRegisterByte(RegisterType::C, 0xAC);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xC4);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0xDB87);
    CheckRegisterWord(RegisterType::SP, 0x3CC2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3CC0, 0x3E);
    CheckMemory(0x3CC1, 0xC0);
    CheckMemory(0xDB86, 0xD1);
}

void test_D1_00AA()
{
    if (skip_test_D1_00AA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4E27);
    WriteRegisterWord(RegisterType::SP, 0x1928);
    WriteRegisterByte(RegisterType::A, 0x8F);
    WriteRegisterByte(RegisterType::B, 0x4C);
    WriteRegisterByte(RegisterType::C, 0x03);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0xA3);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x47);
    WriteRegisterByte(RegisterType::L, 0xB6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4E27, 0xD1);
    WriteMemory(0x1929, 0x51);
    WriteMemory(0x1928, 0xB9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8F);
    CheckRegisterByte(RegisterType::B, 0x4C);
    CheckRegisterByte(RegisterType::C, 0x03);
    CheckRegisterByte(RegisterType::D, 0x51);
    CheckRegisterByte(RegisterType::E, 0xB9);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x47);
    CheckRegisterByte(RegisterType::L, 0xB6);
    CheckRegisterWord(RegisterType::PC, 0x4E28);
    CheckRegisterWord(RegisterType::SP, 0x192A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1928, 0xB9);
    CheckMemory(0x1929, 0x51);
    CheckMemory(0x4E27, 0xD1);
}

void test_D1_00AB()
{
    if (skip_test_D1_00AB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5551);
    WriteRegisterWord(RegisterType::SP, 0xE9D8);
    WriteRegisterByte(RegisterType::A, 0x67);
    WriteRegisterByte(RegisterType::B, 0x48);
    WriteRegisterByte(RegisterType::C, 0xCD);
    WriteRegisterByte(RegisterType::D, 0xBC);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xF5);
    WriteRegisterByte(RegisterType::L, 0x68);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE9D9, 0x2C);
    WriteMemory(0xE9D8, 0x7E);
    WriteMemory(0x5551, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x67);
    CheckRegisterByte(RegisterType::B, 0x48);
    CheckRegisterByte(RegisterType::C, 0xCD);
    CheckRegisterByte(RegisterType::D, 0x2C);
    CheckRegisterByte(RegisterType::E, 0x7E);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xF5);
    CheckRegisterByte(RegisterType::L, 0x68);
    CheckRegisterWord(RegisterType::PC, 0x5552);
    CheckRegisterWord(RegisterType::SP, 0xE9DA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5551, 0xD1);
    CheckMemory(0xE9D8, 0x7E);
    CheckMemory(0xE9D9, 0x2C);
}

void test_D1_00AC()
{
    if (skip_test_D1_00AC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x22CF);
    WriteRegisterWord(RegisterType::SP, 0xDA85);
    WriteRegisterByte(RegisterType::A, 0xB1);
    WriteRegisterByte(RegisterType::B, 0x46);
    WriteRegisterByte(RegisterType::C, 0x5F);
    WriteRegisterByte(RegisterType::D, 0x38);
    WriteRegisterByte(RegisterType::E, 0x41);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xB4);
    WriteRegisterByte(RegisterType::L, 0x5B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDA86, 0x77);
    WriteMemory(0xDA85, 0xCC);
    WriteMemory(0x22CF, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB1);
    CheckRegisterByte(RegisterType::B, 0x46);
    CheckRegisterByte(RegisterType::C, 0x5F);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0xCC);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xB4);
    CheckRegisterByte(RegisterType::L, 0x5B);
    CheckRegisterWord(RegisterType::PC, 0x22D0);
    CheckRegisterWord(RegisterType::SP, 0xDA87);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x22CF, 0xD1);
    CheckMemory(0xDA85, 0xCC);
    CheckMemory(0xDA86, 0x77);
}

void test_D1_00AD()
{
    if (skip_test_D1_00AD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCEA6);
    WriteRegisterWord(RegisterType::SP, 0xC19F);
    WriteRegisterByte(RegisterType::A, 0x35);
    WriteRegisterByte(RegisterType::B, 0xDB);
    WriteRegisterByte(RegisterType::C, 0x58);
    WriteRegisterByte(RegisterType::D, 0xE0);
    WriteRegisterByte(RegisterType::E, 0xF9);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x82);
    WriteRegisterByte(RegisterType::L, 0x67);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCEA6, 0xD1);
    WriteMemory(0xC1A0, 0x0B);
    WriteMemory(0xC19F, 0xA8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x35);
    CheckRegisterByte(RegisterType::B, 0xDB);
    CheckRegisterByte(RegisterType::C, 0x58);
    CheckRegisterByte(RegisterType::D, 0x0B);
    CheckRegisterByte(RegisterType::E, 0xA8);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x82);
    CheckRegisterByte(RegisterType::L, 0x67);
    CheckRegisterWord(RegisterType::PC, 0xCEA7);
    CheckRegisterWord(RegisterType::SP, 0xC1A1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC19F, 0xA8);
    CheckMemory(0xC1A0, 0x0B);
    CheckMemory(0xCEA6, 0xD1);
}

void test_D1_00AE()
{
    if (skip_test_D1_00AE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x34CA);
    WriteRegisterWord(RegisterType::SP, 0xF103);
    WriteRegisterByte(RegisterType::A, 0xF1);
    WriteRegisterByte(RegisterType::B, 0xE3);
    WriteRegisterByte(RegisterType::C, 0xF1);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0x5F);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x5F);
    WriteRegisterByte(RegisterType::L, 0x75);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF104, 0x8C);
    WriteMemory(0xF103, 0x76);
    WriteMemory(0x34CA, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF1);
    CheckRegisterByte(RegisterType::B, 0xE3);
    CheckRegisterByte(RegisterType::C, 0xF1);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0x76);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x5F);
    CheckRegisterByte(RegisterType::L, 0x75);
    CheckRegisterWord(RegisterType::PC, 0x34CB);
    CheckRegisterWord(RegisterType::SP, 0xF105);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x34CA, 0xD1);
    CheckMemory(0xF103, 0x76);
    CheckMemory(0xF104, 0x8C);
}

void test_D1_00AF()
{
    if (skip_test_D1_00AF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3F6A);
    WriteRegisterWord(RegisterType::SP, 0xC954);
    WriteRegisterByte(RegisterType::A, 0xCF);
    WriteRegisterByte(RegisterType::B, 0x9B);
    WriteRegisterByte(RegisterType::C, 0x7C);
    WriteRegisterByte(RegisterType::D, 0xC3);
    WriteRegisterByte(RegisterType::E, 0xD1);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x62);
    WriteRegisterByte(RegisterType::L, 0x3C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC955, 0x56);
    WriteMemory(0xC954, 0x18);
    WriteMemory(0x3F6A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCF);
    CheckRegisterByte(RegisterType::B, 0x9B);
    CheckRegisterByte(RegisterType::C, 0x7C);
    CheckRegisterByte(RegisterType::D, 0x56);
    CheckRegisterByte(RegisterType::E, 0x18);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x62);
    CheckRegisterByte(RegisterType::L, 0x3C);
    CheckRegisterWord(RegisterType::PC, 0x3F6B);
    CheckRegisterWord(RegisterType::SP, 0xC956);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3F6A, 0xD1);
    CheckMemory(0xC954, 0x18);
    CheckMemory(0xC955, 0x56);
}

void test_D1_00B0()
{
    if (skip_test_D1_00B0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4474);
    WriteRegisterWord(RegisterType::SP, 0x1B60);
    WriteRegisterByte(RegisterType::A, 0x3F);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x86);
    WriteRegisterByte(RegisterType::D, 0xFA);
    WriteRegisterByte(RegisterType::E, 0x2C);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x7D);
    WriteRegisterByte(RegisterType::L, 0x7D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4474, 0xD1);
    WriteMemory(0x1B61, 0x13);
    WriteMemory(0x1B60, 0x84);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3F);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x86);
    CheckRegisterByte(RegisterType::D, 0x13);
    CheckRegisterByte(RegisterType::E, 0x84);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x7D);
    CheckRegisterByte(RegisterType::L, 0x7D);
    CheckRegisterWord(RegisterType::PC, 0x4475);
    CheckRegisterWord(RegisterType::SP, 0x1B62);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1B60, 0x84);
    CheckMemory(0x1B61, 0x13);
    CheckMemory(0x4474, 0xD1);
}

void test_D1_00B1()
{
    if (skip_test_D1_00B1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4DB7);
    WriteRegisterWord(RegisterType::SP, 0x169A);
    WriteRegisterByte(RegisterType::A, 0xCE);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0xAF);
    WriteRegisterByte(RegisterType::D, 0x77);
    WriteRegisterByte(RegisterType::E, 0xF6);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xC1);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x4DB7, 0xD1);
    WriteMemory(0x169B, 0xD9);
    WriteMemory(0x169A, 0x05);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCE);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0xAF);
    CheckRegisterByte(RegisterType::D, 0xD9);
    CheckRegisterByte(RegisterType::E, 0x05);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xC1);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0x4DB8);
    CheckRegisterWord(RegisterType::SP, 0x169C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x169A, 0x05);
    CheckMemory(0x169B, 0xD9);
    CheckMemory(0x4DB7, 0xD1);
}

void test_D1_00B2()
{
    if (skip_test_D1_00B2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFD73);
    WriteRegisterWord(RegisterType::SP, 0x1EB5);
    WriteRegisterByte(RegisterType::A, 0xCF);
    WriteRegisterByte(RegisterType::B, 0x9F);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0x34);
    WriteRegisterByte(RegisterType::E, 0x39);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0x29);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFD73, 0xD1);
    WriteMemory(0x1EB6, 0x8C);
    WriteMemory(0x1EB5, 0x8E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCF);
    CheckRegisterByte(RegisterType::B, 0x9F);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0x8E);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0x29);
    CheckRegisterWord(RegisterType::PC, 0xFD74);
    CheckRegisterWord(RegisterType::SP, 0x1EB7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1EB5, 0x8E);
    CheckMemory(0x1EB6, 0x8C);
    CheckMemory(0xFD73, 0xD1);
}

void test_D1_00B3()
{
    if (skip_test_D1_00B3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x95AA);
    WriteRegisterWord(RegisterType::SP, 0x52AB);
    WriteRegisterByte(RegisterType::A, 0x51);
    WriteRegisterByte(RegisterType::B, 0xEF);
    WriteRegisterByte(RegisterType::C, 0x8A);
    WriteRegisterByte(RegisterType::D, 0xCC);
    WriteRegisterByte(RegisterType::E, 0x93);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x0B);
    WriteRegisterByte(RegisterType::L, 0x4E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x95AA, 0xD1);
    WriteMemory(0x52AC, 0x47);
    WriteMemory(0x52AB, 0x11);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x51);
    CheckRegisterByte(RegisterType::B, 0xEF);
    CheckRegisterByte(RegisterType::C, 0x8A);
    CheckRegisterByte(RegisterType::D, 0x47);
    CheckRegisterByte(RegisterType::E, 0x11);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x0B);
    CheckRegisterByte(RegisterType::L, 0x4E);
    CheckRegisterWord(RegisterType::PC, 0x95AB);
    CheckRegisterWord(RegisterType::SP, 0x52AD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x52AB, 0x11);
    CheckMemory(0x52AC, 0x47);
    CheckMemory(0x95AA, 0xD1);
}

void test_D1_00B4()
{
    if (skip_test_D1_00B4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF55A);
    WriteRegisterWord(RegisterType::SP, 0xA8A7);
    WriteRegisterByte(RegisterType::A, 0x02);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0xA7);
    WriteRegisterByte(RegisterType::D, 0xDA);
    WriteRegisterByte(RegisterType::E, 0x54);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x81);
    WriteRegisterByte(RegisterType::L, 0x07);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF55A, 0xD1);
    WriteMemory(0xA8A8, 0xE5);
    WriteMemory(0xA8A7, 0x44);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x02);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0xA7);
    CheckRegisterByte(RegisterType::D, 0xE5);
    CheckRegisterByte(RegisterType::E, 0x44);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x81);
    CheckRegisterByte(RegisterType::L, 0x07);
    CheckRegisterWord(RegisterType::PC, 0xF55B);
    CheckRegisterWord(RegisterType::SP, 0xA8A9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA8A7, 0x44);
    CheckMemory(0xA8A8, 0xE5);
    CheckMemory(0xF55A, 0xD1);
}

void test_D1_00B5()
{
    if (skip_test_D1_00B5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x143B);
    WriteRegisterWord(RegisterType::SP, 0x5263);
    WriteRegisterByte(RegisterType::A, 0x43);
    WriteRegisterByte(RegisterType::B, 0x0C);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0x2A);
    WriteRegisterByte(RegisterType::E, 0xED);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xCE);
    WriteRegisterByte(RegisterType::L, 0xD5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5264, 0x77);
    WriteMemory(0x5263, 0xC3);
    WriteMemory(0x143B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x43);
    CheckRegisterByte(RegisterType::B, 0x0C);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xCE);
    CheckRegisterByte(RegisterType::L, 0xD5);
    CheckRegisterWord(RegisterType::PC, 0x143C);
    CheckRegisterWord(RegisterType::SP, 0x5265);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x143B, 0xD1);
    CheckMemory(0x5263, 0xC3);
    CheckMemory(0x5264, 0x77);
}

void test_D1_00B6()
{
    if (skip_test_D1_00B6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9ADD);
    WriteRegisterWord(RegisterType::SP, 0x0295);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0x55);
    WriteRegisterByte(RegisterType::C, 0x31);
    WriteRegisterByte(RegisterType::D, 0xE3);
    WriteRegisterByte(RegisterType::E, 0xB3);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xDA);
    WriteRegisterByte(RegisterType::L, 0x3E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9ADD, 0xD1);
    WriteMemory(0x0296, 0x23);
    WriteMemory(0x0295, 0x01);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0x55);
    CheckRegisterByte(RegisterType::C, 0x31);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0x01);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xDA);
    CheckRegisterByte(RegisterType::L, 0x3E);
    CheckRegisterWord(RegisterType::PC, 0x9ADE);
    CheckRegisterWord(RegisterType::SP, 0x0297);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0295, 0x01);
    CheckMemory(0x0296, 0x23);
    CheckMemory(0x9ADD, 0xD1);
}

void test_D1_00B7()
{
    if (skip_test_D1_00B7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x656B);
    WriteRegisterWord(RegisterType::SP, 0xF2C4);
    WriteRegisterByte(RegisterType::A, 0x06);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0x2F);
    WriteRegisterByte(RegisterType::D, 0x3A);
    WriteRegisterByte(RegisterType::E, 0xF7);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xED);
    WriteRegisterByte(RegisterType::L, 0x86);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF2C5, 0x73);
    WriteMemory(0xF2C4, 0x2F);
    WriteMemory(0x656B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x06);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0x2F);
    CheckRegisterByte(RegisterType::D, 0x73);
    CheckRegisterByte(RegisterType::E, 0x2F);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xED);
    CheckRegisterByte(RegisterType::L, 0x86);
    CheckRegisterWord(RegisterType::PC, 0x656C);
    CheckRegisterWord(RegisterType::SP, 0xF2C6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x656B, 0xD1);
    CheckMemory(0xF2C4, 0x2F);
    CheckMemory(0xF2C5, 0x73);
}

void test_D1_00B8()
{
    if (skip_test_D1_00B8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4067);
    WriteRegisterWord(RegisterType::SP, 0xE7DD);
    WriteRegisterByte(RegisterType::A, 0x6B);
    WriteRegisterByte(RegisterType::B, 0x98);
    WriteRegisterByte(RegisterType::C, 0xCC);
    WriteRegisterByte(RegisterType::D, 0x08);
    WriteRegisterByte(RegisterType::E, 0xFD);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x79);
    WriteRegisterByte(RegisterType::L, 0x44);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE7DE, 0x5C);
    WriteMemory(0xE7DD, 0x06);
    WriteMemory(0x4067, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6B);
    CheckRegisterByte(RegisterType::B, 0x98);
    CheckRegisterByte(RegisterType::C, 0xCC);
    CheckRegisterByte(RegisterType::D, 0x5C);
    CheckRegisterByte(RegisterType::E, 0x06);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x79);
    CheckRegisterByte(RegisterType::L, 0x44);
    CheckRegisterWord(RegisterType::PC, 0x4068);
    CheckRegisterWord(RegisterType::SP, 0xE7DF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4067, 0xD1);
    CheckMemory(0xE7DD, 0x06);
    CheckMemory(0xE7DE, 0x5C);
}

void test_D1_00B9()
{
    if (skip_test_D1_00B9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2C4D);
    WriteRegisterWord(RegisterType::SP, 0xC67E);
    WriteRegisterByte(RegisterType::A, 0x05);
    WriteRegisterByte(RegisterType::B, 0xD6);
    WriteRegisterByte(RegisterType::C, 0xD0);
    WriteRegisterByte(RegisterType::D, 0x2B);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x32);
    WriteRegisterByte(RegisterType::L, 0xFE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC67F, 0x53);
    WriteMemory(0xC67E, 0x38);
    WriteMemory(0x2C4D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x05);
    CheckRegisterByte(RegisterType::B, 0xD6);
    CheckRegisterByte(RegisterType::C, 0xD0);
    CheckRegisterByte(RegisterType::D, 0x53);
    CheckRegisterByte(RegisterType::E, 0x38);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x32);
    CheckRegisterByte(RegisterType::L, 0xFE);
    CheckRegisterWord(RegisterType::PC, 0x2C4E);
    CheckRegisterWord(RegisterType::SP, 0xC680);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2C4D, 0xD1);
    CheckMemory(0xC67E, 0x38);
    CheckMemory(0xC67F, 0x53);
}

void test_D1_00BA()
{
    if (skip_test_D1_00BA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFD69);
    WriteRegisterWord(RegisterType::SP, 0x9E5B);
    WriteRegisterByte(RegisterType::A, 0x86);
    WriteRegisterByte(RegisterType::B, 0xD6);
    WriteRegisterByte(RegisterType::C, 0xCC);
    WriteRegisterByte(RegisterType::D, 0x77);
    WriteRegisterByte(RegisterType::E, 0x11);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x2F);
    WriteRegisterByte(RegisterType::L, 0x39);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFD69, 0xD1);
    WriteMemory(0x9E5C, 0xCD);
    WriteMemory(0x9E5B, 0xA1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x86);
    CheckRegisterByte(RegisterType::B, 0xD6);
    CheckRegisterByte(RegisterType::C, 0xCC);
    CheckRegisterByte(RegisterType::D, 0xCD);
    CheckRegisterByte(RegisterType::E, 0xA1);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x2F);
    CheckRegisterByte(RegisterType::L, 0x39);
    CheckRegisterWord(RegisterType::PC, 0xFD6A);
    CheckRegisterWord(RegisterType::SP, 0x9E5D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9E5B, 0xA1);
    CheckMemory(0x9E5C, 0xCD);
    CheckMemory(0xFD69, 0xD1);
}

void test_D1_00BB()
{
    if (skip_test_D1_00BB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA3A1);
    WriteRegisterWord(RegisterType::SP, 0x2791);
    WriteRegisterByte(RegisterType::A, 0xE4);
    WriteRegisterByte(RegisterType::B, 0xA7);
    WriteRegisterByte(RegisterType::C, 0x80);
    WriteRegisterByte(RegisterType::D, 0xAC);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x8D);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA3A1, 0xD1);
    WriteMemory(0x2792, 0xAD);
    WriteMemory(0x2791, 0x59);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE4);
    CheckRegisterByte(RegisterType::B, 0xA7);
    CheckRegisterByte(RegisterType::C, 0x80);
    CheckRegisterByte(RegisterType::D, 0xAD);
    CheckRegisterByte(RegisterType::E, 0x59);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x8D);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0xA3A2);
    CheckRegisterWord(RegisterType::SP, 0x2793);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2791, 0x59);
    CheckMemory(0x2792, 0xAD);
    CheckMemory(0xA3A1, 0xD1);
}

void test_D1_00BC()
{
    if (skip_test_D1_00BC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1E0A);
    WriteRegisterWord(RegisterType::SP, 0xDAAD);
    WriteRegisterByte(RegisterType::A, 0xFD);
    WriteRegisterByte(RegisterType::B, 0xB0);
    WriteRegisterByte(RegisterType::C, 0xFB);
    WriteRegisterByte(RegisterType::D, 0x1A);
    WriteRegisterByte(RegisterType::E, 0x57);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xC9);
    WriteRegisterByte(RegisterType::L, 0xB6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDAAE, 0x66);
    WriteMemory(0xDAAD, 0xBF);
    WriteMemory(0x1E0A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFD);
    CheckRegisterByte(RegisterType::B, 0xB0);
    CheckRegisterByte(RegisterType::C, 0xFB);
    CheckRegisterByte(RegisterType::D, 0x66);
    CheckRegisterByte(RegisterType::E, 0xBF);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xC9);
    CheckRegisterByte(RegisterType::L, 0xB6);
    CheckRegisterWord(RegisterType::PC, 0x1E0B);
    CheckRegisterWord(RegisterType::SP, 0xDAAF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1E0A, 0xD1);
    CheckMemory(0xDAAD, 0xBF);
    CheckMemory(0xDAAE, 0x66);
}

void test_D1_00BD()
{
    if (skip_test_D1_00BD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x336B);
    WriteRegisterWord(RegisterType::SP, 0xB87B);
    WriteRegisterByte(RegisterType::A, 0x6C);
    WriteRegisterByte(RegisterType::B, 0xCA);
    WriteRegisterByte(RegisterType::C, 0x07);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0x35);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x9E);
    WriteRegisterByte(RegisterType::L, 0xC9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB87C, 0x3D);
    WriteMemory(0xB87B, 0x67);
    WriteMemory(0x336B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6C);
    CheckRegisterByte(RegisterType::B, 0xCA);
    CheckRegisterByte(RegisterType::C, 0x07);
    CheckRegisterByte(RegisterType::D, 0x3D);
    CheckRegisterByte(RegisterType::E, 0x67);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x9E);
    CheckRegisterByte(RegisterType::L, 0xC9);
    CheckRegisterWord(RegisterType::PC, 0x336C);
    CheckRegisterWord(RegisterType::SP, 0xB87D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x336B, 0xD1);
    CheckMemory(0xB87B, 0x67);
    CheckMemory(0xB87C, 0x3D);
}

void test_D1_00BE()
{
    if (skip_test_D1_00BE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE9ED);
    WriteRegisterWord(RegisterType::SP, 0x7F8A);
    WriteRegisterByte(RegisterType::A, 0x40);
    WriteRegisterByte(RegisterType::B, 0x5E);
    WriteRegisterByte(RegisterType::C, 0xED);
    WriteRegisterByte(RegisterType::D, 0xB5);
    WriteRegisterByte(RegisterType::E, 0xDB);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x83);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE9ED, 0xD1);
    WriteMemory(0x7F8B, 0x7C);
    WriteMemory(0x7F8A, 0x9C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x40);
    CheckRegisterByte(RegisterType::B, 0x5E);
    CheckRegisterByte(RegisterType::C, 0xED);
    CheckRegisterByte(RegisterType::D, 0x7C);
    CheckRegisterByte(RegisterType::E, 0x9C);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x83);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0xE9EE);
    CheckRegisterWord(RegisterType::SP, 0x7F8C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7F8A, 0x9C);
    CheckMemory(0x7F8B, 0x7C);
    CheckMemory(0xE9ED, 0xD1);
}

void test_D1_00BF()
{
    if (skip_test_D1_00BF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDEFB);
    WriteRegisterWord(RegisterType::SP, 0xF31D);
    WriteRegisterByte(RegisterType::A, 0xD6);
    WriteRegisterByte(RegisterType::B, 0x4A);
    WriteRegisterByte(RegisterType::C, 0xF0);
    WriteRegisterByte(RegisterType::D, 0x15);
    WriteRegisterByte(RegisterType::E, 0xEA);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x01);
    WriteRegisterByte(RegisterType::L, 0x34);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF31E, 0xE7);
    WriteMemory(0xF31D, 0x38);
    WriteMemory(0xDEFB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD6);
    CheckRegisterByte(RegisterType::B, 0x4A);
    CheckRegisterByte(RegisterType::C, 0xF0);
    CheckRegisterByte(RegisterType::D, 0xE7);
    CheckRegisterByte(RegisterType::E, 0x38);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x01);
    CheckRegisterByte(RegisterType::L, 0x34);
    CheckRegisterWord(RegisterType::PC, 0xDEFC);
    CheckRegisterWord(RegisterType::SP, 0xF31F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDEFB, 0xD1);
    CheckMemory(0xF31D, 0x38);
    CheckMemory(0xF31E, 0xE7);
}

void test_D1_00C0()
{
    if (skip_test_D1_00C0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6495);
    WriteRegisterWord(RegisterType::SP, 0xE4A8);
    WriteRegisterByte(RegisterType::A, 0xE2);
    WriteRegisterByte(RegisterType::B, 0xEF);
    WriteRegisterByte(RegisterType::C, 0x72);
    WriteRegisterByte(RegisterType::D, 0x47);
    WriteRegisterByte(RegisterType::E, 0x80);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x1F);
    WriteRegisterByte(RegisterType::L, 0x81);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE4A9, 0x9F);
    WriteMemory(0xE4A8, 0x55);
    WriteMemory(0x6495, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE2);
    CheckRegisterByte(RegisterType::B, 0xEF);
    CheckRegisterByte(RegisterType::C, 0x72);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0x55);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x1F);
    CheckRegisterByte(RegisterType::L, 0x81);
    CheckRegisterWord(RegisterType::PC, 0x6496);
    CheckRegisterWord(RegisterType::SP, 0xE4AA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6495, 0xD1);
    CheckMemory(0xE4A8, 0x55);
    CheckMemory(0xE4A9, 0x9F);
}

void test_D1_00C1()
{
    if (skip_test_D1_00C1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFF38);
    WriteRegisterWord(RegisterType::SP, 0xF57D);
    WriteRegisterByte(RegisterType::A, 0x26);
    WriteRegisterByte(RegisterType::B, 0x89);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0x0F);
    WriteRegisterByte(RegisterType::E, 0x26);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x00);
    WriteRegisterByte(RegisterType::L, 0x89);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF38, 0xD1);
    WriteMemory(0xF57E, 0x3E);
    WriteMemory(0xF57D, 0x00);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x26);
    CheckRegisterByte(RegisterType::B, 0x89);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0x00);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x00);
    CheckRegisterByte(RegisterType::L, 0x89);
    CheckRegisterWord(RegisterType::PC, 0xFF39);
    CheckRegisterWord(RegisterType::SP, 0xF57F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF57D, 0x00);
    CheckMemory(0xF57E, 0x3E);
    CheckMemory(0xFF38, 0xD1);
}

void test_D1_00C2()
{
    if (skip_test_D1_00C2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3497);
    WriteRegisterWord(RegisterType::SP, 0x82A0);
    WriteRegisterByte(RegisterType::A, 0x29);
    WriteRegisterByte(RegisterType::B, 0x6E);
    WriteRegisterByte(RegisterType::C, 0x43);
    WriteRegisterByte(RegisterType::D, 0xD3);
    WriteRegisterByte(RegisterType::E, 0x99);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xCF);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x82A1, 0x7C);
    WriteMemory(0x82A0, 0xD3);
    WriteMemory(0x3497, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x29);
    CheckRegisterByte(RegisterType::B, 0x6E);
    CheckRegisterByte(RegisterType::C, 0x43);
    CheckRegisterByte(RegisterType::D, 0x7C);
    CheckRegisterByte(RegisterType::E, 0xD3);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xCF);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0x3498);
    CheckRegisterWord(RegisterType::SP, 0x82A2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3497, 0xD1);
    CheckMemory(0x82A0, 0xD3);
    CheckMemory(0x82A1, 0x7C);
}

void test_D1_00C3()
{
    if (skip_test_D1_00C3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC9CD);
    WriteRegisterWord(RegisterType::SP, 0xA899);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0xB4);
    WriteRegisterByte(RegisterType::C, 0x53);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0xD9);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x2F);
    WriteRegisterByte(RegisterType::L, 0x23);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC9CD, 0xD1);
    WriteMemory(0xA89A, 0x66);
    WriteMemory(0xA899, 0x25);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0xB4);
    CheckRegisterByte(RegisterType::C, 0x53);
    CheckRegisterByte(RegisterType::D, 0x66);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x2F);
    CheckRegisterByte(RegisterType::L, 0x23);
    CheckRegisterWord(RegisterType::PC, 0xC9CE);
    CheckRegisterWord(RegisterType::SP, 0xA89B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA899, 0x25);
    CheckMemory(0xA89A, 0x66);
    CheckMemory(0xC9CD, 0xD1);
}

void test_D1_00C4()
{
    if (skip_test_D1_00C4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDAE2);
    WriteRegisterWord(RegisterType::SP, 0x7277);
    WriteRegisterByte(RegisterType::A, 0xD6);
    WriteRegisterByte(RegisterType::B, 0x19);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0x98);
    WriteRegisterByte(RegisterType::E, 0x52);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x6B);
    WriteRegisterByte(RegisterType::L, 0x27);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDAE2, 0xD1);
    WriteMemory(0x7278, 0x66);
    WriteMemory(0x7277, 0x37);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD6);
    CheckRegisterByte(RegisterType::B, 0x19);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0x66);
    CheckRegisterByte(RegisterType::E, 0x37);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x6B);
    CheckRegisterByte(RegisterType::L, 0x27);
    CheckRegisterWord(RegisterType::PC, 0xDAE3);
    CheckRegisterWord(RegisterType::SP, 0x7279);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7277, 0x37);
    CheckMemory(0x7278, 0x66);
    CheckMemory(0xDAE2, 0xD1);
}

void test_D1_00C5()
{
    if (skip_test_D1_00C5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x94EA);
    WriteRegisterWord(RegisterType::SP, 0x35C3);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0xA6);
    WriteRegisterByte(RegisterType::C, 0x25);
    WriteRegisterByte(RegisterType::D, 0x25);
    WriteRegisterByte(RegisterType::E, 0xD0);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0xCB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x94EA, 0xD1);
    WriteMemory(0x35C4, 0x7B);
    WriteMemory(0x35C3, 0x57);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0xA6);
    CheckRegisterByte(RegisterType::C, 0x25);
    CheckRegisterByte(RegisterType::D, 0x7B);
    CheckRegisterByte(RegisterType::E, 0x57);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0xCB);
    CheckRegisterWord(RegisterType::PC, 0x94EB);
    CheckRegisterWord(RegisterType::SP, 0x35C5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x35C3, 0x57);
    CheckMemory(0x35C4, 0x7B);
    CheckMemory(0x94EA, 0xD1);
}

void test_D1_00C6()
{
    if (skip_test_D1_00C6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA30D);
    WriteRegisterWord(RegisterType::SP, 0xE612);
    WriteRegisterByte(RegisterType::A, 0xDA);
    WriteRegisterByte(RegisterType::B, 0x23);
    WriteRegisterByte(RegisterType::C, 0xF5);
    WriteRegisterByte(RegisterType::D, 0x8E);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xC8);
    WriteRegisterByte(RegisterType::L, 0xAE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE613, 0x76);
    WriteMemory(0xE612, 0x5A);
    WriteMemory(0xA30D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDA);
    CheckRegisterByte(RegisterType::B, 0x23);
    CheckRegisterByte(RegisterType::C, 0xF5);
    CheckRegisterByte(RegisterType::D, 0x76);
    CheckRegisterByte(RegisterType::E, 0x5A);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xC8);
    CheckRegisterByte(RegisterType::L, 0xAE);
    CheckRegisterWord(RegisterType::PC, 0xA30E);
    CheckRegisterWord(RegisterType::SP, 0xE614);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA30D, 0xD1);
    CheckMemory(0xE612, 0x5A);
    CheckMemory(0xE613, 0x76);
}

void test_D1_00C7()
{
    if (skip_test_D1_00C7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5DE7);
    WriteRegisterWord(RegisterType::SP, 0xE164);
    WriteRegisterByte(RegisterType::A, 0x34);
    WriteRegisterByte(RegisterType::B, 0xF9);
    WriteRegisterByte(RegisterType::C, 0xE3);
    WriteRegisterByte(RegisterType::D, 0x24);
    WriteRegisterByte(RegisterType::E, 0x01);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x8E);
    WriteRegisterByte(RegisterType::L, 0x51);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE165, 0xB7);
    WriteMemory(0xE164, 0xED);
    WriteMemory(0x5DE7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x34);
    CheckRegisterByte(RegisterType::B, 0xF9);
    CheckRegisterByte(RegisterType::C, 0xE3);
    CheckRegisterByte(RegisterType::D, 0xB7);
    CheckRegisterByte(RegisterType::E, 0xED);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x8E);
    CheckRegisterByte(RegisterType::L, 0x51);
    CheckRegisterWord(RegisterType::PC, 0x5DE8);
    CheckRegisterWord(RegisterType::SP, 0xE166);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5DE7, 0xD1);
    CheckMemory(0xE164, 0xED);
    CheckMemory(0xE165, 0xB7);
}

void test_D1_00C8()
{
    if (skip_test_D1_00C8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9130);
    WriteRegisterWord(RegisterType::SP, 0x2AE0);
    WriteRegisterByte(RegisterType::A, 0x4F);
    WriteRegisterByte(RegisterType::B, 0xE6);
    WriteRegisterByte(RegisterType::C, 0xA4);
    WriteRegisterByte(RegisterType::D, 0x2F);
    WriteRegisterByte(RegisterType::E, 0x41);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xDF);
    WriteRegisterByte(RegisterType::L, 0xDC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9130, 0xD1);
    WriteMemory(0x2AE1, 0x95);
    WriteMemory(0x2AE0, 0xFC);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4F);
    CheckRegisterByte(RegisterType::B, 0xE6);
    CheckRegisterByte(RegisterType::C, 0xA4);
    CheckRegisterByte(RegisterType::D, 0x95);
    CheckRegisterByte(RegisterType::E, 0xFC);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xDF);
    CheckRegisterByte(RegisterType::L, 0xDC);
    CheckRegisterWord(RegisterType::PC, 0x9131);
    CheckRegisterWord(RegisterType::SP, 0x2AE2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2AE0, 0xFC);
    CheckMemory(0x2AE1, 0x95);
    CheckMemory(0x9130, 0xD1);
}

void test_D1_00C9()
{
    if (skip_test_D1_00C9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2157);
    WriteRegisterWord(RegisterType::SP, 0xC892);
    WriteRegisterByte(RegisterType::A, 0xCF);
    WriteRegisterByte(RegisterType::B, 0x73);
    WriteRegisterByte(RegisterType::C, 0xD9);
    WriteRegisterByte(RegisterType::D, 0x0F);
    WriteRegisterByte(RegisterType::E, 0x42);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x24);
    WriteRegisterByte(RegisterType::L, 0xA0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC893, 0x4A);
    WriteMemory(0xC892, 0x38);
    WriteMemory(0x2157, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCF);
    CheckRegisterByte(RegisterType::B, 0x73);
    CheckRegisterByte(RegisterType::C, 0xD9);
    CheckRegisterByte(RegisterType::D, 0x4A);
    CheckRegisterByte(RegisterType::E, 0x38);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x24);
    CheckRegisterByte(RegisterType::L, 0xA0);
    CheckRegisterWord(RegisterType::PC, 0x2158);
    CheckRegisterWord(RegisterType::SP, 0xC894);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2157, 0xD1);
    CheckMemory(0xC892, 0x38);
    CheckMemory(0xC893, 0x4A);
}

void test_D1_00CA()
{
    if (skip_test_D1_00CA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9C49);
    WriteRegisterWord(RegisterType::SP, 0x01A9);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0x0B);
    WriteRegisterByte(RegisterType::C, 0xFA);
    WriteRegisterByte(RegisterType::D, 0xCB);
    WriteRegisterByte(RegisterType::E, 0xDB);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xDF);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9C49, 0xD1);
    WriteMemory(0x01AA, 0x2B);
    WriteMemory(0x01A9, 0xE2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0x0B);
    CheckRegisterByte(RegisterType::C, 0xFA);
    CheckRegisterByte(RegisterType::D, 0x2B);
    CheckRegisterByte(RegisterType::E, 0xE2);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xDF);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0x9C4A);
    CheckRegisterWord(RegisterType::SP, 0x01AB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x01A9, 0xE2);
    CheckMemory(0x01AA, 0x2B);
    CheckMemory(0x9C49, 0xD1);
}

void test_D1_00CB()
{
    if (skip_test_D1_00CB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1FEA);
    WriteRegisterWord(RegisterType::SP, 0x9CF3);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0xE2);
    WriteRegisterByte(RegisterType::C, 0x72);
    WriteRegisterByte(RegisterType::D, 0x49);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0x70);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9CF4, 0x51);
    WriteMemory(0x9CF3, 0xF0);
    WriteMemory(0x1FEA, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0xE2);
    CheckRegisterByte(RegisterType::C, 0x72);
    CheckRegisterByte(RegisterType::D, 0x51);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0x70);
    CheckRegisterWord(RegisterType::PC, 0x1FEB);
    CheckRegisterWord(RegisterType::SP, 0x9CF5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1FEA, 0xD1);
    CheckMemory(0x9CF3, 0xF0);
    CheckMemory(0x9CF4, 0x51);
}

void test_D1_00CC()
{
    if (skip_test_D1_00CC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE2F9);
    WriteRegisterWord(RegisterType::SP, 0x805B);
    WriteRegisterByte(RegisterType::A, 0xB2);
    WriteRegisterByte(RegisterType::B, 0xC3);
    WriteRegisterByte(RegisterType::C, 0x70);
    WriteRegisterByte(RegisterType::D, 0xFD);
    WriteRegisterByte(RegisterType::E, 0x07);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0x51);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE2F9, 0xD1);
    WriteMemory(0x805C, 0x0A);
    WriteMemory(0x805B, 0xBE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB2);
    CheckRegisterByte(RegisterType::B, 0xC3);
    CheckRegisterByte(RegisterType::C, 0x70);
    CheckRegisterByte(RegisterType::D, 0x0A);
    CheckRegisterByte(RegisterType::E, 0xBE);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0x51);
    CheckRegisterWord(RegisterType::PC, 0xE2FA);
    CheckRegisterWord(RegisterType::SP, 0x805D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x805B, 0xBE);
    CheckMemory(0x805C, 0x0A);
    CheckMemory(0xE2F9, 0xD1);
}

void test_D1_00CD()
{
    if (skip_test_D1_00CD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x56D7);
    WriteRegisterWord(RegisterType::SP, 0xE427);
    WriteRegisterByte(RegisterType::A, 0xAA);
    WriteRegisterByte(RegisterType::B, 0x10);
    WriteRegisterByte(RegisterType::C, 0x0A);
    WriteRegisterByte(RegisterType::D, 0xFE);
    WriteRegisterByte(RegisterType::E, 0xC6);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x6E);
    WriteRegisterByte(RegisterType::L, 0xB5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE428, 0x4C);
    WriteMemory(0xE427, 0xE4);
    WriteMemory(0x56D7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAA);
    CheckRegisterByte(RegisterType::B, 0x10);
    CheckRegisterByte(RegisterType::C, 0x0A);
    CheckRegisterByte(RegisterType::D, 0x4C);
    CheckRegisterByte(RegisterType::E, 0xE4);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x6E);
    CheckRegisterByte(RegisterType::L, 0xB5);
    CheckRegisterWord(RegisterType::PC, 0x56D8);
    CheckRegisterWord(RegisterType::SP, 0xE429);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x56D7, 0xD1);
    CheckMemory(0xE427, 0xE4);
    CheckMemory(0xE428, 0x4C);
}

void test_D1_00CE()
{
    if (skip_test_D1_00CE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE32D);
    WriteRegisterWord(RegisterType::SP, 0x6871);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0xE5);
    WriteRegisterByte(RegisterType::C, 0x25);
    WriteRegisterByte(RegisterType::D, 0x5D);
    WriteRegisterByte(RegisterType::E, 0x65);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0xBE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE32D, 0xD1);
    WriteMemory(0x6872, 0x86);
    WriteMemory(0x6871, 0x21);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0xE5);
    CheckRegisterByte(RegisterType::C, 0x25);
    CheckRegisterByte(RegisterType::D, 0x86);
    CheckRegisterByte(RegisterType::E, 0x21);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0xBE);
    CheckRegisterWord(RegisterType::PC, 0xE32E);
    CheckRegisterWord(RegisterType::SP, 0x6873);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6871, 0x21);
    CheckMemory(0x6872, 0x86);
    CheckMemory(0xE32D, 0xD1);
}

void test_D1_00CF()
{
    if (skip_test_D1_00CF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x78C5);
    WriteRegisterWord(RegisterType::SP, 0x43A5);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0xE3);
    WriteRegisterByte(RegisterType::C, 0x62);
    WriteRegisterByte(RegisterType::D, 0xF9);
    WriteRegisterByte(RegisterType::E, 0xA6);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0xE3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x78C5, 0xD1);
    WriteMemory(0x43A6, 0xC5);
    WriteMemory(0x43A5, 0x1A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0xE3);
    CheckRegisterByte(RegisterType::C, 0x62);
    CheckRegisterByte(RegisterType::D, 0xC5);
    CheckRegisterByte(RegisterType::E, 0x1A);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0xE3);
    CheckRegisterWord(RegisterType::PC, 0x78C6);
    CheckRegisterWord(RegisterType::SP, 0x43A7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x43A5, 0x1A);
    CheckMemory(0x43A6, 0xC5);
    CheckMemory(0x78C5, 0xD1);
}

void test_D1_00D0()
{
    if (skip_test_D1_00D0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDBE1);
    WriteRegisterWord(RegisterType::SP, 0x5DA2);
    WriteRegisterByte(RegisterType::A, 0x36);
    WriteRegisterByte(RegisterType::B, 0x78);
    WriteRegisterByte(RegisterType::C, 0x41);
    WriteRegisterByte(RegisterType::D, 0xA3);
    WriteRegisterByte(RegisterType::E, 0x48);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0x61);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDBE1, 0xD1);
    WriteMemory(0x5DA3, 0xEE);
    WriteMemory(0x5DA2, 0xB1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x36);
    CheckRegisterByte(RegisterType::B, 0x78);
    CheckRegisterByte(RegisterType::C, 0x41);
    CheckRegisterByte(RegisterType::D, 0xEE);
    CheckRegisterByte(RegisterType::E, 0xB1);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0x61);
    CheckRegisterWord(RegisterType::PC, 0xDBE2);
    CheckRegisterWord(RegisterType::SP, 0x5DA4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5DA2, 0xB1);
    CheckMemory(0x5DA3, 0xEE);
    CheckMemory(0xDBE1, 0xD1);
}

void test_D1_00D1()
{
    if (skip_test_D1_00D1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA4E9);
    WriteRegisterWord(RegisterType::SP, 0x08AF);
    WriteRegisterByte(RegisterType::A, 0x06);
    WriteRegisterByte(RegisterType::B, 0x52);
    WriteRegisterByte(RegisterType::C, 0x83);
    WriteRegisterByte(RegisterType::D, 0x1A);
    WriteRegisterByte(RegisterType::E, 0x7B);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0x46);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA4E9, 0xD1);
    WriteMemory(0x08B0, 0xBA);
    WriteMemory(0x08AF, 0xF1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x06);
    CheckRegisterByte(RegisterType::B, 0x52);
    CheckRegisterByte(RegisterType::C, 0x83);
    CheckRegisterByte(RegisterType::D, 0xBA);
    CheckRegisterByte(RegisterType::E, 0xF1);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0x46);
    CheckRegisterWord(RegisterType::PC, 0xA4EA);
    CheckRegisterWord(RegisterType::SP, 0x08B1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x08AF, 0xF1);
    CheckMemory(0x08B0, 0xBA);
    CheckMemory(0xA4E9, 0xD1);
}

void test_D1_00D2()
{
    if (skip_test_D1_00D2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x059D);
    WriteRegisterWord(RegisterType::SP, 0x2435);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0xDB);
    WriteRegisterByte(RegisterType::C, 0xAB);
    WriteRegisterByte(RegisterType::D, 0x7D);
    WriteRegisterByte(RegisterType::E, 0x17);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xB7);
    WriteRegisterByte(RegisterType::L, 0x98);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x2436, 0x44);
    WriteMemory(0x2435, 0xC9);
    WriteMemory(0x059D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0xDB);
    CheckRegisterByte(RegisterType::C, 0xAB);
    CheckRegisterByte(RegisterType::D, 0x44);
    CheckRegisterByte(RegisterType::E, 0xC9);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xB7);
    CheckRegisterByte(RegisterType::L, 0x98);
    CheckRegisterWord(RegisterType::PC, 0x059E);
    CheckRegisterWord(RegisterType::SP, 0x2437);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x059D, 0xD1);
    CheckMemory(0x2435, 0xC9);
    CheckMemory(0x2436, 0x44);
}

void test_D1_00D3()
{
    if (skip_test_D1_00D3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5737);
    WriteRegisterWord(RegisterType::SP, 0x5379);
    WriteRegisterByte(RegisterType::A, 0xDD);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0xE7);
    WriteRegisterByte(RegisterType::D, 0x30);
    WriteRegisterByte(RegisterType::E, 0x15);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x84);
    WriteRegisterByte(RegisterType::L, 0xA0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5737, 0xD1);
    WriteMemory(0x537A, 0xAD);
    WriteMemory(0x5379, 0x05);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDD);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0xE7);
    CheckRegisterByte(RegisterType::D, 0xAD);
    CheckRegisterByte(RegisterType::E, 0x05);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x84);
    CheckRegisterByte(RegisterType::L, 0xA0);
    CheckRegisterWord(RegisterType::PC, 0x5738);
    CheckRegisterWord(RegisterType::SP, 0x537B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5379, 0x05);
    CheckMemory(0x537A, 0xAD);
    CheckMemory(0x5737, 0xD1);
}

void test_D1_00D4()
{
    if (skip_test_D1_00D4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0D46);
    WriteRegisterWord(RegisterType::SP, 0x1CF6);
    WriteRegisterByte(RegisterType::A, 0xF9);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0x6B);
    WriteRegisterByte(RegisterType::D, 0xAC);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0x8C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x1CF7, 0xDD);
    WriteMemory(0x1CF6, 0xD3);
    WriteMemory(0x0D46, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF9);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0x6B);
    CheckRegisterByte(RegisterType::D, 0xDD);
    CheckRegisterByte(RegisterType::E, 0xD3);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0x8C);
    CheckRegisterWord(RegisterType::PC, 0x0D47);
    CheckRegisterWord(RegisterType::SP, 0x1CF8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0D46, 0xD1);
    CheckMemory(0x1CF6, 0xD3);
    CheckMemory(0x1CF7, 0xDD);
}

void test_D1_00D5()
{
    if (skip_test_D1_00D5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6BE4);
    WriteRegisterWord(RegisterType::SP, 0x626C);
    WriteRegisterByte(RegisterType::A, 0xA2);
    WriteRegisterByte(RegisterType::B, 0x85);
    WriteRegisterByte(RegisterType::C, 0xE2);
    WriteRegisterByte(RegisterType::D, 0x43);
    WriteRegisterByte(RegisterType::E, 0x0C);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6BE4, 0xD1);
    WriteMemory(0x626D, 0x45);
    WriteMemory(0x626C, 0x23);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA2);
    CheckRegisterByte(RegisterType::B, 0x85);
    CheckRegisterByte(RegisterType::C, 0xE2);
    CheckRegisterByte(RegisterType::D, 0x45);
    CheckRegisterByte(RegisterType::E, 0x23);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0x6BE5);
    CheckRegisterWord(RegisterType::SP, 0x626E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x626C, 0x23);
    CheckMemory(0x626D, 0x45);
    CheckMemory(0x6BE4, 0xD1);
}

void test_D1_00D6()
{
    if (skip_test_D1_00D6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x707D);
    WriteRegisterWord(RegisterType::SP, 0xBE01);
    WriteRegisterByte(RegisterType::A, 0xC9);
    WriteRegisterByte(RegisterType::B, 0xE1);
    WriteRegisterByte(RegisterType::C, 0x8E);
    WriteRegisterByte(RegisterType::D, 0xDC);
    WriteRegisterByte(RegisterType::E, 0xAC);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xC2);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBE02, 0xB3);
    WriteMemory(0xBE01, 0xDA);
    WriteMemory(0x707D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC9);
    CheckRegisterByte(RegisterType::B, 0xE1);
    CheckRegisterByte(RegisterType::C, 0x8E);
    CheckRegisterByte(RegisterType::D, 0xB3);
    CheckRegisterByte(RegisterType::E, 0xDA);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xC2);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0x707E);
    CheckRegisterWord(RegisterType::SP, 0xBE03);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x707D, 0xD1);
    CheckMemory(0xBE01, 0xDA);
    CheckMemory(0xBE02, 0xB3);
}

void test_D1_00D7()
{
    if (skip_test_D1_00D7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3E7F);
    WriteRegisterWord(RegisterType::SP, 0x3AC7);
    WriteRegisterByte(RegisterType::A, 0x4E);
    WriteRegisterByte(RegisterType::B, 0xE1);
    WriteRegisterByte(RegisterType::C, 0x7C);
    WriteRegisterByte(RegisterType::D, 0x29);
    WriteRegisterByte(RegisterType::E, 0xD3);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x5F);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x3E7F, 0xD1);
    WriteMemory(0x3AC8, 0x03);
    WriteMemory(0x3AC7, 0x70);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4E);
    CheckRegisterByte(RegisterType::B, 0xE1);
    CheckRegisterByte(RegisterType::C, 0x7C);
    CheckRegisterByte(RegisterType::D, 0x03);
    CheckRegisterByte(RegisterType::E, 0x70);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x5F);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0x3E80);
    CheckRegisterWord(RegisterType::SP, 0x3AC9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3AC7, 0x70);
    CheckMemory(0x3AC8, 0x03);
    CheckMemory(0x3E7F, 0xD1);
}

void test_D1_00D8()
{
    if (skip_test_D1_00D8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0B2E);
    WriteRegisterWord(RegisterType::SP, 0xA1BA);
    WriteRegisterByte(RegisterType::A, 0x21);
    WriteRegisterByte(RegisterType::B, 0x64);
    WriteRegisterByte(RegisterType::C, 0x8F);
    WriteRegisterByte(RegisterType::D, 0x2A);
    WriteRegisterByte(RegisterType::E, 0x61);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x58);
    WriteRegisterByte(RegisterType::L, 0x65);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA1BB, 0x09);
    WriteMemory(0xA1BA, 0x1C);
    WriteMemory(0x0B2E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x21);
    CheckRegisterByte(RegisterType::B, 0x64);
    CheckRegisterByte(RegisterType::C, 0x8F);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0x1C);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x58);
    CheckRegisterByte(RegisterType::L, 0x65);
    CheckRegisterWord(RegisterType::PC, 0x0B2F);
    CheckRegisterWord(RegisterType::SP, 0xA1BC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0B2E, 0xD1);
    CheckMemory(0xA1BA, 0x1C);
    CheckMemory(0xA1BB, 0x09);
}

void test_D1_00D9()
{
    if (skip_test_D1_00D9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB98E);
    WriteRegisterWord(RegisterType::SP, 0x9522);
    WriteRegisterByte(RegisterType::A, 0x18);
    WriteRegisterByte(RegisterType::B, 0x25);
    WriteRegisterByte(RegisterType::C, 0x0A);
    WriteRegisterByte(RegisterType::D, 0x83);
    WriteRegisterByte(RegisterType::E, 0xCB);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x32);
    WriteRegisterByte(RegisterType::L, 0x0A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB98E, 0xD1);
    WriteMemory(0x9523, 0xAC);
    WriteMemory(0x9522, 0x1D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x18);
    CheckRegisterByte(RegisterType::B, 0x25);
    CheckRegisterByte(RegisterType::C, 0x0A);
    CheckRegisterByte(RegisterType::D, 0xAC);
    CheckRegisterByte(RegisterType::E, 0x1D);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x32);
    CheckRegisterByte(RegisterType::L, 0x0A);
    CheckRegisterWord(RegisterType::PC, 0xB98F);
    CheckRegisterWord(RegisterType::SP, 0x9524);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9522, 0x1D);
    CheckMemory(0x9523, 0xAC);
    CheckMemory(0xB98E, 0xD1);
}

void test_D1_00DA()
{
    if (skip_test_D1_00DA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6D1B);
    WriteRegisterWord(RegisterType::SP, 0xB43B);
    WriteRegisterByte(RegisterType::A, 0x96);
    WriteRegisterByte(RegisterType::B, 0x1C);
    WriteRegisterByte(RegisterType::C, 0xDE);
    WriteRegisterByte(RegisterType::D, 0xA2);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xA3);
    WriteRegisterByte(RegisterType::L, 0xEA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB43C, 0x75);
    WriteMemory(0xB43B, 0x39);
    WriteMemory(0x6D1B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x96);
    CheckRegisterByte(RegisterType::B, 0x1C);
    CheckRegisterByte(RegisterType::C, 0xDE);
    CheckRegisterByte(RegisterType::D, 0x75);
    CheckRegisterByte(RegisterType::E, 0x39);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xA3);
    CheckRegisterByte(RegisterType::L, 0xEA);
    CheckRegisterWord(RegisterType::PC, 0x6D1C);
    CheckRegisterWord(RegisterType::SP, 0xB43D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6D1B, 0xD1);
    CheckMemory(0xB43B, 0x39);
    CheckMemory(0xB43C, 0x75);
}

void test_D1_00DB()
{
    if (skip_test_D1_00DB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD6BD);
    WriteRegisterWord(RegisterType::SP, 0x1F84);
    WriteRegisterByte(RegisterType::A, 0x5F);
    WriteRegisterByte(RegisterType::B, 0x9B);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0x21);
    WriteRegisterByte(RegisterType::E, 0x97);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD6BD, 0xD1);
    WriteMemory(0x1F85, 0xF9);
    WriteMemory(0x1F84, 0x3A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5F);
    CheckRegisterByte(RegisterType::B, 0x9B);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0xF9);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0xD6BE);
    CheckRegisterWord(RegisterType::SP, 0x1F86);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1F84, 0x3A);
    CheckMemory(0x1F85, 0xF9);
    CheckMemory(0xD6BD, 0xD1);
}

void test_D1_00DC()
{
    if (skip_test_D1_00DC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3777);
    WriteRegisterWord(RegisterType::SP, 0x1D94);
    WriteRegisterByte(RegisterType::A, 0x60);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0x2E);
    WriteRegisterByte(RegisterType::D, 0x2E);
    WriteRegisterByte(RegisterType::E, 0x2A);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xC3);
    WriteRegisterByte(RegisterType::L, 0xEA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x3777, 0xD1);
    WriteMemory(0x1D95, 0x28);
    WriteMemory(0x1D94, 0x3B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x60);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0x2E);
    CheckRegisterByte(RegisterType::D, 0x28);
    CheckRegisterByte(RegisterType::E, 0x3B);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xC3);
    CheckRegisterByte(RegisterType::L, 0xEA);
    CheckRegisterWord(RegisterType::PC, 0x3778);
    CheckRegisterWord(RegisterType::SP, 0x1D96);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1D94, 0x3B);
    CheckMemory(0x1D95, 0x28);
    CheckMemory(0x3777, 0xD1);
}

void test_D1_00DD()
{
    if (skip_test_D1_00DD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2418);
    WriteRegisterWord(RegisterType::SP, 0x238B);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0x43);
    WriteRegisterByte(RegisterType::C, 0x1A);
    WriteRegisterByte(RegisterType::D, 0x36);
    WriteRegisterByte(RegisterType::E, 0x5A);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0xEC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2418, 0xD1);
    WriteMemory(0x238C, 0xFF);
    WriteMemory(0x238B, 0x6B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0x43);
    CheckRegisterByte(RegisterType::C, 0x1A);
    CheckRegisterByte(RegisterType::D, 0xFF);
    CheckRegisterByte(RegisterType::E, 0x6B);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0xEC);
    CheckRegisterWord(RegisterType::PC, 0x2419);
    CheckRegisterWord(RegisterType::SP, 0x238D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x238B, 0x6B);
    CheckMemory(0x238C, 0xFF);
    CheckMemory(0x2418, 0xD1);
}

void test_D1_00DE()
{
    if (skip_test_D1_00DE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x604E);
    WriteRegisterWord(RegisterType::SP, 0xB55E);
    WriteRegisterByte(RegisterType::A, 0x11);
    WriteRegisterByte(RegisterType::B, 0xEB);
    WriteRegisterByte(RegisterType::C, 0xE7);
    WriteRegisterByte(RegisterType::D, 0x92);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0xBB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB55F, 0x02);
    WriteMemory(0xB55E, 0xFC);
    WriteMemory(0x604E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x11);
    CheckRegisterByte(RegisterType::B, 0xEB);
    CheckRegisterByte(RegisterType::C, 0xE7);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0xFC);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0xBB);
    CheckRegisterWord(RegisterType::PC, 0x604F);
    CheckRegisterWord(RegisterType::SP, 0xB560);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x604E, 0xD1);
    CheckMemory(0xB55E, 0xFC);
    CheckMemory(0xB55F, 0x02);
}

void test_D1_00DF()
{
    if (skip_test_D1_00DF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6883);
    WriteRegisterWord(RegisterType::SP, 0x6462);
    WriteRegisterByte(RegisterType::A, 0x76);
    WriteRegisterByte(RegisterType::B, 0xF2);
    WriteRegisterByte(RegisterType::C, 0x8E);
    WriteRegisterByte(RegisterType::D, 0xE7);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x8A);
    WriteRegisterByte(RegisterType::L, 0x3C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6883, 0xD1);
    WriteMemory(0x6463, 0xF0);
    WriteMemory(0x6462, 0xC7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x76);
    CheckRegisterByte(RegisterType::B, 0xF2);
    CheckRegisterByte(RegisterType::C, 0x8E);
    CheckRegisterByte(RegisterType::D, 0xF0);
    CheckRegisterByte(RegisterType::E, 0xC7);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x8A);
    CheckRegisterByte(RegisterType::L, 0x3C);
    CheckRegisterWord(RegisterType::PC, 0x6884);
    CheckRegisterWord(RegisterType::SP, 0x6464);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6462, 0xC7);
    CheckMemory(0x6463, 0xF0);
    CheckMemory(0x6883, 0xD1);
}

void test_D1_00E0()
{
    if (skip_test_D1_00E0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6095);
    WriteRegisterWord(RegisterType::SP, 0xEA81);
    WriteRegisterByte(RegisterType::A, 0x74);
    WriteRegisterByte(RegisterType::B, 0xA8);
    WriteRegisterByte(RegisterType::C, 0x7D);
    WriteRegisterByte(RegisterType::D, 0x5B);
    WriteRegisterByte(RegisterType::E, 0xD4);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x75);
    WriteRegisterByte(RegisterType::L, 0xC7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEA82, 0x32);
    WriteMemory(0xEA81, 0xD7);
    WriteMemory(0x6095, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x74);
    CheckRegisterByte(RegisterType::B, 0xA8);
    CheckRegisterByte(RegisterType::C, 0x7D);
    CheckRegisterByte(RegisterType::D, 0x32);
    CheckRegisterByte(RegisterType::E, 0xD7);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x75);
    CheckRegisterByte(RegisterType::L, 0xC7);
    CheckRegisterWord(RegisterType::PC, 0x6096);
    CheckRegisterWord(RegisterType::SP, 0xEA83);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6095, 0xD1);
    CheckMemory(0xEA81, 0xD7);
    CheckMemory(0xEA82, 0x32);
}

void test_D1_00E1()
{
    if (skip_test_D1_00E1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x572C);
    WriteRegisterWord(RegisterType::SP, 0x0F96);
    WriteRegisterByte(RegisterType::A, 0xBE);
    WriteRegisterByte(RegisterType::B, 0x82);
    WriteRegisterByte(RegisterType::C, 0xBA);
    WriteRegisterByte(RegisterType::D, 0xD8);
    WriteRegisterByte(RegisterType::E, 0xFF);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0x11);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x572C, 0xD1);
    WriteMemory(0x0F97, 0xDF);
    WriteMemory(0x0F96, 0xAB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBE);
    CheckRegisterByte(RegisterType::B, 0x82);
    CheckRegisterByte(RegisterType::C, 0xBA);
    CheckRegisterByte(RegisterType::D, 0xDF);
    CheckRegisterByte(RegisterType::E, 0xAB);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0x11);
    CheckRegisterWord(RegisterType::PC, 0x572D);
    CheckRegisterWord(RegisterType::SP, 0x0F98);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0F96, 0xAB);
    CheckMemory(0x0F97, 0xDF);
    CheckMemory(0x572C, 0xD1);
}

void test_D1_00E2()
{
    if (skip_test_D1_00E2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC6E9);
    WriteRegisterWord(RegisterType::SP, 0x2D56);
    WriteRegisterByte(RegisterType::A, 0xCF);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0xF0);
    WriteRegisterByte(RegisterType::E, 0x87);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xE5);
    WriteRegisterByte(RegisterType::L, 0x39);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC6E9, 0xD1);
    WriteMemory(0x2D57, 0xC0);
    WriteMemory(0x2D56, 0xD4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCF);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0xD4);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xE5);
    CheckRegisterByte(RegisterType::L, 0x39);
    CheckRegisterWord(RegisterType::PC, 0xC6EA);
    CheckRegisterWord(RegisterType::SP, 0x2D58);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2D56, 0xD4);
    CheckMemory(0x2D57, 0xC0);
    CheckMemory(0xC6E9, 0xD1);
}

void test_D1_00E3()
{
    if (skip_test_D1_00E3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7867);
    WriteRegisterWord(RegisterType::SP, 0x1C3A);
    WriteRegisterByte(RegisterType::A, 0x4B);
    WriteRegisterByte(RegisterType::B, 0xCA);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0xBC);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x0F);
    WriteRegisterByte(RegisterType::L, 0x37);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7867, 0xD1);
    WriteMemory(0x1C3B, 0x24);
    WriteMemory(0x1C3A, 0x01);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4B);
    CheckRegisterByte(RegisterType::B, 0xCA);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0x24);
    CheckRegisterByte(RegisterType::E, 0x01);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x0F);
    CheckRegisterByte(RegisterType::L, 0x37);
    CheckRegisterWord(RegisterType::PC, 0x7868);
    CheckRegisterWord(RegisterType::SP, 0x1C3C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1C3A, 0x01);
    CheckMemory(0x1C3B, 0x24);
    CheckMemory(0x7867, 0xD1);
}

void test_D1_00E4()
{
    if (skip_test_D1_00E4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x026E);
    WriteRegisterWord(RegisterType::SP, 0x382E);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0xDF);
    WriteRegisterByte(RegisterType::C, 0x1D);
    WriteRegisterByte(RegisterType::D, 0x15);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0x2C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x382F, 0x72);
    WriteMemory(0x382E, 0x93);
    WriteMemory(0x026E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0xDF);
    CheckRegisterByte(RegisterType::C, 0x1D);
    CheckRegisterByte(RegisterType::D, 0x72);
    CheckRegisterByte(RegisterType::E, 0x93);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0x2C);
    CheckRegisterWord(RegisterType::PC, 0x026F);
    CheckRegisterWord(RegisterType::SP, 0x3830);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x026E, 0xD1);
    CheckMemory(0x382E, 0x93);
    CheckMemory(0x382F, 0x72);
}

void test_D1_00E5()
{
    if (skip_test_D1_00E5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7886);
    WriteRegisterWord(RegisterType::SP, 0x822A);
    WriteRegisterByte(RegisterType::A, 0x5E);
    WriteRegisterByte(RegisterType::B, 0xF9);
    WriteRegisterByte(RegisterType::C, 0x73);
    WriteRegisterByte(RegisterType::D, 0xF8);
    WriteRegisterByte(RegisterType::E, 0xB2);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x70);
    WriteRegisterByte(RegisterType::L, 0xD0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x822B, 0x10);
    WriteMemory(0x822A, 0xC4);
    WriteMemory(0x7886, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5E);
    CheckRegisterByte(RegisterType::B, 0xF9);
    CheckRegisterByte(RegisterType::C, 0x73);
    CheckRegisterByte(RegisterType::D, 0x10);
    CheckRegisterByte(RegisterType::E, 0xC4);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x70);
    CheckRegisterByte(RegisterType::L, 0xD0);
    CheckRegisterWord(RegisterType::PC, 0x7887);
    CheckRegisterWord(RegisterType::SP, 0x822C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7886, 0xD1);
    CheckMemory(0x822A, 0xC4);
    CheckMemory(0x822B, 0x10);
}

void test_D1_00E6()
{
    if (skip_test_D1_00E6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x860A);
    WriteRegisterWord(RegisterType::SP, 0x8F21);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0xD1);
    WriteRegisterByte(RegisterType::C, 0xF1);
    WriteRegisterByte(RegisterType::D, 0xE0);
    WriteRegisterByte(RegisterType::E, 0xF6);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0xFA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8F22, 0x94);
    WriteMemory(0x8F21, 0x6E);
    WriteMemory(0x860A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0xD1);
    CheckRegisterByte(RegisterType::C, 0xF1);
    CheckRegisterByte(RegisterType::D, 0x94);
    CheckRegisterByte(RegisterType::E, 0x6E);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0xFA);
    CheckRegisterWord(RegisterType::PC, 0x860B);
    CheckRegisterWord(RegisterType::SP, 0x8F23);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x860A, 0xD1);
    CheckMemory(0x8F21, 0x6E);
    CheckMemory(0x8F22, 0x94);
}

void test_D1_00E7()
{
    if (skip_test_D1_00E7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x851D);
    WriteRegisterWord(RegisterType::SP, 0xEEA5);
    WriteRegisterByte(RegisterType::A, 0xD3);
    WriteRegisterByte(RegisterType::B, 0x89);
    WriteRegisterByte(RegisterType::C, 0x1C);
    WriteRegisterByte(RegisterType::D, 0xAD);
    WriteRegisterByte(RegisterType::E, 0x66);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x9A);
    WriteRegisterByte(RegisterType::L, 0x71);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEEA6, 0x4E);
    WriteMemory(0xEEA5, 0x05);
    WriteMemory(0x851D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD3);
    CheckRegisterByte(RegisterType::B, 0x89);
    CheckRegisterByte(RegisterType::C, 0x1C);
    CheckRegisterByte(RegisterType::D, 0x4E);
    CheckRegisterByte(RegisterType::E, 0x05);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x9A);
    CheckRegisterByte(RegisterType::L, 0x71);
    CheckRegisterWord(RegisterType::PC, 0x851E);
    CheckRegisterWord(RegisterType::SP, 0xEEA7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x851D, 0xD1);
    CheckMemory(0xEEA5, 0x05);
    CheckMemory(0xEEA6, 0x4E);
}

void test_D1_00E8()
{
    if (skip_test_D1_00E8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCCE6);
    WriteRegisterWord(RegisterType::SP, 0xB8F2);
    WriteRegisterByte(RegisterType::A, 0xD2);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0xF0);
    WriteRegisterByte(RegisterType::D, 0x7D);
    WriteRegisterByte(RegisterType::E, 0x80);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0xCC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCCE6, 0xD1);
    WriteMemory(0xB8F3, 0x6D);
    WriteMemory(0xB8F2, 0x4D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD2);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0xF0);
    CheckRegisterByte(RegisterType::D, 0x6D);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0xCC);
    CheckRegisterWord(RegisterType::PC, 0xCCE7);
    CheckRegisterWord(RegisterType::SP, 0xB8F4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB8F2, 0x4D);
    CheckMemory(0xB8F3, 0x6D);
    CheckMemory(0xCCE6, 0xD1);
}

void test_D1_00E9()
{
    if (skip_test_D1_00E9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x25F3);
    WriteRegisterWord(RegisterType::SP, 0x2B16);
    WriteRegisterByte(RegisterType::A, 0x3D);
    WriteRegisterByte(RegisterType::B, 0x1C);
    WriteRegisterByte(RegisterType::C, 0xD7);
    WriteRegisterByte(RegisterType::D, 0x67);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x2E);
    WriteRegisterByte(RegisterType::L, 0xF5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2B17, 0xBA);
    WriteMemory(0x2B16, 0x6B);
    WriteMemory(0x25F3, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3D);
    CheckRegisterByte(RegisterType::B, 0x1C);
    CheckRegisterByte(RegisterType::C, 0xD7);
    CheckRegisterByte(RegisterType::D, 0xBA);
    CheckRegisterByte(RegisterType::E, 0x6B);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x2E);
    CheckRegisterByte(RegisterType::L, 0xF5);
    CheckRegisterWord(RegisterType::PC, 0x25F4);
    CheckRegisterWord(RegisterType::SP, 0x2B18);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x25F3, 0xD1);
    CheckMemory(0x2B16, 0x6B);
    CheckMemory(0x2B17, 0xBA);
}

void test_D1_00EA()
{
    if (skip_test_D1_00EA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA3C7);
    WriteRegisterWord(RegisterType::SP, 0x406A);
    WriteRegisterByte(RegisterType::A, 0x41);
    WriteRegisterByte(RegisterType::B, 0x4D);
    WriteRegisterByte(RegisterType::C, 0xD6);
    WriteRegisterByte(RegisterType::D, 0xD1);
    WriteRegisterByte(RegisterType::E, 0x63);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x5F);
    WriteRegisterByte(RegisterType::L, 0xD1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA3C7, 0xD1);
    WriteMemory(0x406B, 0xD2);
    WriteMemory(0x406A, 0x41);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x41);
    CheckRegisterByte(RegisterType::B, 0x4D);
    CheckRegisterByte(RegisterType::C, 0xD6);
    CheckRegisterByte(RegisterType::D, 0xD2);
    CheckRegisterByte(RegisterType::E, 0x41);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x5F);
    CheckRegisterByte(RegisterType::L, 0xD1);
    CheckRegisterWord(RegisterType::PC, 0xA3C8);
    CheckRegisterWord(RegisterType::SP, 0x406C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x406A, 0x41);
    CheckMemory(0x406B, 0xD2);
    CheckMemory(0xA3C7, 0xD1);
}

void test_D1_00EB()
{
    if (skip_test_D1_00EB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA00D);
    WriteRegisterWord(RegisterType::SP, 0x2325);
    WriteRegisterByte(RegisterType::A, 0x8D);
    WriteRegisterByte(RegisterType::B, 0x01);
    WriteRegisterByte(RegisterType::C, 0x72);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0x7B);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xBB);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA00D, 0xD1);
    WriteMemory(0x2326, 0xC2);
    WriteMemory(0x2325, 0x61);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8D);
    CheckRegisterByte(RegisterType::B, 0x01);
    CheckRegisterByte(RegisterType::C, 0x72);
    CheckRegisterByte(RegisterType::D, 0xC2);
    CheckRegisterByte(RegisterType::E, 0x61);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xBB);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0xA00E);
    CheckRegisterWord(RegisterType::SP, 0x2327);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2325, 0x61);
    CheckMemory(0x2326, 0xC2);
    CheckMemory(0xA00D, 0xD1);
}

void test_D1_00EC()
{
    if (skip_test_D1_00EC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4353);
    WriteRegisterWord(RegisterType::SP, 0x3EB9);
    WriteRegisterByte(RegisterType::A, 0xF2);
    WriteRegisterByte(RegisterType::B, 0x6F);
    WriteRegisterByte(RegisterType::C, 0xB2);
    WriteRegisterByte(RegisterType::D, 0xF7);
    WriteRegisterByte(RegisterType::E, 0xB4);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0xB4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4353, 0xD1);
    WriteMemory(0x3EBA, 0xB2);
    WriteMemory(0x3EB9, 0xAB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF2);
    CheckRegisterByte(RegisterType::B, 0x6F);
    CheckRegisterByte(RegisterType::C, 0xB2);
    CheckRegisterByte(RegisterType::D, 0xB2);
    CheckRegisterByte(RegisterType::E, 0xAB);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0xB4);
    CheckRegisterWord(RegisterType::PC, 0x4354);
    CheckRegisterWord(RegisterType::SP, 0x3EBB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3EB9, 0xAB);
    CheckMemory(0x3EBA, 0xB2);
    CheckMemory(0x4353, 0xD1);
}

void test_D1_00ED()
{
    if (skip_test_D1_00ED)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE8AF);
    WriteRegisterWord(RegisterType::SP, 0x6C81);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0x38);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0x29);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x8F);
    WriteRegisterByte(RegisterType::L, 0xE1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE8AF, 0xD1);
    WriteMemory(0x6C82, 0x2D);
    WriteMemory(0x6C81, 0xF9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0x38);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0x2D);
    CheckRegisterByte(RegisterType::E, 0xF9);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x8F);
    CheckRegisterByte(RegisterType::L, 0xE1);
    CheckRegisterWord(RegisterType::PC, 0xE8B0);
    CheckRegisterWord(RegisterType::SP, 0x6C83);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6C81, 0xF9);
    CheckMemory(0x6C82, 0x2D);
    CheckMemory(0xE8AF, 0xD1);
}

void test_D1_00EE()
{
    if (skip_test_D1_00EE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE9DE);
    WriteRegisterWord(RegisterType::SP, 0x45F3);
    WriteRegisterByte(RegisterType::A, 0x04);
    WriteRegisterByte(RegisterType::B, 0x73);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE9DE, 0xD1);
    WriteMemory(0x45F4, 0x3C);
    WriteMemory(0x45F3, 0x52);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x04);
    CheckRegisterByte(RegisterType::B, 0x73);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0x3C);
    CheckRegisterByte(RegisterType::E, 0x52);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0xE9DF);
    CheckRegisterWord(RegisterType::SP, 0x45F5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x45F3, 0x52);
    CheckMemory(0x45F4, 0x3C);
    CheckMemory(0xE9DE, 0xD1);
}

void test_D1_00EF()
{
    if (skip_test_D1_00EF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC452);
    WriteRegisterWord(RegisterType::SP, 0x34BD);
    WriteRegisterByte(RegisterType::A, 0x25);
    WriteRegisterByte(RegisterType::B, 0xBF);
    WriteRegisterByte(RegisterType::C, 0xE6);
    WriteRegisterByte(RegisterType::D, 0xE8);
    WriteRegisterByte(RegisterType::E, 0xD0);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0x02);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC452, 0xD1);
    WriteMemory(0x34BE, 0x0C);
    WriteMemory(0x34BD, 0xBA);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x25);
    CheckRegisterByte(RegisterType::B, 0xBF);
    CheckRegisterByte(RegisterType::C, 0xE6);
    CheckRegisterByte(RegisterType::D, 0x0C);
    CheckRegisterByte(RegisterType::E, 0xBA);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0x02);
    CheckRegisterWord(RegisterType::PC, 0xC453);
    CheckRegisterWord(RegisterType::SP, 0x34BF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x34BD, 0xBA);
    CheckMemory(0x34BE, 0x0C);
    CheckMemory(0xC452, 0xD1);
}

void test_D1_00F0()
{
    if (skip_test_D1_00F0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5E85);
    WriteRegisterWord(RegisterType::SP, 0x6271);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0x06);
    WriteRegisterByte(RegisterType::D, 0x2B);
    WriteRegisterByte(RegisterType::E, 0x92);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x71);
    WriteRegisterByte(RegisterType::L, 0xAD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6272, 0x27);
    WriteMemory(0x6271, 0x60);
    WriteMemory(0x5E85, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0x06);
    CheckRegisterByte(RegisterType::D, 0x27);
    CheckRegisterByte(RegisterType::E, 0x60);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x71);
    CheckRegisterByte(RegisterType::L, 0xAD);
    CheckRegisterWord(RegisterType::PC, 0x5E86);
    CheckRegisterWord(RegisterType::SP, 0x6273);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5E85, 0xD1);
    CheckMemory(0x6271, 0x60);
    CheckMemory(0x6272, 0x27);
}

void test_D1_00F1()
{
    if (skip_test_D1_00F1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xABCD);
    WriteRegisterWord(RegisterType::SP, 0x650F);
    WriteRegisterByte(RegisterType::A, 0x52);
    WriteRegisterByte(RegisterType::B, 0x50);
    WriteRegisterByte(RegisterType::C, 0xB5);
    WriteRegisterByte(RegisterType::D, 0xA7);
    WriteRegisterByte(RegisterType::E, 0xFC);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x00);
    WriteRegisterByte(RegisterType::L, 0x3C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xABCD, 0xD1);
    WriteMemory(0x6510, 0x03);
    WriteMemory(0x650F, 0x07);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x52);
    CheckRegisterByte(RegisterType::B, 0x50);
    CheckRegisterByte(RegisterType::C, 0xB5);
    CheckRegisterByte(RegisterType::D, 0x03);
    CheckRegisterByte(RegisterType::E, 0x07);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x00);
    CheckRegisterByte(RegisterType::L, 0x3C);
    CheckRegisterWord(RegisterType::PC, 0xABCE);
    CheckRegisterWord(RegisterType::SP, 0x6511);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x650F, 0x07);
    CheckMemory(0x6510, 0x03);
    CheckMemory(0xABCD, 0xD1);
}

void test_D1_00F2()
{
    if (skip_test_D1_00F2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7F20);
    WriteRegisterWord(RegisterType::SP, 0xE337);
    WriteRegisterByte(RegisterType::A, 0xFD);
    WriteRegisterByte(RegisterType::B, 0xC7);
    WriteRegisterByte(RegisterType::C, 0x89);
    WriteRegisterByte(RegisterType::D, 0xFE);
    WriteRegisterByte(RegisterType::E, 0x54);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x15);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE338, 0xD1);
    WriteMemory(0xE337, 0xBE);
    WriteMemory(0x7F20, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFD);
    CheckRegisterByte(RegisterType::B, 0xC7);
    CheckRegisterByte(RegisterType::C, 0x89);
    CheckRegisterByte(RegisterType::D, 0xD1);
    CheckRegisterByte(RegisterType::E, 0xBE);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x15);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0x7F21);
    CheckRegisterWord(RegisterType::SP, 0xE339);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7F20, 0xD1);
    CheckMemory(0xE337, 0xBE);
    CheckMemory(0xE338, 0xD1);
}

void test_D1_00F3()
{
    if (skip_test_D1_00F3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF0E3);
    WriteRegisterWord(RegisterType::SP, 0x6909);
    WriteRegisterByte(RegisterType::A, 0x91);
    WriteRegisterByte(RegisterType::B, 0xCD);
    WriteRegisterByte(RegisterType::C, 0xF0);
    WriteRegisterByte(RegisterType::D, 0x3D);
    WriteRegisterByte(RegisterType::E, 0x58);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xE1);
    WriteRegisterByte(RegisterType::L, 0xF0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF0E3, 0xD1);
    WriteMemory(0x690A, 0xDF);
    WriteMemory(0x6909, 0x14);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x91);
    CheckRegisterByte(RegisterType::B, 0xCD);
    CheckRegisterByte(RegisterType::C, 0xF0);
    CheckRegisterByte(RegisterType::D, 0xDF);
    CheckRegisterByte(RegisterType::E, 0x14);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xE1);
    CheckRegisterByte(RegisterType::L, 0xF0);
    CheckRegisterWord(RegisterType::PC, 0xF0E4);
    CheckRegisterWord(RegisterType::SP, 0x690B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6909, 0x14);
    CheckMemory(0x690A, 0xDF);
    CheckMemory(0xF0E3, 0xD1);
}

void test_D1_00F4()
{
    if (skip_test_D1_00F4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8B3B);
    WriteRegisterWord(RegisterType::SP, 0x68F3);
    WriteRegisterByte(RegisterType::A, 0xE9);
    WriteRegisterByte(RegisterType::B, 0xA1);
    WriteRegisterByte(RegisterType::C, 0x05);
    WriteRegisterByte(RegisterType::D, 0xA5);
    WriteRegisterByte(RegisterType::E, 0xC2);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xB2);
    WriteRegisterByte(RegisterType::L, 0x76);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x8B3B, 0xD1);
    WriteMemory(0x68F4, 0x42);
    WriteMemory(0x68F3, 0xDF);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE9);
    CheckRegisterByte(RegisterType::B, 0xA1);
    CheckRegisterByte(RegisterType::C, 0x05);
    CheckRegisterByte(RegisterType::D, 0x42);
    CheckRegisterByte(RegisterType::E, 0xDF);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xB2);
    CheckRegisterByte(RegisterType::L, 0x76);
    CheckRegisterWord(RegisterType::PC, 0x8B3C);
    CheckRegisterWord(RegisterType::SP, 0x68F5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x68F3, 0xDF);
    CheckMemory(0x68F4, 0x42);
    CheckMemory(0x8B3B, 0xD1);
}

void test_D1_00F5()
{
    if (skip_test_D1_00F5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6818);
    WriteRegisterWord(RegisterType::SP, 0x2C86);
    WriteRegisterByte(RegisterType::A, 0x70);
    WriteRegisterByte(RegisterType::B, 0x3A);
    WriteRegisterByte(RegisterType::C, 0xBB);
    WriteRegisterByte(RegisterType::D, 0x7A);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x4C);
    WriteRegisterByte(RegisterType::L, 0x8E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6818, 0xD1);
    WriteMemory(0x2C87, 0x57);
    WriteMemory(0x2C86, 0x41);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x70);
    CheckRegisterByte(RegisterType::B, 0x3A);
    CheckRegisterByte(RegisterType::C, 0xBB);
    CheckRegisterByte(RegisterType::D, 0x57);
    CheckRegisterByte(RegisterType::E, 0x41);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x4C);
    CheckRegisterByte(RegisterType::L, 0x8E);
    CheckRegisterWord(RegisterType::PC, 0x6819);
    CheckRegisterWord(RegisterType::SP, 0x2C88);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2C86, 0x41);
    CheckMemory(0x2C87, 0x57);
    CheckMemory(0x6818, 0xD1);
}

void test_D1_00F6()
{
    if (skip_test_D1_00F6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x97F2);
    WriteRegisterWord(RegisterType::SP, 0x9720);
    WriteRegisterByte(RegisterType::A, 0x0A);
    WriteRegisterByte(RegisterType::B, 0x74);
    WriteRegisterByte(RegisterType::C, 0x8A);
    WriteRegisterByte(RegisterType::D, 0x35);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x18);
    WriteRegisterByte(RegisterType::L, 0xB6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x97F2, 0xD1);
    WriteMemory(0x9721, 0x11);
    WriteMemory(0x9720, 0xBC);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0A);
    CheckRegisterByte(RegisterType::B, 0x74);
    CheckRegisterByte(RegisterType::C, 0x8A);
    CheckRegisterByte(RegisterType::D, 0x11);
    CheckRegisterByte(RegisterType::E, 0xBC);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x18);
    CheckRegisterByte(RegisterType::L, 0xB6);
    CheckRegisterWord(RegisterType::PC, 0x97F3);
    CheckRegisterWord(RegisterType::SP, 0x9722);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9720, 0xBC);
    CheckMemory(0x9721, 0x11);
    CheckMemory(0x97F2, 0xD1);
}

void test_D1_00F7()
{
    if (skip_test_D1_00F7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5867);
    WriteRegisterWord(RegisterType::SP, 0xE8DD);
    WriteRegisterByte(RegisterType::A, 0xCB);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0x6C);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0x3D);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xF2);
    WriteRegisterByte(RegisterType::L, 0x4F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE8DE, 0x5A);
    WriteMemory(0xE8DD, 0x96);
    WriteMemory(0x5867, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCB);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0x6C);
    CheckRegisterByte(RegisterType::D, 0x5A);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xF2);
    CheckRegisterByte(RegisterType::L, 0x4F);
    CheckRegisterWord(RegisterType::PC, 0x5868);
    CheckRegisterWord(RegisterType::SP, 0xE8DF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5867, 0xD1);
    CheckMemory(0xE8DD, 0x96);
    CheckMemory(0xE8DE, 0x5A);
}

void test_D1_00F8()
{
    if (skip_test_D1_00F8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2D06);
    WriteRegisterWord(RegisterType::SP, 0x0A97);
    WriteRegisterByte(RegisterType::A, 0x57);
    WriteRegisterByte(RegisterType::B, 0xB4);
    WriteRegisterByte(RegisterType::C, 0xBF);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0x3C);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x47);
    WriteRegisterByte(RegisterType::L, 0x16);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2D06, 0xD1);
    WriteMemory(0x0A98, 0x17);
    WriteMemory(0x0A97, 0x0E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x57);
    CheckRegisterByte(RegisterType::B, 0xB4);
    CheckRegisterByte(RegisterType::C, 0xBF);
    CheckRegisterByte(RegisterType::D, 0x17);
    CheckRegisterByte(RegisterType::E, 0x0E);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x47);
    CheckRegisterByte(RegisterType::L, 0x16);
    CheckRegisterWord(RegisterType::PC, 0x2D07);
    CheckRegisterWord(RegisterType::SP, 0x0A99);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0A97, 0x0E);
    CheckMemory(0x0A98, 0x17);
    CheckMemory(0x2D06, 0xD1);
}

void test_D1_00F9()
{
    if (skip_test_D1_00F9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5FE5);
    WriteRegisterWord(RegisterType::SP, 0xBA02);
    WriteRegisterByte(RegisterType::A, 0x6F);
    WriteRegisterByte(RegisterType::B, 0x62);
    WriteRegisterByte(RegisterType::C, 0xED);
    WriteRegisterByte(RegisterType::D, 0x0F);
    WriteRegisterByte(RegisterType::E, 0xD1);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0x2D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBA03, 0x6D);
    WriteMemory(0xBA02, 0x33);
    WriteMemory(0x5FE5, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6F);
    CheckRegisterByte(RegisterType::B, 0x62);
    CheckRegisterByte(RegisterType::C, 0xED);
    CheckRegisterByte(RegisterType::D, 0x6D);
    CheckRegisterByte(RegisterType::E, 0x33);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0x2D);
    CheckRegisterWord(RegisterType::PC, 0x5FE6);
    CheckRegisterWord(RegisterType::SP, 0xBA04);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5FE5, 0xD1);
    CheckMemory(0xBA02, 0x33);
    CheckMemory(0xBA03, 0x6D);
}

void test_D1_00FA()
{
    if (skip_test_D1_00FA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x12ED);
    WriteRegisterWord(RegisterType::SP, 0x63CC);
    WriteRegisterByte(RegisterType::A, 0x87);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x57);
    WriteRegisterByte(RegisterType::D, 0x0C);
    WriteRegisterByte(RegisterType::E, 0xB8);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xDE);
    WriteRegisterByte(RegisterType::L, 0x45);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x63CD, 0x3D);
    WriteMemory(0x63CC, 0x1B);
    WriteMemory(0x12ED, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x87);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x57);
    CheckRegisterByte(RegisterType::D, 0x3D);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xDE);
    CheckRegisterByte(RegisterType::L, 0x45);
    CheckRegisterWord(RegisterType::PC, 0x12EE);
    CheckRegisterWord(RegisterType::SP, 0x63CE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x12ED, 0xD1);
    CheckMemory(0x63CC, 0x1B);
    CheckMemory(0x63CD, 0x3D);
}

void test_D1_00FB()
{
    if (skip_test_D1_00FB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD22E);
    WriteRegisterWord(RegisterType::SP, 0x0D53);
    WriteRegisterByte(RegisterType::A, 0x3C);
    WriteRegisterByte(RegisterType::B, 0x9A);
    WriteRegisterByte(RegisterType::C, 0x9D);
    WriteRegisterByte(RegisterType::D, 0xCD);
    WriteRegisterByte(RegisterType::E, 0x09);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x86);
    WriteRegisterByte(RegisterType::L, 0x6D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD22E, 0xD1);
    WriteMemory(0x0D54, 0x03);
    WriteMemory(0x0D53, 0xC3);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3C);
    CheckRegisterByte(RegisterType::B, 0x9A);
    CheckRegisterByte(RegisterType::C, 0x9D);
    CheckRegisterByte(RegisterType::D, 0x03);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x86);
    CheckRegisterByte(RegisterType::L, 0x6D);
    CheckRegisterWord(RegisterType::PC, 0xD22F);
    CheckRegisterWord(RegisterType::SP, 0x0D55);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0D53, 0xC3);
    CheckMemory(0x0D54, 0x03);
    CheckMemory(0xD22E, 0xD1);
}

void test_D1_00FC()
{
    if (skip_test_D1_00FC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEDB8);
    WriteRegisterWord(RegisterType::SP, 0xA133);
    WriteRegisterByte(RegisterType::A, 0x88);
    WriteRegisterByte(RegisterType::B, 0xC2);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0x82);
    WriteRegisterByte(RegisterType::E, 0x1B);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x2C);
    WriteRegisterByte(RegisterType::L, 0xC3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEDB8, 0xD1);
    WriteMemory(0xA134, 0x81);
    WriteMemory(0xA133, 0xA2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x88);
    CheckRegisterByte(RegisterType::B, 0xC2);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0xA2);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x2C);
    CheckRegisterByte(RegisterType::L, 0xC3);
    CheckRegisterWord(RegisterType::PC, 0xEDB9);
    CheckRegisterWord(RegisterType::SP, 0xA135);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA133, 0xA2);
    CheckMemory(0xA134, 0x81);
    CheckMemory(0xEDB8, 0xD1);
}

void test_D1_00FD()
{
    if (skip_test_D1_00FD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xABC7);
    WriteRegisterWord(RegisterType::SP, 0xF099);
    WriteRegisterByte(RegisterType::A, 0x1A);
    WriteRegisterByte(RegisterType::B, 0x1A);
    WriteRegisterByte(RegisterType::C, 0x9E);
    WriteRegisterByte(RegisterType::D, 0x59);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x15);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF09A, 0x89);
    WriteMemory(0xF099, 0x87);
    WriteMemory(0xABC7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1A);
    CheckRegisterByte(RegisterType::B, 0x1A);
    CheckRegisterByte(RegisterType::C, 0x9E);
    CheckRegisterByte(RegisterType::D, 0x89);
    CheckRegisterByte(RegisterType::E, 0x87);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x15);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0xABC8);
    CheckRegisterWord(RegisterType::SP, 0xF09B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xABC7, 0xD1);
    CheckMemory(0xF099, 0x87);
    CheckMemory(0xF09A, 0x89);
}

void test_D1_00FE()
{
    if (skip_test_D1_00FE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x29CF);
    WriteRegisterWord(RegisterType::SP, 0xA245);
    WriteRegisterByte(RegisterType::A, 0xF7);
    WriteRegisterByte(RegisterType::B, 0x43);
    WriteRegisterByte(RegisterType::C, 0xB9);
    WriteRegisterByte(RegisterType::D, 0xB4);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x28);
    WriteRegisterByte(RegisterType::L, 0x42);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA246, 0xE3);
    WriteMemory(0xA245, 0x7C);
    WriteMemory(0x29CF, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF7);
    CheckRegisterByte(RegisterType::B, 0x43);
    CheckRegisterByte(RegisterType::C, 0xB9);
    CheckRegisterByte(RegisterType::D, 0xE3);
    CheckRegisterByte(RegisterType::E, 0x7C);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x28);
    CheckRegisterByte(RegisterType::L, 0x42);
    CheckRegisterWord(RegisterType::PC, 0x29D0);
    CheckRegisterWord(RegisterType::SP, 0xA247);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x29CF, 0xD1);
    CheckMemory(0xA245, 0x7C);
    CheckMemory(0xA246, 0xE3);
}

void test_D1_00FF()
{
    if (skip_test_D1_00FF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1551);
    WriteRegisterWord(RegisterType::SP, 0x5CB5);
    WriteRegisterByte(RegisterType::A, 0x4B);
    WriteRegisterByte(RegisterType::B, 0x21);
    WriteRegisterByte(RegisterType::C, 0x57);
    WriteRegisterByte(RegisterType::D, 0x8F);
    WriteRegisterByte(RegisterType::E, 0x1E);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x17);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5CB6, 0xA2);
    WriteMemory(0x5CB5, 0xCE);
    WriteMemory(0x1551, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4B);
    CheckRegisterByte(RegisterType::B, 0x21);
    CheckRegisterByte(RegisterType::C, 0x57);
    CheckRegisterByte(RegisterType::D, 0xA2);
    CheckRegisterByte(RegisterType::E, 0xCE);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x17);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0x1552);
    CheckRegisterWord(RegisterType::SP, 0x5CB7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1551, 0xD1);
    CheckMemory(0x5CB5, 0xCE);
    CheckMemory(0x5CB6, 0xA2);
}

void test_D1_0100()
{
    if (skip_test_D1_0100)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0EEF);
    WriteRegisterWord(RegisterType::SP, 0x5283);
    WriteRegisterByte(RegisterType::A, 0x7A);
    WriteRegisterByte(RegisterType::B, 0xF2);
    WriteRegisterByte(RegisterType::C, 0x54);
    WriteRegisterByte(RegisterType::D, 0x1F);
    WriteRegisterByte(RegisterType::E, 0x04);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xC5);
    WriteRegisterByte(RegisterType::L, 0x0C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5284, 0x1A);
    WriteMemory(0x5283, 0xAC);
    WriteMemory(0x0EEF, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7A);
    CheckRegisterByte(RegisterType::B, 0xF2);
    CheckRegisterByte(RegisterType::C, 0x54);
    CheckRegisterByte(RegisterType::D, 0x1A);
    CheckRegisterByte(RegisterType::E, 0xAC);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xC5);
    CheckRegisterByte(RegisterType::L, 0x0C);
    CheckRegisterWord(RegisterType::PC, 0x0EF0);
    CheckRegisterWord(RegisterType::SP, 0x5285);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0EEF, 0xD1);
    CheckMemory(0x5283, 0xAC);
    CheckMemory(0x5284, 0x1A);
}

void test_D1_0101()
{
    if (skip_test_D1_0101)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB5E6);
    WriteRegisterWord(RegisterType::SP, 0xADD0);
    WriteRegisterByte(RegisterType::A, 0xBF);
    WriteRegisterByte(RegisterType::B, 0xF7);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0x64);
    WriteRegisterByte(RegisterType::E, 0xDD);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x34);
    WriteRegisterByte(RegisterType::L, 0x6C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB5E6, 0xD1);
    WriteMemory(0xADD1, 0xCA);
    WriteMemory(0xADD0, 0x36);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBF);
    CheckRegisterByte(RegisterType::B, 0xF7);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0xCA);
    CheckRegisterByte(RegisterType::E, 0x36);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x34);
    CheckRegisterByte(RegisterType::L, 0x6C);
    CheckRegisterWord(RegisterType::PC, 0xB5E7);
    CheckRegisterWord(RegisterType::SP, 0xADD2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xADD0, 0x36);
    CheckMemory(0xADD1, 0xCA);
    CheckMemory(0xB5E6, 0xD1);
}

void test_D1_0102()
{
    if (skip_test_D1_0102)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEF95);
    WriteRegisterWord(RegisterType::SP, 0x22E5);
    WriteRegisterByte(RegisterType::A, 0x9E);
    WriteRegisterByte(RegisterType::B, 0x33);
    WriteRegisterByte(RegisterType::C, 0x94);
    WriteRegisterByte(RegisterType::D, 0x88);
    WriteRegisterByte(RegisterType::E, 0x93);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xA9);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEF95, 0xD1);
    WriteMemory(0x22E6, 0x40);
    WriteMemory(0x22E5, 0xFB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9E);
    CheckRegisterByte(RegisterType::B, 0x33);
    CheckRegisterByte(RegisterType::C, 0x94);
    CheckRegisterByte(RegisterType::D, 0x40);
    CheckRegisterByte(RegisterType::E, 0xFB);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xA9);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0xEF96);
    CheckRegisterWord(RegisterType::SP, 0x22E7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x22E5, 0xFB);
    CheckMemory(0x22E6, 0x40);
    CheckMemory(0xEF95, 0xD1);
}

void test_D1_0103()
{
    if (skip_test_D1_0103)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC3F0);
    WriteRegisterWord(RegisterType::SP, 0xB8C5);
    WriteRegisterByte(RegisterType::A, 0x8E);
    WriteRegisterByte(RegisterType::B, 0x54);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0x46);
    WriteRegisterByte(RegisterType::E, 0xF1);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xE0);
    WriteRegisterByte(RegisterType::L, 0x50);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC3F0, 0xD1);
    WriteMemory(0xB8C6, 0x6A);
    WriteMemory(0xB8C5, 0x7D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8E);
    CheckRegisterByte(RegisterType::B, 0x54);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0x7D);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xE0);
    CheckRegisterByte(RegisterType::L, 0x50);
    CheckRegisterWord(RegisterType::PC, 0xC3F1);
    CheckRegisterWord(RegisterType::SP, 0xB8C7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB8C5, 0x7D);
    CheckMemory(0xB8C6, 0x6A);
    CheckMemory(0xC3F0, 0xD1);
}

void test_D1_0104()
{
    if (skip_test_D1_0104)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7AC5);
    WriteRegisterWord(RegisterType::SP, 0x89E6);
    WriteRegisterByte(RegisterType::A, 0xC8);
    WriteRegisterByte(RegisterType::B, 0xFC);
    WriteRegisterByte(RegisterType::C, 0x19);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0x08);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x54);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x89E7, 0x10);
    WriteMemory(0x89E6, 0x08);
    WriteMemory(0x7AC5, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC8);
    CheckRegisterByte(RegisterType::B, 0xFC);
    CheckRegisterByte(RegisterType::C, 0x19);
    CheckRegisterByte(RegisterType::D, 0x10);
    CheckRegisterByte(RegisterType::E, 0x08);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x54);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0x7AC6);
    CheckRegisterWord(RegisterType::SP, 0x89E8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7AC5, 0xD1);
    CheckMemory(0x89E6, 0x08);
    CheckMemory(0x89E7, 0x10);
}

void test_D1_0105()
{
    if (skip_test_D1_0105)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE8F6);
    WriteRegisterWord(RegisterType::SP, 0x9C1F);
    WriteRegisterByte(RegisterType::A, 0x5B);
    WriteRegisterByte(RegisterType::B, 0xF3);
    WriteRegisterByte(RegisterType::C, 0x49);
    WriteRegisterByte(RegisterType::D, 0x78);
    WriteRegisterByte(RegisterType::E, 0xAA);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x0F);
    WriteRegisterByte(RegisterType::L, 0x7C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE8F6, 0xD1);
    WriteMemory(0x9C20, 0x6B);
    WriteMemory(0x9C1F, 0x5B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5B);
    CheckRegisterByte(RegisterType::B, 0xF3);
    CheckRegisterByte(RegisterType::C, 0x49);
    CheckRegisterByte(RegisterType::D, 0x6B);
    CheckRegisterByte(RegisterType::E, 0x5B);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x0F);
    CheckRegisterByte(RegisterType::L, 0x7C);
    CheckRegisterWord(RegisterType::PC, 0xE8F7);
    CheckRegisterWord(RegisterType::SP, 0x9C21);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9C1F, 0x5B);
    CheckMemory(0x9C20, 0x6B);
    CheckMemory(0xE8F6, 0xD1);
}

void test_D1_0106()
{
    if (skip_test_D1_0106)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC18E);
    WriteRegisterWord(RegisterType::SP, 0x3879);
    WriteRegisterByte(RegisterType::A, 0x97);
    WriteRegisterByte(RegisterType::B, 0x71);
    WriteRegisterByte(RegisterType::C, 0xA0);
    WriteRegisterByte(RegisterType::D, 0xFE);
    WriteRegisterByte(RegisterType::E, 0x71);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0xAD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC18E, 0xD1);
    WriteMemory(0x387A, 0x01);
    WriteMemory(0x3879, 0x48);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x97);
    CheckRegisterByte(RegisterType::B, 0x71);
    CheckRegisterByte(RegisterType::C, 0xA0);
    CheckRegisterByte(RegisterType::D, 0x01);
    CheckRegisterByte(RegisterType::E, 0x48);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0xAD);
    CheckRegisterWord(RegisterType::PC, 0xC18F);
    CheckRegisterWord(RegisterType::SP, 0x387B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3879, 0x48);
    CheckMemory(0x387A, 0x01);
    CheckMemory(0xC18E, 0xD1);
}

void test_D1_0107()
{
    if (skip_test_D1_0107)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB50C);
    WriteRegisterWord(RegisterType::SP, 0x235B);
    WriteRegisterByte(RegisterType::A, 0x54);
    WriteRegisterByte(RegisterType::B, 0x5D);
    WriteRegisterByte(RegisterType::C, 0xB3);
    WriteRegisterByte(RegisterType::D, 0x53);
    WriteRegisterByte(RegisterType::E, 0xEB);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xAD);
    WriteRegisterByte(RegisterType::L, 0x61);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB50C, 0xD1);
    WriteMemory(0x235C, 0xFA);
    WriteMemory(0x235B, 0x81);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x54);
    CheckRegisterByte(RegisterType::B, 0x5D);
    CheckRegisterByte(RegisterType::C, 0xB3);
    CheckRegisterByte(RegisterType::D, 0xFA);
    CheckRegisterByte(RegisterType::E, 0x81);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xAD);
    CheckRegisterByte(RegisterType::L, 0x61);
    CheckRegisterWord(RegisterType::PC, 0xB50D);
    CheckRegisterWord(RegisterType::SP, 0x235D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x235B, 0x81);
    CheckMemory(0x235C, 0xFA);
    CheckMemory(0xB50C, 0xD1);
}

void test_D1_0108()
{
    if (skip_test_D1_0108)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7683);
    WriteRegisterWord(RegisterType::SP, 0xA0AD);
    WriteRegisterByte(RegisterType::A, 0x8D);
    WriteRegisterByte(RegisterType::B, 0x1E);
    WriteRegisterByte(RegisterType::C, 0xB0);
    WriteRegisterByte(RegisterType::D, 0x5F);
    WriteRegisterByte(RegisterType::E, 0x81);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x3F);
    WriteRegisterByte(RegisterType::L, 0xE9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA0AE, 0x3C);
    WriteMemory(0xA0AD, 0x19);
    WriteMemory(0x7683, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8D);
    CheckRegisterByte(RegisterType::B, 0x1E);
    CheckRegisterByte(RegisterType::C, 0xB0);
    CheckRegisterByte(RegisterType::D, 0x3C);
    CheckRegisterByte(RegisterType::E, 0x19);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x3F);
    CheckRegisterByte(RegisterType::L, 0xE9);
    CheckRegisterWord(RegisterType::PC, 0x7684);
    CheckRegisterWord(RegisterType::SP, 0xA0AF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7683, 0xD1);
    CheckMemory(0xA0AD, 0x19);
    CheckMemory(0xA0AE, 0x3C);
}

void test_D1_0109()
{
    if (skip_test_D1_0109)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAE39);
    WriteRegisterWord(RegisterType::SP, 0x063C);
    WriteRegisterByte(RegisterType::A, 0x88);
    WriteRegisterByte(RegisterType::B, 0xE2);
    WriteRegisterByte(RegisterType::C, 0x64);
    WriteRegisterByte(RegisterType::D, 0x6D);
    WriteRegisterByte(RegisterType::E, 0x60);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC5);
    WriteRegisterByte(RegisterType::L, 0x69);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAE39, 0xD1);
    WriteMemory(0x063D, 0x77);
    WriteMemory(0x063C, 0xC4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x88);
    CheckRegisterByte(RegisterType::B, 0xE2);
    CheckRegisterByte(RegisterType::C, 0x64);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0xC4);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC5);
    CheckRegisterByte(RegisterType::L, 0x69);
    CheckRegisterWord(RegisterType::PC, 0xAE3A);
    CheckRegisterWord(RegisterType::SP, 0x063E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x063C, 0xC4);
    CheckMemory(0x063D, 0x77);
    CheckMemory(0xAE39, 0xD1);
}

void test_D1_010A()
{
    if (skip_test_D1_010A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC5B6);
    WriteRegisterWord(RegisterType::SP, 0x4679);
    WriteRegisterByte(RegisterType::A, 0xFF);
    WriteRegisterByte(RegisterType::B, 0x75);
    WriteRegisterByte(RegisterType::C, 0x17);
    WriteRegisterByte(RegisterType::D, 0x25);
    WriteRegisterByte(RegisterType::E, 0x29);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xBA);
    WriteRegisterByte(RegisterType::L, 0x12);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC5B6, 0xD1);
    WriteMemory(0x467A, 0x59);
    WriteMemory(0x4679, 0x48);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFF);
    CheckRegisterByte(RegisterType::B, 0x75);
    CheckRegisterByte(RegisterType::C, 0x17);
    CheckRegisterByte(RegisterType::D, 0x59);
    CheckRegisterByte(RegisterType::E, 0x48);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xBA);
    CheckRegisterByte(RegisterType::L, 0x12);
    CheckRegisterWord(RegisterType::PC, 0xC5B7);
    CheckRegisterWord(RegisterType::SP, 0x467B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4679, 0x48);
    CheckMemory(0x467A, 0x59);
    CheckMemory(0xC5B6, 0xD1);
}

void test_D1_010B()
{
    if (skip_test_D1_010B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x403C);
    WriteRegisterWord(RegisterType::SP, 0x6BD5);
    WriteRegisterByte(RegisterType::A, 0xFE);
    WriteRegisterByte(RegisterType::B, 0xEA);
    WriteRegisterByte(RegisterType::C, 0x6C);
    WriteRegisterByte(RegisterType::D, 0xE0);
    WriteRegisterByte(RegisterType::E, 0xE6);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x71);
    WriteRegisterByte(RegisterType::L, 0xA1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6BD6, 0xE7);
    WriteMemory(0x6BD5, 0xF4);
    WriteMemory(0x403C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFE);
    CheckRegisterByte(RegisterType::B, 0xEA);
    CheckRegisterByte(RegisterType::C, 0x6C);
    CheckRegisterByte(RegisterType::D, 0xE7);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x71);
    CheckRegisterByte(RegisterType::L, 0xA1);
    CheckRegisterWord(RegisterType::PC, 0x403D);
    CheckRegisterWord(RegisterType::SP, 0x6BD7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x403C, 0xD1);
    CheckMemory(0x6BD5, 0xF4);
    CheckMemory(0x6BD6, 0xE7);
}

void test_D1_010C()
{
    if (skip_test_D1_010C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB8EB);
    WriteRegisterWord(RegisterType::SP, 0x0E6A);
    WriteRegisterByte(RegisterType::A, 0xBA);
    WriteRegisterByte(RegisterType::B, 0x10);
    WriteRegisterByte(RegisterType::C, 0x70);
    WriteRegisterByte(RegisterType::D, 0x78);
    WriteRegisterByte(RegisterType::E, 0x2A);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x9C);
    WriteRegisterByte(RegisterType::L, 0x3D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB8EB, 0xD1);
    WriteMemory(0x0E6B, 0x1B);
    WriteMemory(0x0E6A, 0xDE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBA);
    CheckRegisterByte(RegisterType::B, 0x10);
    CheckRegisterByte(RegisterType::C, 0x70);
    CheckRegisterByte(RegisterType::D, 0x1B);
    CheckRegisterByte(RegisterType::E, 0xDE);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x9C);
    CheckRegisterByte(RegisterType::L, 0x3D);
    CheckRegisterWord(RegisterType::PC, 0xB8EC);
    CheckRegisterWord(RegisterType::SP, 0x0E6C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0E6A, 0xDE);
    CheckMemory(0x0E6B, 0x1B);
    CheckMemory(0xB8EB, 0xD1);
}

void test_D1_010D()
{
    if (skip_test_D1_010D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7182);
    WriteRegisterWord(RegisterType::SP, 0xBBB9);
    WriteRegisterByte(RegisterType::A, 0x84);
    WriteRegisterByte(RegisterType::B, 0x05);
    WriteRegisterByte(RegisterType::C, 0x3F);
    WriteRegisterByte(RegisterType::D, 0x66);
    WriteRegisterByte(RegisterType::E, 0xFF);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x43);
    WriteRegisterByte(RegisterType::L, 0x09);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBBBA, 0xAF);
    WriteMemory(0xBBB9, 0xBB);
    WriteMemory(0x7182, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x84);
    CheckRegisterByte(RegisterType::B, 0x05);
    CheckRegisterByte(RegisterType::C, 0x3F);
    CheckRegisterByte(RegisterType::D, 0xAF);
    CheckRegisterByte(RegisterType::E, 0xBB);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x43);
    CheckRegisterByte(RegisterType::L, 0x09);
    CheckRegisterWord(RegisterType::PC, 0x7183);
    CheckRegisterWord(RegisterType::SP, 0xBBBB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7182, 0xD1);
    CheckMemory(0xBBB9, 0xBB);
    CheckMemory(0xBBBA, 0xAF);
}

void test_D1_010E()
{
    if (skip_test_D1_010E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCC92);
    WriteRegisterWord(RegisterType::SP, 0x36A7);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0xEE);
    WriteRegisterByte(RegisterType::D, 0x42);
    WriteRegisterByte(RegisterType::E, 0x0C);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x90);
    WriteRegisterByte(RegisterType::L, 0x94);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCC92, 0xD1);
    WriteMemory(0x36A8, 0xC1);
    WriteMemory(0x36A7, 0x72);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0xEE);
    CheckRegisterByte(RegisterType::D, 0xC1);
    CheckRegisterByte(RegisterType::E, 0x72);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x90);
    CheckRegisterByte(RegisterType::L, 0x94);
    CheckRegisterWord(RegisterType::PC, 0xCC93);
    CheckRegisterWord(RegisterType::SP, 0x36A9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x36A7, 0x72);
    CheckMemory(0x36A8, 0xC1);
    CheckMemory(0xCC92, 0xD1);
}

void test_D1_010F()
{
    if (skip_test_D1_010F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB5B9);
    WriteRegisterWord(RegisterType::SP, 0x264C);
    WriteRegisterByte(RegisterType::A, 0xDF);
    WriteRegisterByte(RegisterType::B, 0xB9);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0xD6);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x9B);
    WriteRegisterByte(RegisterType::L, 0x24);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB5B9, 0xD1);
    WriteMemory(0x264D, 0xC0);
    WriteMemory(0x264C, 0x7D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDF);
    CheckRegisterByte(RegisterType::B, 0xB9);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0x7D);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x9B);
    CheckRegisterByte(RegisterType::L, 0x24);
    CheckRegisterWord(RegisterType::PC, 0xB5BA);
    CheckRegisterWord(RegisterType::SP, 0x264E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x264C, 0x7D);
    CheckMemory(0x264D, 0xC0);
    CheckMemory(0xB5B9, 0xD1);
}

void test_D1_0110()
{
    if (skip_test_D1_0110)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x41C3);
    WriteRegisterWord(RegisterType::SP, 0x4532);
    WriteRegisterByte(RegisterType::A, 0xF4);
    WriteRegisterByte(RegisterType::B, 0xB4);
    WriteRegisterByte(RegisterType::C, 0x3C);
    WriteRegisterByte(RegisterType::D, 0xED);
    WriteRegisterByte(RegisterType::E, 0xBD);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x47);
    WriteRegisterByte(RegisterType::L, 0xB9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4533, 0xEF);
    WriteMemory(0x4532, 0xAF);
    WriteMemory(0x41C3, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF4);
    CheckRegisterByte(RegisterType::B, 0xB4);
    CheckRegisterByte(RegisterType::C, 0x3C);
    CheckRegisterByte(RegisterType::D, 0xEF);
    CheckRegisterByte(RegisterType::E, 0xAF);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x47);
    CheckRegisterByte(RegisterType::L, 0xB9);
    CheckRegisterWord(RegisterType::PC, 0x41C4);
    CheckRegisterWord(RegisterType::SP, 0x4534);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x41C3, 0xD1);
    CheckMemory(0x4532, 0xAF);
    CheckMemory(0x4533, 0xEF);
}

void test_D1_0111()
{
    if (skip_test_D1_0111)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x44D1);
    WriteRegisterWord(RegisterType::SP, 0xC138);
    WriteRegisterByte(RegisterType::A, 0x19);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0xBD);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xB9);
    WriteRegisterByte(RegisterType::L, 0x7F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC139, 0xA4);
    WriteMemory(0xC138, 0x71);
    WriteMemory(0x44D1, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x19);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0xA4);
    CheckRegisterByte(RegisterType::E, 0x71);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xB9);
    CheckRegisterByte(RegisterType::L, 0x7F);
    CheckRegisterWord(RegisterType::PC, 0x44D2);
    CheckRegisterWord(RegisterType::SP, 0xC13A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x44D1, 0xD1);
    CheckMemory(0xC138, 0x71);
    CheckMemory(0xC139, 0xA4);
}

void test_D1_0112()
{
    if (skip_test_D1_0112)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x109E);
    WriteRegisterWord(RegisterType::SP, 0x66DA);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0x46);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x2C);
    WriteRegisterByte(RegisterType::L, 0x92);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x66DB, 0xC2);
    WriteMemory(0x66DA, 0x74);
    WriteMemory(0x109E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0xC2);
    CheckRegisterByte(RegisterType::E, 0x74);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x2C);
    CheckRegisterByte(RegisterType::L, 0x92);
    CheckRegisterWord(RegisterType::PC, 0x109F);
    CheckRegisterWord(RegisterType::SP, 0x66DC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x109E, 0xD1);
    CheckMemory(0x66DA, 0x74);
    CheckMemory(0x66DB, 0xC2);
}

void test_D1_0113()
{
    if (skip_test_D1_0113)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x29D4);
    WriteRegisterWord(RegisterType::SP, 0x348B);
    WriteRegisterByte(RegisterType::A, 0x2A);
    WriteRegisterByte(RegisterType::B, 0xED);
    WriteRegisterByte(RegisterType::C, 0x45);
    WriteRegisterByte(RegisterType::D, 0x43);
    WriteRegisterByte(RegisterType::E, 0x29);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x20);
    WriteRegisterByte(RegisterType::L, 0x15);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x348C, 0xAC);
    WriteMemory(0x348B, 0x26);
    WriteMemory(0x29D4, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2A);
    CheckRegisterByte(RegisterType::B, 0xED);
    CheckRegisterByte(RegisterType::C, 0x45);
    CheckRegisterByte(RegisterType::D, 0xAC);
    CheckRegisterByte(RegisterType::E, 0x26);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x20);
    CheckRegisterByte(RegisterType::L, 0x15);
    CheckRegisterWord(RegisterType::PC, 0x29D5);
    CheckRegisterWord(RegisterType::SP, 0x348D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x29D4, 0xD1);
    CheckMemory(0x348B, 0x26);
    CheckMemory(0x348C, 0xAC);
}

void test_D1_0114()
{
    if (skip_test_D1_0114)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDB17);
    WriteRegisterWord(RegisterType::SP, 0xCF2B);
    WriteRegisterByte(RegisterType::A, 0xD6);
    WriteRegisterByte(RegisterType::B, 0xC6);
    WriteRegisterByte(RegisterType::C, 0xF7);
    WriteRegisterByte(RegisterType::D, 0xC2);
    WriteRegisterByte(RegisterType::E, 0xDA);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x83);
    WriteRegisterByte(RegisterType::L, 0xFC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDB17, 0xD1);
    WriteMemory(0xCF2C, 0x49);
    WriteMemory(0xCF2B, 0xB6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD6);
    CheckRegisterByte(RegisterType::B, 0xC6);
    CheckRegisterByte(RegisterType::C, 0xF7);
    CheckRegisterByte(RegisterType::D, 0x49);
    CheckRegisterByte(RegisterType::E, 0xB6);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x83);
    CheckRegisterByte(RegisterType::L, 0xFC);
    CheckRegisterWord(RegisterType::PC, 0xDB18);
    CheckRegisterWord(RegisterType::SP, 0xCF2D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCF2B, 0xB6);
    CheckMemory(0xCF2C, 0x49);
    CheckMemory(0xDB17, 0xD1);
}

void test_D1_0115()
{
    if (skip_test_D1_0115)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5F3A);
    WriteRegisterWord(RegisterType::SP, 0x15D3);
    WriteRegisterByte(RegisterType::A, 0x59);
    WriteRegisterByte(RegisterType::B, 0x44);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0x8E);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0x7B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5F3A, 0xD1);
    WriteMemory(0x15D4, 0x61);
    WriteMemory(0x15D3, 0xFC);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x59);
    CheckRegisterByte(RegisterType::B, 0x44);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0x61);
    CheckRegisterByte(RegisterType::E, 0xFC);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0x7B);
    CheckRegisterWord(RegisterType::PC, 0x5F3B);
    CheckRegisterWord(RegisterType::SP, 0x15D5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x15D3, 0xFC);
    CheckMemory(0x15D4, 0x61);
    CheckMemory(0x5F3A, 0xD1);
}

void test_D1_0116()
{
    if (skip_test_D1_0116)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC489);
    WriteRegisterWord(RegisterType::SP, 0xF46B);
    WriteRegisterByte(RegisterType::A, 0x46);
    WriteRegisterByte(RegisterType::B, 0x45);
    WriteRegisterByte(RegisterType::C, 0xF8);
    WriteRegisterByte(RegisterType::D, 0x67);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x7D);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF46C, 0x5D);
    WriteMemory(0xF46B, 0x8B);
    WriteMemory(0xC489, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x46);
    CheckRegisterByte(RegisterType::B, 0x45);
    CheckRegisterByte(RegisterType::C, 0xF8);
    CheckRegisterByte(RegisterType::D, 0x5D);
    CheckRegisterByte(RegisterType::E, 0x8B);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x7D);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0xC48A);
    CheckRegisterWord(RegisterType::SP, 0xF46D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC489, 0xD1);
    CheckMemory(0xF46B, 0x8B);
    CheckMemory(0xF46C, 0x5D);
}

void test_D1_0117()
{
    if (skip_test_D1_0117)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5B91);
    WriteRegisterWord(RegisterType::SP, 0xD1A2);
    WriteRegisterByte(RegisterType::A, 0x7D);
    WriteRegisterByte(RegisterType::B, 0xCE);
    WriteRegisterByte(RegisterType::C, 0x9C);
    WriteRegisterByte(RegisterType::D, 0x20);
    WriteRegisterByte(RegisterType::E, 0x48);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xEA);
    WriteRegisterByte(RegisterType::L, 0x24);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD1A3, 0x78);
    WriteMemory(0xD1A2, 0x4B);
    WriteMemory(0x5B91, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7D);
    CheckRegisterByte(RegisterType::B, 0xCE);
    CheckRegisterByte(RegisterType::C, 0x9C);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0x4B);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xEA);
    CheckRegisterByte(RegisterType::L, 0x24);
    CheckRegisterWord(RegisterType::PC, 0x5B92);
    CheckRegisterWord(RegisterType::SP, 0xD1A4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5B91, 0xD1);
    CheckMemory(0xD1A2, 0x4B);
    CheckMemory(0xD1A3, 0x78);
}

void test_D1_0118()
{
    if (skip_test_D1_0118)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8745);
    WriteRegisterWord(RegisterType::SP, 0xF7DE);
    WriteRegisterByte(RegisterType::A, 0xCA);
    WriteRegisterByte(RegisterType::B, 0x5E);
    WriteRegisterByte(RegisterType::C, 0xDE);
    WriteRegisterByte(RegisterType::D, 0x00);
    WriteRegisterByte(RegisterType::E, 0xD7);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x8D);
    WriteRegisterByte(RegisterType::L, 0x31);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF7DF, 0xFB);
    WriteMemory(0xF7DE, 0x03);
    WriteMemory(0x8745, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCA);
    CheckRegisterByte(RegisterType::B, 0x5E);
    CheckRegisterByte(RegisterType::C, 0xDE);
    CheckRegisterByte(RegisterType::D, 0xFB);
    CheckRegisterByte(RegisterType::E, 0x03);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x8D);
    CheckRegisterByte(RegisterType::L, 0x31);
    CheckRegisterWord(RegisterType::PC, 0x8746);
    CheckRegisterWord(RegisterType::SP, 0xF7E0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8745, 0xD1);
    CheckMemory(0xF7DE, 0x03);
    CheckMemory(0xF7DF, 0xFB);
}

void test_D1_0119()
{
    if (skip_test_D1_0119)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5380);
    WriteRegisterWord(RegisterType::SP, 0x5B69);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0x6D);
    WriteRegisterByte(RegisterType::C, 0xB5);
    WriteRegisterByte(RegisterType::D, 0x22);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xF9);
    WriteRegisterByte(RegisterType::L, 0x88);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5B6A, 0x6D);
    WriteMemory(0x5B69, 0x67);
    WriteMemory(0x5380, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0x6D);
    CheckRegisterByte(RegisterType::C, 0xB5);
    CheckRegisterByte(RegisterType::D, 0x6D);
    CheckRegisterByte(RegisterType::E, 0x67);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xF9);
    CheckRegisterByte(RegisterType::L, 0x88);
    CheckRegisterWord(RegisterType::PC, 0x5381);
    CheckRegisterWord(RegisterType::SP, 0x5B6B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5380, 0xD1);
    CheckMemory(0x5B69, 0x67);
    CheckMemory(0x5B6A, 0x6D);
}

void test_D1_011A()
{
    if (skip_test_D1_011A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x15C9);
    WriteRegisterWord(RegisterType::SP, 0x4E32);
    WriteRegisterByte(RegisterType::A, 0xE5);
    WriteRegisterByte(RegisterType::B, 0xED);
    WriteRegisterByte(RegisterType::C, 0xBF);
    WriteRegisterByte(RegisterType::D, 0xF9);
    WriteRegisterByte(RegisterType::E, 0xD1);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xCA);
    WriteRegisterByte(RegisterType::L, 0x9D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x4E33, 0x09);
    WriteMemory(0x4E32, 0xE4);
    WriteMemory(0x15C9, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE5);
    CheckRegisterByte(RegisterType::B, 0xED);
    CheckRegisterByte(RegisterType::C, 0xBF);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0xE4);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xCA);
    CheckRegisterByte(RegisterType::L, 0x9D);
    CheckRegisterWord(RegisterType::PC, 0x15CA);
    CheckRegisterWord(RegisterType::SP, 0x4E34);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x15C9, 0xD1);
    CheckMemory(0x4E32, 0xE4);
    CheckMemory(0x4E33, 0x09);
}

void test_D1_011B()
{
    if (skip_test_D1_011B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x92BA);
    WriteRegisterWord(RegisterType::SP, 0x0FF1);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0x50);
    WriteRegisterByte(RegisterType::C, 0xA7);
    WriteRegisterByte(RegisterType::D, 0xED);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x65);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x92BA, 0xD1);
    WriteMemory(0x0FF2, 0x0F);
    WriteMemory(0x0FF1, 0xFA);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0x50);
    CheckRegisterByte(RegisterType::C, 0xA7);
    CheckRegisterByte(RegisterType::D, 0x0F);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x65);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0x92BB);
    CheckRegisterWord(RegisterType::SP, 0x0FF3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0FF1, 0xFA);
    CheckMemory(0x0FF2, 0x0F);
    CheckMemory(0x92BA, 0xD1);
}

void test_D1_011C()
{
    if (skip_test_D1_011C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x285D);
    WriteRegisterWord(RegisterType::SP, 0x37E8);
    WriteRegisterByte(RegisterType::A, 0xE3);
    WriteRegisterByte(RegisterType::B, 0x34);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0x15);
    WriteRegisterByte(RegisterType::E, 0xCE);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x27);
    WriteRegisterByte(RegisterType::L, 0x00);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x37E9, 0x6F);
    WriteMemory(0x37E8, 0xF0);
    WriteMemory(0x285D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE3);
    CheckRegisterByte(RegisterType::B, 0x34);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0x6F);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x27);
    CheckRegisterByte(RegisterType::L, 0x00);
    CheckRegisterWord(RegisterType::PC, 0x285E);
    CheckRegisterWord(RegisterType::SP, 0x37EA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x285D, 0xD1);
    CheckMemory(0x37E8, 0xF0);
    CheckMemory(0x37E9, 0x6F);
}

void test_D1_011D()
{
    if (skip_test_D1_011D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEEAE);
    WriteRegisterWord(RegisterType::SP, 0x473A);
    WriteRegisterByte(RegisterType::A, 0x49);
    WriteRegisterByte(RegisterType::B, 0x2C);
    WriteRegisterByte(RegisterType::C, 0x8B);
    WriteRegisterByte(RegisterType::D, 0xDD);
    WriteRegisterByte(RegisterType::E, 0x5C);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEEAE, 0xD1);
    WriteMemory(0x473B, 0x02);
    WriteMemory(0x473A, 0xFA);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x49);
    CheckRegisterByte(RegisterType::B, 0x2C);
    CheckRegisterByte(RegisterType::C, 0x8B);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0xEEAF);
    CheckRegisterWord(RegisterType::SP, 0x473C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x473A, 0xFA);
    CheckMemory(0x473B, 0x02);
    CheckMemory(0xEEAE, 0xD1);
}

void test_D1_011E()
{
    if (skip_test_D1_011E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2CF4);
    WriteRegisterWord(RegisterType::SP, 0xE322);
    WriteRegisterByte(RegisterType::A, 0x27);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0xCD);
    WriteRegisterByte(RegisterType::D, 0x9E);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x63);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE323, 0x3D);
    WriteMemory(0xE322, 0x4A);
    WriteMemory(0x2CF4, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x27);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0xCD);
    CheckRegisterByte(RegisterType::D, 0x3D);
    CheckRegisterByte(RegisterType::E, 0x4A);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x63);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0x2CF5);
    CheckRegisterWord(RegisterType::SP, 0xE324);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2CF4, 0xD1);
    CheckMemory(0xE322, 0x4A);
    CheckMemory(0xE323, 0x3D);
}

void test_D1_011F()
{
    if (skip_test_D1_011F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA894);
    WriteRegisterWord(RegisterType::SP, 0x740E);
    WriteRegisterByte(RegisterType::A, 0xC8);
    WriteRegisterByte(RegisterType::B, 0xB1);
    WriteRegisterByte(RegisterType::C, 0x1A);
    WriteRegisterByte(RegisterType::D, 0xFE);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xAD);
    WriteRegisterByte(RegisterType::L, 0xED);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA894, 0xD1);
    WriteMemory(0x740F, 0x92);
    WriteMemory(0x740E, 0x63);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC8);
    CheckRegisterByte(RegisterType::B, 0xB1);
    CheckRegisterByte(RegisterType::C, 0x1A);
    CheckRegisterByte(RegisterType::D, 0x92);
    CheckRegisterByte(RegisterType::E, 0x63);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xAD);
    CheckRegisterByte(RegisterType::L, 0xED);
    CheckRegisterWord(RegisterType::PC, 0xA895);
    CheckRegisterWord(RegisterType::SP, 0x7410);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x740E, 0x63);
    CheckMemory(0x740F, 0x92);
    CheckMemory(0xA894, 0xD1);
}

void test_D1_0120()
{
    if (skip_test_D1_0120)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9743);
    WriteRegisterWord(RegisterType::SP, 0x1C15);
    WriteRegisterByte(RegisterType::A, 0xA8);
    WriteRegisterByte(RegisterType::B, 0x27);
    WriteRegisterByte(RegisterType::C, 0x76);
    WriteRegisterByte(RegisterType::D, 0x73);
    WriteRegisterByte(RegisterType::E, 0x16);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0xCB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9743, 0xD1);
    WriteMemory(0x1C16, 0x74);
    WriteMemory(0x1C15, 0xE3);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA8);
    CheckRegisterByte(RegisterType::B, 0x27);
    CheckRegisterByte(RegisterType::C, 0x76);
    CheckRegisterByte(RegisterType::D, 0x74);
    CheckRegisterByte(RegisterType::E, 0xE3);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0xCB);
    CheckRegisterWord(RegisterType::PC, 0x9744);
    CheckRegisterWord(RegisterType::SP, 0x1C17);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1C15, 0xE3);
    CheckMemory(0x1C16, 0x74);
    CheckMemory(0x9743, 0xD1);
}

void test_D1_0121()
{
    if (skip_test_D1_0121)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0389);
    WriteRegisterWord(RegisterType::SP, 0xA433);
    WriteRegisterByte(RegisterType::A, 0x49);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0x8A);
    WriteRegisterByte(RegisterType::D, 0x24);
    WriteRegisterByte(RegisterType::E, 0x01);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x97);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA434, 0x9C);
    WriteMemory(0xA433, 0xE8);
    WriteMemory(0x0389, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x49);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0x8A);
    CheckRegisterByte(RegisterType::D, 0x9C);
    CheckRegisterByte(RegisterType::E, 0xE8);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x97);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0x038A);
    CheckRegisterWord(RegisterType::SP, 0xA435);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0389, 0xD1);
    CheckMemory(0xA433, 0xE8);
    CheckMemory(0xA434, 0x9C);
}

void test_D1_0122()
{
    if (skip_test_D1_0122)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x691F);
    WriteRegisterWord(RegisterType::SP, 0x13E7);
    WriteRegisterByte(RegisterType::A, 0xF0);
    WriteRegisterByte(RegisterType::B, 0x1F);
    WriteRegisterByte(RegisterType::C, 0xA5);
    WriteRegisterByte(RegisterType::D, 0xF6);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xBB);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x691F, 0xD1);
    WriteMemory(0x13E8, 0x40);
    WriteMemory(0x13E7, 0xCE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF0);
    CheckRegisterByte(RegisterType::B, 0x1F);
    CheckRegisterByte(RegisterType::C, 0xA5);
    CheckRegisterByte(RegisterType::D, 0x40);
    CheckRegisterByte(RegisterType::E, 0xCE);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xBB);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0x6920);
    CheckRegisterWord(RegisterType::SP, 0x13E9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x13E7, 0xCE);
    CheckMemory(0x13E8, 0x40);
    CheckMemory(0x691F, 0xD1);
}

void test_D1_0123()
{
    if (skip_test_D1_0123)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1A5B);
    WriteRegisterWord(RegisterType::SP, 0x2A8D);
    WriteRegisterByte(RegisterType::A, 0x3A);
    WriteRegisterByte(RegisterType::B, 0x79);
    WriteRegisterByte(RegisterType::C, 0x94);
    WriteRegisterByte(RegisterType::D, 0xAF);
    WriteRegisterByte(RegisterType::E, 0xB1);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x2A);
    WriteRegisterByte(RegisterType::L, 0xEF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x2A8E, 0x18);
    WriteMemory(0x2A8D, 0xCE);
    WriteMemory(0x1A5B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3A);
    CheckRegisterByte(RegisterType::B, 0x79);
    CheckRegisterByte(RegisterType::C, 0x94);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0xCE);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x2A);
    CheckRegisterByte(RegisterType::L, 0xEF);
    CheckRegisterWord(RegisterType::PC, 0x1A5C);
    CheckRegisterWord(RegisterType::SP, 0x2A8F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1A5B, 0xD1);
    CheckMemory(0x2A8D, 0xCE);
    CheckMemory(0x2A8E, 0x18);
}

void test_D1_0124()
{
    if (skip_test_D1_0124)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFC28);
    WriteRegisterWord(RegisterType::SP, 0xFA96);
    WriteRegisterByte(RegisterType::A, 0xB0);
    WriteRegisterByte(RegisterType::B, 0x9D);
    WriteRegisterByte(RegisterType::C, 0x81);
    WriteRegisterByte(RegisterType::D, 0xCC);
    WriteRegisterByte(RegisterType::E, 0xD8);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x06);
    WriteRegisterByte(RegisterType::L, 0x26);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFC28, 0xD1);
    WriteMemory(0xFA97, 0x3A);
    WriteMemory(0xFA96, 0xA2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB0);
    CheckRegisterByte(RegisterType::B, 0x9D);
    CheckRegisterByte(RegisterType::C, 0x81);
    CheckRegisterByte(RegisterType::D, 0x3A);
    CheckRegisterByte(RegisterType::E, 0xA2);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x06);
    CheckRegisterByte(RegisterType::L, 0x26);
    CheckRegisterWord(RegisterType::PC, 0xFC29);
    CheckRegisterWord(RegisterType::SP, 0xFA98);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFA96, 0xA2);
    CheckMemory(0xFA97, 0x3A);
    CheckMemory(0xFC28, 0xD1);
}

void test_D1_0125()
{
    if (skip_test_D1_0125)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7F6F);
    WriteRegisterWord(RegisterType::SP, 0x5D08);
    WriteRegisterByte(RegisterType::A, 0x66);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0x45);
    WriteRegisterByte(RegisterType::E, 0x26);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7F6F, 0xD1);
    WriteMemory(0x5D09, 0x60);
    WriteMemory(0x5D08, 0x52);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x66);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0x60);
    CheckRegisterByte(RegisterType::E, 0x52);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0x7F70);
    CheckRegisterWord(RegisterType::SP, 0x5D0A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5D08, 0x52);
    CheckMemory(0x5D09, 0x60);
    CheckMemory(0x7F6F, 0xD1);
}

void test_D1_0126()
{
    if (skip_test_D1_0126)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFE09);
    WriteRegisterWord(RegisterType::SP, 0x6F24);
    WriteRegisterByte(RegisterType::A, 0x41);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0x09);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x4A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFE09, 0xD1);
    WriteMemory(0x6F25, 0x0D);
    WriteMemory(0x6F24, 0x89);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x41);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0x0D);
    CheckRegisterByte(RegisterType::E, 0x89);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x4A);
    CheckRegisterWord(RegisterType::PC, 0xFE0A);
    CheckRegisterWord(RegisterType::SP, 0x6F26);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6F24, 0x89);
    CheckMemory(0x6F25, 0x0D);
    CheckMemory(0xFE09, 0xD1);
}

void test_D1_0127()
{
    if (skip_test_D1_0127)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7011);
    WriteRegisterWord(RegisterType::SP, 0xF139);
    WriteRegisterByte(RegisterType::A, 0x1E);
    WriteRegisterByte(RegisterType::B, 0x5A);
    WriteRegisterByte(RegisterType::C, 0x83);
    WriteRegisterByte(RegisterType::D, 0x61);
    WriteRegisterByte(RegisterType::E, 0x2D);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xAE);
    WriteRegisterByte(RegisterType::L, 0x0A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF13A, 0xC3);
    WriteMemory(0xF139, 0xF9);
    WriteMemory(0x7011, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1E);
    CheckRegisterByte(RegisterType::B, 0x5A);
    CheckRegisterByte(RegisterType::C, 0x83);
    CheckRegisterByte(RegisterType::D, 0xC3);
    CheckRegisterByte(RegisterType::E, 0xF9);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xAE);
    CheckRegisterByte(RegisterType::L, 0x0A);
    CheckRegisterWord(RegisterType::PC, 0x7012);
    CheckRegisterWord(RegisterType::SP, 0xF13B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7011, 0xD1);
    CheckMemory(0xF139, 0xF9);
    CheckMemory(0xF13A, 0xC3);
}

void test_D1_0128()
{
    if (skip_test_D1_0128)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBE30);
    WriteRegisterWord(RegisterType::SP, 0x6F34);
    WriteRegisterByte(RegisterType::A, 0x16);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0x42);
    WriteRegisterByte(RegisterType::D, 0xCC);
    WriteRegisterByte(RegisterType::E, 0x16);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xFC);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBE30, 0xD1);
    WriteMemory(0x6F35, 0x98);
    WriteMemory(0x6F34, 0x15);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x16);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0x42);
    CheckRegisterByte(RegisterType::D, 0x98);
    CheckRegisterByte(RegisterType::E, 0x15);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xFC);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0xBE31);
    CheckRegisterWord(RegisterType::SP, 0x6F36);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6F34, 0x15);
    CheckMemory(0x6F35, 0x98);
    CheckMemory(0xBE30, 0xD1);
}

void test_D1_0129()
{
    if (skip_test_D1_0129)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x835D);
    WriteRegisterWord(RegisterType::SP, 0xBFCA);
    WriteRegisterByte(RegisterType::A, 0x1C);
    WriteRegisterByte(RegisterType::B, 0x83);
    WriteRegisterByte(RegisterType::C, 0x17);
    WriteRegisterByte(RegisterType::D, 0x5D);
    WriteRegisterByte(RegisterType::E, 0xC4);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xC4);
    WriteRegisterByte(RegisterType::L, 0x5A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBFCB, 0x14);
    WriteMemory(0xBFCA, 0x8F);
    WriteMemory(0x835D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1C);
    CheckRegisterByte(RegisterType::B, 0x83);
    CheckRegisterByte(RegisterType::C, 0x17);
    CheckRegisterByte(RegisterType::D, 0x14);
    CheckRegisterByte(RegisterType::E, 0x8F);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xC4);
    CheckRegisterByte(RegisterType::L, 0x5A);
    CheckRegisterWord(RegisterType::PC, 0x835E);
    CheckRegisterWord(RegisterType::SP, 0xBFCC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x835D, 0xD1);
    CheckMemory(0xBFCA, 0x8F);
    CheckMemory(0xBFCB, 0x14);
}

void test_D1_012A()
{
    if (skip_test_D1_012A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFB1A);
    WriteRegisterWord(RegisterType::SP, 0x7062);
    WriteRegisterByte(RegisterType::A, 0xA4);
    WriteRegisterByte(RegisterType::B, 0x27);
    WriteRegisterByte(RegisterType::C, 0x1B);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0x5F);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0xB2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFB1A, 0xD1);
    WriteMemory(0x7063, 0x7C);
    WriteMemory(0x7062, 0xA3);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA4);
    CheckRegisterByte(RegisterType::B, 0x27);
    CheckRegisterByte(RegisterType::C, 0x1B);
    CheckRegisterByte(RegisterType::D, 0x7C);
    CheckRegisterByte(RegisterType::E, 0xA3);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0xB2);
    CheckRegisterWord(RegisterType::PC, 0xFB1B);
    CheckRegisterWord(RegisterType::SP, 0x7064);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7062, 0xA3);
    CheckMemory(0x7063, 0x7C);
    CheckMemory(0xFB1A, 0xD1);
}

void test_D1_012B()
{
    if (skip_test_D1_012B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2418);
    WriteRegisterWord(RegisterType::SP, 0x6444);
    WriteRegisterByte(RegisterType::A, 0x18);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0xE4);
    WriteRegisterByte(RegisterType::D, 0xCB);
    WriteRegisterByte(RegisterType::E, 0xD7);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x25);
    WriteRegisterByte(RegisterType::L, 0x89);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6445, 0x19);
    WriteMemory(0x6444, 0xCA);
    WriteMemory(0x2418, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x18);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0xE4);
    CheckRegisterByte(RegisterType::D, 0x19);
    CheckRegisterByte(RegisterType::E, 0xCA);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x25);
    CheckRegisterByte(RegisterType::L, 0x89);
    CheckRegisterWord(RegisterType::PC, 0x2419);
    CheckRegisterWord(RegisterType::SP, 0x6446);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2418, 0xD1);
    CheckMemory(0x6444, 0xCA);
    CheckMemory(0x6445, 0x19);
}

void test_D1_012C()
{
    if (skip_test_D1_012C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF2E4);
    WriteRegisterWord(RegisterType::SP, 0xAEF3);
    WriteRegisterByte(RegisterType::A, 0x83);
    WriteRegisterByte(RegisterType::B, 0xD5);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0x49);
    WriteRegisterByte(RegisterType::E, 0x1D);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x60);
    WriteRegisterByte(RegisterType::L, 0xA5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF2E4, 0xD1);
    WriteMemory(0xAEF4, 0xDE);
    WriteMemory(0xAEF3, 0x3D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x83);
    CheckRegisterByte(RegisterType::B, 0xD5);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0xDE);
    CheckRegisterByte(RegisterType::E, 0x3D);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x60);
    CheckRegisterByte(RegisterType::L, 0xA5);
    CheckRegisterWord(RegisterType::PC, 0xF2E5);
    CheckRegisterWord(RegisterType::SP, 0xAEF5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAEF3, 0x3D);
    CheckMemory(0xAEF4, 0xDE);
    CheckMemory(0xF2E4, 0xD1);
}

void test_D1_012D()
{
    if (skip_test_D1_012D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6FE6);
    WriteRegisterWord(RegisterType::SP, 0xB583);
    WriteRegisterByte(RegisterType::A, 0x19);
    WriteRegisterByte(RegisterType::B, 0xE6);
    WriteRegisterByte(RegisterType::C, 0x2C);
    WriteRegisterByte(RegisterType::D, 0x50);
    WriteRegisterByte(RegisterType::E, 0x47);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x9F);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB584, 0x36);
    WriteMemory(0xB583, 0x50);
    WriteMemory(0x6FE6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x19);
    CheckRegisterByte(RegisterType::B, 0xE6);
    CheckRegisterByte(RegisterType::C, 0x2C);
    CheckRegisterByte(RegisterType::D, 0x36);
    CheckRegisterByte(RegisterType::E, 0x50);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x9F);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0x6FE7);
    CheckRegisterWord(RegisterType::SP, 0xB585);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6FE6, 0xD1);
    CheckMemory(0xB583, 0x50);
    CheckMemory(0xB584, 0x36);
}

void test_D1_012E()
{
    if (skip_test_D1_012E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA8E0);
    WriteRegisterWord(RegisterType::SP, 0x0B43);
    WriteRegisterByte(RegisterType::A, 0xF4);
    WriteRegisterByte(RegisterType::B, 0x99);
    WriteRegisterByte(RegisterType::C, 0x5C);
    WriteRegisterByte(RegisterType::D, 0x3D);
    WriteRegisterByte(RegisterType::E, 0x19);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xD8);
    WriteRegisterByte(RegisterType::L, 0x0C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA8E0, 0xD1);
    WriteMemory(0x0B44, 0xE7);
    WriteMemory(0x0B43, 0x06);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF4);
    CheckRegisterByte(RegisterType::B, 0x99);
    CheckRegisterByte(RegisterType::C, 0x5C);
    CheckRegisterByte(RegisterType::D, 0xE7);
    CheckRegisterByte(RegisterType::E, 0x06);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xD8);
    CheckRegisterByte(RegisterType::L, 0x0C);
    CheckRegisterWord(RegisterType::PC, 0xA8E1);
    CheckRegisterWord(RegisterType::SP, 0x0B45);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0B43, 0x06);
    CheckMemory(0x0B44, 0xE7);
    CheckMemory(0xA8E0, 0xD1);
}

void test_D1_012F()
{
    if (skip_test_D1_012F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8A29);
    WriteRegisterWord(RegisterType::SP, 0x5B30);
    WriteRegisterByte(RegisterType::A, 0x18);
    WriteRegisterByte(RegisterType::B, 0x3D);
    WriteRegisterByte(RegisterType::C, 0xB3);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0x68);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x9C);
    WriteRegisterByte(RegisterType::L, 0xDC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8A29, 0xD1);
    WriteMemory(0x5B31, 0xB8);
    WriteMemory(0x5B30, 0x47);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x18);
    CheckRegisterByte(RegisterType::B, 0x3D);
    CheckRegisterByte(RegisterType::C, 0xB3);
    CheckRegisterByte(RegisterType::D, 0xB8);
    CheckRegisterByte(RegisterType::E, 0x47);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x9C);
    CheckRegisterByte(RegisterType::L, 0xDC);
    CheckRegisterWord(RegisterType::PC, 0x8A2A);
    CheckRegisterWord(RegisterType::SP, 0x5B32);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5B30, 0x47);
    CheckMemory(0x5B31, 0xB8);
    CheckMemory(0x8A29, 0xD1);
}

void test_D1_0130()
{
    if (skip_test_D1_0130)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEFB4);
    WriteRegisterWord(RegisterType::SP, 0xBDCD);
    WriteRegisterByte(RegisterType::A, 0x0E);
    WriteRegisterByte(RegisterType::B, 0xA5);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x6C);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x26);
    WriteRegisterByte(RegisterType::L, 0x09);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEFB4, 0xD1);
    WriteMemory(0xBDCE, 0xAB);
    WriteMemory(0xBDCD, 0x96);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0E);
    CheckRegisterByte(RegisterType::B, 0xA5);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0xAB);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x26);
    CheckRegisterByte(RegisterType::L, 0x09);
    CheckRegisterWord(RegisterType::PC, 0xEFB5);
    CheckRegisterWord(RegisterType::SP, 0xBDCF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBDCD, 0x96);
    CheckMemory(0xBDCE, 0xAB);
    CheckMemory(0xEFB4, 0xD1);
}

void test_D1_0131()
{
    if (skip_test_D1_0131)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB9DE);
    WriteRegisterWord(RegisterType::SP, 0x7E99);
    WriteRegisterByte(RegisterType::A, 0x99);
    WriteRegisterByte(RegisterType::B, 0x69);
    WriteRegisterByte(RegisterType::C, 0x1C);
    WriteRegisterByte(RegisterType::D, 0x9B);
    WriteRegisterByte(RegisterType::E, 0x87);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xA9);
    WriteRegisterByte(RegisterType::L, 0xAF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB9DE, 0xD1);
    WriteMemory(0x7E9A, 0xC3);
    WriteMemory(0x7E99, 0x46);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x99);
    CheckRegisterByte(RegisterType::B, 0x69);
    CheckRegisterByte(RegisterType::C, 0x1C);
    CheckRegisterByte(RegisterType::D, 0xC3);
    CheckRegisterByte(RegisterType::E, 0x46);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xA9);
    CheckRegisterByte(RegisterType::L, 0xAF);
    CheckRegisterWord(RegisterType::PC, 0xB9DF);
    CheckRegisterWord(RegisterType::SP, 0x7E9B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7E99, 0x46);
    CheckMemory(0x7E9A, 0xC3);
    CheckMemory(0xB9DE, 0xD1);
}

void test_D1_0132()
{
    if (skip_test_D1_0132)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2C46);
    WriteRegisterWord(RegisterType::SP, 0xA86E);
    WriteRegisterByte(RegisterType::A, 0x74);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0x02);
    WriteRegisterByte(RegisterType::D, 0x2F);
    WriteRegisterByte(RegisterType::E, 0x20);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xAC);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA86F, 0xDA);
    WriteMemory(0xA86E, 0xDD);
    WriteMemory(0x2C46, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x74);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0x02);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0xDD);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xAC);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0x2C47);
    CheckRegisterWord(RegisterType::SP, 0xA870);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2C46, 0xD1);
    CheckMemory(0xA86E, 0xDD);
    CheckMemory(0xA86F, 0xDA);
}

void test_D1_0133()
{
    if (skip_test_D1_0133)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF266);
    WriteRegisterWord(RegisterType::SP, 0x29C0);
    WriteRegisterByte(RegisterType::A, 0x46);
    WriteRegisterByte(RegisterType::B, 0x68);
    WriteRegisterByte(RegisterType::C, 0x49);
    WriteRegisterByte(RegisterType::D, 0x3A);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x24);
    WriteRegisterByte(RegisterType::L, 0x8A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF266, 0xD1);
    WriteMemory(0x29C1, 0x49);
    WriteMemory(0x29C0, 0x4F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x46);
    CheckRegisterByte(RegisterType::B, 0x68);
    CheckRegisterByte(RegisterType::C, 0x49);
    CheckRegisterByte(RegisterType::D, 0x49);
    CheckRegisterByte(RegisterType::E, 0x4F);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x24);
    CheckRegisterByte(RegisterType::L, 0x8A);
    CheckRegisterWord(RegisterType::PC, 0xF267);
    CheckRegisterWord(RegisterType::SP, 0x29C2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x29C0, 0x4F);
    CheckMemory(0x29C1, 0x49);
    CheckMemory(0xF266, 0xD1);
}

void test_D1_0134()
{
    if (skip_test_D1_0134)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3114);
    WriteRegisterWord(RegisterType::SP, 0xC848);
    WriteRegisterByte(RegisterType::A, 0x73);
    WriteRegisterByte(RegisterType::B, 0x18);
    WriteRegisterByte(RegisterType::C, 0x2F);
    WriteRegisterByte(RegisterType::D, 0x2D);
    WriteRegisterByte(RegisterType::E, 0x7E);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x52);
    WriteRegisterByte(RegisterType::L, 0x57);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC849, 0xFB);
    WriteMemory(0xC848, 0x20);
    WriteMemory(0x3114, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x73);
    CheckRegisterByte(RegisterType::B, 0x18);
    CheckRegisterByte(RegisterType::C, 0x2F);
    CheckRegisterByte(RegisterType::D, 0xFB);
    CheckRegisterByte(RegisterType::E, 0x20);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x52);
    CheckRegisterByte(RegisterType::L, 0x57);
    CheckRegisterWord(RegisterType::PC, 0x3115);
    CheckRegisterWord(RegisterType::SP, 0xC84A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3114, 0xD1);
    CheckMemory(0xC848, 0x20);
    CheckMemory(0xC849, 0xFB);
}

void test_D1_0135()
{
    if (skip_test_D1_0135)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAEB8);
    WriteRegisterWord(RegisterType::SP, 0xF88B);
    WriteRegisterByte(RegisterType::A, 0x63);
    WriteRegisterByte(RegisterType::B, 0x56);
    WriteRegisterByte(RegisterType::C, 0xB3);
    WriteRegisterByte(RegisterType::D, 0xF9);
    WriteRegisterByte(RegisterType::E, 0xB1);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xF4);
    WriteRegisterByte(RegisterType::L, 0x11);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF88C, 0x84);
    WriteMemory(0xF88B, 0xA5);
    WriteMemory(0xAEB8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x63);
    CheckRegisterByte(RegisterType::B, 0x56);
    CheckRegisterByte(RegisterType::C, 0xB3);
    CheckRegisterByte(RegisterType::D, 0x84);
    CheckRegisterByte(RegisterType::E, 0xA5);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xF4);
    CheckRegisterByte(RegisterType::L, 0x11);
    CheckRegisterWord(RegisterType::PC, 0xAEB9);
    CheckRegisterWord(RegisterType::SP, 0xF88D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAEB8, 0xD1);
    CheckMemory(0xF88B, 0xA5);
    CheckMemory(0xF88C, 0x84);
}

void test_D1_0136()
{
    if (skip_test_D1_0136)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x72D6);
    WriteRegisterWord(RegisterType::SP, 0x343A);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0xAC);
    WriteRegisterByte(RegisterType::D, 0xD9);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x8F);
    WriteRegisterByte(RegisterType::L, 0x38);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x72D6, 0xD1);
    WriteMemory(0x343B, 0x67);
    WriteMemory(0x343A, 0x9A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0xAC);
    CheckRegisterByte(RegisterType::D, 0x67);
    CheckRegisterByte(RegisterType::E, 0x9A);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x8F);
    CheckRegisterByte(RegisterType::L, 0x38);
    CheckRegisterWord(RegisterType::PC, 0x72D7);
    CheckRegisterWord(RegisterType::SP, 0x343C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x343A, 0x9A);
    CheckMemory(0x343B, 0x67);
    CheckMemory(0x72D6, 0xD1);
}

void test_D1_0137()
{
    if (skip_test_D1_0137)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA443);
    WriteRegisterWord(RegisterType::SP, 0xAADD);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0xFA);
    WriteRegisterByte(RegisterType::C, 0x35);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0x45);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xFB);
    WriteRegisterByte(RegisterType::L, 0x4B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAADE, 0xCA);
    WriteMemory(0xAADD, 0x7F);
    WriteMemory(0xA443, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0xFA);
    CheckRegisterByte(RegisterType::C, 0x35);
    CheckRegisterByte(RegisterType::D, 0xCA);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xFB);
    CheckRegisterByte(RegisterType::L, 0x4B);
    CheckRegisterWord(RegisterType::PC, 0xA444);
    CheckRegisterWord(RegisterType::SP, 0xAADF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA443, 0xD1);
    CheckMemory(0xAADD, 0x7F);
    CheckMemory(0xAADE, 0xCA);
}

void test_D1_0138()
{
    if (skip_test_D1_0138)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9785);
    WriteRegisterWord(RegisterType::SP, 0x6E5D);
    WriteRegisterByte(RegisterType::A, 0xD6);
    WriteRegisterByte(RegisterType::B, 0x5B);
    WriteRegisterByte(RegisterType::C, 0xA6);
    WriteRegisterByte(RegisterType::D, 0xEB);
    WriteRegisterByte(RegisterType::E, 0x4D);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xB8);
    WriteRegisterByte(RegisterType::L, 0xD7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9785, 0xD1);
    WriteMemory(0x6E5E, 0xB2);
    WriteMemory(0x6E5D, 0x7E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD6);
    CheckRegisterByte(RegisterType::B, 0x5B);
    CheckRegisterByte(RegisterType::C, 0xA6);
    CheckRegisterByte(RegisterType::D, 0xB2);
    CheckRegisterByte(RegisterType::E, 0x7E);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xB8);
    CheckRegisterByte(RegisterType::L, 0xD7);
    CheckRegisterWord(RegisterType::PC, 0x9786);
    CheckRegisterWord(RegisterType::SP, 0x6E5F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6E5D, 0x7E);
    CheckMemory(0x6E5E, 0xB2);
    CheckMemory(0x9785, 0xD1);
}

void test_D1_0139()
{
    if (skip_test_D1_0139)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF4F9);
    WriteRegisterWord(RegisterType::SP, 0x1A8A);
    WriteRegisterByte(RegisterType::A, 0xD8);
    WriteRegisterByte(RegisterType::B, 0x20);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0xA2);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xD8);
    WriteRegisterByte(RegisterType::L, 0x2D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF4F9, 0xD1);
    WriteMemory(0x1A8B, 0x8C);
    WriteMemory(0x1A8A, 0xEE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD8);
    CheckRegisterByte(RegisterType::B, 0x20);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0xEE);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xD8);
    CheckRegisterByte(RegisterType::L, 0x2D);
    CheckRegisterWord(RegisterType::PC, 0xF4FA);
    CheckRegisterWord(RegisterType::SP, 0x1A8C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1A8A, 0xEE);
    CheckMemory(0x1A8B, 0x8C);
    CheckMemory(0xF4F9, 0xD1);
}

void test_D1_013A()
{
    if (skip_test_D1_013A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x03DE);
    WriteRegisterWord(RegisterType::SP, 0x41E3);
    WriteRegisterByte(RegisterType::A, 0x2B);
    WriteRegisterByte(RegisterType::B, 0x41);
    WriteRegisterByte(RegisterType::C, 0xEE);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0x8D);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x2A);
    WriteRegisterByte(RegisterType::L, 0xE3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x41E4, 0x82);
    WriteMemory(0x41E3, 0x73);
    WriteMemory(0x03DE, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2B);
    CheckRegisterByte(RegisterType::B, 0x41);
    CheckRegisterByte(RegisterType::C, 0xEE);
    CheckRegisterByte(RegisterType::D, 0x82);
    CheckRegisterByte(RegisterType::E, 0x73);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x2A);
    CheckRegisterByte(RegisterType::L, 0xE3);
    CheckRegisterWord(RegisterType::PC, 0x03DF);
    CheckRegisterWord(RegisterType::SP, 0x41E5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x03DE, 0xD1);
    CheckMemory(0x41E3, 0x73);
    CheckMemory(0x41E4, 0x82);
}

void test_D1_013B()
{
    if (skip_test_D1_013B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x71C8);
    WriteRegisterWord(RegisterType::SP, 0xA100);
    WriteRegisterByte(RegisterType::A, 0x0A);
    WriteRegisterByte(RegisterType::B, 0xBB);
    WriteRegisterByte(RegisterType::C, 0x62);
    WriteRegisterByte(RegisterType::D, 0x8E);
    WriteRegisterByte(RegisterType::E, 0xE4);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0xF9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA101, 0x8C);
    WriteMemory(0xA100, 0x94);
    WriteMemory(0x71C8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0A);
    CheckRegisterByte(RegisterType::B, 0xBB);
    CheckRegisterByte(RegisterType::C, 0x62);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0x94);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0xF9);
    CheckRegisterWord(RegisterType::PC, 0x71C9);
    CheckRegisterWord(RegisterType::SP, 0xA102);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x71C8, 0xD1);
    CheckMemory(0xA100, 0x94);
    CheckMemory(0xA101, 0x8C);
}

void test_D1_013C()
{
    if (skip_test_D1_013C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBCF2);
    WriteRegisterWord(RegisterType::SP, 0x2820);
    WriteRegisterByte(RegisterType::A, 0xFA);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x61);
    WriteRegisterByte(RegisterType::D, 0xF6);
    WriteRegisterByte(RegisterType::E, 0xFF);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xED);
    WriteRegisterByte(RegisterType::L, 0x69);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBCF2, 0xD1);
    WriteMemory(0x2821, 0x64);
    WriteMemory(0x2820, 0xF7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFA);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x61);
    CheckRegisterByte(RegisterType::D, 0x64);
    CheckRegisterByte(RegisterType::E, 0xF7);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xED);
    CheckRegisterByte(RegisterType::L, 0x69);
    CheckRegisterWord(RegisterType::PC, 0xBCF3);
    CheckRegisterWord(RegisterType::SP, 0x2822);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2820, 0xF7);
    CheckMemory(0x2821, 0x64);
    CheckMemory(0xBCF2, 0xD1);
}

void test_D1_013D()
{
    if (skip_test_D1_013D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3077);
    WriteRegisterWord(RegisterType::SP, 0xB490);
    WriteRegisterByte(RegisterType::A, 0x8D);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0xDD);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0x4E);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x6E);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB491, 0xEC);
    WriteMemory(0xB490, 0x8D);
    WriteMemory(0x3077, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8D);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0xDD);
    CheckRegisterByte(RegisterType::D, 0xEC);
    CheckRegisterByte(RegisterType::E, 0x8D);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x6E);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0x3078);
    CheckRegisterWord(RegisterType::SP, 0xB492);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3077, 0xD1);
    CheckMemory(0xB490, 0x8D);
    CheckMemory(0xB491, 0xEC);
}

void test_D1_013E()
{
    if (skip_test_D1_013E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA143);
    WriteRegisterWord(RegisterType::SP, 0x24B6);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0x63);
    WriteRegisterByte(RegisterType::C, 0xE7);
    WriteRegisterByte(RegisterType::D, 0x1C);
    WriteRegisterByte(RegisterType::E, 0x7B);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x45);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA143, 0xD1);
    WriteMemory(0x24B7, 0xD1);
    WriteMemory(0x24B6, 0x0F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0x63);
    CheckRegisterByte(RegisterType::C, 0xE7);
    CheckRegisterByte(RegisterType::D, 0xD1);
    CheckRegisterByte(RegisterType::E, 0x0F);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x45);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0xA144);
    CheckRegisterWord(RegisterType::SP, 0x24B8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x24B6, 0x0F);
    CheckMemory(0x24B7, 0xD1);
    CheckMemory(0xA143, 0xD1);
}

void test_D1_013F()
{
    if (skip_test_D1_013F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x691E);
    WriteRegisterWord(RegisterType::SP, 0xC4BF);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0x70);
    WriteRegisterByte(RegisterType::C, 0x38);
    WriteRegisterByte(RegisterType::D, 0x15);
    WriteRegisterByte(RegisterType::E, 0x8F);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xEE);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC4C0, 0x89);
    WriteMemory(0xC4BF, 0xB1);
    WriteMemory(0x691E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0x70);
    CheckRegisterByte(RegisterType::C, 0x38);
    CheckRegisterByte(RegisterType::D, 0x89);
    CheckRegisterByte(RegisterType::E, 0xB1);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xEE);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0x691F);
    CheckRegisterWord(RegisterType::SP, 0xC4C1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x691E, 0xD1);
    CheckMemory(0xC4BF, 0xB1);
    CheckMemory(0xC4C0, 0x89);
}

void test_D1_0140()
{
    if (skip_test_D1_0140)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5365);
    WriteRegisterWord(RegisterType::SP, 0xF3B9);
    WriteRegisterByte(RegisterType::A, 0xA7);
    WriteRegisterByte(RegisterType::B, 0x6E);
    WriteRegisterByte(RegisterType::C, 0x9F);
    WriteRegisterByte(RegisterType::D, 0x95);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x82);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF3BA, 0x00);
    WriteMemory(0xF3B9, 0xBF);
    WriteMemory(0x5365, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA7);
    CheckRegisterByte(RegisterType::B, 0x6E);
    CheckRegisterByte(RegisterType::C, 0x9F);
    CheckRegisterByte(RegisterType::D, 0x00);
    CheckRegisterByte(RegisterType::E, 0xBF);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x82);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0x5366);
    CheckRegisterWord(RegisterType::SP, 0xF3BB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5365, 0xD1);
    CheckMemory(0xF3B9, 0xBF);
    CheckMemory(0xF3BA, 0x00);
}

void test_D1_0141()
{
    if (skip_test_D1_0141)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA615);
    WriteRegisterWord(RegisterType::SP, 0xAA2E);
    WriteRegisterByte(RegisterType::A, 0x65);
    WriteRegisterByte(RegisterType::B, 0x3B);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0x68);
    WriteRegisterByte(RegisterType::E, 0x20);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x0E);
    WriteRegisterByte(RegisterType::L, 0x52);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAA2F, 0xDB);
    WriteMemory(0xAA2E, 0xD0);
    WriteMemory(0xA615, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x65);
    CheckRegisterByte(RegisterType::B, 0x3B);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0xDB);
    CheckRegisterByte(RegisterType::E, 0xD0);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x0E);
    CheckRegisterByte(RegisterType::L, 0x52);
    CheckRegisterWord(RegisterType::PC, 0xA616);
    CheckRegisterWord(RegisterType::SP, 0xAA30);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA615, 0xD1);
    CheckMemory(0xAA2E, 0xD0);
    CheckMemory(0xAA2F, 0xDB);
}

void test_D1_0142()
{
    if (skip_test_D1_0142)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0AFD);
    WriteRegisterWord(RegisterType::SP, 0x01FB);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x50);
    WriteRegisterByte(RegisterType::C, 0xDF);
    WriteRegisterByte(RegisterType::D, 0x60);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xDB);
    WriteRegisterByte(RegisterType::L, 0x66);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x0AFD, 0xD1);
    WriteMemory(0x01FC, 0x87);
    WriteMemory(0x01FB, 0x7B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x50);
    CheckRegisterByte(RegisterType::C, 0xDF);
    CheckRegisterByte(RegisterType::D, 0x87);
    CheckRegisterByte(RegisterType::E, 0x7B);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xDB);
    CheckRegisterByte(RegisterType::L, 0x66);
    CheckRegisterWord(RegisterType::PC, 0x0AFE);
    CheckRegisterWord(RegisterType::SP, 0x01FD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x01FB, 0x7B);
    CheckMemory(0x01FC, 0x87);
    CheckMemory(0x0AFD, 0xD1);
}

void test_D1_0143()
{
    if (skip_test_D1_0143)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4058);
    WriteRegisterWord(RegisterType::SP, 0x04FC);
    WriteRegisterByte(RegisterType::A, 0xE6);
    WriteRegisterByte(RegisterType::B, 0x1A);
    WriteRegisterByte(RegisterType::C, 0x96);
    WriteRegisterByte(RegisterType::D, 0xC8);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0x6B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4058, 0xD1);
    WriteMemory(0x04FD, 0xF9);
    WriteMemory(0x04FC, 0xAD);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE6);
    CheckRegisterByte(RegisterType::B, 0x1A);
    CheckRegisterByte(RegisterType::C, 0x96);
    CheckRegisterByte(RegisterType::D, 0xF9);
    CheckRegisterByte(RegisterType::E, 0xAD);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0x6B);
    CheckRegisterWord(RegisterType::PC, 0x4059);
    CheckRegisterWord(RegisterType::SP, 0x04FE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x04FC, 0xAD);
    CheckMemory(0x04FD, 0xF9);
    CheckMemory(0x4058, 0xD1);
}

void test_D1_0144()
{
    if (skip_test_D1_0144)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2FC6);
    WriteRegisterWord(RegisterType::SP, 0x75F0);
    WriteRegisterByte(RegisterType::A, 0xAE);
    WriteRegisterByte(RegisterType::B, 0xDD);
    WriteRegisterByte(RegisterType::C, 0x90);
    WriteRegisterByte(RegisterType::D, 0x31);
    WriteRegisterByte(RegisterType::E, 0x19);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xF8);
    WriteRegisterByte(RegisterType::L, 0x77);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x75F1, 0xB9);
    WriteMemory(0x75F0, 0x02);
    WriteMemory(0x2FC6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAE);
    CheckRegisterByte(RegisterType::B, 0xDD);
    CheckRegisterByte(RegisterType::C, 0x90);
    CheckRegisterByte(RegisterType::D, 0xB9);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xF8);
    CheckRegisterByte(RegisterType::L, 0x77);
    CheckRegisterWord(RegisterType::PC, 0x2FC7);
    CheckRegisterWord(RegisterType::SP, 0x75F2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2FC6, 0xD1);
    CheckMemory(0x75F0, 0x02);
    CheckMemory(0x75F1, 0xB9);
}

void test_D1_0145()
{
    if (skip_test_D1_0145)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE028);
    WriteRegisterWord(RegisterType::SP, 0xA066);
    WriteRegisterByte(RegisterType::A, 0x75);
    WriteRegisterByte(RegisterType::B, 0x3B);
    WriteRegisterByte(RegisterType::C, 0xE0);
    WriteRegisterByte(RegisterType::D, 0xE0);
    WriteRegisterByte(RegisterType::E, 0xA9);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xC0);
    WriteRegisterByte(RegisterType::L, 0x9C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE028, 0xD1);
    WriteMemory(0xA067, 0x1E);
    WriteMemory(0xA066, 0x62);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x75);
    CheckRegisterByte(RegisterType::B, 0x3B);
    CheckRegisterByte(RegisterType::C, 0xE0);
    CheckRegisterByte(RegisterType::D, 0x1E);
    CheckRegisterByte(RegisterType::E, 0x62);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xC0);
    CheckRegisterByte(RegisterType::L, 0x9C);
    CheckRegisterWord(RegisterType::PC, 0xE029);
    CheckRegisterWord(RegisterType::SP, 0xA068);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA066, 0x62);
    CheckMemory(0xA067, 0x1E);
    CheckMemory(0xE028, 0xD1);
}

void test_D1_0146()
{
    if (skip_test_D1_0146)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9514);
    WriteRegisterWord(RegisterType::SP, 0x9243);
    WriteRegisterByte(RegisterType::A, 0x8F);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0x7D);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x31);
    WriteRegisterByte(RegisterType::L, 0x8B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9514, 0xD1);
    WriteMemory(0x9244, 0x07);
    WriteMemory(0x9243, 0xD2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8F);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0x07);
    CheckRegisterByte(RegisterType::E, 0xD2);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x31);
    CheckRegisterByte(RegisterType::L, 0x8B);
    CheckRegisterWord(RegisterType::PC, 0x9515);
    CheckRegisterWord(RegisterType::SP, 0x9245);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9243, 0xD2);
    CheckMemory(0x9244, 0x07);
    CheckMemory(0x9514, 0xD1);
}

void test_D1_0147()
{
    if (skip_test_D1_0147)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7C3E);
    WriteRegisterWord(RegisterType::SP, 0xBBC2);
    WriteRegisterByte(RegisterType::A, 0x33);
    WriteRegisterByte(RegisterType::B, 0x3D);
    WriteRegisterByte(RegisterType::C, 0xED);
    WriteRegisterByte(RegisterType::D, 0xDC);
    WriteRegisterByte(RegisterType::E, 0xE3);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xF4);
    WriteRegisterByte(RegisterType::L, 0xBA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBBC3, 0xFE);
    WriteMemory(0xBBC2, 0x47);
    WriteMemory(0x7C3E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x33);
    CheckRegisterByte(RegisterType::B, 0x3D);
    CheckRegisterByte(RegisterType::C, 0xED);
    CheckRegisterByte(RegisterType::D, 0xFE);
    CheckRegisterByte(RegisterType::E, 0x47);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xF4);
    CheckRegisterByte(RegisterType::L, 0xBA);
    CheckRegisterWord(RegisterType::PC, 0x7C3F);
    CheckRegisterWord(RegisterType::SP, 0xBBC4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7C3E, 0xD1);
    CheckMemory(0xBBC2, 0x47);
    CheckMemory(0xBBC3, 0xFE);
}

void test_D1_0148()
{
    if (skip_test_D1_0148)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x799F);
    WriteRegisterWord(RegisterType::SP, 0x1DBE);
    WriteRegisterByte(RegisterType::A, 0xD8);
    WriteRegisterByte(RegisterType::B, 0x4E);
    WriteRegisterByte(RegisterType::C, 0x91);
    WriteRegisterByte(RegisterType::D, 0x72);
    WriteRegisterByte(RegisterType::E, 0x55);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x5C);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x799F, 0xD1);
    WriteMemory(0x1DBF, 0x3E);
    WriteMemory(0x1DBE, 0xB9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD8);
    CheckRegisterByte(RegisterType::B, 0x4E);
    CheckRegisterByte(RegisterType::C, 0x91);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0xB9);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x5C);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0x79A0);
    CheckRegisterWord(RegisterType::SP, 0x1DC0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1DBE, 0xB9);
    CheckMemory(0x1DBF, 0x3E);
    CheckMemory(0x799F, 0xD1);
}

void test_D1_0149()
{
    if (skip_test_D1_0149)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE387);
    WriteRegisterWord(RegisterType::SP, 0x8A73);
    WriteRegisterByte(RegisterType::A, 0x5D);
    WriteRegisterByte(RegisterType::B, 0xF2);
    WriteRegisterByte(RegisterType::C, 0x1B);
    WriteRegisterByte(RegisterType::D, 0x59);
    WriteRegisterByte(RegisterType::E, 0x46);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0xBE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE387, 0xD1);
    WriteMemory(0x8A74, 0xF5);
    WriteMemory(0x8A73, 0x05);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5D);
    CheckRegisterByte(RegisterType::B, 0xF2);
    CheckRegisterByte(RegisterType::C, 0x1B);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x05);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0xBE);
    CheckRegisterWord(RegisterType::PC, 0xE388);
    CheckRegisterWord(RegisterType::SP, 0x8A75);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8A73, 0x05);
    CheckMemory(0x8A74, 0xF5);
    CheckMemory(0xE387, 0xD1);
}

void test_D1_014A()
{
    if (skip_test_D1_014A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFBC5);
    WriteRegisterWord(RegisterType::SP, 0xC231);
    WriteRegisterByte(RegisterType::A, 0x15);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0xA5);
    WriteRegisterByte(RegisterType::D, 0x8C);
    WriteRegisterByte(RegisterType::E, 0xF8);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0xB9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFBC5, 0xD1);
    WriteMemory(0xC232, 0x8C);
    WriteMemory(0xC231, 0x66);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x15);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0xA5);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0x66);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0xB9);
    CheckRegisterWord(RegisterType::PC, 0xFBC6);
    CheckRegisterWord(RegisterType::SP, 0xC233);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC231, 0x66);
    CheckMemory(0xC232, 0x8C);
    CheckMemory(0xFBC5, 0xD1);
}

void test_D1_014B()
{
    if (skip_test_D1_014B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8853);
    WriteRegisterWord(RegisterType::SP, 0x9CBA);
    WriteRegisterByte(RegisterType::A, 0x06);
    WriteRegisterByte(RegisterType::B, 0x4D);
    WriteRegisterByte(RegisterType::C, 0x40);
    WriteRegisterByte(RegisterType::D, 0xEF);
    WriteRegisterByte(RegisterType::E, 0x7E);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xD6);
    WriteRegisterByte(RegisterType::L, 0x98);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9CBB, 0x3E);
    WriteMemory(0x9CBA, 0xF5);
    WriteMemory(0x8853, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x06);
    CheckRegisterByte(RegisterType::B, 0x4D);
    CheckRegisterByte(RegisterType::C, 0x40);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0xF5);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xD6);
    CheckRegisterByte(RegisterType::L, 0x98);
    CheckRegisterWord(RegisterType::PC, 0x8854);
    CheckRegisterWord(RegisterType::SP, 0x9CBC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8853, 0xD1);
    CheckMemory(0x9CBA, 0xF5);
    CheckMemory(0x9CBB, 0x3E);
}

void test_D1_014C()
{
    if (skip_test_D1_014C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA406);
    WriteRegisterWord(RegisterType::SP, 0xC6B5);
    WriteRegisterByte(RegisterType::A, 0x8D);
    WriteRegisterByte(RegisterType::B, 0xC2);
    WriteRegisterByte(RegisterType::C, 0xFB);
    WriteRegisterByte(RegisterType::D, 0x73);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC6B6, 0x8A);
    WriteMemory(0xC6B5, 0x6F);
    WriteMemory(0xA406, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8D);
    CheckRegisterByte(RegisterType::B, 0xC2);
    CheckRegisterByte(RegisterType::C, 0xFB);
    CheckRegisterByte(RegisterType::D, 0x8A);
    CheckRegisterByte(RegisterType::E, 0x6F);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0xA407);
    CheckRegisterWord(RegisterType::SP, 0xC6B7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA406, 0xD1);
    CheckMemory(0xC6B5, 0x6F);
    CheckMemory(0xC6B6, 0x8A);
}

void test_D1_014D()
{
    if (skip_test_D1_014D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB8FD);
    WriteRegisterWord(RegisterType::SP, 0x3AD3);
    WriteRegisterByte(RegisterType::A, 0x03);
    WriteRegisterByte(RegisterType::B, 0xEB);
    WriteRegisterByte(RegisterType::C, 0x3C);
    WriteRegisterByte(RegisterType::D, 0x95);
    WriteRegisterByte(RegisterType::E, 0xA8);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0xB8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB8FD, 0xD1);
    WriteMemory(0x3AD4, 0xE2);
    WriteMemory(0x3AD3, 0x98);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x03);
    CheckRegisterByte(RegisterType::B, 0xEB);
    CheckRegisterByte(RegisterType::C, 0x3C);
    CheckRegisterByte(RegisterType::D, 0xE2);
    CheckRegisterByte(RegisterType::E, 0x98);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0xB8);
    CheckRegisterWord(RegisterType::PC, 0xB8FE);
    CheckRegisterWord(RegisterType::SP, 0x3AD5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3AD3, 0x98);
    CheckMemory(0x3AD4, 0xE2);
    CheckMemory(0xB8FD, 0xD1);
}

void test_D1_014E()
{
    if (skip_test_D1_014E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9444);
    WriteRegisterWord(RegisterType::SP, 0xE0B3);
    WriteRegisterByte(RegisterType::A, 0x0E);
    WriteRegisterByte(RegisterType::B, 0x69);
    WriteRegisterByte(RegisterType::C, 0x75);
    WriteRegisterByte(RegisterType::D, 0xDA);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xF5);
    WriteRegisterByte(RegisterType::L, 0x28);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE0B4, 0xF4);
    WriteMemory(0xE0B3, 0xB4);
    WriteMemory(0x9444, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0E);
    CheckRegisterByte(RegisterType::B, 0x69);
    CheckRegisterByte(RegisterType::C, 0x75);
    CheckRegisterByte(RegisterType::D, 0xF4);
    CheckRegisterByte(RegisterType::E, 0xB4);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xF5);
    CheckRegisterByte(RegisterType::L, 0x28);
    CheckRegisterWord(RegisterType::PC, 0x9445);
    CheckRegisterWord(RegisterType::SP, 0xE0B5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9444, 0xD1);
    CheckMemory(0xE0B3, 0xB4);
    CheckMemory(0xE0B4, 0xF4);
}

void test_D1_014F()
{
    if (skip_test_D1_014F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF7A4);
    WriteRegisterWord(RegisterType::SP, 0x8D02);
    WriteRegisterByte(RegisterType::A, 0x5F);
    WriteRegisterByte(RegisterType::B, 0x4E);
    WriteRegisterByte(RegisterType::C, 0xAF);
    WriteRegisterByte(RegisterType::D, 0x6D);
    WriteRegisterByte(RegisterType::E, 0x6C);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x9A);
    WriteRegisterByte(RegisterType::L, 0x34);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF7A4, 0xD1);
    WriteMemory(0x8D03, 0x9B);
    WriteMemory(0x8D02, 0xAA);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5F);
    CheckRegisterByte(RegisterType::B, 0x4E);
    CheckRegisterByte(RegisterType::C, 0xAF);
    CheckRegisterByte(RegisterType::D, 0x9B);
    CheckRegisterByte(RegisterType::E, 0xAA);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x9A);
    CheckRegisterByte(RegisterType::L, 0x34);
    CheckRegisterWord(RegisterType::PC, 0xF7A5);
    CheckRegisterWord(RegisterType::SP, 0x8D04);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8D02, 0xAA);
    CheckMemory(0x8D03, 0x9B);
    CheckMemory(0xF7A4, 0xD1);
}

void test_D1_0150()
{
    if (skip_test_D1_0150)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8942);
    WriteRegisterWord(RegisterType::SP, 0xCA2A);
    WriteRegisterByte(RegisterType::A, 0x3A);
    WriteRegisterByte(RegisterType::B, 0x4E);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0x3D);
    WriteRegisterByte(RegisterType::E, 0xFB);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0xFF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCA2B, 0xD6);
    WriteMemory(0xCA2A, 0xAD);
    WriteMemory(0x8942, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3A);
    CheckRegisterByte(RegisterType::B, 0x4E);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0xD6);
    CheckRegisterByte(RegisterType::E, 0xAD);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0xFF);
    CheckRegisterWord(RegisterType::PC, 0x8943);
    CheckRegisterWord(RegisterType::SP, 0xCA2C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8942, 0xD1);
    CheckMemory(0xCA2A, 0xAD);
    CheckMemory(0xCA2B, 0xD6);
}

void test_D1_0151()
{
    if (skip_test_D1_0151)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8180);
    WriteRegisterWord(RegisterType::SP, 0xFF9D);
    WriteRegisterByte(RegisterType::A, 0x0E);
    WriteRegisterByte(RegisterType::B, 0x69);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0x9F);
    WriteRegisterByte(RegisterType::E, 0x6E);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0x7B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9E, 0xDE);
    WriteMemory(0xFF9D, 0x0C);
    WriteMemory(0x8180, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0E);
    CheckRegisterByte(RegisterType::B, 0x69);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0xDE);
    CheckRegisterByte(RegisterType::E, 0x0C);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0x7B);
    CheckRegisterWord(RegisterType::PC, 0x8181);
    CheckRegisterWord(RegisterType::SP, 0xFF9F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8180, 0xD1);
    CheckMemory(0xFF9D, 0x0C);
    CheckMemory(0xFF9E, 0xDE);
}

void test_D1_0152()
{
    if (skip_test_D1_0152)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1F8A);
    WriteRegisterWord(RegisterType::SP, 0x3BD7);
    WriteRegisterByte(RegisterType::A, 0x29);
    WriteRegisterByte(RegisterType::B, 0x1E);
    WriteRegisterByte(RegisterType::C, 0xD7);
    WriteRegisterByte(RegisterType::D, 0xB0);
    WriteRegisterByte(RegisterType::E, 0xA3);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xE9);
    WriteRegisterByte(RegisterType::L, 0x07);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x3BD8, 0xF0);
    WriteMemory(0x3BD7, 0x8A);
    WriteMemory(0x1F8A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x29);
    CheckRegisterByte(RegisterType::B, 0x1E);
    CheckRegisterByte(RegisterType::C, 0xD7);
    CheckRegisterByte(RegisterType::D, 0xF0);
    CheckRegisterByte(RegisterType::E, 0x8A);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xE9);
    CheckRegisterByte(RegisterType::L, 0x07);
    CheckRegisterWord(RegisterType::PC, 0x1F8B);
    CheckRegisterWord(RegisterType::SP, 0x3BD9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1F8A, 0xD1);
    CheckMemory(0x3BD7, 0x8A);
    CheckMemory(0x3BD8, 0xF0);
}

void test_D1_0153()
{
    if (skip_test_D1_0153)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x84C0);
    WriteRegisterWord(RegisterType::SP, 0x360B);
    WriteRegisterByte(RegisterType::A, 0xF5);
    WriteRegisterByte(RegisterType::B, 0x70);
    WriteRegisterByte(RegisterType::C, 0xA0);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0x60);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x19);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x84C0, 0xD1);
    WriteMemory(0x360C, 0xEF);
    WriteMemory(0x360B, 0xCA);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF5);
    CheckRegisterByte(RegisterType::B, 0x70);
    CheckRegisterByte(RegisterType::C, 0xA0);
    CheckRegisterByte(RegisterType::D, 0xEF);
    CheckRegisterByte(RegisterType::E, 0xCA);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x19);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0x84C1);
    CheckRegisterWord(RegisterType::SP, 0x360D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x360B, 0xCA);
    CheckMemory(0x360C, 0xEF);
    CheckMemory(0x84C0, 0xD1);
}

void test_D1_0154()
{
    if (skip_test_D1_0154)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xABC9);
    WriteRegisterWord(RegisterType::SP, 0x1D43);
    WriteRegisterByte(RegisterType::A, 0x27);
    WriteRegisterByte(RegisterType::B, 0x1F);
    WriteRegisterByte(RegisterType::C, 0x7E);
    WriteRegisterByte(RegisterType::D, 0xC5);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xABC9, 0xD1);
    WriteMemory(0x1D44, 0x62);
    WriteMemory(0x1D43, 0x2F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x27);
    CheckRegisterByte(RegisterType::B, 0x1F);
    CheckRegisterByte(RegisterType::C, 0x7E);
    CheckRegisterByte(RegisterType::D, 0x62);
    CheckRegisterByte(RegisterType::E, 0x2F);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0xABCA);
    CheckRegisterWord(RegisterType::SP, 0x1D45);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1D43, 0x2F);
    CheckMemory(0x1D44, 0x62);
    CheckMemory(0xABC9, 0xD1);
}

void test_D1_0155()
{
    if (skip_test_D1_0155)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCE6C);
    WriteRegisterWord(RegisterType::SP, 0x5F64);
    WriteRegisterByte(RegisterType::A, 0x1A);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0xA5);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0x1E);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xB1);
    WriteRegisterByte(RegisterType::L, 0x22);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCE6C, 0xD1);
    WriteMemory(0x5F65, 0x94);
    WriteMemory(0x5F64, 0x05);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1A);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0xA5);
    CheckRegisterByte(RegisterType::D, 0x94);
    CheckRegisterByte(RegisterType::E, 0x05);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xB1);
    CheckRegisterByte(RegisterType::L, 0x22);
    CheckRegisterWord(RegisterType::PC, 0xCE6D);
    CheckRegisterWord(RegisterType::SP, 0x5F66);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5F64, 0x05);
    CheckMemory(0x5F65, 0x94);
    CheckMemory(0xCE6C, 0xD1);
}

void test_D1_0156()
{
    if (skip_test_D1_0156)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB211);
    WriteRegisterWord(RegisterType::SP, 0x399C);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0x8B);
    WriteRegisterByte(RegisterType::C, 0x64);
    WriteRegisterByte(RegisterType::D, 0x20);
    WriteRegisterByte(RegisterType::E, 0xAB);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x04);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB211, 0xD1);
    WriteMemory(0x399D, 0x9E);
    WriteMemory(0x399C, 0x88);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0x8B);
    CheckRegisterByte(RegisterType::C, 0x64);
    CheckRegisterByte(RegisterType::D, 0x9E);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x04);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0xB212);
    CheckRegisterWord(RegisterType::SP, 0x399E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x399C, 0x88);
    CheckMemory(0x399D, 0x9E);
    CheckMemory(0xB211, 0xD1);
}

void test_D1_0157()
{
    if (skip_test_D1_0157)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBBB6);
    WriteRegisterWord(RegisterType::SP, 0xFF62);
    WriteRegisterByte(RegisterType::A, 0xCA);
    WriteRegisterByte(RegisterType::B, 0x00);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0x57);
    WriteRegisterByte(RegisterType::E, 0x01);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x5D);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF63, 0x30);
    WriteMemory(0xFF62, 0x1A);
    WriteMemory(0xBBB6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCA);
    CheckRegisterByte(RegisterType::B, 0x00);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0x30);
    CheckRegisterByte(RegisterType::E, 0x1A);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x5D);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0xBBB7);
    CheckRegisterWord(RegisterType::SP, 0xFF64);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBBB6, 0xD1);
    CheckMemory(0xFF62, 0x1A);
    CheckMemory(0xFF63, 0x30);
}

void test_D1_0158()
{
    if (skip_test_D1_0158)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD5B0);
    WriteRegisterWord(RegisterType::SP, 0x7F4F);
    WriteRegisterByte(RegisterType::A, 0xC9);
    WriteRegisterByte(RegisterType::B, 0x13);
    WriteRegisterByte(RegisterType::C, 0xCF);
    WriteRegisterByte(RegisterType::D, 0x7C);
    WriteRegisterByte(RegisterType::E, 0xE8);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xA5);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD5B0, 0xD1);
    WriteMemory(0x7F50, 0x30);
    WriteMemory(0x7F4F, 0xD2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC9);
    CheckRegisterByte(RegisterType::B, 0x13);
    CheckRegisterByte(RegisterType::C, 0xCF);
    CheckRegisterByte(RegisterType::D, 0x30);
    CheckRegisterByte(RegisterType::E, 0xD2);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xA5);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0xD5B1);
    CheckRegisterWord(RegisterType::SP, 0x7F51);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7F4F, 0xD2);
    CheckMemory(0x7F50, 0x30);
    CheckMemory(0xD5B0, 0xD1);
}

void test_D1_0159()
{
    if (skip_test_D1_0159)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5988);
    WriteRegisterWord(RegisterType::SP, 0x1225);
    WriteRegisterByte(RegisterType::A, 0x60);
    WriteRegisterByte(RegisterType::B, 0xBF);
    WriteRegisterByte(RegisterType::C, 0x42);
    WriteRegisterByte(RegisterType::D, 0x8F);
    WriteRegisterByte(RegisterType::E, 0x5F);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xEA);
    WriteRegisterByte(RegisterType::L, 0xDD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5988, 0xD1);
    WriteMemory(0x1226, 0x1C);
    WriteMemory(0x1225, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x60);
    CheckRegisterByte(RegisterType::B, 0xBF);
    CheckRegisterByte(RegisterType::C, 0x42);
    CheckRegisterByte(RegisterType::D, 0x1C);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xEA);
    CheckRegisterByte(RegisterType::L, 0xDD);
    CheckRegisterWord(RegisterType::PC, 0x5989);
    CheckRegisterWord(RegisterType::SP, 0x1227);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1225, 0xD1);
    CheckMemory(0x1226, 0x1C);
    CheckMemory(0x5988, 0xD1);
}

void test_D1_015A()
{
    if (skip_test_D1_015A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6B32);
    WriteRegisterWord(RegisterType::SP, 0xA4D1);
    WriteRegisterByte(RegisterType::A, 0x3A);
    WriteRegisterByte(RegisterType::B, 0x3E);
    WriteRegisterByte(RegisterType::C, 0x3B);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x37);
    WriteRegisterByte(RegisterType::L, 0xE1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA4D2, 0xEA);
    WriteMemory(0xA4D1, 0xBC);
    WriteMemory(0x6B32, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3A);
    CheckRegisterByte(RegisterType::B, 0x3E);
    CheckRegisterByte(RegisterType::C, 0x3B);
    CheckRegisterByte(RegisterType::D, 0xEA);
    CheckRegisterByte(RegisterType::E, 0xBC);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x37);
    CheckRegisterByte(RegisterType::L, 0xE1);
    CheckRegisterWord(RegisterType::PC, 0x6B33);
    CheckRegisterWord(RegisterType::SP, 0xA4D3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6B32, 0xD1);
    CheckMemory(0xA4D1, 0xBC);
    CheckMemory(0xA4D2, 0xEA);
}

void test_D1_015B()
{
    if (skip_test_D1_015B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4462);
    WriteRegisterWord(RegisterType::SP, 0x425E);
    WriteRegisterByte(RegisterType::A, 0x1C);
    WriteRegisterByte(RegisterType::B, 0xAE);
    WriteRegisterByte(RegisterType::C, 0xA0);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0x0D);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0x97);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x4462, 0xD1);
    WriteMemory(0x425F, 0x1A);
    WriteMemory(0x425E, 0x4E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1C);
    CheckRegisterByte(RegisterType::B, 0xAE);
    CheckRegisterByte(RegisterType::C, 0xA0);
    CheckRegisterByte(RegisterType::D, 0x1A);
    CheckRegisterByte(RegisterType::E, 0x4E);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0x97);
    CheckRegisterWord(RegisterType::PC, 0x4463);
    CheckRegisterWord(RegisterType::SP, 0x4260);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x425E, 0x4E);
    CheckMemory(0x425F, 0x1A);
    CheckMemory(0x4462, 0xD1);
}

void test_D1_015C()
{
    if (skip_test_D1_015C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBD79);
    WriteRegisterWord(RegisterType::SP, 0xA040);
    WriteRegisterByte(RegisterType::A, 0x37);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0x81);
    WriteRegisterByte(RegisterType::D, 0x27);
    WriteRegisterByte(RegisterType::E, 0xB6);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x3D);
    WriteRegisterByte(RegisterType::L, 0x9F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBD79, 0xD1);
    WriteMemory(0xA041, 0x1D);
    WriteMemory(0xA040, 0x44);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x37);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0x81);
    CheckRegisterByte(RegisterType::D, 0x1D);
    CheckRegisterByte(RegisterType::E, 0x44);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x3D);
    CheckRegisterByte(RegisterType::L, 0x9F);
    CheckRegisterWord(RegisterType::PC, 0xBD7A);
    CheckRegisterWord(RegisterType::SP, 0xA042);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA040, 0x44);
    CheckMemory(0xA041, 0x1D);
    CheckMemory(0xBD79, 0xD1);
}

void test_D1_015D()
{
    if (skip_test_D1_015D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x801A);
    WriteRegisterWord(RegisterType::SP, 0xA63F);
    WriteRegisterByte(RegisterType::A, 0x27);
    WriteRegisterByte(RegisterType::B, 0x27);
    WriteRegisterByte(RegisterType::C, 0x85);
    WriteRegisterByte(RegisterType::D, 0xFB);
    WriteRegisterByte(RegisterType::E, 0x27);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x5E);
    WriteRegisterByte(RegisterType::L, 0x8B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA640, 0x5D);
    WriteMemory(0xA63F, 0x13);
    WriteMemory(0x801A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x27);
    CheckRegisterByte(RegisterType::B, 0x27);
    CheckRegisterByte(RegisterType::C, 0x85);
    CheckRegisterByte(RegisterType::D, 0x5D);
    CheckRegisterByte(RegisterType::E, 0x13);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x5E);
    CheckRegisterByte(RegisterType::L, 0x8B);
    CheckRegisterWord(RegisterType::PC, 0x801B);
    CheckRegisterWord(RegisterType::SP, 0xA641);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x801A, 0xD1);
    CheckMemory(0xA63F, 0x13);
    CheckMemory(0xA640, 0x5D);
}

void test_D1_015E()
{
    if (skip_test_D1_015E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD7D);
    WriteRegisterWord(RegisterType::SP, 0x1553);
    WriteRegisterByte(RegisterType::A, 0x5D);
    WriteRegisterByte(RegisterType::B, 0x74);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0x4C);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0x7C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCD7D, 0xD1);
    WriteMemory(0x1554, 0x52);
    WriteMemory(0x1553, 0xEC);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5D);
    CheckRegisterByte(RegisterType::B, 0x74);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0x52);
    CheckRegisterByte(RegisterType::E, 0xEC);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0x7C);
    CheckRegisterWord(RegisterType::PC, 0xCD7E);
    CheckRegisterWord(RegisterType::SP, 0x1555);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1553, 0xEC);
    CheckMemory(0x1554, 0x52);
    CheckMemory(0xCD7D, 0xD1);
}

void test_D1_015F()
{
    if (skip_test_D1_015F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6331);
    WriteRegisterWord(RegisterType::SP, 0x258D);
    WriteRegisterByte(RegisterType::A, 0xC4);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0xB1);
    WriteRegisterByte(RegisterType::D, 0xC4);
    WriteRegisterByte(RegisterType::E, 0x51);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0x89);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6331, 0xD1);
    WriteMemory(0x258E, 0xA1);
    WriteMemory(0x258D, 0xA1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC4);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0xB1);
    CheckRegisterByte(RegisterType::D, 0xA1);
    CheckRegisterByte(RegisterType::E, 0xA1);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0x89);
    CheckRegisterWord(RegisterType::PC, 0x6332);
    CheckRegisterWord(RegisterType::SP, 0x258F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x258D, 0xA1);
    CheckMemory(0x258E, 0xA1);
    CheckMemory(0x6331, 0xD1);
}

void test_D1_0160()
{
    if (skip_test_D1_0160)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6E0C);
    WriteRegisterWord(RegisterType::SP, 0x9734);
    WriteRegisterByte(RegisterType::A, 0x70);
    WriteRegisterByte(RegisterType::B, 0x85);
    WriteRegisterByte(RegisterType::C, 0x60);
    WriteRegisterByte(RegisterType::D, 0xA3);
    WriteRegisterByte(RegisterType::E, 0x56);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x14);
    WriteRegisterByte(RegisterType::L, 0xE4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9735, 0x25);
    WriteMemory(0x9734, 0x99);
    WriteMemory(0x6E0C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x70);
    CheckRegisterByte(RegisterType::B, 0x85);
    CheckRegisterByte(RegisterType::C, 0x60);
    CheckRegisterByte(RegisterType::D, 0x25);
    CheckRegisterByte(RegisterType::E, 0x99);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x14);
    CheckRegisterByte(RegisterType::L, 0xE4);
    CheckRegisterWord(RegisterType::PC, 0x6E0D);
    CheckRegisterWord(RegisterType::SP, 0x9736);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6E0C, 0xD1);
    CheckMemory(0x9734, 0x99);
    CheckMemory(0x9735, 0x25);
}

void test_D1_0161()
{
    if (skip_test_D1_0161)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7CB2);
    WriteRegisterWord(RegisterType::SP, 0x7F03);
    WriteRegisterByte(RegisterType::A, 0x53);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0xA0);
    WriteRegisterByte(RegisterType::E, 0x1E);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xDD);
    WriteRegisterByte(RegisterType::L, 0x33);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7F04, 0x53);
    WriteMemory(0x7F03, 0x9A);
    WriteMemory(0x7CB2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x53);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0x53);
    CheckRegisterByte(RegisterType::E, 0x9A);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xDD);
    CheckRegisterByte(RegisterType::L, 0x33);
    CheckRegisterWord(RegisterType::PC, 0x7CB3);
    CheckRegisterWord(RegisterType::SP, 0x7F05);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7CB2, 0xD1);
    CheckMemory(0x7F03, 0x9A);
    CheckMemory(0x7F04, 0x53);
}

void test_D1_0162()
{
    if (skip_test_D1_0162)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7044);
    WriteRegisterWord(RegisterType::SP, 0x2B46);
    WriteRegisterByte(RegisterType::A, 0x01);
    WriteRegisterByte(RegisterType::B, 0xE6);
    WriteRegisterByte(RegisterType::C, 0x21);
    WriteRegisterByte(RegisterType::D, 0xB3);
    WriteRegisterByte(RegisterType::E, 0xA2);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x7A);
    WriteRegisterByte(RegisterType::L, 0xB5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7044, 0xD1);
    WriteMemory(0x2B47, 0x6C);
    WriteMemory(0x2B46, 0x3C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x01);
    CheckRegisterByte(RegisterType::B, 0xE6);
    CheckRegisterByte(RegisterType::C, 0x21);
    CheckRegisterByte(RegisterType::D, 0x6C);
    CheckRegisterByte(RegisterType::E, 0x3C);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x7A);
    CheckRegisterByte(RegisterType::L, 0xB5);
    CheckRegisterWord(RegisterType::PC, 0x7045);
    CheckRegisterWord(RegisterType::SP, 0x2B48);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2B46, 0x3C);
    CheckMemory(0x2B47, 0x6C);
    CheckMemory(0x7044, 0xD1);
}

void test_D1_0163()
{
    if (skip_test_D1_0163)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x09C4);
    WriteRegisterWord(RegisterType::SP, 0xF9DB);
    WriteRegisterByte(RegisterType::A, 0x8F);
    WriteRegisterByte(RegisterType::B, 0x85);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0x21);
    WriteRegisterByte(RegisterType::E, 0x41);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x9E);
    WriteRegisterByte(RegisterType::L, 0x75);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF9DC, 0xA0);
    WriteMemory(0xF9DB, 0x30);
    WriteMemory(0x09C4, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8F);
    CheckRegisterByte(RegisterType::B, 0x85);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0xA0);
    CheckRegisterByte(RegisterType::E, 0x30);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x9E);
    CheckRegisterByte(RegisterType::L, 0x75);
    CheckRegisterWord(RegisterType::PC, 0x09C5);
    CheckRegisterWord(RegisterType::SP, 0xF9DD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x09C4, 0xD1);
    CheckMemory(0xF9DB, 0x30);
    CheckMemory(0xF9DC, 0xA0);
}

void test_D1_0164()
{
    if (skip_test_D1_0164)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x425D);
    WriteRegisterWord(RegisterType::SP, 0x91FC);
    WriteRegisterByte(RegisterType::A, 0x79);
    WriteRegisterByte(RegisterType::B, 0x33);
    WriteRegisterByte(RegisterType::C, 0x9C);
    WriteRegisterByte(RegisterType::D, 0x3F);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xC1);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x91FD, 0x9F);
    WriteMemory(0x91FC, 0x9B);
    WriteMemory(0x425D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x79);
    CheckRegisterByte(RegisterType::B, 0x33);
    CheckRegisterByte(RegisterType::C, 0x9C);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0x9B);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xC1);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0x425E);
    CheckRegisterWord(RegisterType::SP, 0x91FE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x425D, 0xD1);
    CheckMemory(0x91FC, 0x9B);
    CheckMemory(0x91FD, 0x9F);
}

void test_D1_0165()
{
    if (skip_test_D1_0165)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5FC5);
    WriteRegisterWord(RegisterType::SP, 0x3203);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0x3F);
    WriteRegisterByte(RegisterType::C, 0x9D);
    WriteRegisterByte(RegisterType::D, 0xC0);
    WriteRegisterByte(RegisterType::E, 0x76);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x1A);
    WriteRegisterByte(RegisterType::L, 0x6C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5FC5, 0xD1);
    WriteMemory(0x3204, 0xB0);
    WriteMemory(0x3203, 0xC4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0x3F);
    CheckRegisterByte(RegisterType::C, 0x9D);
    CheckRegisterByte(RegisterType::D, 0xB0);
    CheckRegisterByte(RegisterType::E, 0xC4);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x1A);
    CheckRegisterByte(RegisterType::L, 0x6C);
    CheckRegisterWord(RegisterType::PC, 0x5FC6);
    CheckRegisterWord(RegisterType::SP, 0x3205);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3203, 0xC4);
    CheckMemory(0x3204, 0xB0);
    CheckMemory(0x5FC5, 0xD1);
}

void test_D1_0166()
{
    if (skip_test_D1_0166)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFE83);
    WriteRegisterWord(RegisterType::SP, 0xE69A);
    WriteRegisterByte(RegisterType::A, 0xA9);
    WriteRegisterByte(RegisterType::B, 0xBA);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0xEF);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xD3);
    WriteRegisterByte(RegisterType::L, 0x74);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFE83, 0xD1);
    WriteMemory(0xE69B, 0x42);
    WriteMemory(0xE69A, 0x1D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA9);
    CheckRegisterByte(RegisterType::B, 0xBA);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0x42);
    CheckRegisterByte(RegisterType::E, 0x1D);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xD3);
    CheckRegisterByte(RegisterType::L, 0x74);
    CheckRegisterWord(RegisterType::PC, 0xFE84);
    CheckRegisterWord(RegisterType::SP, 0xE69C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE69A, 0x1D);
    CheckMemory(0xE69B, 0x42);
    CheckMemory(0xFE83, 0xD1);
}

void test_D1_0167()
{
    if (skip_test_D1_0167)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD962);
    WriteRegisterWord(RegisterType::SP, 0xE4A8);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0xFA);
    WriteRegisterByte(RegisterType::C, 0x6C);
    WriteRegisterByte(RegisterType::D, 0x80);
    WriteRegisterByte(RegisterType::E, 0xD2);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x85);
    WriteRegisterByte(RegisterType::L, 0x90);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE4A9, 0x9F);
    WriteMemory(0xE4A8, 0x55);
    WriteMemory(0xD962, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0xFA);
    CheckRegisterByte(RegisterType::C, 0x6C);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0x55);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x85);
    CheckRegisterByte(RegisterType::L, 0x90);
    CheckRegisterWord(RegisterType::PC, 0xD963);
    CheckRegisterWord(RegisterType::SP, 0xE4AA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD962, 0xD1);
    CheckMemory(0xE4A8, 0x55);
    CheckMemory(0xE4A9, 0x9F);
}

void test_D1_0168()
{
    if (skip_test_D1_0168)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x64A6);
    WriteRegisterWord(RegisterType::SP, 0x76F8);
    WriteRegisterByte(RegisterType::A, 0xA9);
    WriteRegisterByte(RegisterType::B, 0xC3);
    WriteRegisterByte(RegisterType::C, 0x7B);
    WriteRegisterByte(RegisterType::D, 0xBA);
    WriteRegisterByte(RegisterType::E, 0x25);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x67);
    WriteRegisterByte(RegisterType::L, 0x5F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x76F9, 0x43);
    WriteMemory(0x76F8, 0x9B);
    WriteMemory(0x64A6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA9);
    CheckRegisterByte(RegisterType::B, 0xC3);
    CheckRegisterByte(RegisterType::C, 0x7B);
    CheckRegisterByte(RegisterType::D, 0x43);
    CheckRegisterByte(RegisterType::E, 0x9B);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x67);
    CheckRegisterByte(RegisterType::L, 0x5F);
    CheckRegisterWord(RegisterType::PC, 0x64A7);
    CheckRegisterWord(RegisterType::SP, 0x76FA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x64A6, 0xD1);
    CheckMemory(0x76F8, 0x9B);
    CheckMemory(0x76F9, 0x43);
}

void test_D1_0169()
{
    if (skip_test_D1_0169)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x080A);
    WriteRegisterWord(RegisterType::SP, 0xE3CE);
    WriteRegisterByte(RegisterType::A, 0x1C);
    WriteRegisterByte(RegisterType::B, 0xDF);
    WriteRegisterByte(RegisterType::C, 0x93);
    WriteRegisterByte(RegisterType::D, 0x6B);
    WriteRegisterByte(RegisterType::E, 0x18);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xE0);
    WriteRegisterByte(RegisterType::L, 0xF7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE3CF, 0xA4);
    WriteMemory(0xE3CE, 0x3C);
    WriteMemory(0x080A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1C);
    CheckRegisterByte(RegisterType::B, 0xDF);
    CheckRegisterByte(RegisterType::C, 0x93);
    CheckRegisterByte(RegisterType::D, 0xA4);
    CheckRegisterByte(RegisterType::E, 0x3C);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xE0);
    CheckRegisterByte(RegisterType::L, 0xF7);
    CheckRegisterWord(RegisterType::PC, 0x080B);
    CheckRegisterWord(RegisterType::SP, 0xE3D0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x080A, 0xD1);
    CheckMemory(0xE3CE, 0x3C);
    CheckMemory(0xE3CF, 0xA4);
}

void test_D1_016A()
{
    if (skip_test_D1_016A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x374F);
    WriteRegisterWord(RegisterType::SP, 0xA580);
    WriteRegisterByte(RegisterType::A, 0x9F);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x86);
    WriteRegisterByte(RegisterType::D, 0xE6);
    WriteRegisterByte(RegisterType::E, 0x41);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0x39);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA581, 0xA7);
    WriteMemory(0xA580, 0xC1);
    WriteMemory(0x374F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9F);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x86);
    CheckRegisterByte(RegisterType::D, 0xA7);
    CheckRegisterByte(RegisterType::E, 0xC1);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0x39);
    CheckRegisterWord(RegisterType::PC, 0x3750);
    CheckRegisterWord(RegisterType::SP, 0xA582);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x374F, 0xD1);
    CheckMemory(0xA580, 0xC1);
    CheckMemory(0xA581, 0xA7);
}

void test_D1_016B()
{
    if (skip_test_D1_016B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5CB8);
    WriteRegisterWord(RegisterType::SP, 0xE794);
    WriteRegisterByte(RegisterType::A, 0xDD);
    WriteRegisterByte(RegisterType::B, 0x8A);
    WriteRegisterByte(RegisterType::C, 0x0D);
    WriteRegisterByte(RegisterType::D, 0xE6);
    WriteRegisterByte(RegisterType::E, 0xCF);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x8F);
    WriteRegisterByte(RegisterType::L, 0xCD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE795, 0x80);
    WriteMemory(0xE794, 0x2C);
    WriteMemory(0x5CB8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDD);
    CheckRegisterByte(RegisterType::B, 0x8A);
    CheckRegisterByte(RegisterType::C, 0x0D);
    CheckRegisterByte(RegisterType::D, 0x80);
    CheckRegisterByte(RegisterType::E, 0x2C);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x8F);
    CheckRegisterByte(RegisterType::L, 0xCD);
    CheckRegisterWord(RegisterType::PC, 0x5CB9);
    CheckRegisterWord(RegisterType::SP, 0xE796);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5CB8, 0xD1);
    CheckMemory(0xE794, 0x2C);
    CheckMemory(0xE795, 0x80);
}

void test_D1_016C()
{
    if (skip_test_D1_016C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3A9E);
    WriteRegisterWord(RegisterType::SP, 0x5A13);
    WriteRegisterByte(RegisterType::A, 0x73);
    WriteRegisterByte(RegisterType::B, 0x35);
    WriteRegisterByte(RegisterType::C, 0xAD);
    WriteRegisterByte(RegisterType::D, 0x51);
    WriteRegisterByte(RegisterType::E, 0x26);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xC3);
    WriteRegisterByte(RegisterType::L, 0xEF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5A14, 0xB8);
    WriteMemory(0x5A13, 0x25);
    WriteMemory(0x3A9E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x73);
    CheckRegisterByte(RegisterType::B, 0x35);
    CheckRegisterByte(RegisterType::C, 0xAD);
    CheckRegisterByte(RegisterType::D, 0xB8);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xC3);
    CheckRegisterByte(RegisterType::L, 0xEF);
    CheckRegisterWord(RegisterType::PC, 0x3A9F);
    CheckRegisterWord(RegisterType::SP, 0x5A15);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3A9E, 0xD1);
    CheckMemory(0x5A13, 0x25);
    CheckMemory(0x5A14, 0xB8);
}

void test_D1_016D()
{
    if (skip_test_D1_016D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x944E);
    WriteRegisterWord(RegisterType::SP, 0x5686);
    WriteRegisterByte(RegisterType::A, 0x07);
    WriteRegisterByte(RegisterType::B, 0xFC);
    WriteRegisterByte(RegisterType::C, 0x8F);
    WriteRegisterByte(RegisterType::D, 0x28);
    WriteRegisterByte(RegisterType::E, 0xBC);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xCD);
    WriteRegisterByte(RegisterType::L, 0x43);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x944E, 0xD1);
    WriteMemory(0x5687, 0x93);
    WriteMemory(0x5686, 0xF1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x07);
    CheckRegisterByte(RegisterType::B, 0xFC);
    CheckRegisterByte(RegisterType::C, 0x8F);
    CheckRegisterByte(RegisterType::D, 0x93);
    CheckRegisterByte(RegisterType::E, 0xF1);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xCD);
    CheckRegisterByte(RegisterType::L, 0x43);
    CheckRegisterWord(RegisterType::PC, 0x944F);
    CheckRegisterWord(RegisterType::SP, 0x5688);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5686, 0xF1);
    CheckMemory(0x5687, 0x93);
    CheckMemory(0x944E, 0xD1);
}

void test_D1_016E()
{
    if (skip_test_D1_016E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8951);
    WriteRegisterWord(RegisterType::SP, 0xCD61);
    WriteRegisterByte(RegisterType::A, 0xDD);
    WriteRegisterByte(RegisterType::B, 0xD5);
    WriteRegisterByte(RegisterType::C, 0x48);
    WriteRegisterByte(RegisterType::D, 0xE9);
    WriteRegisterByte(RegisterType::E, 0xD2);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x5A);
    WriteRegisterByte(RegisterType::L, 0x24);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCD62, 0xA0);
    WriteMemory(0xCD61, 0x7E);
    WriteMemory(0x8951, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDD);
    CheckRegisterByte(RegisterType::B, 0xD5);
    CheckRegisterByte(RegisterType::C, 0x48);
    CheckRegisterByte(RegisterType::D, 0xA0);
    CheckRegisterByte(RegisterType::E, 0x7E);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x5A);
    CheckRegisterByte(RegisterType::L, 0x24);
    CheckRegisterWord(RegisterType::PC, 0x8952);
    CheckRegisterWord(RegisterType::SP, 0xCD63);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8951, 0xD1);
    CheckMemory(0xCD61, 0x7E);
    CheckMemory(0xCD62, 0xA0);
}

void test_D1_016F()
{
    if (skip_test_D1_016F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8007);
    WriteRegisterWord(RegisterType::SP, 0xDD25);
    WriteRegisterByte(RegisterType::A, 0x31);
    WriteRegisterByte(RegisterType::B, 0x2B);
    WriteRegisterByte(RegisterType::C, 0xBA);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0xD9);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x5A);
    WriteRegisterByte(RegisterType::L, 0x7C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDD26, 0x62);
    WriteMemory(0xDD25, 0x4D);
    WriteMemory(0x8007, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x31);
    CheckRegisterByte(RegisterType::B, 0x2B);
    CheckRegisterByte(RegisterType::C, 0xBA);
    CheckRegisterByte(RegisterType::D, 0x62);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x5A);
    CheckRegisterByte(RegisterType::L, 0x7C);
    CheckRegisterWord(RegisterType::PC, 0x8008);
    CheckRegisterWord(RegisterType::SP, 0xDD27);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8007, 0xD1);
    CheckMemory(0xDD25, 0x4D);
    CheckMemory(0xDD26, 0x62);
}

void test_D1_0170()
{
    if (skip_test_D1_0170)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBF65);
    WriteRegisterWord(RegisterType::SP, 0x844A);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0xD6);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x68);
    WriteRegisterByte(RegisterType::E, 0x15);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xC5);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBF65, 0xD1);
    WriteMemory(0x844B, 0xBB);
    WriteMemory(0x844A, 0xC4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0xD6);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0xBB);
    CheckRegisterByte(RegisterType::E, 0xC4);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xC5);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0xBF66);
    CheckRegisterWord(RegisterType::SP, 0x844C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x844A, 0xC4);
    CheckMemory(0x844B, 0xBB);
    CheckMemory(0xBF65, 0xD1);
}

void test_D1_0171()
{
    if (skip_test_D1_0171)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBDF2);
    WriteRegisterWord(RegisterType::SP, 0xA19C);
    WriteRegisterByte(RegisterType::A, 0x3E);
    WriteRegisterByte(RegisterType::B, 0x34);
    WriteRegisterByte(RegisterType::C, 0x05);
    WriteRegisterByte(RegisterType::D, 0x79);
    WriteRegisterByte(RegisterType::E, 0x47);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x85);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBDF2, 0xD1);
    WriteMemory(0xA19D, 0xC3);
    WriteMemory(0xA19C, 0xA6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3E);
    CheckRegisterByte(RegisterType::B, 0x34);
    CheckRegisterByte(RegisterType::C, 0x05);
    CheckRegisterByte(RegisterType::D, 0xC3);
    CheckRegisterByte(RegisterType::E, 0xA6);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x85);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0xBDF3);
    CheckRegisterWord(RegisterType::SP, 0xA19E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA19C, 0xA6);
    CheckMemory(0xA19D, 0xC3);
    CheckMemory(0xBDF2, 0xD1);
}

void test_D1_0172()
{
    if (skip_test_D1_0172)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA9A5);
    WriteRegisterWord(RegisterType::SP, 0xD2CA);
    WriteRegisterByte(RegisterType::A, 0x41);
    WriteRegisterByte(RegisterType::B, 0x94);
    WriteRegisterByte(RegisterType::C, 0x1A);
    WriteRegisterByte(RegisterType::D, 0x66);
    WriteRegisterByte(RegisterType::E, 0xAD);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xBA);
    WriteRegisterByte(RegisterType::L, 0xD0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD2CB, 0x3C);
    WriteMemory(0xD2CA, 0xFE);
    WriteMemory(0xA9A5, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x41);
    CheckRegisterByte(RegisterType::B, 0x94);
    CheckRegisterByte(RegisterType::C, 0x1A);
    CheckRegisterByte(RegisterType::D, 0x3C);
    CheckRegisterByte(RegisterType::E, 0xFE);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xBA);
    CheckRegisterByte(RegisterType::L, 0xD0);
    CheckRegisterWord(RegisterType::PC, 0xA9A6);
    CheckRegisterWord(RegisterType::SP, 0xD2CC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA9A5, 0xD1);
    CheckMemory(0xD2CA, 0xFE);
    CheckMemory(0xD2CB, 0x3C);
}

void test_D1_0173()
{
    if (skip_test_D1_0173)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6752);
    WriteRegisterWord(RegisterType::SP, 0xCFE4);
    WriteRegisterByte(RegisterType::A, 0x77);
    WriteRegisterByte(RegisterType::B, 0x8D);
    WriteRegisterByte(RegisterType::C, 0x33);
    WriteRegisterByte(RegisterType::D, 0x95);
    WriteRegisterByte(RegisterType::E, 0xDA);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x8E);
    WriteRegisterByte(RegisterType::L, 0x24);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCFE5, 0xF7);
    WriteMemory(0xCFE4, 0xE5);
    WriteMemory(0x6752, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x77);
    CheckRegisterByte(RegisterType::B, 0x8D);
    CheckRegisterByte(RegisterType::C, 0x33);
    CheckRegisterByte(RegisterType::D, 0xF7);
    CheckRegisterByte(RegisterType::E, 0xE5);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x8E);
    CheckRegisterByte(RegisterType::L, 0x24);
    CheckRegisterWord(RegisterType::PC, 0x6753);
    CheckRegisterWord(RegisterType::SP, 0xCFE6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6752, 0xD1);
    CheckMemory(0xCFE4, 0xE5);
    CheckMemory(0xCFE5, 0xF7);
}

void test_D1_0174()
{
    if (skip_test_D1_0174)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8019);
    WriteRegisterWord(RegisterType::SP, 0xD1CD);
    WriteRegisterByte(RegisterType::A, 0x5D);
    WriteRegisterByte(RegisterType::B, 0x6D);
    WriteRegisterByte(RegisterType::C, 0xB5);
    WriteRegisterByte(RegisterType::D, 0x33);
    WriteRegisterByte(RegisterType::E, 0xC6);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xB2);
    WriteRegisterByte(RegisterType::L, 0x86);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD1CE, 0xD5);
    WriteMemory(0xD1CD, 0xEC);
    WriteMemory(0x8019, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5D);
    CheckRegisterByte(RegisterType::B, 0x6D);
    CheckRegisterByte(RegisterType::C, 0xB5);
    CheckRegisterByte(RegisterType::D, 0xD5);
    CheckRegisterByte(RegisterType::E, 0xEC);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xB2);
    CheckRegisterByte(RegisterType::L, 0x86);
    CheckRegisterWord(RegisterType::PC, 0x801A);
    CheckRegisterWord(RegisterType::SP, 0xD1CF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8019, 0xD1);
    CheckMemory(0xD1CD, 0xEC);
    CheckMemory(0xD1CE, 0xD5);
}

void test_D1_0175()
{
    if (skip_test_D1_0175)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7419);
    WriteRegisterWord(RegisterType::SP, 0x69CD);
    WriteRegisterByte(RegisterType::A, 0x49);
    WriteRegisterByte(RegisterType::B, 0x01);
    WriteRegisterByte(RegisterType::C, 0x02);
    WriteRegisterByte(RegisterType::D, 0x58);
    WriteRegisterByte(RegisterType::E, 0xB3);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0x7A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7419, 0xD1);
    WriteMemory(0x69CE, 0xED);
    WriteMemory(0x69CD, 0xE6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x49);
    CheckRegisterByte(RegisterType::B, 0x01);
    CheckRegisterByte(RegisterType::C, 0x02);
    CheckRegisterByte(RegisterType::D, 0xED);
    CheckRegisterByte(RegisterType::E, 0xE6);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0x7A);
    CheckRegisterWord(RegisterType::PC, 0x741A);
    CheckRegisterWord(RegisterType::SP, 0x69CF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x69CD, 0xE6);
    CheckMemory(0x69CE, 0xED);
    CheckMemory(0x7419, 0xD1);
}

void test_D1_0176()
{
    if (skip_test_D1_0176)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC751);
    WriteRegisterWord(RegisterType::SP, 0xC6B5);
    WriteRegisterByte(RegisterType::A, 0xB1);
    WriteRegisterByte(RegisterType::B, 0x2F);
    WriteRegisterByte(RegisterType::C, 0x63);
    WriteRegisterByte(RegisterType::D, 0x50);
    WriteRegisterByte(RegisterType::E, 0x77);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x0B);
    WriteRegisterByte(RegisterType::L, 0x7E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC751, 0xD1);
    WriteMemory(0xC6B6, 0x8A);
    WriteMemory(0xC6B5, 0x6F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB1);
    CheckRegisterByte(RegisterType::B, 0x2F);
    CheckRegisterByte(RegisterType::C, 0x63);
    CheckRegisterByte(RegisterType::D, 0x8A);
    CheckRegisterByte(RegisterType::E, 0x6F);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x0B);
    CheckRegisterByte(RegisterType::L, 0x7E);
    CheckRegisterWord(RegisterType::PC, 0xC752);
    CheckRegisterWord(RegisterType::SP, 0xC6B7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC6B5, 0x6F);
    CheckMemory(0xC6B6, 0x8A);
    CheckMemory(0xC751, 0xD1);
}

void test_D1_0177()
{
    if (skip_test_D1_0177)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x46B5);
    WriteRegisterWord(RegisterType::SP, 0xC3B2);
    WriteRegisterByte(RegisterType::A, 0x42);
    WriteRegisterByte(RegisterType::B, 0xD2);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0x1A);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xC1);
    WriteRegisterByte(RegisterType::L, 0x3E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC3B3, 0x55);
    WriteMemory(0xC3B2, 0x72);
    WriteMemory(0x46B5, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x42);
    CheckRegisterByte(RegisterType::B, 0xD2);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0x55);
    CheckRegisterByte(RegisterType::E, 0x72);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xC1);
    CheckRegisterByte(RegisterType::L, 0x3E);
    CheckRegisterWord(RegisterType::PC, 0x46B6);
    CheckRegisterWord(RegisterType::SP, 0xC3B4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x46B5, 0xD1);
    CheckMemory(0xC3B2, 0x72);
    CheckMemory(0xC3B3, 0x55);
}

void test_D1_0178()
{
    if (skip_test_D1_0178)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9AA9);
    WriteRegisterWord(RegisterType::SP, 0x6736);
    WriteRegisterByte(RegisterType::A, 0x39);
    WriteRegisterByte(RegisterType::B, 0x78);
    WriteRegisterByte(RegisterType::C, 0xE1);
    WriteRegisterByte(RegisterType::D, 0xF7);
    WriteRegisterByte(RegisterType::E, 0xF7);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xE5);
    WriteRegisterByte(RegisterType::L, 0x37);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9AA9, 0xD1);
    WriteMemory(0x6737, 0x2E);
    WriteMemory(0x6736, 0x2D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x39);
    CheckRegisterByte(RegisterType::B, 0x78);
    CheckRegisterByte(RegisterType::C, 0xE1);
    CheckRegisterByte(RegisterType::D, 0x2E);
    CheckRegisterByte(RegisterType::E, 0x2D);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xE5);
    CheckRegisterByte(RegisterType::L, 0x37);
    CheckRegisterWord(RegisterType::PC, 0x9AAA);
    CheckRegisterWord(RegisterType::SP, 0x6738);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6736, 0x2D);
    CheckMemory(0x6737, 0x2E);
    CheckMemory(0x9AA9, 0xD1);
}

void test_D1_0179()
{
    if (skip_test_D1_0179)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4513);
    WriteRegisterWord(RegisterType::SP, 0x86BC);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0xD9);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0xE8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x86BD, 0x47);
    WriteMemory(0x86BC, 0x0C);
    WriteMemory(0x4513, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0xD9);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0x47);
    CheckRegisterByte(RegisterType::E, 0x0C);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0xE8);
    CheckRegisterWord(RegisterType::PC, 0x4514);
    CheckRegisterWord(RegisterType::SP, 0x86BE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4513, 0xD1);
    CheckMemory(0x86BC, 0x0C);
    CheckMemory(0x86BD, 0x47);
}

void test_D1_017A()
{
    if (skip_test_D1_017A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD340);
    WriteRegisterWord(RegisterType::SP, 0xBEFA);
    WriteRegisterByte(RegisterType::A, 0xFF);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0xBE);
    WriteRegisterByte(RegisterType::D, 0x54);
    WriteRegisterByte(RegisterType::E, 0x3C);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xBD);
    WriteRegisterByte(RegisterType::L, 0xA0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD340, 0xD1);
    WriteMemory(0xBEFB, 0x8B);
    WriteMemory(0xBEFA, 0x24);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFF);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0xBE);
    CheckRegisterByte(RegisterType::D, 0x8B);
    CheckRegisterByte(RegisterType::E, 0x24);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xBD);
    CheckRegisterByte(RegisterType::L, 0xA0);
    CheckRegisterWord(RegisterType::PC, 0xD341);
    CheckRegisterWord(RegisterType::SP, 0xBEFC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBEFA, 0x24);
    CheckMemory(0xBEFB, 0x8B);
    CheckMemory(0xD340, 0xD1);
}

void test_D1_017B()
{
    if (skip_test_D1_017B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x29F3);
    WriteRegisterWord(RegisterType::SP, 0xC24D);
    WriteRegisterByte(RegisterType::A, 0xD3);
    WriteRegisterByte(RegisterType::B, 0xE8);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0xB2);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x55);
    WriteRegisterByte(RegisterType::L, 0xAC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC24E, 0x12);
    WriteMemory(0xC24D, 0x57);
    WriteMemory(0x29F3, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD3);
    CheckRegisterByte(RegisterType::B, 0xE8);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0x12);
    CheckRegisterByte(RegisterType::E, 0x57);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x55);
    CheckRegisterByte(RegisterType::L, 0xAC);
    CheckRegisterWord(RegisterType::PC, 0x29F4);
    CheckRegisterWord(RegisterType::SP, 0xC24F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x29F3, 0xD1);
    CheckMemory(0xC24D, 0x57);
    CheckMemory(0xC24E, 0x12);
}

void test_D1_017C()
{
    if (skip_test_D1_017C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDB57);
    WriteRegisterWord(RegisterType::SP, 0x5A50);
    WriteRegisterByte(RegisterType::A, 0xB6);
    WriteRegisterByte(RegisterType::B, 0x9C);
    WriteRegisterByte(RegisterType::C, 0x01);
    WriteRegisterByte(RegisterType::D, 0x94);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDB57, 0xD1);
    WriteMemory(0x5A51, 0x35);
    WriteMemory(0x5A50, 0xB3);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB6);
    CheckRegisterByte(RegisterType::B, 0x9C);
    CheckRegisterByte(RegisterType::C, 0x01);
    CheckRegisterByte(RegisterType::D, 0x35);
    CheckRegisterByte(RegisterType::E, 0xB3);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0xDB58);
    CheckRegisterWord(RegisterType::SP, 0x5A52);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5A50, 0xB3);
    CheckMemory(0x5A51, 0x35);
    CheckMemory(0xDB57, 0xD1);
}

void test_D1_017D()
{
    if (skip_test_D1_017D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1B70);
    WriteRegisterWord(RegisterType::SP, 0xB81C);
    WriteRegisterByte(RegisterType::A, 0x52);
    WriteRegisterByte(RegisterType::B, 0x95);
    WriteRegisterByte(RegisterType::C, 0xEB);
    WriteRegisterByte(RegisterType::D, 0xEF);
    WriteRegisterByte(RegisterType::E, 0xF7);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xF1);
    WriteRegisterByte(RegisterType::L, 0x5C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB81D, 0x3E);
    WriteMemory(0xB81C, 0x12);
    WriteMemory(0x1B70, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x52);
    CheckRegisterByte(RegisterType::B, 0x95);
    CheckRegisterByte(RegisterType::C, 0xEB);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xF1);
    CheckRegisterByte(RegisterType::L, 0x5C);
    CheckRegisterWord(RegisterType::PC, 0x1B71);
    CheckRegisterWord(RegisterType::SP, 0xB81E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1B70, 0xD1);
    CheckMemory(0xB81C, 0x12);
    CheckMemory(0xB81D, 0x3E);
}

void test_D1_017E()
{
    if (skip_test_D1_017E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF46C);
    WriteRegisterWord(RegisterType::SP, 0x8510);
    WriteRegisterByte(RegisterType::A, 0x2C);
    WriteRegisterByte(RegisterType::B, 0x35);
    WriteRegisterByte(RegisterType::C, 0xA9);
    WriteRegisterByte(RegisterType::D, 0x08);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x31);
    WriteRegisterByte(RegisterType::L, 0x74);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF46C, 0xD1);
    WriteMemory(0x8511, 0xB6);
    WriteMemory(0x8510, 0x48);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2C);
    CheckRegisterByte(RegisterType::B, 0x35);
    CheckRegisterByte(RegisterType::C, 0xA9);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0x48);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x31);
    CheckRegisterByte(RegisterType::L, 0x74);
    CheckRegisterWord(RegisterType::PC, 0xF46D);
    CheckRegisterWord(RegisterType::SP, 0x8512);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8510, 0x48);
    CheckMemory(0x8511, 0xB6);
    CheckMemory(0xF46C, 0xD1);
}

void test_D1_017F()
{
    if (skip_test_D1_017F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9638);
    WriteRegisterWord(RegisterType::SP, 0x0FF0);
    WriteRegisterByte(RegisterType::A, 0x88);
    WriteRegisterByte(RegisterType::B, 0x7B);
    WriteRegisterByte(RegisterType::C, 0x79);
    WriteRegisterByte(RegisterType::D, 0x9D);
    WriteRegisterByte(RegisterType::E, 0x8C);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x9F);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9638, 0xD1);
    WriteMemory(0x0FF1, 0xFA);
    WriteMemory(0x0FF0, 0x03);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x88);
    CheckRegisterByte(RegisterType::B, 0x7B);
    CheckRegisterByte(RegisterType::C, 0x79);
    CheckRegisterByte(RegisterType::D, 0xFA);
    CheckRegisterByte(RegisterType::E, 0x03);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x9F);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0x9639);
    CheckRegisterWord(RegisterType::SP, 0x0FF2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0FF0, 0x03);
    CheckMemory(0x0FF1, 0xFA);
    CheckMemory(0x9638, 0xD1);
}

void test_D1_0180()
{
    if (skip_test_D1_0180)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x104B);
    WriteRegisterWord(RegisterType::SP, 0x9565);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0xFE);
    WriteRegisterByte(RegisterType::C, 0xA7);
    WriteRegisterByte(RegisterType::D, 0xB1);
    WriteRegisterByte(RegisterType::E, 0x64);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x08);
    WriteRegisterByte(RegisterType::L, 0xEF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9566, 0xDD);
    WriteMemory(0x9565, 0x3B);
    WriteMemory(0x104B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0xFE);
    CheckRegisterByte(RegisterType::C, 0xA7);
    CheckRegisterByte(RegisterType::D, 0xDD);
    CheckRegisterByte(RegisterType::E, 0x3B);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x08);
    CheckRegisterByte(RegisterType::L, 0xEF);
    CheckRegisterWord(RegisterType::PC, 0x104C);
    CheckRegisterWord(RegisterType::SP, 0x9567);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x104B, 0xD1);
    CheckMemory(0x9565, 0x3B);
    CheckMemory(0x9566, 0xDD);
}

void test_D1_0181()
{
    if (skip_test_D1_0181)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8A85);
    WriteRegisterWord(RegisterType::SP, 0x3BCD);
    WriteRegisterByte(RegisterType::A, 0x93);
    WriteRegisterByte(RegisterType::B, 0x6D);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0x20);
    WriteRegisterByte(RegisterType::E, 0xA0);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x3A);
    WriteRegisterByte(RegisterType::L, 0xC0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8A85, 0xD1);
    WriteMemory(0x3BCE, 0xBF);
    WriteMemory(0x3BCD, 0xC1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x93);
    CheckRegisterByte(RegisterType::B, 0x6D);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0xBF);
    CheckRegisterByte(RegisterType::E, 0xC1);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x3A);
    CheckRegisterByte(RegisterType::L, 0xC0);
    CheckRegisterWord(RegisterType::PC, 0x8A86);
    CheckRegisterWord(RegisterType::SP, 0x3BCF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3BCD, 0xC1);
    CheckMemory(0x3BCE, 0xBF);
    CheckMemory(0x8A85, 0xD1);
}

void test_D1_0182()
{
    if (skip_test_D1_0182)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEB88);
    WriteRegisterWord(RegisterType::SP, 0x56E8);
    WriteRegisterByte(RegisterType::A, 0x8E);
    WriteRegisterByte(RegisterType::B, 0xEA);
    WriteRegisterByte(RegisterType::C, 0x4F);
    WriteRegisterByte(RegisterType::D, 0x9D);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x69);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEB88, 0xD1);
    WriteMemory(0x56E9, 0xEE);
    WriteMemory(0x56E8, 0xD6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8E);
    CheckRegisterByte(RegisterType::B, 0xEA);
    CheckRegisterByte(RegisterType::C, 0x4F);
    CheckRegisterByte(RegisterType::D, 0xEE);
    CheckRegisterByte(RegisterType::E, 0xD6);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x69);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0xEB89);
    CheckRegisterWord(RegisterType::SP, 0x56EA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x56E8, 0xD6);
    CheckMemory(0x56E9, 0xEE);
    CheckMemory(0xEB88, 0xD1);
}

void test_D1_0183()
{
    if (skip_test_D1_0183)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5D9D);
    WriteRegisterWord(RegisterType::SP, 0xE27A);
    WriteRegisterByte(RegisterType::A, 0xCF);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0xCA);
    WriteRegisterByte(RegisterType::D, 0x37);
    WriteRegisterByte(RegisterType::E, 0xC1);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xA1);
    WriteRegisterByte(RegisterType::L, 0x07);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE27B, 0x9C);
    WriteMemory(0xE27A, 0x6B);
    WriteMemory(0x5D9D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCF);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0xCA);
    CheckRegisterByte(RegisterType::D, 0x9C);
    CheckRegisterByte(RegisterType::E, 0x6B);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xA1);
    CheckRegisterByte(RegisterType::L, 0x07);
    CheckRegisterWord(RegisterType::PC, 0x5D9E);
    CheckRegisterWord(RegisterType::SP, 0xE27C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5D9D, 0xD1);
    CheckMemory(0xE27A, 0x6B);
    CheckMemory(0xE27B, 0x9C);
}

void test_D1_0184()
{
    if (skip_test_D1_0184)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x973A);
    WriteRegisterWord(RegisterType::SP, 0xAF52);
    WriteRegisterByte(RegisterType::A, 0xE5);
    WriteRegisterByte(RegisterType::B, 0x27);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0x56);
    WriteRegisterByte(RegisterType::E, 0xDA);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xA8);
    WriteRegisterByte(RegisterType::L, 0x9B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAF53, 0x2E);
    WriteMemory(0xAF52, 0x3E);
    WriteMemory(0x973A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE5);
    CheckRegisterByte(RegisterType::B, 0x27);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0x2E);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xA8);
    CheckRegisterByte(RegisterType::L, 0x9B);
    CheckRegisterWord(RegisterType::PC, 0x973B);
    CheckRegisterWord(RegisterType::SP, 0xAF54);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x973A, 0xD1);
    CheckMemory(0xAF52, 0x3E);
    CheckMemory(0xAF53, 0x2E);
}

void test_D1_0185()
{
    if (skip_test_D1_0185)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6F77);
    WriteRegisterWord(RegisterType::SP, 0x960F);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0xCE);
    WriteRegisterByte(RegisterType::C, 0x0D);
    WriteRegisterByte(RegisterType::D, 0xBF);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9610, 0x37);
    WriteMemory(0x960F, 0x58);
    WriteMemory(0x6F77, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0xCE);
    CheckRegisterByte(RegisterType::C, 0x0D);
    CheckRegisterByte(RegisterType::D, 0x37);
    CheckRegisterByte(RegisterType::E, 0x58);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0x6F78);
    CheckRegisterWord(RegisterType::SP, 0x9611);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6F77, 0xD1);
    CheckMemory(0x960F, 0x58);
    CheckMemory(0x9610, 0x37);
}

void test_D1_0186()
{
    if (skip_test_D1_0186)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9B50);
    WriteRegisterWord(RegisterType::SP, 0x6BD6);
    WriteRegisterByte(RegisterType::A, 0xF9);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x05);
    WriteRegisterByte(RegisterType::D, 0x88);
    WriteRegisterByte(RegisterType::E, 0x20);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xE2);
    WriteRegisterByte(RegisterType::L, 0x33);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9B50, 0xD1);
    WriteMemory(0x6BD7, 0x7A);
    WriteMemory(0x6BD6, 0xE7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF9);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x05);
    CheckRegisterByte(RegisterType::D, 0x7A);
    CheckRegisterByte(RegisterType::E, 0xE7);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xE2);
    CheckRegisterByte(RegisterType::L, 0x33);
    CheckRegisterWord(RegisterType::PC, 0x9B51);
    CheckRegisterWord(RegisterType::SP, 0x6BD8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6BD6, 0xE7);
    CheckMemory(0x6BD7, 0x7A);
    CheckMemory(0x9B50, 0xD1);
}

void test_D1_0187()
{
    if (skip_test_D1_0187)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x10AE);
    WriteRegisterWord(RegisterType::SP, 0xFB1A);
    WriteRegisterByte(RegisterType::A, 0x83);
    WriteRegisterByte(RegisterType::B, 0x6E);
    WriteRegisterByte(RegisterType::C, 0x8D);
    WriteRegisterByte(RegisterType::D, 0x12);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x1F);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFB1B, 0x75);
    WriteMemory(0xFB1A, 0x2D);
    WriteMemory(0x10AE, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x83);
    CheckRegisterByte(RegisterType::B, 0x6E);
    CheckRegisterByte(RegisterType::C, 0x8D);
    CheckRegisterByte(RegisterType::D, 0x75);
    CheckRegisterByte(RegisterType::E, 0x2D);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x1F);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0x10AF);
    CheckRegisterWord(RegisterType::SP, 0xFB1C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x10AE, 0xD1);
    CheckMemory(0xFB1A, 0x2D);
    CheckMemory(0xFB1B, 0x75);
}

void test_D1_0188()
{
    if (skip_test_D1_0188)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x761A);
    WriteRegisterWord(RegisterType::SP, 0x5195);
    WriteRegisterByte(RegisterType::A, 0x51);
    WriteRegisterByte(RegisterType::B, 0x8C);
    WriteRegisterByte(RegisterType::C, 0xD4);
    WriteRegisterByte(RegisterType::D, 0xC5);
    WriteRegisterByte(RegisterType::E, 0x44);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x761A, 0xD1);
    WriteMemory(0x5196, 0x50);
    WriteMemory(0x5195, 0xEF);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x51);
    CheckRegisterByte(RegisterType::B, 0x8C);
    CheckRegisterByte(RegisterType::C, 0xD4);
    CheckRegisterByte(RegisterType::D, 0x50);
    CheckRegisterByte(RegisterType::E, 0xEF);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0x761B);
    CheckRegisterWord(RegisterType::SP, 0x5197);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5195, 0xEF);
    CheckMemory(0x5196, 0x50);
    CheckMemory(0x761A, 0xD1);
}

void test_D1_0189()
{
    if (skip_test_D1_0189)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA80F);
    WriteRegisterWord(RegisterType::SP, 0x6AB7);
    WriteRegisterByte(RegisterType::A, 0x6B);
    WriteRegisterByte(RegisterType::B, 0x08);
    WriteRegisterByte(RegisterType::C, 0x07);
    WriteRegisterByte(RegisterType::D, 0x6E);
    WriteRegisterByte(RegisterType::E, 0xC1);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x92);
    WriteRegisterByte(RegisterType::L, 0xA4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA80F, 0xD1);
    WriteMemory(0x6AB8, 0xD7);
    WriteMemory(0x6AB7, 0x17);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6B);
    CheckRegisterByte(RegisterType::B, 0x08);
    CheckRegisterByte(RegisterType::C, 0x07);
    CheckRegisterByte(RegisterType::D, 0xD7);
    CheckRegisterByte(RegisterType::E, 0x17);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x92);
    CheckRegisterByte(RegisterType::L, 0xA4);
    CheckRegisterWord(RegisterType::PC, 0xA810);
    CheckRegisterWord(RegisterType::SP, 0x6AB9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6AB7, 0x17);
    CheckMemory(0x6AB8, 0xD7);
    CheckMemory(0xA80F, 0xD1);
}

void test_D1_018A()
{
    if (skip_test_D1_018A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2A54);
    WriteRegisterWord(RegisterType::SP, 0x72FD);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0x78);
    WriteRegisterByte(RegisterType::D, 0x52);
    WriteRegisterByte(RegisterType::E, 0x89);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x9A);
    WriteRegisterByte(RegisterType::L, 0x41);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x72FE, 0x9D);
    WriteMemory(0x72FD, 0x47);
    WriteMemory(0x2A54, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0x78);
    CheckRegisterByte(RegisterType::D, 0x9D);
    CheckRegisterByte(RegisterType::E, 0x47);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x9A);
    CheckRegisterByte(RegisterType::L, 0x41);
    CheckRegisterWord(RegisterType::PC, 0x2A55);
    CheckRegisterWord(RegisterType::SP, 0x72FF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2A54, 0xD1);
    CheckMemory(0x72FD, 0x47);
    CheckMemory(0x72FE, 0x9D);
}

void test_D1_018B()
{
    if (skip_test_D1_018B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBCBD);
    WriteRegisterWord(RegisterType::SP, 0x2E16);
    WriteRegisterByte(RegisterType::A, 0x4E);
    WriteRegisterByte(RegisterType::B, 0x37);
    WriteRegisterByte(RegisterType::C, 0xB4);
    WriteRegisterByte(RegisterType::D, 0x17);
    WriteRegisterByte(RegisterType::E, 0x87);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xE3);
    WriteRegisterByte(RegisterType::L, 0x8A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBCBD, 0xD1);
    WriteMemory(0x2E17, 0xFD);
    WriteMemory(0x2E16, 0xB0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4E);
    CheckRegisterByte(RegisterType::B, 0x37);
    CheckRegisterByte(RegisterType::C, 0xB4);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xE3);
    CheckRegisterByte(RegisterType::L, 0x8A);
    CheckRegisterWord(RegisterType::PC, 0xBCBE);
    CheckRegisterWord(RegisterType::SP, 0x2E18);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2E16, 0xB0);
    CheckMemory(0x2E17, 0xFD);
    CheckMemory(0xBCBD, 0xD1);
}

void test_D1_018C()
{
    if (skip_test_D1_018C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9431);
    WriteRegisterWord(RegisterType::SP, 0xC057);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0xD1);
    WriteRegisterByte(RegisterType::C, 0x39);
    WriteRegisterByte(RegisterType::D, 0x8F);
    WriteRegisterByte(RegisterType::E, 0x72);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x91);
    WriteRegisterByte(RegisterType::L, 0xFE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC058, 0x98);
    WriteMemory(0xC057, 0x50);
    WriteMemory(0x9431, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0xD1);
    CheckRegisterByte(RegisterType::C, 0x39);
    CheckRegisterByte(RegisterType::D, 0x98);
    CheckRegisterByte(RegisterType::E, 0x50);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x91);
    CheckRegisterByte(RegisterType::L, 0xFE);
    CheckRegisterWord(RegisterType::PC, 0x9432);
    CheckRegisterWord(RegisterType::SP, 0xC059);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9431, 0xD1);
    CheckMemory(0xC057, 0x50);
    CheckMemory(0xC058, 0x98);
}

void test_D1_018D()
{
    if (skip_test_D1_018D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5437);
    WriteRegisterWord(RegisterType::SP, 0xA809);
    WriteRegisterByte(RegisterType::A, 0x59);
    WriteRegisterByte(RegisterType::B, 0xE4);
    WriteRegisterByte(RegisterType::C, 0xF4);
    WriteRegisterByte(RegisterType::D, 0xCA);
    WriteRegisterByte(RegisterType::E, 0xDF);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x49);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA80A, 0x3B);
    WriteMemory(0xA809, 0xE8);
    WriteMemory(0x5437, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x59);
    CheckRegisterByte(RegisterType::B, 0xE4);
    CheckRegisterByte(RegisterType::C, 0xF4);
    CheckRegisterByte(RegisterType::D, 0x3B);
    CheckRegisterByte(RegisterType::E, 0xE8);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x49);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0x5438);
    CheckRegisterWord(RegisterType::SP, 0xA80B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5437, 0xD1);
    CheckMemory(0xA809, 0xE8);
    CheckMemory(0xA80A, 0x3B);
}

void test_D1_018E()
{
    if (skip_test_D1_018E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2E60);
    WriteRegisterWord(RegisterType::SP, 0xE1BA);
    WriteRegisterByte(RegisterType::A, 0x2F);
    WriteRegisterByte(RegisterType::B, 0x3F);
    WriteRegisterByte(RegisterType::C, 0x41);
    WriteRegisterByte(RegisterType::D, 0xBF);
    WriteRegisterByte(RegisterType::E, 0xA4);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0x4E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE1BB, 0x5F);
    WriteMemory(0xE1BA, 0x9C);
    WriteMemory(0x2E60, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2F);
    CheckRegisterByte(RegisterType::B, 0x3F);
    CheckRegisterByte(RegisterType::C, 0x41);
    CheckRegisterByte(RegisterType::D, 0x5F);
    CheckRegisterByte(RegisterType::E, 0x9C);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0x4E);
    CheckRegisterWord(RegisterType::PC, 0x2E61);
    CheckRegisterWord(RegisterType::SP, 0xE1BC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2E60, 0xD1);
    CheckMemory(0xE1BA, 0x9C);
    CheckMemory(0xE1BB, 0x5F);
}

void test_D1_018F()
{
    if (skip_test_D1_018F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9469);
    WriteRegisterWord(RegisterType::SP, 0xF17C);
    WriteRegisterByte(RegisterType::A, 0x09);
    WriteRegisterByte(RegisterType::B, 0xD0);
    WriteRegisterByte(RegisterType::C, 0x98);
    WriteRegisterByte(RegisterType::D, 0x63);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x23);
    WriteRegisterByte(RegisterType::L, 0x37);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF17D, 0x8B);
    WriteMemory(0xF17C, 0x03);
    WriteMemory(0x9469, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x09);
    CheckRegisterByte(RegisterType::B, 0xD0);
    CheckRegisterByte(RegisterType::C, 0x98);
    CheckRegisterByte(RegisterType::D, 0x8B);
    CheckRegisterByte(RegisterType::E, 0x03);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x23);
    CheckRegisterByte(RegisterType::L, 0x37);
    CheckRegisterWord(RegisterType::PC, 0x946A);
    CheckRegisterWord(RegisterType::SP, 0xF17E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9469, 0xD1);
    CheckMemory(0xF17C, 0x03);
    CheckMemory(0xF17D, 0x8B);
}

void test_D1_0190()
{
    if (skip_test_D1_0190)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD749);
    WriteRegisterWord(RegisterType::SP, 0x49E0);
    WriteRegisterByte(RegisterType::A, 0x6A);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0x50);
    WriteRegisterByte(RegisterType::D, 0x6F);
    WriteRegisterByte(RegisterType::E, 0x2F);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x73);
    WriteRegisterByte(RegisterType::L, 0x2C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD749, 0xD1);
    WriteMemory(0x49E1, 0xB9);
    WriteMemory(0x49E0, 0x26);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6A);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0x50);
    CheckRegisterByte(RegisterType::D, 0xB9);
    CheckRegisterByte(RegisterType::E, 0x26);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x73);
    CheckRegisterByte(RegisterType::L, 0x2C);
    CheckRegisterWord(RegisterType::PC, 0xD74A);
    CheckRegisterWord(RegisterType::SP, 0x49E2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x49E0, 0x26);
    CheckMemory(0x49E1, 0xB9);
    CheckMemory(0xD749, 0xD1);
}

void test_D1_0191()
{
    if (skip_test_D1_0191)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6DBA);
    WriteRegisterWord(RegisterType::SP, 0x642F);
    WriteRegisterByte(RegisterType::A, 0x57);
    WriteRegisterByte(RegisterType::B, 0x08);
    WriteRegisterByte(RegisterType::C, 0x21);
    WriteRegisterByte(RegisterType::D, 0x66);
    WriteRegisterByte(RegisterType::E, 0x20);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xDA);
    WriteRegisterByte(RegisterType::L, 0x08);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6DBA, 0xD1);
    WriteMemory(0x6430, 0x2B);
    WriteMemory(0x642F, 0xA4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x57);
    CheckRegisterByte(RegisterType::B, 0x08);
    CheckRegisterByte(RegisterType::C, 0x21);
    CheckRegisterByte(RegisterType::D, 0x2B);
    CheckRegisterByte(RegisterType::E, 0xA4);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xDA);
    CheckRegisterByte(RegisterType::L, 0x08);
    CheckRegisterWord(RegisterType::PC, 0x6DBB);
    CheckRegisterWord(RegisterType::SP, 0x6431);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x642F, 0xA4);
    CheckMemory(0x6430, 0x2B);
    CheckMemory(0x6DBA, 0xD1);
}

void test_D1_0192()
{
    if (skip_test_D1_0192)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6738);
    WriteRegisterWord(RegisterType::SP, 0xA810);
    WriteRegisterByte(RegisterType::A, 0x7E);
    WriteRegisterByte(RegisterType::B, 0x45);
    WriteRegisterByte(RegisterType::C, 0x4D);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0x3F);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x05);
    WriteRegisterByte(RegisterType::L, 0x7F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA811, 0xCD);
    WriteMemory(0xA810, 0xAA);
    WriteMemory(0x6738, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7E);
    CheckRegisterByte(RegisterType::B, 0x45);
    CheckRegisterByte(RegisterType::C, 0x4D);
    CheckRegisterByte(RegisterType::D, 0xCD);
    CheckRegisterByte(RegisterType::E, 0xAA);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x05);
    CheckRegisterByte(RegisterType::L, 0x7F);
    CheckRegisterWord(RegisterType::PC, 0x6739);
    CheckRegisterWord(RegisterType::SP, 0xA812);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6738, 0xD1);
    CheckMemory(0xA810, 0xAA);
    CheckMemory(0xA811, 0xCD);
}

void test_D1_0193()
{
    if (skip_test_D1_0193)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8206);
    WriteRegisterWord(RegisterType::SP, 0x7430);
    WriteRegisterByte(RegisterType::A, 0xF1);
    WriteRegisterByte(RegisterType::B, 0x55);
    WriteRegisterByte(RegisterType::C, 0xD8);
    WriteRegisterByte(RegisterType::D, 0x6D);
    WriteRegisterByte(RegisterType::E, 0xC1);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x27);
    WriteRegisterByte(RegisterType::L, 0xD6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8206, 0xD1);
    WriteMemory(0x7431, 0xEC);
    WriteMemory(0x7430, 0x16);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF1);
    CheckRegisterByte(RegisterType::B, 0x55);
    CheckRegisterByte(RegisterType::C, 0xD8);
    CheckRegisterByte(RegisterType::D, 0xEC);
    CheckRegisterByte(RegisterType::E, 0x16);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x27);
    CheckRegisterByte(RegisterType::L, 0xD6);
    CheckRegisterWord(RegisterType::PC, 0x8207);
    CheckRegisterWord(RegisterType::SP, 0x7432);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7430, 0x16);
    CheckMemory(0x7431, 0xEC);
    CheckMemory(0x8206, 0xD1);
}

void test_D1_0194()
{
    if (skip_test_D1_0194)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x76B9);
    WriteRegisterWord(RegisterType::SP, 0x98E8);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0xAE);
    WriteRegisterByte(RegisterType::C, 0xF2);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0x07);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x58);
    WriteRegisterByte(RegisterType::L, 0xFF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x98E9, 0x0E);
    WriteMemory(0x98E8, 0x0B);
    WriteMemory(0x76B9, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0xAE);
    CheckRegisterByte(RegisterType::C, 0xF2);
    CheckRegisterByte(RegisterType::D, 0x0E);
    CheckRegisterByte(RegisterType::E, 0x0B);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x58);
    CheckRegisterByte(RegisterType::L, 0xFF);
    CheckRegisterWord(RegisterType::PC, 0x76BA);
    CheckRegisterWord(RegisterType::SP, 0x98EA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x76B9, 0xD1);
    CheckMemory(0x98E8, 0x0B);
    CheckMemory(0x98E9, 0x0E);
}

void test_D1_0195()
{
    if (skip_test_D1_0195)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4909);
    WriteRegisterWord(RegisterType::SP, 0xC915);
    WriteRegisterByte(RegisterType::A, 0xA4);
    WriteRegisterByte(RegisterType::B, 0x3D);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0x11);
    WriteRegisterByte(RegisterType::E, 0xD9);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC916, 0x8F);
    WriteMemory(0xC915, 0x8A);
    WriteMemory(0x4909, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA4);
    CheckRegisterByte(RegisterType::B, 0x3D);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0x8F);
    CheckRegisterByte(RegisterType::E, 0x8A);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0x490A);
    CheckRegisterWord(RegisterType::SP, 0xC917);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4909, 0xD1);
    CheckMemory(0xC915, 0x8A);
    CheckMemory(0xC916, 0x8F);
}

void test_D1_0196()
{
    if (skip_test_D1_0196)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB56A);
    WriteRegisterWord(RegisterType::SP, 0x7430);
    WriteRegisterByte(RegisterType::A, 0x57);
    WriteRegisterByte(RegisterType::B, 0x36);
    WriteRegisterByte(RegisterType::C, 0x98);
    WriteRegisterByte(RegisterType::D, 0xFA);
    WriteRegisterByte(RegisterType::E, 0x52);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x99);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB56A, 0xD1);
    WriteMemory(0x7431, 0xEC);
    WriteMemory(0x7430, 0x16);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x57);
    CheckRegisterByte(RegisterType::B, 0x36);
    CheckRegisterByte(RegisterType::C, 0x98);
    CheckRegisterByte(RegisterType::D, 0xEC);
    CheckRegisterByte(RegisterType::E, 0x16);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x99);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0xB56B);
    CheckRegisterWord(RegisterType::SP, 0x7432);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7430, 0x16);
    CheckMemory(0x7431, 0xEC);
    CheckMemory(0xB56A, 0xD1);
}

void test_D1_0197()
{
    if (skip_test_D1_0197)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF6FE);
    WriteRegisterWord(RegisterType::SP, 0xDA05);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0x56);
    WriteRegisterByte(RegisterType::D, 0xBE);
    WriteRegisterByte(RegisterType::E, 0x2B);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x50);
    WriteRegisterByte(RegisterType::L, 0xF1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF6FE, 0xD1);
    WriteMemory(0xDA06, 0x36);
    WriteMemory(0xDA05, 0x34);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0x56);
    CheckRegisterByte(RegisterType::D, 0x36);
    CheckRegisterByte(RegisterType::E, 0x34);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x50);
    CheckRegisterByte(RegisterType::L, 0xF1);
    CheckRegisterWord(RegisterType::PC, 0xF6FF);
    CheckRegisterWord(RegisterType::SP, 0xDA07);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDA05, 0x34);
    CheckMemory(0xDA06, 0x36);
    CheckMemory(0xF6FE, 0xD1);
}

void test_D1_0198()
{
    if (skip_test_D1_0198)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8EA4);
    WriteRegisterWord(RegisterType::SP, 0x08DA);
    WriteRegisterByte(RegisterType::A, 0x31);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0xFC);
    WriteRegisterByte(RegisterType::D, 0x8F);
    WriteRegisterByte(RegisterType::E, 0x93);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x93);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8EA4, 0xD1);
    WriteMemory(0x08DB, 0x1A);
    WriteMemory(0x08DA, 0x53);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x31);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0xFC);
    CheckRegisterByte(RegisterType::D, 0x1A);
    CheckRegisterByte(RegisterType::E, 0x53);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x93);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0x8EA5);
    CheckRegisterWord(RegisterType::SP, 0x08DC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x08DA, 0x53);
    CheckMemory(0x08DB, 0x1A);
    CheckMemory(0x8EA4, 0xD1);
}

void test_D1_0199()
{
    if (skip_test_D1_0199)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB705);
    WriteRegisterWord(RegisterType::SP, 0x3496);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0xC9);
    WriteRegisterByte(RegisterType::E, 0xA2);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x38);
    WriteRegisterByte(RegisterType::L, 0x6E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB705, 0xD1);
    WriteMemory(0x3497, 0x5B);
    WriteMemory(0x3496, 0xB0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0x5B);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x38);
    CheckRegisterByte(RegisterType::L, 0x6E);
    CheckRegisterWord(RegisterType::PC, 0xB706);
    CheckRegisterWord(RegisterType::SP, 0x3498);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3496, 0xB0);
    CheckMemory(0x3497, 0x5B);
    CheckMemory(0xB705, 0xD1);
}

void test_D1_019A()
{
    if (skip_test_D1_019A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x63DD);
    WriteRegisterWord(RegisterType::SP, 0xBD8E);
    WriteRegisterByte(RegisterType::A, 0x3B);
    WriteRegisterByte(RegisterType::B, 0xC2);
    WriteRegisterByte(RegisterType::C, 0x3C);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0x4C);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x4B);
    WriteRegisterByte(RegisterType::L, 0x93);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBD8F, 0x18);
    WriteMemory(0xBD8E, 0x83);
    WriteMemory(0x63DD, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3B);
    CheckRegisterByte(RegisterType::B, 0xC2);
    CheckRegisterByte(RegisterType::C, 0x3C);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0x83);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x4B);
    CheckRegisterByte(RegisterType::L, 0x93);
    CheckRegisterWord(RegisterType::PC, 0x63DE);
    CheckRegisterWord(RegisterType::SP, 0xBD90);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x63DD, 0xD1);
    CheckMemory(0xBD8E, 0x83);
    CheckMemory(0xBD8F, 0x18);
}

void test_D1_019B()
{
    if (skip_test_D1_019B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9D39);
    WriteRegisterWord(RegisterType::SP, 0x5FB8);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0x63);
    WriteRegisterByte(RegisterType::D, 0xC6);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0x50);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9D39, 0xD1);
    WriteMemory(0x5FB9, 0x6B);
    WriteMemory(0x5FB8, 0xAC);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0x63);
    CheckRegisterByte(RegisterType::D, 0x6B);
    CheckRegisterByte(RegisterType::E, 0xAC);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0x50);
    CheckRegisterWord(RegisterType::PC, 0x9D3A);
    CheckRegisterWord(RegisterType::SP, 0x5FBA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5FB8, 0xAC);
    CheckMemory(0x5FB9, 0x6B);
    CheckMemory(0x9D39, 0xD1);
}

void test_D1_019C()
{
    if (skip_test_D1_019C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAF1D);
    WriteRegisterWord(RegisterType::SP, 0xE645);
    WriteRegisterByte(RegisterType::A, 0x03);
    WriteRegisterByte(RegisterType::B, 0x2D);
    WriteRegisterByte(RegisterType::C, 0x38);
    WriteRegisterByte(RegisterType::D, 0x97);
    WriteRegisterByte(RegisterType::E, 0xD2);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x81);
    WriteRegisterByte(RegisterType::L, 0x86);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE646, 0x43);
    WriteMemory(0xE645, 0xA0);
    WriteMemory(0xAF1D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x03);
    CheckRegisterByte(RegisterType::B, 0x2D);
    CheckRegisterByte(RegisterType::C, 0x38);
    CheckRegisterByte(RegisterType::D, 0x43);
    CheckRegisterByte(RegisterType::E, 0xA0);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x81);
    CheckRegisterByte(RegisterType::L, 0x86);
    CheckRegisterWord(RegisterType::PC, 0xAF1E);
    CheckRegisterWord(RegisterType::SP, 0xE647);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAF1D, 0xD1);
    CheckMemory(0xE645, 0xA0);
    CheckMemory(0xE646, 0x43);
}

void test_D1_019D()
{
    if (skip_test_D1_019D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x332F);
    WriteRegisterWord(RegisterType::SP, 0xA998);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0xEF);
    WriteRegisterByte(RegisterType::C, 0x1B);
    WriteRegisterByte(RegisterType::D, 0x48);
    WriteRegisterByte(RegisterType::E, 0x33);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x4C);
    WriteRegisterByte(RegisterType::L, 0xDC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA999, 0xB7);
    WriteMemory(0xA998, 0x5E);
    WriteMemory(0x332F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0xEF);
    CheckRegisterByte(RegisterType::C, 0x1B);
    CheckRegisterByte(RegisterType::D, 0xB7);
    CheckRegisterByte(RegisterType::E, 0x5E);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x4C);
    CheckRegisterByte(RegisterType::L, 0xDC);
    CheckRegisterWord(RegisterType::PC, 0x3330);
    CheckRegisterWord(RegisterType::SP, 0xA99A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x332F, 0xD1);
    CheckMemory(0xA998, 0x5E);
    CheckMemory(0xA999, 0xB7);
}

void test_D1_019E()
{
    if (skip_test_D1_019E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEF47);
    WriteRegisterWord(RegisterType::SP, 0x3F76);
    WriteRegisterByte(RegisterType::A, 0xF8);
    WriteRegisterByte(RegisterType::B, 0x1F);
    WriteRegisterByte(RegisterType::C, 0x1D);
    WriteRegisterByte(RegisterType::D, 0xD0);
    WriteRegisterByte(RegisterType::E, 0x5D);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEF47, 0xD1);
    WriteMemory(0x3F77, 0x96);
    WriteMemory(0x3F76, 0x7F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF8);
    CheckRegisterByte(RegisterType::B, 0x1F);
    CheckRegisterByte(RegisterType::C, 0x1D);
    CheckRegisterByte(RegisterType::D, 0x96);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0xEF48);
    CheckRegisterWord(RegisterType::SP, 0x3F78);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3F76, 0x7F);
    CheckMemory(0x3F77, 0x96);
    CheckMemory(0xEF47, 0xD1);
}

void test_D1_019F()
{
    if (skip_test_D1_019F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1548);
    WriteRegisterWord(RegisterType::SP, 0x7FA8);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0x22);
    WriteRegisterByte(RegisterType::C, 0xCB);
    WriteRegisterByte(RegisterType::D, 0x0C);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0x7F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7FA9, 0xC8);
    WriteMemory(0x7FA8, 0xCC);
    WriteMemory(0x1548, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0x22);
    CheckRegisterByte(RegisterType::C, 0xCB);
    CheckRegisterByte(RegisterType::D, 0xC8);
    CheckRegisterByte(RegisterType::E, 0xCC);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0x7F);
    CheckRegisterWord(RegisterType::PC, 0x1549);
    CheckRegisterWord(RegisterType::SP, 0x7FAA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1548, 0xD1);
    CheckMemory(0x7FA8, 0xCC);
    CheckMemory(0x7FA9, 0xC8);
}

void test_D1_01A0()
{
    if (skip_test_D1_01A0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD934);
    WriteRegisterWord(RegisterType::SP, 0xE344);
    WriteRegisterByte(RegisterType::A, 0x0B);
    WriteRegisterByte(RegisterType::B, 0xA6);
    WriteRegisterByte(RegisterType::C, 0xBE);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x7B);
    WriteRegisterByte(RegisterType::L, 0xAF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE345, 0x1A);
    WriteMemory(0xE344, 0xC3);
    WriteMemory(0xD934, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0B);
    CheckRegisterByte(RegisterType::B, 0xA6);
    CheckRegisterByte(RegisterType::C, 0xBE);
    CheckRegisterByte(RegisterType::D, 0x1A);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x7B);
    CheckRegisterByte(RegisterType::L, 0xAF);
    CheckRegisterWord(RegisterType::PC, 0xD935);
    CheckRegisterWord(RegisterType::SP, 0xE346);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD934, 0xD1);
    CheckMemory(0xE344, 0xC3);
    CheckMemory(0xE345, 0x1A);
}

void test_D1_01A1()
{
    if (skip_test_D1_01A1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFDDC);
    WriteRegisterWord(RegisterType::SP, 0x6CB6);
    WriteRegisterByte(RegisterType::A, 0x5A);
    WriteRegisterByte(RegisterType::B, 0x2C);
    WriteRegisterByte(RegisterType::C, 0xDC);
    WriteRegisterByte(RegisterType::D, 0x31);
    WriteRegisterByte(RegisterType::E, 0x43);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x34);
    WriteRegisterByte(RegisterType::L, 0x41);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFDDC, 0xD1);
    WriteMemory(0x6CB7, 0x2A);
    WriteMemory(0x6CB6, 0x05);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5A);
    CheckRegisterByte(RegisterType::B, 0x2C);
    CheckRegisterByte(RegisterType::C, 0xDC);
    CheckRegisterByte(RegisterType::D, 0x2A);
    CheckRegisterByte(RegisterType::E, 0x05);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x34);
    CheckRegisterByte(RegisterType::L, 0x41);
    CheckRegisterWord(RegisterType::PC, 0xFDDD);
    CheckRegisterWord(RegisterType::SP, 0x6CB8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6CB6, 0x05);
    CheckMemory(0x6CB7, 0x2A);
    CheckMemory(0xFDDC, 0xD1);
}

void test_D1_01A2()
{
    if (skip_test_D1_01A2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCB00);
    WriteRegisterWord(RegisterType::SP, 0x0750);
    WriteRegisterByte(RegisterType::A, 0x08);
    WriteRegisterByte(RegisterType::B, 0x89);
    WriteRegisterByte(RegisterType::C, 0x63);
    WriteRegisterByte(RegisterType::D, 0xAC);
    WriteRegisterByte(RegisterType::E, 0xC8);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x63);
    WriteRegisterByte(RegisterType::L, 0xBC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCB00, 0xD1);
    WriteMemory(0x0751, 0x50);
    WriteMemory(0x0750, 0xA9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x08);
    CheckRegisterByte(RegisterType::B, 0x89);
    CheckRegisterByte(RegisterType::C, 0x63);
    CheckRegisterByte(RegisterType::D, 0x50);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x63);
    CheckRegisterByte(RegisterType::L, 0xBC);
    CheckRegisterWord(RegisterType::PC, 0xCB01);
    CheckRegisterWord(RegisterType::SP, 0x0752);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0750, 0xA9);
    CheckMemory(0x0751, 0x50);
    CheckMemory(0xCB00, 0xD1);
}

void test_D1_01A3()
{
    if (skip_test_D1_01A3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x54CD);
    WriteRegisterWord(RegisterType::SP, 0x4438);
    WriteRegisterByte(RegisterType::A, 0x99);
    WriteRegisterByte(RegisterType::B, 0x2F);
    WriteRegisterByte(RegisterType::C, 0x73);
    WriteRegisterByte(RegisterType::D, 0xE9);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xE5);
    WriteRegisterByte(RegisterType::L, 0x65);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x54CD, 0xD1);
    WriteMemory(0x4439, 0x88);
    WriteMemory(0x4438, 0x6A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x99);
    CheckRegisterByte(RegisterType::B, 0x2F);
    CheckRegisterByte(RegisterType::C, 0x73);
    CheckRegisterByte(RegisterType::D, 0x88);
    CheckRegisterByte(RegisterType::E, 0x6A);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xE5);
    CheckRegisterByte(RegisterType::L, 0x65);
    CheckRegisterWord(RegisterType::PC, 0x54CE);
    CheckRegisterWord(RegisterType::SP, 0x443A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4438, 0x6A);
    CheckMemory(0x4439, 0x88);
    CheckMemory(0x54CD, 0xD1);
}

void test_D1_01A4()
{
    if (skip_test_D1_01A4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF74C);
    WriteRegisterWord(RegisterType::SP, 0xA90E);
    WriteRegisterByte(RegisterType::A, 0xD5);
    WriteRegisterByte(RegisterType::B, 0x69);
    WriteRegisterByte(RegisterType::C, 0x32);
    WriteRegisterByte(RegisterType::D, 0xD6);
    WriteRegisterByte(RegisterType::E, 0x9E);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x78);
    WriteRegisterByte(RegisterType::L, 0x66);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF74C, 0xD1);
    WriteMemory(0xA90F, 0x7A);
    WriteMemory(0xA90E, 0x6E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD5);
    CheckRegisterByte(RegisterType::B, 0x69);
    CheckRegisterByte(RegisterType::C, 0x32);
    CheckRegisterByte(RegisterType::D, 0x7A);
    CheckRegisterByte(RegisterType::E, 0x6E);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x78);
    CheckRegisterByte(RegisterType::L, 0x66);
    CheckRegisterWord(RegisterType::PC, 0xF74D);
    CheckRegisterWord(RegisterType::SP, 0xA910);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA90E, 0x6E);
    CheckMemory(0xA90F, 0x7A);
    CheckMemory(0xF74C, 0xD1);
}

void test_D1_01A5()
{
    if (skip_test_D1_01A5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA911);
    WriteRegisterWord(RegisterType::SP, 0x6CE2);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0x9A);
    WriteRegisterByte(RegisterType::C, 0xA4);
    WriteRegisterByte(RegisterType::D, 0xAD);
    WriteRegisterByte(RegisterType::E, 0xA4);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x52);
    WriteRegisterByte(RegisterType::L, 0x6A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA911, 0xD1);
    WriteMemory(0x6CE3, 0x1F);
    WriteMemory(0x6CE2, 0xA9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0x9A);
    CheckRegisterByte(RegisterType::C, 0xA4);
    CheckRegisterByte(RegisterType::D, 0x1F);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x52);
    CheckRegisterByte(RegisterType::L, 0x6A);
    CheckRegisterWord(RegisterType::PC, 0xA912);
    CheckRegisterWord(RegisterType::SP, 0x6CE4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6CE2, 0xA9);
    CheckMemory(0x6CE3, 0x1F);
    CheckMemory(0xA911, 0xD1);
}

void test_D1_01A6()
{
    if (skip_test_D1_01A6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF141);
    WriteRegisterWord(RegisterType::SP, 0x3433);
    WriteRegisterByte(RegisterType::A, 0x0B);
    WriteRegisterByte(RegisterType::B, 0x54);
    WriteRegisterByte(RegisterType::C, 0x60);
    WriteRegisterByte(RegisterType::D, 0x5E);
    WriteRegisterByte(RegisterType::E, 0x5A);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0xAD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF141, 0xD1);
    WriteMemory(0x3434, 0xC1);
    WriteMemory(0x3433, 0x1D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0B);
    CheckRegisterByte(RegisterType::B, 0x54);
    CheckRegisterByte(RegisterType::C, 0x60);
    CheckRegisterByte(RegisterType::D, 0xC1);
    CheckRegisterByte(RegisterType::E, 0x1D);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0xAD);
    CheckRegisterWord(RegisterType::PC, 0xF142);
    CheckRegisterWord(RegisterType::SP, 0x3435);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3433, 0x1D);
    CheckMemory(0x3434, 0xC1);
    CheckMemory(0xF141, 0xD1);
}

void test_D1_01A7()
{
    if (skip_test_D1_01A7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDC46);
    WriteRegisterWord(RegisterType::SP, 0x827C);
    WriteRegisterByte(RegisterType::A, 0x1F);
    WriteRegisterByte(RegisterType::B, 0x63);
    WriteRegisterByte(RegisterType::C, 0xD2);
    WriteRegisterByte(RegisterType::D, 0xF2);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xD6);
    WriteRegisterByte(RegisterType::L, 0xC3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDC46, 0xD1);
    WriteMemory(0x827D, 0x98);
    WriteMemory(0x827C, 0x1D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1F);
    CheckRegisterByte(RegisterType::B, 0x63);
    CheckRegisterByte(RegisterType::C, 0xD2);
    CheckRegisterByte(RegisterType::D, 0x98);
    CheckRegisterByte(RegisterType::E, 0x1D);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xD6);
    CheckRegisterByte(RegisterType::L, 0xC3);
    CheckRegisterWord(RegisterType::PC, 0xDC47);
    CheckRegisterWord(RegisterType::SP, 0x827E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x827C, 0x1D);
    CheckMemory(0x827D, 0x98);
    CheckMemory(0xDC46, 0xD1);
}

void test_D1_01A8()
{
    if (skip_test_D1_01A8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC7FE);
    WriteRegisterWord(RegisterType::SP, 0x6C96);
    WriteRegisterByte(RegisterType::A, 0x33);
    WriteRegisterByte(RegisterType::B, 0x8E);
    WriteRegisterByte(RegisterType::C, 0x51);
    WriteRegisterByte(RegisterType::D, 0x7F);
    WriteRegisterByte(RegisterType::E, 0x93);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xE6);
    WriteRegisterByte(RegisterType::L, 0x8A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC7FE, 0xD1);
    WriteMemory(0x6C97, 0x62);
    WriteMemory(0x6C96, 0xF6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x33);
    CheckRegisterByte(RegisterType::B, 0x8E);
    CheckRegisterByte(RegisterType::C, 0x51);
    CheckRegisterByte(RegisterType::D, 0x62);
    CheckRegisterByte(RegisterType::E, 0xF6);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xE6);
    CheckRegisterByte(RegisterType::L, 0x8A);
    CheckRegisterWord(RegisterType::PC, 0xC7FF);
    CheckRegisterWord(RegisterType::SP, 0x6C98);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6C96, 0xF6);
    CheckMemory(0x6C97, 0x62);
    CheckMemory(0xC7FE, 0xD1);
}

void test_D1_01A9()
{
    if (skip_test_D1_01A9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0287);
    WriteRegisterWord(RegisterType::SP, 0x09AB);
    WriteRegisterByte(RegisterType::A, 0x27);
    WriteRegisterByte(RegisterType::B, 0xBA);
    WriteRegisterByte(RegisterType::C, 0xB7);
    WriteRegisterByte(RegisterType::D, 0xF0);
    WriteRegisterByte(RegisterType::E, 0x01);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x49);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x09AC, 0x9B);
    WriteMemory(0x09AB, 0x23);
    WriteMemory(0x0287, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x27);
    CheckRegisterByte(RegisterType::B, 0xBA);
    CheckRegisterByte(RegisterType::C, 0xB7);
    CheckRegisterByte(RegisterType::D, 0x9B);
    CheckRegisterByte(RegisterType::E, 0x23);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x49);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0x0288);
    CheckRegisterWord(RegisterType::SP, 0x09AD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0287, 0xD1);
    CheckMemory(0x09AB, 0x23);
    CheckMemory(0x09AC, 0x9B);
}

void test_D1_01AA()
{
    if (skip_test_D1_01AA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6A6D);
    WriteRegisterWord(RegisterType::SP, 0x66D4);
    WriteRegisterByte(RegisterType::A, 0x8F);
    WriteRegisterByte(RegisterType::B, 0xA3);
    WriteRegisterByte(RegisterType::C, 0x85);
    WriteRegisterByte(RegisterType::D, 0xAD);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x06);
    WriteRegisterByte(RegisterType::L, 0x1B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6A6D, 0xD1);
    WriteMemory(0x66D5, 0x5F);
    WriteMemory(0x66D4, 0xAE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8F);
    CheckRegisterByte(RegisterType::B, 0xA3);
    CheckRegisterByte(RegisterType::C, 0x85);
    CheckRegisterByte(RegisterType::D, 0x5F);
    CheckRegisterByte(RegisterType::E, 0xAE);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x06);
    CheckRegisterByte(RegisterType::L, 0x1B);
    CheckRegisterWord(RegisterType::PC, 0x6A6E);
    CheckRegisterWord(RegisterType::SP, 0x66D6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x66D4, 0xAE);
    CheckMemory(0x66D5, 0x5F);
    CheckMemory(0x6A6D, 0xD1);
}

void test_D1_01AB()
{
    if (skip_test_D1_01AB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3BD9);
    WriteRegisterWord(RegisterType::SP, 0x5D0D);
    WriteRegisterByte(RegisterType::A, 0xBE);
    WriteRegisterByte(RegisterType::B, 0xB2);
    WriteRegisterByte(RegisterType::C, 0x96);
    WriteRegisterByte(RegisterType::D, 0x4F);
    WriteRegisterByte(RegisterType::E, 0x2B);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x6C);
    WriteRegisterByte(RegisterType::L, 0x57);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5D0E, 0xAA);
    WriteMemory(0x5D0D, 0x87);
    WriteMemory(0x3BD9, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBE);
    CheckRegisterByte(RegisterType::B, 0xB2);
    CheckRegisterByte(RegisterType::C, 0x96);
    CheckRegisterByte(RegisterType::D, 0xAA);
    CheckRegisterByte(RegisterType::E, 0x87);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x6C);
    CheckRegisterByte(RegisterType::L, 0x57);
    CheckRegisterWord(RegisterType::PC, 0x3BDA);
    CheckRegisterWord(RegisterType::SP, 0x5D0F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3BD9, 0xD1);
    CheckMemory(0x5D0D, 0x87);
    CheckMemory(0x5D0E, 0xAA);
}

void test_D1_01AC()
{
    if (skip_test_D1_01AC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4053);
    WriteRegisterWord(RegisterType::SP, 0xEFC5);
    WriteRegisterByte(RegisterType::A, 0x74);
    WriteRegisterByte(RegisterType::B, 0x0C);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0xE6);
    WriteRegisterByte(RegisterType::E, 0x65);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x99);
    WriteRegisterByte(RegisterType::L, 0x59);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEFC6, 0xE6);
    WriteMemory(0xEFC5, 0x3A);
    WriteMemory(0x4053, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x74);
    CheckRegisterByte(RegisterType::B, 0x0C);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0xE6);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x99);
    CheckRegisterByte(RegisterType::L, 0x59);
    CheckRegisterWord(RegisterType::PC, 0x4054);
    CheckRegisterWord(RegisterType::SP, 0xEFC7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4053, 0xD1);
    CheckMemory(0xEFC5, 0x3A);
    CheckMemory(0xEFC6, 0xE6);
}

void test_D1_01AD()
{
    if (skip_test_D1_01AD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5567);
    WriteRegisterWord(RegisterType::SP, 0x3603);
    WriteRegisterByte(RegisterType::A, 0x39);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0xCE);
    WriteRegisterByte(RegisterType::D, 0x67);
    WriteRegisterByte(RegisterType::E, 0xB2);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xA5);
    WriteRegisterByte(RegisterType::L, 0x55);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5567, 0xD1);
    WriteMemory(0x3604, 0xE1);
    WriteMemory(0x3603, 0xC8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x39);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0xCE);
    CheckRegisterByte(RegisterType::D, 0xE1);
    CheckRegisterByte(RegisterType::E, 0xC8);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xA5);
    CheckRegisterByte(RegisterType::L, 0x55);
    CheckRegisterWord(RegisterType::PC, 0x5568);
    CheckRegisterWord(RegisterType::SP, 0x3605);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3603, 0xC8);
    CheckMemory(0x3604, 0xE1);
    CheckMemory(0x5567, 0xD1);
}

void test_D1_01AE()
{
    if (skip_test_D1_01AE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD4D5);
    WriteRegisterWord(RegisterType::SP, 0xB776);
    WriteRegisterByte(RegisterType::A, 0x03);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x5B);
    WriteRegisterByte(RegisterType::D, 0xD6);
    WriteRegisterByte(RegisterType::E, 0x79);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xCF);
    WriteRegisterByte(RegisterType::L, 0x12);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD4D5, 0xD1);
    WriteMemory(0xB777, 0x5A);
    WriteMemory(0xB776, 0x53);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x03);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x5B);
    CheckRegisterByte(RegisterType::D, 0x5A);
    CheckRegisterByte(RegisterType::E, 0x53);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xCF);
    CheckRegisterByte(RegisterType::L, 0x12);
    CheckRegisterWord(RegisterType::PC, 0xD4D6);
    CheckRegisterWord(RegisterType::SP, 0xB778);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB776, 0x53);
    CheckMemory(0xB777, 0x5A);
    CheckMemory(0xD4D5, 0xD1);
}

void test_D1_01AF()
{
    if (skip_test_D1_01AF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAFC6);
    WriteRegisterWord(RegisterType::SP, 0x7BB9);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x99);
    WriteRegisterByte(RegisterType::D, 0x31);
    WriteRegisterByte(RegisterType::E, 0xFB);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x5E);
    WriteRegisterByte(RegisterType::L, 0x39);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAFC6, 0xD1);
    WriteMemory(0x7BBA, 0x7E);
    WriteMemory(0x7BB9, 0xA6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x99);
    CheckRegisterByte(RegisterType::D, 0x7E);
    CheckRegisterByte(RegisterType::E, 0xA6);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x5E);
    CheckRegisterByte(RegisterType::L, 0x39);
    CheckRegisterWord(RegisterType::PC, 0xAFC7);
    CheckRegisterWord(RegisterType::SP, 0x7BBB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7BB9, 0xA6);
    CheckMemory(0x7BBA, 0x7E);
    CheckMemory(0xAFC6, 0xD1);
}

void test_D1_01B0()
{
    if (skip_test_D1_01B0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6B19);
    WriteRegisterWord(RegisterType::SP, 0x6434);
    WriteRegisterByte(RegisterType::A, 0x34);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0x8E);
    WriteRegisterByte(RegisterType::E, 0xCA);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0xBB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6B19, 0xD1);
    WriteMemory(0x6435, 0x2A);
    WriteMemory(0x6434, 0xF4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x34);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0x2A);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0xBB);
    CheckRegisterWord(RegisterType::PC, 0x6B1A);
    CheckRegisterWord(RegisterType::SP, 0x6436);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6434, 0xF4);
    CheckMemory(0x6435, 0x2A);
    CheckMemory(0x6B19, 0xD1);
}

void test_D1_01B1()
{
    if (skip_test_D1_01B1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3739);
    WriteRegisterWord(RegisterType::SP, 0x886F);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0x33);
    WriteRegisterByte(RegisterType::D, 0x7A);
    WriteRegisterByte(RegisterType::E, 0x8C);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x31);
    WriteRegisterByte(RegisterType::L, 0x25);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8870, 0xB3);
    WriteMemory(0x886F, 0x96);
    WriteMemory(0x3739, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0x33);
    CheckRegisterByte(RegisterType::D, 0xB3);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x31);
    CheckRegisterByte(RegisterType::L, 0x25);
    CheckRegisterWord(RegisterType::PC, 0x373A);
    CheckRegisterWord(RegisterType::SP, 0x8871);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3739, 0xD1);
    CheckMemory(0x886F, 0x96);
    CheckMemory(0x8870, 0xB3);
}

void test_D1_01B2()
{
    if (skip_test_D1_01B2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE9AF);
    WriteRegisterWord(RegisterType::SP, 0x73DD);
    WriteRegisterByte(RegisterType::A, 0x66);
    WriteRegisterByte(RegisterType::B, 0x8F);
    WriteRegisterByte(RegisterType::C, 0xB5);
    WriteRegisterByte(RegisterType::D, 0x53);
    WriteRegisterByte(RegisterType::E, 0xB5);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x61);
    WriteRegisterByte(RegisterType::L, 0xB4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE9AF, 0xD1);
    WriteMemory(0x73DE, 0xEE);
    WriteMemory(0x73DD, 0xD4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x66);
    CheckRegisterByte(RegisterType::B, 0x8F);
    CheckRegisterByte(RegisterType::C, 0xB5);
    CheckRegisterByte(RegisterType::D, 0xEE);
    CheckRegisterByte(RegisterType::E, 0xD4);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x61);
    CheckRegisterByte(RegisterType::L, 0xB4);
    CheckRegisterWord(RegisterType::PC, 0xE9B0);
    CheckRegisterWord(RegisterType::SP, 0x73DF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x73DD, 0xD4);
    CheckMemory(0x73DE, 0xEE);
    CheckMemory(0xE9AF, 0xD1);
}

void test_D1_01B3()
{
    if (skip_test_D1_01B3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2F68);
    WriteRegisterWord(RegisterType::SP, 0x05D2);
    WriteRegisterByte(RegisterType::A, 0x04);
    WriteRegisterByte(RegisterType::B, 0xF7);
    WriteRegisterByte(RegisterType::C, 0xDC);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0x4D);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xDF);
    WriteRegisterByte(RegisterType::L, 0x13);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2F68, 0xD1);
    WriteMemory(0x05D3, 0x14);
    WriteMemory(0x05D2, 0x81);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x04);
    CheckRegisterByte(RegisterType::B, 0xF7);
    CheckRegisterByte(RegisterType::C, 0xDC);
    CheckRegisterByte(RegisterType::D, 0x14);
    CheckRegisterByte(RegisterType::E, 0x81);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xDF);
    CheckRegisterByte(RegisterType::L, 0x13);
    CheckRegisterWord(RegisterType::PC, 0x2F69);
    CheckRegisterWord(RegisterType::SP, 0x05D4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x05D2, 0x81);
    CheckMemory(0x05D3, 0x14);
    CheckMemory(0x2F68, 0xD1);
}

void test_D1_01B4()
{
    if (skip_test_D1_01B4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7FF5);
    WriteRegisterWord(RegisterType::SP, 0xE741);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0x9F);
    WriteRegisterByte(RegisterType::C, 0x75);
    WriteRegisterByte(RegisterType::D, 0xE2);
    WriteRegisterByte(RegisterType::E, 0x8B);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xF5);
    WriteRegisterByte(RegisterType::L, 0x12);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE742, 0xF9);
    WriteMemory(0xE741, 0x6E);
    WriteMemory(0x7FF5, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0x9F);
    CheckRegisterByte(RegisterType::C, 0x75);
    CheckRegisterByte(RegisterType::D, 0xF9);
    CheckRegisterByte(RegisterType::E, 0x6E);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xF5);
    CheckRegisterByte(RegisterType::L, 0x12);
    CheckRegisterWord(RegisterType::PC, 0x7FF6);
    CheckRegisterWord(RegisterType::SP, 0xE743);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7FF5, 0xD1);
    CheckMemory(0xE741, 0x6E);
    CheckMemory(0xE742, 0xF9);
}

void test_D1_01B5()
{
    if (skip_test_D1_01B5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x15F6);
    WriteRegisterWord(RegisterType::SP, 0x6EFA);
    WriteRegisterByte(RegisterType::A, 0x20);
    WriteRegisterByte(RegisterType::B, 0x95);
    WriteRegisterByte(RegisterType::C, 0x80);
    WriteRegisterByte(RegisterType::D, 0xC5);
    WriteRegisterByte(RegisterType::E, 0xB2);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC2);
    WriteRegisterByte(RegisterType::L, 0xDA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6EFB, 0x4E);
    WriteMemory(0x6EFA, 0xE9);
    WriteMemory(0x15F6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x20);
    CheckRegisterByte(RegisterType::B, 0x95);
    CheckRegisterByte(RegisterType::C, 0x80);
    CheckRegisterByte(RegisterType::D, 0x4E);
    CheckRegisterByte(RegisterType::E, 0xE9);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC2);
    CheckRegisterByte(RegisterType::L, 0xDA);
    CheckRegisterWord(RegisterType::PC, 0x15F7);
    CheckRegisterWord(RegisterType::SP, 0x6EFC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x15F6, 0xD1);
    CheckMemory(0x6EFA, 0xE9);
    CheckMemory(0x6EFB, 0x4E);
}

void test_D1_01B6()
{
    if (skip_test_D1_01B6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1BDC);
    WriteRegisterWord(RegisterType::SP, 0xB046);
    WriteRegisterByte(RegisterType::A, 0x43);
    WriteRegisterByte(RegisterType::B, 0x10);
    WriteRegisterByte(RegisterType::C, 0x18);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0xBE);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x42);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB047, 0x0B);
    WriteMemory(0xB046, 0x2A);
    WriteMemory(0x1BDC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x43);
    CheckRegisterByte(RegisterType::B, 0x10);
    CheckRegisterByte(RegisterType::C, 0x18);
    CheckRegisterByte(RegisterType::D, 0x0B);
    CheckRegisterByte(RegisterType::E, 0x2A);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x42);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0x1BDD);
    CheckRegisterWord(RegisterType::SP, 0xB048);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1BDC, 0xD1);
    CheckMemory(0xB046, 0x2A);
    CheckMemory(0xB047, 0x0B);
}

void test_D1_01B7()
{
    if (skip_test_D1_01B7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC9E5);
    WriteRegisterWord(RegisterType::SP, 0x7414);
    WriteRegisterByte(RegisterType::A, 0xF6);
    WriteRegisterByte(RegisterType::B, 0xB8);
    WriteRegisterByte(RegisterType::C, 0x65);
    WriteRegisterByte(RegisterType::D, 0xE1);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x47);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC9E5, 0xD1);
    WriteMemory(0x7415, 0x50);
    WriteMemory(0x7414, 0xC2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF6);
    CheckRegisterByte(RegisterType::B, 0xB8);
    CheckRegisterByte(RegisterType::C, 0x65);
    CheckRegisterByte(RegisterType::D, 0x50);
    CheckRegisterByte(RegisterType::E, 0xC2);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x47);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0xC9E6);
    CheckRegisterWord(RegisterType::SP, 0x7416);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7414, 0xC2);
    CheckMemory(0x7415, 0x50);
    CheckMemory(0xC9E5, 0xD1);
}

void test_D1_01B8()
{
    if (skip_test_D1_01B8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF11B);
    WriteRegisterWord(RegisterType::SP, 0x6339);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0x69);
    WriteRegisterByte(RegisterType::C, 0xEB);
    WriteRegisterByte(RegisterType::D, 0x44);
    WriteRegisterByte(RegisterType::E, 0xBC);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x18);
    WriteRegisterByte(RegisterType::L, 0xAA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF11B, 0xD1);
    WriteMemory(0x633A, 0xB5);
    WriteMemory(0x6339, 0xB4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0x69);
    CheckRegisterByte(RegisterType::C, 0xEB);
    CheckRegisterByte(RegisterType::D, 0xB5);
    CheckRegisterByte(RegisterType::E, 0xB4);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x18);
    CheckRegisterByte(RegisterType::L, 0xAA);
    CheckRegisterWord(RegisterType::PC, 0xF11C);
    CheckRegisterWord(RegisterType::SP, 0x633B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6339, 0xB4);
    CheckMemory(0x633A, 0xB5);
    CheckMemory(0xF11B, 0xD1);
}

void test_D1_01B9()
{
    if (skip_test_D1_01B9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB8B6);
    WriteRegisterWord(RegisterType::SP, 0x0BF6);
    WriteRegisterByte(RegisterType::A, 0x14);
    WriteRegisterByte(RegisterType::B, 0xAE);
    WriteRegisterByte(RegisterType::C, 0xEC);
    WriteRegisterByte(RegisterType::D, 0xA5);
    WriteRegisterByte(RegisterType::E, 0xFB);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x72);
    WriteRegisterByte(RegisterType::L, 0xA8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB8B6, 0xD1);
    WriteMemory(0x0BF7, 0x4D);
    WriteMemory(0x0BF6, 0x77);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x14);
    CheckRegisterByte(RegisterType::B, 0xAE);
    CheckRegisterByte(RegisterType::C, 0xEC);
    CheckRegisterByte(RegisterType::D, 0x4D);
    CheckRegisterByte(RegisterType::E, 0x77);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x72);
    CheckRegisterByte(RegisterType::L, 0xA8);
    CheckRegisterWord(RegisterType::PC, 0xB8B7);
    CheckRegisterWord(RegisterType::SP, 0x0BF8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0BF6, 0x77);
    CheckMemory(0x0BF7, 0x4D);
    CheckMemory(0xB8B6, 0xD1);
}

void test_D1_01BA()
{
    if (skip_test_D1_01BA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1365);
    WriteRegisterWord(RegisterType::SP, 0x4FC3);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0xC2);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x61);
    WriteRegisterByte(RegisterType::L, 0x12);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4FC4, 0x58);
    WriteMemory(0x4FC3, 0xD4);
    WriteMemory(0x1365, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0x58);
    CheckRegisterByte(RegisterType::E, 0xD4);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x61);
    CheckRegisterByte(RegisterType::L, 0x12);
    CheckRegisterWord(RegisterType::PC, 0x1366);
    CheckRegisterWord(RegisterType::SP, 0x4FC5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1365, 0xD1);
    CheckMemory(0x4FC3, 0xD4);
    CheckMemory(0x4FC4, 0x58);
}

void test_D1_01BB()
{
    if (skip_test_D1_01BB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x39B2);
    WriteRegisterWord(RegisterType::SP, 0x8230);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0xD1);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0x57);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xE6);
    WriteRegisterByte(RegisterType::L, 0x66);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x8231, 0x5A);
    WriteMemory(0x8230, 0xE2);
    WriteMemory(0x39B2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0xD1);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0x5A);
    CheckRegisterByte(RegisterType::E, 0xE2);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xE6);
    CheckRegisterByte(RegisterType::L, 0x66);
    CheckRegisterWord(RegisterType::PC, 0x39B3);
    CheckRegisterWord(RegisterType::SP, 0x8232);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x39B2, 0xD1);
    CheckMemory(0x8230, 0xE2);
    CheckMemory(0x8231, 0x5A);
}

void test_D1_01BC()
{
    if (skip_test_D1_01BC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6119);
    WriteRegisterWord(RegisterType::SP, 0x2E24);
    WriteRegisterByte(RegisterType::A, 0x1C);
    WriteRegisterByte(RegisterType::B, 0xD9);
    WriteRegisterByte(RegisterType::C, 0x95);
    WriteRegisterByte(RegisterType::D, 0x2D);
    WriteRegisterByte(RegisterType::E, 0x0E);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0x03);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6119, 0xD1);
    WriteMemory(0x2E25, 0xCE);
    WriteMemory(0x2E24, 0xD8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1C);
    CheckRegisterByte(RegisterType::B, 0xD9);
    CheckRegisterByte(RegisterType::C, 0x95);
    CheckRegisterByte(RegisterType::D, 0xCE);
    CheckRegisterByte(RegisterType::E, 0xD8);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0x03);
    CheckRegisterWord(RegisterType::PC, 0x611A);
    CheckRegisterWord(RegisterType::SP, 0x2E26);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2E24, 0xD8);
    CheckMemory(0x2E25, 0xCE);
    CheckMemory(0x6119, 0xD1);
}

void test_D1_01BD()
{
    if (skip_test_D1_01BD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD9B6);
    WriteRegisterWord(RegisterType::SP, 0xAB08);
    WriteRegisterByte(RegisterType::A, 0xBA);
    WriteRegisterByte(RegisterType::B, 0x5A);
    WriteRegisterByte(RegisterType::C, 0xF8);
    WriteRegisterByte(RegisterType::D, 0x7E);
    WriteRegisterByte(RegisterType::E, 0xF1);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xF4);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD9B6, 0xD1);
    WriteMemory(0xAB09, 0xE1);
    WriteMemory(0xAB08, 0x65);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBA);
    CheckRegisterByte(RegisterType::B, 0x5A);
    CheckRegisterByte(RegisterType::C, 0xF8);
    CheckRegisterByte(RegisterType::D, 0xE1);
    CheckRegisterByte(RegisterType::E, 0x65);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xF4);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0xD9B7);
    CheckRegisterWord(RegisterType::SP, 0xAB0A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAB08, 0x65);
    CheckMemory(0xAB09, 0xE1);
    CheckMemory(0xD9B6, 0xD1);
}

void test_D1_01BE()
{
    if (skip_test_D1_01BE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9756);
    WriteRegisterWord(RegisterType::SP, 0x8EFC);
    WriteRegisterByte(RegisterType::A, 0x18);
    WriteRegisterByte(RegisterType::B, 0x8C);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0x3B);
    WriteRegisterByte(RegisterType::E, 0xFC);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0x55);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9756, 0xD1);
    WriteMemory(0x8EFD, 0x50);
    WriteMemory(0x8EFC, 0x27);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x18);
    CheckRegisterByte(RegisterType::B, 0x8C);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0x50);
    CheckRegisterByte(RegisterType::E, 0x27);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0x55);
    CheckRegisterWord(RegisterType::PC, 0x9757);
    CheckRegisterWord(RegisterType::SP, 0x8EFE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8EFC, 0x27);
    CheckMemory(0x8EFD, 0x50);
    CheckMemory(0x9756, 0xD1);
}

void test_D1_01BF()
{
    if (skip_test_D1_01BF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD326);
    WriteRegisterWord(RegisterType::SP, 0x56CB);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0x63);
    WriteRegisterByte(RegisterType::C, 0xB2);
    WriteRegisterByte(RegisterType::D, 0x0B);
    WriteRegisterByte(RegisterType::E, 0xD1);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD326, 0xD1);
    WriteMemory(0x56CC, 0x4B);
    WriteMemory(0x56CB, 0x8C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0x63);
    CheckRegisterByte(RegisterType::C, 0xB2);
    CheckRegisterByte(RegisterType::D, 0x4B);
    CheckRegisterByte(RegisterType::E, 0x8C);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0xD327);
    CheckRegisterWord(RegisterType::SP, 0x56CD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x56CB, 0x8C);
    CheckMemory(0x56CC, 0x4B);
    CheckMemory(0xD326, 0xD1);
}

void test_D1_01C0()
{
    if (skip_test_D1_01C0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD645);
    WriteRegisterWord(RegisterType::SP, 0xCCBE);
    WriteRegisterByte(RegisterType::A, 0x79);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x14);
    WriteRegisterByte(RegisterType::D, 0x28);
    WriteRegisterByte(RegisterType::E, 0xF8);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x9E);
    WriteRegisterByte(RegisterType::L, 0x7E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD645, 0xD1);
    WriteMemory(0xCCBF, 0xF5);
    WriteMemory(0xCCBE, 0xE8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x79);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x14);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0xE8);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x9E);
    CheckRegisterByte(RegisterType::L, 0x7E);
    CheckRegisterWord(RegisterType::PC, 0xD646);
    CheckRegisterWord(RegisterType::SP, 0xCCC0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCCBE, 0xE8);
    CheckMemory(0xCCBF, 0xF5);
    CheckMemory(0xD645, 0xD1);
}

void test_D1_01C1()
{
    if (skip_test_D1_01C1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFFF1);
    WriteRegisterWord(RegisterType::SP, 0xEF43);
    WriteRegisterByte(RegisterType::A, 0x4F);
    WriteRegisterByte(RegisterType::B, 0x28);
    WriteRegisterByte(RegisterType::C, 0x2E);
    WriteRegisterByte(RegisterType::D, 0x2D);
    WriteRegisterByte(RegisterType::E, 0x38);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x27);
    WriteRegisterByte(RegisterType::L, 0x2D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF1, 0xD1);
    WriteMemory(0xEF44, 0x01);
    WriteMemory(0xEF43, 0xD0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4F);
    CheckRegisterByte(RegisterType::B, 0x28);
    CheckRegisterByte(RegisterType::C, 0x2E);
    CheckRegisterByte(RegisterType::D, 0x01);
    CheckRegisterByte(RegisterType::E, 0xD0);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x27);
    CheckRegisterByte(RegisterType::L, 0x2D);
    CheckRegisterWord(RegisterType::PC, 0xFFF2);
    CheckRegisterWord(RegisterType::SP, 0xEF45);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEF43, 0xD0);
    CheckMemory(0xEF44, 0x01);
    CheckMemory(0xFFF1, 0xD1);
}

void test_D1_01C2()
{
    if (skip_test_D1_01C2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6AD9);
    WriteRegisterWord(RegisterType::SP, 0xEA5B);
    WriteRegisterByte(RegisterType::A, 0x61);
    WriteRegisterByte(RegisterType::B, 0xF3);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0x61);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xFE);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEA5C, 0xE6);
    WriteMemory(0xEA5B, 0xA9);
    WriteMemory(0x6AD9, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x61);
    CheckRegisterByte(RegisterType::B, 0xF3);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0xE6);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xFE);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0x6ADA);
    CheckRegisterWord(RegisterType::SP, 0xEA5D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6AD9, 0xD1);
    CheckMemory(0xEA5B, 0xA9);
    CheckMemory(0xEA5C, 0xE6);
}

void test_D1_01C3()
{
    if (skip_test_D1_01C3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC806);
    WriteRegisterWord(RegisterType::SP, 0x1B6F);
    WriteRegisterByte(RegisterType::A, 0x22);
    WriteRegisterByte(RegisterType::B, 0x60);
    WriteRegisterByte(RegisterType::C, 0xE8);
    WriteRegisterByte(RegisterType::D, 0x5E);
    WriteRegisterByte(RegisterType::E, 0x48);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x45);
    WriteRegisterByte(RegisterType::L, 0x31);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC806, 0xD1);
    WriteMemory(0x1B70, 0x04);
    WriteMemory(0x1B6F, 0x36);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x22);
    CheckRegisterByte(RegisterType::B, 0x60);
    CheckRegisterByte(RegisterType::C, 0xE8);
    CheckRegisterByte(RegisterType::D, 0x04);
    CheckRegisterByte(RegisterType::E, 0x36);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x45);
    CheckRegisterByte(RegisterType::L, 0x31);
    CheckRegisterWord(RegisterType::PC, 0xC807);
    CheckRegisterWord(RegisterType::SP, 0x1B71);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1B6F, 0x36);
    CheckMemory(0x1B70, 0x04);
    CheckMemory(0xC806, 0xD1);
}

void test_D1_01C4()
{
    if (skip_test_D1_01C4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2F3D);
    WriteRegisterWord(RegisterType::SP, 0x322C);
    WriteRegisterByte(RegisterType::A, 0xEB);
    WriteRegisterByte(RegisterType::B, 0x66);
    WriteRegisterByte(RegisterType::C, 0x2C);
    WriteRegisterByte(RegisterType::D, 0xDD);
    WriteRegisterByte(RegisterType::E, 0x0B);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xEF);
    WriteRegisterByte(RegisterType::L, 0xE1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x322D, 0x78);
    WriteMemory(0x322C, 0x29);
    WriteMemory(0x2F3D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEB);
    CheckRegisterByte(RegisterType::B, 0x66);
    CheckRegisterByte(RegisterType::C, 0x2C);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0x29);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xEF);
    CheckRegisterByte(RegisterType::L, 0xE1);
    CheckRegisterWord(RegisterType::PC, 0x2F3E);
    CheckRegisterWord(RegisterType::SP, 0x322E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2F3D, 0xD1);
    CheckMemory(0x322C, 0x29);
    CheckMemory(0x322D, 0x78);
}

void test_D1_01C5()
{
    if (skip_test_D1_01C5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8A0B);
    WriteRegisterWord(RegisterType::SP, 0x3239);
    WriteRegisterByte(RegisterType::A, 0x7C);
    WriteRegisterByte(RegisterType::B, 0x45);
    WriteRegisterByte(RegisterType::C, 0xE3);
    WriteRegisterByte(RegisterType::D, 0xF4);
    WriteRegisterByte(RegisterType::E, 0x28);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0xD8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8A0B, 0xD1);
    WriteMemory(0x323A, 0xD1);
    WriteMemory(0x3239, 0xE1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7C);
    CheckRegisterByte(RegisterType::B, 0x45);
    CheckRegisterByte(RegisterType::C, 0xE3);
    CheckRegisterByte(RegisterType::D, 0xD1);
    CheckRegisterByte(RegisterType::E, 0xE1);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0xD8);
    CheckRegisterWord(RegisterType::PC, 0x8A0C);
    CheckRegisterWord(RegisterType::SP, 0x323B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3239, 0xE1);
    CheckMemory(0x323A, 0xD1);
    CheckMemory(0x8A0B, 0xD1);
}

void test_D1_01C6()
{
    if (skip_test_D1_01C6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8183);
    WriteRegisterWord(RegisterType::SP, 0x4613);
    WriteRegisterByte(RegisterType::A, 0xF5);
    WriteRegisterByte(RegisterType::B, 0x85);
    WriteRegisterByte(RegisterType::C, 0x10);
    WriteRegisterByte(RegisterType::D, 0x57);
    WriteRegisterByte(RegisterType::E, 0x51);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xE7);
    WriteRegisterByte(RegisterType::L, 0x39);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8183, 0xD1);
    WriteMemory(0x4614, 0x00);
    WriteMemory(0x4613, 0xC6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF5);
    CheckRegisterByte(RegisterType::B, 0x85);
    CheckRegisterByte(RegisterType::C, 0x10);
    CheckRegisterByte(RegisterType::D, 0x00);
    CheckRegisterByte(RegisterType::E, 0xC6);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xE7);
    CheckRegisterByte(RegisterType::L, 0x39);
    CheckRegisterWord(RegisterType::PC, 0x8184);
    CheckRegisterWord(RegisterType::SP, 0x4615);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4613, 0xC6);
    CheckMemory(0x4614, 0x00);
    CheckMemory(0x8183, 0xD1);
}

void test_D1_01C7()
{
    if (skip_test_D1_01C7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3A12);
    WriteRegisterWord(RegisterType::SP, 0x401D);
    WriteRegisterByte(RegisterType::A, 0xDC);
    WriteRegisterByte(RegisterType::B, 0xAC);
    WriteRegisterByte(RegisterType::C, 0x49);
    WriteRegisterByte(RegisterType::D, 0x21);
    WriteRegisterByte(RegisterType::E, 0x13);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xEC);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x401E, 0x79);
    WriteMemory(0x401D, 0x7A);
    WriteMemory(0x3A12, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDC);
    CheckRegisterByte(RegisterType::B, 0xAC);
    CheckRegisterByte(RegisterType::C, 0x49);
    CheckRegisterByte(RegisterType::D, 0x79);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xEC);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0x3A13);
    CheckRegisterWord(RegisterType::SP, 0x401F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3A12, 0xD1);
    CheckMemory(0x401D, 0x7A);
    CheckMemory(0x401E, 0x79);
}

void test_D1_01C8()
{
    if (skip_test_D1_01C8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5F20);
    WriteRegisterWord(RegisterType::SP, 0x7FBC);
    WriteRegisterByte(RegisterType::A, 0xFD);
    WriteRegisterByte(RegisterType::B, 0x62);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0xEC);
    WriteRegisterByte(RegisterType::E, 0x66);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0x7A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7FBD, 0x11);
    WriteMemory(0x7FBC, 0xF2);
    WriteMemory(0x5F20, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFD);
    CheckRegisterByte(RegisterType::B, 0x62);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0x11);
    CheckRegisterByte(RegisterType::E, 0xF2);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0x7A);
    CheckRegisterWord(RegisterType::PC, 0x5F21);
    CheckRegisterWord(RegisterType::SP, 0x7FBE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5F20, 0xD1);
    CheckMemory(0x7FBC, 0xF2);
    CheckMemory(0x7FBD, 0x11);
}

void test_D1_01C9()
{
    if (skip_test_D1_01C9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0E5D);
    WriteRegisterWord(RegisterType::SP, 0x1A43);
    WriteRegisterByte(RegisterType::A, 0xEF);
    WriteRegisterByte(RegisterType::B, 0x83);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0x5B);
    WriteRegisterByte(RegisterType::E, 0xA3);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x82);
    WriteRegisterByte(RegisterType::L, 0x3D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x1A44, 0x99);
    WriteMemory(0x1A43, 0xB1);
    WriteMemory(0x0E5D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEF);
    CheckRegisterByte(RegisterType::B, 0x83);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0x99);
    CheckRegisterByte(RegisterType::E, 0xB1);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x82);
    CheckRegisterByte(RegisterType::L, 0x3D);
    CheckRegisterWord(RegisterType::PC, 0x0E5E);
    CheckRegisterWord(RegisterType::SP, 0x1A45);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0E5D, 0xD1);
    CheckMemory(0x1A43, 0xB1);
    CheckMemory(0x1A44, 0x99);
}

void test_D1_01CA()
{
    if (skip_test_D1_01CA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x17BB);
    WriteRegisterWord(RegisterType::SP, 0x5165);
    WriteRegisterByte(RegisterType::A, 0x79);
    WriteRegisterByte(RegisterType::B, 0xFE);
    WriteRegisterByte(RegisterType::C, 0x40);
    WriteRegisterByte(RegisterType::D, 0xE8);
    WriteRegisterByte(RegisterType::E, 0x43);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xEE);
    WriteRegisterByte(RegisterType::L, 0xFE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5166, 0xD8);
    WriteMemory(0x5165, 0xCC);
    WriteMemory(0x17BB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x79);
    CheckRegisterByte(RegisterType::B, 0xFE);
    CheckRegisterByte(RegisterType::C, 0x40);
    CheckRegisterByte(RegisterType::D, 0xD8);
    CheckRegisterByte(RegisterType::E, 0xCC);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xEE);
    CheckRegisterByte(RegisterType::L, 0xFE);
    CheckRegisterWord(RegisterType::PC, 0x17BC);
    CheckRegisterWord(RegisterType::SP, 0x5167);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x17BB, 0xD1);
    CheckMemory(0x5165, 0xCC);
    CheckMemory(0x5166, 0xD8);
}

void test_D1_01CB()
{
    if (skip_test_D1_01CB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFC27);
    WriteRegisterWord(RegisterType::SP, 0x7D63);
    WriteRegisterByte(RegisterType::A, 0xE4);
    WriteRegisterByte(RegisterType::B, 0x9B);
    WriteRegisterByte(RegisterType::C, 0xC5);
    WriteRegisterByte(RegisterType::D, 0xD3);
    WriteRegisterByte(RegisterType::E, 0xC9);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0x83);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFC27, 0xD1);
    WriteMemory(0x7D64, 0xAC);
    WriteMemory(0x7D63, 0x94);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE4);
    CheckRegisterByte(RegisterType::B, 0x9B);
    CheckRegisterByte(RegisterType::C, 0xC5);
    CheckRegisterByte(RegisterType::D, 0xAC);
    CheckRegisterByte(RegisterType::E, 0x94);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0x83);
    CheckRegisterWord(RegisterType::PC, 0xFC28);
    CheckRegisterWord(RegisterType::SP, 0x7D65);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7D63, 0x94);
    CheckMemory(0x7D64, 0xAC);
    CheckMemory(0xFC27, 0xD1);
}

void test_D1_01CC()
{
    if (skip_test_D1_01CC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9ECA);
    WriteRegisterWord(RegisterType::SP, 0xA38A);
    WriteRegisterByte(RegisterType::A, 0x7C);
    WriteRegisterByte(RegisterType::B, 0xF0);
    WriteRegisterByte(RegisterType::C, 0xCA);
    WriteRegisterByte(RegisterType::D, 0x9D);
    WriteRegisterByte(RegisterType::E, 0xFE);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x45);
    WriteRegisterByte(RegisterType::L, 0xA2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA38B, 0xDC);
    WriteMemory(0xA38A, 0xE9);
    WriteMemory(0x9ECA, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7C);
    CheckRegisterByte(RegisterType::B, 0xF0);
    CheckRegisterByte(RegisterType::C, 0xCA);
    CheckRegisterByte(RegisterType::D, 0xDC);
    CheckRegisterByte(RegisterType::E, 0xE9);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x45);
    CheckRegisterByte(RegisterType::L, 0xA2);
    CheckRegisterWord(RegisterType::PC, 0x9ECB);
    CheckRegisterWord(RegisterType::SP, 0xA38C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9ECA, 0xD1);
    CheckMemory(0xA38A, 0xE9);
    CheckMemory(0xA38B, 0xDC);
}

void test_D1_01CD()
{
    if (skip_test_D1_01CD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x160D);
    WriteRegisterWord(RegisterType::SP, 0x592C);
    WriteRegisterByte(RegisterType::A, 0xDC);
    WriteRegisterByte(RegisterType::B, 0xEA);
    WriteRegisterByte(RegisterType::C, 0x38);
    WriteRegisterByte(RegisterType::D, 0xE5);
    WriteRegisterByte(RegisterType::E, 0xE2);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x29);
    WriteRegisterByte(RegisterType::L, 0x2A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x592D, 0x9D);
    WriteMemory(0x592C, 0xA2);
    WriteMemory(0x160D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDC);
    CheckRegisterByte(RegisterType::B, 0xEA);
    CheckRegisterByte(RegisterType::C, 0x38);
    CheckRegisterByte(RegisterType::D, 0x9D);
    CheckRegisterByte(RegisterType::E, 0xA2);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x29);
    CheckRegisterByte(RegisterType::L, 0x2A);
    CheckRegisterWord(RegisterType::PC, 0x160E);
    CheckRegisterWord(RegisterType::SP, 0x592E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x160D, 0xD1);
    CheckMemory(0x592C, 0xA2);
    CheckMemory(0x592D, 0x9D);
}

void test_D1_01CE()
{
    if (skip_test_D1_01CE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0F0C);
    WriteRegisterWord(RegisterType::SP, 0x648B);
    WriteRegisterByte(RegisterType::A, 0x0F);
    WriteRegisterByte(RegisterType::B, 0xDB);
    WriteRegisterByte(RegisterType::C, 0x2F);
    WriteRegisterByte(RegisterType::D, 0x8D);
    WriteRegisterByte(RegisterType::E, 0xE1);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x5C);
    WriteRegisterByte(RegisterType::L, 0x50);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x648C, 0x5B);
    WriteMemory(0x648B, 0x4E);
    WriteMemory(0x0F0C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0F);
    CheckRegisterByte(RegisterType::B, 0xDB);
    CheckRegisterByte(RegisterType::C, 0x2F);
    CheckRegisterByte(RegisterType::D, 0x5B);
    CheckRegisterByte(RegisterType::E, 0x4E);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x5C);
    CheckRegisterByte(RegisterType::L, 0x50);
    CheckRegisterWord(RegisterType::PC, 0x0F0D);
    CheckRegisterWord(RegisterType::SP, 0x648D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0F0C, 0xD1);
    CheckMemory(0x648B, 0x4E);
    CheckMemory(0x648C, 0x5B);
}

void test_D1_01CF()
{
    if (skip_test_D1_01CF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4C6B);
    WriteRegisterWord(RegisterType::SP, 0x1EEF);
    WriteRegisterByte(RegisterType::A, 0xC0);
    WriteRegisterByte(RegisterType::B, 0xD8);
    WriteRegisterByte(RegisterType::C, 0x62);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0xFB);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xC9);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4C6B, 0xD1);
    WriteMemory(0x1EF0, 0x4C);
    WriteMemory(0x1EEF, 0x58);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC0);
    CheckRegisterByte(RegisterType::B, 0xD8);
    CheckRegisterByte(RegisterType::C, 0x62);
    CheckRegisterByte(RegisterType::D, 0x4C);
    CheckRegisterByte(RegisterType::E, 0x58);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xC9);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0x4C6C);
    CheckRegisterWord(RegisterType::SP, 0x1EF1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1EEF, 0x58);
    CheckMemory(0x1EF0, 0x4C);
    CheckMemory(0x4C6B, 0xD1);
}

void test_D1_01D0()
{
    if (skip_test_D1_01D0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB879);
    WriteRegisterWord(RegisterType::SP, 0x5866);
    WriteRegisterByte(RegisterType::A, 0xE6);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0xC7);
    WriteRegisterByte(RegisterType::D, 0x53);
    WriteRegisterByte(RegisterType::E, 0x38);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x7E);
    WriteRegisterByte(RegisterType::L, 0xF8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB879, 0xD1);
    WriteMemory(0x5867, 0xB2);
    WriteMemory(0x5866, 0xFD);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE6);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0xC7);
    CheckRegisterByte(RegisterType::D, 0xB2);
    CheckRegisterByte(RegisterType::E, 0xFD);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x7E);
    CheckRegisterByte(RegisterType::L, 0xF8);
    CheckRegisterWord(RegisterType::PC, 0xB87A);
    CheckRegisterWord(RegisterType::SP, 0x5868);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5866, 0xFD);
    CheckMemory(0x5867, 0xB2);
    CheckMemory(0xB879, 0xD1);
}

void test_D1_01D1()
{
    if (skip_test_D1_01D1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFD2A);
    WriteRegisterWord(RegisterType::SP, 0x1F18);
    WriteRegisterByte(RegisterType::A, 0xEA);
    WriteRegisterByte(RegisterType::B, 0x3F);
    WriteRegisterByte(RegisterType::C, 0x8A);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0xB3);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x07);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFD2A, 0xD1);
    WriteMemory(0x1F19, 0xF3);
    WriteMemory(0x1F18, 0x29);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEA);
    CheckRegisterByte(RegisterType::B, 0x3F);
    CheckRegisterByte(RegisterType::C, 0x8A);
    CheckRegisterByte(RegisterType::D, 0xF3);
    CheckRegisterByte(RegisterType::E, 0x29);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x07);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0xFD2B);
    CheckRegisterWord(RegisterType::SP, 0x1F1A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1F18, 0x29);
    CheckMemory(0x1F19, 0xF3);
    CheckMemory(0xFD2A, 0xD1);
}

void test_D1_01D2()
{
    if (skip_test_D1_01D2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9CFD);
    WriteRegisterWord(RegisterType::SP, 0x0E06);
    WriteRegisterByte(RegisterType::A, 0xF5);
    WriteRegisterByte(RegisterType::B, 0x95);
    WriteRegisterByte(RegisterType::C, 0xBD);
    WriteRegisterByte(RegisterType::D, 0x7F);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xB7);
    WriteRegisterByte(RegisterType::L, 0xDC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9CFD, 0xD1);
    WriteMemory(0x0E07, 0x82);
    WriteMemory(0x0E06, 0xED);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF5);
    CheckRegisterByte(RegisterType::B, 0x95);
    CheckRegisterByte(RegisterType::C, 0xBD);
    CheckRegisterByte(RegisterType::D, 0x82);
    CheckRegisterByte(RegisterType::E, 0xED);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xB7);
    CheckRegisterByte(RegisterType::L, 0xDC);
    CheckRegisterWord(RegisterType::PC, 0x9CFE);
    CheckRegisterWord(RegisterType::SP, 0x0E08);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0E06, 0xED);
    CheckMemory(0x0E07, 0x82);
    CheckMemory(0x9CFD, 0xD1);
}

void test_D1_01D3()
{
    if (skip_test_D1_01D3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6785);
    WriteRegisterWord(RegisterType::SP, 0x5855);
    WriteRegisterByte(RegisterType::A, 0x04);
    WriteRegisterByte(RegisterType::B, 0x4C);
    WriteRegisterByte(RegisterType::C, 0xF7);
    WriteRegisterByte(RegisterType::D, 0xE1);
    WriteRegisterByte(RegisterType::E, 0x46);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x28);
    WriteRegisterByte(RegisterType::L, 0x81);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6785, 0xD1);
    WriteMemory(0x5856, 0xBE);
    WriteMemory(0x5855, 0x0C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x04);
    CheckRegisterByte(RegisterType::B, 0x4C);
    CheckRegisterByte(RegisterType::C, 0xF7);
    CheckRegisterByte(RegisterType::D, 0xBE);
    CheckRegisterByte(RegisterType::E, 0x0C);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x28);
    CheckRegisterByte(RegisterType::L, 0x81);
    CheckRegisterWord(RegisterType::PC, 0x6786);
    CheckRegisterWord(RegisterType::SP, 0x5857);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5855, 0x0C);
    CheckMemory(0x5856, 0xBE);
    CheckMemory(0x6785, 0xD1);
}

void test_D1_01D4()
{
    if (skip_test_D1_01D4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2B8E);
    WriteRegisterWord(RegisterType::SP, 0x97F1);
    WriteRegisterByte(RegisterType::A, 0x64);
    WriteRegisterByte(RegisterType::B, 0x17);
    WriteRegisterByte(RegisterType::C, 0x14);
    WriteRegisterByte(RegisterType::D, 0x9D);
    WriteRegisterByte(RegisterType::E, 0xD7);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xC2);
    WriteRegisterByte(RegisterType::L, 0xBB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x97F2, 0xC6);
    WriteMemory(0x97F1, 0x1A);
    WriteMemory(0x2B8E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x64);
    CheckRegisterByte(RegisterType::B, 0x17);
    CheckRegisterByte(RegisterType::C, 0x14);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0x1A);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xC2);
    CheckRegisterByte(RegisterType::L, 0xBB);
    CheckRegisterWord(RegisterType::PC, 0x2B8F);
    CheckRegisterWord(RegisterType::SP, 0x97F3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2B8E, 0xD1);
    CheckMemory(0x97F1, 0x1A);
    CheckMemory(0x97F2, 0xC6);
}

void test_D1_01D5()
{
    if (skip_test_D1_01D5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x107B);
    WriteRegisterWord(RegisterType::SP, 0xE9E1);
    WriteRegisterByte(RegisterType::A, 0xE8);
    WriteRegisterByte(RegisterType::B, 0xD5);
    WriteRegisterByte(RegisterType::C, 0x01);
    WriteRegisterByte(RegisterType::D, 0x92);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x72);
    WriteRegisterByte(RegisterType::L, 0x90);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE9E2, 0xE4);
    WriteMemory(0xE9E1, 0xFF);
    WriteMemory(0x107B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE8);
    CheckRegisterByte(RegisterType::B, 0xD5);
    CheckRegisterByte(RegisterType::C, 0x01);
    CheckRegisterByte(RegisterType::D, 0xE4);
    CheckRegisterByte(RegisterType::E, 0xFF);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x72);
    CheckRegisterByte(RegisterType::L, 0x90);
    CheckRegisterWord(RegisterType::PC, 0x107C);
    CheckRegisterWord(RegisterType::SP, 0xE9E3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x107B, 0xD1);
    CheckMemory(0xE9E1, 0xFF);
    CheckMemory(0xE9E2, 0xE4);
}

void test_D1_01D6()
{
    if (skip_test_D1_01D6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x29BC);
    WriteRegisterWord(RegisterType::SP, 0x7F62);
    WriteRegisterByte(RegisterType::A, 0xF6);
    WriteRegisterByte(RegisterType::B, 0x5E);
    WriteRegisterByte(RegisterType::C, 0x96);
    WriteRegisterByte(RegisterType::D, 0x0F);
    WriteRegisterByte(RegisterType::E, 0xD7);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x50);
    WriteRegisterByte(RegisterType::L, 0x50);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7F63, 0x94);
    WriteMemory(0x7F62, 0x2D);
    WriteMemory(0x29BC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF6);
    CheckRegisterByte(RegisterType::B, 0x5E);
    CheckRegisterByte(RegisterType::C, 0x96);
    CheckRegisterByte(RegisterType::D, 0x94);
    CheckRegisterByte(RegisterType::E, 0x2D);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x50);
    CheckRegisterByte(RegisterType::L, 0x50);
    CheckRegisterWord(RegisterType::PC, 0x29BD);
    CheckRegisterWord(RegisterType::SP, 0x7F64);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x29BC, 0xD1);
    CheckMemory(0x7F62, 0x2D);
    CheckMemory(0x7F63, 0x94);
}

void test_D1_01D7()
{
    if (skip_test_D1_01D7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC31C);
    WriteRegisterWord(RegisterType::SP, 0x7DFB);
    WriteRegisterByte(RegisterType::A, 0xF9);
    WriteRegisterByte(RegisterType::B, 0xCB);
    WriteRegisterByte(RegisterType::C, 0x81);
    WriteRegisterByte(RegisterType::D, 0x13);
    WriteRegisterByte(RegisterType::E, 0x19);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xF7);
    WriteRegisterByte(RegisterType::L, 0x48);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC31C, 0xD1);
    WriteMemory(0x7DFC, 0x06);
    WriteMemory(0x7DFB, 0x7B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF9);
    CheckRegisterByte(RegisterType::B, 0xCB);
    CheckRegisterByte(RegisterType::C, 0x81);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0x7B);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xF7);
    CheckRegisterByte(RegisterType::L, 0x48);
    CheckRegisterWord(RegisterType::PC, 0xC31D);
    CheckRegisterWord(RegisterType::SP, 0x7DFD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7DFB, 0x7B);
    CheckMemory(0x7DFC, 0x06);
    CheckMemory(0xC31C, 0xD1);
}

void test_D1_01D8()
{
    if (skip_test_D1_01D8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA88E);
    WriteRegisterWord(RegisterType::SP, 0xAB92);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0x52);
    WriteRegisterByte(RegisterType::C, 0x18);
    WriteRegisterByte(RegisterType::D, 0xF9);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0xD1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xAB93, 0x02);
    WriteMemory(0xAB92, 0x82);
    WriteMemory(0xA88E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0x52);
    CheckRegisterByte(RegisterType::C, 0x18);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0x82);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0xD1);
    CheckRegisterWord(RegisterType::PC, 0xA88F);
    CheckRegisterWord(RegisterType::SP, 0xAB94);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA88E, 0xD1);
    CheckMemory(0xAB92, 0x82);
    CheckMemory(0xAB93, 0x02);
}

void test_D1_01D9()
{
    if (skip_test_D1_01D9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC0E3);
    WriteRegisterWord(RegisterType::SP, 0x8ED9);
    WriteRegisterByte(RegisterType::A, 0xB6);
    WriteRegisterByte(RegisterType::B, 0x5E);
    WriteRegisterByte(RegisterType::C, 0x8C);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0xDE);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xBE);
    WriteRegisterByte(RegisterType::L, 0x0B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC0E3, 0xD1);
    WriteMemory(0x8EDA, 0xF2);
    WriteMemory(0x8ED9, 0x35);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB6);
    CheckRegisterByte(RegisterType::B, 0x5E);
    CheckRegisterByte(RegisterType::C, 0x8C);
    CheckRegisterByte(RegisterType::D, 0xF2);
    CheckRegisterByte(RegisterType::E, 0x35);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xBE);
    CheckRegisterByte(RegisterType::L, 0x0B);
    CheckRegisterWord(RegisterType::PC, 0xC0E4);
    CheckRegisterWord(RegisterType::SP, 0x8EDB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8ED9, 0x35);
    CheckMemory(0x8EDA, 0xF2);
    CheckMemory(0xC0E3, 0xD1);
}

void test_D1_01DA()
{
    if (skip_test_D1_01DA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9A56);
    WriteRegisterWord(RegisterType::SP, 0x6179);
    WriteRegisterByte(RegisterType::A, 0xB9);
    WriteRegisterByte(RegisterType::B, 0xE8);
    WriteRegisterByte(RegisterType::C, 0x93);
    WriteRegisterByte(RegisterType::D, 0xE3);
    WriteRegisterByte(RegisterType::E, 0x0A);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0xEF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9A56, 0xD1);
    WriteMemory(0x617A, 0x4B);
    WriteMemory(0x6179, 0x23);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB9);
    CheckRegisterByte(RegisterType::B, 0xE8);
    CheckRegisterByte(RegisterType::C, 0x93);
    CheckRegisterByte(RegisterType::D, 0x4B);
    CheckRegisterByte(RegisterType::E, 0x23);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0xEF);
    CheckRegisterWord(RegisterType::PC, 0x9A57);
    CheckRegisterWord(RegisterType::SP, 0x617B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6179, 0x23);
    CheckMemory(0x617A, 0x4B);
    CheckMemory(0x9A56, 0xD1);
}

void test_D1_01DB()
{
    if (skip_test_D1_01DB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1A4B);
    WriteRegisterWord(RegisterType::SP, 0xEF9F);
    WriteRegisterByte(RegisterType::A, 0x97);
    WriteRegisterByte(RegisterType::B, 0x83);
    WriteRegisterByte(RegisterType::C, 0xFF);
    WriteRegisterByte(RegisterType::D, 0x6E);
    WriteRegisterByte(RegisterType::E, 0x7B);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x32);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEFA0, 0x98);
    WriteMemory(0xEF9F, 0x4F);
    WriteMemory(0x1A4B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x97);
    CheckRegisterByte(RegisterType::B, 0x83);
    CheckRegisterByte(RegisterType::C, 0xFF);
    CheckRegisterByte(RegisterType::D, 0x98);
    CheckRegisterByte(RegisterType::E, 0x4F);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x32);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0x1A4C);
    CheckRegisterWord(RegisterType::SP, 0xEFA1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1A4B, 0xD1);
    CheckMemory(0xEF9F, 0x4F);
    CheckMemory(0xEFA0, 0x98);
}

void test_D1_01DC()
{
    if (skip_test_D1_01DC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x028D);
    WriteRegisterWord(RegisterType::SP, 0x3A73);
    WriteRegisterByte(RegisterType::A, 0x3C);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0x7E);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xDB);
    WriteRegisterByte(RegisterType::L, 0x1D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x3A74, 0x62);
    WriteMemory(0x3A73, 0xD1);
    WriteMemory(0x028D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3C);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0x7E);
    CheckRegisterByte(RegisterType::D, 0x62);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xDB);
    CheckRegisterByte(RegisterType::L, 0x1D);
    CheckRegisterWord(RegisterType::PC, 0x028E);
    CheckRegisterWord(RegisterType::SP, 0x3A75);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x028D, 0xD1);
    CheckMemory(0x3A73, 0xD1);
    CheckMemory(0x3A74, 0x62);
}

void test_D1_01DD()
{
    if (skip_test_D1_01DD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCDBF);
    WriteRegisterWord(RegisterType::SP, 0x807E);
    WriteRegisterByte(RegisterType::A, 0x41);
    WriteRegisterByte(RegisterType::B, 0x4D);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0x01);
    WriteRegisterByte(RegisterType::E, 0x2B);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x38);
    WriteRegisterByte(RegisterType::L, 0x99);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCDBF, 0xD1);
    WriteMemory(0x807F, 0x06);
    WriteMemory(0x807E, 0x31);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x41);
    CheckRegisterByte(RegisterType::B, 0x4D);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0x31);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x38);
    CheckRegisterByte(RegisterType::L, 0x99);
    CheckRegisterWord(RegisterType::PC, 0xCDC0);
    CheckRegisterWord(RegisterType::SP, 0x8080);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x807E, 0x31);
    CheckMemory(0x807F, 0x06);
    CheckMemory(0xCDBF, 0xD1);
}

void test_D1_01DE()
{
    if (skip_test_D1_01DE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCF32);
    WriteRegisterWord(RegisterType::SP, 0xEA45);
    WriteRegisterByte(RegisterType::A, 0xDE);
    WriteRegisterByte(RegisterType::B, 0x8D);
    WriteRegisterByte(RegisterType::C, 0x0F);
    WriteRegisterByte(RegisterType::D, 0x64);
    WriteRegisterByte(RegisterType::E, 0x35);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xD9);
    WriteRegisterByte(RegisterType::L, 0xED);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEA46, 0x1E);
    WriteMemory(0xEA45, 0x84);
    WriteMemory(0xCF32, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDE);
    CheckRegisterByte(RegisterType::B, 0x8D);
    CheckRegisterByte(RegisterType::C, 0x0F);
    CheckRegisterByte(RegisterType::D, 0x1E);
    CheckRegisterByte(RegisterType::E, 0x84);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xD9);
    CheckRegisterByte(RegisterType::L, 0xED);
    CheckRegisterWord(RegisterType::PC, 0xCF33);
    CheckRegisterWord(RegisterType::SP, 0xEA47);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCF32, 0xD1);
    CheckMemory(0xEA45, 0x84);
    CheckMemory(0xEA46, 0x1E);
}

void test_D1_01DF()
{
    if (skip_test_D1_01DF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3F0A);
    WriteRegisterWord(RegisterType::SP, 0x2E59);
    WriteRegisterByte(RegisterType::A, 0xB6);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0x75);
    WriteRegisterByte(RegisterType::D, 0x60);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x4B);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x3F0A, 0xD1);
    WriteMemory(0x2E5A, 0xFB);
    WriteMemory(0x2E59, 0xBD);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB6);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0x75);
    CheckRegisterByte(RegisterType::D, 0xFB);
    CheckRegisterByte(RegisterType::E, 0xBD);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x4B);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0x3F0B);
    CheckRegisterWord(RegisterType::SP, 0x2E5B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2E59, 0xBD);
    CheckMemory(0x2E5A, 0xFB);
    CheckMemory(0x3F0A, 0xD1);
}

void test_D1_01E0()
{
    if (skip_test_D1_01E0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1B48);
    WriteRegisterWord(RegisterType::SP, 0xE18C);
    WriteRegisterByte(RegisterType::A, 0xAE);
    WriteRegisterByte(RegisterType::B, 0x09);
    WriteRegisterByte(RegisterType::C, 0x59);
    WriteRegisterByte(RegisterType::D, 0x5A);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x5C);
    WriteRegisterByte(RegisterType::L, 0x37);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE18D, 0xC3);
    WriteMemory(0xE18C, 0x27);
    WriteMemory(0x1B48, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAE);
    CheckRegisterByte(RegisterType::B, 0x09);
    CheckRegisterByte(RegisterType::C, 0x59);
    CheckRegisterByte(RegisterType::D, 0xC3);
    CheckRegisterByte(RegisterType::E, 0x27);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x5C);
    CheckRegisterByte(RegisterType::L, 0x37);
    CheckRegisterWord(RegisterType::PC, 0x1B49);
    CheckRegisterWord(RegisterType::SP, 0xE18E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1B48, 0xD1);
    CheckMemory(0xE18C, 0x27);
    CheckMemory(0xE18D, 0xC3);
}

void test_D1_01E1()
{
    if (skip_test_D1_01E1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBC99);
    WriteRegisterWord(RegisterType::SP, 0xAFE5);
    WriteRegisterByte(RegisterType::A, 0x65);
    WriteRegisterByte(RegisterType::B, 0x6E);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0x04);
    WriteRegisterByte(RegisterType::E, 0xFC);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x60);
    WriteRegisterByte(RegisterType::L, 0x04);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBC99, 0xD1);
    WriteMemory(0xAFE6, 0xBF);
    WriteMemory(0xAFE5, 0x12);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x65);
    CheckRegisterByte(RegisterType::B, 0x6E);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0xBF);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x60);
    CheckRegisterByte(RegisterType::L, 0x04);
    CheckRegisterWord(RegisterType::PC, 0xBC9A);
    CheckRegisterWord(RegisterType::SP, 0xAFE7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAFE5, 0x12);
    CheckMemory(0xAFE6, 0xBF);
    CheckMemory(0xBC99, 0xD1);
}

void test_D1_01E2()
{
    if (skip_test_D1_01E2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC58A);
    WriteRegisterWord(RegisterType::SP, 0x5E2E);
    WriteRegisterByte(RegisterType::A, 0x2A);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0xE6);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0x60);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x0D);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC58A, 0xD1);
    WriteMemory(0x5E2F, 0xEE);
    WriteMemory(0x5E2E, 0x8D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2A);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0xE6);
    CheckRegisterByte(RegisterType::D, 0xEE);
    CheckRegisterByte(RegisterType::E, 0x8D);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x0D);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0xC58B);
    CheckRegisterWord(RegisterType::SP, 0x5E30);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5E2E, 0x8D);
    CheckMemory(0x5E2F, 0xEE);
    CheckMemory(0xC58A, 0xD1);
}

void test_D1_01E3()
{
    if (skip_test_D1_01E3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEDC1);
    WriteRegisterWord(RegisterType::SP, 0x81C8);
    WriteRegisterByte(RegisterType::A, 0x53);
    WriteRegisterByte(RegisterType::B, 0x93);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0xAF);
    WriteRegisterByte(RegisterType::E, 0x2C);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x28);
    WriteRegisterByte(RegisterType::L, 0x42);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEDC1, 0xD1);
    WriteMemory(0x81C9, 0x5F);
    WriteMemory(0x81C8, 0xB4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x53);
    CheckRegisterByte(RegisterType::B, 0x93);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0x5F);
    CheckRegisterByte(RegisterType::E, 0xB4);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x28);
    CheckRegisterByte(RegisterType::L, 0x42);
    CheckRegisterWord(RegisterType::PC, 0xEDC2);
    CheckRegisterWord(RegisterType::SP, 0x81CA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x81C8, 0xB4);
    CheckMemory(0x81C9, 0x5F);
    CheckMemory(0xEDC1, 0xD1);
}

void test_D1_01E4()
{
    if (skip_test_D1_01E4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3DC5);
    WriteRegisterWord(RegisterType::SP, 0x38D9);
    WriteRegisterByte(RegisterType::A, 0x83);
    WriteRegisterByte(RegisterType::B, 0x36);
    WriteRegisterByte(RegisterType::C, 0x54);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0xD7);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x82);
    WriteRegisterByte(RegisterType::L, 0x38);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x3DC5, 0xD1);
    WriteMemory(0x38DA, 0xE2);
    WriteMemory(0x38D9, 0x3A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x83);
    CheckRegisterByte(RegisterType::B, 0x36);
    CheckRegisterByte(RegisterType::C, 0x54);
    CheckRegisterByte(RegisterType::D, 0xE2);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x82);
    CheckRegisterByte(RegisterType::L, 0x38);
    CheckRegisterWord(RegisterType::PC, 0x3DC6);
    CheckRegisterWord(RegisterType::SP, 0x38DB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x38D9, 0x3A);
    CheckMemory(0x38DA, 0xE2);
    CheckMemory(0x3DC5, 0xD1);
}

void test_D1_01E5()
{
    if (skip_test_D1_01E5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDAAA);
    WriteRegisterWord(RegisterType::SP, 0xC229);
    WriteRegisterByte(RegisterType::A, 0xE3);
    WriteRegisterByte(RegisterType::B, 0x17);
    WriteRegisterByte(RegisterType::C, 0x32);
    WriteRegisterByte(RegisterType::D, 0x50);
    WriteRegisterByte(RegisterType::E, 0x92);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x33);
    WriteRegisterByte(RegisterType::L, 0x65);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDAAA, 0xD1);
    WriteMemory(0xC22A, 0xC5);
    WriteMemory(0xC229, 0x19);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE3);
    CheckRegisterByte(RegisterType::B, 0x17);
    CheckRegisterByte(RegisterType::C, 0x32);
    CheckRegisterByte(RegisterType::D, 0xC5);
    CheckRegisterByte(RegisterType::E, 0x19);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x33);
    CheckRegisterByte(RegisterType::L, 0x65);
    CheckRegisterWord(RegisterType::PC, 0xDAAB);
    CheckRegisterWord(RegisterType::SP, 0xC22B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC229, 0x19);
    CheckMemory(0xC22A, 0xC5);
    CheckMemory(0xDAAA, 0xD1);
}

void test_D1_01E6()
{
    if (skip_test_D1_01E6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD401);
    WriteRegisterWord(RegisterType::SP, 0x3F7E);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0xA1);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0xAF);
    WriteRegisterByte(RegisterType::E, 0xDD);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x67);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD401, 0xD1);
    WriteMemory(0x3F7F, 0x63);
    WriteMemory(0x3F7E, 0x34);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0xA1);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0x63);
    CheckRegisterByte(RegisterType::E, 0x34);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x67);
    CheckRegisterWord(RegisterType::PC, 0xD402);
    CheckRegisterWord(RegisterType::SP, 0x3F80);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3F7E, 0x34);
    CheckMemory(0x3F7F, 0x63);
    CheckMemory(0xD401, 0xD1);
}

void test_D1_01E7()
{
    if (skip_test_D1_01E7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD8B);
    WriteRegisterWord(RegisterType::SP, 0x1D93);
    WriteRegisterByte(RegisterType::A, 0xDC);
    WriteRegisterByte(RegisterType::B, 0xA2);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0x2C);
    WriteRegisterByte(RegisterType::E, 0x2B);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x19);
    WriteRegisterByte(RegisterType::L, 0xB6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCD8B, 0xD1);
    WriteMemory(0x1D94, 0x3B);
    WriteMemory(0x1D93, 0x18);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDC);
    CheckRegisterByte(RegisterType::B, 0xA2);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0x3B);
    CheckRegisterByte(RegisterType::E, 0x18);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x19);
    CheckRegisterByte(RegisterType::L, 0xB6);
    CheckRegisterWord(RegisterType::PC, 0xCD8C);
    CheckRegisterWord(RegisterType::SP, 0x1D95);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1D93, 0x18);
    CheckMemory(0x1D94, 0x3B);
    CheckMemory(0xCD8B, 0xD1);
}

void test_D1_01E8()
{
    if (skip_test_D1_01E8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x450D);
    WriteRegisterWord(RegisterType::SP, 0x51B1);
    WriteRegisterByte(RegisterType::A, 0xD5);
    WriteRegisterByte(RegisterType::B, 0x64);
    WriteRegisterByte(RegisterType::C, 0xA8);
    WriteRegisterByte(RegisterType::D, 0x26);
    WriteRegisterByte(RegisterType::E, 0xC6);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xF5);
    WriteRegisterByte(RegisterType::L, 0x3A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x51B2, 0xF8);
    WriteMemory(0x51B1, 0xB7);
    WriteMemory(0x450D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD5);
    CheckRegisterByte(RegisterType::B, 0x64);
    CheckRegisterByte(RegisterType::C, 0xA8);
    CheckRegisterByte(RegisterType::D, 0xF8);
    CheckRegisterByte(RegisterType::E, 0xB7);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xF5);
    CheckRegisterByte(RegisterType::L, 0x3A);
    CheckRegisterWord(RegisterType::PC, 0x450E);
    CheckRegisterWord(RegisterType::SP, 0x51B3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x450D, 0xD1);
    CheckMemory(0x51B1, 0xB7);
    CheckMemory(0x51B2, 0xF8);
}

void test_D1_01E9()
{
    if (skip_test_D1_01E9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC651);
    WriteRegisterWord(RegisterType::SP, 0x793E);
    WriteRegisterByte(RegisterType::A, 0xA2);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0x69);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0x1F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC651, 0xD1);
    WriteMemory(0x793F, 0xAE);
    WriteMemory(0x793E, 0x78);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA2);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0xAE);
    CheckRegisterByte(RegisterType::E, 0x78);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0x1F);
    CheckRegisterWord(RegisterType::PC, 0xC652);
    CheckRegisterWord(RegisterType::SP, 0x7940);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x793E, 0x78);
    CheckMemory(0x793F, 0xAE);
    CheckMemory(0xC651, 0xD1);
}

void test_D1_01EA()
{
    if (skip_test_D1_01EA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x553A);
    WriteRegisterWord(RegisterType::SP, 0x5C32);
    WriteRegisterByte(RegisterType::A, 0xB7);
    WriteRegisterByte(RegisterType::B, 0xC7);
    WriteRegisterByte(RegisterType::C, 0xA2);
    WriteRegisterByte(RegisterType::D, 0x08);
    WriteRegisterByte(RegisterType::E, 0x07);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x0D);
    WriteRegisterByte(RegisterType::L, 0xDF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5C33, 0x6D);
    WriteMemory(0x5C32, 0xA9);
    WriteMemory(0x553A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB7);
    CheckRegisterByte(RegisterType::B, 0xC7);
    CheckRegisterByte(RegisterType::C, 0xA2);
    CheckRegisterByte(RegisterType::D, 0x6D);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x0D);
    CheckRegisterByte(RegisterType::L, 0xDF);
    CheckRegisterWord(RegisterType::PC, 0x553B);
    CheckRegisterWord(RegisterType::SP, 0x5C34);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x553A, 0xD1);
    CheckMemory(0x5C32, 0xA9);
    CheckMemory(0x5C33, 0x6D);
}

void test_D1_01EB()
{
    if (skip_test_D1_01EB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA79A);
    WriteRegisterWord(RegisterType::SP, 0xC848);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0xA1);
    WriteRegisterByte(RegisterType::C, 0xCD);
    WriteRegisterByte(RegisterType::D, 0x6C);
    WriteRegisterByte(RegisterType::E, 0x63);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x89);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC849, 0xFB);
    WriteMemory(0xC848, 0x20);
    WriteMemory(0xA79A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0xA1);
    CheckRegisterByte(RegisterType::C, 0xCD);
    CheckRegisterByte(RegisterType::D, 0xFB);
    CheckRegisterByte(RegisterType::E, 0x20);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x89);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0xA79B);
    CheckRegisterWord(RegisterType::SP, 0xC84A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA79A, 0xD1);
    CheckMemory(0xC848, 0x20);
    CheckMemory(0xC849, 0xFB);
}

void test_D1_01EC()
{
    if (skip_test_D1_01EC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x42F8);
    WriteRegisterWord(RegisterType::SP, 0x460E);
    WriteRegisterByte(RegisterType::A, 0x13);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0x6C);
    WriteRegisterByte(RegisterType::D, 0xA3);
    WriteRegisterByte(RegisterType::E, 0xC0);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xCB);
    WriteRegisterByte(RegisterType::L, 0xD1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x460F, 0x65);
    WriteMemory(0x460E, 0x3A);
    WriteMemory(0x42F8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x13);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0x6C);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xCB);
    CheckRegisterByte(RegisterType::L, 0xD1);
    CheckRegisterWord(RegisterType::PC, 0x42F9);
    CheckRegisterWord(RegisterType::SP, 0x4610);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x42F8, 0xD1);
    CheckMemory(0x460E, 0x3A);
    CheckMemory(0x460F, 0x65);
}

void test_D1_01ED()
{
    if (skip_test_D1_01ED)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7CFB);
    WriteRegisterWord(RegisterType::SP, 0x347C);
    WriteRegisterByte(RegisterType::A, 0x9D);
    WriteRegisterByte(RegisterType::B, 0xCF);
    WriteRegisterByte(RegisterType::C, 0xF9);
    WriteRegisterByte(RegisterType::D, 0x69);
    WriteRegisterByte(RegisterType::E, 0xF8);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x67);
    WriteRegisterByte(RegisterType::L, 0x1A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7CFB, 0xD1);
    WriteMemory(0x347D, 0x2B);
    WriteMemory(0x347C, 0xCC);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9D);
    CheckRegisterByte(RegisterType::B, 0xCF);
    CheckRegisterByte(RegisterType::C, 0xF9);
    CheckRegisterByte(RegisterType::D, 0x2B);
    CheckRegisterByte(RegisterType::E, 0xCC);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x67);
    CheckRegisterByte(RegisterType::L, 0x1A);
    CheckRegisterWord(RegisterType::PC, 0x7CFC);
    CheckRegisterWord(RegisterType::SP, 0x347E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x347C, 0xCC);
    CheckMemory(0x347D, 0x2B);
    CheckMemory(0x7CFB, 0xD1);
}

void test_D1_01EE()
{
    if (skip_test_D1_01EE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD49E);
    WriteRegisterWord(RegisterType::SP, 0xE0F6);
    WriteRegisterByte(RegisterType::A, 0x33);
    WriteRegisterByte(RegisterType::B, 0xA9);
    WriteRegisterByte(RegisterType::C, 0x2E);
    WriteRegisterByte(RegisterType::D, 0x6D);
    WriteRegisterByte(RegisterType::E, 0xB3);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x43);
    WriteRegisterByte(RegisterType::L, 0xEA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE0F7, 0x04);
    WriteMemory(0xE0F6, 0xED);
    WriteMemory(0xD49E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x33);
    CheckRegisterByte(RegisterType::B, 0xA9);
    CheckRegisterByte(RegisterType::C, 0x2E);
    CheckRegisterByte(RegisterType::D, 0x04);
    CheckRegisterByte(RegisterType::E, 0xED);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x43);
    CheckRegisterByte(RegisterType::L, 0xEA);
    CheckRegisterWord(RegisterType::PC, 0xD49F);
    CheckRegisterWord(RegisterType::SP, 0xE0F8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD49E, 0xD1);
    CheckMemory(0xE0F6, 0xED);
    CheckMemory(0xE0F7, 0x04);
}

void test_D1_01EF()
{
    if (skip_test_D1_01EF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE815);
    WriteRegisterWord(RegisterType::SP, 0xDFF0);
    WriteRegisterByte(RegisterType::A, 0x0D);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0xD5);
    WriteRegisterByte(RegisterType::D, 0x1F);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x33);
    WriteRegisterByte(RegisterType::L, 0xE2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE815, 0xD1);
    WriteMemory(0xDFF1, 0xD9);
    WriteMemory(0xDFF0, 0x5F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0D);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0xD5);
    CheckRegisterByte(RegisterType::D, 0xD9);
    CheckRegisterByte(RegisterType::E, 0x5F);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x33);
    CheckRegisterByte(RegisterType::L, 0xE2);
    CheckRegisterWord(RegisterType::PC, 0xE816);
    CheckRegisterWord(RegisterType::SP, 0xDFF2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDFF0, 0x5F);
    CheckMemory(0xDFF1, 0xD9);
    CheckMemory(0xE815, 0xD1);
}

void test_D1_01F0()
{
    if (skip_test_D1_01F0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x708F);
    WriteRegisterWord(RegisterType::SP, 0x85C3);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0x19);
    WriteRegisterByte(RegisterType::C, 0x9C);
    WriteRegisterByte(RegisterType::D, 0x71);
    WriteRegisterByte(RegisterType::E, 0xBE);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x94);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x85C4, 0x72);
    WriteMemory(0x85C3, 0x06);
    WriteMemory(0x708F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0x19);
    CheckRegisterByte(RegisterType::C, 0x9C);
    CheckRegisterByte(RegisterType::D, 0x72);
    CheckRegisterByte(RegisterType::E, 0x06);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x94);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0x7090);
    CheckRegisterWord(RegisterType::SP, 0x85C5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x708F, 0xD1);
    CheckMemory(0x85C3, 0x06);
    CheckMemory(0x85C4, 0x72);
}

void test_D1_01F1()
{
    if (skip_test_D1_01F1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9BDC);
    WriteRegisterWord(RegisterType::SP, 0xEC2E);
    WriteRegisterByte(RegisterType::A, 0xEE);
    WriteRegisterByte(RegisterType::B, 0xDD);
    WriteRegisterByte(RegisterType::C, 0x2F);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0xB9);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0x40);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEC2F, 0x28);
    WriteMemory(0xEC2E, 0xD4);
    WriteMemory(0x9BDC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEE);
    CheckRegisterByte(RegisterType::B, 0xDD);
    CheckRegisterByte(RegisterType::C, 0x2F);
    CheckRegisterByte(RegisterType::D, 0x28);
    CheckRegisterByte(RegisterType::E, 0xD4);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0x40);
    CheckRegisterWord(RegisterType::PC, 0x9BDD);
    CheckRegisterWord(RegisterType::SP, 0xEC30);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9BDC, 0xD1);
    CheckMemory(0xEC2E, 0xD4);
    CheckMemory(0xEC2F, 0x28);
}

void test_D1_01F2()
{
    if (skip_test_D1_01F2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDB0C);
    WriteRegisterWord(RegisterType::SP, 0x69D4);
    WriteRegisterByte(RegisterType::A, 0x08);
    WriteRegisterByte(RegisterType::B, 0xB9);
    WriteRegisterByte(RegisterType::C, 0x6E);
    WriteRegisterByte(RegisterType::D, 0xAF);
    WriteRegisterByte(RegisterType::E, 0xB3);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x89);
    WriteRegisterByte(RegisterType::L, 0xDD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDB0C, 0xD1);
    WriteMemory(0x69D5, 0x2F);
    WriteMemory(0x69D4, 0x92);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x08);
    CheckRegisterByte(RegisterType::B, 0xB9);
    CheckRegisterByte(RegisterType::C, 0x6E);
    CheckRegisterByte(RegisterType::D, 0x2F);
    CheckRegisterByte(RegisterType::E, 0x92);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x89);
    CheckRegisterByte(RegisterType::L, 0xDD);
    CheckRegisterWord(RegisterType::PC, 0xDB0D);
    CheckRegisterWord(RegisterType::SP, 0x69D6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x69D4, 0x92);
    CheckMemory(0x69D5, 0x2F);
    CheckMemory(0xDB0C, 0xD1);
}

void test_D1_01F3()
{
    if (skip_test_D1_01F3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3C06);
    WriteRegisterWord(RegisterType::SP, 0xB3A9);
    WriteRegisterByte(RegisterType::A, 0x5F);
    WriteRegisterByte(RegisterType::B, 0xBB);
    WriteRegisterByte(RegisterType::C, 0x75);
    WriteRegisterByte(RegisterType::D, 0xBD);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x10);
    WriteRegisterByte(RegisterType::L, 0xCD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB3AA, 0xDD);
    WriteMemory(0xB3A9, 0xAD);
    WriteMemory(0x3C06, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5F);
    CheckRegisterByte(RegisterType::B, 0xBB);
    CheckRegisterByte(RegisterType::C, 0x75);
    CheckRegisterByte(RegisterType::D, 0xDD);
    CheckRegisterByte(RegisterType::E, 0xAD);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x10);
    CheckRegisterByte(RegisterType::L, 0xCD);
    CheckRegisterWord(RegisterType::PC, 0x3C07);
    CheckRegisterWord(RegisterType::SP, 0xB3AB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3C06, 0xD1);
    CheckMemory(0xB3A9, 0xAD);
    CheckMemory(0xB3AA, 0xDD);
}

void test_D1_01F4()
{
    if (skip_test_D1_01F4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x38C2);
    WriteRegisterWord(RegisterType::SP, 0x840F);
    WriteRegisterByte(RegisterType::A, 0xCF);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0xBE);
    WriteRegisterByte(RegisterType::E, 0x22);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x0D);
    WriteRegisterByte(RegisterType::L, 0x61);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8410, 0xCA);
    WriteMemory(0x840F, 0x33);
    WriteMemory(0x38C2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCF);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0xCA);
    CheckRegisterByte(RegisterType::E, 0x33);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x0D);
    CheckRegisterByte(RegisterType::L, 0x61);
    CheckRegisterWord(RegisterType::PC, 0x38C3);
    CheckRegisterWord(RegisterType::SP, 0x8411);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x38C2, 0xD1);
    CheckMemory(0x840F, 0x33);
    CheckMemory(0x8410, 0xCA);
}

void test_D1_01F5()
{
    if (skip_test_D1_01F5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD87C);
    WriteRegisterWord(RegisterType::SP, 0x4E39);
    WriteRegisterByte(RegisterType::A, 0x2F);
    WriteRegisterByte(RegisterType::B, 0x03);
    WriteRegisterByte(RegisterType::C, 0x84);
    WriteRegisterByte(RegisterType::D, 0x22);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x88);
    WriteRegisterByte(RegisterType::L, 0x50);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD87C, 0xD1);
    WriteMemory(0x4E3A, 0xF1);
    WriteMemory(0x4E39, 0xDD);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2F);
    CheckRegisterByte(RegisterType::B, 0x03);
    CheckRegisterByte(RegisterType::C, 0x84);
    CheckRegisterByte(RegisterType::D, 0xF1);
    CheckRegisterByte(RegisterType::E, 0xDD);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x88);
    CheckRegisterByte(RegisterType::L, 0x50);
    CheckRegisterWord(RegisterType::PC, 0xD87D);
    CheckRegisterWord(RegisterType::SP, 0x4E3B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4E39, 0xDD);
    CheckMemory(0x4E3A, 0xF1);
    CheckMemory(0xD87C, 0xD1);
}

void test_D1_01F6()
{
    if (skip_test_D1_01F6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD47D);
    WriteRegisterWord(RegisterType::SP, 0x36CB);
    WriteRegisterByte(RegisterType::A, 0xE0);
    WriteRegisterByte(RegisterType::B, 0x25);
    WriteRegisterByte(RegisterType::C, 0x07);
    WriteRegisterByte(RegisterType::D, 0xB8);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xAB);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD47D, 0xD1);
    WriteMemory(0x36CC, 0xC5);
    WriteMemory(0x36CB, 0xE3);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE0);
    CheckRegisterByte(RegisterType::B, 0x25);
    CheckRegisterByte(RegisterType::C, 0x07);
    CheckRegisterByte(RegisterType::D, 0xC5);
    CheckRegisterByte(RegisterType::E, 0xE3);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xAB);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0xD47E);
    CheckRegisterWord(RegisterType::SP, 0x36CD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x36CB, 0xE3);
    CheckMemory(0x36CC, 0xC5);
    CheckMemory(0xD47D, 0xD1);
}

void test_D1_01F7()
{
    if (skip_test_D1_01F7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEAD7);
    WriteRegisterWord(RegisterType::SP, 0xB43E);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0x46);
    WriteRegisterByte(RegisterType::C, 0x95);
    WriteRegisterByte(RegisterType::D, 0x27);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xC3);
    WriteRegisterByte(RegisterType::L, 0xE6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEAD7, 0xD1);
    WriteMemory(0xB43F, 0x44);
    WriteMemory(0xB43E, 0xD7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0x46);
    CheckRegisterByte(RegisterType::C, 0x95);
    CheckRegisterByte(RegisterType::D, 0x44);
    CheckRegisterByte(RegisterType::E, 0xD7);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xC3);
    CheckRegisterByte(RegisterType::L, 0xE6);
    CheckRegisterWord(RegisterType::PC, 0xEAD8);
    CheckRegisterWord(RegisterType::SP, 0xB440);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB43E, 0xD7);
    CheckMemory(0xB43F, 0x44);
    CheckMemory(0xEAD7, 0xD1);
}

void test_D1_01F8()
{
    if (skip_test_D1_01F8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC5E6);
    WriteRegisterWord(RegisterType::SP, 0xC0E9);
    WriteRegisterByte(RegisterType::A, 0x06);
    WriteRegisterByte(RegisterType::B, 0x85);
    WriteRegisterByte(RegisterType::C, 0x7C);
    WriteRegisterByte(RegisterType::D, 0x73);
    WriteRegisterByte(RegisterType::E, 0xFC);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xD7);
    WriteRegisterByte(RegisterType::L, 0xBE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC5E6, 0xD1);
    WriteMemory(0xC0EA, 0xBE);
    WriteMemory(0xC0E9, 0x8D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x06);
    CheckRegisterByte(RegisterType::B, 0x85);
    CheckRegisterByte(RegisterType::C, 0x7C);
    CheckRegisterByte(RegisterType::D, 0xBE);
    CheckRegisterByte(RegisterType::E, 0x8D);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xD7);
    CheckRegisterByte(RegisterType::L, 0xBE);
    CheckRegisterWord(RegisterType::PC, 0xC5E7);
    CheckRegisterWord(RegisterType::SP, 0xC0EB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC0E9, 0x8D);
    CheckMemory(0xC0EA, 0xBE);
    CheckMemory(0xC5E6, 0xD1);
}

void test_D1_01F9()
{
    if (skip_test_D1_01F9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC7D1);
    WriteRegisterWord(RegisterType::SP, 0x9CFF);
    WriteRegisterByte(RegisterType::A, 0x13);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0x05);
    WriteRegisterByte(RegisterType::D, 0x59);
    WriteRegisterByte(RegisterType::E, 0xB5);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xFF);
    WriteRegisterByte(RegisterType::L, 0xC3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC7D1, 0xD1);
    WriteMemory(0x9D00, 0xAB);
    WriteMemory(0x9CFF, 0xEE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x13);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0x05);
    CheckRegisterByte(RegisterType::D, 0xAB);
    CheckRegisterByte(RegisterType::E, 0xEE);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xFF);
    CheckRegisterByte(RegisterType::L, 0xC3);
    CheckRegisterWord(RegisterType::PC, 0xC7D2);
    CheckRegisterWord(RegisterType::SP, 0x9D01);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9CFF, 0xEE);
    CheckMemory(0x9D00, 0xAB);
    CheckMemory(0xC7D1, 0xD1);
}

void test_D1_01FA()
{
    if (skip_test_D1_01FA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1B32);
    WriteRegisterWord(RegisterType::SP, 0xFA86);
    WriteRegisterByte(RegisterType::A, 0xB1);
    WriteRegisterByte(RegisterType::B, 0x62);
    WriteRegisterByte(RegisterType::C, 0x53);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0x85);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xC9);
    WriteRegisterByte(RegisterType::L, 0xA6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFA87, 0x59);
    WriteMemory(0xFA86, 0x14);
    WriteMemory(0x1B32, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB1);
    CheckRegisterByte(RegisterType::B, 0x62);
    CheckRegisterByte(RegisterType::C, 0x53);
    CheckRegisterByte(RegisterType::D, 0x59);
    CheckRegisterByte(RegisterType::E, 0x14);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xC9);
    CheckRegisterByte(RegisterType::L, 0xA6);
    CheckRegisterWord(RegisterType::PC, 0x1B33);
    CheckRegisterWord(RegisterType::SP, 0xFA88);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1B32, 0xD1);
    CheckMemory(0xFA86, 0x14);
    CheckMemory(0xFA87, 0x59);
}

void test_D1_01FB()
{
    if (skip_test_D1_01FB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5638);
    WriteRegisterWord(RegisterType::SP, 0x2ADC);
    WriteRegisterByte(RegisterType::A, 0x49);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0xC3);
    WriteRegisterByte(RegisterType::D, 0x4D);
    WriteRegisterByte(RegisterType::E, 0xA4);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xE1);
    WriteRegisterByte(RegisterType::L, 0x4A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5638, 0xD1);
    WriteMemory(0x2ADD, 0x5C);
    WriteMemory(0x2ADC, 0x94);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x49);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0xC3);
    CheckRegisterByte(RegisterType::D, 0x5C);
    CheckRegisterByte(RegisterType::E, 0x94);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xE1);
    CheckRegisterByte(RegisterType::L, 0x4A);
    CheckRegisterWord(RegisterType::PC, 0x5639);
    CheckRegisterWord(RegisterType::SP, 0x2ADE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2ADC, 0x94);
    CheckMemory(0x2ADD, 0x5C);
    CheckMemory(0x5638, 0xD1);
}

void test_D1_01FC()
{
    if (skip_test_D1_01FC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDD63);
    WriteRegisterWord(RegisterType::SP, 0x6901);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0xF3);
    WriteRegisterByte(RegisterType::C, 0x59);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0xAE);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x41);
    WriteRegisterByte(RegisterType::L, 0x4E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDD63, 0xD1);
    WriteMemory(0x6902, 0xF4);
    WriteMemory(0x6901, 0x94);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0xF3);
    CheckRegisterByte(RegisterType::C, 0x59);
    CheckRegisterByte(RegisterType::D, 0xF4);
    CheckRegisterByte(RegisterType::E, 0x94);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x41);
    CheckRegisterByte(RegisterType::L, 0x4E);
    CheckRegisterWord(RegisterType::PC, 0xDD64);
    CheckRegisterWord(RegisterType::SP, 0x6903);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6901, 0x94);
    CheckMemory(0x6902, 0xF4);
    CheckMemory(0xDD63, 0xD1);
}

void test_D1_01FD()
{
    if (skip_test_D1_01FD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCDB7);
    WriteRegisterWord(RegisterType::SP, 0x948B);
    WriteRegisterByte(RegisterType::A, 0xA2);
    WriteRegisterByte(RegisterType::B, 0x96);
    WriteRegisterByte(RegisterType::C, 0x72);
    WriteRegisterByte(RegisterType::D, 0x9B);
    WriteRegisterByte(RegisterType::E, 0x43);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x98);
    WriteRegisterByte(RegisterType::L, 0x00);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCDB7, 0xD1);
    WriteMemory(0x948C, 0xD1);
    WriteMemory(0x948B, 0x7A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA2);
    CheckRegisterByte(RegisterType::B, 0x96);
    CheckRegisterByte(RegisterType::C, 0x72);
    CheckRegisterByte(RegisterType::D, 0xD1);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x98);
    CheckRegisterByte(RegisterType::L, 0x00);
    CheckRegisterWord(RegisterType::PC, 0xCDB8);
    CheckRegisterWord(RegisterType::SP, 0x948D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x948B, 0x7A);
    CheckMemory(0x948C, 0xD1);
    CheckMemory(0xCDB7, 0xD1);
}

void test_D1_01FE()
{
    if (skip_test_D1_01FE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4152);
    WriteRegisterWord(RegisterType::SP, 0x02FA);
    WriteRegisterByte(RegisterType::A, 0x40);
    WriteRegisterByte(RegisterType::B, 0xE1);
    WriteRegisterByte(RegisterType::C, 0xF5);
    WriteRegisterByte(RegisterType::D, 0xCF);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x3A);
    WriteRegisterByte(RegisterType::L, 0x20);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x4152, 0xD1);
    WriteMemory(0x02FB, 0xE5);
    WriteMemory(0x02FA, 0x4D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x40);
    CheckRegisterByte(RegisterType::B, 0xE1);
    CheckRegisterByte(RegisterType::C, 0xF5);
    CheckRegisterByte(RegisterType::D, 0xE5);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x3A);
    CheckRegisterByte(RegisterType::L, 0x20);
    CheckRegisterWord(RegisterType::PC, 0x4153);
    CheckRegisterWord(RegisterType::SP, 0x02FC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x02FA, 0x4D);
    CheckMemory(0x02FB, 0xE5);
    CheckMemory(0x4152, 0xD1);
}

void test_D1_01FF()
{
    if (skip_test_D1_01FF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9F9E);
    WriteRegisterWord(RegisterType::SP, 0x554A);
    WriteRegisterByte(RegisterType::A, 0x2F);
    WriteRegisterByte(RegisterType::B, 0xB3);
    WriteRegisterByte(RegisterType::C, 0x66);
    WriteRegisterByte(RegisterType::D, 0xC8);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xF7);
    WriteRegisterByte(RegisterType::L, 0x43);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9F9E, 0xD1);
    WriteMemory(0x554B, 0x54);
    WriteMemory(0x554A, 0xA1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2F);
    CheckRegisterByte(RegisterType::B, 0xB3);
    CheckRegisterByte(RegisterType::C, 0x66);
    CheckRegisterByte(RegisterType::D, 0x54);
    CheckRegisterByte(RegisterType::E, 0xA1);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xF7);
    CheckRegisterByte(RegisterType::L, 0x43);
    CheckRegisterWord(RegisterType::PC, 0x9F9F);
    CheckRegisterWord(RegisterType::SP, 0x554C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x554A, 0xA1);
    CheckMemory(0x554B, 0x54);
    CheckMemory(0x9F9E, 0xD1);
}

void test_D1_0200()
{
    if (skip_test_D1_0200)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0D96);
    WriteRegisterWord(RegisterType::SP, 0x201B);
    WriteRegisterByte(RegisterType::A, 0xB2);
    WriteRegisterByte(RegisterType::B, 0xBD);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0x9C);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xE2);
    WriteRegisterByte(RegisterType::L, 0xB8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x201C, 0xA0);
    WriteMemory(0x201B, 0x25);
    WriteMemory(0x0D96, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB2);
    CheckRegisterByte(RegisterType::B, 0xBD);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0xA0);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xE2);
    CheckRegisterByte(RegisterType::L, 0xB8);
    CheckRegisterWord(RegisterType::PC, 0x0D97);
    CheckRegisterWord(RegisterType::SP, 0x201D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0D96, 0xD1);
    CheckMemory(0x201B, 0x25);
    CheckMemory(0x201C, 0xA0);
}

void test_D1_0201()
{
    if (skip_test_D1_0201)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8DAC);
    WriteRegisterWord(RegisterType::SP, 0xD55C);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0x7D);
    WriteRegisterByte(RegisterType::C, 0x04);
    WriteRegisterByte(RegisterType::D, 0x13);
    WriteRegisterByte(RegisterType::E, 0xD0);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xE3);
    WriteRegisterByte(RegisterType::L, 0xA2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD55D, 0x52);
    WriteMemory(0xD55C, 0x84);
    WriteMemory(0x8DAC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0x7D);
    CheckRegisterByte(RegisterType::C, 0x04);
    CheckRegisterByte(RegisterType::D, 0x52);
    CheckRegisterByte(RegisterType::E, 0x84);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xE3);
    CheckRegisterByte(RegisterType::L, 0xA2);
    CheckRegisterWord(RegisterType::PC, 0x8DAD);
    CheckRegisterWord(RegisterType::SP, 0xD55E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8DAC, 0xD1);
    CheckMemory(0xD55C, 0x84);
    CheckMemory(0xD55D, 0x52);
}

void test_D1_0202()
{
    if (skip_test_D1_0202)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9D1E);
    WriteRegisterWord(RegisterType::SP, 0x2742);
    WriteRegisterByte(RegisterType::A, 0x13);
    WriteRegisterByte(RegisterType::B, 0xBF);
    WriteRegisterByte(RegisterType::C, 0xB0);
    WriteRegisterByte(RegisterType::D, 0x22);
    WriteRegisterByte(RegisterType::E, 0x5F);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x41);
    WriteRegisterByte(RegisterType::L, 0x4E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9D1E, 0xD1);
    WriteMemory(0x2743, 0xEF);
    WriteMemory(0x2742, 0x4E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x13);
    CheckRegisterByte(RegisterType::B, 0xBF);
    CheckRegisterByte(RegisterType::C, 0xB0);
    CheckRegisterByte(RegisterType::D, 0xEF);
    CheckRegisterByte(RegisterType::E, 0x4E);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x41);
    CheckRegisterByte(RegisterType::L, 0x4E);
    CheckRegisterWord(RegisterType::PC, 0x9D1F);
    CheckRegisterWord(RegisterType::SP, 0x2744);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2742, 0x4E);
    CheckMemory(0x2743, 0xEF);
    CheckMemory(0x9D1E, 0xD1);
}

void test_D1_0203()
{
    if (skip_test_D1_0203)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1323);
    WriteRegisterWord(RegisterType::SP, 0x78C4);
    WriteRegisterByte(RegisterType::A, 0xA8);
    WriteRegisterByte(RegisterType::B, 0xA8);
    WriteRegisterByte(RegisterType::C, 0x9E);
    WriteRegisterByte(RegisterType::D, 0x5D);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x0B);
    WriteRegisterByte(RegisterType::L, 0x78);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x78C5, 0xB2);
    WriteMemory(0x78C4, 0x9A);
    WriteMemory(0x1323, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA8);
    CheckRegisterByte(RegisterType::B, 0xA8);
    CheckRegisterByte(RegisterType::C, 0x9E);
    CheckRegisterByte(RegisterType::D, 0xB2);
    CheckRegisterByte(RegisterType::E, 0x9A);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x0B);
    CheckRegisterByte(RegisterType::L, 0x78);
    CheckRegisterWord(RegisterType::PC, 0x1324);
    CheckRegisterWord(RegisterType::SP, 0x78C6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1323, 0xD1);
    CheckMemory(0x78C4, 0x9A);
    CheckMemory(0x78C5, 0xB2);
}

void test_D1_0204()
{
    if (skip_test_D1_0204)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x00F9);
    WriteRegisterWord(RegisterType::SP, 0x93CE);
    WriteRegisterByte(RegisterType::A, 0x1F);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0x61);
    WriteRegisterByte(RegisterType::E, 0x29);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x10);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x93CF, 0x88);
    WriteMemory(0x93CE, 0x2E);
    WriteMemory(0x00F9, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1F);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0x88);
    CheckRegisterByte(RegisterType::E, 0x2E);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x10);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0x00FA);
    CheckRegisterWord(RegisterType::SP, 0x93D0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x00F9, 0xD1);
    CheckMemory(0x93CE, 0x2E);
    CheckMemory(0x93CF, 0x88);
}

void test_D1_0205()
{
    if (skip_test_D1_0205)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFDDB);
    WriteRegisterWord(RegisterType::SP, 0xCFBB);
    WriteRegisterByte(RegisterType::A, 0xB4);
    WriteRegisterByte(RegisterType::B, 0x71);
    WriteRegisterByte(RegisterType::C, 0xD3);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0x45);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0x61);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFDDB, 0xD1);
    WriteMemory(0xCFBC, 0x7C);
    WriteMemory(0xCFBB, 0x8B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB4);
    CheckRegisterByte(RegisterType::B, 0x71);
    CheckRegisterByte(RegisterType::C, 0xD3);
    CheckRegisterByte(RegisterType::D, 0x7C);
    CheckRegisterByte(RegisterType::E, 0x8B);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0x61);
    CheckRegisterWord(RegisterType::PC, 0xFDDC);
    CheckRegisterWord(RegisterType::SP, 0xCFBD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCFBB, 0x8B);
    CheckMemory(0xCFBC, 0x7C);
    CheckMemory(0xFDDB, 0xD1);
}

void test_D1_0206()
{
    if (skip_test_D1_0206)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBB4B);
    WriteRegisterWord(RegisterType::SP, 0x1A1D);
    WriteRegisterByte(RegisterType::A, 0xD8);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0xDF);
    WriteRegisterByte(RegisterType::E, 0xA1);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0xD3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBB4B, 0xD1);
    WriteMemory(0x1A1E, 0xC3);
    WriteMemory(0x1A1D, 0x7E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD8);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0xC3);
    CheckRegisterByte(RegisterType::E, 0x7E);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0xD3);
    CheckRegisterWord(RegisterType::PC, 0xBB4C);
    CheckRegisterWord(RegisterType::SP, 0x1A1F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1A1D, 0x7E);
    CheckMemory(0x1A1E, 0xC3);
    CheckMemory(0xBB4B, 0xD1);
}

void test_D1_0207()
{
    if (skip_test_D1_0207)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF946);
    WriteRegisterWord(RegisterType::SP, 0xAB9D);
    WriteRegisterByte(RegisterType::A, 0x4B);
    WriteRegisterByte(RegisterType::B, 0x6A);
    WriteRegisterByte(RegisterType::C, 0x63);
    WriteRegisterByte(RegisterType::D, 0x61);
    WriteRegisterByte(RegisterType::E, 0x9F);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xE4);
    WriteRegisterByte(RegisterType::L, 0xF7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF946, 0xD1);
    WriteMemory(0xAB9E, 0xCB);
    WriteMemory(0xAB9D, 0x4A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4B);
    CheckRegisterByte(RegisterType::B, 0x6A);
    CheckRegisterByte(RegisterType::C, 0x63);
    CheckRegisterByte(RegisterType::D, 0xCB);
    CheckRegisterByte(RegisterType::E, 0x4A);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xE4);
    CheckRegisterByte(RegisterType::L, 0xF7);
    CheckRegisterWord(RegisterType::PC, 0xF947);
    CheckRegisterWord(RegisterType::SP, 0xAB9F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAB9D, 0x4A);
    CheckMemory(0xAB9E, 0xCB);
    CheckMemory(0xF946, 0xD1);
}

void test_D1_0208()
{
    if (skip_test_D1_0208)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD6C8);
    WriteRegisterWord(RegisterType::SP, 0xCD5E);
    WriteRegisterByte(RegisterType::A, 0x8F);
    WriteRegisterByte(RegisterType::B, 0xF1);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0x23);
    WriteRegisterByte(RegisterType::E, 0x89);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xCA);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD6C8, 0xD1);
    WriteMemory(0xCD5F, 0x12);
    WriteMemory(0xCD5E, 0xEB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8F);
    CheckRegisterByte(RegisterType::B, 0xF1);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0x12);
    CheckRegisterByte(RegisterType::E, 0xEB);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xCA);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0xD6C9);
    CheckRegisterWord(RegisterType::SP, 0xCD60);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCD5E, 0xEB);
    CheckMemory(0xCD5F, 0x12);
    CheckMemory(0xD6C8, 0xD1);
}

void test_D1_0209()
{
    if (skip_test_D1_0209)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x37C2);
    WriteRegisterWord(RegisterType::SP, 0xE181);
    WriteRegisterByte(RegisterType::A, 0xA5);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x1B);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0x35);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x9B);
    WriteRegisterByte(RegisterType::L, 0x4D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE182, 0x55);
    WriteMemory(0xE181, 0xDB);
    WriteMemory(0x37C2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA5);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x1B);
    CheckRegisterByte(RegisterType::D, 0x55);
    CheckRegisterByte(RegisterType::E, 0xDB);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x9B);
    CheckRegisterByte(RegisterType::L, 0x4D);
    CheckRegisterWord(RegisterType::PC, 0x37C3);
    CheckRegisterWord(RegisterType::SP, 0xE183);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x37C2, 0xD1);
    CheckMemory(0xE181, 0xDB);
    CheckMemory(0xE182, 0x55);
}

void test_D1_020A()
{
    if (skip_test_D1_020A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x664A);
    WriteRegisterWord(RegisterType::SP, 0x4447);
    WriteRegisterByte(RegisterType::A, 0x0A);
    WriteRegisterByte(RegisterType::B, 0xBB);
    WriteRegisterByte(RegisterType::C, 0xB0);
    WriteRegisterByte(RegisterType::D, 0x39);
    WriteRegisterByte(RegisterType::E, 0x1D);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0xF8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x664A, 0xD1);
    WriteMemory(0x4448, 0x88);
    WriteMemory(0x4447, 0xAE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0A);
    CheckRegisterByte(RegisterType::B, 0xBB);
    CheckRegisterByte(RegisterType::C, 0xB0);
    CheckRegisterByte(RegisterType::D, 0x88);
    CheckRegisterByte(RegisterType::E, 0xAE);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0xF8);
    CheckRegisterWord(RegisterType::PC, 0x664B);
    CheckRegisterWord(RegisterType::SP, 0x4449);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4447, 0xAE);
    CheckMemory(0x4448, 0x88);
    CheckMemory(0x664A, 0xD1);
}

void test_D1_020B()
{
    if (skip_test_D1_020B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB5AD);
    WriteRegisterWord(RegisterType::SP, 0x37CD);
    WriteRegisterByte(RegisterType::A, 0xDA);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0xC1);
    WriteRegisterByte(RegisterType::D, 0x90);
    WriteRegisterByte(RegisterType::E, 0xDD);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x01);
    WriteRegisterByte(RegisterType::L, 0xE6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB5AD, 0xD1);
    WriteMemory(0x37CE, 0x43);
    WriteMemory(0x37CD, 0x8E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDA);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0xC1);
    CheckRegisterByte(RegisterType::D, 0x43);
    CheckRegisterByte(RegisterType::E, 0x8E);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x01);
    CheckRegisterByte(RegisterType::L, 0xE6);
    CheckRegisterWord(RegisterType::PC, 0xB5AE);
    CheckRegisterWord(RegisterType::SP, 0x37CF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x37CD, 0x8E);
    CheckMemory(0x37CE, 0x43);
    CheckMemory(0xB5AD, 0xD1);
}

void test_D1_020C()
{
    if (skip_test_D1_020C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x95A6);
    WriteRegisterWord(RegisterType::SP, 0x2225);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0xAE);
    WriteRegisterByte(RegisterType::C, 0x79);
    WriteRegisterByte(RegisterType::D, 0x94);
    WriteRegisterByte(RegisterType::E, 0xE8);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x45);
    WriteRegisterByte(RegisterType::L, 0xDB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x95A6, 0xD1);
    WriteMemory(0x2226, 0x48);
    WriteMemory(0x2225, 0x84);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0xAE);
    CheckRegisterByte(RegisterType::C, 0x79);
    CheckRegisterByte(RegisterType::D, 0x48);
    CheckRegisterByte(RegisterType::E, 0x84);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x45);
    CheckRegisterByte(RegisterType::L, 0xDB);
    CheckRegisterWord(RegisterType::PC, 0x95A7);
    CheckRegisterWord(RegisterType::SP, 0x2227);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2225, 0x84);
    CheckMemory(0x2226, 0x48);
    CheckMemory(0x95A6, 0xD1);
}

void test_D1_020D()
{
    if (skip_test_D1_020D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x87F5);
    WriteRegisterWord(RegisterType::SP, 0x5CB4);
    WriteRegisterByte(RegisterType::A, 0x23);
    WriteRegisterByte(RegisterType::B, 0x42);
    WriteRegisterByte(RegisterType::C, 0x81);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x61);
    WriteRegisterByte(RegisterType::L, 0xA1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x87F5, 0xD1);
    WriteMemory(0x5CB5, 0xCE);
    WriteMemory(0x5CB4, 0xC4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x23);
    CheckRegisterByte(RegisterType::B, 0x42);
    CheckRegisterByte(RegisterType::C, 0x81);
    CheckRegisterByte(RegisterType::D, 0xCE);
    CheckRegisterByte(RegisterType::E, 0xC4);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x61);
    CheckRegisterByte(RegisterType::L, 0xA1);
    CheckRegisterWord(RegisterType::PC, 0x87F6);
    CheckRegisterWord(RegisterType::SP, 0x5CB6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5CB4, 0xC4);
    CheckMemory(0x5CB5, 0xCE);
    CheckMemory(0x87F5, 0xD1);
}

void test_D1_020E()
{
    if (skip_test_D1_020E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA6A8);
    WriteRegisterWord(RegisterType::SP, 0xB7A8);
    WriteRegisterByte(RegisterType::A, 0x9C);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0x28);
    WriteRegisterByte(RegisterType::D, 0xF0);
    WriteRegisterByte(RegisterType::E, 0x08);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xAF);
    WriteRegisterByte(RegisterType::L, 0x15);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB7A9, 0x54);
    WriteMemory(0xB7A8, 0xEE);
    WriteMemory(0xA6A8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9C);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0x28);
    CheckRegisterByte(RegisterType::D, 0x54);
    CheckRegisterByte(RegisterType::E, 0xEE);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xAF);
    CheckRegisterByte(RegisterType::L, 0x15);
    CheckRegisterWord(RegisterType::PC, 0xA6A9);
    CheckRegisterWord(RegisterType::SP, 0xB7AA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA6A8, 0xD1);
    CheckMemory(0xB7A8, 0xEE);
    CheckMemory(0xB7A9, 0x54);
}

void test_D1_020F()
{
    if (skip_test_D1_020F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x07C1);
    WriteRegisterWord(RegisterType::SP, 0x84DF);
    WriteRegisterByte(RegisterType::A, 0x5B);
    WriteRegisterByte(RegisterType::B, 0x18);
    WriteRegisterByte(RegisterType::C, 0x8D);
    WriteRegisterByte(RegisterType::D, 0x47);
    WriteRegisterByte(RegisterType::E, 0x1C);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xD9);
    WriteRegisterByte(RegisterType::L, 0xF4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x84E0, 0x35);
    WriteMemory(0x84DF, 0x47);
    WriteMemory(0x07C1, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5B);
    CheckRegisterByte(RegisterType::B, 0x18);
    CheckRegisterByte(RegisterType::C, 0x8D);
    CheckRegisterByte(RegisterType::D, 0x35);
    CheckRegisterByte(RegisterType::E, 0x47);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xD9);
    CheckRegisterByte(RegisterType::L, 0xF4);
    CheckRegisterWord(RegisterType::PC, 0x07C2);
    CheckRegisterWord(RegisterType::SP, 0x84E1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x07C1, 0xD1);
    CheckMemory(0x84DF, 0x47);
    CheckMemory(0x84E0, 0x35);
}

void test_D1_0210()
{
    if (skip_test_D1_0210)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEDD3);
    WriteRegisterWord(RegisterType::SP, 0x9B87);
    WriteRegisterByte(RegisterType::A, 0x83);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x33);
    WriteRegisterByte(RegisterType::D, 0x4C);
    WriteRegisterByte(RegisterType::E, 0x61);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x05);
    WriteRegisterByte(RegisterType::L, 0xBA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEDD3, 0xD1);
    WriteMemory(0x9B88, 0x01);
    WriteMemory(0x9B87, 0x1F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x83);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x33);
    CheckRegisterByte(RegisterType::D, 0x01);
    CheckRegisterByte(RegisterType::E, 0x1F);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x05);
    CheckRegisterByte(RegisterType::L, 0xBA);
    CheckRegisterWord(RegisterType::PC, 0xEDD4);
    CheckRegisterWord(RegisterType::SP, 0x9B89);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9B87, 0x1F);
    CheckMemory(0x9B88, 0x01);
    CheckMemory(0xEDD3, 0xD1);
}

void test_D1_0211()
{
    if (skip_test_D1_0211)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x96E8);
    WriteRegisterWord(RegisterType::SP, 0x24CB);
    WriteRegisterByte(RegisterType::A, 0x76);
    WriteRegisterByte(RegisterType::B, 0xF9);
    WriteRegisterByte(RegisterType::C, 0x0D);
    WriteRegisterByte(RegisterType::D, 0x0F);
    WriteRegisterByte(RegisterType::E, 0x76);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0x68);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x96E8, 0xD1);
    WriteMemory(0x24CC, 0x06);
    WriteMemory(0x24CB, 0xFE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x76);
    CheckRegisterByte(RegisterType::B, 0xF9);
    CheckRegisterByte(RegisterType::C, 0x0D);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0xFE);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0x68);
    CheckRegisterWord(RegisterType::PC, 0x96E9);
    CheckRegisterWord(RegisterType::SP, 0x24CD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x24CB, 0xFE);
    CheckMemory(0x24CC, 0x06);
    CheckMemory(0x96E8, 0xD1);
}

void test_D1_0212()
{
    if (skip_test_D1_0212)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2BD6);
    WriteRegisterWord(RegisterType::SP, 0x2610);
    WriteRegisterByte(RegisterType::A, 0x4B);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0xCA);
    WriteRegisterByte(RegisterType::E, 0xF8);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x20);
    WriteRegisterByte(RegisterType::L, 0x47);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2BD6, 0xD1);
    WriteMemory(0x2611, 0x9A);
    WriteMemory(0x2610, 0x57);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4B);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0x57);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x20);
    CheckRegisterByte(RegisterType::L, 0x47);
    CheckRegisterWord(RegisterType::PC, 0x2BD7);
    CheckRegisterWord(RegisterType::SP, 0x2612);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2610, 0x57);
    CheckMemory(0x2611, 0x9A);
    CheckMemory(0x2BD6, 0xD1);
}

void test_D1_0213()
{
    if (skip_test_D1_0213)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9D4A);
    WriteRegisterWord(RegisterType::SP, 0x75D8);
    WriteRegisterByte(RegisterType::A, 0xA8);
    WriteRegisterByte(RegisterType::B, 0xAC);
    WriteRegisterByte(RegisterType::C, 0xEC);
    WriteRegisterByte(RegisterType::D, 0xB4);
    WriteRegisterByte(RegisterType::E, 0x9C);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD3);
    WriteRegisterByte(RegisterType::L, 0x68);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9D4A, 0xD1);
    WriteMemory(0x75D9, 0xD5);
    WriteMemory(0x75D8, 0x3D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA8);
    CheckRegisterByte(RegisterType::B, 0xAC);
    CheckRegisterByte(RegisterType::C, 0xEC);
    CheckRegisterByte(RegisterType::D, 0xD5);
    CheckRegisterByte(RegisterType::E, 0x3D);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD3);
    CheckRegisterByte(RegisterType::L, 0x68);
    CheckRegisterWord(RegisterType::PC, 0x9D4B);
    CheckRegisterWord(RegisterType::SP, 0x75DA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x75D8, 0x3D);
    CheckMemory(0x75D9, 0xD5);
    CheckMemory(0x9D4A, 0xD1);
}

void test_D1_0214()
{
    if (skip_test_D1_0214)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB1B2);
    WriteRegisterWord(RegisterType::SP, 0xA424);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0xF3);
    WriteRegisterByte(RegisterType::C, 0xE4);
    WriteRegisterByte(RegisterType::D, 0x4C);
    WriteRegisterByte(RegisterType::E, 0x9E);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xA3);
    WriteRegisterByte(RegisterType::L, 0x88);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB1B2, 0xD1);
    WriteMemory(0xA425, 0xA7);
    WriteMemory(0xA424, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0xF3);
    CheckRegisterByte(RegisterType::C, 0xE4);
    CheckRegisterByte(RegisterType::D, 0xA7);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xA3);
    CheckRegisterByte(RegisterType::L, 0x88);
    CheckRegisterWord(RegisterType::PC, 0xB1B3);
    CheckRegisterWord(RegisterType::SP, 0xA426);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA424, 0xD1);
    CheckMemory(0xA425, 0xA7);
    CheckMemory(0xB1B2, 0xD1);
}

void test_D1_0215()
{
    if (skip_test_D1_0215)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0F30);
    WriteRegisterWord(RegisterType::SP, 0x9EE6);
    WriteRegisterByte(RegisterType::A, 0xFC);
    WriteRegisterByte(RegisterType::B, 0x04);
    WriteRegisterByte(RegisterType::C, 0x81);
    WriteRegisterByte(RegisterType::D, 0x4D);
    WriteRegisterByte(RegisterType::E, 0xAE);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x47);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9EE7, 0xA7);
    WriteMemory(0x9EE6, 0x74);
    WriteMemory(0x0F30, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFC);
    CheckRegisterByte(RegisterType::B, 0x04);
    CheckRegisterByte(RegisterType::C, 0x81);
    CheckRegisterByte(RegisterType::D, 0xA7);
    CheckRegisterByte(RegisterType::E, 0x74);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x47);
    CheckRegisterWord(RegisterType::PC, 0x0F31);
    CheckRegisterWord(RegisterType::SP, 0x9EE8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0F30, 0xD1);
    CheckMemory(0x9EE6, 0x74);
    CheckMemory(0x9EE7, 0xA7);
}

void test_D1_0216()
{
    if (skip_test_D1_0216)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0C33);
    WriteRegisterWord(RegisterType::SP, 0x8DED);
    WriteRegisterByte(RegisterType::A, 0x80);
    WriteRegisterByte(RegisterType::B, 0xC3);
    WriteRegisterByte(RegisterType::C, 0x52);
    WriteRegisterByte(RegisterType::D, 0xD3);
    WriteRegisterByte(RegisterType::E, 0xA1);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x3C);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x8DEE, 0x63);
    WriteMemory(0x8DED, 0xA0);
    WriteMemory(0x0C33, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x80);
    CheckRegisterByte(RegisterType::B, 0xC3);
    CheckRegisterByte(RegisterType::C, 0x52);
    CheckRegisterByte(RegisterType::D, 0x63);
    CheckRegisterByte(RegisterType::E, 0xA0);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x3C);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0x0C34);
    CheckRegisterWord(RegisterType::SP, 0x8DEF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0C33, 0xD1);
    CheckMemory(0x8DED, 0xA0);
    CheckMemory(0x8DEE, 0x63);
}

void test_D1_0217()
{
    if (skip_test_D1_0217)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9E96);
    WriteRegisterWord(RegisterType::SP, 0xEB95);
    WriteRegisterByte(RegisterType::A, 0x9E);
    WriteRegisterByte(RegisterType::B, 0x7C);
    WriteRegisterByte(RegisterType::C, 0x5C);
    WriteRegisterByte(RegisterType::D, 0x5F);
    WriteRegisterByte(RegisterType::E, 0xC1);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0xC8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEB96, 0xD2);
    WriteMemory(0xEB95, 0xD2);
    WriteMemory(0x9E96, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9E);
    CheckRegisterByte(RegisterType::B, 0x7C);
    CheckRegisterByte(RegisterType::C, 0x5C);
    CheckRegisterByte(RegisterType::D, 0xD2);
    CheckRegisterByte(RegisterType::E, 0xD2);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0xC8);
    CheckRegisterWord(RegisterType::PC, 0x9E97);
    CheckRegisterWord(RegisterType::SP, 0xEB97);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9E96, 0xD1);
    CheckMemory(0xEB95, 0xD2);
    CheckMemory(0xEB96, 0xD2);
}

void test_D1_0218()
{
    if (skip_test_D1_0218)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4F4C);
    WriteRegisterWord(RegisterType::SP, 0xAFB5);
    WriteRegisterByte(RegisterType::A, 0x98);
    WriteRegisterByte(RegisterType::B, 0x54);
    WriteRegisterByte(RegisterType::C, 0xDF);
    WriteRegisterByte(RegisterType::D, 0xA0);
    WriteRegisterByte(RegisterType::E, 0x42);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x37);
    WriteRegisterByte(RegisterType::L, 0x79);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAFB6, 0x6D);
    WriteMemory(0xAFB5, 0x0B);
    WriteMemory(0x4F4C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x98);
    CheckRegisterByte(RegisterType::B, 0x54);
    CheckRegisterByte(RegisterType::C, 0xDF);
    CheckRegisterByte(RegisterType::D, 0x6D);
    CheckRegisterByte(RegisterType::E, 0x0B);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x37);
    CheckRegisterByte(RegisterType::L, 0x79);
    CheckRegisterWord(RegisterType::PC, 0x4F4D);
    CheckRegisterWord(RegisterType::SP, 0xAFB7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4F4C, 0xD1);
    CheckMemory(0xAFB5, 0x0B);
    CheckMemory(0xAFB6, 0x6D);
}

void test_D1_0219()
{
    if (skip_test_D1_0219)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x35F0);
    WriteRegisterWord(RegisterType::SP, 0x1820);
    WriteRegisterByte(RegisterType::A, 0xD3);
    WriteRegisterByte(RegisterType::B, 0x1D);
    WriteRegisterByte(RegisterType::C, 0x11);
    WriteRegisterByte(RegisterType::D, 0x5F);
    WriteRegisterByte(RegisterType::E, 0x65);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0x01);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x35F0, 0xD1);
    WriteMemory(0x1821, 0xAE);
    WriteMemory(0x1820, 0xBA);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD3);
    CheckRegisterByte(RegisterType::B, 0x1D);
    CheckRegisterByte(RegisterType::C, 0x11);
    CheckRegisterByte(RegisterType::D, 0xAE);
    CheckRegisterByte(RegisterType::E, 0xBA);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0x01);
    CheckRegisterWord(RegisterType::PC, 0x35F1);
    CheckRegisterWord(RegisterType::SP, 0x1822);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1820, 0xBA);
    CheckMemory(0x1821, 0xAE);
    CheckMemory(0x35F0, 0xD1);
}

void test_D1_021A()
{
    if (skip_test_D1_021A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE794);
    WriteRegisterWord(RegisterType::SP, 0x8E9D);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0x9B);
    WriteRegisterByte(RegisterType::C, 0xC3);
    WriteRegisterByte(RegisterType::D, 0x95);
    WriteRegisterByte(RegisterType::E, 0xC9);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0x63);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE794, 0xD1);
    WriteMemory(0x8E9E, 0x6A);
    WriteMemory(0x8E9D, 0xD8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0x9B);
    CheckRegisterByte(RegisterType::C, 0xC3);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0xD8);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0x63);
    CheckRegisterWord(RegisterType::PC, 0xE795);
    CheckRegisterWord(RegisterType::SP, 0x8E9F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8E9D, 0xD8);
    CheckMemory(0x8E9E, 0x6A);
    CheckMemory(0xE794, 0xD1);
}

void test_D1_021B()
{
    if (skip_test_D1_021B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x24F5);
    WriteRegisterWord(RegisterType::SP, 0x70A5);
    WriteRegisterByte(RegisterType::A, 0x55);
    WriteRegisterByte(RegisterType::B, 0xC6);
    WriteRegisterByte(RegisterType::C, 0x7A);
    WriteRegisterByte(RegisterType::D, 0x84);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x77);
    WriteRegisterByte(RegisterType::L, 0x8A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x70A6, 0xB8);
    WriteMemory(0x70A5, 0xFF);
    WriteMemory(0x24F5, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x55);
    CheckRegisterByte(RegisterType::B, 0xC6);
    CheckRegisterByte(RegisterType::C, 0x7A);
    CheckRegisterByte(RegisterType::D, 0xB8);
    CheckRegisterByte(RegisterType::E, 0xFF);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x77);
    CheckRegisterByte(RegisterType::L, 0x8A);
    CheckRegisterWord(RegisterType::PC, 0x24F6);
    CheckRegisterWord(RegisterType::SP, 0x70A7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x24F5, 0xD1);
    CheckMemory(0x70A5, 0xFF);
    CheckMemory(0x70A6, 0xB8);
}

void test_D1_021C()
{
    if (skip_test_D1_021C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD0E8);
    WriteRegisterWord(RegisterType::SP, 0x5A65);
    WriteRegisterByte(RegisterType::A, 0x62);
    WriteRegisterByte(RegisterType::B, 0x5C);
    WriteRegisterByte(RegisterType::C, 0xC5);
    WriteRegisterByte(RegisterType::D, 0x69);
    WriteRegisterByte(RegisterType::E, 0x25);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xC3);
    WriteRegisterByte(RegisterType::L, 0x01);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD0E8, 0xD1);
    WriteMemory(0x5A66, 0x21);
    WriteMemory(0x5A65, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x62);
    CheckRegisterByte(RegisterType::B, 0x5C);
    CheckRegisterByte(RegisterType::C, 0xC5);
    CheckRegisterByte(RegisterType::D, 0x21);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xC3);
    CheckRegisterByte(RegisterType::L, 0x01);
    CheckRegisterWord(RegisterType::PC, 0xD0E9);
    CheckRegisterWord(RegisterType::SP, 0x5A67);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5A65, 0xD1);
    CheckMemory(0x5A66, 0x21);
    CheckMemory(0xD0E8, 0xD1);
}

void test_D1_021D()
{
    if (skip_test_D1_021D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x16F7);
    WriteRegisterWord(RegisterType::SP, 0xFE4B);
    WriteRegisterByte(RegisterType::A, 0xE0);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0xA3);
    WriteRegisterByte(RegisterType::D, 0x26);
    WriteRegisterByte(RegisterType::E, 0xD5);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x43);
    WriteRegisterByte(RegisterType::L, 0x92);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFE4C, 0xF3);
    WriteMemory(0xFE4B, 0x46);
    WriteMemory(0x16F7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE0);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0xA3);
    CheckRegisterByte(RegisterType::D, 0xF3);
    CheckRegisterByte(RegisterType::E, 0x46);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x43);
    CheckRegisterByte(RegisterType::L, 0x92);
    CheckRegisterWord(RegisterType::PC, 0x16F8);
    CheckRegisterWord(RegisterType::SP, 0xFE4D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x16F7, 0xD1);
    CheckMemory(0xFE4B, 0x46);
    CheckMemory(0xFE4C, 0xF3);
}

void test_D1_021E()
{
    if (skip_test_D1_021E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x13D1);
    WriteRegisterWord(RegisterType::SP, 0x97CE);
    WriteRegisterByte(RegisterType::A, 0x3E);
    WriteRegisterByte(RegisterType::B, 0xE4);
    WriteRegisterByte(RegisterType::C, 0x0E);
    WriteRegisterByte(RegisterType::D, 0x43);
    WriteRegisterByte(RegisterType::E, 0x42);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x2A);
    WriteRegisterByte(RegisterType::L, 0x49);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x97CF, 0xBC);
    WriteMemory(0x97CE, 0xA2);
    WriteMemory(0x13D1, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3E);
    CheckRegisterByte(RegisterType::B, 0xE4);
    CheckRegisterByte(RegisterType::C, 0x0E);
    CheckRegisterByte(RegisterType::D, 0xBC);
    CheckRegisterByte(RegisterType::E, 0xA2);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x2A);
    CheckRegisterByte(RegisterType::L, 0x49);
    CheckRegisterWord(RegisterType::PC, 0x13D2);
    CheckRegisterWord(RegisterType::SP, 0x97D0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x13D1, 0xD1);
    CheckMemory(0x97CE, 0xA2);
    CheckMemory(0x97CF, 0xBC);
}

void test_D1_021F()
{
    if (skip_test_D1_021F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC758);
    WriteRegisterWord(RegisterType::SP, 0xCB7D);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0xA1);
    WriteRegisterByte(RegisterType::C, 0x39);
    WriteRegisterByte(RegisterType::D, 0x4F);
    WriteRegisterByte(RegisterType::E, 0x79);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xF8);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCB7E, 0x57);
    WriteMemory(0xCB7D, 0x16);
    WriteMemory(0xC758, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0xA1);
    CheckRegisterByte(RegisterType::C, 0x39);
    CheckRegisterByte(RegisterType::D, 0x57);
    CheckRegisterByte(RegisterType::E, 0x16);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xF8);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0xC759);
    CheckRegisterWord(RegisterType::SP, 0xCB7F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC758, 0xD1);
    CheckMemory(0xCB7D, 0x16);
    CheckMemory(0xCB7E, 0x57);
}

void test_D1_0220()
{
    if (skip_test_D1_0220)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBACC);
    WriteRegisterWord(RegisterType::SP, 0x765C);
    WriteRegisterByte(RegisterType::A, 0xE6);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0xAA);
    WriteRegisterByte(RegisterType::D, 0x6E);
    WriteRegisterByte(RegisterType::E, 0x8B);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x14);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBACC, 0xD1);
    WriteMemory(0x765D, 0x5F);
    WriteMemory(0x765C, 0x93);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE6);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0xAA);
    CheckRegisterByte(RegisterType::D, 0x5F);
    CheckRegisterByte(RegisterType::E, 0x93);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x14);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0xBACD);
    CheckRegisterWord(RegisterType::SP, 0x765E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x765C, 0x93);
    CheckMemory(0x765D, 0x5F);
    CheckMemory(0xBACC, 0xD1);
}

void test_D1_0221()
{
    if (skip_test_D1_0221)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0D9F);
    WriteRegisterWord(RegisterType::SP, 0x5C0E);
    WriteRegisterByte(RegisterType::A, 0xF7);
    WriteRegisterByte(RegisterType::B, 0x92);
    WriteRegisterByte(RegisterType::C, 0x27);
    WriteRegisterByte(RegisterType::D, 0xB5);
    WriteRegisterByte(RegisterType::E, 0xF1);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x6E);
    WriteRegisterByte(RegisterType::L, 0x96);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5C0F, 0xC8);
    WriteMemory(0x5C0E, 0x7B);
    WriteMemory(0x0D9F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF7);
    CheckRegisterByte(RegisterType::B, 0x92);
    CheckRegisterByte(RegisterType::C, 0x27);
    CheckRegisterByte(RegisterType::D, 0xC8);
    CheckRegisterByte(RegisterType::E, 0x7B);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x6E);
    CheckRegisterByte(RegisterType::L, 0x96);
    CheckRegisterWord(RegisterType::PC, 0x0DA0);
    CheckRegisterWord(RegisterType::SP, 0x5C10);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0D9F, 0xD1);
    CheckMemory(0x5C0E, 0x7B);
    CheckMemory(0x5C0F, 0xC8);
}

void test_D1_0222()
{
    if (skip_test_D1_0222)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1CA2);
    WriteRegisterWord(RegisterType::SP, 0x0E1D);
    WriteRegisterByte(RegisterType::A, 0xB6);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0x32);
    WriteRegisterByte(RegisterType::E, 0xED);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x94);
    WriteRegisterByte(RegisterType::L, 0xA1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x1CA2, 0xD1);
    WriteMemory(0x0E1E, 0x9D);
    WriteMemory(0x0E1D, 0xA5);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB6);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0x9D);
    CheckRegisterByte(RegisterType::E, 0xA5);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x94);
    CheckRegisterByte(RegisterType::L, 0xA1);
    CheckRegisterWord(RegisterType::PC, 0x1CA3);
    CheckRegisterWord(RegisterType::SP, 0x0E1F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0E1D, 0xA5);
    CheckMemory(0x0E1E, 0x9D);
    CheckMemory(0x1CA2, 0xD1);
}

void test_D1_0223()
{
    if (skip_test_D1_0223)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x29A8);
    WriteRegisterWord(RegisterType::SP, 0xFA3A);
    WriteRegisterByte(RegisterType::A, 0x41);
    WriteRegisterByte(RegisterType::B, 0x16);
    WriteRegisterByte(RegisterType::C, 0x97);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xB5);
    WriteRegisterByte(RegisterType::L, 0x37);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFA3B, 0x4B);
    WriteMemory(0xFA3A, 0xF8);
    WriteMemory(0x29A8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x41);
    CheckRegisterByte(RegisterType::B, 0x16);
    CheckRegisterByte(RegisterType::C, 0x97);
    CheckRegisterByte(RegisterType::D, 0x4B);
    CheckRegisterByte(RegisterType::E, 0xF8);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xB5);
    CheckRegisterByte(RegisterType::L, 0x37);
    CheckRegisterWord(RegisterType::PC, 0x29A9);
    CheckRegisterWord(RegisterType::SP, 0xFA3C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x29A8, 0xD1);
    CheckMemory(0xFA3A, 0xF8);
    CheckMemory(0xFA3B, 0x4B);
}

void test_D1_0224()
{
    if (skip_test_D1_0224)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6FD6);
    WriteRegisterWord(RegisterType::SP, 0xE5A4);
    WriteRegisterByte(RegisterType::A, 0x87);
    WriteRegisterByte(RegisterType::B, 0x61);
    WriteRegisterByte(RegisterType::C, 0x36);
    WriteRegisterByte(RegisterType::D, 0x30);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0x4F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE5A5, 0x68);
    WriteMemory(0xE5A4, 0x13);
    WriteMemory(0x6FD6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x87);
    CheckRegisterByte(RegisterType::B, 0x61);
    CheckRegisterByte(RegisterType::C, 0x36);
    CheckRegisterByte(RegisterType::D, 0x68);
    CheckRegisterByte(RegisterType::E, 0x13);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0x4F);
    CheckRegisterWord(RegisterType::PC, 0x6FD7);
    CheckRegisterWord(RegisterType::SP, 0xE5A6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6FD6, 0xD1);
    CheckMemory(0xE5A4, 0x13);
    CheckMemory(0xE5A5, 0x68);
}

void test_D1_0225()
{
    if (skip_test_D1_0225)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA5B5);
    WriteRegisterWord(RegisterType::SP, 0x2446);
    WriteRegisterByte(RegisterType::A, 0x65);
    WriteRegisterByte(RegisterType::B, 0x83);
    WriteRegisterByte(RegisterType::C, 0x50);
    WriteRegisterByte(RegisterType::D, 0x20);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0xEB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA5B5, 0xD1);
    WriteMemory(0x2447, 0xF5);
    WriteMemory(0x2446, 0x05);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x65);
    CheckRegisterByte(RegisterType::B, 0x83);
    CheckRegisterByte(RegisterType::C, 0x50);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x05);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0xEB);
    CheckRegisterWord(RegisterType::PC, 0xA5B6);
    CheckRegisterWord(RegisterType::SP, 0x2448);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2446, 0x05);
    CheckMemory(0x2447, 0xF5);
    CheckMemory(0xA5B5, 0xD1);
}

void test_D1_0226()
{
    if (skip_test_D1_0226)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5440);
    WriteRegisterWord(RegisterType::SP, 0xC3B7);
    WriteRegisterByte(RegisterType::A, 0x13);
    WriteRegisterByte(RegisterType::B, 0x08);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0xE6);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC3B8, 0x1D);
    WriteMemory(0xC3B7, 0xA8);
    WriteMemory(0x5440, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x13);
    CheckRegisterByte(RegisterType::B, 0x08);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0x1D);
    CheckRegisterByte(RegisterType::E, 0xA8);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0x5441);
    CheckRegisterWord(RegisterType::SP, 0xC3B9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5440, 0xD1);
    CheckMemory(0xC3B7, 0xA8);
    CheckMemory(0xC3B8, 0x1D);
}

void test_D1_0227()
{
    if (skip_test_D1_0227)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4473);
    WriteRegisterWord(RegisterType::SP, 0x6F33);
    WriteRegisterByte(RegisterType::A, 0x34);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0x32);
    WriteRegisterByte(RegisterType::D, 0xCF);
    WriteRegisterByte(RegisterType::E, 0xEC);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x76);
    WriteRegisterByte(RegisterType::L, 0xDB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6F34, 0x15);
    WriteMemory(0x6F33, 0xBA);
    WriteMemory(0x4473, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x34);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0x32);
    CheckRegisterByte(RegisterType::D, 0x15);
    CheckRegisterByte(RegisterType::E, 0xBA);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x76);
    CheckRegisterByte(RegisterType::L, 0xDB);
    CheckRegisterWord(RegisterType::PC, 0x4474);
    CheckRegisterWord(RegisterType::SP, 0x6F35);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4473, 0xD1);
    CheckMemory(0x6F33, 0xBA);
    CheckMemory(0x6F34, 0x15);
}

void test_D1_0228()
{
    if (skip_test_D1_0228)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x91F7);
    WriteRegisterWord(RegisterType::SP, 0xF38E);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0xEF);
    WriteRegisterByte(RegisterType::C, 0xFC);
    WriteRegisterByte(RegisterType::D, 0x96);
    WriteRegisterByte(RegisterType::E, 0x06);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xB4);
    WriteRegisterByte(RegisterType::L, 0x8F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF38F, 0x95);
    WriteMemory(0xF38E, 0xDC);
    WriteMemory(0x91F7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0xEF);
    CheckRegisterByte(RegisterType::C, 0xFC);
    CheckRegisterByte(RegisterType::D, 0x95);
    CheckRegisterByte(RegisterType::E, 0xDC);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xB4);
    CheckRegisterByte(RegisterType::L, 0x8F);
    CheckRegisterWord(RegisterType::PC, 0x91F8);
    CheckRegisterWord(RegisterType::SP, 0xF390);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x91F7, 0xD1);
    CheckMemory(0xF38E, 0xDC);
    CheckMemory(0xF38F, 0x95);
}

void test_D1_0229()
{
    if (skip_test_D1_0229)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE868);
    WriteRegisterWord(RegisterType::SP, 0x7A20);
    WriteRegisterByte(RegisterType::A, 0xF3);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x22);
    WriteRegisterByte(RegisterType::D, 0x58);
    WriteRegisterByte(RegisterType::E, 0x46);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x1C);
    WriteRegisterByte(RegisterType::L, 0x10);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE868, 0xD1);
    WriteMemory(0x7A21, 0x0A);
    WriteMemory(0x7A20, 0x0A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF3);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x22);
    CheckRegisterByte(RegisterType::D, 0x0A);
    CheckRegisterByte(RegisterType::E, 0x0A);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x1C);
    CheckRegisterByte(RegisterType::L, 0x10);
    CheckRegisterWord(RegisterType::PC, 0xE869);
    CheckRegisterWord(RegisterType::SP, 0x7A22);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7A20, 0x0A);
    CheckMemory(0x7A21, 0x0A);
    CheckMemory(0xE868, 0xD1);
}

void test_D1_022A()
{
    if (skip_test_D1_022A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1224);
    WriteRegisterWord(RegisterType::SP, 0xF8AE);
    WriteRegisterByte(RegisterType::A, 0x9A);
    WriteRegisterByte(RegisterType::B, 0x69);
    WriteRegisterByte(RegisterType::C, 0x77);
    WriteRegisterByte(RegisterType::D, 0x0A);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0xD6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF8AF, 0x00);
    WriteMemory(0xF8AE, 0xC0);
    WriteMemory(0x1224, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9A);
    CheckRegisterByte(RegisterType::B, 0x69);
    CheckRegisterByte(RegisterType::C, 0x77);
    CheckRegisterByte(RegisterType::D, 0x00);
    CheckRegisterByte(RegisterType::E, 0xC0);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0xD6);
    CheckRegisterWord(RegisterType::PC, 0x1225);
    CheckRegisterWord(RegisterType::SP, 0xF8B0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1224, 0xD1);
    CheckMemory(0xF8AE, 0xC0);
    CheckMemory(0xF8AF, 0x00);
}

void test_D1_022B()
{
    if (skip_test_D1_022B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4E09);
    WriteRegisterWord(RegisterType::SP, 0xD87F);
    WriteRegisterByte(RegisterType::A, 0x75);
    WriteRegisterByte(RegisterType::B, 0xB1);
    WriteRegisterByte(RegisterType::C, 0x21);
    WriteRegisterByte(RegisterType::D, 0x6D);
    WriteRegisterByte(RegisterType::E, 0x32);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xE1);
    WriteRegisterByte(RegisterType::L, 0xBD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD880, 0x3F);
    WriteMemory(0xD87F, 0xA6);
    WriteMemory(0x4E09, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x75);
    CheckRegisterByte(RegisterType::B, 0xB1);
    CheckRegisterByte(RegisterType::C, 0x21);
    CheckRegisterByte(RegisterType::D, 0x3F);
    CheckRegisterByte(RegisterType::E, 0xA6);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xE1);
    CheckRegisterByte(RegisterType::L, 0xBD);
    CheckRegisterWord(RegisterType::PC, 0x4E0A);
    CheckRegisterWord(RegisterType::SP, 0xD881);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4E09, 0xD1);
    CheckMemory(0xD87F, 0xA6);
    CheckMemory(0xD880, 0x3F);
}

void test_D1_022C()
{
    if (skip_test_D1_022C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7219);
    WriteRegisterWord(RegisterType::SP, 0xFE6B);
    WriteRegisterByte(RegisterType::A, 0x13);
    WriteRegisterByte(RegisterType::B, 0xB9);
    WriteRegisterByte(RegisterType::C, 0x5C);
    WriteRegisterByte(RegisterType::D, 0x92);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x73);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFE6C, 0x60);
    WriteMemory(0xFE6B, 0xBE);
    WriteMemory(0x7219, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x13);
    CheckRegisterByte(RegisterType::B, 0xB9);
    CheckRegisterByte(RegisterType::C, 0x5C);
    CheckRegisterByte(RegisterType::D, 0x60);
    CheckRegisterByte(RegisterType::E, 0xBE);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x73);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0x721A);
    CheckRegisterWord(RegisterType::SP, 0xFE6D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7219, 0xD1);
    CheckMemory(0xFE6B, 0xBE);
    CheckMemory(0xFE6C, 0x60);
}

void test_D1_022D()
{
    if (skip_test_D1_022D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB659);
    WriteRegisterWord(RegisterType::SP, 0xA158);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0x8B);
    WriteRegisterByte(RegisterType::C, 0xB0);
    WriteRegisterByte(RegisterType::D, 0x03);
    WriteRegisterByte(RegisterType::E, 0xD2);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xCC);
    WriteRegisterByte(RegisterType::L, 0xF4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB659, 0xD1);
    WriteMemory(0xA159, 0xCE);
    WriteMemory(0xA158, 0xAA);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0x8B);
    CheckRegisterByte(RegisterType::C, 0xB0);
    CheckRegisterByte(RegisterType::D, 0xCE);
    CheckRegisterByte(RegisterType::E, 0xAA);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xCC);
    CheckRegisterByte(RegisterType::L, 0xF4);
    CheckRegisterWord(RegisterType::PC, 0xB65A);
    CheckRegisterWord(RegisterType::SP, 0xA15A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA158, 0xAA);
    CheckMemory(0xA159, 0xCE);
    CheckMemory(0xB659, 0xD1);
}

void test_D1_022E()
{
    if (skip_test_D1_022E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6EA0);
    WriteRegisterWord(RegisterType::SP, 0x6E21);
    WriteRegisterByte(RegisterType::A, 0x6B);
    WriteRegisterByte(RegisterType::B, 0x07);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0x0D);
    WriteRegisterByte(RegisterType::E, 0x7B);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x6F);
    WriteRegisterByte(RegisterType::L, 0x77);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6EA0, 0xD1);
    WriteMemory(0x6E22, 0x11);
    WriteMemory(0x6E21, 0x65);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6B);
    CheckRegisterByte(RegisterType::B, 0x07);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0x11);
    CheckRegisterByte(RegisterType::E, 0x65);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x6F);
    CheckRegisterByte(RegisterType::L, 0x77);
    CheckRegisterWord(RegisterType::PC, 0x6EA1);
    CheckRegisterWord(RegisterType::SP, 0x6E23);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6E21, 0x65);
    CheckMemory(0x6E22, 0x11);
    CheckMemory(0x6EA0, 0xD1);
}

void test_D1_022F()
{
    if (skip_test_D1_022F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC78B);
    WriteRegisterWord(RegisterType::SP, 0x3C63);
    WriteRegisterByte(RegisterType::A, 0x36);
    WriteRegisterByte(RegisterType::B, 0x0C);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0x08);
    WriteRegisterByte(RegisterType::E, 0x6B);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x3B);
    WriteRegisterByte(RegisterType::L, 0xA0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC78B, 0xD1);
    WriteMemory(0x3C64, 0x7D);
    WriteMemory(0x3C63, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x36);
    CheckRegisterByte(RegisterType::B, 0x0C);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0x7D);
    CheckRegisterByte(RegisterType::E, 0xE0);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x3B);
    CheckRegisterByte(RegisterType::L, 0xA0);
    CheckRegisterWord(RegisterType::PC, 0xC78C);
    CheckRegisterWord(RegisterType::SP, 0x3C65);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3C63, 0xE0);
    CheckMemory(0x3C64, 0x7D);
    CheckMemory(0xC78B, 0xD1);
}

void test_D1_0230()
{
    if (skip_test_D1_0230)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0FDA);
    WriteRegisterWord(RegisterType::SP, 0x394A);
    WriteRegisterByte(RegisterType::A, 0x40);
    WriteRegisterByte(RegisterType::B, 0xCD);
    WriteRegisterByte(RegisterType::C, 0xF0);
    WriteRegisterByte(RegisterType::D, 0x5A);
    WriteRegisterByte(RegisterType::E, 0xE8);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x9B);
    WriteRegisterByte(RegisterType::L, 0x96);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x394B, 0x03);
    WriteMemory(0x394A, 0x2A);
    WriteMemory(0x0FDA, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x40);
    CheckRegisterByte(RegisterType::B, 0xCD);
    CheckRegisterByte(RegisterType::C, 0xF0);
    CheckRegisterByte(RegisterType::D, 0x03);
    CheckRegisterByte(RegisterType::E, 0x2A);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x9B);
    CheckRegisterByte(RegisterType::L, 0x96);
    CheckRegisterWord(RegisterType::PC, 0x0FDB);
    CheckRegisterWord(RegisterType::SP, 0x394C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0FDA, 0xD1);
    CheckMemory(0x394A, 0x2A);
    CheckMemory(0x394B, 0x03);
}

void test_D1_0231()
{
    if (skip_test_D1_0231)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x18B2);
    WriteRegisterWord(RegisterType::SP, 0xA8E8);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0x41);
    WriteRegisterByte(RegisterType::C, 0xC4);
    WriteRegisterByte(RegisterType::D, 0xCA);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x88);
    WriteRegisterByte(RegisterType::L, 0xC9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA8E9, 0x75);
    WriteMemory(0xA8E8, 0x07);
    WriteMemory(0x18B2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0x41);
    CheckRegisterByte(RegisterType::C, 0xC4);
    CheckRegisterByte(RegisterType::D, 0x75);
    CheckRegisterByte(RegisterType::E, 0x07);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x88);
    CheckRegisterByte(RegisterType::L, 0xC9);
    CheckRegisterWord(RegisterType::PC, 0x18B3);
    CheckRegisterWord(RegisterType::SP, 0xA8EA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x18B2, 0xD1);
    CheckMemory(0xA8E8, 0x07);
    CheckMemory(0xA8E9, 0x75);
}

void test_D1_0232()
{
    if (skip_test_D1_0232)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x06D7);
    WriteRegisterWord(RegisterType::SP, 0x1F30);
    WriteRegisterByte(RegisterType::A, 0x2D);
    WriteRegisterByte(RegisterType::B, 0xB4);
    WriteRegisterByte(RegisterType::C, 0x5F);
    WriteRegisterByte(RegisterType::D, 0x4C);
    WriteRegisterByte(RegisterType::E, 0x07);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x91);
    WriteRegisterByte(RegisterType::L, 0x4D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x1F31, 0x8D);
    WriteMemory(0x1F30, 0x82);
    WriteMemory(0x06D7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2D);
    CheckRegisterByte(RegisterType::B, 0xB4);
    CheckRegisterByte(RegisterType::C, 0x5F);
    CheckRegisterByte(RegisterType::D, 0x8D);
    CheckRegisterByte(RegisterType::E, 0x82);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x91);
    CheckRegisterByte(RegisterType::L, 0x4D);
    CheckRegisterWord(RegisterType::PC, 0x06D8);
    CheckRegisterWord(RegisterType::SP, 0x1F32);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x06D7, 0xD1);
    CheckMemory(0x1F30, 0x82);
    CheckMemory(0x1F31, 0x8D);
}

void test_D1_0233()
{
    if (skip_test_D1_0233)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x103F);
    WriteRegisterWord(RegisterType::SP, 0x3003);
    WriteRegisterByte(RegisterType::A, 0x0B);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0x80);
    WriteRegisterByte(RegisterType::D, 0xEF);
    WriteRegisterByte(RegisterType::E, 0xCB);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x69);
    WriteRegisterByte(RegisterType::L, 0x27);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x3004, 0x31);
    WriteMemory(0x3003, 0x2D);
    WriteMemory(0x103F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0B);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0x80);
    CheckRegisterByte(RegisterType::D, 0x31);
    CheckRegisterByte(RegisterType::E, 0x2D);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x69);
    CheckRegisterByte(RegisterType::L, 0x27);
    CheckRegisterWord(RegisterType::PC, 0x1040);
    CheckRegisterWord(RegisterType::SP, 0x3005);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x103F, 0xD1);
    CheckMemory(0x3003, 0x2D);
    CheckMemory(0x3004, 0x31);
}

void test_D1_0234()
{
    if (skip_test_D1_0234)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xACA5);
    WriteRegisterWord(RegisterType::SP, 0xFA5F);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0xD2);
    WriteRegisterByte(RegisterType::C, 0x3A);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0x92);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xBE);
    WriteRegisterByte(RegisterType::L, 0x16);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFA60, 0xAA);
    WriteMemory(0xFA5F, 0x4E);
    WriteMemory(0xACA5, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0xD2);
    CheckRegisterByte(RegisterType::C, 0x3A);
    CheckRegisterByte(RegisterType::D, 0xAA);
    CheckRegisterByte(RegisterType::E, 0x4E);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xBE);
    CheckRegisterByte(RegisterType::L, 0x16);
    CheckRegisterWord(RegisterType::PC, 0xACA6);
    CheckRegisterWord(RegisterType::SP, 0xFA61);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xACA5, 0xD1);
    CheckMemory(0xFA5F, 0x4E);
    CheckMemory(0xFA60, 0xAA);
}

void test_D1_0235()
{
    if (skip_test_D1_0235)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4AC8);
    WriteRegisterWord(RegisterType::SP, 0xF560);
    WriteRegisterByte(RegisterType::A, 0xA3);
    WriteRegisterByte(RegisterType::B, 0x4F);
    WriteRegisterByte(RegisterType::C, 0xD3);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0xBF);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xB3);
    WriteRegisterByte(RegisterType::L, 0xCD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF561, 0x1C);
    WriteMemory(0xF560, 0x22);
    WriteMemory(0x4AC8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA3);
    CheckRegisterByte(RegisterType::B, 0x4F);
    CheckRegisterByte(RegisterType::C, 0xD3);
    CheckRegisterByte(RegisterType::D, 0x1C);
    CheckRegisterByte(RegisterType::E, 0x22);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xB3);
    CheckRegisterByte(RegisterType::L, 0xCD);
    CheckRegisterWord(RegisterType::PC, 0x4AC9);
    CheckRegisterWord(RegisterType::SP, 0xF562);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4AC8, 0xD1);
    CheckMemory(0xF560, 0x22);
    CheckMemory(0xF561, 0x1C);
}

void test_D1_0236()
{
    if (skip_test_D1_0236)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7218);
    WriteRegisterWord(RegisterType::SP, 0xACA8);
    WriteRegisterByte(RegisterType::A, 0x3A);
    WriteRegisterByte(RegisterType::B, 0x1C);
    WriteRegisterByte(RegisterType::C, 0x80);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0x1D);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xEB);
    WriteRegisterByte(RegisterType::L, 0xAF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xACA9, 0xAF);
    WriteMemory(0xACA8, 0x27);
    WriteMemory(0x7218, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3A);
    CheckRegisterByte(RegisterType::B, 0x1C);
    CheckRegisterByte(RegisterType::C, 0x80);
    CheckRegisterByte(RegisterType::D, 0xAF);
    CheckRegisterByte(RegisterType::E, 0x27);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xEB);
    CheckRegisterByte(RegisterType::L, 0xAF);
    CheckRegisterWord(RegisterType::PC, 0x7219);
    CheckRegisterWord(RegisterType::SP, 0xACAA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7218, 0xD1);
    CheckMemory(0xACA8, 0x27);
    CheckMemory(0xACA9, 0xAF);
}

void test_D1_0237()
{
    if (skip_test_D1_0237)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDCE8);
    WriteRegisterWord(RegisterType::SP, 0x229A);
    WriteRegisterByte(RegisterType::A, 0x97);
    WriteRegisterByte(RegisterType::B, 0x5A);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0xBF);
    WriteRegisterByte(RegisterType::E, 0xDA);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x5D);
    WriteRegisterByte(RegisterType::L, 0xC0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDCE8, 0xD1);
    WriteMemory(0x229B, 0x19);
    WriteMemory(0x229A, 0x5A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x97);
    CheckRegisterByte(RegisterType::B, 0x5A);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0x19);
    CheckRegisterByte(RegisterType::E, 0x5A);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x5D);
    CheckRegisterByte(RegisterType::L, 0xC0);
    CheckRegisterWord(RegisterType::PC, 0xDCE9);
    CheckRegisterWord(RegisterType::SP, 0x229C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x229A, 0x5A);
    CheckMemory(0x229B, 0x19);
    CheckMemory(0xDCE8, 0xD1);
}

void test_D1_0238()
{
    if (skip_test_D1_0238)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2ECF);
    WriteRegisterWord(RegisterType::SP, 0x9027);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0x0C);
    WriteRegisterByte(RegisterType::C, 0x76);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0x79);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0xE2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9028, 0x97);
    WriteMemory(0x9027, 0xB6);
    WriteMemory(0x2ECF, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0x0C);
    CheckRegisterByte(RegisterType::C, 0x76);
    CheckRegisterByte(RegisterType::D, 0x97);
    CheckRegisterByte(RegisterType::E, 0xB6);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0xE2);
    CheckRegisterWord(RegisterType::PC, 0x2ED0);
    CheckRegisterWord(RegisterType::SP, 0x9029);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2ECF, 0xD1);
    CheckMemory(0x9027, 0xB6);
    CheckMemory(0x9028, 0x97);
}

void test_D1_0239()
{
    if (skip_test_D1_0239)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x549B);
    WriteRegisterWord(RegisterType::SP, 0x5C83);
    WriteRegisterByte(RegisterType::A, 0x91);
    WriteRegisterByte(RegisterType::B, 0x55);
    WriteRegisterByte(RegisterType::C, 0xE3);
    WriteRegisterByte(RegisterType::D, 0xD7);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xFC);
    WriteRegisterByte(RegisterType::L, 0x70);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5C84, 0x9B);
    WriteMemory(0x5C83, 0xDD);
    WriteMemory(0x549B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x91);
    CheckRegisterByte(RegisterType::B, 0x55);
    CheckRegisterByte(RegisterType::C, 0xE3);
    CheckRegisterByte(RegisterType::D, 0x9B);
    CheckRegisterByte(RegisterType::E, 0xDD);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xFC);
    CheckRegisterByte(RegisterType::L, 0x70);
    CheckRegisterWord(RegisterType::PC, 0x549C);
    CheckRegisterWord(RegisterType::SP, 0x5C85);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x549B, 0xD1);
    CheckMemory(0x5C83, 0xDD);
    CheckMemory(0x5C84, 0x9B);
}

void test_D1_023A()
{
    if (skip_test_D1_023A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0F97);
    WriteRegisterWord(RegisterType::SP, 0x6896);
    WriteRegisterByte(RegisterType::A, 0x09);
    WriteRegisterByte(RegisterType::B, 0x25);
    WriteRegisterByte(RegisterType::C, 0x83);
    WriteRegisterByte(RegisterType::D, 0x9B);
    WriteRegisterByte(RegisterType::E, 0x46);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6897, 0x85);
    WriteMemory(0x6896, 0xD8);
    WriteMemory(0x0F97, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x09);
    CheckRegisterByte(RegisterType::B, 0x25);
    CheckRegisterByte(RegisterType::C, 0x83);
    CheckRegisterByte(RegisterType::D, 0x85);
    CheckRegisterByte(RegisterType::E, 0xD8);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0x0F98);
    CheckRegisterWord(RegisterType::SP, 0x6898);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0F97, 0xD1);
    CheckMemory(0x6896, 0xD8);
    CheckMemory(0x6897, 0x85);
}

void test_D1_023B()
{
    if (skip_test_D1_023B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1396);
    WriteRegisterWord(RegisterType::SP, 0x7C24);
    WriteRegisterByte(RegisterType::A, 0x38);
    WriteRegisterByte(RegisterType::B, 0xA1);
    WriteRegisterByte(RegisterType::C, 0x1E);
    WriteRegisterByte(RegisterType::D, 0xC2);
    WriteRegisterByte(RegisterType::E, 0xA9);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x90);
    WriteRegisterByte(RegisterType::L, 0xCD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7C25, 0x78);
    WriteMemory(0x7C24, 0x63);
    WriteMemory(0x1396, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x38);
    CheckRegisterByte(RegisterType::B, 0xA1);
    CheckRegisterByte(RegisterType::C, 0x1E);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0x63);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x90);
    CheckRegisterByte(RegisterType::L, 0xCD);
    CheckRegisterWord(RegisterType::PC, 0x1397);
    CheckRegisterWord(RegisterType::SP, 0x7C26);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1396, 0xD1);
    CheckMemory(0x7C24, 0x63);
    CheckMemory(0x7C25, 0x78);
}

void test_D1_023C()
{
    if (skip_test_D1_023C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB21C);
    WriteRegisterWord(RegisterType::SP, 0xE2A2);
    WriteRegisterByte(RegisterType::A, 0xFA);
    WriteRegisterByte(RegisterType::B, 0xCF);
    WriteRegisterByte(RegisterType::C, 0xAA);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0x65);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0x00);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE2A3, 0x5B);
    WriteMemory(0xE2A2, 0x11);
    WriteMemory(0xB21C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFA);
    CheckRegisterByte(RegisterType::B, 0xCF);
    CheckRegisterByte(RegisterType::C, 0xAA);
    CheckRegisterByte(RegisterType::D, 0x5B);
    CheckRegisterByte(RegisterType::E, 0x11);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0x00);
    CheckRegisterWord(RegisterType::PC, 0xB21D);
    CheckRegisterWord(RegisterType::SP, 0xE2A4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB21C, 0xD1);
    CheckMemory(0xE2A2, 0x11);
    CheckMemory(0xE2A3, 0x5B);
}

void test_D1_023D()
{
    if (skip_test_D1_023D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCC49);
    WriteRegisterWord(RegisterType::SP, 0x1E3B);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0xA2);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0x2D);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCC49, 0xD1);
    WriteMemory(0x1E3C, 0xEA);
    WriteMemory(0x1E3B, 0x55);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0xA2);
    CheckRegisterByte(RegisterType::D, 0xEA);
    CheckRegisterByte(RegisterType::E, 0x55);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0xCC4A);
    CheckRegisterWord(RegisterType::SP, 0x1E3D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1E3B, 0x55);
    CheckMemory(0x1E3C, 0xEA);
    CheckMemory(0xCC49, 0xD1);
}

void test_D1_023E()
{
    if (skip_test_D1_023E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x51A2);
    WriteRegisterWord(RegisterType::SP, 0x023D);
    WriteRegisterByte(RegisterType::A, 0x8D);
    WriteRegisterByte(RegisterType::B, 0xCB);
    WriteRegisterByte(RegisterType::C, 0x6E);
    WriteRegisterByte(RegisterType::D, 0xF3);
    WriteRegisterByte(RegisterType::E, 0x82);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x75);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x51A2, 0xD1);
    WriteMemory(0x023E, 0x86);
    WriteMemory(0x023D, 0xAB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8D);
    CheckRegisterByte(RegisterType::B, 0xCB);
    CheckRegisterByte(RegisterType::C, 0x6E);
    CheckRegisterByte(RegisterType::D, 0x86);
    CheckRegisterByte(RegisterType::E, 0xAB);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x75);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0x51A3);
    CheckRegisterWord(RegisterType::SP, 0x023F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x023D, 0xAB);
    CheckMemory(0x023E, 0x86);
    CheckMemory(0x51A2, 0xD1);
}

void test_D1_023F()
{
    if (skip_test_D1_023F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD386);
    WriteRegisterWord(RegisterType::SP, 0x8D91);
    WriteRegisterByte(RegisterType::A, 0x6B);
    WriteRegisterByte(RegisterType::B, 0x03);
    WriteRegisterByte(RegisterType::C, 0x13);
    WriteRegisterByte(RegisterType::D, 0xC6);
    WriteRegisterByte(RegisterType::E, 0x8E);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x98);
    WriteRegisterByte(RegisterType::L, 0x32);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD386, 0xD1);
    WriteMemory(0x8D92, 0x92);
    WriteMemory(0x8D91, 0x21);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6B);
    CheckRegisterByte(RegisterType::B, 0x03);
    CheckRegisterByte(RegisterType::C, 0x13);
    CheckRegisterByte(RegisterType::D, 0x92);
    CheckRegisterByte(RegisterType::E, 0x21);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x98);
    CheckRegisterByte(RegisterType::L, 0x32);
    CheckRegisterWord(RegisterType::PC, 0xD387);
    CheckRegisterWord(RegisterType::SP, 0x8D93);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8D91, 0x21);
    CheckMemory(0x8D92, 0x92);
    CheckMemory(0xD386, 0xD1);
}

void test_D1_0240()
{
    if (skip_test_D1_0240)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA5F5);
    WriteRegisterWord(RegisterType::SP, 0x1046);
    WriteRegisterByte(RegisterType::A, 0x9A);
    WriteRegisterByte(RegisterType::B, 0x0B);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0xE1);
    WriteRegisterByte(RegisterType::E, 0x81);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x4E);
    WriteRegisterByte(RegisterType::L, 0x94);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA5F5, 0xD1);
    WriteMemory(0x1047, 0x8C);
    WriteMemory(0x1046, 0x2B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9A);
    CheckRegisterByte(RegisterType::B, 0x0B);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0x2B);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x4E);
    CheckRegisterByte(RegisterType::L, 0x94);
    CheckRegisterWord(RegisterType::PC, 0xA5F6);
    CheckRegisterWord(RegisterType::SP, 0x1048);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1046, 0x2B);
    CheckMemory(0x1047, 0x8C);
    CheckMemory(0xA5F5, 0xD1);
}

void test_D1_0241()
{
    if (skip_test_D1_0241)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x66B6);
    WriteRegisterWord(RegisterType::SP, 0xA414);
    WriteRegisterByte(RegisterType::A, 0x26);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0xE5);
    WriteRegisterByte(RegisterType::E, 0x87);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xAC);
    WriteRegisterByte(RegisterType::L, 0xAA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA415, 0x4D);
    WriteMemory(0xA414, 0x69);
    WriteMemory(0x66B6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x26);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0x4D);
    CheckRegisterByte(RegisterType::E, 0x69);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xAC);
    CheckRegisterByte(RegisterType::L, 0xAA);
    CheckRegisterWord(RegisterType::PC, 0x66B7);
    CheckRegisterWord(RegisterType::SP, 0xA416);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x66B6, 0xD1);
    CheckMemory(0xA414, 0x69);
    CheckMemory(0xA415, 0x4D);
}

void test_D1_0242()
{
    if (skip_test_D1_0242)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8496);
    WriteRegisterWord(RegisterType::SP, 0xD039);
    WriteRegisterByte(RegisterType::A, 0xE2);
    WriteRegisterByte(RegisterType::B, 0xFE);
    WriteRegisterByte(RegisterType::C, 0x01);
    WriteRegisterByte(RegisterType::D, 0xE2);
    WriteRegisterByte(RegisterType::E, 0x5D);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xD9);
    WriteRegisterByte(RegisterType::L, 0x66);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD03A, 0xC9);
    WriteMemory(0xD039, 0x3E);
    WriteMemory(0x8496, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE2);
    CheckRegisterByte(RegisterType::B, 0xFE);
    CheckRegisterByte(RegisterType::C, 0x01);
    CheckRegisterByte(RegisterType::D, 0xC9);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xD9);
    CheckRegisterByte(RegisterType::L, 0x66);
    CheckRegisterWord(RegisterType::PC, 0x8497);
    CheckRegisterWord(RegisterType::SP, 0xD03B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8496, 0xD1);
    CheckMemory(0xD039, 0x3E);
    CheckMemory(0xD03A, 0xC9);
}

void test_D1_0243()
{
    if (skip_test_D1_0243)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4F4D);
    WriteRegisterWord(RegisterType::SP, 0x30DB);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0xDE);
    WriteRegisterByte(RegisterType::D, 0xAC);
    WriteRegisterByte(RegisterType::E, 0x9D);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xEC);
    WriteRegisterByte(RegisterType::L, 0xAA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x4F4D, 0xD1);
    WriteMemory(0x30DC, 0x47);
    WriteMemory(0x30DB, 0xF7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0xDE);
    CheckRegisterByte(RegisterType::D, 0x47);
    CheckRegisterByte(RegisterType::E, 0xF7);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xEC);
    CheckRegisterByte(RegisterType::L, 0xAA);
    CheckRegisterWord(RegisterType::PC, 0x4F4E);
    CheckRegisterWord(RegisterType::SP, 0x30DD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x30DB, 0xF7);
    CheckMemory(0x30DC, 0x47);
    CheckMemory(0x4F4D, 0xD1);
}

void test_D1_0244()
{
    if (skip_test_D1_0244)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x13DB);
    WriteRegisterWord(RegisterType::SP, 0x196B);
    WriteRegisterByte(RegisterType::A, 0xF1);
    WriteRegisterByte(RegisterType::B, 0xFE);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0xC9);
    WriteRegisterByte(RegisterType::E, 0x6B);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x34);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x196C, 0x18);
    WriteMemory(0x196B, 0x4F);
    WriteMemory(0x13DB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF1);
    CheckRegisterByte(RegisterType::B, 0xFE);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0x4F);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x34);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0x13DC);
    CheckRegisterWord(RegisterType::SP, 0x196D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x13DB, 0xD1);
    CheckMemory(0x196B, 0x4F);
    CheckMemory(0x196C, 0x18);
}

void test_D1_0245()
{
    if (skip_test_D1_0245)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4628);
    WriteRegisterWord(RegisterType::SP, 0x3C15);
    WriteRegisterByte(RegisterType::A, 0x85);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0x3B);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0x2D);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xD8);
    WriteRegisterByte(RegisterType::L, 0x0F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x4628, 0xD1);
    WriteMemory(0x3C16, 0x6D);
    WriteMemory(0x3C15, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x85);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0x3B);
    CheckRegisterByte(RegisterType::D, 0x6D);
    CheckRegisterByte(RegisterType::E, 0xE0);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xD8);
    CheckRegisterByte(RegisterType::L, 0x0F);
    CheckRegisterWord(RegisterType::PC, 0x4629);
    CheckRegisterWord(RegisterType::SP, 0x3C17);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3C15, 0xE0);
    CheckMemory(0x3C16, 0x6D);
    CheckMemory(0x4628, 0xD1);
}

void test_D1_0246()
{
    if (skip_test_D1_0246)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA1BF);
    WriteRegisterWord(RegisterType::SP, 0x1B32);
    WriteRegisterByte(RegisterType::A, 0x8F);
    WriteRegisterByte(RegisterType::B, 0xB8);
    WriteRegisterByte(RegisterType::C, 0xD4);
    WriteRegisterByte(RegisterType::D, 0x54);
    WriteRegisterByte(RegisterType::E, 0x9C);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x4F);
    WriteRegisterByte(RegisterType::L, 0x0D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA1BF, 0xD1);
    WriteMemory(0x1B33, 0x24);
    WriteMemory(0x1B32, 0xB7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8F);
    CheckRegisterByte(RegisterType::B, 0xB8);
    CheckRegisterByte(RegisterType::C, 0xD4);
    CheckRegisterByte(RegisterType::D, 0x24);
    CheckRegisterByte(RegisterType::E, 0xB7);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x4F);
    CheckRegisterByte(RegisterType::L, 0x0D);
    CheckRegisterWord(RegisterType::PC, 0xA1C0);
    CheckRegisterWord(RegisterType::SP, 0x1B34);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1B32, 0xB7);
    CheckMemory(0x1B33, 0x24);
    CheckMemory(0xA1BF, 0xD1);
}

void test_D1_0247()
{
    if (skip_test_D1_0247)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDFAC);
    WriteRegisterWord(RegisterType::SP, 0xF182);
    WriteRegisterByte(RegisterType::A, 0x5A);
    WriteRegisterByte(RegisterType::B, 0x4E);
    WriteRegisterByte(RegisterType::C, 0x75);
    WriteRegisterByte(RegisterType::D, 0x12);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xD6);
    WriteRegisterByte(RegisterType::L, 0xB5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF183, 0x2D);
    WriteMemory(0xF182, 0xF8);
    WriteMemory(0xDFAC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5A);
    CheckRegisterByte(RegisterType::B, 0x4E);
    CheckRegisterByte(RegisterType::C, 0x75);
    CheckRegisterByte(RegisterType::D, 0x2D);
    CheckRegisterByte(RegisterType::E, 0xF8);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xD6);
    CheckRegisterByte(RegisterType::L, 0xB5);
    CheckRegisterWord(RegisterType::PC, 0xDFAD);
    CheckRegisterWord(RegisterType::SP, 0xF184);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDFAC, 0xD1);
    CheckMemory(0xF182, 0xF8);
    CheckMemory(0xF183, 0x2D);
}

void test_D1_0248()
{
    if (skip_test_D1_0248)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x427C);
    WriteRegisterWord(RegisterType::SP, 0xE358);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0xA3);
    WriteRegisterByte(RegisterType::C, 0xB2);
    WriteRegisterByte(RegisterType::D, 0x89);
    WriteRegisterByte(RegisterType::E, 0x69);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x55);
    WriteRegisterByte(RegisterType::L, 0x0F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE359, 0x68);
    WriteMemory(0xE358, 0x1B);
    WriteMemory(0x427C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0xA3);
    CheckRegisterByte(RegisterType::C, 0xB2);
    CheckRegisterByte(RegisterType::D, 0x68);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x55);
    CheckRegisterByte(RegisterType::L, 0x0F);
    CheckRegisterWord(RegisterType::PC, 0x427D);
    CheckRegisterWord(RegisterType::SP, 0xE35A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x427C, 0xD1);
    CheckMemory(0xE358, 0x1B);
    CheckMemory(0xE359, 0x68);
}

void test_D1_0249()
{
    if (skip_test_D1_0249)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB070);
    WriteRegisterWord(RegisterType::SP, 0xA620);
    WriteRegisterByte(RegisterType::A, 0xAC);
    WriteRegisterByte(RegisterType::B, 0x06);
    WriteRegisterByte(RegisterType::C, 0x83);
    WriteRegisterByte(RegisterType::D, 0x2B);
    WriteRegisterByte(RegisterType::E, 0xD5);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x60);
    WriteRegisterByte(RegisterType::L, 0xDA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB070, 0xD1);
    WriteMemory(0xA621, 0x0C);
    WriteMemory(0xA620, 0xF4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAC);
    CheckRegisterByte(RegisterType::B, 0x06);
    CheckRegisterByte(RegisterType::C, 0x83);
    CheckRegisterByte(RegisterType::D, 0x0C);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x60);
    CheckRegisterByte(RegisterType::L, 0xDA);
    CheckRegisterWord(RegisterType::PC, 0xB071);
    CheckRegisterWord(RegisterType::SP, 0xA622);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA620, 0xF4);
    CheckMemory(0xA621, 0x0C);
    CheckMemory(0xB070, 0xD1);
}

void test_D1_024A()
{
    if (skip_test_D1_024A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4D6F);
    WriteRegisterWord(RegisterType::SP, 0xCD12);
    WriteRegisterByte(RegisterType::A, 0xBE);
    WriteRegisterByte(RegisterType::B, 0x27);
    WriteRegisterByte(RegisterType::C, 0xDC);
    WriteRegisterByte(RegisterType::D, 0x4C);
    WriteRegisterByte(RegisterType::E, 0x5B);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x99);
    WriteRegisterByte(RegisterType::L, 0x8F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCD13, 0x7A);
    WriteMemory(0xCD12, 0x00);
    WriteMemory(0x4D6F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBE);
    CheckRegisterByte(RegisterType::B, 0x27);
    CheckRegisterByte(RegisterType::C, 0xDC);
    CheckRegisterByte(RegisterType::D, 0x7A);
    CheckRegisterByte(RegisterType::E, 0x00);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x99);
    CheckRegisterByte(RegisterType::L, 0x8F);
    CheckRegisterWord(RegisterType::PC, 0x4D70);
    CheckRegisterWord(RegisterType::SP, 0xCD14);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4D6F, 0xD1);
    CheckMemory(0xCD12, 0x00);
    CheckMemory(0xCD13, 0x7A);
}

void test_D1_024B()
{
    if (skip_test_D1_024B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x767B);
    WriteRegisterWord(RegisterType::SP, 0x55B8);
    WriteRegisterByte(RegisterType::A, 0x96);
    WriteRegisterByte(RegisterType::B, 0xE8);
    WriteRegisterByte(RegisterType::C, 0x8C);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x49);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x767B, 0xD1);
    WriteMemory(0x55B9, 0x4B);
    WriteMemory(0x55B8, 0xAA);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x96);
    CheckRegisterByte(RegisterType::B, 0xE8);
    CheckRegisterByte(RegisterType::C, 0x8C);
    CheckRegisterByte(RegisterType::D, 0x4B);
    CheckRegisterByte(RegisterType::E, 0xAA);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x49);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0x767C);
    CheckRegisterWord(RegisterType::SP, 0x55BA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x55B8, 0xAA);
    CheckMemory(0x55B9, 0x4B);
    CheckMemory(0x767B, 0xD1);
}

void test_D1_024C()
{
    if (skip_test_D1_024C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAAEB);
    WriteRegisterWord(RegisterType::SP, 0xE794);
    WriteRegisterByte(RegisterType::A, 0xF5);
    WriteRegisterByte(RegisterType::B, 0xDB);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0x8F);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xC0);
    WriteRegisterByte(RegisterType::L, 0xEC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE795, 0x80);
    WriteMemory(0xE794, 0x2C);
    WriteMemory(0xAAEB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF5);
    CheckRegisterByte(RegisterType::B, 0xDB);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0x80);
    CheckRegisterByte(RegisterType::E, 0x2C);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xC0);
    CheckRegisterByte(RegisterType::L, 0xEC);
    CheckRegisterWord(RegisterType::PC, 0xAAEC);
    CheckRegisterWord(RegisterType::SP, 0xE796);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAAEB, 0xD1);
    CheckMemory(0xE794, 0x2C);
    CheckMemory(0xE795, 0x80);
}

void test_D1_024D()
{
    if (skip_test_D1_024D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5E64);
    WriteRegisterWord(RegisterType::SP, 0xE2A4);
    WriteRegisterByte(RegisterType::A, 0xF2);
    WriteRegisterByte(RegisterType::B, 0xD1);
    WriteRegisterByte(RegisterType::C, 0xD8);
    WriteRegisterByte(RegisterType::D, 0x84);
    WriteRegisterByte(RegisterType::E, 0x9B);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xF2);
    WriteRegisterByte(RegisterType::L, 0x8C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE2A5, 0xC0);
    WriteMemory(0xE2A4, 0xF9);
    WriteMemory(0x5E64, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF2);
    CheckRegisterByte(RegisterType::B, 0xD1);
    CheckRegisterByte(RegisterType::C, 0xD8);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0xF9);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xF2);
    CheckRegisterByte(RegisterType::L, 0x8C);
    CheckRegisterWord(RegisterType::PC, 0x5E65);
    CheckRegisterWord(RegisterType::SP, 0xE2A6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5E64, 0xD1);
    CheckMemory(0xE2A4, 0xF9);
    CheckMemory(0xE2A5, 0xC0);
}

void test_D1_024E()
{
    if (skip_test_D1_024E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1D00);
    WriteRegisterWord(RegisterType::SP, 0x2770);
    WriteRegisterByte(RegisterType::A, 0x53);
    WriteRegisterByte(RegisterType::B, 0x5B);
    WriteRegisterByte(RegisterType::C, 0x04);
    WriteRegisterByte(RegisterType::D, 0x89);
    WriteRegisterByte(RegisterType::E, 0xC0);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xC4);
    WriteRegisterByte(RegisterType::L, 0xFE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x2771, 0x97);
    WriteMemory(0x2770, 0x15);
    WriteMemory(0x1D00, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x53);
    CheckRegisterByte(RegisterType::B, 0x5B);
    CheckRegisterByte(RegisterType::C, 0x04);
    CheckRegisterByte(RegisterType::D, 0x97);
    CheckRegisterByte(RegisterType::E, 0x15);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xC4);
    CheckRegisterByte(RegisterType::L, 0xFE);
    CheckRegisterWord(RegisterType::PC, 0x1D01);
    CheckRegisterWord(RegisterType::SP, 0x2772);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1D00, 0xD1);
    CheckMemory(0x2770, 0x15);
    CheckMemory(0x2771, 0x97);
}

void test_D1_024F()
{
    if (skip_test_D1_024F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB471);
    WriteRegisterWord(RegisterType::SP, 0x41C6);
    WriteRegisterByte(RegisterType::A, 0x6F);
    WriteRegisterByte(RegisterType::B, 0xE8);
    WriteRegisterByte(RegisterType::C, 0xC9);
    WriteRegisterByte(RegisterType::D, 0xA7);
    WriteRegisterByte(RegisterType::E, 0x04);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0xFC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB471, 0xD1);
    WriteMemory(0x41C7, 0x3E);
    WriteMemory(0x41C6, 0x86);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6F);
    CheckRegisterByte(RegisterType::B, 0xE8);
    CheckRegisterByte(RegisterType::C, 0xC9);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0x86);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0xFC);
    CheckRegisterWord(RegisterType::PC, 0xB472);
    CheckRegisterWord(RegisterType::SP, 0x41C8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x41C6, 0x86);
    CheckMemory(0x41C7, 0x3E);
    CheckMemory(0xB471, 0xD1);
}

void test_D1_0250()
{
    if (skip_test_D1_0250)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEF4A);
    WriteRegisterWord(RegisterType::SP, 0x8938);
    WriteRegisterByte(RegisterType::A, 0x0E);
    WriteRegisterByte(RegisterType::B, 0x68);
    WriteRegisterByte(RegisterType::C, 0xAB);
    WriteRegisterByte(RegisterType::D, 0xA8);
    WriteRegisterByte(RegisterType::E, 0xEA);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x18);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEF4A, 0xD1);
    WriteMemory(0x8939, 0xAE);
    WriteMemory(0x8938, 0xA6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0E);
    CheckRegisterByte(RegisterType::B, 0x68);
    CheckRegisterByte(RegisterType::C, 0xAB);
    CheckRegisterByte(RegisterType::D, 0xAE);
    CheckRegisterByte(RegisterType::E, 0xA6);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x18);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0xEF4B);
    CheckRegisterWord(RegisterType::SP, 0x893A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8938, 0xA6);
    CheckMemory(0x8939, 0xAE);
    CheckMemory(0xEF4A, 0xD1);
}

void test_D1_0251()
{
    if (skip_test_D1_0251)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3B33);
    WriteRegisterWord(RegisterType::SP, 0xC6AD);
    WriteRegisterByte(RegisterType::A, 0xC4);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0x27);
    WriteRegisterByte(RegisterType::D, 0x4B);
    WriteRegisterByte(RegisterType::E, 0xBB);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0xC2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC6AE, 0x8F);
    WriteMemory(0xC6AD, 0xC8);
    WriteMemory(0x3B33, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC4);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0x27);
    CheckRegisterByte(RegisterType::D, 0x8F);
    CheckRegisterByte(RegisterType::E, 0xC8);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0xC2);
    CheckRegisterWord(RegisterType::PC, 0x3B34);
    CheckRegisterWord(RegisterType::SP, 0xC6AF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3B33, 0xD1);
    CheckMemory(0xC6AD, 0xC8);
    CheckMemory(0xC6AE, 0x8F);
}

void test_D1_0252()
{
    if (skip_test_D1_0252)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA960);
    WriteRegisterWord(RegisterType::SP, 0xCBFE);
    WriteRegisterByte(RegisterType::A, 0xE8);
    WriteRegisterByte(RegisterType::B, 0xBB);
    WriteRegisterByte(RegisterType::C, 0xD3);
    WriteRegisterByte(RegisterType::D, 0x47);
    WriteRegisterByte(RegisterType::E, 0x2F);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xA8);
    WriteRegisterByte(RegisterType::L, 0x6C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCBFF, 0x65);
    WriteMemory(0xCBFE, 0x20);
    WriteMemory(0xA960, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE8);
    CheckRegisterByte(RegisterType::B, 0xBB);
    CheckRegisterByte(RegisterType::C, 0xD3);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0x20);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xA8);
    CheckRegisterByte(RegisterType::L, 0x6C);
    CheckRegisterWord(RegisterType::PC, 0xA961);
    CheckRegisterWord(RegisterType::SP, 0xCC00);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA960, 0xD1);
    CheckMemory(0xCBFE, 0x20);
    CheckMemory(0xCBFF, 0x65);
}

void test_D1_0253()
{
    if (skip_test_D1_0253)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFFFD);
    WriteRegisterWord(RegisterType::SP, 0xAF9D);
    WriteRegisterByte(RegisterType::A, 0xF8);
    WriteRegisterByte(RegisterType::B, 0x0B);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0x64);
    WriteRegisterByte(RegisterType::E, 0x7D);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0xE2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFFD, 0xD1);
    WriteMemory(0xAF9E, 0x3A);
    WriteMemory(0xAF9D, 0x7C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF8);
    CheckRegisterByte(RegisterType::B, 0x0B);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0x3A);
    CheckRegisterByte(RegisterType::E, 0x7C);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0xE2);
    CheckRegisterWord(RegisterType::PC, 0xFFFE);
    CheckRegisterWord(RegisterType::SP, 0xAF9F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAF9D, 0x7C);
    CheckMemory(0xAF9E, 0x3A);
    CheckMemory(0xFFFD, 0xD1);
}

void test_D1_0254()
{
    if (skip_test_D1_0254)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8568);
    WriteRegisterWord(RegisterType::SP, 0x0E36);
    WriteRegisterByte(RegisterType::A, 0x87);
    WriteRegisterByte(RegisterType::B, 0x6B);
    WriteRegisterByte(RegisterType::C, 0x6C);
    WriteRegisterByte(RegisterType::D, 0x42);
    WriteRegisterByte(RegisterType::E, 0x58);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0x2A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x8568, 0xD1);
    WriteMemory(0x0E37, 0x0C);
    WriteMemory(0x0E36, 0x5D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x87);
    CheckRegisterByte(RegisterType::B, 0x6B);
    CheckRegisterByte(RegisterType::C, 0x6C);
    CheckRegisterByte(RegisterType::D, 0x0C);
    CheckRegisterByte(RegisterType::E, 0x5D);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0x2A);
    CheckRegisterWord(RegisterType::PC, 0x8569);
    CheckRegisterWord(RegisterType::SP, 0x0E38);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0E36, 0x5D);
    CheckMemory(0x0E37, 0x0C);
    CheckMemory(0x8568, 0xD1);
}

void test_D1_0255()
{
    if (skip_test_D1_0255)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEA6F);
    WriteRegisterWord(RegisterType::SP, 0xB2C4);
    WriteRegisterByte(RegisterType::A, 0x22);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0xD9);
    WriteRegisterByte(RegisterType::D, 0xFF);
    WriteRegisterByte(RegisterType::E, 0x39);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0x1E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEA6F, 0xD1);
    WriteMemory(0xB2C5, 0x86);
    WriteMemory(0xB2C4, 0xD6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x22);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0xD9);
    CheckRegisterByte(RegisterType::D, 0x86);
    CheckRegisterByte(RegisterType::E, 0xD6);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0x1E);
    CheckRegisterWord(RegisterType::PC, 0xEA70);
    CheckRegisterWord(RegisterType::SP, 0xB2C6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB2C4, 0xD6);
    CheckMemory(0xB2C5, 0x86);
    CheckMemory(0xEA6F, 0xD1);
}

void test_D1_0256()
{
    if (skip_test_D1_0256)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1D6A);
    WriteRegisterWord(RegisterType::SP, 0x0643);
    WriteRegisterByte(RegisterType::A, 0xF2);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x59);
    WriteRegisterByte(RegisterType::D, 0xC5);
    WriteRegisterByte(RegisterType::E, 0x49);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0xBE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x1D6A, 0xD1);
    WriteMemory(0x0644, 0x9F);
    WriteMemory(0x0643, 0x23);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF2);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x59);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0x23);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0xBE);
    CheckRegisterWord(RegisterType::PC, 0x1D6B);
    CheckRegisterWord(RegisterType::SP, 0x0645);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0643, 0x23);
    CheckMemory(0x0644, 0x9F);
    CheckMemory(0x1D6A, 0xD1);
}

void test_D1_0257()
{
    if (skip_test_D1_0257)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDB76);
    WriteRegisterWord(RegisterType::SP, 0x93EC);
    WriteRegisterByte(RegisterType::A, 0x61);
    WriteRegisterByte(RegisterType::B, 0xFE);
    WriteRegisterByte(RegisterType::C, 0xA2);
    WriteRegisterByte(RegisterType::D, 0x27);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0x62);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDB76, 0xD1);
    WriteMemory(0x93ED, 0x69);
    WriteMemory(0x93EC, 0x7D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x61);
    CheckRegisterByte(RegisterType::B, 0xFE);
    CheckRegisterByte(RegisterType::C, 0xA2);
    CheckRegisterByte(RegisterType::D, 0x69);
    CheckRegisterByte(RegisterType::E, 0x7D);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0x62);
    CheckRegisterWord(RegisterType::PC, 0xDB77);
    CheckRegisterWord(RegisterType::SP, 0x93EE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x93EC, 0x7D);
    CheckMemory(0x93ED, 0x69);
    CheckMemory(0xDB76, 0xD1);
}

void test_D1_0258()
{
    if (skip_test_D1_0258)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6D7F);
    WriteRegisterWord(RegisterType::SP, 0x06C7);
    WriteRegisterByte(RegisterType::A, 0x91);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0x98);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x2C);
    WriteRegisterByte(RegisterType::L, 0xFD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6D7F, 0xD1);
    WriteMemory(0x06C8, 0x09);
    WriteMemory(0x06C7, 0x73);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x91);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0x73);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x2C);
    CheckRegisterByte(RegisterType::L, 0xFD);
    CheckRegisterWord(RegisterType::PC, 0x6D80);
    CheckRegisterWord(RegisterType::SP, 0x06C9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x06C7, 0x73);
    CheckMemory(0x06C8, 0x09);
    CheckMemory(0x6D7F, 0xD1);
}

void test_D1_0259()
{
    if (skip_test_D1_0259)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1D1B);
    WriteRegisterWord(RegisterType::SP, 0x0A4B);
    WriteRegisterByte(RegisterType::A, 0x60);
    WriteRegisterByte(RegisterType::B, 0x2D);
    WriteRegisterByte(RegisterType::C, 0xAF);
    WriteRegisterByte(RegisterType::D, 0x4A);
    WriteRegisterByte(RegisterType::E, 0xFC);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x37);
    WriteRegisterByte(RegisterType::L, 0x9A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x1D1B, 0xD1);
    WriteMemory(0x0A4C, 0x55);
    WriteMemory(0x0A4B, 0xE3);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x60);
    CheckRegisterByte(RegisterType::B, 0x2D);
    CheckRegisterByte(RegisterType::C, 0xAF);
    CheckRegisterByte(RegisterType::D, 0x55);
    CheckRegisterByte(RegisterType::E, 0xE3);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x37);
    CheckRegisterByte(RegisterType::L, 0x9A);
    CheckRegisterWord(RegisterType::PC, 0x1D1C);
    CheckRegisterWord(RegisterType::SP, 0x0A4D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0A4B, 0xE3);
    CheckMemory(0x0A4C, 0x55);
    CheckMemory(0x1D1B, 0xD1);
}

void test_D1_025A()
{
    if (skip_test_D1_025A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBD93);
    WriteRegisterWord(RegisterType::SP, 0x106E);
    WriteRegisterByte(RegisterType::A, 0xFE);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0x95);
    WriteRegisterByte(RegisterType::E, 0x05);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xF3);
    WriteRegisterByte(RegisterType::L, 0x13);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBD93, 0xD1);
    WriteMemory(0x106F, 0x8F);
    WriteMemory(0x106E, 0x3C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFE);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0x8F);
    CheckRegisterByte(RegisterType::E, 0x3C);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xF3);
    CheckRegisterByte(RegisterType::L, 0x13);
    CheckRegisterWord(RegisterType::PC, 0xBD94);
    CheckRegisterWord(RegisterType::SP, 0x1070);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x106E, 0x3C);
    CheckMemory(0x106F, 0x8F);
    CheckMemory(0xBD93, 0xD1);
}

void test_D1_025B()
{
    if (skip_test_D1_025B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE70F);
    WriteRegisterWord(RegisterType::SP, 0xBAC5);
    WriteRegisterByte(RegisterType::A, 0x19);
    WriteRegisterByte(RegisterType::B, 0x4E);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0x24);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x14);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE70F, 0xD1);
    WriteMemory(0xBAC6, 0x86);
    WriteMemory(0xBAC5, 0x32);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x19);
    CheckRegisterByte(RegisterType::B, 0x4E);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0x86);
    CheckRegisterByte(RegisterType::E, 0x32);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x14);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0xE710);
    CheckRegisterWord(RegisterType::SP, 0xBAC7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBAC5, 0x32);
    CheckMemory(0xBAC6, 0x86);
    CheckMemory(0xE70F, 0xD1);
}

void test_D1_025C()
{
    if (skip_test_D1_025C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE9A1);
    WriteRegisterWord(RegisterType::SP, 0xA680);
    WriteRegisterByte(RegisterType::A, 0x13);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x22);
    WriteRegisterByte(RegisterType::D, 0x1F);
    WriteRegisterByte(RegisterType::E, 0x45);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x1E);
    WriteRegisterByte(RegisterType::L, 0xDC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE9A1, 0xD1);
    WriteMemory(0xA681, 0xA9);
    WriteMemory(0xA680, 0x61);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x13);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x22);
    CheckRegisterByte(RegisterType::D, 0xA9);
    CheckRegisterByte(RegisterType::E, 0x61);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x1E);
    CheckRegisterByte(RegisterType::L, 0xDC);
    CheckRegisterWord(RegisterType::PC, 0xE9A2);
    CheckRegisterWord(RegisterType::SP, 0xA682);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA680, 0x61);
    CheckMemory(0xA681, 0xA9);
    CheckMemory(0xE9A1, 0xD1);
}

void test_D1_025D()
{
    if (skip_test_D1_025D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1173);
    WriteRegisterWord(RegisterType::SP, 0x53B8);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0x0D);
    WriteRegisterByte(RegisterType::C, 0xA4);
    WriteRegisterByte(RegisterType::D, 0xE8);
    WriteRegisterByte(RegisterType::E, 0x1D);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x61);
    WriteRegisterByte(RegisterType::L, 0x77);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x53B9, 0x8D);
    WriteMemory(0x53B8, 0x66);
    WriteMemory(0x1173, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0x0D);
    CheckRegisterByte(RegisterType::C, 0xA4);
    CheckRegisterByte(RegisterType::D, 0x8D);
    CheckRegisterByte(RegisterType::E, 0x66);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x61);
    CheckRegisterByte(RegisterType::L, 0x77);
    CheckRegisterWord(RegisterType::PC, 0x1174);
    CheckRegisterWord(RegisterType::SP, 0x53BA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1173, 0xD1);
    CheckMemory(0x53B8, 0x66);
    CheckMemory(0x53B9, 0x8D);
}

void test_D1_025E()
{
    if (skip_test_D1_025E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFECE);
    WriteRegisterWord(RegisterType::SP, 0x4F6C);
    WriteRegisterByte(RegisterType::A, 0xC9);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0xFA);
    WriteRegisterByte(RegisterType::D, 0xFE);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x8B);
    WriteRegisterByte(RegisterType::L, 0x84);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFECE, 0xD1);
    WriteMemory(0x4F6D, 0xF9);
    WriteMemory(0x4F6C, 0xCD);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC9);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0xFA);
    CheckRegisterByte(RegisterType::D, 0xF9);
    CheckRegisterByte(RegisterType::E, 0xCD);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x8B);
    CheckRegisterByte(RegisterType::L, 0x84);
    CheckRegisterWord(RegisterType::PC, 0xFECF);
    CheckRegisterWord(RegisterType::SP, 0x4F6E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4F6C, 0xCD);
    CheckMemory(0x4F6D, 0xF9);
    CheckMemory(0xFECE, 0xD1);
}

void test_D1_025F()
{
    if (skip_test_D1_025F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3C4A);
    WriteRegisterWord(RegisterType::SP, 0x1339);
    WriteRegisterByte(RegisterType::A, 0x15);
    WriteRegisterByte(RegisterType::B, 0x00);
    WriteRegisterByte(RegisterType::C, 0x61);
    WriteRegisterByte(RegisterType::D, 0xA2);
    WriteRegisterByte(RegisterType::E, 0xDE);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x3C4A, 0xD1);
    WriteMemory(0x133A, 0x41);
    WriteMemory(0x1339, 0x18);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x15);
    CheckRegisterByte(RegisterType::B, 0x00);
    CheckRegisterByte(RegisterType::C, 0x61);
    CheckRegisterByte(RegisterType::D, 0x41);
    CheckRegisterByte(RegisterType::E, 0x18);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0x3C4B);
    CheckRegisterWord(RegisterType::SP, 0x133B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1339, 0x18);
    CheckMemory(0x133A, 0x41);
    CheckMemory(0x3C4A, 0xD1);
}

void test_D1_0260()
{
    if (skip_test_D1_0260)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2771);
    WriteRegisterWord(RegisterType::SP, 0x15B6);
    WriteRegisterByte(RegisterType::A, 0xBA);
    WriteRegisterByte(RegisterType::B, 0x36);
    WriteRegisterByte(RegisterType::C, 0x6E);
    WriteRegisterByte(RegisterType::D, 0xDF);
    WriteRegisterByte(RegisterType::E, 0x25);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xBE);
    WriteRegisterByte(RegisterType::L, 0x3E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2771, 0xD1);
    WriteMemory(0x15B7, 0x02);
    WriteMemory(0x15B6, 0xF2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBA);
    CheckRegisterByte(RegisterType::B, 0x36);
    CheckRegisterByte(RegisterType::C, 0x6E);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0xF2);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xBE);
    CheckRegisterByte(RegisterType::L, 0x3E);
    CheckRegisterWord(RegisterType::PC, 0x2772);
    CheckRegisterWord(RegisterType::SP, 0x15B8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x15B6, 0xF2);
    CheckMemory(0x15B7, 0x02);
    CheckMemory(0x2771, 0xD1);
}

void test_D1_0261()
{
    if (skip_test_D1_0261)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6F9A);
    WriteRegisterWord(RegisterType::SP, 0x7A4B);
    WriteRegisterByte(RegisterType::A, 0x62);
    WriteRegisterByte(RegisterType::B, 0x84);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0x92);
    WriteRegisterByte(RegisterType::E, 0x34);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x8F);
    WriteRegisterByte(RegisterType::L, 0xCF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7A4C, 0xF4);
    WriteMemory(0x7A4B, 0xD3);
    WriteMemory(0x6F9A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x62);
    CheckRegisterByte(RegisterType::B, 0x84);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0xF4);
    CheckRegisterByte(RegisterType::E, 0xD3);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x8F);
    CheckRegisterByte(RegisterType::L, 0xCF);
    CheckRegisterWord(RegisterType::PC, 0x6F9B);
    CheckRegisterWord(RegisterType::SP, 0x7A4D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6F9A, 0xD1);
    CheckMemory(0x7A4B, 0xD3);
    CheckMemory(0x7A4C, 0xF4);
}

void test_D1_0262()
{
    if (skip_test_D1_0262)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x11EB);
    WriteRegisterWord(RegisterType::SP, 0x5F5B);
    WriteRegisterByte(RegisterType::A, 0xCE);
    WriteRegisterByte(RegisterType::B, 0x48);
    WriteRegisterByte(RegisterType::C, 0x5F);
    WriteRegisterByte(RegisterType::D, 0x9E);
    WriteRegisterByte(RegisterType::E, 0x68);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5F5C, 0x8C);
    WriteMemory(0x5F5B, 0x05);
    WriteMemory(0x11EB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCE);
    CheckRegisterByte(RegisterType::B, 0x48);
    CheckRegisterByte(RegisterType::C, 0x5F);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0x05);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0x11EC);
    CheckRegisterWord(RegisterType::SP, 0x5F5D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x11EB, 0xD1);
    CheckMemory(0x5F5B, 0x05);
    CheckMemory(0x5F5C, 0x8C);
}

void test_D1_0263()
{
    if (skip_test_D1_0263)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x07E4);
    WriteRegisterWord(RegisterType::SP, 0x7330);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0xF5);
    WriteRegisterByte(RegisterType::C, 0x84);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0x91);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xC1);
    WriteRegisterByte(RegisterType::L, 0xB2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7331, 0xAE);
    WriteMemory(0x7330, 0xA5);
    WriteMemory(0x07E4, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0xF5);
    CheckRegisterByte(RegisterType::C, 0x84);
    CheckRegisterByte(RegisterType::D, 0xAE);
    CheckRegisterByte(RegisterType::E, 0xA5);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xC1);
    CheckRegisterByte(RegisterType::L, 0xB2);
    CheckRegisterWord(RegisterType::PC, 0x07E5);
    CheckRegisterWord(RegisterType::SP, 0x7332);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x07E4, 0xD1);
    CheckMemory(0x7330, 0xA5);
    CheckMemory(0x7331, 0xAE);
}

void test_D1_0264()
{
    if (skip_test_D1_0264)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC6EC);
    WriteRegisterWord(RegisterType::SP, 0x578B);
    WriteRegisterByte(RegisterType::A, 0x1A);
    WriteRegisterByte(RegisterType::B, 0x5D);
    WriteRegisterByte(RegisterType::C, 0x82);
    WriteRegisterByte(RegisterType::D, 0xD1);
    WriteRegisterByte(RegisterType::E, 0xCA);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x52);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC6EC, 0xD1);
    WriteMemory(0x578C, 0xE1);
    WriteMemory(0x578B, 0x15);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1A);
    CheckRegisterByte(RegisterType::B, 0x5D);
    CheckRegisterByte(RegisterType::C, 0x82);
    CheckRegisterByte(RegisterType::D, 0xE1);
    CheckRegisterByte(RegisterType::E, 0x15);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x52);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0xC6ED);
    CheckRegisterWord(RegisterType::SP, 0x578D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x578B, 0x15);
    CheckMemory(0x578C, 0xE1);
    CheckMemory(0xC6EC, 0xD1);
}

void test_D1_0265()
{
    if (skip_test_D1_0265)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA336);
    WriteRegisterWord(RegisterType::SP, 0x2B92);
    WriteRegisterByte(RegisterType::A, 0xE1);
    WriteRegisterByte(RegisterType::B, 0xC2);
    WriteRegisterByte(RegisterType::C, 0xD2);
    WriteRegisterByte(RegisterType::D, 0x5D);
    WriteRegisterByte(RegisterType::E, 0xDB);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA336, 0xD1);
    WriteMemory(0x2B93, 0x00);
    WriteMemory(0x2B92, 0x4A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE1);
    CheckRegisterByte(RegisterType::B, 0xC2);
    CheckRegisterByte(RegisterType::C, 0xD2);
    CheckRegisterByte(RegisterType::D, 0x00);
    CheckRegisterByte(RegisterType::E, 0x4A);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0xA337);
    CheckRegisterWord(RegisterType::SP, 0x2B94);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2B92, 0x4A);
    CheckMemory(0x2B93, 0x00);
    CheckMemory(0xA336, 0xD1);
}

void test_D1_0266()
{
    if (skip_test_D1_0266)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3F4D);
    WriteRegisterWord(RegisterType::SP, 0x6B74);
    WriteRegisterByte(RegisterType::A, 0x59);
    WriteRegisterByte(RegisterType::B, 0xE9);
    WriteRegisterByte(RegisterType::C, 0x31);
    WriteRegisterByte(RegisterType::D, 0x1A);
    WriteRegisterByte(RegisterType::E, 0x4D);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x5D);
    WriteRegisterByte(RegisterType::L, 0xEF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6B75, 0x0F);
    WriteMemory(0x6B74, 0x72);
    WriteMemory(0x3F4D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x59);
    CheckRegisterByte(RegisterType::B, 0xE9);
    CheckRegisterByte(RegisterType::C, 0x31);
    CheckRegisterByte(RegisterType::D, 0x0F);
    CheckRegisterByte(RegisterType::E, 0x72);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x5D);
    CheckRegisterByte(RegisterType::L, 0xEF);
    CheckRegisterWord(RegisterType::PC, 0x3F4E);
    CheckRegisterWord(RegisterType::SP, 0x6B76);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3F4D, 0xD1);
    CheckMemory(0x6B74, 0x72);
    CheckMemory(0x6B75, 0x0F);
}

void test_D1_0267()
{
    if (skip_test_D1_0267)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDBDE);
    WriteRegisterWord(RegisterType::SP, 0x9191);
    WriteRegisterByte(RegisterType::A, 0xC8);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0xEB);
    WriteRegisterByte(RegisterType::E, 0x0E);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x92);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDBDE, 0xD1);
    WriteMemory(0x9192, 0x95);
    WriteMemory(0x9191, 0x79);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC8);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0x95);
    CheckRegisterByte(RegisterType::E, 0x79);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x92);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0xDBDF);
    CheckRegisterWord(RegisterType::SP, 0x9193);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9191, 0x79);
    CheckMemory(0x9192, 0x95);
    CheckMemory(0xDBDE, 0xD1);
}

void test_D1_0268()
{
    if (skip_test_D1_0268)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD0CC);
    WriteRegisterWord(RegisterType::SP, 0x9311);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0x1B);
    WriteRegisterByte(RegisterType::C, 0x6B);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0xA6);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0xD5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD0CC, 0xD1);
    WriteMemory(0x9312, 0x9C);
    WriteMemory(0x9311, 0x66);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0x1B);
    CheckRegisterByte(RegisterType::C, 0x6B);
    CheckRegisterByte(RegisterType::D, 0x9C);
    CheckRegisterByte(RegisterType::E, 0x66);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0xD5);
    CheckRegisterWord(RegisterType::PC, 0xD0CD);
    CheckRegisterWord(RegisterType::SP, 0x9313);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9311, 0x66);
    CheckMemory(0x9312, 0x9C);
    CheckMemory(0xD0CC, 0xD1);
}

void test_D1_0269()
{
    if (skip_test_D1_0269)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x02E4);
    WriteRegisterWord(RegisterType::SP, 0x5754);
    WriteRegisterByte(RegisterType::A, 0xAA);
    WriteRegisterByte(RegisterType::B, 0x82);
    WriteRegisterByte(RegisterType::C, 0xE7);
    WriteRegisterByte(RegisterType::D, 0x68);
    WriteRegisterByte(RegisterType::E, 0x72);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xC2);
    WriteRegisterByte(RegisterType::L, 0xFC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5755, 0x6D);
    WriteMemory(0x5754, 0x73);
    WriteMemory(0x02E4, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAA);
    CheckRegisterByte(RegisterType::B, 0x82);
    CheckRegisterByte(RegisterType::C, 0xE7);
    CheckRegisterByte(RegisterType::D, 0x6D);
    CheckRegisterByte(RegisterType::E, 0x73);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xC2);
    CheckRegisterByte(RegisterType::L, 0xFC);
    CheckRegisterWord(RegisterType::PC, 0x02E5);
    CheckRegisterWord(RegisterType::SP, 0x5756);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x02E4, 0xD1);
    CheckMemory(0x5754, 0x73);
    CheckMemory(0x5755, 0x6D);
}

void test_D1_026A()
{
    if (skip_test_D1_026A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3898);
    WriteRegisterWord(RegisterType::SP, 0x5D88);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0x48);
    WriteRegisterByte(RegisterType::C, 0x83);
    WriteRegisterByte(RegisterType::D, 0xFA);
    WriteRegisterByte(RegisterType::E, 0x68);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xCF);
    WriteRegisterByte(RegisterType::L, 0xD5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5D89, 0x5A);
    WriteMemory(0x5D88, 0x97);
    WriteMemory(0x3898, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0x48);
    CheckRegisterByte(RegisterType::C, 0x83);
    CheckRegisterByte(RegisterType::D, 0x5A);
    CheckRegisterByte(RegisterType::E, 0x97);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xCF);
    CheckRegisterByte(RegisterType::L, 0xD5);
    CheckRegisterWord(RegisterType::PC, 0x3899);
    CheckRegisterWord(RegisterType::SP, 0x5D8A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3898, 0xD1);
    CheckMemory(0x5D88, 0x97);
    CheckMemory(0x5D89, 0x5A);
}

void test_D1_026B()
{
    if (skip_test_D1_026B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x00E2);
    WriteRegisterWord(RegisterType::SP, 0xE6E9);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0xC4);
    WriteRegisterByte(RegisterType::C, 0x1D);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0xCD);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xE9);
    WriteRegisterByte(RegisterType::L, 0xB2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE6EA, 0x66);
    WriteMemory(0xE6E9, 0x80);
    WriteMemory(0x00E2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0xC4);
    CheckRegisterByte(RegisterType::C, 0x1D);
    CheckRegisterByte(RegisterType::D, 0x66);
    CheckRegisterByte(RegisterType::E, 0x80);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xE9);
    CheckRegisterByte(RegisterType::L, 0xB2);
    CheckRegisterWord(RegisterType::PC, 0x00E3);
    CheckRegisterWord(RegisterType::SP, 0xE6EB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x00E2, 0xD1);
    CheckMemory(0xE6E9, 0x80);
    CheckMemory(0xE6EA, 0x66);
}

void test_D1_026C()
{
    if (skip_test_D1_026C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x858E);
    WriteRegisterWord(RegisterType::SP, 0xD82B);
    WriteRegisterByte(RegisterType::A, 0xC5);
    WriteRegisterByte(RegisterType::B, 0xB2);
    WriteRegisterByte(RegisterType::C, 0xC8);
    WriteRegisterByte(RegisterType::D, 0x31);
    WriteRegisterByte(RegisterType::E, 0x36);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x6A);
    WriteRegisterByte(RegisterType::L, 0x81);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD82C, 0x13);
    WriteMemory(0xD82B, 0xE2);
    WriteMemory(0x858E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC5);
    CheckRegisterByte(RegisterType::B, 0xB2);
    CheckRegisterByte(RegisterType::C, 0xC8);
    CheckRegisterByte(RegisterType::D, 0x13);
    CheckRegisterByte(RegisterType::E, 0xE2);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x6A);
    CheckRegisterByte(RegisterType::L, 0x81);
    CheckRegisterWord(RegisterType::PC, 0x858F);
    CheckRegisterWord(RegisterType::SP, 0xD82D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x858E, 0xD1);
    CheckMemory(0xD82B, 0xE2);
    CheckMemory(0xD82C, 0x13);
}

void test_D1_026D()
{
    if (skip_test_D1_026D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x31EB);
    WriteRegisterWord(RegisterType::SP, 0xC304);
    WriteRegisterByte(RegisterType::A, 0x43);
    WriteRegisterByte(RegisterType::B, 0x08);
    WriteRegisterByte(RegisterType::C, 0x0F);
    WriteRegisterByte(RegisterType::D, 0x7E);
    WriteRegisterByte(RegisterType::E, 0x91);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0x5B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC305, 0x08);
    WriteMemory(0xC304, 0xD1);
    WriteMemory(0x31EB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x43);
    CheckRegisterByte(RegisterType::B, 0x08);
    CheckRegisterByte(RegisterType::C, 0x0F);
    CheckRegisterByte(RegisterType::D, 0x08);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0x5B);
    CheckRegisterWord(RegisterType::PC, 0x31EC);
    CheckRegisterWord(RegisterType::SP, 0xC306);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x31EB, 0xD1);
    CheckMemory(0xC304, 0xD1);
    CheckMemory(0xC305, 0x08);
}

void test_D1_026E()
{
    if (skip_test_D1_026E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB0ED);
    WriteRegisterWord(RegisterType::SP, 0xCFC5);
    WriteRegisterByte(RegisterType::A, 0x31);
    WriteRegisterByte(RegisterType::B, 0xE3);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0xBE);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x1A);
    WriteRegisterByte(RegisterType::L, 0xF1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCFC6, 0xAF);
    WriteMemory(0xCFC5, 0x3D);
    WriteMemory(0xB0ED, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x31);
    CheckRegisterByte(RegisterType::B, 0xE3);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0xAF);
    CheckRegisterByte(RegisterType::E, 0x3D);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x1A);
    CheckRegisterByte(RegisterType::L, 0xF1);
    CheckRegisterWord(RegisterType::PC, 0xB0EE);
    CheckRegisterWord(RegisterType::SP, 0xCFC7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB0ED, 0xD1);
    CheckMemory(0xCFC5, 0x3D);
    CheckMemory(0xCFC6, 0xAF);
}

void test_D1_026F()
{
    if (skip_test_D1_026F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6D3D);
    WriteRegisterWord(RegisterType::SP, 0x2447);
    WriteRegisterByte(RegisterType::A, 0x57);
    WriteRegisterByte(RegisterType::B, 0xDF);
    WriteRegisterByte(RegisterType::C, 0x1E);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0xB6);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0x08);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6D3D, 0xD1);
    WriteMemory(0x2448, 0x21);
    WriteMemory(0x2447, 0xF5);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x57);
    CheckRegisterByte(RegisterType::B, 0xDF);
    CheckRegisterByte(RegisterType::C, 0x1E);
    CheckRegisterByte(RegisterType::D, 0x21);
    CheckRegisterByte(RegisterType::E, 0xF5);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0x08);
    CheckRegisterWord(RegisterType::PC, 0x6D3E);
    CheckRegisterWord(RegisterType::SP, 0x2449);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2447, 0xF5);
    CheckMemory(0x2448, 0x21);
    CheckMemory(0x6D3D, 0xD1);
}

void test_D1_0270()
{
    if (skip_test_D1_0270)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6C82);
    WriteRegisterWord(RegisterType::SP, 0xC9C1);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0xB0);
    WriteRegisterByte(RegisterType::C, 0x64);
    WriteRegisterByte(RegisterType::D, 0xAD);
    WriteRegisterByte(RegisterType::E, 0xEC);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x64);
    WriteRegisterByte(RegisterType::L, 0x7F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC9C2, 0xDA);
    WriteMemory(0xC9C1, 0xDD);
    WriteMemory(0x6C82, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0xB0);
    CheckRegisterByte(RegisterType::C, 0x64);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0xDD);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x64);
    CheckRegisterByte(RegisterType::L, 0x7F);
    CheckRegisterWord(RegisterType::PC, 0x6C83);
    CheckRegisterWord(RegisterType::SP, 0xC9C3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6C82, 0xD1);
    CheckMemory(0xC9C1, 0xDD);
    CheckMemory(0xC9C2, 0xDA);
}

void test_D1_0271()
{
    if (skip_test_D1_0271)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0976);
    WriteRegisterWord(RegisterType::SP, 0x4126);
    WriteRegisterByte(RegisterType::A, 0xAD);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0xA3);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0x3A);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x4D);
    WriteRegisterByte(RegisterType::L, 0xBC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4127, 0x31);
    WriteMemory(0x4126, 0x06);
    WriteMemory(0x0976, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAD);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0xA3);
    CheckRegisterByte(RegisterType::D, 0x31);
    CheckRegisterByte(RegisterType::E, 0x06);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x4D);
    CheckRegisterByte(RegisterType::L, 0xBC);
    CheckRegisterWord(RegisterType::PC, 0x0977);
    CheckRegisterWord(RegisterType::SP, 0x4128);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0976, 0xD1);
    CheckMemory(0x4126, 0x06);
    CheckMemory(0x4127, 0x31);
}

void test_D1_0272()
{
    if (skip_test_D1_0272)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x708D);
    WriteRegisterWord(RegisterType::SP, 0x5DCC);
    WriteRegisterByte(RegisterType::A, 0x50);
    WriteRegisterByte(RegisterType::B, 0x75);
    WriteRegisterByte(RegisterType::C, 0x21);
    WriteRegisterByte(RegisterType::D, 0x80);
    WriteRegisterByte(RegisterType::E, 0x6F);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xEF);
    WriteRegisterByte(RegisterType::L, 0x26);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x708D, 0xD1);
    WriteMemory(0x5DCD, 0x3A);
    WriteMemory(0x5DCC, 0xE6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x50);
    CheckRegisterByte(RegisterType::B, 0x75);
    CheckRegisterByte(RegisterType::C, 0x21);
    CheckRegisterByte(RegisterType::D, 0x3A);
    CheckRegisterByte(RegisterType::E, 0xE6);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xEF);
    CheckRegisterByte(RegisterType::L, 0x26);
    CheckRegisterWord(RegisterType::PC, 0x708E);
    CheckRegisterWord(RegisterType::SP, 0x5DCE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5DCC, 0xE6);
    CheckMemory(0x5DCD, 0x3A);
    CheckMemory(0x708D, 0xD1);
}

void test_D1_0273()
{
    if (skip_test_D1_0273)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x273E);
    WriteRegisterWord(RegisterType::SP, 0x5C07);
    WriteRegisterByte(RegisterType::A, 0x49);
    WriteRegisterByte(RegisterType::B, 0x2F);
    WriteRegisterByte(RegisterType::C, 0xCE);
    WriteRegisterByte(RegisterType::D, 0x83);
    WriteRegisterByte(RegisterType::E, 0xB4);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x7D);
    WriteRegisterByte(RegisterType::L, 0x36);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5C08, 0x5D);
    WriteMemory(0x5C07, 0xC2);
    WriteMemory(0x273E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x49);
    CheckRegisterByte(RegisterType::B, 0x2F);
    CheckRegisterByte(RegisterType::C, 0xCE);
    CheckRegisterByte(RegisterType::D, 0x5D);
    CheckRegisterByte(RegisterType::E, 0xC2);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x7D);
    CheckRegisterByte(RegisterType::L, 0x36);
    CheckRegisterWord(RegisterType::PC, 0x273F);
    CheckRegisterWord(RegisterType::SP, 0x5C09);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x273E, 0xD1);
    CheckMemory(0x5C07, 0xC2);
    CheckMemory(0x5C08, 0x5D);
}

void test_D1_0274()
{
    if (skip_test_D1_0274)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0754);
    WriteRegisterWord(RegisterType::SP, 0xF115);
    WriteRegisterByte(RegisterType::A, 0x57);
    WriteRegisterByte(RegisterType::B, 0xF7);
    WriteRegisterByte(RegisterType::C, 0x75);
    WriteRegisterByte(RegisterType::D, 0x2E);
    WriteRegisterByte(RegisterType::E, 0xD5);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC3);
    WriteRegisterByte(RegisterType::L, 0x5B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF116, 0x65);
    WriteMemory(0xF115, 0x7C);
    WriteMemory(0x0754, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x57);
    CheckRegisterByte(RegisterType::B, 0xF7);
    CheckRegisterByte(RegisterType::C, 0x75);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0x7C);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC3);
    CheckRegisterByte(RegisterType::L, 0x5B);
    CheckRegisterWord(RegisterType::PC, 0x0755);
    CheckRegisterWord(RegisterType::SP, 0xF117);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0754, 0xD1);
    CheckMemory(0xF115, 0x7C);
    CheckMemory(0xF116, 0x65);
}

void test_D1_0275()
{
    if (skip_test_D1_0275)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3350);
    WriteRegisterWord(RegisterType::SP, 0x9EB0);
    WriteRegisterByte(RegisterType::A, 0xA3);
    WriteRegisterByte(RegisterType::B, 0xB9);
    WriteRegisterByte(RegisterType::C, 0xC2);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0xEA);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x69);
    WriteRegisterByte(RegisterType::L, 0x8B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9EB1, 0xEE);
    WriteMemory(0x9EB0, 0xD3);
    WriteMemory(0x3350, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA3);
    CheckRegisterByte(RegisterType::B, 0xB9);
    CheckRegisterByte(RegisterType::C, 0xC2);
    CheckRegisterByte(RegisterType::D, 0xEE);
    CheckRegisterByte(RegisterType::E, 0xD3);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x69);
    CheckRegisterByte(RegisterType::L, 0x8B);
    CheckRegisterWord(RegisterType::PC, 0x3351);
    CheckRegisterWord(RegisterType::SP, 0x9EB2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3350, 0xD1);
    CheckMemory(0x9EB0, 0xD3);
    CheckMemory(0x9EB1, 0xEE);
}

void test_D1_0276()
{
    if (skip_test_D1_0276)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBF92);
    WriteRegisterWord(RegisterType::SP, 0xF6E7);
    WriteRegisterByte(RegisterType::A, 0x06);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0x39);
    WriteRegisterByte(RegisterType::D, 0x25);
    WriteRegisterByte(RegisterType::E, 0xF2);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xD6);
    WriteRegisterByte(RegisterType::L, 0x43);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF6E8, 0xA6);
    WriteMemory(0xF6E7, 0x8A);
    WriteMemory(0xBF92, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x06);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0x39);
    CheckRegisterByte(RegisterType::D, 0xA6);
    CheckRegisterByte(RegisterType::E, 0x8A);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xD6);
    CheckRegisterByte(RegisterType::L, 0x43);
    CheckRegisterWord(RegisterType::PC, 0xBF93);
    CheckRegisterWord(RegisterType::SP, 0xF6E9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBF92, 0xD1);
    CheckMemory(0xF6E7, 0x8A);
    CheckMemory(0xF6E8, 0xA6);
}

void test_D1_0277()
{
    if (skip_test_D1_0277)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x031B);
    WriteRegisterWord(RegisterType::SP, 0x7D55);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0x2D);
    WriteRegisterByte(RegisterType::C, 0x9D);
    WriteRegisterByte(RegisterType::D, 0xD2);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x36);
    WriteRegisterByte(RegisterType::L, 0x87);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7D56, 0x79);
    WriteMemory(0x7D55, 0xDA);
    WriteMemory(0x031B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0x2D);
    CheckRegisterByte(RegisterType::C, 0x9D);
    CheckRegisterByte(RegisterType::D, 0x79);
    CheckRegisterByte(RegisterType::E, 0xDA);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x36);
    CheckRegisterByte(RegisterType::L, 0x87);
    CheckRegisterWord(RegisterType::PC, 0x031C);
    CheckRegisterWord(RegisterType::SP, 0x7D57);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x031B, 0xD1);
    CheckMemory(0x7D55, 0xDA);
    CheckMemory(0x7D56, 0x79);
}

void test_D1_0278()
{
    if (skip_test_D1_0278)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC6B4);
    WriteRegisterWord(RegisterType::SP, 0x12E1);
    WriteRegisterByte(RegisterType::A, 0x2A);
    WriteRegisterByte(RegisterType::B, 0x71);
    WriteRegisterByte(RegisterType::C, 0x2C);
    WriteRegisterByte(RegisterType::D, 0x8E);
    WriteRegisterByte(RegisterType::E, 0xFC);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xEF);
    WriteRegisterByte(RegisterType::L, 0x79);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC6B4, 0xD1);
    WriteMemory(0x12E2, 0x69);
    WriteMemory(0x12E1, 0x95);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2A);
    CheckRegisterByte(RegisterType::B, 0x71);
    CheckRegisterByte(RegisterType::C, 0x2C);
    CheckRegisterByte(RegisterType::D, 0x69);
    CheckRegisterByte(RegisterType::E, 0x95);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xEF);
    CheckRegisterByte(RegisterType::L, 0x79);
    CheckRegisterWord(RegisterType::PC, 0xC6B5);
    CheckRegisterWord(RegisterType::SP, 0x12E3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x12E1, 0x95);
    CheckMemory(0x12E2, 0x69);
    CheckMemory(0xC6B4, 0xD1);
}

void test_D1_0279()
{
    if (skip_test_D1_0279)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAE92);
    WriteRegisterWord(RegisterType::SP, 0x5B3B);
    WriteRegisterByte(RegisterType::A, 0x34);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0x25);
    WriteRegisterByte(RegisterType::E, 0x76);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0x00);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAE92, 0xD1);
    WriteMemory(0x5B3C, 0x13);
    WriteMemory(0x5B3B, 0xC9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x34);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0x13);
    CheckRegisterByte(RegisterType::E, 0xC9);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0x00);
    CheckRegisterWord(RegisterType::PC, 0xAE93);
    CheckRegisterWord(RegisterType::SP, 0x5B3D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5B3B, 0xC9);
    CheckMemory(0x5B3C, 0x13);
    CheckMemory(0xAE92, 0xD1);
}

void test_D1_027A()
{
    if (skip_test_D1_027A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1BFE);
    WriteRegisterWord(RegisterType::SP, 0x94F7);
    WriteRegisterByte(RegisterType::A, 0x1C);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0x21);
    WriteRegisterByte(RegisterType::D, 0x7C);
    WriteRegisterByte(RegisterType::E, 0x84);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xD7);
    WriteRegisterByte(RegisterType::L, 0xA9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x94F8, 0x81);
    WriteMemory(0x94F7, 0xD1);
    WriteMemory(0x1BFE, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1C);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0x21);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xD7);
    CheckRegisterByte(RegisterType::L, 0xA9);
    CheckRegisterWord(RegisterType::PC, 0x1BFF);
    CheckRegisterWord(RegisterType::SP, 0x94F9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1BFE, 0xD1);
    CheckMemory(0x94F7, 0xD1);
    CheckMemory(0x94F8, 0x81);
}

void test_D1_027B()
{
    if (skip_test_D1_027B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4BF0);
    WriteRegisterWord(RegisterType::SP, 0xE4E6);
    WriteRegisterByte(RegisterType::A, 0x4F);
    WriteRegisterByte(RegisterType::B, 0x61);
    WriteRegisterByte(RegisterType::C, 0x62);
    WriteRegisterByte(RegisterType::D, 0x1D);
    WriteRegisterByte(RegisterType::E, 0xCA);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x43);
    WriteRegisterByte(RegisterType::L, 0x59);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE4E7, 0x90);
    WriteMemory(0xE4E6, 0xF2);
    WriteMemory(0x4BF0, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4F);
    CheckRegisterByte(RegisterType::B, 0x61);
    CheckRegisterByte(RegisterType::C, 0x62);
    CheckRegisterByte(RegisterType::D, 0x90);
    CheckRegisterByte(RegisterType::E, 0xF2);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x43);
    CheckRegisterByte(RegisterType::L, 0x59);
    CheckRegisterWord(RegisterType::PC, 0x4BF1);
    CheckRegisterWord(RegisterType::SP, 0xE4E8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4BF0, 0xD1);
    CheckMemory(0xE4E6, 0xF2);
    CheckMemory(0xE4E7, 0x90);
}

void test_D1_027C()
{
    if (skip_test_D1_027C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAEBC);
    WriteRegisterWord(RegisterType::SP, 0x6EC0);
    WriteRegisterByte(RegisterType::A, 0xA2);
    WriteRegisterByte(RegisterType::B, 0x33);
    WriteRegisterByte(RegisterType::C, 0xE8);
    WriteRegisterByte(RegisterType::D, 0x30);
    WriteRegisterByte(RegisterType::E, 0xC8);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x8E);
    WriteRegisterByte(RegisterType::L, 0x6D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xAEBC, 0xD1);
    WriteMemory(0x6EC1, 0x3A);
    WriteMemory(0x6EC0, 0x0A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA2);
    CheckRegisterByte(RegisterType::B, 0x33);
    CheckRegisterByte(RegisterType::C, 0xE8);
    CheckRegisterByte(RegisterType::D, 0x3A);
    CheckRegisterByte(RegisterType::E, 0x0A);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x8E);
    CheckRegisterByte(RegisterType::L, 0x6D);
    CheckRegisterWord(RegisterType::PC, 0xAEBD);
    CheckRegisterWord(RegisterType::SP, 0x6EC2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6EC0, 0x0A);
    CheckMemory(0x6EC1, 0x3A);
    CheckMemory(0xAEBC, 0xD1);
}

void test_D1_027D()
{
    if (skip_test_D1_027D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDF0F);
    WriteRegisterWord(RegisterType::SP, 0x4328);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0xA6);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0x09);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x83);
    WriteRegisterByte(RegisterType::L, 0xEF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDF0F, 0xD1);
    WriteMemory(0x4329, 0x8B);
    WriteMemory(0x4328, 0x76);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0xA6);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0x8B);
    CheckRegisterByte(RegisterType::E, 0x76);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x83);
    CheckRegisterByte(RegisterType::L, 0xEF);
    CheckRegisterWord(RegisterType::PC, 0xDF10);
    CheckRegisterWord(RegisterType::SP, 0x432A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4328, 0x76);
    CheckMemory(0x4329, 0x8B);
    CheckMemory(0xDF0F, 0xD1);
}

void test_D1_027E()
{
    if (skip_test_D1_027E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCF94);
    WriteRegisterWord(RegisterType::SP, 0x02C0);
    WriteRegisterByte(RegisterType::A, 0x5F);
    WriteRegisterByte(RegisterType::B, 0x3D);
    WriteRegisterByte(RegisterType::C, 0x35);
    WriteRegisterByte(RegisterType::D, 0x22);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xD0);
    WriteRegisterByte(RegisterType::L, 0x45);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCF94, 0xD1);
    WriteMemory(0x02C1, 0x09);
    WriteMemory(0x02C0, 0x36);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5F);
    CheckRegisterByte(RegisterType::B, 0x3D);
    CheckRegisterByte(RegisterType::C, 0x35);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0x36);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xD0);
    CheckRegisterByte(RegisterType::L, 0x45);
    CheckRegisterWord(RegisterType::PC, 0xCF95);
    CheckRegisterWord(RegisterType::SP, 0x02C2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x02C0, 0x36);
    CheckMemory(0x02C1, 0x09);
    CheckMemory(0xCF94, 0xD1);
}

void test_D1_027F()
{
    if (skip_test_D1_027F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x60CC);
    WriteRegisterWord(RegisterType::SP, 0xE480);
    WriteRegisterByte(RegisterType::A, 0x3E);
    WriteRegisterByte(RegisterType::B, 0x2A);
    WriteRegisterByte(RegisterType::C, 0xB2);
    WriteRegisterByte(RegisterType::D, 0x72);
    WriteRegisterByte(RegisterType::E, 0xD9);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0x04);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE481, 0xAB);
    WriteMemory(0xE480, 0xFA);
    WriteMemory(0x60CC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3E);
    CheckRegisterByte(RegisterType::B, 0x2A);
    CheckRegisterByte(RegisterType::C, 0xB2);
    CheckRegisterByte(RegisterType::D, 0xAB);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0x04);
    CheckRegisterWord(RegisterType::PC, 0x60CD);
    CheckRegisterWord(RegisterType::SP, 0xE482);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x60CC, 0xD1);
    CheckMemory(0xE480, 0xFA);
    CheckMemory(0xE481, 0xAB);
}

void test_D1_0280()
{
    if (skip_test_D1_0280)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBE8D);
    WriteRegisterWord(RegisterType::SP, 0xFD39);
    WriteRegisterByte(RegisterType::A, 0x28);
    WriteRegisterByte(RegisterType::B, 0x93);
    WriteRegisterByte(RegisterType::C, 0x47);
    WriteRegisterByte(RegisterType::D, 0x81);
    WriteRegisterByte(RegisterType::E, 0x2C);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xEC);
    WriteRegisterByte(RegisterType::L, 0xD9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFD3A, 0x09);
    WriteMemory(0xFD39, 0x64);
    WriteMemory(0xBE8D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x28);
    CheckRegisterByte(RegisterType::B, 0x93);
    CheckRegisterByte(RegisterType::C, 0x47);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0x64);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xEC);
    CheckRegisterByte(RegisterType::L, 0xD9);
    CheckRegisterWord(RegisterType::PC, 0xBE8E);
    CheckRegisterWord(RegisterType::SP, 0xFD3B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBE8D, 0xD1);
    CheckMemory(0xFD39, 0x64);
    CheckMemory(0xFD3A, 0x09);
}

void test_D1_0281()
{
    if (skip_test_D1_0281)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8AC3);
    WriteRegisterWord(RegisterType::SP, 0x47FF);
    WriteRegisterByte(RegisterType::A, 0x17);
    WriteRegisterByte(RegisterType::B, 0x86);
    WriteRegisterByte(RegisterType::C, 0x15);
    WriteRegisterByte(RegisterType::D, 0x9C);
    WriteRegisterByte(RegisterType::E, 0xB6);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xDE);
    WriteRegisterByte(RegisterType::L, 0xCF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x8AC3, 0xD1);
    WriteMemory(0x4800, 0x78);
    WriteMemory(0x47FF, 0x72);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x17);
    CheckRegisterByte(RegisterType::B, 0x86);
    CheckRegisterByte(RegisterType::C, 0x15);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0x72);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xDE);
    CheckRegisterByte(RegisterType::L, 0xCF);
    CheckRegisterWord(RegisterType::PC, 0x8AC4);
    CheckRegisterWord(RegisterType::SP, 0x4801);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x47FF, 0x72);
    CheckMemory(0x4800, 0x78);
    CheckMemory(0x8AC3, 0xD1);
}

void test_D1_0282()
{
    if (skip_test_D1_0282)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7822);
    WriteRegisterWord(RegisterType::SP, 0x9263);
    WriteRegisterByte(RegisterType::A, 0xDF);
    WriteRegisterByte(RegisterType::B, 0x98);
    WriteRegisterByte(RegisterType::C, 0xE5);
    WriteRegisterByte(RegisterType::D, 0x7E);
    WriteRegisterByte(RegisterType::E, 0xA4);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xB3);
    WriteRegisterByte(RegisterType::L, 0x7A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9264, 0x3B);
    WriteMemory(0x9263, 0x2A);
    WriteMemory(0x7822, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDF);
    CheckRegisterByte(RegisterType::B, 0x98);
    CheckRegisterByte(RegisterType::C, 0xE5);
    CheckRegisterByte(RegisterType::D, 0x3B);
    CheckRegisterByte(RegisterType::E, 0x2A);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xB3);
    CheckRegisterByte(RegisterType::L, 0x7A);
    CheckRegisterWord(RegisterType::PC, 0x7823);
    CheckRegisterWord(RegisterType::SP, 0x9265);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7822, 0xD1);
    CheckMemory(0x9263, 0x2A);
    CheckMemory(0x9264, 0x3B);
}

void test_D1_0283()
{
    if (skip_test_D1_0283)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x20F0);
    WriteRegisterWord(RegisterType::SP, 0xC460);
    WriteRegisterByte(RegisterType::A, 0x9A);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0x18);
    WriteRegisterByte(RegisterType::D, 0x17);
    WriteRegisterByte(RegisterType::E, 0x34);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0x2D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC461, 0x1C);
    WriteMemory(0xC460, 0xED);
    WriteMemory(0x20F0, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9A);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0x18);
    CheckRegisterByte(RegisterType::D, 0x1C);
    CheckRegisterByte(RegisterType::E, 0xED);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0x2D);
    CheckRegisterWord(RegisterType::PC, 0x20F1);
    CheckRegisterWord(RegisterType::SP, 0xC462);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x20F0, 0xD1);
    CheckMemory(0xC460, 0xED);
    CheckMemory(0xC461, 0x1C);
}

void test_D1_0284()
{
    if (skip_test_D1_0284)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4938);
    WriteRegisterWord(RegisterType::SP, 0xB986);
    WriteRegisterByte(RegisterType::A, 0x5D);
    WriteRegisterByte(RegisterType::B, 0x70);
    WriteRegisterByte(RegisterType::C, 0x0E);
    WriteRegisterByte(RegisterType::D, 0xBC);
    WriteRegisterByte(RegisterType::E, 0x71);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x5E);
    WriteRegisterByte(RegisterType::L, 0x52);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB987, 0x02);
    WriteMemory(0xB986, 0x96);
    WriteMemory(0x4938, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5D);
    CheckRegisterByte(RegisterType::B, 0x70);
    CheckRegisterByte(RegisterType::C, 0x0E);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x5E);
    CheckRegisterByte(RegisterType::L, 0x52);
    CheckRegisterWord(RegisterType::PC, 0x4939);
    CheckRegisterWord(RegisterType::SP, 0xB988);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4938, 0xD1);
    CheckMemory(0xB986, 0x96);
    CheckMemory(0xB987, 0x02);
}

void test_D1_0285()
{
    if (skip_test_D1_0285)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0EFA);
    WriteRegisterWord(RegisterType::SP, 0x54BD);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0xAD);
    WriteRegisterByte(RegisterType::C, 0x8E);
    WriteRegisterByte(RegisterType::D, 0xDB);
    WriteRegisterByte(RegisterType::E, 0x4C);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0xCB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x54BE, 0x61);
    WriteMemory(0x54BD, 0x62);
    WriteMemory(0x0EFA, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0xAD);
    CheckRegisterByte(RegisterType::C, 0x8E);
    CheckRegisterByte(RegisterType::D, 0x61);
    CheckRegisterByte(RegisterType::E, 0x62);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0xCB);
    CheckRegisterWord(RegisterType::PC, 0x0EFB);
    CheckRegisterWord(RegisterType::SP, 0x54BF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0EFA, 0xD1);
    CheckMemory(0x54BD, 0x62);
    CheckMemory(0x54BE, 0x61);
}

void test_D1_0286()
{
    if (skip_test_D1_0286)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x460C);
    WriteRegisterWord(RegisterType::SP, 0x1C92);
    WriteRegisterByte(RegisterType::A, 0xB2);
    WriteRegisterByte(RegisterType::B, 0x0F);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0x04);
    WriteRegisterByte(RegisterType::E, 0xDE);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x32);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x460C, 0xD1);
    WriteMemory(0x1C93, 0xAF);
    WriteMemory(0x1C92, 0x35);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB2);
    CheckRegisterByte(RegisterType::B, 0x0F);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0xAF);
    CheckRegisterByte(RegisterType::E, 0x35);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x32);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0x460D);
    CheckRegisterWord(RegisterType::SP, 0x1C94);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1C92, 0x35);
    CheckMemory(0x1C93, 0xAF);
    CheckMemory(0x460C, 0xD1);
}

void test_D1_0287()
{
    if (skip_test_D1_0287)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD0F9);
    WriteRegisterWord(RegisterType::SP, 0x1433);
    WriteRegisterByte(RegisterType::A, 0x4B);
    WriteRegisterByte(RegisterType::B, 0x5C);
    WriteRegisterByte(RegisterType::C, 0xF0);
    WriteRegisterByte(RegisterType::D, 0x3A);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x9D);
    WriteRegisterByte(RegisterType::L, 0x61);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD0F9, 0xD1);
    WriteMemory(0x1434, 0xC8);
    WriteMemory(0x1433, 0x03);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4B);
    CheckRegisterByte(RegisterType::B, 0x5C);
    CheckRegisterByte(RegisterType::C, 0xF0);
    CheckRegisterByte(RegisterType::D, 0xC8);
    CheckRegisterByte(RegisterType::E, 0x03);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x9D);
    CheckRegisterByte(RegisterType::L, 0x61);
    CheckRegisterWord(RegisterType::PC, 0xD0FA);
    CheckRegisterWord(RegisterType::SP, 0x1435);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1433, 0x03);
    CheckMemory(0x1434, 0xC8);
    CheckMemory(0xD0F9, 0xD1);
}

void test_D1_0288()
{
    if (skip_test_D1_0288)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9375);
    WriteRegisterWord(RegisterType::SP, 0x306E);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0xB0);
    WriteRegisterByte(RegisterType::C, 0xA2);
    WriteRegisterByte(RegisterType::D, 0xC5);
    WriteRegisterByte(RegisterType::E, 0x63);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x9D);
    WriteRegisterByte(RegisterType::L, 0xED);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9375, 0xD1);
    WriteMemory(0x306F, 0x16);
    WriteMemory(0x306E, 0x91);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0xB0);
    CheckRegisterByte(RegisterType::C, 0xA2);
    CheckRegisterByte(RegisterType::D, 0x16);
    CheckRegisterByte(RegisterType::E, 0x91);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x9D);
    CheckRegisterByte(RegisterType::L, 0xED);
    CheckRegisterWord(RegisterType::PC, 0x9376);
    CheckRegisterWord(RegisterType::SP, 0x3070);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x306E, 0x91);
    CheckMemory(0x306F, 0x16);
    CheckMemory(0x9375, 0xD1);
}

void test_D1_0289()
{
    if (skip_test_D1_0289)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8449);
    WriteRegisterWord(RegisterType::SP, 0x3903);
    WriteRegisterByte(RegisterType::A, 0x2B);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0x44);
    WriteRegisterByte(RegisterType::D, 0x30);
    WriteRegisterByte(RegisterType::E, 0x73);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x51);
    WriteRegisterByte(RegisterType::L, 0xE2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8449, 0xD1);
    WriteMemory(0x3904, 0x18);
    WriteMemory(0x3903, 0x32);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2B);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0x44);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0x32);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x51);
    CheckRegisterByte(RegisterType::L, 0xE2);
    CheckRegisterWord(RegisterType::PC, 0x844A);
    CheckRegisterWord(RegisterType::SP, 0x3905);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3903, 0x32);
    CheckMemory(0x3904, 0x18);
    CheckMemory(0x8449, 0xD1);
}

void test_D1_028A()
{
    if (skip_test_D1_028A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDE21);
    WriteRegisterWord(RegisterType::SP, 0xBAB7);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0x92);
    WriteRegisterByte(RegisterType::C, 0xD9);
    WriteRegisterByte(RegisterType::D, 0xB7);
    WriteRegisterByte(RegisterType::E, 0xCE);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xAE);
    WriteRegisterByte(RegisterType::L, 0xF9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDE21, 0xD1);
    WriteMemory(0xBAB8, 0x77);
    WriteMemory(0xBAB7, 0xB0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0x92);
    CheckRegisterByte(RegisterType::C, 0xD9);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xAE);
    CheckRegisterByte(RegisterType::L, 0xF9);
    CheckRegisterWord(RegisterType::PC, 0xDE22);
    CheckRegisterWord(RegisterType::SP, 0xBAB9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBAB7, 0xB0);
    CheckMemory(0xBAB8, 0x77);
    CheckMemory(0xDE21, 0xD1);
}

void test_D1_028B()
{
    if (skip_test_D1_028B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1505);
    WriteRegisterWord(RegisterType::SP, 0x3025);
    WriteRegisterByte(RegisterType::A, 0x28);
    WriteRegisterByte(RegisterType::B, 0x72);
    WriteRegisterByte(RegisterType::C, 0x7D);
    WriteRegisterByte(RegisterType::D, 0x3A);
    WriteRegisterByte(RegisterType::E, 0x37);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x05);
    WriteRegisterByte(RegisterType::L, 0x54);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x3026, 0x17);
    WriteMemory(0x3025, 0x68);
    WriteMemory(0x1505, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x28);
    CheckRegisterByte(RegisterType::B, 0x72);
    CheckRegisterByte(RegisterType::C, 0x7D);
    CheckRegisterByte(RegisterType::D, 0x17);
    CheckRegisterByte(RegisterType::E, 0x68);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x05);
    CheckRegisterByte(RegisterType::L, 0x54);
    CheckRegisterWord(RegisterType::PC, 0x1506);
    CheckRegisterWord(RegisterType::SP, 0x3027);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1505, 0xD1);
    CheckMemory(0x3025, 0x68);
    CheckMemory(0x3026, 0x17);
}

void test_D1_028C()
{
    if (skip_test_D1_028C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0BE9);
    WriteRegisterWord(RegisterType::SP, 0xFB6B);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0x83);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0x44);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x35);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFB6C, 0x11);
    WriteMemory(0xFB6B, 0xC3);
    WriteMemory(0x0BE9, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0x83);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0x11);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x35);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0x0BEA);
    CheckRegisterWord(RegisterType::SP, 0xFB6D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0BE9, 0xD1);
    CheckMemory(0xFB6B, 0xC3);
    CheckMemory(0xFB6C, 0x11);
}

void test_D1_028D()
{
    if (skip_test_D1_028D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFA10);
    WriteRegisterWord(RegisterType::SP, 0x582A);
    WriteRegisterByte(RegisterType::A, 0x55);
    WriteRegisterByte(RegisterType::B, 0x73);
    WriteRegisterByte(RegisterType::C, 0xCD);
    WriteRegisterByte(RegisterType::D, 0x39);
    WriteRegisterByte(RegisterType::E, 0x14);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xA6);
    WriteRegisterByte(RegisterType::L, 0x88);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFA10, 0xD1);
    WriteMemory(0x582B, 0xA1);
    WriteMemory(0x582A, 0x76);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x55);
    CheckRegisterByte(RegisterType::B, 0x73);
    CheckRegisterByte(RegisterType::C, 0xCD);
    CheckRegisterByte(RegisterType::D, 0xA1);
    CheckRegisterByte(RegisterType::E, 0x76);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xA6);
    CheckRegisterByte(RegisterType::L, 0x88);
    CheckRegisterWord(RegisterType::PC, 0xFA11);
    CheckRegisterWord(RegisterType::SP, 0x582C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x582A, 0x76);
    CheckMemory(0x582B, 0xA1);
    CheckMemory(0xFA10, 0xD1);
}

void test_D1_028E()
{
    if (skip_test_D1_028E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x150D);
    WriteRegisterWord(RegisterType::SP, 0x4DA9);
    WriteRegisterByte(RegisterType::A, 0x62);
    WriteRegisterByte(RegisterType::B, 0x7D);
    WriteRegisterByte(RegisterType::C, 0x00);
    WriteRegisterByte(RegisterType::D, 0xB4);
    WriteRegisterByte(RegisterType::E, 0xC0);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xCF);
    WriteRegisterByte(RegisterType::L, 0xA0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x4DAA, 0x85);
    WriteMemory(0x4DA9, 0xA6);
    WriteMemory(0x150D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x62);
    CheckRegisterByte(RegisterType::B, 0x7D);
    CheckRegisterByte(RegisterType::C, 0x00);
    CheckRegisterByte(RegisterType::D, 0x85);
    CheckRegisterByte(RegisterType::E, 0xA6);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xCF);
    CheckRegisterByte(RegisterType::L, 0xA0);
    CheckRegisterWord(RegisterType::PC, 0x150E);
    CheckRegisterWord(RegisterType::SP, 0x4DAB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x150D, 0xD1);
    CheckMemory(0x4DA9, 0xA6);
    CheckMemory(0x4DAA, 0x85);
}

void test_D1_028F()
{
    if (skip_test_D1_028F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD3E);
    WriteRegisterWord(RegisterType::SP, 0x04F8);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0xD5);
    WriteRegisterByte(RegisterType::D, 0xFB);
    WriteRegisterByte(RegisterType::E, 0x07);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x58);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCD3E, 0xD1);
    WriteMemory(0x04F9, 0x50);
    WriteMemory(0x04F8, 0xC0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0xD5);
    CheckRegisterByte(RegisterType::D, 0x50);
    CheckRegisterByte(RegisterType::E, 0xC0);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x58);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0xCD3F);
    CheckRegisterWord(RegisterType::SP, 0x04FA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x04F8, 0xC0);
    CheckMemory(0x04F9, 0x50);
    CheckMemory(0xCD3E, 0xD1);
}

void test_D1_0290()
{
    if (skip_test_D1_0290)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1F5A);
    WriteRegisterWord(RegisterType::SP, 0x5B32);
    WriteRegisterByte(RegisterType::A, 0xEE);
    WriteRegisterByte(RegisterType::B, 0x48);
    WriteRegisterByte(RegisterType::C, 0x34);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0x84);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x4E);
    WriteRegisterByte(RegisterType::L, 0x90);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5B33, 0xB2);
    WriteMemory(0x5B32, 0xA8);
    WriteMemory(0x1F5A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEE);
    CheckRegisterByte(RegisterType::B, 0x48);
    CheckRegisterByte(RegisterType::C, 0x34);
    CheckRegisterByte(RegisterType::D, 0xB2);
    CheckRegisterByte(RegisterType::E, 0xA8);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x4E);
    CheckRegisterByte(RegisterType::L, 0x90);
    CheckRegisterWord(RegisterType::PC, 0x1F5B);
    CheckRegisterWord(RegisterType::SP, 0x5B34);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1F5A, 0xD1);
    CheckMemory(0x5B32, 0xA8);
    CheckMemory(0x5B33, 0xB2);
}

void test_D1_0291()
{
    if (skip_test_D1_0291)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5122);
    WriteRegisterWord(RegisterType::SP, 0xC9BB);
    WriteRegisterByte(RegisterType::A, 0x28);
    WriteRegisterByte(RegisterType::B, 0xED);
    WriteRegisterByte(RegisterType::C, 0xD5);
    WriteRegisterByte(RegisterType::D, 0xDB);
    WriteRegisterByte(RegisterType::E, 0x68);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xBA);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC9BC, 0xE6);
    WriteMemory(0xC9BB, 0x33);
    WriteMemory(0x5122, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x28);
    CheckRegisterByte(RegisterType::B, 0xED);
    CheckRegisterByte(RegisterType::C, 0xD5);
    CheckRegisterByte(RegisterType::D, 0xE6);
    CheckRegisterByte(RegisterType::E, 0x33);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xBA);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0x5123);
    CheckRegisterWord(RegisterType::SP, 0xC9BD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5122, 0xD1);
    CheckMemory(0xC9BB, 0x33);
    CheckMemory(0xC9BC, 0xE6);
}

void test_D1_0292()
{
    if (skip_test_D1_0292)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBBF8);
    WriteRegisterWord(RegisterType::SP, 0x8650);
    WriteRegisterByte(RegisterType::A, 0x7A);
    WriteRegisterByte(RegisterType::B, 0x81);
    WriteRegisterByte(RegisterType::C, 0x89);
    WriteRegisterByte(RegisterType::D, 0x1B);
    WriteRegisterByte(RegisterType::E, 0x8F);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x09);
    WriteRegisterByte(RegisterType::L, 0x0B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBBF8, 0xD1);
    WriteMemory(0x8651, 0x55);
    WriteMemory(0x8650, 0x92);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7A);
    CheckRegisterByte(RegisterType::B, 0x81);
    CheckRegisterByte(RegisterType::C, 0x89);
    CheckRegisterByte(RegisterType::D, 0x55);
    CheckRegisterByte(RegisterType::E, 0x92);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x09);
    CheckRegisterByte(RegisterType::L, 0x0B);
    CheckRegisterWord(RegisterType::PC, 0xBBF9);
    CheckRegisterWord(RegisterType::SP, 0x8652);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8650, 0x92);
    CheckMemory(0x8651, 0x55);
    CheckMemory(0xBBF8, 0xD1);
}

void test_D1_0293()
{
    if (skip_test_D1_0293)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x24A2);
    WriteRegisterWord(RegisterType::SP, 0x3E16);
    WriteRegisterByte(RegisterType::A, 0xD2);
    WriteRegisterByte(RegisterType::B, 0x9C);
    WriteRegisterByte(RegisterType::C, 0xD0);
    WriteRegisterByte(RegisterType::D, 0x8D);
    WriteRegisterByte(RegisterType::E, 0xE1);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x8A);
    WriteRegisterByte(RegisterType::L, 0x63);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x3E17, 0x13);
    WriteMemory(0x3E16, 0x57);
    WriteMemory(0x24A2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD2);
    CheckRegisterByte(RegisterType::B, 0x9C);
    CheckRegisterByte(RegisterType::C, 0xD0);
    CheckRegisterByte(RegisterType::D, 0x13);
    CheckRegisterByte(RegisterType::E, 0x57);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x8A);
    CheckRegisterByte(RegisterType::L, 0x63);
    CheckRegisterWord(RegisterType::PC, 0x24A3);
    CheckRegisterWord(RegisterType::SP, 0x3E18);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x24A2, 0xD1);
    CheckMemory(0x3E16, 0x57);
    CheckMemory(0x3E17, 0x13);
}

void test_D1_0294()
{
    if (skip_test_D1_0294)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC623);
    WriteRegisterWord(RegisterType::SP, 0x6982);
    WriteRegisterByte(RegisterType::A, 0x3E);
    WriteRegisterByte(RegisterType::B, 0x99);
    WriteRegisterByte(RegisterType::C, 0x62);
    WriteRegisterByte(RegisterType::D, 0xA8);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x7F);
    WriteRegisterByte(RegisterType::L, 0xC0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC623, 0xD1);
    WriteMemory(0x6983, 0xAF);
    WriteMemory(0x6982, 0x10);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3E);
    CheckRegisterByte(RegisterType::B, 0x99);
    CheckRegisterByte(RegisterType::C, 0x62);
    CheckRegisterByte(RegisterType::D, 0xAF);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x7F);
    CheckRegisterByte(RegisterType::L, 0xC0);
    CheckRegisterWord(RegisterType::PC, 0xC624);
    CheckRegisterWord(RegisterType::SP, 0x6984);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6982, 0x10);
    CheckMemory(0x6983, 0xAF);
    CheckMemory(0xC623, 0xD1);
}

void test_D1_0295()
{
    if (skip_test_D1_0295)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD37C);
    WriteRegisterWord(RegisterType::SP, 0xFD8F);
    WriteRegisterByte(RegisterType::A, 0xFC);
    WriteRegisterByte(RegisterType::B, 0x9C);
    WriteRegisterByte(RegisterType::C, 0x70);
    WriteRegisterByte(RegisterType::D, 0x57);
    WriteRegisterByte(RegisterType::E, 0xBA);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0xAF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFD90, 0xBC);
    WriteMemory(0xFD8F, 0xE2);
    WriteMemory(0xD37C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFC);
    CheckRegisterByte(RegisterType::B, 0x9C);
    CheckRegisterByte(RegisterType::C, 0x70);
    CheckRegisterByte(RegisterType::D, 0xBC);
    CheckRegisterByte(RegisterType::E, 0xE2);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0xAF);
    CheckRegisterWord(RegisterType::PC, 0xD37D);
    CheckRegisterWord(RegisterType::SP, 0xFD91);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD37C, 0xD1);
    CheckMemory(0xFD8F, 0xE2);
    CheckMemory(0xFD90, 0xBC);
}

void test_D1_0296()
{
    if (skip_test_D1_0296)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5FB8);
    WriteRegisterWord(RegisterType::SP, 0xD6D6);
    WriteRegisterByte(RegisterType::A, 0x42);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0x06);
    WriteRegisterByte(RegisterType::D, 0xF6);
    WriteRegisterByte(RegisterType::E, 0xC2);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xCA);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD6D7, 0xF5);
    WriteMemory(0xD6D6, 0x73);
    WriteMemory(0x5FB8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x42);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0x06);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x73);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xCA);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0x5FB9);
    CheckRegisterWord(RegisterType::SP, 0xD6D8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5FB8, 0xD1);
    CheckMemory(0xD6D6, 0x73);
    CheckMemory(0xD6D7, 0xF5);
}

void test_D1_0297()
{
    if (skip_test_D1_0297)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7BDE);
    WriteRegisterWord(RegisterType::SP, 0xB7F7);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x52);
    WriteRegisterByte(RegisterType::C, 0xAF);
    WriteRegisterByte(RegisterType::D, 0xCA);
    WriteRegisterByte(RegisterType::E, 0xDD);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xF9);
    WriteRegisterByte(RegisterType::L, 0x71);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB7F8, 0xA0);
    WriteMemory(0xB7F7, 0x96);
    WriteMemory(0x7BDE, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x52);
    CheckRegisterByte(RegisterType::C, 0xAF);
    CheckRegisterByte(RegisterType::D, 0xA0);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xF9);
    CheckRegisterByte(RegisterType::L, 0x71);
    CheckRegisterWord(RegisterType::PC, 0x7BDF);
    CheckRegisterWord(RegisterType::SP, 0xB7F9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7BDE, 0xD1);
    CheckMemory(0xB7F7, 0x96);
    CheckMemory(0xB7F8, 0xA0);
}

void test_D1_0298()
{
    if (skip_test_D1_0298)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8D34);
    WriteRegisterWord(RegisterType::SP, 0x376B);
    WriteRegisterByte(RegisterType::A, 0x4E);
    WriteRegisterByte(RegisterType::B, 0x7C);
    WriteRegisterByte(RegisterType::C, 0x9E);
    WriteRegisterByte(RegisterType::D, 0xC0);
    WriteRegisterByte(RegisterType::E, 0xC3);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x65);
    WriteRegisterByte(RegisterType::L, 0x9F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8D34, 0xD1);
    WriteMemory(0x376C, 0xD0);
    WriteMemory(0x376B, 0xA8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4E);
    CheckRegisterByte(RegisterType::B, 0x7C);
    CheckRegisterByte(RegisterType::C, 0x9E);
    CheckRegisterByte(RegisterType::D, 0xD0);
    CheckRegisterByte(RegisterType::E, 0xA8);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x65);
    CheckRegisterByte(RegisterType::L, 0x9F);
    CheckRegisterWord(RegisterType::PC, 0x8D35);
    CheckRegisterWord(RegisterType::SP, 0x376D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x376B, 0xA8);
    CheckMemory(0x376C, 0xD0);
    CheckMemory(0x8D34, 0xD1);
}

void test_D1_0299()
{
    if (skip_test_D1_0299)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB2D2);
    WriteRegisterWord(RegisterType::SP, 0x1830);
    WriteRegisterByte(RegisterType::A, 0x97);
    WriteRegisterByte(RegisterType::B, 0xE7);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0xF6);
    WriteRegisterByte(RegisterType::E, 0x17);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x5D);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB2D2, 0xD1);
    WriteMemory(0x1831, 0x52);
    WriteMemory(0x1830, 0xAD);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x97);
    CheckRegisterByte(RegisterType::B, 0xE7);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0x52);
    CheckRegisterByte(RegisterType::E, 0xAD);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x5D);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0xB2D3);
    CheckRegisterWord(RegisterType::SP, 0x1832);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1830, 0xAD);
    CheckMemory(0x1831, 0x52);
    CheckMemory(0xB2D2, 0xD1);
}

void test_D1_029A()
{
    if (skip_test_D1_029A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2931);
    WriteRegisterWord(RegisterType::SP, 0x7BBD);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0x4D);
    WriteRegisterByte(RegisterType::D, 0x88);
    WriteRegisterByte(RegisterType::E, 0xAB);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xA0);
    WriteRegisterByte(RegisterType::L, 0xE7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7BBE, 0x50);
    WriteMemory(0x7BBD, 0x96);
    WriteMemory(0x2931, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0x4D);
    CheckRegisterByte(RegisterType::D, 0x50);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xA0);
    CheckRegisterByte(RegisterType::L, 0xE7);
    CheckRegisterWord(RegisterType::PC, 0x2932);
    CheckRegisterWord(RegisterType::SP, 0x7BBF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2931, 0xD1);
    CheckMemory(0x7BBD, 0x96);
    CheckMemory(0x7BBE, 0x50);
}

void test_D1_029B()
{
    if (skip_test_D1_029B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xED9D);
    WriteRegisterWord(RegisterType::SP, 0x155E);
    WriteRegisterByte(RegisterType::A, 0x6A);
    WriteRegisterByte(RegisterType::B, 0xFF);
    WriteRegisterByte(RegisterType::C, 0x14);
    WriteRegisterByte(RegisterType::D, 0x0F);
    WriteRegisterByte(RegisterType::E, 0xD6);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xEF);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xED9D, 0xD1);
    WriteMemory(0x155F, 0x39);
    WriteMemory(0x155E, 0x0C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6A);
    CheckRegisterByte(RegisterType::B, 0xFF);
    CheckRegisterByte(RegisterType::C, 0x14);
    CheckRegisterByte(RegisterType::D, 0x39);
    CheckRegisterByte(RegisterType::E, 0x0C);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xEF);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0xED9E);
    CheckRegisterWord(RegisterType::SP, 0x1560);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x155E, 0x0C);
    CheckMemory(0x155F, 0x39);
    CheckMemory(0xED9D, 0xD1);
}

void test_D1_029C()
{
    if (skip_test_D1_029C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x864D);
    WriteRegisterWord(RegisterType::SP, 0x4930);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0x4F);
    WriteRegisterByte(RegisterType::C, 0x93);
    WriteRegisterByte(RegisterType::D, 0xC7);
    WriteRegisterByte(RegisterType::E, 0x57);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x33);
    WriteRegisterByte(RegisterType::L, 0x70);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x864D, 0xD1);
    WriteMemory(0x4931, 0xFB);
    WriteMemory(0x4930, 0x90);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0x4F);
    CheckRegisterByte(RegisterType::C, 0x93);
    CheckRegisterByte(RegisterType::D, 0xFB);
    CheckRegisterByte(RegisterType::E, 0x90);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x33);
    CheckRegisterByte(RegisterType::L, 0x70);
    CheckRegisterWord(RegisterType::PC, 0x864E);
    CheckRegisterWord(RegisterType::SP, 0x4932);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4930, 0x90);
    CheckMemory(0x4931, 0xFB);
    CheckMemory(0x864D, 0xD1);
}

void test_D1_029D()
{
    if (skip_test_D1_029D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5922);
    WriteRegisterWord(RegisterType::SP, 0x791E);
    WriteRegisterByte(RegisterType::A, 0xEE);
    WriteRegisterByte(RegisterType::B, 0xED);
    WriteRegisterByte(RegisterType::C, 0xFF);
    WriteRegisterByte(RegisterType::D, 0x0E);
    WriteRegisterByte(RegisterType::E, 0xC2);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x0D);
    WriteRegisterByte(RegisterType::L, 0x07);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x791F, 0xB2);
    WriteMemory(0x791E, 0xE6);
    WriteMemory(0x5922, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEE);
    CheckRegisterByte(RegisterType::B, 0xED);
    CheckRegisterByte(RegisterType::C, 0xFF);
    CheckRegisterByte(RegisterType::D, 0xB2);
    CheckRegisterByte(RegisterType::E, 0xE6);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x0D);
    CheckRegisterByte(RegisterType::L, 0x07);
    CheckRegisterWord(RegisterType::PC, 0x5923);
    CheckRegisterWord(RegisterType::SP, 0x7920);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5922, 0xD1);
    CheckMemory(0x791E, 0xE6);
    CheckMemory(0x791F, 0xB2);
}

void test_D1_029E()
{
    if (skip_test_D1_029E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5083);
    WriteRegisterWord(RegisterType::SP, 0xB0CA);
    WriteRegisterByte(RegisterType::A, 0xBA);
    WriteRegisterByte(RegisterType::B, 0x36);
    WriteRegisterByte(RegisterType::C, 0x8F);
    WriteRegisterByte(RegisterType::D, 0x1C);
    WriteRegisterByte(RegisterType::E, 0x19);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x50);
    WriteRegisterByte(RegisterType::L, 0x9D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB0CB, 0x38);
    WriteMemory(0xB0CA, 0xD0);
    WriteMemory(0x5083, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBA);
    CheckRegisterByte(RegisterType::B, 0x36);
    CheckRegisterByte(RegisterType::C, 0x8F);
    CheckRegisterByte(RegisterType::D, 0x38);
    CheckRegisterByte(RegisterType::E, 0xD0);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x50);
    CheckRegisterByte(RegisterType::L, 0x9D);
    CheckRegisterWord(RegisterType::PC, 0x5084);
    CheckRegisterWord(RegisterType::SP, 0xB0CC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5083, 0xD1);
    CheckMemory(0xB0CA, 0xD0);
    CheckMemory(0xB0CB, 0x38);
}

void test_D1_029F()
{
    if (skip_test_D1_029F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBEEF);
    WriteRegisterWord(RegisterType::SP, 0x6433);
    WriteRegisterByte(RegisterType::A, 0x20);
    WriteRegisterByte(RegisterType::B, 0xF1);
    WriteRegisterByte(RegisterType::C, 0xA8);
    WriteRegisterByte(RegisterType::D, 0x94);
    WriteRegisterByte(RegisterType::E, 0xFF);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x5E);
    WriteRegisterByte(RegisterType::L, 0x1C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBEEF, 0xD1);
    WriteMemory(0x6434, 0xF4);
    WriteMemory(0x6433, 0xAD);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x20);
    CheckRegisterByte(RegisterType::B, 0xF1);
    CheckRegisterByte(RegisterType::C, 0xA8);
    CheckRegisterByte(RegisterType::D, 0xF4);
    CheckRegisterByte(RegisterType::E, 0xAD);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x5E);
    CheckRegisterByte(RegisterType::L, 0x1C);
    CheckRegisterWord(RegisterType::PC, 0xBEF0);
    CheckRegisterWord(RegisterType::SP, 0x6435);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6433, 0xAD);
    CheckMemory(0x6434, 0xF4);
    CheckMemory(0xBEEF, 0xD1);
}

void test_D1_02A0()
{
    if (skip_test_D1_02A0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xADAF);
    WriteRegisterWord(RegisterType::SP, 0x4B98);
    WriteRegisterByte(RegisterType::A, 0xFE);
    WriteRegisterByte(RegisterType::B, 0x3E);
    WriteRegisterByte(RegisterType::C, 0x9E);
    WriteRegisterByte(RegisterType::D, 0x4D);
    WriteRegisterByte(RegisterType::E, 0x56);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xF5);
    WriteRegisterByte(RegisterType::L, 0x6D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xADAF, 0xD1);
    WriteMemory(0x4B99, 0xC6);
    WriteMemory(0x4B98, 0x92);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFE);
    CheckRegisterByte(RegisterType::B, 0x3E);
    CheckRegisterByte(RegisterType::C, 0x9E);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0x92);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xF5);
    CheckRegisterByte(RegisterType::L, 0x6D);
    CheckRegisterWord(RegisterType::PC, 0xADB0);
    CheckRegisterWord(RegisterType::SP, 0x4B9A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4B98, 0x92);
    CheckMemory(0x4B99, 0xC6);
    CheckMemory(0xADAF, 0xD1);
}

void test_D1_02A1()
{
    if (skip_test_D1_02A1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA8A3);
    WriteRegisterWord(RegisterType::SP, 0x23F1);
    WriteRegisterByte(RegisterType::A, 0xAD);
    WriteRegisterByte(RegisterType::B, 0x78);
    WriteRegisterByte(RegisterType::C, 0xA8);
    WriteRegisterByte(RegisterType::D, 0x7F);
    WriteRegisterByte(RegisterType::E, 0xF1);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x5A);
    WriteRegisterByte(RegisterType::L, 0x9F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA8A3, 0xD1);
    WriteMemory(0x23F2, 0x08);
    WriteMemory(0x23F1, 0x32);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAD);
    CheckRegisterByte(RegisterType::B, 0x78);
    CheckRegisterByte(RegisterType::C, 0xA8);
    CheckRegisterByte(RegisterType::D, 0x08);
    CheckRegisterByte(RegisterType::E, 0x32);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x5A);
    CheckRegisterByte(RegisterType::L, 0x9F);
    CheckRegisterWord(RegisterType::PC, 0xA8A4);
    CheckRegisterWord(RegisterType::SP, 0x23F3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x23F1, 0x32);
    CheckMemory(0x23F2, 0x08);
    CheckMemory(0xA8A3, 0xD1);
}

void test_D1_02A2()
{
    if (skip_test_D1_02A2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9BE7);
    WriteRegisterWord(RegisterType::SP, 0xA291);
    WriteRegisterByte(RegisterType::A, 0xEA);
    WriteRegisterByte(RegisterType::B, 0xF1);
    WriteRegisterByte(RegisterType::C, 0x8D);
    WriteRegisterByte(RegisterType::D, 0xCC);
    WriteRegisterByte(RegisterType::E, 0x4A);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x71);
    WriteRegisterByte(RegisterType::L, 0xDC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA292, 0x3A);
    WriteMemory(0xA291, 0x0D);
    WriteMemory(0x9BE7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEA);
    CheckRegisterByte(RegisterType::B, 0xF1);
    CheckRegisterByte(RegisterType::C, 0x8D);
    CheckRegisterByte(RegisterType::D, 0x3A);
    CheckRegisterByte(RegisterType::E, 0x0D);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x71);
    CheckRegisterByte(RegisterType::L, 0xDC);
    CheckRegisterWord(RegisterType::PC, 0x9BE8);
    CheckRegisterWord(RegisterType::SP, 0xA293);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9BE7, 0xD1);
    CheckMemory(0xA291, 0x0D);
    CheckMemory(0xA292, 0x3A);
}

void test_D1_02A3()
{
    if (skip_test_D1_02A3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAFCF);
    WriteRegisterWord(RegisterType::SP, 0x8694);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0xE8);
    WriteRegisterByte(RegisterType::C, 0xF3);
    WriteRegisterByte(RegisterType::D, 0xE0);
    WriteRegisterByte(RegisterType::E, 0xCF);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x8C);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAFCF, 0xD1);
    WriteMemory(0x8695, 0x51);
    WriteMemory(0x8694, 0x0D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0xE8);
    CheckRegisterByte(RegisterType::C, 0xF3);
    CheckRegisterByte(RegisterType::D, 0x51);
    CheckRegisterByte(RegisterType::E, 0x0D);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x8C);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0xAFD0);
    CheckRegisterWord(RegisterType::SP, 0x8696);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8694, 0x0D);
    CheckMemory(0x8695, 0x51);
    CheckMemory(0xAFCF, 0xD1);
}

void test_D1_02A4()
{
    if (skip_test_D1_02A4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x88FC);
    WriteRegisterWord(RegisterType::SP, 0x2513);
    WriteRegisterByte(RegisterType::A, 0x6F);
    WriteRegisterByte(RegisterType::B, 0xA5);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0xCB);
    WriteRegisterByte(RegisterType::E, 0xC9);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x2D);
    WriteRegisterByte(RegisterType::L, 0x94);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x88FC, 0xD1);
    WriteMemory(0x2514, 0x37);
    WriteMemory(0x2513, 0x7D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6F);
    CheckRegisterByte(RegisterType::B, 0xA5);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0x37);
    CheckRegisterByte(RegisterType::E, 0x7D);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x2D);
    CheckRegisterByte(RegisterType::L, 0x94);
    CheckRegisterWord(RegisterType::PC, 0x88FD);
    CheckRegisterWord(RegisterType::SP, 0x2515);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2513, 0x7D);
    CheckMemory(0x2514, 0x37);
    CheckMemory(0x88FC, 0xD1);
}

void test_D1_02A5()
{
    if (skip_test_D1_02A5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x70B0);
    WriteRegisterWord(RegisterType::SP, 0xECAC);
    WriteRegisterByte(RegisterType::A, 0x79);
    WriteRegisterByte(RegisterType::B, 0xAE);
    WriteRegisterByte(RegisterType::C, 0x4E);
    WriteRegisterByte(RegisterType::D, 0x02);
    WriteRegisterByte(RegisterType::E, 0x55);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xEC);
    WriteRegisterByte(RegisterType::L, 0x29);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xECAD, 0x2B);
    WriteMemory(0xECAC, 0x82);
    WriteMemory(0x70B0, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x79);
    CheckRegisterByte(RegisterType::B, 0xAE);
    CheckRegisterByte(RegisterType::C, 0x4E);
    CheckRegisterByte(RegisterType::D, 0x2B);
    CheckRegisterByte(RegisterType::E, 0x82);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xEC);
    CheckRegisterByte(RegisterType::L, 0x29);
    CheckRegisterWord(RegisterType::PC, 0x70B1);
    CheckRegisterWord(RegisterType::SP, 0xECAE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x70B0, 0xD1);
    CheckMemory(0xECAC, 0x82);
    CheckMemory(0xECAD, 0x2B);
}

void test_D1_02A6()
{
    if (skip_test_D1_02A6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA80D);
    WriteRegisterWord(RegisterType::SP, 0x2875);
    WriteRegisterByte(RegisterType::A, 0x70);
    WriteRegisterByte(RegisterType::B, 0x45);
    WriteRegisterByte(RegisterType::C, 0xA4);
    WriteRegisterByte(RegisterType::D, 0xE4);
    WriteRegisterByte(RegisterType::E, 0xC8);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xA9);
    WriteRegisterByte(RegisterType::L, 0xF4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA80D, 0xD1);
    WriteMemory(0x2876, 0x24);
    WriteMemory(0x2875, 0xD9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x70);
    CheckRegisterByte(RegisterType::B, 0x45);
    CheckRegisterByte(RegisterType::C, 0xA4);
    CheckRegisterByte(RegisterType::D, 0x24);
    CheckRegisterByte(RegisterType::E, 0xD9);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xA9);
    CheckRegisterByte(RegisterType::L, 0xF4);
    CheckRegisterWord(RegisterType::PC, 0xA80E);
    CheckRegisterWord(RegisterType::SP, 0x2877);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2875, 0xD9);
    CheckMemory(0x2876, 0x24);
    CheckMemory(0xA80D, 0xD1);
}

void test_D1_02A7()
{
    if (skip_test_D1_02A7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF408);
    WriteRegisterWord(RegisterType::SP, 0xF787);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0x92);
    WriteRegisterByte(RegisterType::C, 0x42);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0x40);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xFF);
    WriteRegisterByte(RegisterType::L, 0x82);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF788, 0x57);
    WriteMemory(0xF787, 0x04);
    WriteMemory(0xF408, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0x92);
    CheckRegisterByte(RegisterType::C, 0x42);
    CheckRegisterByte(RegisterType::D, 0x57);
    CheckRegisterByte(RegisterType::E, 0x04);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xFF);
    CheckRegisterByte(RegisterType::L, 0x82);
    CheckRegisterWord(RegisterType::PC, 0xF409);
    CheckRegisterWord(RegisterType::SP, 0xF789);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF408, 0xD1);
    CheckMemory(0xF787, 0x04);
    CheckMemory(0xF788, 0x57);
}

void test_D1_02A8()
{
    if (skip_test_D1_02A8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3446);
    WriteRegisterWord(RegisterType::SP, 0x5D35);
    WriteRegisterByte(RegisterType::A, 0x70);
    WriteRegisterByte(RegisterType::B, 0x6B);
    WriteRegisterByte(RegisterType::C, 0x76);
    WriteRegisterByte(RegisterType::D, 0x2B);
    WriteRegisterByte(RegisterType::E, 0x6F);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xE0);
    WriteRegisterByte(RegisterType::L, 0xB9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5D36, 0xF7);
    WriteMemory(0x5D35, 0x20);
    WriteMemory(0x3446, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x70);
    CheckRegisterByte(RegisterType::B, 0x6B);
    CheckRegisterByte(RegisterType::C, 0x76);
    CheckRegisterByte(RegisterType::D, 0xF7);
    CheckRegisterByte(RegisterType::E, 0x20);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xE0);
    CheckRegisterByte(RegisterType::L, 0xB9);
    CheckRegisterWord(RegisterType::PC, 0x3447);
    CheckRegisterWord(RegisterType::SP, 0x5D37);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3446, 0xD1);
    CheckMemory(0x5D35, 0x20);
    CheckMemory(0x5D36, 0xF7);
}

void test_D1_02A9()
{
    if (skip_test_D1_02A9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCBCF);
    WriteRegisterWord(RegisterType::SP, 0x6DE4);
    WriteRegisterByte(RegisterType::A, 0x2E);
    WriteRegisterByte(RegisterType::B, 0xF8);
    WriteRegisterByte(RegisterType::C, 0x44);
    WriteRegisterByte(RegisterType::D, 0x05);
    WriteRegisterByte(RegisterType::E, 0x5C);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0x8F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCBCF, 0xD1);
    WriteMemory(0x6DE5, 0x42);
    WriteMemory(0x6DE4, 0x6C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2E);
    CheckRegisterByte(RegisterType::B, 0xF8);
    CheckRegisterByte(RegisterType::C, 0x44);
    CheckRegisterByte(RegisterType::D, 0x42);
    CheckRegisterByte(RegisterType::E, 0x6C);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0x8F);
    CheckRegisterWord(RegisterType::PC, 0xCBD0);
    CheckRegisterWord(RegisterType::SP, 0x6DE6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6DE4, 0x6C);
    CheckMemory(0x6DE5, 0x42);
    CheckMemory(0xCBCF, 0xD1);
}

void test_D1_02AA()
{
    if (skip_test_D1_02AA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFCBA);
    WriteRegisterWord(RegisterType::SP, 0x9D73);
    WriteRegisterByte(RegisterType::A, 0x46);
    WriteRegisterByte(RegisterType::B, 0x43);
    WriteRegisterByte(RegisterType::C, 0xAA);
    WriteRegisterByte(RegisterType::D, 0x14);
    WriteRegisterByte(RegisterType::E, 0x2C);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x13);
    WriteRegisterByte(RegisterType::L, 0x91);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFCBA, 0xD1);
    WriteMemory(0x9D74, 0xE5);
    WriteMemory(0x9D73, 0x2F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x46);
    CheckRegisterByte(RegisterType::B, 0x43);
    CheckRegisterByte(RegisterType::C, 0xAA);
    CheckRegisterByte(RegisterType::D, 0xE5);
    CheckRegisterByte(RegisterType::E, 0x2F);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x13);
    CheckRegisterByte(RegisterType::L, 0x91);
    CheckRegisterWord(RegisterType::PC, 0xFCBB);
    CheckRegisterWord(RegisterType::SP, 0x9D75);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9D73, 0x2F);
    CheckMemory(0x9D74, 0xE5);
    CheckMemory(0xFCBA, 0xD1);
}

void test_D1_02AB()
{
    if (skip_test_D1_02AB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8D02);
    WriteRegisterWord(RegisterType::SP, 0x36F0);
    WriteRegisterByte(RegisterType::A, 0x42);
    WriteRegisterByte(RegisterType::B, 0x78);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0x58);
    WriteRegisterByte(RegisterType::E, 0xD8);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x00);
    WriteRegisterByte(RegisterType::L, 0x6F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8D02, 0xD1);
    WriteMemory(0x36F1, 0xC6);
    WriteMemory(0x36F0, 0xC9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x42);
    CheckRegisterByte(RegisterType::B, 0x78);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0xC9);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x00);
    CheckRegisterByte(RegisterType::L, 0x6F);
    CheckRegisterWord(RegisterType::PC, 0x8D03);
    CheckRegisterWord(RegisterType::SP, 0x36F2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x36F0, 0xC9);
    CheckMemory(0x36F1, 0xC6);
    CheckMemory(0x8D02, 0xD1);
}

void test_D1_02AC()
{
    if (skip_test_D1_02AC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x322E);
    WriteRegisterWord(RegisterType::SP, 0x4471);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0xDA);
    WriteRegisterByte(RegisterType::C, 0xA0);
    WriteRegisterByte(RegisterType::D, 0x86);
    WriteRegisterByte(RegisterType::E, 0x0C);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x01);
    WriteRegisterByte(RegisterType::L, 0x6B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4472, 0xCB);
    WriteMemory(0x4471, 0xA0);
    WriteMemory(0x322E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0xDA);
    CheckRegisterByte(RegisterType::C, 0xA0);
    CheckRegisterByte(RegisterType::D, 0xCB);
    CheckRegisterByte(RegisterType::E, 0xA0);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x01);
    CheckRegisterByte(RegisterType::L, 0x6B);
    CheckRegisterWord(RegisterType::PC, 0x322F);
    CheckRegisterWord(RegisterType::SP, 0x4473);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x322E, 0xD1);
    CheckMemory(0x4471, 0xA0);
    CheckMemory(0x4472, 0xCB);
}

void test_D1_02AD()
{
    if (skip_test_D1_02AD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD46);
    WriteRegisterWord(RegisterType::SP, 0x037A);
    WriteRegisterByte(RegisterType::A, 0x12);
    WriteRegisterByte(RegisterType::B, 0xFD);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0xA4);
    WriteRegisterByte(RegisterType::E, 0x52);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xE5);
    WriteRegisterByte(RegisterType::L, 0x08);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCD46, 0xD1);
    WriteMemory(0x037B, 0x16);
    WriteMemory(0x037A, 0x56);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x12);
    CheckRegisterByte(RegisterType::B, 0xFD);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0x16);
    CheckRegisterByte(RegisterType::E, 0x56);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xE5);
    CheckRegisterByte(RegisterType::L, 0x08);
    CheckRegisterWord(RegisterType::PC, 0xCD47);
    CheckRegisterWord(RegisterType::SP, 0x037C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x037A, 0x56);
    CheckMemory(0x037B, 0x16);
    CheckMemory(0xCD46, 0xD1);
}

void test_D1_02AE()
{
    if (skip_test_D1_02AE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0B04);
    WriteRegisterWord(RegisterType::SP, 0x935D);
    WriteRegisterByte(RegisterType::A, 0xFA);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x30);
    WriteRegisterByte(RegisterType::D, 0x31);
    WriteRegisterByte(RegisterType::E, 0xC9);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x99);
    WriteRegisterByte(RegisterType::L, 0x2E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x935E, 0x6E);
    WriteMemory(0x935D, 0xA7);
    WriteMemory(0x0B04, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFA);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x30);
    CheckRegisterByte(RegisterType::D, 0x6E);
    CheckRegisterByte(RegisterType::E, 0xA7);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x99);
    CheckRegisterByte(RegisterType::L, 0x2E);
    CheckRegisterWord(RegisterType::PC, 0x0B05);
    CheckRegisterWord(RegisterType::SP, 0x935F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0B04, 0xD1);
    CheckMemory(0x935D, 0xA7);
    CheckMemory(0x935E, 0x6E);
}

void test_D1_02AF()
{
    if (skip_test_D1_02AF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0A61);
    WriteRegisterWord(RegisterType::SP, 0x9FF7);
    WriteRegisterByte(RegisterType::A, 0x8C);
    WriteRegisterByte(RegisterType::B, 0xE2);
    WriteRegisterByte(RegisterType::C, 0xEA);
    WriteRegisterByte(RegisterType::D, 0xD0);
    WriteRegisterByte(RegisterType::E, 0x64);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x9A);
    WriteRegisterByte(RegisterType::L, 0xC5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9FF8, 0x09);
    WriteMemory(0x9FF7, 0xDF);
    WriteMemory(0x0A61, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8C);
    CheckRegisterByte(RegisterType::B, 0xE2);
    CheckRegisterByte(RegisterType::C, 0xEA);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0xDF);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x9A);
    CheckRegisterByte(RegisterType::L, 0xC5);
    CheckRegisterWord(RegisterType::PC, 0x0A62);
    CheckRegisterWord(RegisterType::SP, 0x9FF9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0A61, 0xD1);
    CheckMemory(0x9FF7, 0xDF);
    CheckMemory(0x9FF8, 0x09);
}

void test_D1_02B0()
{
    if (skip_test_D1_02B0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF0EC);
    WriteRegisterWord(RegisterType::SP, 0xFCF8);
    WriteRegisterByte(RegisterType::A, 0x43);
    WriteRegisterByte(RegisterType::B, 0xE1);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0x6F);
    WriteRegisterByte(RegisterType::E, 0x19);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0x03);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFCF9, 0x29);
    WriteMemory(0xFCF8, 0x8C);
    WriteMemory(0xF0EC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x43);
    CheckRegisterByte(RegisterType::B, 0xE1);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0x29);
    CheckRegisterByte(RegisterType::E, 0x8C);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0x03);
    CheckRegisterWord(RegisterType::PC, 0xF0ED);
    CheckRegisterWord(RegisterType::SP, 0xFCFA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF0EC, 0xD1);
    CheckMemory(0xFCF8, 0x8C);
    CheckMemory(0xFCF9, 0x29);
}

void test_D1_02B1()
{
    if (skip_test_D1_02B1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8232);
    WriteRegisterWord(RegisterType::SP, 0x3B58);
    WriteRegisterByte(RegisterType::A, 0xF2);
    WriteRegisterByte(RegisterType::B, 0x59);
    WriteRegisterByte(RegisterType::C, 0xDE);
    WriteRegisterByte(RegisterType::D, 0x9B);
    WriteRegisterByte(RegisterType::E, 0x18);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xBA);
    WriteRegisterByte(RegisterType::L, 0x68);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8232, 0xD1);
    WriteMemory(0x3B59, 0xC7);
    WriteMemory(0x3B58, 0x73);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF2);
    CheckRegisterByte(RegisterType::B, 0x59);
    CheckRegisterByte(RegisterType::C, 0xDE);
    CheckRegisterByte(RegisterType::D, 0xC7);
    CheckRegisterByte(RegisterType::E, 0x73);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xBA);
    CheckRegisterByte(RegisterType::L, 0x68);
    CheckRegisterWord(RegisterType::PC, 0x8233);
    CheckRegisterWord(RegisterType::SP, 0x3B5A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3B58, 0x73);
    CheckMemory(0x3B59, 0xC7);
    CheckMemory(0x8232, 0xD1);
}

void test_D1_02B2()
{
    if (skip_test_D1_02B2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x910B);
    WriteRegisterWord(RegisterType::SP, 0x346A);
    WriteRegisterByte(RegisterType::A, 0xBC);
    WriteRegisterByte(RegisterType::B, 0x44);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x54);
    WriteRegisterByte(RegisterType::E, 0xA7);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0xA9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x910B, 0xD1);
    WriteMemory(0x346B, 0x62);
    WriteMemory(0x346A, 0xA8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBC);
    CheckRegisterByte(RegisterType::B, 0x44);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0x62);
    CheckRegisterByte(RegisterType::E, 0xA8);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0xA9);
    CheckRegisterWord(RegisterType::PC, 0x910C);
    CheckRegisterWord(RegisterType::SP, 0x346C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x346A, 0xA8);
    CheckMemory(0x346B, 0x62);
    CheckMemory(0x910B, 0xD1);
}

void test_D1_02B3()
{
    if (skip_test_D1_02B3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x66BC);
    WriteRegisterWord(RegisterType::SP, 0x62AE);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0xD6);
    WriteRegisterByte(RegisterType::D, 0x8B);
    WriteRegisterByte(RegisterType::E, 0xD9);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xF0);
    WriteRegisterByte(RegisterType::L, 0x98);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x66BC, 0xD1);
    WriteMemory(0x62AF, 0xF5);
    WriteMemory(0x62AE, 0x68);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0xD6);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x68);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xF0);
    CheckRegisterByte(RegisterType::L, 0x98);
    CheckRegisterWord(RegisterType::PC, 0x66BD);
    CheckRegisterWord(RegisterType::SP, 0x62B0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x62AE, 0x68);
    CheckMemory(0x62AF, 0xF5);
    CheckMemory(0x66BC, 0xD1);
}

void test_D1_02B4()
{
    if (skip_test_D1_02B4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5500);
    WriteRegisterWord(RegisterType::SP, 0x98CA);
    WriteRegisterByte(RegisterType::A, 0x2B);
    WriteRegisterByte(RegisterType::B, 0x70);
    WriteRegisterByte(RegisterType::C, 0xCC);
    WriteRegisterByte(RegisterType::D, 0x69);
    WriteRegisterByte(RegisterType::E, 0x34);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0x7B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x98CB, 0xB5);
    WriteMemory(0x98CA, 0x45);
    WriteMemory(0x5500, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2B);
    CheckRegisterByte(RegisterType::B, 0x70);
    CheckRegisterByte(RegisterType::C, 0xCC);
    CheckRegisterByte(RegisterType::D, 0xB5);
    CheckRegisterByte(RegisterType::E, 0x45);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0x7B);
    CheckRegisterWord(RegisterType::PC, 0x5501);
    CheckRegisterWord(RegisterType::SP, 0x98CC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5500, 0xD1);
    CheckMemory(0x98CA, 0x45);
    CheckMemory(0x98CB, 0xB5);
}

void test_D1_02B5()
{
    if (skip_test_D1_02B5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8C1F);
    WriteRegisterWord(RegisterType::SP, 0xB9E6);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0xE8);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0xBF);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x09);
    WriteRegisterByte(RegisterType::L, 0x20);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB9E7, 0xB6);
    WriteMemory(0xB9E6, 0x19);
    WriteMemory(0x8C1F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0xE8);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0x19);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x09);
    CheckRegisterByte(RegisterType::L, 0x20);
    CheckRegisterWord(RegisterType::PC, 0x8C20);
    CheckRegisterWord(RegisterType::SP, 0xB9E8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8C1F, 0xD1);
    CheckMemory(0xB9E6, 0x19);
    CheckMemory(0xB9E7, 0xB6);
}

void test_D1_02B6()
{
    if (skip_test_D1_02B6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4DD6);
    WriteRegisterWord(RegisterType::SP, 0xFB86);
    WriteRegisterByte(RegisterType::A, 0xFC);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x70);
    WriteRegisterByte(RegisterType::E, 0x1F);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xF5);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFB87, 0x17);
    WriteMemory(0xFB86, 0xDF);
    WriteMemory(0x4DD6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFC);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0x17);
    CheckRegisterByte(RegisterType::E, 0xDF);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xF5);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0x4DD7);
    CheckRegisterWord(RegisterType::SP, 0xFB88);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4DD6, 0xD1);
    CheckMemory(0xFB86, 0xDF);
    CheckMemory(0xFB87, 0x17);
}

void test_D1_02B7()
{
    if (skip_test_D1_02B7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAE05);
    WriteRegisterWord(RegisterType::SP, 0xFD05);
    WriteRegisterByte(RegisterType::A, 0x02);
    WriteRegisterByte(RegisterType::B, 0x07);
    WriteRegisterByte(RegisterType::C, 0xC5);
    WriteRegisterByte(RegisterType::D, 0x9F);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x2D);
    WriteRegisterByte(RegisterType::L, 0x6B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFD06, 0xEB);
    WriteMemory(0xFD05, 0x25);
    WriteMemory(0xAE05, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x02);
    CheckRegisterByte(RegisterType::B, 0x07);
    CheckRegisterByte(RegisterType::C, 0xC5);
    CheckRegisterByte(RegisterType::D, 0xEB);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x2D);
    CheckRegisterByte(RegisterType::L, 0x6B);
    CheckRegisterWord(RegisterType::PC, 0xAE06);
    CheckRegisterWord(RegisterType::SP, 0xFD07);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAE05, 0xD1);
    CheckMemory(0xFD05, 0x25);
    CheckMemory(0xFD06, 0xEB);
}

void test_D1_02B8()
{
    if (skip_test_D1_02B8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x185C);
    WriteRegisterWord(RegisterType::SP, 0x3977);
    WriteRegisterByte(RegisterType::A, 0xD6);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0x25);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0xFC);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x2A);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x3978, 0x4D);
    WriteMemory(0x3977, 0x6A);
    WriteMemory(0x185C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD6);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0x25);
    CheckRegisterByte(RegisterType::D, 0x4D);
    CheckRegisterByte(RegisterType::E, 0x6A);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x2A);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0x185D);
    CheckRegisterWord(RegisterType::SP, 0x3979);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x185C, 0xD1);
    CheckMemory(0x3977, 0x6A);
    CheckMemory(0x3978, 0x4D);
}

void test_D1_02B9()
{
    if (skip_test_D1_02B9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x46BF);
    WriteRegisterWord(RegisterType::SP, 0x1E7F);
    WriteRegisterByte(RegisterType::A, 0x21);
    WriteRegisterByte(RegisterType::B, 0x93);
    WriteRegisterByte(RegisterType::C, 0x5B);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0x72);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x43);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x46BF, 0xD1);
    WriteMemory(0x1E80, 0x12);
    WriteMemory(0x1E7F, 0x7B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x21);
    CheckRegisterByte(RegisterType::B, 0x93);
    CheckRegisterByte(RegisterType::C, 0x5B);
    CheckRegisterByte(RegisterType::D, 0x12);
    CheckRegisterByte(RegisterType::E, 0x7B);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x43);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0x46C0);
    CheckRegisterWord(RegisterType::SP, 0x1E81);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1E7F, 0x7B);
    CheckMemory(0x1E80, 0x12);
    CheckMemory(0x46BF, 0xD1);
}

void test_D1_02BA()
{
    if (skip_test_D1_02BA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAEE3);
    WriteRegisterWord(RegisterType::SP, 0x0E2D);
    WriteRegisterByte(RegisterType::A, 0x57);
    WriteRegisterByte(RegisterType::B, 0xC1);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0xD2);
    WriteRegisterByte(RegisterType::E, 0x51);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xCC);
    WriteRegisterByte(RegisterType::L, 0x57);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xAEE3, 0xD1);
    WriteMemory(0x0E2E, 0x6A);
    WriteMemory(0x0E2D, 0x49);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x57);
    CheckRegisterByte(RegisterType::B, 0xC1);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0x49);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xCC);
    CheckRegisterByte(RegisterType::L, 0x57);
    CheckRegisterWord(RegisterType::PC, 0xAEE4);
    CheckRegisterWord(RegisterType::SP, 0x0E2F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0E2D, 0x49);
    CheckMemory(0x0E2E, 0x6A);
    CheckMemory(0xAEE3, 0xD1);
}

void test_D1_02BB()
{
    if (skip_test_D1_02BB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x02BA);
    WriteRegisterWord(RegisterType::SP, 0x3CA4);
    WriteRegisterByte(RegisterType::A, 0xDA);
    WriteRegisterByte(RegisterType::B, 0x8E);
    WriteRegisterByte(RegisterType::C, 0x00);
    WriteRegisterByte(RegisterType::D, 0x97);
    WriteRegisterByte(RegisterType::E, 0xBD);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x4E);
    WriteRegisterByte(RegisterType::L, 0x12);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x3CA5, 0x77);
    WriteMemory(0x3CA4, 0x74);
    WriteMemory(0x02BA, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDA);
    CheckRegisterByte(RegisterType::B, 0x8E);
    CheckRegisterByte(RegisterType::C, 0x00);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0x74);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x4E);
    CheckRegisterByte(RegisterType::L, 0x12);
    CheckRegisterWord(RegisterType::PC, 0x02BB);
    CheckRegisterWord(RegisterType::SP, 0x3CA6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x02BA, 0xD1);
    CheckMemory(0x3CA4, 0x74);
    CheckMemory(0x3CA5, 0x77);
}

void test_D1_02BC()
{
    if (skip_test_D1_02BC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x55A6);
    WriteRegisterWord(RegisterType::SP, 0xD4B5);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0x9D);
    WriteRegisterByte(RegisterType::C, 0xEC);
    WriteRegisterByte(RegisterType::D, 0x47);
    WriteRegisterByte(RegisterType::E, 0x43);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xE6);
    WriteRegisterByte(RegisterType::L, 0x83);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD4B6, 0x77);
    WriteMemory(0xD4B5, 0x57);
    WriteMemory(0x55A6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0x9D);
    CheckRegisterByte(RegisterType::C, 0xEC);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0x57);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xE6);
    CheckRegisterByte(RegisterType::L, 0x83);
    CheckRegisterWord(RegisterType::PC, 0x55A7);
    CheckRegisterWord(RegisterType::SP, 0xD4B7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x55A6, 0xD1);
    CheckMemory(0xD4B5, 0x57);
    CheckMemory(0xD4B6, 0x77);
}

void test_D1_02BD()
{
    if (skip_test_D1_02BD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB1DE);
    WriteRegisterWord(RegisterType::SP, 0x06F6);
    WriteRegisterByte(RegisterType::A, 0x5C);
    WriteRegisterByte(RegisterType::B, 0x2C);
    WriteRegisterByte(RegisterType::C, 0x70);
    WriteRegisterByte(RegisterType::D, 0xBD);
    WriteRegisterByte(RegisterType::E, 0x87);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xE9);
    WriteRegisterByte(RegisterType::L, 0x55);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB1DE, 0xD1);
    WriteMemory(0x06F7, 0x54);
    WriteMemory(0x06F6, 0x0F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5C);
    CheckRegisterByte(RegisterType::B, 0x2C);
    CheckRegisterByte(RegisterType::C, 0x70);
    CheckRegisterByte(RegisterType::D, 0x54);
    CheckRegisterByte(RegisterType::E, 0x0F);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xE9);
    CheckRegisterByte(RegisterType::L, 0x55);
    CheckRegisterWord(RegisterType::PC, 0xB1DF);
    CheckRegisterWord(RegisterType::SP, 0x06F8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x06F6, 0x0F);
    CheckMemory(0x06F7, 0x54);
    CheckMemory(0xB1DE, 0xD1);
}

void test_D1_02BE()
{
    if (skip_test_D1_02BE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBFFE);
    WriteRegisterWord(RegisterType::SP, 0x7E6D);
    WriteRegisterByte(RegisterType::A, 0x8A);
    WriteRegisterByte(RegisterType::B, 0xA6);
    WriteRegisterByte(RegisterType::C, 0x82);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0x40);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xE6);
    WriteRegisterByte(RegisterType::L, 0xEA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBFFE, 0xD1);
    WriteMemory(0x7E6E, 0x0A);
    WriteMemory(0x7E6D, 0xBB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8A);
    CheckRegisterByte(RegisterType::B, 0xA6);
    CheckRegisterByte(RegisterType::C, 0x82);
    CheckRegisterByte(RegisterType::D, 0x0A);
    CheckRegisterByte(RegisterType::E, 0xBB);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xE6);
    CheckRegisterByte(RegisterType::L, 0xEA);
    CheckRegisterWord(RegisterType::PC, 0xBFFF);
    CheckRegisterWord(RegisterType::SP, 0x7E6F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7E6D, 0xBB);
    CheckMemory(0x7E6E, 0x0A);
    CheckMemory(0xBFFE, 0xD1);
}

void test_D1_02BF()
{
    if (skip_test_D1_02BF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3888);
    WriteRegisterWord(RegisterType::SP, 0xC661);
    WriteRegisterByte(RegisterType::A, 0x3B);
    WriteRegisterByte(RegisterType::B, 0xB5);
    WriteRegisterByte(RegisterType::C, 0xB9);
    WriteRegisterByte(RegisterType::D, 0x18);
    WriteRegisterByte(RegisterType::E, 0x27);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x72);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC662, 0xB3);
    WriteMemory(0xC661, 0x12);
    WriteMemory(0x3888, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3B);
    CheckRegisterByte(RegisterType::B, 0xB5);
    CheckRegisterByte(RegisterType::C, 0xB9);
    CheckRegisterByte(RegisterType::D, 0xB3);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x72);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0x3889);
    CheckRegisterWord(RegisterType::SP, 0xC663);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3888, 0xD1);
    CheckMemory(0xC661, 0x12);
    CheckMemory(0xC662, 0xB3);
}

void test_D1_02C0()
{
    if (skip_test_D1_02C0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD994);
    WriteRegisterWord(RegisterType::SP, 0xBDD0);
    WriteRegisterByte(RegisterType::A, 0x41);
    WriteRegisterByte(RegisterType::B, 0x23);
    WriteRegisterByte(RegisterType::C, 0x9C);
    WriteRegisterByte(RegisterType::D, 0x95);
    WriteRegisterByte(RegisterType::E, 0xD2);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x98);
    WriteRegisterByte(RegisterType::L, 0x79);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD994, 0xD1);
    WriteMemory(0xBDD1, 0x05);
    WriteMemory(0xBDD0, 0x73);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x41);
    CheckRegisterByte(RegisterType::B, 0x23);
    CheckRegisterByte(RegisterType::C, 0x9C);
    CheckRegisterByte(RegisterType::D, 0x05);
    CheckRegisterByte(RegisterType::E, 0x73);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x98);
    CheckRegisterByte(RegisterType::L, 0x79);
    CheckRegisterWord(RegisterType::PC, 0xD995);
    CheckRegisterWord(RegisterType::SP, 0xBDD2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBDD0, 0x73);
    CheckMemory(0xBDD1, 0x05);
    CheckMemory(0xD994, 0xD1);
}

void test_D1_02C1()
{
    if (skip_test_D1_02C1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC9A6);
    WriteRegisterWord(RegisterType::SP, 0x5336);
    WriteRegisterByte(RegisterType::A, 0x10);
    WriteRegisterByte(RegisterType::B, 0xAA);
    WriteRegisterByte(RegisterType::C, 0x3F);
    WriteRegisterByte(RegisterType::D, 0x9E);
    WriteRegisterByte(RegisterType::E, 0xA0);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xDA);
    WriteRegisterByte(RegisterType::L, 0xC1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC9A6, 0xD1);
    WriteMemory(0x5337, 0x72);
    WriteMemory(0x5336, 0x3F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x10);
    CheckRegisterByte(RegisterType::B, 0xAA);
    CheckRegisterByte(RegisterType::C, 0x3F);
    CheckRegisterByte(RegisterType::D, 0x72);
    CheckRegisterByte(RegisterType::E, 0x3F);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xDA);
    CheckRegisterByte(RegisterType::L, 0xC1);
    CheckRegisterWord(RegisterType::PC, 0xC9A7);
    CheckRegisterWord(RegisterType::SP, 0x5338);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5336, 0x3F);
    CheckMemory(0x5337, 0x72);
    CheckMemory(0xC9A6, 0xD1);
}

void test_D1_02C2()
{
    if (skip_test_D1_02C2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDA20);
    WriteRegisterWord(RegisterType::SP, 0x11F7);
    WriteRegisterByte(RegisterType::A, 0xE0);
    WriteRegisterByte(RegisterType::B, 0x49);
    WriteRegisterByte(RegisterType::C, 0xFC);
    WriteRegisterByte(RegisterType::D, 0xEF);
    WriteRegisterByte(RegisterType::E, 0x55);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xB7);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDA20, 0xD1);
    WriteMemory(0x11F8, 0x23);
    WriteMemory(0x11F7, 0x9C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE0);
    CheckRegisterByte(RegisterType::B, 0x49);
    CheckRegisterByte(RegisterType::C, 0xFC);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0x9C);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xB7);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0xDA21);
    CheckRegisterWord(RegisterType::SP, 0x11F9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x11F7, 0x9C);
    CheckMemory(0x11F8, 0x23);
    CheckMemory(0xDA20, 0xD1);
}

void test_D1_02C3()
{
    if (skip_test_D1_02C3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7A0B);
    WriteRegisterWord(RegisterType::SP, 0x6F1B);
    WriteRegisterByte(RegisterType::A, 0xA4);
    WriteRegisterByte(RegisterType::B, 0x49);
    WriteRegisterByte(RegisterType::C, 0xFB);
    WriteRegisterByte(RegisterType::D, 0xB1);
    WriteRegisterByte(RegisterType::E, 0x6F);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x3B);
    WriteRegisterByte(RegisterType::L, 0x63);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7A0B, 0xD1);
    WriteMemory(0x6F1C, 0x90);
    WriteMemory(0x6F1B, 0xB6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA4);
    CheckRegisterByte(RegisterType::B, 0x49);
    CheckRegisterByte(RegisterType::C, 0xFB);
    CheckRegisterByte(RegisterType::D, 0x90);
    CheckRegisterByte(RegisterType::E, 0xB6);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x3B);
    CheckRegisterByte(RegisterType::L, 0x63);
    CheckRegisterWord(RegisterType::PC, 0x7A0C);
    CheckRegisterWord(RegisterType::SP, 0x6F1D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6F1B, 0xB6);
    CheckMemory(0x6F1C, 0x90);
    CheckMemory(0x7A0B, 0xD1);
}

void test_D1_02C4()
{
    if (skip_test_D1_02C4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB6BE);
    WriteRegisterWord(RegisterType::SP, 0x8DD8);
    WriteRegisterByte(RegisterType::A, 0x30);
    WriteRegisterByte(RegisterType::B, 0xCE);
    WriteRegisterByte(RegisterType::C, 0x5B);
    WriteRegisterByte(RegisterType::D, 0xEC);
    WriteRegisterByte(RegisterType::E, 0x38);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x49);
    WriteRegisterByte(RegisterType::L, 0x69);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB6BE, 0xD1);
    WriteMemory(0x8DD9, 0xE0);
    WriteMemory(0x8DD8, 0x55);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x30);
    CheckRegisterByte(RegisterType::B, 0xCE);
    CheckRegisterByte(RegisterType::C, 0x5B);
    CheckRegisterByte(RegisterType::D, 0xE0);
    CheckRegisterByte(RegisterType::E, 0x55);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x49);
    CheckRegisterByte(RegisterType::L, 0x69);
    CheckRegisterWord(RegisterType::PC, 0xB6BF);
    CheckRegisterWord(RegisterType::SP, 0x8DDA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8DD8, 0x55);
    CheckMemory(0x8DD9, 0xE0);
    CheckMemory(0xB6BE, 0xD1);
}

void test_D1_02C5()
{
    if (skip_test_D1_02C5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA95F);
    WriteRegisterWord(RegisterType::SP, 0x9779);
    WriteRegisterByte(RegisterType::A, 0xE7);
    WriteRegisterByte(RegisterType::B, 0xFE);
    WriteRegisterByte(RegisterType::C, 0x0A);
    WriteRegisterByte(RegisterType::D, 0xDB);
    WriteRegisterByte(RegisterType::E, 0xFB);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xF9);
    WriteRegisterByte(RegisterType::L, 0xFC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA95F, 0xD1);
    WriteMemory(0x977A, 0x24);
    WriteMemory(0x9779, 0xF2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE7);
    CheckRegisterByte(RegisterType::B, 0xFE);
    CheckRegisterByte(RegisterType::C, 0x0A);
    CheckRegisterByte(RegisterType::D, 0x24);
    CheckRegisterByte(RegisterType::E, 0xF2);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xF9);
    CheckRegisterByte(RegisterType::L, 0xFC);
    CheckRegisterWord(RegisterType::PC, 0xA960);
    CheckRegisterWord(RegisterType::SP, 0x977B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9779, 0xF2);
    CheckMemory(0x977A, 0x24);
    CheckMemory(0xA95F, 0xD1);
}

void test_D1_02C6()
{
    if (skip_test_D1_02C6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9E46);
    WriteRegisterWord(RegisterType::SP, 0x0D6C);
    WriteRegisterByte(RegisterType::A, 0x27);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x98);
    WriteRegisterByte(RegisterType::D, 0xEC);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xFC);
    WriteRegisterByte(RegisterType::L, 0x49);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9E46, 0xD1);
    WriteMemory(0x0D6D, 0xE7);
    WriteMemory(0x0D6C, 0xEC);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x27);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x98);
    CheckRegisterByte(RegisterType::D, 0xE7);
    CheckRegisterByte(RegisterType::E, 0xEC);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xFC);
    CheckRegisterByte(RegisterType::L, 0x49);
    CheckRegisterWord(RegisterType::PC, 0x9E47);
    CheckRegisterWord(RegisterType::SP, 0x0D6E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0D6C, 0xEC);
    CheckMemory(0x0D6D, 0xE7);
    CheckMemory(0x9E46, 0xD1);
}

void test_D1_02C7()
{
    if (skip_test_D1_02C7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x843A);
    WriteRegisterWord(RegisterType::SP, 0x3D10);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0x06);
    WriteRegisterByte(RegisterType::C, 0x14);
    WriteRegisterByte(RegisterType::D, 0xC6);
    WriteRegisterByte(RegisterType::E, 0x15);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x3B);
    WriteRegisterByte(RegisterType::L, 0xB0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x843A, 0xD1);
    WriteMemory(0x3D11, 0x0D);
    WriteMemory(0x3D10, 0x37);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0x06);
    CheckRegisterByte(RegisterType::C, 0x14);
    CheckRegisterByte(RegisterType::D, 0x0D);
    CheckRegisterByte(RegisterType::E, 0x37);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x3B);
    CheckRegisterByte(RegisterType::L, 0xB0);
    CheckRegisterWord(RegisterType::PC, 0x843B);
    CheckRegisterWord(RegisterType::SP, 0x3D12);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3D10, 0x37);
    CheckMemory(0x3D11, 0x0D);
    CheckMemory(0x843A, 0xD1);
}

void test_D1_02C8()
{
    if (skip_test_D1_02C8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0F30);
    WriteRegisterWord(RegisterType::SP, 0xD4B2);
    WriteRegisterByte(RegisterType::A, 0x26);
    WriteRegisterByte(RegisterType::B, 0xA9);
    WriteRegisterByte(RegisterType::C, 0xB5);
    WriteRegisterByte(RegisterType::D, 0xA8);
    WriteRegisterByte(RegisterType::E, 0xF7);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x71);
    WriteRegisterByte(RegisterType::L, 0x01);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD4B3, 0x33);
    WriteMemory(0xD4B2, 0xC5);
    WriteMemory(0x0F30, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x26);
    CheckRegisterByte(RegisterType::B, 0xA9);
    CheckRegisterByte(RegisterType::C, 0xB5);
    CheckRegisterByte(RegisterType::D, 0x33);
    CheckRegisterByte(RegisterType::E, 0xC5);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x71);
    CheckRegisterByte(RegisterType::L, 0x01);
    CheckRegisterWord(RegisterType::PC, 0x0F31);
    CheckRegisterWord(RegisterType::SP, 0xD4B4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0F30, 0xD1);
    CheckMemory(0xD4B2, 0xC5);
    CheckMemory(0xD4B3, 0x33);
}

void test_D1_02C9()
{
    if (skip_test_D1_02C9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAD02);
    WriteRegisterWord(RegisterType::SP, 0xB681);
    WriteRegisterByte(RegisterType::A, 0x07);
    WriteRegisterByte(RegisterType::B, 0x83);
    WriteRegisterByte(RegisterType::C, 0x7B);
    WriteRegisterByte(RegisterType::D, 0x8C);
    WriteRegisterByte(RegisterType::E, 0x07);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xDB);
    WriteRegisterByte(RegisterType::L, 0x97);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB682, 0x31);
    WriteMemory(0xB681, 0xC3);
    WriteMemory(0xAD02, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x07);
    CheckRegisterByte(RegisterType::B, 0x83);
    CheckRegisterByte(RegisterType::C, 0x7B);
    CheckRegisterByte(RegisterType::D, 0x31);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xDB);
    CheckRegisterByte(RegisterType::L, 0x97);
    CheckRegisterWord(RegisterType::PC, 0xAD03);
    CheckRegisterWord(RegisterType::SP, 0xB683);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAD02, 0xD1);
    CheckMemory(0xB681, 0xC3);
    CheckMemory(0xB682, 0x31);
}

void test_D1_02CA()
{
    if (skip_test_D1_02CA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x69FE);
    WriteRegisterWord(RegisterType::SP, 0x0B00);
    WriteRegisterByte(RegisterType::A, 0x4C);
    WriteRegisterByte(RegisterType::B, 0x21);
    WriteRegisterByte(RegisterType::C, 0xD6);
    WriteRegisterByte(RegisterType::D, 0x02);
    WriteRegisterByte(RegisterType::E, 0xDB);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x1F);
    WriteRegisterByte(RegisterType::L, 0x10);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x69FE, 0xD1);
    WriteMemory(0x0B01, 0xB5);
    WriteMemory(0x0B00, 0x61);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4C);
    CheckRegisterByte(RegisterType::B, 0x21);
    CheckRegisterByte(RegisterType::C, 0xD6);
    CheckRegisterByte(RegisterType::D, 0xB5);
    CheckRegisterByte(RegisterType::E, 0x61);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x1F);
    CheckRegisterByte(RegisterType::L, 0x10);
    CheckRegisterWord(RegisterType::PC, 0x69FF);
    CheckRegisterWord(RegisterType::SP, 0x0B02);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0B00, 0x61);
    CheckMemory(0x0B01, 0xB5);
    CheckMemory(0x69FE, 0xD1);
}

void test_D1_02CB()
{
    if (skip_test_D1_02CB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5456);
    WriteRegisterWord(RegisterType::SP, 0xDB09);
    WriteRegisterByte(RegisterType::A, 0xE8);
    WriteRegisterByte(RegisterType::B, 0x97);
    WriteRegisterByte(RegisterType::C, 0x00);
    WriteRegisterByte(RegisterType::D, 0x88);
    WriteRegisterByte(RegisterType::E, 0x89);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xCB);
    WriteRegisterByte(RegisterType::L, 0x4C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDB0A, 0x81);
    WriteMemory(0xDB09, 0x04);
    WriteMemory(0x5456, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE8);
    CheckRegisterByte(RegisterType::B, 0x97);
    CheckRegisterByte(RegisterType::C, 0x00);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0x04);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xCB);
    CheckRegisterByte(RegisterType::L, 0x4C);
    CheckRegisterWord(RegisterType::PC, 0x5457);
    CheckRegisterWord(RegisterType::SP, 0xDB0B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5456, 0xD1);
    CheckMemory(0xDB09, 0x04);
    CheckMemory(0xDB0A, 0x81);
}

void test_D1_02CC()
{
    if (skip_test_D1_02CC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1DEE);
    WriteRegisterWord(RegisterType::SP, 0x5679);
    WriteRegisterByte(RegisterType::A, 0xFB);
    WriteRegisterByte(RegisterType::B, 0x3A);
    WriteRegisterByte(RegisterType::C, 0x93);
    WriteRegisterByte(RegisterType::D, 0xD5);
    WriteRegisterByte(RegisterType::E, 0x2A);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x41);
    WriteRegisterByte(RegisterType::L, 0xC6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x567A, 0x3A);
    WriteMemory(0x5679, 0x93);
    WriteMemory(0x1DEE, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFB);
    CheckRegisterByte(RegisterType::B, 0x3A);
    CheckRegisterByte(RegisterType::C, 0x93);
    CheckRegisterByte(RegisterType::D, 0x3A);
    CheckRegisterByte(RegisterType::E, 0x93);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x41);
    CheckRegisterByte(RegisterType::L, 0xC6);
    CheckRegisterWord(RegisterType::PC, 0x1DEF);
    CheckRegisterWord(RegisterType::SP, 0x567B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1DEE, 0xD1);
    CheckMemory(0x5679, 0x93);
    CheckMemory(0x567A, 0x3A);
}

void test_D1_02CD()
{
    if (skip_test_D1_02CD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x515E);
    WriteRegisterWord(RegisterType::SP, 0x04C7);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0x82);
    WriteRegisterByte(RegisterType::D, 0x3B);
    WriteRegisterByte(RegisterType::E, 0x68);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x515E, 0xD1);
    WriteMemory(0x04C8, 0xB1);
    WriteMemory(0x04C7, 0xF0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0x82);
    CheckRegisterByte(RegisterType::D, 0xB1);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0x515F);
    CheckRegisterWord(RegisterType::SP, 0x04C9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x04C7, 0xF0);
    CheckMemory(0x04C8, 0xB1);
    CheckMemory(0x515E, 0xD1);
}

void test_D1_02CE()
{
    if (skip_test_D1_02CE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x56AA);
    WriteRegisterWord(RegisterType::SP, 0xC7F9);
    WriteRegisterByte(RegisterType::A, 0xF8);
    WriteRegisterByte(RegisterType::B, 0x49);
    WriteRegisterByte(RegisterType::C, 0x9D);
    WriteRegisterByte(RegisterType::D, 0x51);
    WriteRegisterByte(RegisterType::E, 0x98);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x16);
    WriteRegisterByte(RegisterType::L, 0x69);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC7FA, 0x02);
    WriteMemory(0xC7F9, 0xBD);
    WriteMemory(0x56AA, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF8);
    CheckRegisterByte(RegisterType::B, 0x49);
    CheckRegisterByte(RegisterType::C, 0x9D);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0xBD);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x16);
    CheckRegisterByte(RegisterType::L, 0x69);
    CheckRegisterWord(RegisterType::PC, 0x56AB);
    CheckRegisterWord(RegisterType::SP, 0xC7FB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x56AA, 0xD1);
    CheckMemory(0xC7F9, 0xBD);
    CheckMemory(0xC7FA, 0x02);
}

void test_D1_02CF()
{
    if (skip_test_D1_02CF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4632);
    WriteRegisterWord(RegisterType::SP, 0xD086);
    WriteRegisterByte(RegisterType::A, 0xF8);
    WriteRegisterByte(RegisterType::B, 0x4A);
    WriteRegisterByte(RegisterType::C, 0xED);
    WriteRegisterByte(RegisterType::D, 0x3A);
    WriteRegisterByte(RegisterType::E, 0xE9);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xC8);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD087, 0xF4);
    WriteMemory(0xD086, 0x4D);
    WriteMemory(0x4632, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF8);
    CheckRegisterByte(RegisterType::B, 0x4A);
    CheckRegisterByte(RegisterType::C, 0xED);
    CheckRegisterByte(RegisterType::D, 0xF4);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xC8);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0x4633);
    CheckRegisterWord(RegisterType::SP, 0xD088);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4632, 0xD1);
    CheckMemory(0xD086, 0x4D);
    CheckMemory(0xD087, 0xF4);
}

void test_D1_02D0()
{
    if (skip_test_D1_02D0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF202);
    WriteRegisterWord(RegisterType::SP, 0x8C67);
    WriteRegisterByte(RegisterType::A, 0xF1);
    WriteRegisterByte(RegisterType::B, 0x7A);
    WriteRegisterByte(RegisterType::C, 0xA5);
    WriteRegisterByte(RegisterType::D, 0xB8);
    WriteRegisterByte(RegisterType::E, 0x0D);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC9);
    WriteRegisterByte(RegisterType::L, 0x4A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF202, 0xD1);
    WriteMemory(0x8C68, 0x4C);
    WriteMemory(0x8C67, 0x5F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF1);
    CheckRegisterByte(RegisterType::B, 0x7A);
    CheckRegisterByte(RegisterType::C, 0xA5);
    CheckRegisterByte(RegisterType::D, 0x4C);
    CheckRegisterByte(RegisterType::E, 0x5F);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC9);
    CheckRegisterByte(RegisterType::L, 0x4A);
    CheckRegisterWord(RegisterType::PC, 0xF203);
    CheckRegisterWord(RegisterType::SP, 0x8C69);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8C67, 0x5F);
    CheckMemory(0x8C68, 0x4C);
    CheckMemory(0xF202, 0xD1);
}

void test_D1_02D1()
{
    if (skip_test_D1_02D1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA2EE);
    WriteRegisterWord(RegisterType::SP, 0x69C1);
    WriteRegisterByte(RegisterType::A, 0xFB);
    WriteRegisterByte(RegisterType::B, 0xF6);
    WriteRegisterByte(RegisterType::C, 0x9C);
    WriteRegisterByte(RegisterType::D, 0x21);
    WriteRegisterByte(RegisterType::E, 0xA1);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x71);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA2EE, 0xD1);
    WriteMemory(0x69C2, 0x4F);
    WriteMemory(0x69C1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFB);
    CheckRegisterByte(RegisterType::B, 0xF6);
    CheckRegisterByte(RegisterType::C, 0x9C);
    CheckRegisterByte(RegisterType::D, 0x4F);
    CheckRegisterByte(RegisterType::E, 0xE0);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x71);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0xA2EF);
    CheckRegisterWord(RegisterType::SP, 0x69C3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x69C1, 0xE0);
    CheckMemory(0x69C2, 0x4F);
    CheckMemory(0xA2EE, 0xD1);
}

void test_D1_02D2()
{
    if (skip_test_D1_02D2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC45D);
    WriteRegisterWord(RegisterType::SP, 0xFE5A);
    WriteRegisterByte(RegisterType::A, 0x7F);
    WriteRegisterByte(RegisterType::B, 0xC4);
    WriteRegisterByte(RegisterType::C, 0xF2);
    WriteRegisterByte(RegisterType::D, 0xC0);
    WriteRegisterByte(RegisterType::E, 0xBC);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xBF);
    WriteRegisterByte(RegisterType::L, 0xD7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFE5B, 0xDE);
    WriteMemory(0xFE5A, 0xFD);
    WriteMemory(0xC45D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7F);
    CheckRegisterByte(RegisterType::B, 0xC4);
    CheckRegisterByte(RegisterType::C, 0xF2);
    CheckRegisterByte(RegisterType::D, 0xDE);
    CheckRegisterByte(RegisterType::E, 0xFD);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xBF);
    CheckRegisterByte(RegisterType::L, 0xD7);
    CheckRegisterWord(RegisterType::PC, 0xC45E);
    CheckRegisterWord(RegisterType::SP, 0xFE5C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC45D, 0xD1);
    CheckMemory(0xFE5A, 0xFD);
    CheckMemory(0xFE5B, 0xDE);
}

void test_D1_02D3()
{
    if (skip_test_D1_02D3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF120);
    WriteRegisterWord(RegisterType::SP, 0xC57B);
    WriteRegisterByte(RegisterType::A, 0x42);
    WriteRegisterByte(RegisterType::B, 0x4E);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0xD9);
    WriteRegisterByte(RegisterType::E, 0xAB);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xDB);
    WriteRegisterByte(RegisterType::L, 0xC9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF120, 0xD1);
    WriteMemory(0xC57C, 0x47);
    WriteMemory(0xC57B, 0x17);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x42);
    CheckRegisterByte(RegisterType::B, 0x4E);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0x47);
    CheckRegisterByte(RegisterType::E, 0x17);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xDB);
    CheckRegisterByte(RegisterType::L, 0xC9);
    CheckRegisterWord(RegisterType::PC, 0xF121);
    CheckRegisterWord(RegisterType::SP, 0xC57D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC57B, 0x17);
    CheckMemory(0xC57C, 0x47);
    CheckMemory(0xF120, 0xD1);
}

void test_D1_02D4()
{
    if (skip_test_D1_02D4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEE0E);
    WriteRegisterWord(RegisterType::SP, 0x4806);
    WriteRegisterByte(RegisterType::A, 0xAD);
    WriteRegisterByte(RegisterType::B, 0xF5);
    WriteRegisterByte(RegisterType::C, 0xB6);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0x3D);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xE4);
    WriteRegisterByte(RegisterType::L, 0xA2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEE0E, 0xD1);
    WriteMemory(0x4807, 0xFD);
    WriteMemory(0x4806, 0xB0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAD);
    CheckRegisterByte(RegisterType::B, 0xF5);
    CheckRegisterByte(RegisterType::C, 0xB6);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xE4);
    CheckRegisterByte(RegisterType::L, 0xA2);
    CheckRegisterWord(RegisterType::PC, 0xEE0F);
    CheckRegisterWord(RegisterType::SP, 0x4808);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4806, 0xB0);
    CheckMemory(0x4807, 0xFD);
    CheckMemory(0xEE0E, 0xD1);
}

void test_D1_02D5()
{
    if (skip_test_D1_02D5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3CA4);
    WriteRegisterWord(RegisterType::SP, 0x91EE);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0x44);
    WriteRegisterByte(RegisterType::C, 0xBB);
    WriteRegisterByte(RegisterType::D, 0xA7);
    WriteRegisterByte(RegisterType::E, 0x6E);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xAC);
    WriteRegisterByte(RegisterType::L, 0x2A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x91EF, 0x36);
    WriteMemory(0x91EE, 0xCA);
    WriteMemory(0x3CA4, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0x44);
    CheckRegisterByte(RegisterType::C, 0xBB);
    CheckRegisterByte(RegisterType::D, 0x36);
    CheckRegisterByte(RegisterType::E, 0xCA);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xAC);
    CheckRegisterByte(RegisterType::L, 0x2A);
    CheckRegisterWord(RegisterType::PC, 0x3CA5);
    CheckRegisterWord(RegisterType::SP, 0x91F0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3CA4, 0xD1);
    CheckMemory(0x91EE, 0xCA);
    CheckMemory(0x91EF, 0x36);
}

void test_D1_02D6()
{
    if (skip_test_D1_02D6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAA18);
    WriteRegisterWord(RegisterType::SP, 0x5A77);
    WriteRegisterByte(RegisterType::A, 0x8F);
    WriteRegisterByte(RegisterType::B, 0x6C);
    WriteRegisterByte(RegisterType::C, 0x6C);
    WriteRegisterByte(RegisterType::D, 0x2A);
    WriteRegisterByte(RegisterType::E, 0x7C);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x6F);
    WriteRegisterByte(RegisterType::L, 0xFF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAA18, 0xD1);
    WriteMemory(0x5A78, 0xEE);
    WriteMemory(0x5A77, 0x8C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8F);
    CheckRegisterByte(RegisterType::B, 0x6C);
    CheckRegisterByte(RegisterType::C, 0x6C);
    CheckRegisterByte(RegisterType::D, 0xEE);
    CheckRegisterByte(RegisterType::E, 0x8C);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x6F);
    CheckRegisterByte(RegisterType::L, 0xFF);
    CheckRegisterWord(RegisterType::PC, 0xAA19);
    CheckRegisterWord(RegisterType::SP, 0x5A79);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5A77, 0x8C);
    CheckMemory(0x5A78, 0xEE);
    CheckMemory(0xAA18, 0xD1);
}

void test_D1_02D7()
{
    if (skip_test_D1_02D7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9ED7);
    WriteRegisterWord(RegisterType::SP, 0x7532);
    WriteRegisterByte(RegisterType::A, 0x8B);
    WriteRegisterByte(RegisterType::B, 0xEA);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0x93);
    WriteRegisterByte(RegisterType::E, 0xBE);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x11);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9ED7, 0xD1);
    WriteMemory(0x7533, 0x0A);
    WriteMemory(0x7532, 0x3B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8B);
    CheckRegisterByte(RegisterType::B, 0xEA);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0x0A);
    CheckRegisterByte(RegisterType::E, 0x3B);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x11);
    CheckRegisterWord(RegisterType::PC, 0x9ED8);
    CheckRegisterWord(RegisterType::SP, 0x7534);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7532, 0x3B);
    CheckMemory(0x7533, 0x0A);
    CheckMemory(0x9ED7, 0xD1);
}

void test_D1_02D8()
{
    if (skip_test_D1_02D8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBE77);
    WriteRegisterWord(RegisterType::SP, 0xB3B8);
    WriteRegisterByte(RegisterType::A, 0x96);
    WriteRegisterByte(RegisterType::B, 0x5B);
    WriteRegisterByte(RegisterType::C, 0xC1);
    WriteRegisterByte(RegisterType::D, 0xF0);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x18);
    WriteRegisterByte(RegisterType::L, 0xCE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBE77, 0xD1);
    WriteMemory(0xB3B9, 0xB6);
    WriteMemory(0xB3B8, 0x2A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x96);
    CheckRegisterByte(RegisterType::B, 0x5B);
    CheckRegisterByte(RegisterType::C, 0xC1);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0x2A);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x18);
    CheckRegisterByte(RegisterType::L, 0xCE);
    CheckRegisterWord(RegisterType::PC, 0xBE78);
    CheckRegisterWord(RegisterType::SP, 0xB3BA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB3B8, 0x2A);
    CheckMemory(0xB3B9, 0xB6);
    CheckMemory(0xBE77, 0xD1);
}

void test_D1_02D9()
{
    if (skip_test_D1_02D9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE954);
    WriteRegisterWord(RegisterType::SP, 0xCAC5);
    WriteRegisterByte(RegisterType::A, 0xFE);
    WriteRegisterByte(RegisterType::B, 0xB2);
    WriteRegisterByte(RegisterType::C, 0x59);
    WriteRegisterByte(RegisterType::D, 0x19);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xD1);
    WriteRegisterByte(RegisterType::L, 0x4B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE954, 0xD1);
    WriteMemory(0xCAC6, 0xD6);
    WriteMemory(0xCAC5, 0x9B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFE);
    CheckRegisterByte(RegisterType::B, 0xB2);
    CheckRegisterByte(RegisterType::C, 0x59);
    CheckRegisterByte(RegisterType::D, 0xD6);
    CheckRegisterByte(RegisterType::E, 0x9B);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xD1);
    CheckRegisterByte(RegisterType::L, 0x4B);
    CheckRegisterWord(RegisterType::PC, 0xE955);
    CheckRegisterWord(RegisterType::SP, 0xCAC7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCAC5, 0x9B);
    CheckMemory(0xCAC6, 0xD6);
    CheckMemory(0xE954, 0xD1);
}

void test_D1_02DA()
{
    if (skip_test_D1_02DA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6A6C);
    WriteRegisterWord(RegisterType::SP, 0x4F9C);
    WriteRegisterByte(RegisterType::A, 0x04);
    WriteRegisterByte(RegisterType::B, 0x10);
    WriteRegisterByte(RegisterType::C, 0x8C);
    WriteRegisterByte(RegisterType::D, 0x5F);
    WriteRegisterByte(RegisterType::E, 0xCA);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x8A);
    WriteRegisterByte(RegisterType::L, 0xAD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6A6C, 0xD1);
    WriteMemory(0x4F9D, 0x16);
    WriteMemory(0x4F9C, 0xBE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x04);
    CheckRegisterByte(RegisterType::B, 0x10);
    CheckRegisterByte(RegisterType::C, 0x8C);
    CheckRegisterByte(RegisterType::D, 0x16);
    CheckRegisterByte(RegisterType::E, 0xBE);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x8A);
    CheckRegisterByte(RegisterType::L, 0xAD);
    CheckRegisterWord(RegisterType::PC, 0x6A6D);
    CheckRegisterWord(RegisterType::SP, 0x4F9E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4F9C, 0xBE);
    CheckMemory(0x4F9D, 0x16);
    CheckMemory(0x6A6C, 0xD1);
}

void test_D1_02DB()
{
    if (skip_test_D1_02DB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBF41);
    WriteRegisterWord(RegisterType::SP, 0xE4A9);
    WriteRegisterByte(RegisterType::A, 0x5A);
    WriteRegisterByte(RegisterType::B, 0x94);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0x5F);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0x1C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE4AA, 0x9B);
    WriteMemory(0xE4A9, 0x9F);
    WriteMemory(0xBF41, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5A);
    CheckRegisterByte(RegisterType::B, 0x94);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0x9B);
    CheckRegisterByte(RegisterType::E, 0x9F);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0x1C);
    CheckRegisterWord(RegisterType::PC, 0xBF42);
    CheckRegisterWord(RegisterType::SP, 0xE4AB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBF41, 0xD1);
    CheckMemory(0xE4A9, 0x9F);
    CheckMemory(0xE4AA, 0x9B);
}

void test_D1_02DC()
{
    if (skip_test_D1_02DC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1C61);
    WriteRegisterWord(RegisterType::SP, 0xEC80);
    WriteRegisterByte(RegisterType::A, 0xF8);
    WriteRegisterByte(RegisterType::B, 0xAB);
    WriteRegisterByte(RegisterType::C, 0x65);
    WriteRegisterByte(RegisterType::D, 0x17);
    WriteRegisterByte(RegisterType::E, 0xEF);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0x35);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEC81, 0x2C);
    WriteMemory(0xEC80, 0xD0);
    WriteMemory(0x1C61, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF8);
    CheckRegisterByte(RegisterType::B, 0xAB);
    CheckRegisterByte(RegisterType::C, 0x65);
    CheckRegisterByte(RegisterType::D, 0x2C);
    CheckRegisterByte(RegisterType::E, 0xD0);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0x35);
    CheckRegisterWord(RegisterType::PC, 0x1C62);
    CheckRegisterWord(RegisterType::SP, 0xEC82);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1C61, 0xD1);
    CheckMemory(0xEC80, 0xD0);
    CheckMemory(0xEC81, 0x2C);
}

void test_D1_02DD()
{
    if (skip_test_D1_02DD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB80A);
    WriteRegisterWord(RegisterType::SP, 0xAEF7);
    WriteRegisterByte(RegisterType::A, 0x88);
    WriteRegisterByte(RegisterType::B, 0x36);
    WriteRegisterByte(RegisterType::C, 0x32);
    WriteRegisterByte(RegisterType::D, 0x01);
    WriteRegisterByte(RegisterType::E, 0x78);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x53);
    WriteRegisterByte(RegisterType::L, 0xF8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB80A, 0xD1);
    WriteMemory(0xAEF8, 0xD3);
    WriteMemory(0xAEF7, 0x42);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x88);
    CheckRegisterByte(RegisterType::B, 0x36);
    CheckRegisterByte(RegisterType::C, 0x32);
    CheckRegisterByte(RegisterType::D, 0xD3);
    CheckRegisterByte(RegisterType::E, 0x42);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x53);
    CheckRegisterByte(RegisterType::L, 0xF8);
    CheckRegisterWord(RegisterType::PC, 0xB80B);
    CheckRegisterWord(RegisterType::SP, 0xAEF9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAEF7, 0x42);
    CheckMemory(0xAEF8, 0xD3);
    CheckMemory(0xB80A, 0xD1);
}

void test_D1_02DE()
{
    if (skip_test_D1_02DE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0FB2);
    WriteRegisterWord(RegisterType::SP, 0x5656);
    WriteRegisterByte(RegisterType::A, 0x9C);
    WriteRegisterByte(RegisterType::B, 0x45);
    WriteRegisterByte(RegisterType::C, 0x2B);
    WriteRegisterByte(RegisterType::D, 0x96);
    WriteRegisterByte(RegisterType::E, 0x06);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5657, 0x15);
    WriteMemory(0x5656, 0xE5);
    WriteMemory(0x0FB2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9C);
    CheckRegisterByte(RegisterType::B, 0x45);
    CheckRegisterByte(RegisterType::C, 0x2B);
    CheckRegisterByte(RegisterType::D, 0x15);
    CheckRegisterByte(RegisterType::E, 0xE5);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0x0FB3);
    CheckRegisterWord(RegisterType::SP, 0x5658);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0FB2, 0xD1);
    CheckMemory(0x5656, 0xE5);
    CheckMemory(0x5657, 0x15);
}

void test_D1_02DF()
{
    if (skip_test_D1_02DF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAD75);
    WriteRegisterWord(RegisterType::SP, 0x9D26);
    WriteRegisterByte(RegisterType::A, 0x83);
    WriteRegisterByte(RegisterType::B, 0x82);
    WriteRegisterByte(RegisterType::C, 0x79);
    WriteRegisterByte(RegisterType::D, 0x89);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xF4);
    WriteRegisterByte(RegisterType::L, 0xE6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAD75, 0xD1);
    WriteMemory(0x9D27, 0x72);
    WriteMemory(0x9D26, 0x03);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x83);
    CheckRegisterByte(RegisterType::B, 0x82);
    CheckRegisterByte(RegisterType::C, 0x79);
    CheckRegisterByte(RegisterType::D, 0x72);
    CheckRegisterByte(RegisterType::E, 0x03);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xF4);
    CheckRegisterByte(RegisterType::L, 0xE6);
    CheckRegisterWord(RegisterType::PC, 0xAD76);
    CheckRegisterWord(RegisterType::SP, 0x9D28);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9D26, 0x03);
    CheckMemory(0x9D27, 0x72);
    CheckMemory(0xAD75, 0xD1);
}

void test_D1_02E0()
{
    if (skip_test_D1_02E0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEAB2);
    WriteRegisterWord(RegisterType::SP, 0x649F);
    WriteRegisterByte(RegisterType::A, 0xE6);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0x68);
    WriteRegisterByte(RegisterType::D, 0x02);
    WriteRegisterByte(RegisterType::E, 0x6B);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x8D);
    WriteRegisterByte(RegisterType::L, 0xF3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEAB2, 0xD1);
    WriteMemory(0x64A0, 0x98);
    WriteMemory(0x649F, 0xE2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE6);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0x68);
    CheckRegisterByte(RegisterType::D, 0x98);
    CheckRegisterByte(RegisterType::E, 0xE2);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x8D);
    CheckRegisterByte(RegisterType::L, 0xF3);
    CheckRegisterWord(RegisterType::PC, 0xEAB3);
    CheckRegisterWord(RegisterType::SP, 0x64A1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x649F, 0xE2);
    CheckMemory(0x64A0, 0x98);
    CheckMemory(0xEAB2, 0xD1);
}

void test_D1_02E1()
{
    if (skip_test_D1_02E1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9887);
    WriteRegisterWord(RegisterType::SP, 0x20A1);
    WriteRegisterByte(RegisterType::A, 0x20);
    WriteRegisterByte(RegisterType::B, 0x04);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0x6B);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x33);
    WriteRegisterByte(RegisterType::L, 0xC8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9887, 0xD1);
    WriteMemory(0x20A2, 0x1A);
    WriteMemory(0x20A1, 0x92);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x20);
    CheckRegisterByte(RegisterType::B, 0x04);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0x1A);
    CheckRegisterByte(RegisterType::E, 0x92);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x33);
    CheckRegisterByte(RegisterType::L, 0xC8);
    CheckRegisterWord(RegisterType::PC, 0x9888);
    CheckRegisterWord(RegisterType::SP, 0x20A3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x20A1, 0x92);
    CheckMemory(0x20A2, 0x1A);
    CheckMemory(0x9887, 0xD1);
}

void test_D1_02E2()
{
    if (skip_test_D1_02E2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD5ED);
    WriteRegisterWord(RegisterType::SP, 0xF406);
    WriteRegisterByte(RegisterType::A, 0x41);
    WriteRegisterByte(RegisterType::B, 0x5D);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0x64);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0x3C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF407, 0x90);
    WriteMemory(0xF406, 0x71);
    WriteMemory(0xD5ED, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x41);
    CheckRegisterByte(RegisterType::B, 0x5D);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0x90);
    CheckRegisterByte(RegisterType::E, 0x71);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0x3C);
    CheckRegisterWord(RegisterType::PC, 0xD5EE);
    CheckRegisterWord(RegisterType::SP, 0xF408);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD5ED, 0xD1);
    CheckMemory(0xF406, 0x71);
    CheckMemory(0xF407, 0x90);
}

void test_D1_02E3()
{
    if (skip_test_D1_02E3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x78EE);
    WriteRegisterWord(RegisterType::SP, 0xBFA7);
    WriteRegisterByte(RegisterType::A, 0x98);
    WriteRegisterByte(RegisterType::B, 0xC4);
    WriteRegisterByte(RegisterType::C, 0x92);
    WriteRegisterByte(RegisterType::D, 0x83);
    WriteRegisterByte(RegisterType::E, 0xCE);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x14);
    WriteRegisterByte(RegisterType::L, 0x53);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBFA8, 0x11);
    WriteMemory(0xBFA7, 0xC3);
    WriteMemory(0x78EE, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x98);
    CheckRegisterByte(RegisterType::B, 0xC4);
    CheckRegisterByte(RegisterType::C, 0x92);
    CheckRegisterByte(RegisterType::D, 0x11);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x14);
    CheckRegisterByte(RegisterType::L, 0x53);
    CheckRegisterWord(RegisterType::PC, 0x78EF);
    CheckRegisterWord(RegisterType::SP, 0xBFA9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x78EE, 0xD1);
    CheckMemory(0xBFA7, 0xC3);
    CheckMemory(0xBFA8, 0x11);
}

void test_D1_02E4()
{
    if (skip_test_D1_02E4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF520);
    WriteRegisterWord(RegisterType::SP, 0x135A);
    WriteRegisterByte(RegisterType::A, 0x2F);
    WriteRegisterByte(RegisterType::B, 0x61);
    WriteRegisterByte(RegisterType::C, 0x9F);
    WriteRegisterByte(RegisterType::D, 0x1F);
    WriteRegisterByte(RegisterType::E, 0xE1);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x61);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF520, 0xD1);
    WriteMemory(0x135B, 0xC0);
    WriteMemory(0x135A, 0x81);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2F);
    CheckRegisterByte(RegisterType::B, 0x61);
    CheckRegisterByte(RegisterType::C, 0x9F);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0x81);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x61);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0xF521);
    CheckRegisterWord(RegisterType::SP, 0x135C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x135A, 0x81);
    CheckMemory(0x135B, 0xC0);
    CheckMemory(0xF520, 0xD1);
}

void test_D1_02E5()
{
    if (skip_test_D1_02E5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA87E);
    WriteRegisterWord(RegisterType::SP, 0x175F);
    WriteRegisterByte(RegisterType::A, 0x5B);
    WriteRegisterByte(RegisterType::B, 0x52);
    WriteRegisterByte(RegisterType::C, 0x98);
    WriteRegisterByte(RegisterType::D, 0xF2);
    WriteRegisterByte(RegisterType::E, 0xDA);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x8A);
    WriteRegisterByte(RegisterType::L, 0x14);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA87E, 0xD1);
    WriteMemory(0x1760, 0x10);
    WriteMemory(0x175F, 0x14);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5B);
    CheckRegisterByte(RegisterType::B, 0x52);
    CheckRegisterByte(RegisterType::C, 0x98);
    CheckRegisterByte(RegisterType::D, 0x10);
    CheckRegisterByte(RegisterType::E, 0x14);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x8A);
    CheckRegisterByte(RegisterType::L, 0x14);
    CheckRegisterWord(RegisterType::PC, 0xA87F);
    CheckRegisterWord(RegisterType::SP, 0x1761);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x175F, 0x14);
    CheckMemory(0x1760, 0x10);
    CheckMemory(0xA87E, 0xD1);
}

void test_D1_02E6()
{
    if (skip_test_D1_02E6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0ABB);
    WriteRegisterWord(RegisterType::SP, 0x0EE8);
    WriteRegisterByte(RegisterType::A, 0x60);
    WriteRegisterByte(RegisterType::B, 0xAE);
    WriteRegisterByte(RegisterType::C, 0x17);
    WriteRegisterByte(RegisterType::D, 0x43);
    WriteRegisterByte(RegisterType::E, 0x19);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0xB0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x0EE9, 0xEF);
    WriteMemory(0x0EE8, 0x1F);
    WriteMemory(0x0ABB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x60);
    CheckRegisterByte(RegisterType::B, 0xAE);
    CheckRegisterByte(RegisterType::C, 0x17);
    CheckRegisterByte(RegisterType::D, 0xEF);
    CheckRegisterByte(RegisterType::E, 0x1F);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0xB0);
    CheckRegisterWord(RegisterType::PC, 0x0ABC);
    CheckRegisterWord(RegisterType::SP, 0x0EEA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0ABB, 0xD1);
    CheckMemory(0x0EE8, 0x1F);
    CheckMemory(0x0EE9, 0xEF);
}

void test_D1_02E7()
{
    if (skip_test_D1_02E7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4582);
    WriteRegisterWord(RegisterType::SP, 0xDC00);
    WriteRegisterByte(RegisterType::A, 0xEA);
    WriteRegisterByte(RegisterType::B, 0x92);
    WriteRegisterByte(RegisterType::C, 0xB4);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0x56);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x53);
    WriteRegisterByte(RegisterType::L, 0x1A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDC01, 0xF0);
    WriteMemory(0xDC00, 0xC6);
    WriteMemory(0x4582, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEA);
    CheckRegisterByte(RegisterType::B, 0x92);
    CheckRegisterByte(RegisterType::C, 0xB4);
    CheckRegisterByte(RegisterType::D, 0xF0);
    CheckRegisterByte(RegisterType::E, 0xC6);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x53);
    CheckRegisterByte(RegisterType::L, 0x1A);
    CheckRegisterWord(RegisterType::PC, 0x4583);
    CheckRegisterWord(RegisterType::SP, 0xDC02);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4582, 0xD1);
    CheckMemory(0xDC00, 0xC6);
    CheckMemory(0xDC01, 0xF0);
}

void test_D1_02E8()
{
    if (skip_test_D1_02E8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0E84);
    WriteRegisterWord(RegisterType::SP, 0xD5AC);
    WriteRegisterByte(RegisterType::A, 0xF8);
    WriteRegisterByte(RegisterType::B, 0xCD);
    WriteRegisterByte(RegisterType::C, 0x11);
    WriteRegisterByte(RegisterType::D, 0xAC);
    WriteRegisterByte(RegisterType::E, 0x26);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x85);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD5AD, 0xF8);
    WriteMemory(0xD5AC, 0xF1);
    WriteMemory(0x0E84, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF8);
    CheckRegisterByte(RegisterType::B, 0xCD);
    CheckRegisterByte(RegisterType::C, 0x11);
    CheckRegisterByte(RegisterType::D, 0xF8);
    CheckRegisterByte(RegisterType::E, 0xF1);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x85);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0x0E85);
    CheckRegisterWord(RegisterType::SP, 0xD5AE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0E84, 0xD1);
    CheckMemory(0xD5AC, 0xF1);
    CheckMemory(0xD5AD, 0xF8);
}

void test_D1_02E9()
{
    if (skip_test_D1_02E9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2B6F);
    WriteRegisterWord(RegisterType::SP, 0x8C94);
    WriteRegisterByte(RegisterType::A, 0xD8);
    WriteRegisterByte(RegisterType::B, 0x18);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0x0C);
    WriteRegisterByte(RegisterType::E, 0xE3);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x3C);
    WriteRegisterByte(RegisterType::L, 0xEB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8C95, 0x1D);
    WriteMemory(0x8C94, 0x99);
    WriteMemory(0x2B6F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD8);
    CheckRegisterByte(RegisterType::B, 0x18);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0x1D);
    CheckRegisterByte(RegisterType::E, 0x99);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x3C);
    CheckRegisterByte(RegisterType::L, 0xEB);
    CheckRegisterWord(RegisterType::PC, 0x2B70);
    CheckRegisterWord(RegisterType::SP, 0x8C96);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2B6F, 0xD1);
    CheckMemory(0x8C94, 0x99);
    CheckMemory(0x8C95, 0x1D);
}

void test_D1_02EA()
{
    if (skip_test_D1_02EA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF213);
    WriteRegisterWord(RegisterType::SP, 0x051E);
    WriteRegisterByte(RegisterType::A, 0x47);
    WriteRegisterByte(RegisterType::B, 0x7A);
    WriteRegisterByte(RegisterType::C, 0x01);
    WriteRegisterByte(RegisterType::D, 0xA8);
    WriteRegisterByte(RegisterType::E, 0xC9);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0x97);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF213, 0xD1);
    WriteMemory(0x051F, 0xA2);
    WriteMemory(0x051E, 0xDE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x47);
    CheckRegisterByte(RegisterType::B, 0x7A);
    CheckRegisterByte(RegisterType::C, 0x01);
    CheckRegisterByte(RegisterType::D, 0xA2);
    CheckRegisterByte(RegisterType::E, 0xDE);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0x97);
    CheckRegisterWord(RegisterType::PC, 0xF214);
    CheckRegisterWord(RegisterType::SP, 0x0520);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x051E, 0xDE);
    CheckMemory(0x051F, 0xA2);
    CheckMemory(0xF213, 0xD1);
}

void test_D1_02EB()
{
    if (skip_test_D1_02EB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x69C1);
    WriteRegisterWord(RegisterType::SP, 0xB68E);
    WriteRegisterByte(RegisterType::A, 0x02);
    WriteRegisterByte(RegisterType::B, 0xE1);
    WriteRegisterByte(RegisterType::C, 0xAB);
    WriteRegisterByte(RegisterType::D, 0xD1);
    WriteRegisterByte(RegisterType::E, 0xFF);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xAB);
    WriteRegisterByte(RegisterType::L, 0x50);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB68F, 0x68);
    WriteMemory(0xB68E, 0xC1);
    WriteMemory(0x69C1, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x02);
    CheckRegisterByte(RegisterType::B, 0xE1);
    CheckRegisterByte(RegisterType::C, 0xAB);
    CheckRegisterByte(RegisterType::D, 0x68);
    CheckRegisterByte(RegisterType::E, 0xC1);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xAB);
    CheckRegisterByte(RegisterType::L, 0x50);
    CheckRegisterWord(RegisterType::PC, 0x69C2);
    CheckRegisterWord(RegisterType::SP, 0xB690);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x69C1, 0xD1);
    CheckMemory(0xB68E, 0xC1);
    CheckMemory(0xB68F, 0x68);
}

void test_D1_02EC()
{
    if (skip_test_D1_02EC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x375B);
    WriteRegisterWord(RegisterType::SP, 0x341B);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0x7B);
    WriteRegisterByte(RegisterType::C, 0x9C);
    WriteRegisterByte(RegisterType::D, 0x39);
    WriteRegisterByte(RegisterType::E, 0x01);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0x4E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x375B, 0xD1);
    WriteMemory(0x341C, 0x6C);
    WriteMemory(0x341B, 0xAC);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0x7B);
    CheckRegisterByte(RegisterType::C, 0x9C);
    CheckRegisterByte(RegisterType::D, 0x6C);
    CheckRegisterByte(RegisterType::E, 0xAC);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0x4E);
    CheckRegisterWord(RegisterType::PC, 0x375C);
    CheckRegisterWord(RegisterType::SP, 0x341D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x341B, 0xAC);
    CheckMemory(0x341C, 0x6C);
    CheckMemory(0x375B, 0xD1);
}

void test_D1_02ED()
{
    if (skip_test_D1_02ED)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6A79);
    WriteRegisterWord(RegisterType::SP, 0xA012);
    WriteRegisterByte(RegisterType::A, 0xE7);
    WriteRegisterByte(RegisterType::B, 0x9F);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0x3D);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xB9);
    WriteRegisterByte(RegisterType::L, 0xAD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA013, 0x4C);
    WriteMemory(0xA012, 0x34);
    WriteMemory(0x6A79, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE7);
    CheckRegisterByte(RegisterType::B, 0x9F);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0x4C);
    CheckRegisterByte(RegisterType::E, 0x34);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xB9);
    CheckRegisterByte(RegisterType::L, 0xAD);
    CheckRegisterWord(RegisterType::PC, 0x6A7A);
    CheckRegisterWord(RegisterType::SP, 0xA014);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6A79, 0xD1);
    CheckMemory(0xA012, 0x34);
    CheckMemory(0xA013, 0x4C);
}

void test_D1_02EE()
{
    if (skip_test_D1_02EE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0AFC);
    WriteRegisterWord(RegisterType::SP, 0x71E9);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0x56);
    WriteRegisterByte(RegisterType::D, 0x70);
    WriteRegisterByte(RegisterType::E, 0x48);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x24);
    WriteRegisterByte(RegisterType::L, 0xA6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x71EA, 0x06);
    WriteMemory(0x71E9, 0x0D);
    WriteMemory(0x0AFC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0x56);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0x0D);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x24);
    CheckRegisterByte(RegisterType::L, 0xA6);
    CheckRegisterWord(RegisterType::PC, 0x0AFD);
    CheckRegisterWord(RegisterType::SP, 0x71EB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0AFC, 0xD1);
    CheckMemory(0x71E9, 0x0D);
    CheckMemory(0x71EA, 0x06);
}

void test_D1_02EF()
{
    if (skip_test_D1_02EF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5D90);
    WriteRegisterWord(RegisterType::SP, 0x0B09);
    WriteRegisterByte(RegisterType::A, 0xB9);
    WriteRegisterByte(RegisterType::B, 0xA9);
    WriteRegisterByte(RegisterType::C, 0x87);
    WriteRegisterByte(RegisterType::D, 0xD8);
    WriteRegisterByte(RegisterType::E, 0x94);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xCE);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5D90, 0xD1);
    WriteMemory(0x0B0A, 0x0F);
    WriteMemory(0x0B09, 0x13);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB9);
    CheckRegisterByte(RegisterType::B, 0xA9);
    CheckRegisterByte(RegisterType::C, 0x87);
    CheckRegisterByte(RegisterType::D, 0x0F);
    CheckRegisterByte(RegisterType::E, 0x13);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xCE);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0x5D91);
    CheckRegisterWord(RegisterType::SP, 0x0B0B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0B09, 0x13);
    CheckMemory(0x0B0A, 0x0F);
    CheckMemory(0x5D90, 0xD1);
}

void test_D1_02F0()
{
    if (skip_test_D1_02F0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7A82);
    WriteRegisterWord(RegisterType::SP, 0xA49D);
    WriteRegisterByte(RegisterType::A, 0xBA);
    WriteRegisterByte(RegisterType::B, 0xA5);
    WriteRegisterByte(RegisterType::C, 0x59);
    WriteRegisterByte(RegisterType::D, 0xE9);
    WriteRegisterByte(RegisterType::E, 0x29);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x88);
    WriteRegisterByte(RegisterType::L, 0x45);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA49E, 0xC0);
    WriteMemory(0xA49D, 0x8F);
    WriteMemory(0x7A82, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBA);
    CheckRegisterByte(RegisterType::B, 0xA5);
    CheckRegisterByte(RegisterType::C, 0x59);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0x8F);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x88);
    CheckRegisterByte(RegisterType::L, 0x45);
    CheckRegisterWord(RegisterType::PC, 0x7A83);
    CheckRegisterWord(RegisterType::SP, 0xA49F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7A82, 0xD1);
    CheckMemory(0xA49D, 0x8F);
    CheckMemory(0xA49E, 0xC0);
}

void test_D1_02F1()
{
    if (skip_test_D1_02F1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x591C);
    WriteRegisterWord(RegisterType::SP, 0x07F6);
    WriteRegisterByte(RegisterType::A, 0xEB);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0x47);
    WriteRegisterByte(RegisterType::D, 0xA2);
    WriteRegisterByte(RegisterType::E, 0xDF);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x6B);
    WriteRegisterByte(RegisterType::L, 0xCE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x591C, 0xD1);
    WriteMemory(0x07F7, 0x99);
    WriteMemory(0x07F6, 0x5F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEB);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0x47);
    CheckRegisterByte(RegisterType::D, 0x99);
    CheckRegisterByte(RegisterType::E, 0x5F);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x6B);
    CheckRegisterByte(RegisterType::L, 0xCE);
    CheckRegisterWord(RegisterType::PC, 0x591D);
    CheckRegisterWord(RegisterType::SP, 0x07F8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x07F6, 0x5F);
    CheckMemory(0x07F7, 0x99);
    CheckMemory(0x591C, 0xD1);
}

void test_D1_02F2()
{
    if (skip_test_D1_02F2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x915D);
    WriteRegisterWord(RegisterType::SP, 0x8A8A);
    WriteRegisterByte(RegisterType::A, 0xB3);
    WriteRegisterByte(RegisterType::B, 0x70);
    WriteRegisterByte(RegisterType::C, 0x31);
    WriteRegisterByte(RegisterType::D, 0x13);
    WriteRegisterByte(RegisterType::E, 0x76);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x97);
    WriteRegisterByte(RegisterType::L, 0x59);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x915D, 0xD1);
    WriteMemory(0x8A8B, 0x1E);
    WriteMemory(0x8A8A, 0x8F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB3);
    CheckRegisterByte(RegisterType::B, 0x70);
    CheckRegisterByte(RegisterType::C, 0x31);
    CheckRegisterByte(RegisterType::D, 0x1E);
    CheckRegisterByte(RegisterType::E, 0x8F);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x97);
    CheckRegisterByte(RegisterType::L, 0x59);
    CheckRegisterWord(RegisterType::PC, 0x915E);
    CheckRegisterWord(RegisterType::SP, 0x8A8C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8A8A, 0x8F);
    CheckMemory(0x8A8B, 0x1E);
    CheckMemory(0x915D, 0xD1);
}

void test_D1_02F3()
{
    if (skip_test_D1_02F3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x99B6);
    WriteRegisterWord(RegisterType::SP, 0xD3E2);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0xE3);
    WriteRegisterByte(RegisterType::C, 0xC8);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xF9);
    WriteRegisterByte(RegisterType::L, 0x91);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD3E3, 0x07);
    WriteMemory(0xD3E2, 0xF4);
    WriteMemory(0x99B6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0xE3);
    CheckRegisterByte(RegisterType::C, 0xC8);
    CheckRegisterByte(RegisterType::D, 0x07);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xF9);
    CheckRegisterByte(RegisterType::L, 0x91);
    CheckRegisterWord(RegisterType::PC, 0x99B7);
    CheckRegisterWord(RegisterType::SP, 0xD3E4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x99B6, 0xD1);
    CheckMemory(0xD3E2, 0xF4);
    CheckMemory(0xD3E3, 0x07);
}

void test_D1_02F4()
{
    if (skip_test_D1_02F4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7907);
    WriteRegisterWord(RegisterType::SP, 0xEB98);
    WriteRegisterByte(RegisterType::A, 0x5D);
    WriteRegisterByte(RegisterType::B, 0xB5);
    WriteRegisterByte(RegisterType::C, 0x85);
    WriteRegisterByte(RegisterType::D, 0x91);
    WriteRegisterByte(RegisterType::E, 0x5A);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0x4C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEB99, 0x72);
    WriteMemory(0xEB98, 0x16);
    WriteMemory(0x7907, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5D);
    CheckRegisterByte(RegisterType::B, 0xB5);
    CheckRegisterByte(RegisterType::C, 0x85);
    CheckRegisterByte(RegisterType::D, 0x72);
    CheckRegisterByte(RegisterType::E, 0x16);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0x4C);
    CheckRegisterWord(RegisterType::PC, 0x7908);
    CheckRegisterWord(RegisterType::SP, 0xEB9A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7907, 0xD1);
    CheckMemory(0xEB98, 0x16);
    CheckMemory(0xEB99, 0x72);
}

void test_D1_02F5()
{
    if (skip_test_D1_02F5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF227);
    WriteRegisterWord(RegisterType::SP, 0x8736);
    WriteRegisterByte(RegisterType::A, 0x0D);
    WriteRegisterByte(RegisterType::B, 0x2A);
    WriteRegisterByte(RegisterType::C, 0x12);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0xD3);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x9C);
    WriteRegisterByte(RegisterType::L, 0x1B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF227, 0xD1);
    WriteMemory(0x8737, 0x0B);
    WriteMemory(0x8736, 0x0E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0D);
    CheckRegisterByte(RegisterType::B, 0x2A);
    CheckRegisterByte(RegisterType::C, 0x12);
    CheckRegisterByte(RegisterType::D, 0x0B);
    CheckRegisterByte(RegisterType::E, 0x0E);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x9C);
    CheckRegisterByte(RegisterType::L, 0x1B);
    CheckRegisterWord(RegisterType::PC, 0xF228);
    CheckRegisterWord(RegisterType::SP, 0x8738);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8736, 0x0E);
    CheckMemory(0x8737, 0x0B);
    CheckMemory(0xF227, 0xD1);
}

void test_D1_02F6()
{
    if (skip_test_D1_02F6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEDB9);
    WriteRegisterWord(RegisterType::SP, 0xD092);
    WriteRegisterByte(RegisterType::A, 0x2E);
    WriteRegisterByte(RegisterType::B, 0x37);
    WriteRegisterByte(RegisterType::C, 0x0B);
    WriteRegisterByte(RegisterType::D, 0xA4);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x98);
    WriteRegisterByte(RegisterType::L, 0x5B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEDB9, 0xD1);
    WriteMemory(0xD093, 0x93);
    WriteMemory(0xD092, 0x8D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2E);
    CheckRegisterByte(RegisterType::B, 0x37);
    CheckRegisterByte(RegisterType::C, 0x0B);
    CheckRegisterByte(RegisterType::D, 0x93);
    CheckRegisterByte(RegisterType::E, 0x8D);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x98);
    CheckRegisterByte(RegisterType::L, 0x5B);
    CheckRegisterWord(RegisterType::PC, 0xEDBA);
    CheckRegisterWord(RegisterType::SP, 0xD094);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD092, 0x8D);
    CheckMemory(0xD093, 0x93);
    CheckMemory(0xEDB9, 0xD1);
}

void test_D1_02F7()
{
    if (skip_test_D1_02F7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x23A5);
    WriteRegisterWord(RegisterType::SP, 0xB281);
    WriteRegisterByte(RegisterType::A, 0xE2);
    WriteRegisterByte(RegisterType::B, 0xBD);
    WriteRegisterByte(RegisterType::C, 0xEF);
    WriteRegisterByte(RegisterType::D, 0x3C);
    WriteRegisterByte(RegisterType::E, 0x8C);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0x7F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB282, 0xAA);
    WriteMemory(0xB281, 0x07);
    WriteMemory(0x23A5, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE2);
    CheckRegisterByte(RegisterType::B, 0xBD);
    CheckRegisterByte(RegisterType::C, 0xEF);
    CheckRegisterByte(RegisterType::D, 0xAA);
    CheckRegisterByte(RegisterType::E, 0x07);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0x7F);
    CheckRegisterWord(RegisterType::PC, 0x23A6);
    CheckRegisterWord(RegisterType::SP, 0xB283);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x23A5, 0xD1);
    CheckMemory(0xB281, 0x07);
    CheckMemory(0xB282, 0xAA);
}

void test_D1_02F8()
{
    if (skip_test_D1_02F8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1ADC);
    WriteRegisterWord(RegisterType::SP, 0xCCC8);
    WriteRegisterByte(RegisterType::A, 0x6C);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0xB0);
    WriteRegisterByte(RegisterType::D, 0x4D);
    WriteRegisterByte(RegisterType::E, 0x2B);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x6A);
    WriteRegisterByte(RegisterType::L, 0x1B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCCC9, 0x02);
    WriteMemory(0xCCC8, 0x75);
    WriteMemory(0x1ADC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6C);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0xB0);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0x75);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x6A);
    CheckRegisterByte(RegisterType::L, 0x1B);
    CheckRegisterWord(RegisterType::PC, 0x1ADD);
    CheckRegisterWord(RegisterType::SP, 0xCCCA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1ADC, 0xD1);
    CheckMemory(0xCCC8, 0x75);
    CheckMemory(0xCCC9, 0x02);
}

void test_D1_02F9()
{
    if (skip_test_D1_02F9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1F96);
    WriteRegisterWord(RegisterType::SP, 0x0F52);
    WriteRegisterByte(RegisterType::A, 0x2D);
    WriteRegisterByte(RegisterType::B, 0xE3);
    WriteRegisterByte(RegisterType::C, 0xA8);
    WriteRegisterByte(RegisterType::D, 0x49);
    WriteRegisterByte(RegisterType::E, 0xF6);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xE5);
    WriteRegisterByte(RegisterType::L, 0x8B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x1F96, 0xD1);
    WriteMemory(0x0F53, 0x6F);
    WriteMemory(0x0F52, 0xF6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2D);
    CheckRegisterByte(RegisterType::B, 0xE3);
    CheckRegisterByte(RegisterType::C, 0xA8);
    CheckRegisterByte(RegisterType::D, 0x6F);
    CheckRegisterByte(RegisterType::E, 0xF6);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xE5);
    CheckRegisterByte(RegisterType::L, 0x8B);
    CheckRegisterWord(RegisterType::PC, 0x1F97);
    CheckRegisterWord(RegisterType::SP, 0x0F54);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0F52, 0xF6);
    CheckMemory(0x0F53, 0x6F);
    CheckMemory(0x1F96, 0xD1);
}

void test_D1_02FA()
{
    if (skip_test_D1_02FA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4B40);
    WriteRegisterWord(RegisterType::SP, 0x9160);
    WriteRegisterByte(RegisterType::A, 0xAB);
    WriteRegisterByte(RegisterType::B, 0x08);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x75);
    WriteRegisterByte(RegisterType::E, 0x78);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x50);
    WriteRegisterByte(RegisterType::L, 0x1A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9161, 0xB9);
    WriteMemory(0x9160, 0x54);
    WriteMemory(0x4B40, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAB);
    CheckRegisterByte(RegisterType::B, 0x08);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0xB9);
    CheckRegisterByte(RegisterType::E, 0x54);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x50);
    CheckRegisterByte(RegisterType::L, 0x1A);
    CheckRegisterWord(RegisterType::PC, 0x4B41);
    CheckRegisterWord(RegisterType::SP, 0x9162);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4B40, 0xD1);
    CheckMemory(0x9160, 0x54);
    CheckMemory(0x9161, 0xB9);
}

void test_D1_02FB()
{
    if (skip_test_D1_02FB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1409);
    WriteRegisterWord(RegisterType::SP, 0xB62A);
    WriteRegisterByte(RegisterType::A, 0xA5);
    WriteRegisterByte(RegisterType::B, 0x8C);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0xB1);
    WriteRegisterByte(RegisterType::E, 0xCC);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xE3);
    WriteRegisterByte(RegisterType::L, 0x95);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB62B, 0x7F);
    WriteMemory(0xB62A, 0x3E);
    WriteMemory(0x1409, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA5);
    CheckRegisterByte(RegisterType::B, 0x8C);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0x7F);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xE3);
    CheckRegisterByte(RegisterType::L, 0x95);
    CheckRegisterWord(RegisterType::PC, 0x140A);
    CheckRegisterWord(RegisterType::SP, 0xB62C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1409, 0xD1);
    CheckMemory(0xB62A, 0x3E);
    CheckMemory(0xB62B, 0x7F);
}

void test_D1_02FC()
{
    if (skip_test_D1_02FC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2E8B);
    WriteRegisterWord(RegisterType::SP, 0x2B79);
    WriteRegisterByte(RegisterType::A, 0xE8);
    WriteRegisterByte(RegisterType::B, 0x26);
    WriteRegisterByte(RegisterType::C, 0x8E);
    WriteRegisterByte(RegisterType::D, 0xDB);
    WriteRegisterByte(RegisterType::E, 0xD7);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0x98);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2E8B, 0xD1);
    WriteMemory(0x2B7A, 0x4F);
    WriteMemory(0x2B79, 0xA6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE8);
    CheckRegisterByte(RegisterType::B, 0x26);
    CheckRegisterByte(RegisterType::C, 0x8E);
    CheckRegisterByte(RegisterType::D, 0x4F);
    CheckRegisterByte(RegisterType::E, 0xA6);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0x98);
    CheckRegisterWord(RegisterType::PC, 0x2E8C);
    CheckRegisterWord(RegisterType::SP, 0x2B7B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2B79, 0xA6);
    CheckMemory(0x2B7A, 0x4F);
    CheckMemory(0x2E8B, 0xD1);
}

void test_D1_02FD()
{
    if (skip_test_D1_02FD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x501E);
    WriteRegisterWord(RegisterType::SP, 0x04E9);
    WriteRegisterByte(RegisterType::A, 0xA6);
    WriteRegisterByte(RegisterType::B, 0x9F);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0x22);
    WriteRegisterByte(RegisterType::E, 0x56);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xDA);
    WriteRegisterByte(RegisterType::L, 0x13);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x501E, 0xD1);
    WriteMemory(0x04EA, 0xFB);
    WriteMemory(0x04E9, 0xBC);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA6);
    CheckRegisterByte(RegisterType::B, 0x9F);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0xFB);
    CheckRegisterByte(RegisterType::E, 0xBC);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xDA);
    CheckRegisterByte(RegisterType::L, 0x13);
    CheckRegisterWord(RegisterType::PC, 0x501F);
    CheckRegisterWord(RegisterType::SP, 0x04EB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x04E9, 0xBC);
    CheckMemory(0x04EA, 0xFB);
    CheckMemory(0x501E, 0xD1);
}

void test_D1_02FE()
{
    if (skip_test_D1_02FE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5290);
    WriteRegisterWord(RegisterType::SP, 0xAD7F);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0x9E);
    WriteRegisterByte(RegisterType::D, 0x53);
    WriteRegisterByte(RegisterType::E, 0x02);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xAD80, 0x1A);
    WriteMemory(0xAD7F, 0xA9);
    WriteMemory(0x5290, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0x9E);
    CheckRegisterByte(RegisterType::D, 0x1A);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0x5291);
    CheckRegisterWord(RegisterType::SP, 0xAD81);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5290, 0xD1);
    CheckMemory(0xAD7F, 0xA9);
    CheckMemory(0xAD80, 0x1A);
}

void test_D1_02FF()
{
    if (skip_test_D1_02FF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1DC9);
    WriteRegisterWord(RegisterType::SP, 0x0360);
    WriteRegisterByte(RegisterType::A, 0x97);
    WriteRegisterByte(RegisterType::B, 0x13);
    WriteRegisterByte(RegisterType::C, 0x74);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x92);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x1DC9, 0xD1);
    WriteMemory(0x0361, 0xAC);
    WriteMemory(0x0360, 0x90);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x97);
    CheckRegisterByte(RegisterType::B, 0x13);
    CheckRegisterByte(RegisterType::C, 0x74);
    CheckRegisterByte(RegisterType::D, 0xAC);
    CheckRegisterByte(RegisterType::E, 0x90);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x92);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0x1DCA);
    CheckRegisterWord(RegisterType::SP, 0x0362);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0360, 0x90);
    CheckMemory(0x0361, 0xAC);
    CheckMemory(0x1DC9, 0xD1);
}

void test_D1_0300()
{
    if (skip_test_D1_0300)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1802);
    WriteRegisterWord(RegisterType::SP, 0x288F);
    WriteRegisterByte(RegisterType::A, 0xF4);
    WriteRegisterByte(RegisterType::B, 0x8F);
    WriteRegisterByte(RegisterType::C, 0x26);
    WriteRegisterByte(RegisterType::D, 0x2F);
    WriteRegisterByte(RegisterType::E, 0x89);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x6D);
    WriteRegisterByte(RegisterType::L, 0xA5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x2890, 0x12);
    WriteMemory(0x288F, 0xB4);
    WriteMemory(0x1802, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF4);
    CheckRegisterByte(RegisterType::B, 0x8F);
    CheckRegisterByte(RegisterType::C, 0x26);
    CheckRegisterByte(RegisterType::D, 0x12);
    CheckRegisterByte(RegisterType::E, 0xB4);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x6D);
    CheckRegisterByte(RegisterType::L, 0xA5);
    CheckRegisterWord(RegisterType::PC, 0x1803);
    CheckRegisterWord(RegisterType::SP, 0x2891);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1802, 0xD1);
    CheckMemory(0x288F, 0xB4);
    CheckMemory(0x2890, 0x12);
}

void test_D1_0301()
{
    if (skip_test_D1_0301)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEA37);
    WriteRegisterWord(RegisterType::SP, 0xD279);
    WriteRegisterByte(RegisterType::A, 0xDB);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0xC3);
    WriteRegisterByte(RegisterType::D, 0x05);
    WriteRegisterByte(RegisterType::E, 0x92);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x6A);
    WriteRegisterByte(RegisterType::L, 0x9D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEA37, 0xD1);
    WriteMemory(0xD27A, 0x48);
    WriteMemory(0xD279, 0x9B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDB);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0xC3);
    CheckRegisterByte(RegisterType::D, 0x48);
    CheckRegisterByte(RegisterType::E, 0x9B);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x6A);
    CheckRegisterByte(RegisterType::L, 0x9D);
    CheckRegisterWord(RegisterType::PC, 0xEA38);
    CheckRegisterWord(RegisterType::SP, 0xD27B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD279, 0x9B);
    CheckMemory(0xD27A, 0x48);
    CheckMemory(0xEA37, 0xD1);
}

void test_D1_0302()
{
    if (skip_test_D1_0302)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2EFC);
    WriteRegisterWord(RegisterType::SP, 0xD6EA);
    WriteRegisterByte(RegisterType::A, 0xFE);
    WriteRegisterByte(RegisterType::B, 0xDF);
    WriteRegisterByte(RegisterType::C, 0x28);
    WriteRegisterByte(RegisterType::D, 0x10);
    WriteRegisterByte(RegisterType::E, 0xE9);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x61);
    WriteRegisterByte(RegisterType::L, 0xEF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD6EB, 0x95);
    WriteMemory(0xD6EA, 0x9E);
    WriteMemory(0x2EFC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFE);
    CheckRegisterByte(RegisterType::B, 0xDF);
    CheckRegisterByte(RegisterType::C, 0x28);
    CheckRegisterByte(RegisterType::D, 0x95);
    CheckRegisterByte(RegisterType::E, 0x9E);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x61);
    CheckRegisterByte(RegisterType::L, 0xEF);
    CheckRegisterWord(RegisterType::PC, 0x2EFD);
    CheckRegisterWord(RegisterType::SP, 0xD6EC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2EFC, 0xD1);
    CheckMemory(0xD6EA, 0x9E);
    CheckMemory(0xD6EB, 0x95);
}

void test_D1_0303()
{
    if (skip_test_D1_0303)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1B97);
    WriteRegisterWord(RegisterType::SP, 0x2CB3);
    WriteRegisterByte(RegisterType::A, 0x07);
    WriteRegisterByte(RegisterType::B, 0x23);
    WriteRegisterByte(RegisterType::C, 0x00);
    WriteRegisterByte(RegisterType::D, 0x29);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xDF);
    WriteRegisterByte(RegisterType::L, 0x4A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2CB4, 0xFF);
    WriteMemory(0x2CB3, 0x26);
    WriteMemory(0x1B97, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x07);
    CheckRegisterByte(RegisterType::B, 0x23);
    CheckRegisterByte(RegisterType::C, 0x00);
    CheckRegisterByte(RegisterType::D, 0xFF);
    CheckRegisterByte(RegisterType::E, 0x26);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xDF);
    CheckRegisterByte(RegisterType::L, 0x4A);
    CheckRegisterWord(RegisterType::PC, 0x1B98);
    CheckRegisterWord(RegisterType::SP, 0x2CB5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1B97, 0xD1);
    CheckMemory(0x2CB3, 0x26);
    CheckMemory(0x2CB4, 0xFF);
}

void test_D1_0304()
{
    if (skip_test_D1_0304)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7449);
    WriteRegisterWord(RegisterType::SP, 0x2B07);
    WriteRegisterByte(RegisterType::A, 0x41);
    WriteRegisterByte(RegisterType::B, 0x51);
    WriteRegisterByte(RegisterType::C, 0x00);
    WriteRegisterByte(RegisterType::D, 0x01);
    WriteRegisterByte(RegisterType::E, 0xB9);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x73);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7449, 0xD1);
    WriteMemory(0x2B08, 0x85);
    WriteMemory(0x2B07, 0x40);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x41);
    CheckRegisterByte(RegisterType::B, 0x51);
    CheckRegisterByte(RegisterType::C, 0x00);
    CheckRegisterByte(RegisterType::D, 0x85);
    CheckRegisterByte(RegisterType::E, 0x40);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x73);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0x744A);
    CheckRegisterWord(RegisterType::SP, 0x2B09);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2B07, 0x40);
    CheckMemory(0x2B08, 0x85);
    CheckMemory(0x7449, 0xD1);
}

void test_D1_0305()
{
    if (skip_test_D1_0305)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4E72);
    WriteRegisterWord(RegisterType::SP, 0xB946);
    WriteRegisterByte(RegisterType::A, 0x99);
    WriteRegisterByte(RegisterType::B, 0x2D);
    WriteRegisterByte(RegisterType::C, 0x76);
    WriteRegisterByte(RegisterType::D, 0xF1);
    WriteRegisterByte(RegisterType::E, 0x3A);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x26);
    WriteRegisterByte(RegisterType::L, 0x67);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB947, 0x8D);
    WriteMemory(0xB946, 0x33);
    WriteMemory(0x4E72, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x99);
    CheckRegisterByte(RegisterType::B, 0x2D);
    CheckRegisterByte(RegisterType::C, 0x76);
    CheckRegisterByte(RegisterType::D, 0x8D);
    CheckRegisterByte(RegisterType::E, 0x33);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x26);
    CheckRegisterByte(RegisterType::L, 0x67);
    CheckRegisterWord(RegisterType::PC, 0x4E73);
    CheckRegisterWord(RegisterType::SP, 0xB948);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4E72, 0xD1);
    CheckMemory(0xB946, 0x33);
    CheckMemory(0xB947, 0x8D);
}

void test_D1_0306()
{
    if (skip_test_D1_0306)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1694);
    WriteRegisterWord(RegisterType::SP, 0x1DA0);
    WriteRegisterByte(RegisterType::A, 0x9F);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0xCE);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x58);
    WriteRegisterByte(RegisterType::L, 0xFF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x1DA1, 0x3B);
    WriteMemory(0x1DA0, 0x64);
    WriteMemory(0x1694, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9F);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0xCE);
    CheckRegisterByte(RegisterType::D, 0x3B);
    CheckRegisterByte(RegisterType::E, 0x64);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x58);
    CheckRegisterByte(RegisterType::L, 0xFF);
    CheckRegisterWord(RegisterType::PC, 0x1695);
    CheckRegisterWord(RegisterType::SP, 0x1DA2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1694, 0xD1);
    CheckMemory(0x1DA0, 0x64);
    CheckMemory(0x1DA1, 0x3B);
}

void test_D1_0307()
{
    if (skip_test_D1_0307)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7411);
    WriteRegisterWord(RegisterType::SP, 0xD0E4);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x1B);
    WriteRegisterByte(RegisterType::C, 0xE8);
    WriteRegisterByte(RegisterType::D, 0x4B);
    WriteRegisterByte(RegisterType::E, 0x31);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xB1);
    WriteRegisterByte(RegisterType::L, 0x8D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD0E5, 0x50);
    WriteMemory(0xD0E4, 0x5A);
    WriteMemory(0x7411, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x1B);
    CheckRegisterByte(RegisterType::C, 0xE8);
    CheckRegisterByte(RegisterType::D, 0x50);
    CheckRegisterByte(RegisterType::E, 0x5A);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xB1);
    CheckRegisterByte(RegisterType::L, 0x8D);
    CheckRegisterWord(RegisterType::PC, 0x7412);
    CheckRegisterWord(RegisterType::SP, 0xD0E6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7411, 0xD1);
    CheckMemory(0xD0E4, 0x5A);
    CheckMemory(0xD0E5, 0x50);
}

void test_D1_0308()
{
    if (skip_test_D1_0308)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xABEF);
    WriteRegisterWord(RegisterType::SP, 0x4B66);
    WriteRegisterByte(RegisterType::A, 0x61);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0xF4);
    WriteRegisterByte(RegisterType::D, 0x52);
    WriteRegisterByte(RegisterType::E, 0x1E);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x8C);
    WriteRegisterByte(RegisterType::L, 0x9B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xABEF, 0xD1);
    WriteMemory(0x4B67, 0x4E);
    WriteMemory(0x4B66, 0x53);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x61);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0xF4);
    CheckRegisterByte(RegisterType::D, 0x4E);
    CheckRegisterByte(RegisterType::E, 0x53);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x8C);
    CheckRegisterByte(RegisterType::L, 0x9B);
    CheckRegisterWord(RegisterType::PC, 0xABF0);
    CheckRegisterWord(RegisterType::SP, 0x4B68);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4B66, 0x53);
    CheckMemory(0x4B67, 0x4E);
    CheckMemory(0xABEF, 0xD1);
}

void test_D1_0309()
{
    if (skip_test_D1_0309)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6E32);
    WriteRegisterWord(RegisterType::SP, 0x45C3);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0x54);
    WriteRegisterByte(RegisterType::C, 0x4F);
    WriteRegisterByte(RegisterType::D, 0xEA);
    WriteRegisterByte(RegisterType::E, 0xBA);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0x57);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6E32, 0xD1);
    WriteMemory(0x45C4, 0x62);
    WriteMemory(0x45C3, 0x19);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0x54);
    CheckRegisterByte(RegisterType::C, 0x4F);
    CheckRegisterByte(RegisterType::D, 0x62);
    CheckRegisterByte(RegisterType::E, 0x19);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0x57);
    CheckRegisterWord(RegisterType::PC, 0x6E33);
    CheckRegisterWord(RegisterType::SP, 0x45C5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x45C3, 0x19);
    CheckMemory(0x45C4, 0x62);
    CheckMemory(0x6E32, 0xD1);
}

void test_D1_030A()
{
    if (skip_test_D1_030A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD0F3);
    WriteRegisterWord(RegisterType::SP, 0xF764);
    WriteRegisterByte(RegisterType::A, 0x0A);
    WriteRegisterByte(RegisterType::B, 0x64);
    WriteRegisterByte(RegisterType::C, 0x13);
    WriteRegisterByte(RegisterType::D, 0x49);
    WriteRegisterByte(RegisterType::E, 0xD2);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xC2);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF765, 0xF5);
    WriteMemory(0xF764, 0x97);
    WriteMemory(0xD0F3, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0A);
    CheckRegisterByte(RegisterType::B, 0x64);
    CheckRegisterByte(RegisterType::C, 0x13);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x97);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xC2);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0xD0F4);
    CheckRegisterWord(RegisterType::SP, 0xF766);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD0F3, 0xD1);
    CheckMemory(0xF764, 0x97);
    CheckMemory(0xF765, 0xF5);
}

void test_D1_030B()
{
    if (skip_test_D1_030B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD9DB);
    WriteRegisterWord(RegisterType::SP, 0xB5C3);
    WriteRegisterByte(RegisterType::A, 0x70);
    WriteRegisterByte(RegisterType::B, 0xF0);
    WriteRegisterByte(RegisterType::C, 0xCF);
    WriteRegisterByte(RegisterType::D, 0x18);
    WriteRegisterByte(RegisterType::E, 0x79);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x1F);
    WriteRegisterByte(RegisterType::L, 0xC6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD9DB, 0xD1);
    WriteMemory(0xB5C4, 0x72);
    WriteMemory(0xB5C3, 0x80);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x70);
    CheckRegisterByte(RegisterType::B, 0xF0);
    CheckRegisterByte(RegisterType::C, 0xCF);
    CheckRegisterByte(RegisterType::D, 0x72);
    CheckRegisterByte(RegisterType::E, 0x80);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x1F);
    CheckRegisterByte(RegisterType::L, 0xC6);
    CheckRegisterWord(RegisterType::PC, 0xD9DC);
    CheckRegisterWord(RegisterType::SP, 0xB5C5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB5C3, 0x80);
    CheckMemory(0xB5C4, 0x72);
    CheckMemory(0xD9DB, 0xD1);
}

void test_D1_030C()
{
    if (skip_test_D1_030C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA3B4);
    WriteRegisterWord(RegisterType::SP, 0xAE05);
    WriteRegisterByte(RegisterType::A, 0x4A);
    WriteRegisterByte(RegisterType::B, 0xE8);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0xE2);
    WriteRegisterByte(RegisterType::E, 0xA8);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xE6);
    WriteRegisterByte(RegisterType::L, 0xAD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xAE06, 0x13);
    WriteMemory(0xAE05, 0xFE);
    WriteMemory(0xA3B4, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4A);
    CheckRegisterByte(RegisterType::B, 0xE8);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0x13);
    CheckRegisterByte(RegisterType::E, 0xFE);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xE6);
    CheckRegisterByte(RegisterType::L, 0xAD);
    CheckRegisterWord(RegisterType::PC, 0xA3B5);
    CheckRegisterWord(RegisterType::SP, 0xAE07);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA3B4, 0xD1);
    CheckMemory(0xAE05, 0xFE);
    CheckMemory(0xAE06, 0x13);
}

void test_D1_030D()
{
    if (skip_test_D1_030D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0CD7);
    WriteRegisterWord(RegisterType::SP, 0x7054);
    WriteRegisterByte(RegisterType::A, 0x4E);
    WriteRegisterByte(RegisterType::B, 0x9A);
    WriteRegisterByte(RegisterType::C, 0xF7);
    WriteRegisterByte(RegisterType::D, 0x73);
    WriteRegisterByte(RegisterType::E, 0x62);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xF8);
    WriteRegisterByte(RegisterType::L, 0xFC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7055, 0xAE);
    WriteMemory(0x7054, 0x84);
    WriteMemory(0x0CD7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4E);
    CheckRegisterByte(RegisterType::B, 0x9A);
    CheckRegisterByte(RegisterType::C, 0xF7);
    CheckRegisterByte(RegisterType::D, 0xAE);
    CheckRegisterByte(RegisterType::E, 0x84);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xF8);
    CheckRegisterByte(RegisterType::L, 0xFC);
    CheckRegisterWord(RegisterType::PC, 0x0CD8);
    CheckRegisterWord(RegisterType::SP, 0x7056);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0CD7, 0xD1);
    CheckMemory(0x7054, 0x84);
    CheckMemory(0x7055, 0xAE);
}

void test_D1_030E()
{
    if (skip_test_D1_030E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4B9C);
    WriteRegisterWord(RegisterType::SP, 0xB50A);
    WriteRegisterByte(RegisterType::A, 0x77);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0x00);
    WriteRegisterByte(RegisterType::E, 0xA3);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x7A);
    WriteRegisterByte(RegisterType::L, 0xE2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB50B, 0xD3);
    WriteMemory(0xB50A, 0x00);
    WriteMemory(0x4B9C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x77);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0xD3);
    CheckRegisterByte(RegisterType::E, 0x00);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x7A);
    CheckRegisterByte(RegisterType::L, 0xE2);
    CheckRegisterWord(RegisterType::PC, 0x4B9D);
    CheckRegisterWord(RegisterType::SP, 0xB50C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4B9C, 0xD1);
    CheckMemory(0xB50A, 0x00);
    CheckMemory(0xB50B, 0xD3);
}

void test_D1_030F()
{
    if (skip_test_D1_030F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD2BC);
    WriteRegisterWord(RegisterType::SP, 0x19C6);
    WriteRegisterByte(RegisterType::A, 0x5F);
    WriteRegisterByte(RegisterType::B, 0xC2);
    WriteRegisterByte(RegisterType::C, 0xF7);
    WriteRegisterByte(RegisterType::D, 0x86);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xB3);
    WriteRegisterByte(RegisterType::L, 0xD0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD2BC, 0xD1);
    WriteMemory(0x19C7, 0x9B);
    WriteMemory(0x19C6, 0xE7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5F);
    CheckRegisterByte(RegisterType::B, 0xC2);
    CheckRegisterByte(RegisterType::C, 0xF7);
    CheckRegisterByte(RegisterType::D, 0x9B);
    CheckRegisterByte(RegisterType::E, 0xE7);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xB3);
    CheckRegisterByte(RegisterType::L, 0xD0);
    CheckRegisterWord(RegisterType::PC, 0xD2BD);
    CheckRegisterWord(RegisterType::SP, 0x19C8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x19C6, 0xE7);
    CheckMemory(0x19C7, 0x9B);
    CheckMemory(0xD2BC, 0xD1);
}

void test_D1_0310()
{
    if (skip_test_D1_0310)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x242E);
    WriteRegisterWord(RegisterType::SP, 0xD5BC);
    WriteRegisterByte(RegisterType::A, 0xFF);
    WriteRegisterByte(RegisterType::B, 0x36);
    WriteRegisterByte(RegisterType::C, 0xF0);
    WriteRegisterByte(RegisterType::D, 0x33);
    WriteRegisterByte(RegisterType::E, 0x65);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x32);
    WriteRegisterByte(RegisterType::L, 0xFD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD5BD, 0x4F);
    WriteMemory(0xD5BC, 0xB5);
    WriteMemory(0x242E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFF);
    CheckRegisterByte(RegisterType::B, 0x36);
    CheckRegisterByte(RegisterType::C, 0xF0);
    CheckRegisterByte(RegisterType::D, 0x4F);
    CheckRegisterByte(RegisterType::E, 0xB5);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x32);
    CheckRegisterByte(RegisterType::L, 0xFD);
    CheckRegisterWord(RegisterType::PC, 0x242F);
    CheckRegisterWord(RegisterType::SP, 0xD5BE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x242E, 0xD1);
    CheckMemory(0xD5BC, 0xB5);
    CheckMemory(0xD5BD, 0x4F);
}

void test_D1_0311()
{
    if (skip_test_D1_0311)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x74E6);
    WriteRegisterWord(RegisterType::SP, 0x4721);
    WriteRegisterByte(RegisterType::A, 0x09);
    WriteRegisterByte(RegisterType::B, 0x90);
    WriteRegisterByte(RegisterType::C, 0x60);
    WriteRegisterByte(RegisterType::D, 0x12);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x57);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x74E6, 0xD1);
    WriteMemory(0x4722, 0x9F);
    WriteMemory(0x4721, 0x5B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x09);
    CheckRegisterByte(RegisterType::B, 0x90);
    CheckRegisterByte(RegisterType::C, 0x60);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0x5B);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x57);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0x74E7);
    CheckRegisterWord(RegisterType::SP, 0x4723);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4721, 0x5B);
    CheckMemory(0x4722, 0x9F);
    CheckMemory(0x74E6, 0xD1);
}

void test_D1_0312()
{
    if (skip_test_D1_0312)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1DEA);
    WriteRegisterWord(RegisterType::SP, 0x2848);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0x0F);
    WriteRegisterByte(RegisterType::C, 0xEB);
    WriteRegisterByte(RegisterType::D, 0xE6);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x38);
    WriteRegisterByte(RegisterType::L, 0xA9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2849, 0x6F);
    WriteMemory(0x2848, 0x98);
    WriteMemory(0x1DEA, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0x0F);
    CheckRegisterByte(RegisterType::C, 0xEB);
    CheckRegisterByte(RegisterType::D, 0x6F);
    CheckRegisterByte(RegisterType::E, 0x98);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x38);
    CheckRegisterByte(RegisterType::L, 0xA9);
    CheckRegisterWord(RegisterType::PC, 0x1DEB);
    CheckRegisterWord(RegisterType::SP, 0x284A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1DEA, 0xD1);
    CheckMemory(0x2848, 0x98);
    CheckMemory(0x2849, 0x6F);
}

void test_D1_0313()
{
    if (skip_test_D1_0313)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x72F1);
    WriteRegisterWord(RegisterType::SP, 0x5424);
    WriteRegisterByte(RegisterType::A, 0xF4);
    WriteRegisterByte(RegisterType::B, 0x90);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0xFB);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x42);
    WriteRegisterByte(RegisterType::L, 0xAF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x72F1, 0xD1);
    WriteMemory(0x5425, 0x78);
    WriteMemory(0x5424, 0xD7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF4);
    CheckRegisterByte(RegisterType::B, 0x90);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0xD7);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x42);
    CheckRegisterByte(RegisterType::L, 0xAF);
    CheckRegisterWord(RegisterType::PC, 0x72F2);
    CheckRegisterWord(RegisterType::SP, 0x5426);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5424, 0xD7);
    CheckMemory(0x5425, 0x78);
    CheckMemory(0x72F1, 0xD1);
}

void test_D1_0314()
{
    if (skip_test_D1_0314)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3E96);
    WriteRegisterWord(RegisterType::SP, 0x2651);
    WriteRegisterByte(RegisterType::A, 0x45);
    WriteRegisterByte(RegisterType::B, 0x34);
    WriteRegisterByte(RegisterType::C, 0x3C);
    WriteRegisterByte(RegisterType::D, 0x11);
    WriteRegisterByte(RegisterType::E, 0xC4);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x28);
    WriteRegisterByte(RegisterType::L, 0x0A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x3E96, 0xD1);
    WriteMemory(0x2652, 0x81);
    WriteMemory(0x2651, 0x08);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x45);
    CheckRegisterByte(RegisterType::B, 0x34);
    CheckRegisterByte(RegisterType::C, 0x3C);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0x08);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x28);
    CheckRegisterByte(RegisterType::L, 0x0A);
    CheckRegisterWord(RegisterType::PC, 0x3E97);
    CheckRegisterWord(RegisterType::SP, 0x2653);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2651, 0x08);
    CheckMemory(0x2652, 0x81);
    CheckMemory(0x3E96, 0xD1);
}

void test_D1_0315()
{
    if (skip_test_D1_0315)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB4CB);
    WriteRegisterWord(RegisterType::SP, 0xA66F);
    WriteRegisterByte(RegisterType::A, 0x65);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0xEB);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x84);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB4CB, 0xD1);
    WriteMemory(0xA670, 0xD0);
    WriteMemory(0xA66F, 0x94);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x65);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0xD0);
    CheckRegisterByte(RegisterType::E, 0x94);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x84);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0xB4CC);
    CheckRegisterWord(RegisterType::SP, 0xA671);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA66F, 0x94);
    CheckMemory(0xA670, 0xD0);
    CheckMemory(0xB4CB, 0xD1);
}

void test_D1_0316()
{
    if (skip_test_D1_0316)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x58F8);
    WriteRegisterWord(RegisterType::SP, 0xAC3E);
    WriteRegisterByte(RegisterType::A, 0xB2);
    WriteRegisterByte(RegisterType::B, 0x06);
    WriteRegisterByte(RegisterType::C, 0x0A);
    WriteRegisterByte(RegisterType::D, 0xC1);
    WriteRegisterByte(RegisterType::E, 0xA9);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0xC7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xAC3F, 0xED);
    WriteMemory(0xAC3E, 0xA4);
    WriteMemory(0x58F8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB2);
    CheckRegisterByte(RegisterType::B, 0x06);
    CheckRegisterByte(RegisterType::C, 0x0A);
    CheckRegisterByte(RegisterType::D, 0xED);
    CheckRegisterByte(RegisterType::E, 0xA4);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0xC7);
    CheckRegisterWord(RegisterType::PC, 0x58F9);
    CheckRegisterWord(RegisterType::SP, 0xAC40);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x58F8, 0xD1);
    CheckMemory(0xAC3E, 0xA4);
    CheckMemory(0xAC3F, 0xED);
}

void test_D1_0317()
{
    if (skip_test_D1_0317)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x93C3);
    WriteRegisterWord(RegisterType::SP, 0xD437);
    WriteRegisterByte(RegisterType::A, 0x7A);
    WriteRegisterByte(RegisterType::B, 0xA0);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0x28);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xF2);
    WriteRegisterByte(RegisterType::L, 0x98);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD438, 0xDB);
    WriteMemory(0xD437, 0x02);
    WriteMemory(0x93C3, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7A);
    CheckRegisterByte(RegisterType::B, 0xA0);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0xDB);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xF2);
    CheckRegisterByte(RegisterType::L, 0x98);
    CheckRegisterWord(RegisterType::PC, 0x93C4);
    CheckRegisterWord(RegisterType::SP, 0xD439);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x93C3, 0xD1);
    CheckMemory(0xD437, 0x02);
    CheckMemory(0xD438, 0xDB);
}

void test_D1_0318()
{
    if (skip_test_D1_0318)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1AA5);
    WriteRegisterWord(RegisterType::SP, 0x0868);
    WriteRegisterByte(RegisterType::A, 0x68);
    WriteRegisterByte(RegisterType::B, 0x29);
    WriteRegisterByte(RegisterType::C, 0x50);
    WriteRegisterByte(RegisterType::D, 0xA2);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xE5);
    WriteRegisterByte(RegisterType::L, 0x15);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x1AA5, 0xD1);
    WriteMemory(0x0869, 0x65);
    WriteMemory(0x0868, 0xB8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x68);
    CheckRegisterByte(RegisterType::B, 0x29);
    CheckRegisterByte(RegisterType::C, 0x50);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0xB8);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xE5);
    CheckRegisterByte(RegisterType::L, 0x15);
    CheckRegisterWord(RegisterType::PC, 0x1AA6);
    CheckRegisterWord(RegisterType::SP, 0x086A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0868, 0xB8);
    CheckMemory(0x0869, 0x65);
    CheckMemory(0x1AA5, 0xD1);
}

void test_D1_0319()
{
    if (skip_test_D1_0319)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4837);
    WriteRegisterWord(RegisterType::SP, 0xE8F9);
    WriteRegisterByte(RegisterType::A, 0xDA);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0x4E);
    WriteRegisterByte(RegisterType::D, 0xBF);
    WriteRegisterByte(RegisterType::E, 0xF6);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x57);
    WriteRegisterByte(RegisterType::L, 0x02);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE8FA, 0xE0);
    WriteMemory(0xE8F9, 0x4B);
    WriteMemory(0x4837, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDA);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0x4E);
    CheckRegisterByte(RegisterType::D, 0xE0);
    CheckRegisterByte(RegisterType::E, 0x4B);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x57);
    CheckRegisterByte(RegisterType::L, 0x02);
    CheckRegisterWord(RegisterType::PC, 0x4838);
    CheckRegisterWord(RegisterType::SP, 0xE8FB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4837, 0xD1);
    CheckMemory(0xE8F9, 0x4B);
    CheckMemory(0xE8FA, 0xE0);
}

void test_D1_031A()
{
    if (skip_test_D1_031A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x807B);
    WriteRegisterWord(RegisterType::SP, 0x4576);
    WriteRegisterByte(RegisterType::A, 0x7F);
    WriteRegisterByte(RegisterType::B, 0xE7);
    WriteRegisterByte(RegisterType::C, 0x52);
    WriteRegisterByte(RegisterType::D, 0xD6);
    WriteRegisterByte(RegisterType::E, 0x87);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x09);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x807B, 0xD1);
    WriteMemory(0x4577, 0xF8);
    WriteMemory(0x4576, 0xFB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7F);
    CheckRegisterByte(RegisterType::B, 0xE7);
    CheckRegisterByte(RegisterType::C, 0x52);
    CheckRegisterByte(RegisterType::D, 0xF8);
    CheckRegisterByte(RegisterType::E, 0xFB);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x09);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0x807C);
    CheckRegisterWord(RegisterType::SP, 0x4578);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4576, 0xFB);
    CheckMemory(0x4577, 0xF8);
    CheckMemory(0x807B, 0xD1);
}

void test_D1_031B()
{
    if (skip_test_D1_031B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2902);
    WriteRegisterWord(RegisterType::SP, 0xDC43);
    WriteRegisterByte(RegisterType::A, 0xC4);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0xD7);
    WriteRegisterByte(RegisterType::D, 0xB3);
    WriteRegisterByte(RegisterType::E, 0xF7);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0xB8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDC44, 0xC2);
    WriteMemory(0xDC43, 0xF8);
    WriteMemory(0x2902, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC4);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0xD7);
    CheckRegisterByte(RegisterType::D, 0xC2);
    CheckRegisterByte(RegisterType::E, 0xF8);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0xB8);
    CheckRegisterWord(RegisterType::PC, 0x2903);
    CheckRegisterWord(RegisterType::SP, 0xDC45);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2902, 0xD1);
    CheckMemory(0xDC43, 0xF8);
    CheckMemory(0xDC44, 0xC2);
}

void test_D1_031C()
{
    if (skip_test_D1_031C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC02A);
    WriteRegisterWord(RegisterType::SP, 0xB03D);
    WriteRegisterByte(RegisterType::A, 0x43);
    WriteRegisterByte(RegisterType::B, 0xB0);
    WriteRegisterByte(RegisterType::C, 0x57);
    WriteRegisterByte(RegisterType::D, 0x23);
    WriteRegisterByte(RegisterType::E, 0x2A);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xB3);
    WriteRegisterByte(RegisterType::L, 0xD7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC02A, 0xD1);
    WriteMemory(0xB03E, 0xED);
    WriteMemory(0xB03D, 0x04);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x43);
    CheckRegisterByte(RegisterType::B, 0xB0);
    CheckRegisterByte(RegisterType::C, 0x57);
    CheckRegisterByte(RegisterType::D, 0xED);
    CheckRegisterByte(RegisterType::E, 0x04);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xB3);
    CheckRegisterByte(RegisterType::L, 0xD7);
    CheckRegisterWord(RegisterType::PC, 0xC02B);
    CheckRegisterWord(RegisterType::SP, 0xB03F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB03D, 0x04);
    CheckMemory(0xB03E, 0xED);
    CheckMemory(0xC02A, 0xD1);
}

void test_D1_031D()
{
    if (skip_test_D1_031D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDBA5);
    WriteRegisterWord(RegisterType::SP, 0x2DBD);
    WriteRegisterByte(RegisterType::A, 0x75);
    WriteRegisterByte(RegisterType::B, 0x94);
    WriteRegisterByte(RegisterType::C, 0xA3);
    WriteRegisterByte(RegisterType::D, 0x1A);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x02);
    WriteRegisterByte(RegisterType::L, 0x01);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDBA5, 0xD1);
    WriteMemory(0x2DBE, 0x67);
    WriteMemory(0x2DBD, 0xE1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x75);
    CheckRegisterByte(RegisterType::B, 0x94);
    CheckRegisterByte(RegisterType::C, 0xA3);
    CheckRegisterByte(RegisterType::D, 0x67);
    CheckRegisterByte(RegisterType::E, 0xE1);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x02);
    CheckRegisterByte(RegisterType::L, 0x01);
    CheckRegisterWord(RegisterType::PC, 0xDBA6);
    CheckRegisterWord(RegisterType::SP, 0x2DBF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2DBD, 0xE1);
    CheckMemory(0x2DBE, 0x67);
    CheckMemory(0xDBA5, 0xD1);
}

void test_D1_031E()
{
    if (skip_test_D1_031E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5B51);
    WriteRegisterWord(RegisterType::SP, 0xED3A);
    WriteRegisterByte(RegisterType::A, 0x83);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0x5C);
    WriteRegisterByte(RegisterType::D, 0x85);
    WriteRegisterByte(RegisterType::E, 0xAF);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x3C);
    WriteRegisterByte(RegisterType::L, 0xB0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xED3B, 0x33);
    WriteMemory(0xED3A, 0x7C);
    WriteMemory(0x5B51, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x83);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0x5C);
    CheckRegisterByte(RegisterType::D, 0x33);
    CheckRegisterByte(RegisterType::E, 0x7C);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x3C);
    CheckRegisterByte(RegisterType::L, 0xB0);
    CheckRegisterWord(RegisterType::PC, 0x5B52);
    CheckRegisterWord(RegisterType::SP, 0xED3C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5B51, 0xD1);
    CheckMemory(0xED3A, 0x7C);
    CheckMemory(0xED3B, 0x33);
}

void test_D1_031F()
{
    if (skip_test_D1_031F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0259);
    WriteRegisterWord(RegisterType::SP, 0x1ADC);
    WriteRegisterByte(RegisterType::A, 0x0D);
    WriteRegisterByte(RegisterType::B, 0x93);
    WriteRegisterByte(RegisterType::C, 0x13);
    WriteRegisterByte(RegisterType::D, 0xBD);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0xD0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x1ADD, 0xA3);
    WriteMemory(0x1ADC, 0xA9);
    WriteMemory(0x0259, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0D);
    CheckRegisterByte(RegisterType::B, 0x93);
    CheckRegisterByte(RegisterType::C, 0x13);
    CheckRegisterByte(RegisterType::D, 0xA3);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0xD0);
    CheckRegisterWord(RegisterType::PC, 0x025A);
    CheckRegisterWord(RegisterType::SP, 0x1ADE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0259, 0xD1);
    CheckMemory(0x1ADC, 0xA9);
    CheckMemory(0x1ADD, 0xA3);
}

void test_D1_0320()
{
    if (skip_test_D1_0320)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA58B);
    WriteRegisterWord(RegisterType::SP, 0xA121);
    WriteRegisterByte(RegisterType::A, 0x86);
    WriteRegisterByte(RegisterType::B, 0x96);
    WriteRegisterByte(RegisterType::C, 0x47);
    WriteRegisterByte(RegisterType::D, 0xCA);
    WriteRegisterByte(RegisterType::E, 0xBB);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x05);
    WriteRegisterByte(RegisterType::L, 0x93);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA58B, 0xD1);
    WriteMemory(0xA122, 0x6F);
    WriteMemory(0xA121, 0xDE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x86);
    CheckRegisterByte(RegisterType::B, 0x96);
    CheckRegisterByte(RegisterType::C, 0x47);
    CheckRegisterByte(RegisterType::D, 0x6F);
    CheckRegisterByte(RegisterType::E, 0xDE);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x05);
    CheckRegisterByte(RegisterType::L, 0x93);
    CheckRegisterWord(RegisterType::PC, 0xA58C);
    CheckRegisterWord(RegisterType::SP, 0xA123);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA121, 0xDE);
    CheckMemory(0xA122, 0x6F);
    CheckMemory(0xA58B, 0xD1);
}

void test_D1_0321()
{
    if (skip_test_D1_0321)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF548);
    WriteRegisterWord(RegisterType::SP, 0xB202);
    WriteRegisterByte(RegisterType::A, 0xFE);
    WriteRegisterByte(RegisterType::B, 0xC4);
    WriteRegisterByte(RegisterType::C, 0xB5);
    WriteRegisterByte(RegisterType::D, 0xB9);
    WriteRegisterByte(RegisterType::E, 0xDF);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xC9);
    WriteRegisterByte(RegisterType::L, 0xCF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF548, 0xD1);
    WriteMemory(0xB203, 0xDD);
    WriteMemory(0xB202, 0x0B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFE);
    CheckRegisterByte(RegisterType::B, 0xC4);
    CheckRegisterByte(RegisterType::C, 0xB5);
    CheckRegisterByte(RegisterType::D, 0xDD);
    CheckRegisterByte(RegisterType::E, 0x0B);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xC9);
    CheckRegisterByte(RegisterType::L, 0xCF);
    CheckRegisterWord(RegisterType::PC, 0xF549);
    CheckRegisterWord(RegisterType::SP, 0xB204);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB202, 0x0B);
    CheckMemory(0xB203, 0xDD);
    CheckMemory(0xF548, 0xD1);
}

void test_D1_0322()
{
    if (skip_test_D1_0322)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD70);
    WriteRegisterWord(RegisterType::SP, 0x07DA);
    WriteRegisterByte(RegisterType::A, 0x42);
    WriteRegisterByte(RegisterType::B, 0xEB);
    WriteRegisterByte(RegisterType::C, 0x2E);
    WriteRegisterByte(RegisterType::D, 0x00);
    WriteRegisterByte(RegisterType::E, 0xD5);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0x78);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCD70, 0xD1);
    WriteMemory(0x07DB, 0x38);
    WriteMemory(0x07DA, 0x23);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x42);
    CheckRegisterByte(RegisterType::B, 0xEB);
    CheckRegisterByte(RegisterType::C, 0x2E);
    CheckRegisterByte(RegisterType::D, 0x38);
    CheckRegisterByte(RegisterType::E, 0x23);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0x78);
    CheckRegisterWord(RegisterType::PC, 0xCD71);
    CheckRegisterWord(RegisterType::SP, 0x07DC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x07DA, 0x23);
    CheckMemory(0x07DB, 0x38);
    CheckMemory(0xCD70, 0xD1);
}

void test_D1_0323()
{
    if (skip_test_D1_0323)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0E23);
    WriteRegisterWord(RegisterType::SP, 0x0A1F);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0x0B);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0x68);
    WriteRegisterByte(RegisterType::E, 0x28);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xE2);
    WriteRegisterByte(RegisterType::L, 0x79);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x0E23, 0xD1);
    WriteMemory(0x0A20, 0xB5);
    WriteMemory(0x0A1F, 0xB6);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0x0B);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0xB5);
    CheckRegisterByte(RegisterType::E, 0xB6);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xE2);
    CheckRegisterByte(RegisterType::L, 0x79);
    CheckRegisterWord(RegisterType::PC, 0x0E24);
    CheckRegisterWord(RegisterType::SP, 0x0A21);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0A1F, 0xB6);
    CheckMemory(0x0A20, 0xB5);
    CheckMemory(0x0E23, 0xD1);
}

void test_D1_0324()
{
    if (skip_test_D1_0324)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x00B0);
    WriteRegisterWord(RegisterType::SP, 0x3BDD);
    WriteRegisterByte(RegisterType::A, 0x81);
    WriteRegisterByte(RegisterType::B, 0xF8);
    WriteRegisterByte(RegisterType::C, 0xCE);
    WriteRegisterByte(RegisterType::D, 0xC9);
    WriteRegisterByte(RegisterType::E, 0xC4);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0xAC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x3BDE, 0xC6);
    WriteMemory(0x3BDD, 0x26);
    WriteMemory(0x00B0, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x81);
    CheckRegisterByte(RegisterType::B, 0xF8);
    CheckRegisterByte(RegisterType::C, 0xCE);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0x26);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0xAC);
    CheckRegisterWord(RegisterType::PC, 0x00B1);
    CheckRegisterWord(RegisterType::SP, 0x3BDF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x00B0, 0xD1);
    CheckMemory(0x3BDD, 0x26);
    CheckMemory(0x3BDE, 0xC6);
}

void test_D1_0325()
{
    if (skip_test_D1_0325)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x66E4);
    WriteRegisterWord(RegisterType::SP, 0x8321);
    WriteRegisterByte(RegisterType::A, 0x63);
    WriteRegisterByte(RegisterType::B, 0x2E);
    WriteRegisterByte(RegisterType::C, 0xD2);
    WriteRegisterByte(RegisterType::D, 0x1C);
    WriteRegisterByte(RegisterType::E, 0xD5);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x4C);
    WriteRegisterByte(RegisterType::L, 0x4B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x8322, 0x75);
    WriteMemory(0x8321, 0x16);
    WriteMemory(0x66E4, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x63);
    CheckRegisterByte(RegisterType::B, 0x2E);
    CheckRegisterByte(RegisterType::C, 0xD2);
    CheckRegisterByte(RegisterType::D, 0x75);
    CheckRegisterByte(RegisterType::E, 0x16);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x4C);
    CheckRegisterByte(RegisterType::L, 0x4B);
    CheckRegisterWord(RegisterType::PC, 0x66E5);
    CheckRegisterWord(RegisterType::SP, 0x8323);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x66E4, 0xD1);
    CheckMemory(0x8321, 0x16);
    CheckMemory(0x8322, 0x75);
}

void test_D1_0326()
{
    if (skip_test_D1_0326)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD8D8);
    WriteRegisterWord(RegisterType::SP, 0x7CA7);
    WriteRegisterByte(RegisterType::A, 0x35);
    WriteRegisterByte(RegisterType::B, 0x28);
    WriteRegisterByte(RegisterType::C, 0x61);
    WriteRegisterByte(RegisterType::D, 0x29);
    WriteRegisterByte(RegisterType::E, 0x4A);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x78);
    WriteRegisterByte(RegisterType::L, 0x55);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD8D8, 0xD1);
    WriteMemory(0x7CA8, 0x2D);
    WriteMemory(0x7CA7, 0xAB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x35);
    CheckRegisterByte(RegisterType::B, 0x28);
    CheckRegisterByte(RegisterType::C, 0x61);
    CheckRegisterByte(RegisterType::D, 0x2D);
    CheckRegisterByte(RegisterType::E, 0xAB);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x78);
    CheckRegisterByte(RegisterType::L, 0x55);
    CheckRegisterWord(RegisterType::PC, 0xD8D9);
    CheckRegisterWord(RegisterType::SP, 0x7CA9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7CA7, 0xAB);
    CheckMemory(0x7CA8, 0x2D);
    CheckMemory(0xD8D8, 0xD1);
}

void test_D1_0327()
{
    if (skip_test_D1_0327)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xABCE);
    WriteRegisterWord(RegisterType::SP, 0x4217);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0xC4);
    WriteRegisterByte(RegisterType::D, 0x48);
    WriteRegisterByte(RegisterType::E, 0x52);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x19);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xABCE, 0xD1);
    WriteMemory(0x4218, 0x5B);
    WriteMemory(0x4217, 0x6A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0xC4);
    CheckRegisterByte(RegisterType::D, 0x5B);
    CheckRegisterByte(RegisterType::E, 0x6A);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x19);
    CheckRegisterWord(RegisterType::PC, 0xABCF);
    CheckRegisterWord(RegisterType::SP, 0x4219);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4217, 0x6A);
    CheckMemory(0x4218, 0x5B);
    CheckMemory(0xABCE, 0xD1);
}

void test_D1_0328()
{
    if (skip_test_D1_0328)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x56FA);
    WriteRegisterWord(RegisterType::SP, 0x3FBD);
    WriteRegisterByte(RegisterType::A, 0xB4);
    WriteRegisterByte(RegisterType::B, 0x52);
    WriteRegisterByte(RegisterType::C, 0x49);
    WriteRegisterByte(RegisterType::D, 0xA4);
    WriteRegisterByte(RegisterType::E, 0x24);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xCB);
    WriteRegisterByte(RegisterType::L, 0xA1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x56FA, 0xD1);
    WriteMemory(0x3FBE, 0x22);
    WriteMemory(0x3FBD, 0x24);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB4);
    CheckRegisterByte(RegisterType::B, 0x52);
    CheckRegisterByte(RegisterType::C, 0x49);
    CheckRegisterByte(RegisterType::D, 0x22);
    CheckRegisterByte(RegisterType::E, 0x24);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xCB);
    CheckRegisterByte(RegisterType::L, 0xA1);
    CheckRegisterWord(RegisterType::PC, 0x56FB);
    CheckRegisterWord(RegisterType::SP, 0x3FBF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3FBD, 0x24);
    CheckMemory(0x3FBE, 0x22);
    CheckMemory(0x56FA, 0xD1);
}

void test_D1_0329()
{
    if (skip_test_D1_0329)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1ED7);
    WriteRegisterWord(RegisterType::SP, 0xC075);
    WriteRegisterByte(RegisterType::A, 0x93);
    WriteRegisterByte(RegisterType::B, 0x5D);
    WriteRegisterByte(RegisterType::C, 0x85);
    WriteRegisterByte(RegisterType::D, 0x1E);
    WriteRegisterByte(RegisterType::E, 0xB7);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x94);
    WriteRegisterByte(RegisterType::L, 0xF7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC076, 0xC6);
    WriteMemory(0xC075, 0x7A);
    WriteMemory(0x1ED7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x93);
    CheckRegisterByte(RegisterType::B, 0x5D);
    CheckRegisterByte(RegisterType::C, 0x85);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x94);
    CheckRegisterByte(RegisterType::L, 0xF7);
    CheckRegisterWord(RegisterType::PC, 0x1ED8);
    CheckRegisterWord(RegisterType::SP, 0xC077);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1ED7, 0xD1);
    CheckMemory(0xC075, 0x7A);
    CheckMemory(0xC076, 0xC6);
}

void test_D1_032A()
{
    if (skip_test_D1_032A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1835);
    WriteRegisterWord(RegisterType::SP, 0x77A0);
    WriteRegisterByte(RegisterType::A, 0xF8);
    WriteRegisterByte(RegisterType::B, 0xDC);
    WriteRegisterByte(RegisterType::C, 0x74);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0x42);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x91);
    WriteRegisterByte(RegisterType::L, 0x53);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x77A1, 0xD3);
    WriteMemory(0x77A0, 0x13);
    WriteMemory(0x1835, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF8);
    CheckRegisterByte(RegisterType::B, 0xDC);
    CheckRegisterByte(RegisterType::C, 0x74);
    CheckRegisterByte(RegisterType::D, 0xD3);
    CheckRegisterByte(RegisterType::E, 0x13);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x91);
    CheckRegisterByte(RegisterType::L, 0x53);
    CheckRegisterWord(RegisterType::PC, 0x1836);
    CheckRegisterWord(RegisterType::SP, 0x77A2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1835, 0xD1);
    CheckMemory(0x77A0, 0x13);
    CheckMemory(0x77A1, 0xD3);
}

void test_D1_032B()
{
    if (skip_test_D1_032B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB584);
    WriteRegisterWord(RegisterType::SP, 0x6C66);
    WriteRegisterByte(RegisterType::A, 0x93);
    WriteRegisterByte(RegisterType::B, 0xC3);
    WriteRegisterByte(RegisterType::C, 0x02);
    WriteRegisterByte(RegisterType::D, 0xA8);
    WriteRegisterByte(RegisterType::E, 0x57);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x96);
    WriteRegisterByte(RegisterType::L, 0xFA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB584, 0xD1);
    WriteMemory(0x6C67, 0x94);
    WriteMemory(0x6C66, 0xAB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x93);
    CheckRegisterByte(RegisterType::B, 0xC3);
    CheckRegisterByte(RegisterType::C, 0x02);
    CheckRegisterByte(RegisterType::D, 0x94);
    CheckRegisterByte(RegisterType::E, 0xAB);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x96);
    CheckRegisterByte(RegisterType::L, 0xFA);
    CheckRegisterWord(RegisterType::PC, 0xB585);
    CheckRegisterWord(RegisterType::SP, 0x6C68);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6C66, 0xAB);
    CheckMemory(0x6C67, 0x94);
    CheckMemory(0xB584, 0xD1);
}

void test_D1_032C()
{
    if (skip_test_D1_032C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7AEC);
    WriteRegisterWord(RegisterType::SP, 0xBF0E);
    WriteRegisterByte(RegisterType::A, 0xF0);
    WriteRegisterByte(RegisterType::B, 0xAF);
    WriteRegisterByte(RegisterType::C, 0xEF);
    WriteRegisterByte(RegisterType::D, 0xD7);
    WriteRegisterByte(RegisterType::E, 0xC0);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xF1);
    WriteRegisterByte(RegisterType::L, 0x6F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBF0F, 0xB2);
    WriteMemory(0xBF0E, 0xEA);
    WriteMemory(0x7AEC, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF0);
    CheckRegisterByte(RegisterType::B, 0xAF);
    CheckRegisterByte(RegisterType::C, 0xEF);
    CheckRegisterByte(RegisterType::D, 0xB2);
    CheckRegisterByte(RegisterType::E, 0xEA);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xF1);
    CheckRegisterByte(RegisterType::L, 0x6F);
    CheckRegisterWord(RegisterType::PC, 0x7AED);
    CheckRegisterWord(RegisterType::SP, 0xBF10);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7AEC, 0xD1);
    CheckMemory(0xBF0E, 0xEA);
    CheckMemory(0xBF0F, 0xB2);
}

void test_D1_032D()
{
    if (skip_test_D1_032D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x66FF);
    WriteRegisterWord(RegisterType::SP, 0x90F2);
    WriteRegisterByte(RegisterType::A, 0xAB);
    WriteRegisterByte(RegisterType::B, 0x56);
    WriteRegisterByte(RegisterType::C, 0xC8);
    WriteRegisterByte(RegisterType::D, 0x22);
    WriteRegisterByte(RegisterType::E, 0xE9);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xE6);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x90F3, 0xEF);
    WriteMemory(0x90F2, 0x2D);
    WriteMemory(0x66FF, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAB);
    CheckRegisterByte(RegisterType::B, 0x56);
    CheckRegisterByte(RegisterType::C, 0xC8);
    CheckRegisterByte(RegisterType::D, 0xEF);
    CheckRegisterByte(RegisterType::E, 0x2D);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xE6);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0x6700);
    CheckRegisterWord(RegisterType::SP, 0x90F4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x66FF, 0xD1);
    CheckMemory(0x90F2, 0x2D);
    CheckMemory(0x90F3, 0xEF);
}

void test_D1_032E()
{
    if (skip_test_D1_032E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9742);
    WriteRegisterWord(RegisterType::SP, 0xF4CB);
    WriteRegisterByte(RegisterType::A, 0x1C);
    WriteRegisterByte(RegisterType::B, 0xEA);
    WriteRegisterByte(RegisterType::C, 0x50);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0xF4);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x29);
    WriteRegisterByte(RegisterType::L, 0xCC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF4CC, 0x17);
    WriteMemory(0xF4CB, 0x53);
    WriteMemory(0x9742, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1C);
    CheckRegisterByte(RegisterType::B, 0xEA);
    CheckRegisterByte(RegisterType::C, 0x50);
    CheckRegisterByte(RegisterType::D, 0x17);
    CheckRegisterByte(RegisterType::E, 0x53);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x29);
    CheckRegisterByte(RegisterType::L, 0xCC);
    CheckRegisterWord(RegisterType::PC, 0x9743);
    CheckRegisterWord(RegisterType::SP, 0xF4CD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9742, 0xD1);
    CheckMemory(0xF4CB, 0x53);
    CheckMemory(0xF4CC, 0x17);
}

void test_D1_032F()
{
    if (skip_test_D1_032F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF638);
    WriteRegisterWord(RegisterType::SP, 0x1152);
    WriteRegisterByte(RegisterType::A, 0xAA);
    WriteRegisterByte(RegisterType::B, 0xDA);
    WriteRegisterByte(RegisterType::C, 0x1E);
    WriteRegisterByte(RegisterType::D, 0x5A);
    WriteRegisterByte(RegisterType::E, 0x5F);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x1A);
    WriteRegisterByte(RegisterType::L, 0xC2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xF638, 0xD1);
    WriteMemory(0x1153, 0xAF);
    WriteMemory(0x1152, 0x0F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAA);
    CheckRegisterByte(RegisterType::B, 0xDA);
    CheckRegisterByte(RegisterType::C, 0x1E);
    CheckRegisterByte(RegisterType::D, 0xAF);
    CheckRegisterByte(RegisterType::E, 0x0F);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x1A);
    CheckRegisterByte(RegisterType::L, 0xC2);
    CheckRegisterWord(RegisterType::PC, 0xF639);
    CheckRegisterWord(RegisterType::SP, 0x1154);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1152, 0x0F);
    CheckMemory(0x1153, 0xAF);
    CheckMemory(0xF638, 0xD1);
}

void test_D1_0330()
{
    if (skip_test_D1_0330)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCA88);
    WriteRegisterWord(RegisterType::SP, 0xD179);
    WriteRegisterByte(RegisterType::A, 0x5C);
    WriteRegisterByte(RegisterType::B, 0x5D);
    WriteRegisterByte(RegisterType::C, 0x38);
    WriteRegisterByte(RegisterType::D, 0x63);
    WriteRegisterByte(RegisterType::E, 0x04);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xE0);
    WriteRegisterByte(RegisterType::L, 0x59);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD17A, 0x0B);
    WriteMemory(0xD179, 0x3B);
    WriteMemory(0xCA88, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5C);
    CheckRegisterByte(RegisterType::B, 0x5D);
    CheckRegisterByte(RegisterType::C, 0x38);
    CheckRegisterByte(RegisterType::D, 0x0B);
    CheckRegisterByte(RegisterType::E, 0x3B);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xE0);
    CheckRegisterByte(RegisterType::L, 0x59);
    CheckRegisterWord(RegisterType::PC, 0xCA89);
    CheckRegisterWord(RegisterType::SP, 0xD17B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCA88, 0xD1);
    CheckMemory(0xD179, 0x3B);
    CheckMemory(0xD17A, 0x0B);
}

void test_D1_0331()
{
    if (skip_test_D1_0331)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x21DB);
    WriteRegisterWord(RegisterType::SP, 0x2FCA);
    WriteRegisterByte(RegisterType::A, 0x4A);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x45);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x17);
    WriteRegisterByte(RegisterType::L, 0x14);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x2FCB, 0xDC);
    WriteMemory(0x2FCA, 0xF4);
    WriteMemory(0x21DB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4A);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0xDC);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x17);
    CheckRegisterByte(RegisterType::L, 0x14);
    CheckRegisterWord(RegisterType::PC, 0x21DC);
    CheckRegisterWord(RegisterType::SP, 0x2FCC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x21DB, 0xD1);
    CheckMemory(0x2FCA, 0xF4);
    CheckMemory(0x2FCB, 0xDC);
}

void test_D1_0332()
{
    if (skip_test_D1_0332)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x76D2);
    WriteRegisterWord(RegisterType::SP, 0xAC46);
    WriteRegisterByte(RegisterType::A, 0x16);
    WriteRegisterByte(RegisterType::B, 0x77);
    WriteRegisterByte(RegisterType::C, 0xF0);
    WriteRegisterByte(RegisterType::D, 0x1E);
    WriteRegisterByte(RegisterType::E, 0xA4);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x4E);
    WriteRegisterByte(RegisterType::L, 0x75);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xAC47, 0xC1);
    WriteMemory(0xAC46, 0xCA);
    WriteMemory(0x76D2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x16);
    CheckRegisterByte(RegisterType::B, 0x77);
    CheckRegisterByte(RegisterType::C, 0xF0);
    CheckRegisterByte(RegisterType::D, 0xC1);
    CheckRegisterByte(RegisterType::E, 0xCA);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x4E);
    CheckRegisterByte(RegisterType::L, 0x75);
    CheckRegisterWord(RegisterType::PC, 0x76D3);
    CheckRegisterWord(RegisterType::SP, 0xAC48);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x76D2, 0xD1);
    CheckMemory(0xAC46, 0xCA);
    CheckMemory(0xAC47, 0xC1);
}

void test_D1_0333()
{
    if (skip_test_D1_0333)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x614B);
    WriteRegisterWord(RegisterType::SP, 0xE96A);
    WriteRegisterByte(RegisterType::A, 0xEB);
    WriteRegisterByte(RegisterType::B, 0x5D);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0xD3);
    WriteRegisterByte(RegisterType::E, 0xE8);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x0F);
    WriteRegisterByte(RegisterType::L, 0x0B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE96B, 0x63);
    WriteMemory(0xE96A, 0x9A);
    WriteMemory(0x614B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEB);
    CheckRegisterByte(RegisterType::B, 0x5D);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0x63);
    CheckRegisterByte(RegisterType::E, 0x9A);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x0F);
    CheckRegisterByte(RegisterType::L, 0x0B);
    CheckRegisterWord(RegisterType::PC, 0x614C);
    CheckRegisterWord(RegisterType::SP, 0xE96C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x614B, 0xD1);
    CheckMemory(0xE96A, 0x9A);
    CheckMemory(0xE96B, 0x63);
}

void test_D1_0334()
{
    if (skip_test_D1_0334)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4A68);
    WriteRegisterWord(RegisterType::SP, 0x51E9);
    WriteRegisterByte(RegisterType::A, 0x3D);
    WriteRegisterByte(RegisterType::B, 0x4A);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0xDF);
    WriteRegisterByte(RegisterType::E, 0xD9);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x1B);
    WriteRegisterByte(RegisterType::L, 0x78);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x51EA, 0x28);
    WriteMemory(0x51E9, 0x02);
    WriteMemory(0x4A68, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3D);
    CheckRegisterByte(RegisterType::B, 0x4A);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0x28);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x1B);
    CheckRegisterByte(RegisterType::L, 0x78);
    CheckRegisterWord(RegisterType::PC, 0x4A69);
    CheckRegisterWord(RegisterType::SP, 0x51EB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4A68, 0xD1);
    CheckMemory(0x51E9, 0x02);
    CheckMemory(0x51EA, 0x28);
}

void test_D1_0335()
{
    if (skip_test_D1_0335)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7E8F);
    WriteRegisterWord(RegisterType::SP, 0xFA52);
    WriteRegisterByte(RegisterType::A, 0xBE);
    WriteRegisterByte(RegisterType::B, 0x2D);
    WriteRegisterByte(RegisterType::C, 0x48);
    WriteRegisterByte(RegisterType::D, 0xD0);
    WriteRegisterByte(RegisterType::E, 0xD0);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x8A);
    WriteRegisterByte(RegisterType::L, 0x43);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFA53, 0x37);
    WriteMemory(0xFA52, 0x3E);
    WriteMemory(0x7E8F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBE);
    CheckRegisterByte(RegisterType::B, 0x2D);
    CheckRegisterByte(RegisterType::C, 0x48);
    CheckRegisterByte(RegisterType::D, 0x37);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x8A);
    CheckRegisterByte(RegisterType::L, 0x43);
    CheckRegisterWord(RegisterType::PC, 0x7E90);
    CheckRegisterWord(RegisterType::SP, 0xFA54);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7E8F, 0xD1);
    CheckMemory(0xFA52, 0x3E);
    CheckMemory(0xFA53, 0x37);
}

void test_D1_0336()
{
    if (skip_test_D1_0336)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1996);
    WriteRegisterWord(RegisterType::SP, 0xF251);
    WriteRegisterByte(RegisterType::A, 0x86);
    WriteRegisterByte(RegisterType::B, 0x64);
    WriteRegisterByte(RegisterType::C, 0xC6);
    WriteRegisterByte(RegisterType::D, 0xB0);
    WriteRegisterByte(RegisterType::E, 0x5F);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x6B);
    WriteRegisterByte(RegisterType::L, 0x17);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF252, 0x43);
    WriteMemory(0xF251, 0x20);
    WriteMemory(0x1996, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x86);
    CheckRegisterByte(RegisterType::B, 0x64);
    CheckRegisterByte(RegisterType::C, 0xC6);
    CheckRegisterByte(RegisterType::D, 0x43);
    CheckRegisterByte(RegisterType::E, 0x20);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x6B);
    CheckRegisterByte(RegisterType::L, 0x17);
    CheckRegisterWord(RegisterType::PC, 0x1997);
    CheckRegisterWord(RegisterType::SP, 0xF253);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1996, 0xD1);
    CheckMemory(0xF251, 0x20);
    CheckMemory(0xF252, 0x43);
}

void test_D1_0337()
{
    if (skip_test_D1_0337)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB14E);
    WriteRegisterWord(RegisterType::SP, 0x0145);
    WriteRegisterByte(RegisterType::A, 0xE3);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x3F);
    WriteRegisterByte(RegisterType::D, 0x50);
    WriteRegisterByte(RegisterType::E, 0x38);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x0A);
    WriteRegisterByte(RegisterType::L, 0xCC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB14E, 0xD1);
    WriteMemory(0x0146, 0x04);
    WriteMemory(0x0145, 0x1E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE3);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x3F);
    CheckRegisterByte(RegisterType::D, 0x04);
    CheckRegisterByte(RegisterType::E, 0x1E);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x0A);
    CheckRegisterByte(RegisterType::L, 0xCC);
    CheckRegisterWord(RegisterType::PC, 0xB14F);
    CheckRegisterWord(RegisterType::SP, 0x0147);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0145, 0x1E);
    CheckMemory(0x0146, 0x04);
    CheckMemory(0xB14E, 0xD1);
}

void test_D1_0338()
{
    if (skip_test_D1_0338)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFFCF);
    WriteRegisterWord(RegisterType::SP, 0xF54A);
    WriteRegisterByte(RegisterType::A, 0x0F);
    WriteRegisterByte(RegisterType::B, 0xC3);
    WriteRegisterByte(RegisterType::C, 0x8C);
    WriteRegisterByte(RegisterType::D, 0x43);
    WriteRegisterByte(RegisterType::E, 0x0C);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0x00);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCF, 0xD1);
    WriteMemory(0xF54B, 0x79);
    WriteMemory(0xF54A, 0x68);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0F);
    CheckRegisterByte(RegisterType::B, 0xC3);
    CheckRegisterByte(RegisterType::C, 0x8C);
    CheckRegisterByte(RegisterType::D, 0x79);
    CheckRegisterByte(RegisterType::E, 0x68);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0x00);
    CheckRegisterWord(RegisterType::PC, 0xFFD0);
    CheckRegisterWord(RegisterType::SP, 0xF54C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF54A, 0x68);
    CheckMemory(0xF54B, 0x79);
    CheckMemory(0xFFCF, 0xD1);
}

void test_D1_0339()
{
    if (skip_test_D1_0339)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD4AA);
    WriteRegisterWord(RegisterType::SP, 0x00AF);
    WriteRegisterByte(RegisterType::A, 0xA4);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x67);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0x4C);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xED);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD4AA, 0xD1);
    WriteMemory(0x00B0, 0x09);
    WriteMemory(0x00AF, 0x54);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA4);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x67);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0x54);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xED);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0xD4AB);
    CheckRegisterWord(RegisterType::SP, 0x00B1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x00AF, 0x54);
    CheckMemory(0x00B0, 0x09);
    CheckMemory(0xD4AA, 0xD1);
}

void test_D1_033A()
{
    if (skip_test_D1_033A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5184);
    WriteRegisterWord(RegisterType::SP, 0x5660);
    WriteRegisterByte(RegisterType::A, 0x4D);
    WriteRegisterByte(RegisterType::B, 0x7A);
    WriteRegisterByte(RegisterType::C, 0x89);
    WriteRegisterByte(RegisterType::D, 0x4C);
    WriteRegisterByte(RegisterType::E, 0x84);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x53);
    WriteRegisterByte(RegisterType::L, 0x8D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5661, 0x7F);
    WriteMemory(0x5660, 0x3B);
    WriteMemory(0x5184, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4D);
    CheckRegisterByte(RegisterType::B, 0x7A);
    CheckRegisterByte(RegisterType::C, 0x89);
    CheckRegisterByte(RegisterType::D, 0x7F);
    CheckRegisterByte(RegisterType::E, 0x3B);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x53);
    CheckRegisterByte(RegisterType::L, 0x8D);
    CheckRegisterWord(RegisterType::PC, 0x5185);
    CheckRegisterWord(RegisterType::SP, 0x5662);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5184, 0xD1);
    CheckMemory(0x5660, 0x3B);
    CheckMemory(0x5661, 0x7F);
}

void test_D1_033B()
{
    if (skip_test_D1_033B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9271);
    WriteRegisterWord(RegisterType::SP, 0xE3E3);
    WriteRegisterByte(RegisterType::A, 0x8E);
    WriteRegisterByte(RegisterType::B, 0xA2);
    WriteRegisterByte(RegisterType::C, 0x12);
    WriteRegisterByte(RegisterType::D, 0x1E);
    WriteRegisterByte(RegisterType::E, 0xED);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xBE);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE3E4, 0x29);
    WriteMemory(0xE3E3, 0xBD);
    WriteMemory(0x9271, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8E);
    CheckRegisterByte(RegisterType::B, 0xA2);
    CheckRegisterByte(RegisterType::C, 0x12);
    CheckRegisterByte(RegisterType::D, 0x29);
    CheckRegisterByte(RegisterType::E, 0xBD);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xBE);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0x9272);
    CheckRegisterWord(RegisterType::SP, 0xE3E5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9271, 0xD1);
    CheckMemory(0xE3E3, 0xBD);
    CheckMemory(0xE3E4, 0x29);
}

void test_D1_033C()
{
    if (skip_test_D1_033C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCEF5);
    WriteRegisterWord(RegisterType::SP, 0x1DEC);
    WriteRegisterByte(RegisterType::A, 0x2A);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0x8F);
    WriteRegisterByte(RegisterType::D, 0xB2);
    WriteRegisterByte(RegisterType::E, 0x45);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x54);
    WriteRegisterByte(RegisterType::L, 0x33);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCEF5, 0xD1);
    WriteMemory(0x1DED, 0xA2);
    WriteMemory(0x1DEC, 0x3F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2A);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0x8F);
    CheckRegisterByte(RegisterType::D, 0xA2);
    CheckRegisterByte(RegisterType::E, 0x3F);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x54);
    CheckRegisterByte(RegisterType::L, 0x33);
    CheckRegisterWord(RegisterType::PC, 0xCEF6);
    CheckRegisterWord(RegisterType::SP, 0x1DEE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1DEC, 0x3F);
    CheckMemory(0x1DED, 0xA2);
    CheckMemory(0xCEF5, 0xD1);
}

void test_D1_033D()
{
    if (skip_test_D1_033D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4468);
    WriteRegisterWord(RegisterType::SP, 0x1930);
    WriteRegisterByte(RegisterType::A, 0x7A);
    WriteRegisterByte(RegisterType::B, 0x20);
    WriteRegisterByte(RegisterType::C, 0x33);
    WriteRegisterByte(RegisterType::D, 0x57);
    WriteRegisterByte(RegisterType::E, 0x7C);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x7E);
    WriteRegisterByte(RegisterType::L, 0x1B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4468, 0xD1);
    WriteMemory(0x1931, 0x63);
    WriteMemory(0x1930, 0x06);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7A);
    CheckRegisterByte(RegisterType::B, 0x20);
    CheckRegisterByte(RegisterType::C, 0x33);
    CheckRegisterByte(RegisterType::D, 0x63);
    CheckRegisterByte(RegisterType::E, 0x06);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x7E);
    CheckRegisterByte(RegisterType::L, 0x1B);
    CheckRegisterWord(RegisterType::PC, 0x4469);
    CheckRegisterWord(RegisterType::SP, 0x1932);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1930, 0x06);
    CheckMemory(0x1931, 0x63);
    CheckMemory(0x4468, 0xD1);
}

void test_D1_033E()
{
    if (skip_test_D1_033E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3259);
    WriteRegisterWord(RegisterType::SP, 0xB465);
    WriteRegisterByte(RegisterType::A, 0x6E);
    WriteRegisterByte(RegisterType::B, 0x6B);
    WriteRegisterByte(RegisterType::C, 0xE6);
    WriteRegisterByte(RegisterType::D, 0x58);
    WriteRegisterByte(RegisterType::E, 0x29);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x5E);
    WriteRegisterByte(RegisterType::L, 0xFA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB466, 0x92);
    WriteMemory(0xB465, 0xED);
    WriteMemory(0x3259, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6E);
    CheckRegisterByte(RegisterType::B, 0x6B);
    CheckRegisterByte(RegisterType::C, 0xE6);
    CheckRegisterByte(RegisterType::D, 0x92);
    CheckRegisterByte(RegisterType::E, 0xED);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x5E);
    CheckRegisterByte(RegisterType::L, 0xFA);
    CheckRegisterWord(RegisterType::PC, 0x325A);
    CheckRegisterWord(RegisterType::SP, 0xB467);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3259, 0xD1);
    CheckMemory(0xB465, 0xED);
    CheckMemory(0xB466, 0x92);
}

void test_D1_033F()
{
    if (skip_test_D1_033F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEBB6);
    WriteRegisterWord(RegisterType::SP, 0xFEEE);
    WriteRegisterByte(RegisterType::A, 0x18);
    WriteRegisterByte(RegisterType::B, 0x49);
    WriteRegisterByte(RegisterType::C, 0xCE);
    WriteRegisterByte(RegisterType::D, 0xAA);
    WriteRegisterByte(RegisterType::E, 0x4A);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0xA4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFEEF, 0xDA);
    WriteMemory(0xFEEE, 0x65);
    WriteMemory(0xEBB6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x18);
    CheckRegisterByte(RegisterType::B, 0x49);
    CheckRegisterByte(RegisterType::C, 0xCE);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0x65);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0xA4);
    CheckRegisterWord(RegisterType::PC, 0xEBB7);
    CheckRegisterWord(RegisterType::SP, 0xFEF0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xEBB6, 0xD1);
    CheckMemory(0xFEEE, 0x65);
    CheckMemory(0xFEEF, 0xDA);
}

void test_D1_0340()
{
    if (skip_test_D1_0340)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xADC1);
    WriteRegisterWord(RegisterType::SP, 0xEB04);
    WriteRegisterByte(RegisterType::A, 0x28);
    WriteRegisterByte(RegisterType::B, 0x5C);
    WriteRegisterByte(RegisterType::C, 0x3D);
    WriteRegisterByte(RegisterType::D, 0x8B);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0xB8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEB05, 0xB4);
    WriteMemory(0xEB04, 0x88);
    WriteMemory(0xADC1, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x28);
    CheckRegisterByte(RegisterType::B, 0x5C);
    CheckRegisterByte(RegisterType::C, 0x3D);
    CheckRegisterByte(RegisterType::D, 0xB4);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0xB8);
    CheckRegisterWord(RegisterType::PC, 0xADC2);
    CheckRegisterWord(RegisterType::SP, 0xEB06);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xADC1, 0xD1);
    CheckMemory(0xEB04, 0x88);
    CheckMemory(0xEB05, 0xB4);
}

void test_D1_0341()
{
    if (skip_test_D1_0341)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC65B);
    WriteRegisterWord(RegisterType::SP, 0x1ADD);
    WriteRegisterByte(RegisterType::A, 0x9F);
    WriteRegisterByte(RegisterType::B, 0xA9);
    WriteRegisterByte(RegisterType::C, 0x4E);
    WriteRegisterByte(RegisterType::D, 0x5A);
    WriteRegisterByte(RegisterType::E, 0x20);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x2D);
    WriteRegisterByte(RegisterType::L, 0x83);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC65B, 0xD1);
    WriteMemory(0x1ADE, 0xB3);
    WriteMemory(0x1ADD, 0xA3);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9F);
    CheckRegisterByte(RegisterType::B, 0xA9);
    CheckRegisterByte(RegisterType::C, 0x4E);
    CheckRegisterByte(RegisterType::D, 0xB3);
    CheckRegisterByte(RegisterType::E, 0xA3);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x2D);
    CheckRegisterByte(RegisterType::L, 0x83);
    CheckRegisterWord(RegisterType::PC, 0xC65C);
    CheckRegisterWord(RegisterType::SP, 0x1ADF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1ADD, 0xA3);
    CheckMemory(0x1ADE, 0xB3);
    CheckMemory(0xC65B, 0xD1);
}

void test_D1_0342()
{
    if (skip_test_D1_0342)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x315C);
    WriteRegisterWord(RegisterType::SP, 0x23D5);
    WriteRegisterByte(RegisterType::A, 0xC0);
    WriteRegisterByte(RegisterType::B, 0x05);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0xE4);
    WriteRegisterByte(RegisterType::E, 0xEA);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xBC);
    WriteRegisterByte(RegisterType::L, 0xF4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x315C, 0xD1);
    WriteMemory(0x23D6, 0xD7);
    WriteMemory(0x23D5, 0x40);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC0);
    CheckRegisterByte(RegisterType::B, 0x05);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0xD7);
    CheckRegisterByte(RegisterType::E, 0x40);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xBC);
    CheckRegisterByte(RegisterType::L, 0xF4);
    CheckRegisterWord(RegisterType::PC, 0x315D);
    CheckRegisterWord(RegisterType::SP, 0x23D7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x23D5, 0x40);
    CheckMemory(0x23D6, 0xD7);
    CheckMemory(0x315C, 0xD1);
}

void test_D1_0343()
{
    if (skip_test_D1_0343)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x556E);
    WriteRegisterWord(RegisterType::SP, 0x7039);
    WriteRegisterByte(RegisterType::A, 0x7A);
    WriteRegisterByte(RegisterType::B, 0x2B);
    WriteRegisterByte(RegisterType::C, 0xF7);
    WriteRegisterByte(RegisterType::D, 0x6C);
    WriteRegisterByte(RegisterType::E, 0xC0);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0x74);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x703A, 0x9F);
    WriteMemory(0x7039, 0xB6);
    WriteMemory(0x556E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7A);
    CheckRegisterByte(RegisterType::B, 0x2B);
    CheckRegisterByte(RegisterType::C, 0xF7);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0xB6);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0x74);
    CheckRegisterWord(RegisterType::PC, 0x556F);
    CheckRegisterWord(RegisterType::SP, 0x703B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x556E, 0xD1);
    CheckMemory(0x7039, 0xB6);
    CheckMemory(0x703A, 0x9F);
}

void test_D1_0344()
{
    if (skip_test_D1_0344)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFD3B);
    WriteRegisterWord(RegisterType::SP, 0x723E);
    WriteRegisterByte(RegisterType::A, 0x25);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0x2F);
    WriteRegisterByte(RegisterType::D, 0x38);
    WriteRegisterByte(RegisterType::E, 0x4B);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x1F);
    WriteRegisterByte(RegisterType::L, 0x92);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFD3B, 0xD1);
    WriteMemory(0x723F, 0x92);
    WriteMemory(0x723E, 0x26);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x25);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0x2F);
    CheckRegisterByte(RegisterType::D, 0x92);
    CheckRegisterByte(RegisterType::E, 0x26);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x1F);
    CheckRegisterByte(RegisterType::L, 0x92);
    CheckRegisterWord(RegisterType::PC, 0xFD3C);
    CheckRegisterWord(RegisterType::SP, 0x7240);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x723E, 0x26);
    CheckMemory(0x723F, 0x92);
    CheckMemory(0xFD3B, 0xD1);
}

void test_D1_0345()
{
    if (skip_test_D1_0345)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x12A0);
    WriteRegisterWord(RegisterType::SP, 0x035F);
    WriteRegisterByte(RegisterType::A, 0xD4);
    WriteRegisterByte(RegisterType::B, 0x48);
    WriteRegisterByte(RegisterType::C, 0xE3);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0xB3);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0x3F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x12A0, 0xD1);
    WriteMemory(0x0360, 0x90);
    WriteMemory(0x035F, 0x57);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD4);
    CheckRegisterByte(RegisterType::B, 0x48);
    CheckRegisterByte(RegisterType::C, 0xE3);
    CheckRegisterByte(RegisterType::D, 0x90);
    CheckRegisterByte(RegisterType::E, 0x57);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0x3F);
    CheckRegisterWord(RegisterType::PC, 0x12A1);
    CheckRegisterWord(RegisterType::SP, 0x0361);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x035F, 0x57);
    CheckMemory(0x0360, 0x90);
    CheckMemory(0x12A0, 0xD1);
}

void test_D1_0346()
{
    if (skip_test_D1_0346)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x02EB);
    WriteRegisterWord(RegisterType::SP, 0xE886);
    WriteRegisterByte(RegisterType::A, 0x62);
    WriteRegisterByte(RegisterType::B, 0x25);
    WriteRegisterByte(RegisterType::C, 0x2F);
    WriteRegisterByte(RegisterType::D, 0x19);
    WriteRegisterByte(RegisterType::E, 0x4C);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x9A);
    WriteRegisterByte(RegisterType::L, 0x99);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE887, 0x2A);
    WriteMemory(0xE886, 0x27);
    WriteMemory(0x02EB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x62);
    CheckRegisterByte(RegisterType::B, 0x25);
    CheckRegisterByte(RegisterType::C, 0x2F);
    CheckRegisterByte(RegisterType::D, 0x2A);
    CheckRegisterByte(RegisterType::E, 0x27);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x9A);
    CheckRegisterByte(RegisterType::L, 0x99);
    CheckRegisterWord(RegisterType::PC, 0x02EC);
    CheckRegisterWord(RegisterType::SP, 0xE888);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x02EB, 0xD1);
    CheckMemory(0xE886, 0x27);
    CheckMemory(0xE887, 0x2A);
}

void test_D1_0347()
{
    if (skip_test_D1_0347)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x72C2);
    WriteRegisterWord(RegisterType::SP, 0xBB91);
    WriteRegisterByte(RegisterType::A, 0xAE);
    WriteRegisterByte(RegisterType::B, 0xB2);
    WriteRegisterByte(RegisterType::C, 0x03);
    WriteRegisterByte(RegisterType::D, 0xE8);
    WriteRegisterByte(RegisterType::E, 0x51);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xC3);
    WriteRegisterByte(RegisterType::L, 0xB2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBB92, 0xBF);
    WriteMemory(0xBB91, 0x61);
    WriteMemory(0x72C2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAE);
    CheckRegisterByte(RegisterType::B, 0xB2);
    CheckRegisterByte(RegisterType::C, 0x03);
    CheckRegisterByte(RegisterType::D, 0xBF);
    CheckRegisterByte(RegisterType::E, 0x61);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xC3);
    CheckRegisterByte(RegisterType::L, 0xB2);
    CheckRegisterWord(RegisterType::PC, 0x72C3);
    CheckRegisterWord(RegisterType::SP, 0xBB93);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x72C2, 0xD1);
    CheckMemory(0xBB91, 0x61);
    CheckMemory(0xBB92, 0xBF);
}

void test_D1_0348()
{
    if (skip_test_D1_0348)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6133);
    WriteRegisterWord(RegisterType::SP, 0x2E2C);
    WriteRegisterByte(RegisterType::A, 0x51);
    WriteRegisterByte(RegisterType::B, 0x5C);
    WriteRegisterByte(RegisterType::C, 0xB5);
    WriteRegisterByte(RegisterType::D, 0x70);
    WriteRegisterByte(RegisterType::E, 0xB6);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x22);
    WriteRegisterByte(RegisterType::L, 0xF8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6133, 0xD1);
    WriteMemory(0x2E2D, 0x8D);
    WriteMemory(0x2E2C, 0xFD);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x51);
    CheckRegisterByte(RegisterType::B, 0x5C);
    CheckRegisterByte(RegisterType::C, 0xB5);
    CheckRegisterByte(RegisterType::D, 0x8D);
    CheckRegisterByte(RegisterType::E, 0xFD);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x22);
    CheckRegisterByte(RegisterType::L, 0xF8);
    CheckRegisterWord(RegisterType::PC, 0x6134);
    CheckRegisterWord(RegisterType::SP, 0x2E2E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2E2C, 0xFD);
    CheckMemory(0x2E2D, 0x8D);
    CheckMemory(0x6133, 0xD1);
}

void test_D1_0349()
{
    if (skip_test_D1_0349)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x43DF);
    WriteRegisterWord(RegisterType::SP, 0xB2AE);
    WriteRegisterByte(RegisterType::A, 0xA3);
    WriteRegisterByte(RegisterType::B, 0xCD);
    WriteRegisterByte(RegisterType::C, 0x7D);
    WriteRegisterByte(RegisterType::D, 0x5E);
    WriteRegisterByte(RegisterType::E, 0x04);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xFE);
    WriteRegisterByte(RegisterType::L, 0xC7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB2AF, 0xD7);
    WriteMemory(0xB2AE, 0xD6);
    WriteMemory(0x43DF, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA3);
    CheckRegisterByte(RegisterType::B, 0xCD);
    CheckRegisterByte(RegisterType::C, 0x7D);
    CheckRegisterByte(RegisterType::D, 0xD7);
    CheckRegisterByte(RegisterType::E, 0xD6);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xFE);
    CheckRegisterByte(RegisterType::L, 0xC7);
    CheckRegisterWord(RegisterType::PC, 0x43E0);
    CheckRegisterWord(RegisterType::SP, 0xB2B0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x43DF, 0xD1);
    CheckMemory(0xB2AE, 0xD6);
    CheckMemory(0xB2AF, 0xD7);
}

void test_D1_034A()
{
    if (skip_test_D1_034A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x21A0);
    WriteRegisterWord(RegisterType::SP, 0x25AC);
    WriteRegisterByte(RegisterType::A, 0x04);
    WriteRegisterByte(RegisterType::B, 0x06);
    WriteRegisterByte(RegisterType::C, 0xC2);
    WriteRegisterByte(RegisterType::D, 0x10);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xDB);
    WriteRegisterByte(RegisterType::L, 0xD6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x25AD, 0xE3);
    WriteMemory(0x25AC, 0x55);
    WriteMemory(0x21A0, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x04);
    CheckRegisterByte(RegisterType::B, 0x06);
    CheckRegisterByte(RegisterType::C, 0xC2);
    CheckRegisterByte(RegisterType::D, 0xE3);
    CheckRegisterByte(RegisterType::E, 0x55);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xDB);
    CheckRegisterByte(RegisterType::L, 0xD6);
    CheckRegisterWord(RegisterType::PC, 0x21A1);
    CheckRegisterWord(RegisterType::SP, 0x25AE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x21A0, 0xD1);
    CheckMemory(0x25AC, 0x55);
    CheckMemory(0x25AD, 0xE3);
}

void test_D1_034B()
{
    if (skip_test_D1_034B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x74A7);
    WriteRegisterWord(RegisterType::SP, 0xFA73);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0x04);
    WriteRegisterByte(RegisterType::C, 0x55);
    WriteRegisterByte(RegisterType::D, 0xC6);
    WriteRegisterByte(RegisterType::E, 0x6E);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x8E);
    WriteRegisterByte(RegisterType::L, 0xF0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFA74, 0x57);
    WriteMemory(0xFA73, 0x18);
    WriteMemory(0x74A7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0x04);
    CheckRegisterByte(RegisterType::C, 0x55);
    CheckRegisterByte(RegisterType::D, 0x57);
    CheckRegisterByte(RegisterType::E, 0x18);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x8E);
    CheckRegisterByte(RegisterType::L, 0xF0);
    CheckRegisterWord(RegisterType::PC, 0x74A8);
    CheckRegisterWord(RegisterType::SP, 0xFA75);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x74A7, 0xD1);
    CheckMemory(0xFA73, 0x18);
    CheckMemory(0xFA74, 0x57);
}

void test_D1_034C()
{
    if (skip_test_D1_034C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8BC5);
    WriteRegisterWord(RegisterType::SP, 0xB963);
    WriteRegisterByte(RegisterType::A, 0x33);
    WriteRegisterByte(RegisterType::B, 0xED);
    WriteRegisterByte(RegisterType::C, 0xC7);
    WriteRegisterByte(RegisterType::D, 0x7F);
    WriteRegisterByte(RegisterType::E, 0x94);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x3C);
    WriteRegisterByte(RegisterType::L, 0xA0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB964, 0x1F);
    WriteMemory(0xB963, 0x71);
    WriteMemory(0x8BC5, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x33);
    CheckRegisterByte(RegisterType::B, 0xED);
    CheckRegisterByte(RegisterType::C, 0xC7);
    CheckRegisterByte(RegisterType::D, 0x1F);
    CheckRegisterByte(RegisterType::E, 0x71);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x3C);
    CheckRegisterByte(RegisterType::L, 0xA0);
    CheckRegisterWord(RegisterType::PC, 0x8BC6);
    CheckRegisterWord(RegisterType::SP, 0xB965);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8BC5, 0xD1);
    CheckMemory(0xB963, 0x71);
    CheckMemory(0xB964, 0x1F);
}

void test_D1_034D()
{
    if (skip_test_D1_034D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB709);
    WriteRegisterWord(RegisterType::SP, 0xC5A2);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0xA8);
    WriteRegisterByte(RegisterType::C, 0x53);
    WriteRegisterByte(RegisterType::D, 0x0D);
    WriteRegisterByte(RegisterType::E, 0xBA);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x5C);
    WriteRegisterByte(RegisterType::L, 0x5E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC5A3, 0x04);
    WriteMemory(0xC5A2, 0x62);
    WriteMemory(0xB709, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0xA8);
    CheckRegisterByte(RegisterType::C, 0x53);
    CheckRegisterByte(RegisterType::D, 0x04);
    CheckRegisterByte(RegisterType::E, 0x62);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x5C);
    CheckRegisterByte(RegisterType::L, 0x5E);
    CheckRegisterWord(RegisterType::PC, 0xB70A);
    CheckRegisterWord(RegisterType::SP, 0xC5A4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB709, 0xD1);
    CheckMemory(0xC5A2, 0x62);
    CheckMemory(0xC5A3, 0x04);
}

void test_D1_034E()
{
    if (skip_test_D1_034E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE4AC);
    WriteRegisterWord(RegisterType::SP, 0x7E77);
    WriteRegisterByte(RegisterType::A, 0x9E);
    WriteRegisterByte(RegisterType::B, 0x5B);
    WriteRegisterByte(RegisterType::C, 0x57);
    WriteRegisterByte(RegisterType::D, 0xFE);
    WriteRegisterByte(RegisterType::E, 0xAB);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x9B);
    WriteRegisterByte(RegisterType::L, 0x0F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE4AC, 0xD1);
    WriteMemory(0x7E78, 0x4A);
    WriteMemory(0x7E77, 0xDE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9E);
    CheckRegisterByte(RegisterType::B, 0x5B);
    CheckRegisterByte(RegisterType::C, 0x57);
    CheckRegisterByte(RegisterType::D, 0x4A);
    CheckRegisterByte(RegisterType::E, 0xDE);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x9B);
    CheckRegisterByte(RegisterType::L, 0x0F);
    CheckRegisterWord(RegisterType::PC, 0xE4AD);
    CheckRegisterWord(RegisterType::SP, 0x7E79);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7E77, 0xDE);
    CheckMemory(0x7E78, 0x4A);
    CheckMemory(0xE4AC, 0xD1);
}

void test_D1_034F()
{
    if (skip_test_D1_034F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAE23);
    WriteRegisterWord(RegisterType::SP, 0xD0B7);
    WriteRegisterByte(RegisterType::A, 0x3F);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0xC3);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0xA7);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xD0);
    WriteRegisterByte(RegisterType::L, 0x00);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD0B8, 0x8A);
    WriteMemory(0xD0B7, 0x53);
    WriteMemory(0xAE23, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3F);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0xC3);
    CheckRegisterByte(RegisterType::D, 0x8A);
    CheckRegisterByte(RegisterType::E, 0x53);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xD0);
    CheckRegisterByte(RegisterType::L, 0x00);
    CheckRegisterWord(RegisterType::PC, 0xAE24);
    CheckRegisterWord(RegisterType::SP, 0xD0B9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAE23, 0xD1);
    CheckMemory(0xD0B7, 0x53);
    CheckMemory(0xD0B8, 0x8A);
}

void test_D1_0350()
{
    if (skip_test_D1_0350)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE8E5);
    WriteRegisterWord(RegisterType::SP, 0xE6A4);
    WriteRegisterByte(RegisterType::A, 0x59);
    WriteRegisterByte(RegisterType::B, 0x1D);
    WriteRegisterByte(RegisterType::C, 0x5F);
    WriteRegisterByte(RegisterType::D, 0x7F);
    WriteRegisterByte(RegisterType::E, 0x28);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x61);
    WriteRegisterByte(RegisterType::L, 0xAB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE8E5, 0xD1);
    WriteMemory(0xE6A5, 0xFF);
    WriteMemory(0xE6A4, 0x9A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x59);
    CheckRegisterByte(RegisterType::B, 0x1D);
    CheckRegisterByte(RegisterType::C, 0x5F);
    CheckRegisterByte(RegisterType::D, 0xFF);
    CheckRegisterByte(RegisterType::E, 0x9A);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x61);
    CheckRegisterByte(RegisterType::L, 0xAB);
    CheckRegisterWord(RegisterType::PC, 0xE8E6);
    CheckRegisterWord(RegisterType::SP, 0xE6A6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE6A4, 0x9A);
    CheckMemory(0xE6A5, 0xFF);
    CheckMemory(0xE8E5, 0xD1);
}

void test_D1_0351()
{
    if (skip_test_D1_0351)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x28A7);
    WriteRegisterWord(RegisterType::SP, 0xE131);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0x79);
    WriteRegisterByte(RegisterType::D, 0x8E);
    WriteRegisterByte(RegisterType::E, 0x5D);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xCD);
    WriteRegisterByte(RegisterType::L, 0x0A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE132, 0x79);
    WriteMemory(0xE131, 0xD8);
    WriteMemory(0x28A7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0x79);
    CheckRegisterByte(RegisterType::D, 0x79);
    CheckRegisterByte(RegisterType::E, 0xD8);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xCD);
    CheckRegisterByte(RegisterType::L, 0x0A);
    CheckRegisterWord(RegisterType::PC, 0x28A8);
    CheckRegisterWord(RegisterType::SP, 0xE133);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x28A7, 0xD1);
    CheckMemory(0xE131, 0xD8);
    CheckMemory(0xE132, 0x79);
}

void test_D1_0352()
{
    if (skip_test_D1_0352)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDAA8);
    WriteRegisterWord(RegisterType::SP, 0x76E7);
    WriteRegisterByte(RegisterType::A, 0xAA);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0x94);
    WriteRegisterByte(RegisterType::D, 0xC1);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xAE);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDAA8, 0xD1);
    WriteMemory(0x76E8, 0x95);
    WriteMemory(0x76E7, 0xE5);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAA);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0x94);
    CheckRegisterByte(RegisterType::D, 0x95);
    CheckRegisterByte(RegisterType::E, 0xE5);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xAE);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0xDAA9);
    CheckRegisterWord(RegisterType::SP, 0x76E9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x76E7, 0xE5);
    CheckMemory(0x76E8, 0x95);
    CheckMemory(0xDAA8, 0xD1);
}

void test_D1_0353()
{
    if (skip_test_D1_0353)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD1D0);
    WriteRegisterWord(RegisterType::SP, 0x8E71);
    WriteRegisterByte(RegisterType::A, 0x0A);
    WriteRegisterByte(RegisterType::B, 0xA6);
    WriteRegisterByte(RegisterType::C, 0x89);
    WriteRegisterByte(RegisterType::D, 0x0A);
    WriteRegisterByte(RegisterType::E, 0x78);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xD7);
    WriteRegisterByte(RegisterType::L, 0x0C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD1D0, 0xD1);
    WriteMemory(0x8E72, 0x1F);
    WriteMemory(0x8E71, 0xCD);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0A);
    CheckRegisterByte(RegisterType::B, 0xA6);
    CheckRegisterByte(RegisterType::C, 0x89);
    CheckRegisterByte(RegisterType::D, 0x1F);
    CheckRegisterByte(RegisterType::E, 0xCD);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xD7);
    CheckRegisterByte(RegisterType::L, 0x0C);
    CheckRegisterWord(RegisterType::PC, 0xD1D1);
    CheckRegisterWord(RegisterType::SP, 0x8E73);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8E71, 0xCD);
    CheckMemory(0x8E72, 0x1F);
    CheckMemory(0xD1D0, 0xD1);
}

void test_D1_0354()
{
    if (skip_test_D1_0354)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9576);
    WriteRegisterWord(RegisterType::SP, 0xFAE2);
    WriteRegisterByte(RegisterType::A, 0x1B);
    WriteRegisterByte(RegisterType::B, 0xF4);
    WriteRegisterByte(RegisterType::C, 0x66);
    WriteRegisterByte(RegisterType::D, 0x67);
    WriteRegisterByte(RegisterType::E, 0xC3);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x48);
    WriteRegisterByte(RegisterType::L, 0xC3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFAE3, 0x3D);
    WriteMemory(0xFAE2, 0xD1);
    WriteMemory(0x9576, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1B);
    CheckRegisterByte(RegisterType::B, 0xF4);
    CheckRegisterByte(RegisterType::C, 0x66);
    CheckRegisterByte(RegisterType::D, 0x3D);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x48);
    CheckRegisterByte(RegisterType::L, 0xC3);
    CheckRegisterWord(RegisterType::PC, 0x9577);
    CheckRegisterWord(RegisterType::SP, 0xFAE4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9576, 0xD1);
    CheckMemory(0xFAE2, 0xD1);
    CheckMemory(0xFAE3, 0x3D);
}

void test_D1_0355()
{
    if (skip_test_D1_0355)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF06B);
    WriteRegisterWord(RegisterType::SP, 0x4590);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0x06);
    WriteRegisterByte(RegisterType::C, 0x54);
    WriteRegisterByte(RegisterType::D, 0xB3);
    WriteRegisterByte(RegisterType::E, 0x27);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x52);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF06B, 0xD1);
    WriteMemory(0x4591, 0x91);
    WriteMemory(0x4590, 0x77);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0x06);
    CheckRegisterByte(RegisterType::C, 0x54);
    CheckRegisterByte(RegisterType::D, 0x91);
    CheckRegisterByte(RegisterType::E, 0x77);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x52);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0xF06C);
    CheckRegisterWord(RegisterType::SP, 0x4592);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4590, 0x77);
    CheckMemory(0x4591, 0x91);
    CheckMemory(0xF06B, 0xD1);
}

void test_D1_0356()
{
    if (skip_test_D1_0356)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x01A6);
    WriteRegisterWord(RegisterType::SP, 0xC2E1);
    WriteRegisterByte(RegisterType::A, 0xEC);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0x96);
    WriteRegisterByte(RegisterType::D, 0x1A);
    WriteRegisterByte(RegisterType::E, 0x68);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x08);
    WriteRegisterByte(RegisterType::L, 0xB4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC2E2, 0xA5);
    WriteMemory(0xC2E1, 0x08);
    WriteMemory(0x01A6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEC);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0x96);
    CheckRegisterByte(RegisterType::D, 0xA5);
    CheckRegisterByte(RegisterType::E, 0x08);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x08);
    CheckRegisterByte(RegisterType::L, 0xB4);
    CheckRegisterWord(RegisterType::PC, 0x01A7);
    CheckRegisterWord(RegisterType::SP, 0xC2E3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x01A6, 0xD1);
    CheckMemory(0xC2E1, 0x08);
    CheckMemory(0xC2E2, 0xA5);
}

void test_D1_0357()
{
    if (skip_test_D1_0357)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9484);
    WriteRegisterWord(RegisterType::SP, 0x0370);
    WriteRegisterByte(RegisterType::A, 0xBC);
    WriteRegisterByte(RegisterType::B, 0x50);
    WriteRegisterByte(RegisterType::C, 0x30);
    WriteRegisterByte(RegisterType::D, 0x97);
    WriteRegisterByte(RegisterType::E, 0xC9);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0xC7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9484, 0xD1);
    WriteMemory(0x0371, 0x08);
    WriteMemory(0x0370, 0xDF);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBC);
    CheckRegisterByte(RegisterType::B, 0x50);
    CheckRegisterByte(RegisterType::C, 0x30);
    CheckRegisterByte(RegisterType::D, 0x08);
    CheckRegisterByte(RegisterType::E, 0xDF);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0xC7);
    CheckRegisterWord(RegisterType::PC, 0x9485);
    CheckRegisterWord(RegisterType::SP, 0x0372);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0370, 0xDF);
    CheckMemory(0x0371, 0x08);
    CheckMemory(0x9484, 0xD1);
}

void test_D1_0358()
{
    if (skip_test_D1_0358)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7ED4);
    WriteRegisterWord(RegisterType::SP, 0x7E62);
    WriteRegisterByte(RegisterType::A, 0x2C);
    WriteRegisterByte(RegisterType::B, 0x8B);
    WriteRegisterByte(RegisterType::C, 0x0D);
    WriteRegisterByte(RegisterType::D, 0xE3);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0x07);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7ED4, 0xD1);
    WriteMemory(0x7E63, 0xAF);
    WriteMemory(0x7E62, 0x96);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2C);
    CheckRegisterByte(RegisterType::B, 0x8B);
    CheckRegisterByte(RegisterType::C, 0x0D);
    CheckRegisterByte(RegisterType::D, 0xAF);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0x07);
    CheckRegisterWord(RegisterType::PC, 0x7ED5);
    CheckRegisterWord(RegisterType::SP, 0x7E64);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7E62, 0x96);
    CheckMemory(0x7E63, 0xAF);
    CheckMemory(0x7ED4, 0xD1);
}

void test_D1_0359()
{
    if (skip_test_D1_0359)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB562);
    WriteRegisterWord(RegisterType::SP, 0x43EC);
    WriteRegisterByte(RegisterType::A, 0x6E);
    WriteRegisterByte(RegisterType::B, 0x66);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0xBE);
    WriteRegisterByte(RegisterType::E, 0xED);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x04);
    WriteRegisterByte(RegisterType::L, 0x63);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB562, 0xD1);
    WriteMemory(0x43ED, 0x9C);
    WriteMemory(0x43EC, 0xAB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6E);
    CheckRegisterByte(RegisterType::B, 0x66);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0x9C);
    CheckRegisterByte(RegisterType::E, 0xAB);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x04);
    CheckRegisterByte(RegisterType::L, 0x63);
    CheckRegisterWord(RegisterType::PC, 0xB563);
    CheckRegisterWord(RegisterType::SP, 0x43EE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x43EC, 0xAB);
    CheckMemory(0x43ED, 0x9C);
    CheckMemory(0xB562, 0xD1);
}

void test_D1_035A()
{
    if (skip_test_D1_035A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCF23);
    WriteRegisterWord(RegisterType::SP, 0xC550);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0x82);
    WriteRegisterByte(RegisterType::D, 0xBC);
    WriteRegisterByte(RegisterType::E, 0x89);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0x10);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCF23, 0xD1);
    WriteMemory(0xC551, 0x7A);
    WriteMemory(0xC550, 0x59);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0x82);
    CheckRegisterByte(RegisterType::D, 0x7A);
    CheckRegisterByte(RegisterType::E, 0x59);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0x10);
    CheckRegisterWord(RegisterType::PC, 0xCF24);
    CheckRegisterWord(RegisterType::SP, 0xC552);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC550, 0x59);
    CheckMemory(0xC551, 0x7A);
    CheckMemory(0xCF23, 0xD1);
}

void test_D1_035B()
{
    if (skip_test_D1_035B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x14CB);
    WriteRegisterWord(RegisterType::SP, 0x4B84);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0xC9);
    WriteRegisterByte(RegisterType::C, 0x2C);
    WriteRegisterByte(RegisterType::D, 0x29);
    WriteRegisterByte(RegisterType::E, 0xA3);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x9B);
    WriteRegisterByte(RegisterType::L, 0xE8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4B85, 0xB9);
    WriteMemory(0x4B84, 0x86);
    WriteMemory(0x14CB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0xC9);
    CheckRegisterByte(RegisterType::C, 0x2C);
    CheckRegisterByte(RegisterType::D, 0xB9);
    CheckRegisterByte(RegisterType::E, 0x86);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x9B);
    CheckRegisterByte(RegisterType::L, 0xE8);
    CheckRegisterWord(RegisterType::PC, 0x14CC);
    CheckRegisterWord(RegisterType::SP, 0x4B86);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x14CB, 0xD1);
    CheckMemory(0x4B84, 0x86);
    CheckMemory(0x4B85, 0xB9);
}

void test_D1_035C()
{
    if (skip_test_D1_035C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3B8D);
    WriteRegisterWord(RegisterType::SP, 0xE600);
    WriteRegisterByte(RegisterType::A, 0xC4);
    WriteRegisterByte(RegisterType::B, 0x04);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0x95);
    WriteRegisterByte(RegisterType::E, 0xE3);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x81);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE601, 0xD5);
    WriteMemory(0xE600, 0x2D);
    WriteMemory(0x3B8D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC4);
    CheckRegisterByte(RegisterType::B, 0x04);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0xD5);
    CheckRegisterByte(RegisterType::E, 0x2D);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x81);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0x3B8E);
    CheckRegisterWord(RegisterType::SP, 0xE602);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3B8D, 0xD1);
    CheckMemory(0xE600, 0x2D);
    CheckMemory(0xE601, 0xD5);
}

void test_D1_035D()
{
    if (skip_test_D1_035D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x59B1);
    WriteRegisterWord(RegisterType::SP, 0x6447);
    WriteRegisterByte(RegisterType::A, 0x01);
    WriteRegisterByte(RegisterType::B, 0x12);
    WriteRegisterByte(RegisterType::C, 0xFA);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0xC8);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xDC);
    WriteRegisterByte(RegisterType::L, 0x70);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6448, 0x91);
    WriteMemory(0x6447, 0x04);
    WriteMemory(0x59B1, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x01);
    CheckRegisterByte(RegisterType::B, 0x12);
    CheckRegisterByte(RegisterType::C, 0xFA);
    CheckRegisterByte(RegisterType::D, 0x91);
    CheckRegisterByte(RegisterType::E, 0x04);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xDC);
    CheckRegisterByte(RegisterType::L, 0x70);
    CheckRegisterWord(RegisterType::PC, 0x59B2);
    CheckRegisterWord(RegisterType::SP, 0x6449);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x59B1, 0xD1);
    CheckMemory(0x6447, 0x04);
    CheckMemory(0x6448, 0x91);
}

void test_D1_035E()
{
    if (skip_test_D1_035E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x62CE);
    WriteRegisterWord(RegisterType::SP, 0x1726);
    WriteRegisterByte(RegisterType::A, 0xF8);
    WriteRegisterByte(RegisterType::B, 0x8C);
    WriteRegisterByte(RegisterType::C, 0x7D);
    WriteRegisterByte(RegisterType::D, 0x97);
    WriteRegisterByte(RegisterType::E, 0x3F);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x5D);
    WriteRegisterByte(RegisterType::L, 0x7E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x62CE, 0xD1);
    WriteMemory(0x1727, 0x6A);
    WriteMemory(0x1726, 0x78);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF8);
    CheckRegisterByte(RegisterType::B, 0x8C);
    CheckRegisterByte(RegisterType::C, 0x7D);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0x78);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x5D);
    CheckRegisterByte(RegisterType::L, 0x7E);
    CheckRegisterWord(RegisterType::PC, 0x62CF);
    CheckRegisterWord(RegisterType::SP, 0x1728);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1726, 0x78);
    CheckMemory(0x1727, 0x6A);
    CheckMemory(0x62CE, 0xD1);
}

void test_D1_035F()
{
    if (skip_test_D1_035F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC02E);
    WriteRegisterWord(RegisterType::SP, 0x2C6E);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0x2A);
    WriteRegisterByte(RegisterType::C, 0x34);
    WriteRegisterByte(RegisterType::D, 0xBA);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x57);
    WriteRegisterByte(RegisterType::L, 0x28);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC02E, 0xD1);
    WriteMemory(0x2C6F, 0xAA);
    WriteMemory(0x2C6E, 0x12);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0x2A);
    CheckRegisterByte(RegisterType::C, 0x34);
    CheckRegisterByte(RegisterType::D, 0xAA);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x57);
    CheckRegisterByte(RegisterType::L, 0x28);
    CheckRegisterWord(RegisterType::PC, 0xC02F);
    CheckRegisterWord(RegisterType::SP, 0x2C70);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2C6E, 0x12);
    CheckMemory(0x2C6F, 0xAA);
    CheckMemory(0xC02E, 0xD1);
}

void test_D1_0360()
{
    if (skip_test_D1_0360)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x09FB);
    WriteRegisterWord(RegisterType::SP, 0xE1E4);
    WriteRegisterByte(RegisterType::A, 0x99);
    WriteRegisterByte(RegisterType::B, 0x00);
    WriteRegisterByte(RegisterType::C, 0x0A);
    WriteRegisterByte(RegisterType::D, 0x89);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x64);
    WriteRegisterByte(RegisterType::L, 0x9A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE1E5, 0xFD);
    WriteMemory(0xE1E4, 0xEE);
    WriteMemory(0x09FB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x99);
    CheckRegisterByte(RegisterType::B, 0x00);
    CheckRegisterByte(RegisterType::C, 0x0A);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0xEE);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x64);
    CheckRegisterByte(RegisterType::L, 0x9A);
    CheckRegisterWord(RegisterType::PC, 0x09FC);
    CheckRegisterWord(RegisterType::SP, 0xE1E6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x09FB, 0xD1);
    CheckMemory(0xE1E4, 0xEE);
    CheckMemory(0xE1E5, 0xFD);
}

void test_D1_0361()
{
    if (skip_test_D1_0361)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8DB9);
    WriteRegisterWord(RegisterType::SP, 0xB26D);
    WriteRegisterByte(RegisterType::A, 0xFF);
    WriteRegisterByte(RegisterType::B, 0x66);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0x9B);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x25);
    WriteRegisterByte(RegisterType::L, 0x16);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB26E, 0x65);
    WriteMemory(0xB26D, 0xE0);
    WriteMemory(0x8DB9, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFF);
    CheckRegisterByte(RegisterType::B, 0x66);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0xE0);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x25);
    CheckRegisterByte(RegisterType::L, 0x16);
    CheckRegisterWord(RegisterType::PC, 0x8DBA);
    CheckRegisterWord(RegisterType::SP, 0xB26F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8DB9, 0xD1);
    CheckMemory(0xB26D, 0xE0);
    CheckMemory(0xB26E, 0x65);
}

void test_D1_0362()
{
    if (skip_test_D1_0362)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x986B);
    WriteRegisterWord(RegisterType::SP, 0x7530);
    WriteRegisterByte(RegisterType::A, 0x96);
    WriteRegisterByte(RegisterType::B, 0x7E);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0xA0);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x90);
    WriteRegisterByte(RegisterType::L, 0x2C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x986B, 0xD1);
    WriteMemory(0x7531, 0x23);
    WriteMemory(0x7530, 0xB5);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x96);
    CheckRegisterByte(RegisterType::B, 0x7E);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0xB5);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x90);
    CheckRegisterByte(RegisterType::L, 0x2C);
    CheckRegisterWord(RegisterType::PC, 0x986C);
    CheckRegisterWord(RegisterType::SP, 0x7532);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7530, 0xB5);
    CheckMemory(0x7531, 0x23);
    CheckMemory(0x986B, 0xD1);
}

void test_D1_0363()
{
    if (skip_test_D1_0363)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7D99);
    WriteRegisterWord(RegisterType::SP, 0xCCB6);
    WriteRegisterByte(RegisterType::A, 0xA6);
    WriteRegisterByte(RegisterType::B, 0x58);
    WriteRegisterByte(RegisterType::C, 0x2E);
    WriteRegisterByte(RegisterType::D, 0x07);
    WriteRegisterByte(RegisterType::E, 0x80);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xCA);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCCB7, 0xD8);
    WriteMemory(0xCCB6, 0xD9);
    WriteMemory(0x7D99, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA6);
    CheckRegisterByte(RegisterType::B, 0x58);
    CheckRegisterByte(RegisterType::C, 0x2E);
    CheckRegisterByte(RegisterType::D, 0xD8);
    CheckRegisterByte(RegisterType::E, 0xD9);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xCA);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0x7D9A);
    CheckRegisterWord(RegisterType::SP, 0xCCB8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7D99, 0xD1);
    CheckMemory(0xCCB6, 0xD9);
    CheckMemory(0xCCB7, 0xD8);
}

void test_D1_0364()
{
    if (skip_test_D1_0364)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x44F0);
    WriteRegisterWord(RegisterType::SP, 0x9D65);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0x7E);
    WriteRegisterByte(RegisterType::C, 0x51);
    WriteRegisterByte(RegisterType::D, 0x3B);
    WriteRegisterByte(RegisterType::E, 0xF4);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x8C);
    WriteRegisterByte(RegisterType::L, 0xA5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9D66, 0x2A);
    WriteMemory(0x9D65, 0xF4);
    WriteMemory(0x44F0, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0x7E);
    CheckRegisterByte(RegisterType::C, 0x51);
    CheckRegisterByte(RegisterType::D, 0x2A);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x8C);
    CheckRegisterByte(RegisterType::L, 0xA5);
    CheckRegisterWord(RegisterType::PC, 0x44F1);
    CheckRegisterWord(RegisterType::SP, 0x9D67);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x44F0, 0xD1);
    CheckMemory(0x9D65, 0xF4);
    CheckMemory(0x9D66, 0x2A);
}

void test_D1_0365()
{
    if (skip_test_D1_0365)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5475);
    WriteRegisterWord(RegisterType::SP, 0x19CF);
    WriteRegisterByte(RegisterType::A, 0x73);
    WriteRegisterByte(RegisterType::B, 0x7A);
    WriteRegisterByte(RegisterType::C, 0x1C);
    WriteRegisterByte(RegisterType::D, 0xBE);
    WriteRegisterByte(RegisterType::E, 0x2F);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x2D);
    WriteRegisterByte(RegisterType::L, 0x6A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5475, 0xD1);
    WriteMemory(0x19D0, 0xB1);
    WriteMemory(0x19CF, 0xB4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x73);
    CheckRegisterByte(RegisterType::B, 0x7A);
    CheckRegisterByte(RegisterType::C, 0x1C);
    CheckRegisterByte(RegisterType::D, 0xB1);
    CheckRegisterByte(RegisterType::E, 0xB4);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x2D);
    CheckRegisterByte(RegisterType::L, 0x6A);
    CheckRegisterWord(RegisterType::PC, 0x5476);
    CheckRegisterWord(RegisterType::SP, 0x19D1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x19CF, 0xB4);
    CheckMemory(0x19D0, 0xB1);
    CheckMemory(0x5475, 0xD1);
}

void test_D1_0366()
{
    if (skip_test_D1_0366)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x47F3);
    WriteRegisterWord(RegisterType::SP, 0x2463);
    WriteRegisterByte(RegisterType::A, 0xAD);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0x52);
    WriteRegisterByte(RegisterType::D, 0x7E);
    WriteRegisterByte(RegisterType::E, 0xCF);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xB2);
    WriteRegisterByte(RegisterType::L, 0x95);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x47F3, 0xD1);
    WriteMemory(0x2464, 0x09);
    WriteMemory(0x2463, 0x0C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAD);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0x52);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0x0C);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xB2);
    CheckRegisterByte(RegisterType::L, 0x95);
    CheckRegisterWord(RegisterType::PC, 0x47F4);
    CheckRegisterWord(RegisterType::SP, 0x2465);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2463, 0x0C);
    CheckMemory(0x2464, 0x09);
    CheckMemory(0x47F3, 0xD1);
}

void test_D1_0367()
{
    if (skip_test_D1_0367)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD7EF);
    WriteRegisterWord(RegisterType::SP, 0x13F0);
    WriteRegisterByte(RegisterType::A, 0xD6);
    WriteRegisterByte(RegisterType::B, 0xCE);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0x1F);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xEA);
    WriteRegisterByte(RegisterType::L, 0xF6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD7EF, 0xD1);
    WriteMemory(0x13F1, 0x57);
    WriteMemory(0x13F0, 0x6C);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD6);
    CheckRegisterByte(RegisterType::B, 0xCE);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0x57);
    CheckRegisterByte(RegisterType::E, 0x6C);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xEA);
    CheckRegisterByte(RegisterType::L, 0xF6);
    CheckRegisterWord(RegisterType::PC, 0xD7F0);
    CheckRegisterWord(RegisterType::SP, 0x13F2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x13F0, 0x6C);
    CheckMemory(0x13F1, 0x57);
    CheckMemory(0xD7EF, 0xD1);
}

void test_D1_0368()
{
    if (skip_test_D1_0368)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x427A);
    WriteRegisterWord(RegisterType::SP, 0x555B);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0x89);
    WriteRegisterByte(RegisterType::C, 0x24);
    WriteRegisterByte(RegisterType::D, 0xC4);
    WriteRegisterByte(RegisterType::E, 0x8C);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0x1F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x555C, 0x8F);
    WriteMemory(0x555B, 0xC2);
    WriteMemory(0x427A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0x89);
    CheckRegisterByte(RegisterType::C, 0x24);
    CheckRegisterByte(RegisterType::D, 0x8F);
    CheckRegisterByte(RegisterType::E, 0xC2);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0x1F);
    CheckRegisterWord(RegisterType::PC, 0x427B);
    CheckRegisterWord(RegisterType::SP, 0x555D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x427A, 0xD1);
    CheckMemory(0x555B, 0xC2);
    CheckMemory(0x555C, 0x8F);
}

void test_D1_0369()
{
    if (skip_test_D1_0369)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6B79);
    WriteRegisterWord(RegisterType::SP, 0xBA83);
    WriteRegisterByte(RegisterType::A, 0x7F);
    WriteRegisterByte(RegisterType::B, 0x5E);
    WriteRegisterByte(RegisterType::C, 0x45);
    WriteRegisterByte(RegisterType::D, 0xEF);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xD3);
    WriteRegisterByte(RegisterType::L, 0x35);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBA84, 0x9D);
    WriteMemory(0xBA83, 0x64);
    WriteMemory(0x6B79, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7F);
    CheckRegisterByte(RegisterType::B, 0x5E);
    CheckRegisterByte(RegisterType::C, 0x45);
    CheckRegisterByte(RegisterType::D, 0x9D);
    CheckRegisterByte(RegisterType::E, 0x64);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xD3);
    CheckRegisterByte(RegisterType::L, 0x35);
    CheckRegisterWord(RegisterType::PC, 0x6B7A);
    CheckRegisterWord(RegisterType::SP, 0xBA85);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6B79, 0xD1);
    CheckMemory(0xBA83, 0x64);
    CheckMemory(0xBA84, 0x9D);
}

void test_D1_036A()
{
    if (skip_test_D1_036A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8788);
    WriteRegisterWord(RegisterType::SP, 0xE1E2);
    WriteRegisterByte(RegisterType::A, 0x6D);
    WriteRegisterByte(RegisterType::B, 0x84);
    WriteRegisterByte(RegisterType::C, 0xF8);
    WriteRegisterByte(RegisterType::D, 0x86);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0x93);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE1E3, 0xE8);
    WriteMemory(0xE1E2, 0xF3);
    WriteMemory(0x8788, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6D);
    CheckRegisterByte(RegisterType::B, 0x84);
    CheckRegisterByte(RegisterType::C, 0xF8);
    CheckRegisterByte(RegisterType::D, 0xE8);
    CheckRegisterByte(RegisterType::E, 0xF3);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0x93);
    CheckRegisterWord(RegisterType::PC, 0x8789);
    CheckRegisterWord(RegisterType::SP, 0xE1E4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8788, 0xD1);
    CheckMemory(0xE1E2, 0xF3);
    CheckMemory(0xE1E3, 0xE8);
}

void test_D1_036B()
{
    if (skip_test_D1_036B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x99A3);
    WriteRegisterWord(RegisterType::SP, 0x955D);
    WriteRegisterByte(RegisterType::A, 0x1F);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x75);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0xE4);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x6A);
    WriteRegisterByte(RegisterType::L, 0x10);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x99A3, 0xD1);
    WriteMemory(0x955E, 0xB5);
    WriteMemory(0x955D, 0x22);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1F);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x75);
    CheckRegisterByte(RegisterType::D, 0xB5);
    CheckRegisterByte(RegisterType::E, 0x22);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x6A);
    CheckRegisterByte(RegisterType::L, 0x10);
    CheckRegisterWord(RegisterType::PC, 0x99A4);
    CheckRegisterWord(RegisterType::SP, 0x955F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x955D, 0x22);
    CheckMemory(0x955E, 0xB5);
    CheckMemory(0x99A3, 0xD1);
}

void test_D1_036C()
{
    if (skip_test_D1_036C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD441);
    WriteRegisterWord(RegisterType::SP, 0xA569);
    WriteRegisterByte(RegisterType::A, 0x4B);
    WriteRegisterByte(RegisterType::B, 0x03);
    WriteRegisterByte(RegisterType::C, 0xAB);
    WriteRegisterByte(RegisterType::D, 0x84);
    WriteRegisterByte(RegisterType::E, 0xB2);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xF2);
    WriteRegisterByte(RegisterType::L, 0xFD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD441, 0xD1);
    WriteMemory(0xA56A, 0x98);
    WriteMemory(0xA569, 0x73);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4B);
    CheckRegisterByte(RegisterType::B, 0x03);
    CheckRegisterByte(RegisterType::C, 0xAB);
    CheckRegisterByte(RegisterType::D, 0x98);
    CheckRegisterByte(RegisterType::E, 0x73);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xF2);
    CheckRegisterByte(RegisterType::L, 0xFD);
    CheckRegisterWord(RegisterType::PC, 0xD442);
    CheckRegisterWord(RegisterType::SP, 0xA56B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA569, 0x73);
    CheckMemory(0xA56A, 0x98);
    CheckMemory(0xD441, 0xD1);
}

void test_D1_036D()
{
    if (skip_test_D1_036D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9E6F);
    WriteRegisterWord(RegisterType::SP, 0x5902);
    WriteRegisterByte(RegisterType::A, 0x74);
    WriteRegisterByte(RegisterType::B, 0xA0);
    WriteRegisterByte(RegisterType::C, 0x1E);
    WriteRegisterByte(RegisterType::D, 0x98);
    WriteRegisterByte(RegisterType::E, 0x27);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x42);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x9E6F, 0xD1);
    WriteMemory(0x5903, 0x06);
    WriteMemory(0x5902, 0xB4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x74);
    CheckRegisterByte(RegisterType::B, 0xA0);
    CheckRegisterByte(RegisterType::C, 0x1E);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0xB4);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x42);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0x9E70);
    CheckRegisterWord(RegisterType::SP, 0x5904);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5902, 0xB4);
    CheckMemory(0x5903, 0x06);
    CheckMemory(0x9E6F, 0xD1);
}

void test_D1_036E()
{
    if (skip_test_D1_036E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2F28);
    WriteRegisterWord(RegisterType::SP, 0x5920);
    WriteRegisterByte(RegisterType::A, 0x5F);
    WriteRegisterByte(RegisterType::B, 0xF8);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0x50);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xF4);
    WriteRegisterByte(RegisterType::L, 0x7C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5921, 0xC2);
    WriteMemory(0x5920, 0x41);
    WriteMemory(0x2F28, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5F);
    CheckRegisterByte(RegisterType::B, 0xF8);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0xC2);
    CheckRegisterByte(RegisterType::E, 0x41);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xF4);
    CheckRegisterByte(RegisterType::L, 0x7C);
    CheckRegisterWord(RegisterType::PC, 0x2F29);
    CheckRegisterWord(RegisterType::SP, 0x5922);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2F28, 0xD1);
    CheckMemory(0x5920, 0x41);
    CheckMemory(0x5921, 0xC2);
}

void test_D1_036F()
{
    if (skip_test_D1_036F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1FC3);
    WriteRegisterWord(RegisterType::SP, 0xC3E3);
    WriteRegisterByte(RegisterType::A, 0x8A);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0x60);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0x2F);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0x5F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC3E4, 0xBB);
    WriteMemory(0xC3E3, 0x3D);
    WriteMemory(0x1FC3, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8A);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0x60);
    CheckRegisterByte(RegisterType::D, 0xBB);
    CheckRegisterByte(RegisterType::E, 0x3D);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0x5F);
    CheckRegisterWord(RegisterType::PC, 0x1FC4);
    CheckRegisterWord(RegisterType::SP, 0xC3E5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1FC3, 0xD1);
    CheckMemory(0xC3E3, 0x3D);
    CheckMemory(0xC3E4, 0xBB);
}

void test_D1_0370()
{
    if (skip_test_D1_0370)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9898);
    WriteRegisterWord(RegisterType::SP, 0xE5B2);
    WriteRegisterByte(RegisterType::A, 0xED);
    WriteRegisterByte(RegisterType::B, 0xFD);
    WriteRegisterByte(RegisterType::C, 0xEB);
    WriteRegisterByte(RegisterType::D, 0x56);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x38);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE5B3, 0x95);
    WriteMemory(0xE5B2, 0x16);
    WriteMemory(0x9898, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xED);
    CheckRegisterByte(RegisterType::B, 0xFD);
    CheckRegisterByte(RegisterType::C, 0xEB);
    CheckRegisterByte(RegisterType::D, 0x95);
    CheckRegisterByte(RegisterType::E, 0x16);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x38);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0x9899);
    CheckRegisterWord(RegisterType::SP, 0xE5B4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9898, 0xD1);
    CheckMemory(0xE5B2, 0x16);
    CheckMemory(0xE5B3, 0x95);
}

void test_D1_0371()
{
    if (skip_test_D1_0371)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2637);
    WriteRegisterWord(RegisterType::SP, 0x6B69);
    WriteRegisterByte(RegisterType::A, 0x40);
    WriteRegisterByte(RegisterType::B, 0x34);
    WriteRegisterByte(RegisterType::C, 0x28);
    WriteRegisterByte(RegisterType::D, 0x56);
    WriteRegisterByte(RegisterType::E, 0xE4);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xBF);
    WriteRegisterByte(RegisterType::L, 0x83);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6B6A, 0x71);
    WriteMemory(0x6B69, 0xDD);
    WriteMemory(0x2637, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x40);
    CheckRegisterByte(RegisterType::B, 0x34);
    CheckRegisterByte(RegisterType::C, 0x28);
    CheckRegisterByte(RegisterType::D, 0x71);
    CheckRegisterByte(RegisterType::E, 0xDD);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xBF);
    CheckRegisterByte(RegisterType::L, 0x83);
    CheckRegisterWord(RegisterType::PC, 0x2638);
    CheckRegisterWord(RegisterType::SP, 0x6B6B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2637, 0xD1);
    CheckMemory(0x6B69, 0xDD);
    CheckMemory(0x6B6A, 0x71);
}

void test_D1_0372()
{
    if (skip_test_D1_0372)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8540);
    WriteRegisterWord(RegisterType::SP, 0xD6B6);
    WriteRegisterByte(RegisterType::A, 0x8C);
    WriteRegisterByte(RegisterType::B, 0xB5);
    WriteRegisterByte(RegisterType::C, 0x82);
    WriteRegisterByte(RegisterType::D, 0x27);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x2A);
    WriteRegisterByte(RegisterType::L, 0x7F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD6B7, 0x69);
    WriteMemory(0xD6B6, 0xC3);
    WriteMemory(0x8540, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8C);
    CheckRegisterByte(RegisterType::B, 0xB5);
    CheckRegisterByte(RegisterType::C, 0x82);
    CheckRegisterByte(RegisterType::D, 0x69);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x2A);
    CheckRegisterByte(RegisterType::L, 0x7F);
    CheckRegisterWord(RegisterType::PC, 0x8541);
    CheckRegisterWord(RegisterType::SP, 0xD6B8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8540, 0xD1);
    CheckMemory(0xD6B6, 0xC3);
    CheckMemory(0xD6B7, 0x69);
}

void test_D1_0373()
{
    if (skip_test_D1_0373)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7C32);
    WriteRegisterWord(RegisterType::SP, 0xC705);
    WriteRegisterByte(RegisterType::A, 0x9D);
    WriteRegisterByte(RegisterType::B, 0xC0);
    WriteRegisterByte(RegisterType::C, 0x1D);
    WriteRegisterByte(RegisterType::D, 0x15);
    WriteRegisterByte(RegisterType::E, 0x1D);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x69);
    WriteRegisterByte(RegisterType::L, 0x49);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC706, 0x07);
    WriteMemory(0xC705, 0x8E);
    WriteMemory(0x7C32, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9D);
    CheckRegisterByte(RegisterType::B, 0xC0);
    CheckRegisterByte(RegisterType::C, 0x1D);
    CheckRegisterByte(RegisterType::D, 0x07);
    CheckRegisterByte(RegisterType::E, 0x8E);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x69);
    CheckRegisterByte(RegisterType::L, 0x49);
    CheckRegisterWord(RegisterType::PC, 0x7C33);
    CheckRegisterWord(RegisterType::SP, 0xC707);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7C32, 0xD1);
    CheckMemory(0xC705, 0x8E);
    CheckMemory(0xC706, 0x07);
}

void test_D1_0374()
{
    if (skip_test_D1_0374)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC370);
    WriteRegisterWord(RegisterType::SP, 0xCB20);
    WriteRegisterByte(RegisterType::A, 0xC4);
    WriteRegisterByte(RegisterType::B, 0xA1);
    WriteRegisterByte(RegisterType::C, 0x1C);
    WriteRegisterByte(RegisterType::D, 0x60);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xBB);
    WriteRegisterByte(RegisterType::L, 0xCB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCB21, 0xA2);
    WriteMemory(0xCB20, 0x68);
    WriteMemory(0xC370, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC4);
    CheckRegisterByte(RegisterType::B, 0xA1);
    CheckRegisterByte(RegisterType::C, 0x1C);
    CheckRegisterByte(RegisterType::D, 0xA2);
    CheckRegisterByte(RegisterType::E, 0x68);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xBB);
    CheckRegisterByte(RegisterType::L, 0xCB);
    CheckRegisterWord(RegisterType::PC, 0xC371);
    CheckRegisterWord(RegisterType::SP, 0xCB22);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC370, 0xD1);
    CheckMemory(0xCB20, 0x68);
    CheckMemory(0xCB21, 0xA2);
}

void test_D1_0375()
{
    if (skip_test_D1_0375)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD70);
    WriteRegisterWord(RegisterType::SP, 0x01CD);
    WriteRegisterByte(RegisterType::A, 0x5A);
    WriteRegisterByte(RegisterType::B, 0x36);
    WriteRegisterByte(RegisterType::C, 0x5F);
    WriteRegisterByte(RegisterType::D, 0x2A);
    WriteRegisterByte(RegisterType::E, 0x26);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCD70, 0xD1);
    WriteMemory(0x01CE, 0x3C);
    WriteMemory(0x01CD, 0x9D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5A);
    CheckRegisterByte(RegisterType::B, 0x36);
    CheckRegisterByte(RegisterType::C, 0x5F);
    CheckRegisterByte(RegisterType::D, 0x3C);
    CheckRegisterByte(RegisterType::E, 0x9D);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0xCD71);
    CheckRegisterWord(RegisterType::SP, 0x01CF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x01CD, 0x9D);
    CheckMemory(0x01CE, 0x3C);
    CheckMemory(0xCD70, 0xD1);
}

void test_D1_0376()
{
    if (skip_test_D1_0376)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFE96);
    WriteRegisterWord(RegisterType::SP, 0xE85E);
    WriteRegisterByte(RegisterType::A, 0x77);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0xF7);
    WriteRegisterByte(RegisterType::D, 0x98);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x1E);
    WriteRegisterByte(RegisterType::L, 0x1B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFE96, 0xD1);
    WriteMemory(0xE85F, 0xFD);
    WriteMemory(0xE85E, 0x59);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x77);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0xF7);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0x59);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x1E);
    CheckRegisterByte(RegisterType::L, 0x1B);
    CheckRegisterWord(RegisterType::PC, 0xFE97);
    CheckRegisterWord(RegisterType::SP, 0xE860);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE85E, 0x59);
    CheckMemory(0xE85F, 0xFD);
    CheckMemory(0xFE96, 0xD1);
}

void test_D1_0377()
{
    if (skip_test_D1_0377)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDD5C);
    WriteRegisterWord(RegisterType::SP, 0xADE6);
    WriteRegisterByte(RegisterType::A, 0x91);
    WriteRegisterByte(RegisterType::B, 0x41);
    WriteRegisterByte(RegisterType::C, 0xD3);
    WriteRegisterByte(RegisterType::D, 0x62);
    WriteRegisterByte(RegisterType::E, 0x56);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x5F);
    WriteRegisterByte(RegisterType::L, 0x6B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xDD5C, 0xD1);
    WriteMemory(0xADE7, 0x2A);
    WriteMemory(0xADE6, 0x88);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x91);
    CheckRegisterByte(RegisterType::B, 0x41);
    CheckRegisterByte(RegisterType::C, 0xD3);
    CheckRegisterByte(RegisterType::D, 0x2A);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x5F);
    CheckRegisterByte(RegisterType::L, 0x6B);
    CheckRegisterWord(RegisterType::PC, 0xDD5D);
    CheckRegisterWord(RegisterType::SP, 0xADE8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xADE6, 0x88);
    CheckMemory(0xADE7, 0x2A);
    CheckMemory(0xDD5C, 0xD1);
}

void test_D1_0378()
{
    if (skip_test_D1_0378)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3FE3);
    WriteRegisterWord(RegisterType::SP, 0xA41F);
    WriteRegisterByte(RegisterType::A, 0xAB);
    WriteRegisterByte(RegisterType::B, 0xDC);
    WriteRegisterByte(RegisterType::C, 0x1A);
    WriteRegisterByte(RegisterType::D, 0x19);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x27);
    WriteRegisterByte(RegisterType::L, 0x51);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA420, 0xF5);
    WriteMemory(0xA41F, 0xEE);
    WriteMemory(0x3FE3, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAB);
    CheckRegisterByte(RegisterType::B, 0xDC);
    CheckRegisterByte(RegisterType::C, 0x1A);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0xEE);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x27);
    CheckRegisterByte(RegisterType::L, 0x51);
    CheckRegisterWord(RegisterType::PC, 0x3FE4);
    CheckRegisterWord(RegisterType::SP, 0xA421);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3FE3, 0xD1);
    CheckMemory(0xA41F, 0xEE);
    CheckMemory(0xA420, 0xF5);
}

void test_D1_0379()
{
    if (skip_test_D1_0379)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7918);
    WriteRegisterWord(RegisterType::SP, 0x0AA2);
    WriteRegisterByte(RegisterType::A, 0xEE);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0x1B);
    WriteRegisterByte(RegisterType::E, 0x61);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7918, 0xD1);
    WriteMemory(0x0AA3, 0x5E);
    WriteMemory(0x0AA2, 0xC7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEE);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0x5E);
    CheckRegisterByte(RegisterType::E, 0xC7);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0x7919);
    CheckRegisterWord(RegisterType::SP, 0x0AA4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0AA2, 0xC7);
    CheckMemory(0x0AA3, 0x5E);
    CheckMemory(0x7918, 0xD1);
}

void test_D1_037A()
{
    if (skip_test_D1_037A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0490);
    WriteRegisterWord(RegisterType::SP, 0x7867);
    WriteRegisterByte(RegisterType::A, 0x4E);
    WriteRegisterByte(RegisterType::B, 0x78);
    WriteRegisterByte(RegisterType::C, 0xC3);
    WriteRegisterByte(RegisterType::D, 0x3B);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x69);
    WriteRegisterByte(RegisterType::L, 0x90);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7868, 0x59);
    WriteMemory(0x7867, 0x67);
    WriteMemory(0x0490, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4E);
    CheckRegisterByte(RegisterType::B, 0x78);
    CheckRegisterByte(RegisterType::C, 0xC3);
    CheckRegisterByte(RegisterType::D, 0x59);
    CheckRegisterByte(RegisterType::E, 0x67);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x69);
    CheckRegisterByte(RegisterType::L, 0x90);
    CheckRegisterWord(RegisterType::PC, 0x0491);
    CheckRegisterWord(RegisterType::SP, 0x7869);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0490, 0xD1);
    CheckMemory(0x7867, 0x67);
    CheckMemory(0x7868, 0x59);
}

void test_D1_037B()
{
    if (skip_test_D1_037B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE9F6);
    WriteRegisterWord(RegisterType::SP, 0x8F22);
    WriteRegisterByte(RegisterType::A, 0xA6);
    WriteRegisterByte(RegisterType::B, 0x2F);
    WriteRegisterByte(RegisterType::C, 0xA0);
    WriteRegisterByte(RegisterType::D, 0xF9);
    WriteRegisterByte(RegisterType::E, 0x37);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x56);
    WriteRegisterByte(RegisterType::L, 0xD9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE9F6, 0xD1);
    WriteMemory(0x8F23, 0x48);
    WriteMemory(0x8F22, 0x94);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA6);
    CheckRegisterByte(RegisterType::B, 0x2F);
    CheckRegisterByte(RegisterType::C, 0xA0);
    CheckRegisterByte(RegisterType::D, 0x48);
    CheckRegisterByte(RegisterType::E, 0x94);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x56);
    CheckRegisterByte(RegisterType::L, 0xD9);
    CheckRegisterWord(RegisterType::PC, 0xE9F7);
    CheckRegisterWord(RegisterType::SP, 0x8F24);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8F22, 0x94);
    CheckMemory(0x8F23, 0x48);
    CheckMemory(0xE9F6, 0xD1);
}

void test_D1_037C()
{
    if (skip_test_D1_037C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x573E);
    WriteRegisterWord(RegisterType::SP, 0x6CD3);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0x74);
    WriteRegisterByte(RegisterType::C, 0x11);
    WriteRegisterByte(RegisterType::D, 0xB9);
    WriteRegisterByte(RegisterType::E, 0x57);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x7D);
    WriteRegisterByte(RegisterType::L, 0xC1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6CD4, 0x12);
    WriteMemory(0x6CD3, 0xF4);
    WriteMemory(0x573E, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0x74);
    CheckRegisterByte(RegisterType::C, 0x11);
    CheckRegisterByte(RegisterType::D, 0x12);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x7D);
    CheckRegisterByte(RegisterType::L, 0xC1);
    CheckRegisterWord(RegisterType::PC, 0x573F);
    CheckRegisterWord(RegisterType::SP, 0x6CD5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x573E, 0xD1);
    CheckMemory(0x6CD3, 0xF4);
    CheckMemory(0x6CD4, 0x12);
}

void test_D1_037D()
{
    if (skip_test_D1_037D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x21E0);
    WriteRegisterWord(RegisterType::SP, 0x8C4C);
    WriteRegisterByte(RegisterType::A, 0x8F);
    WriteRegisterByte(RegisterType::B, 0xF3);
    WriteRegisterByte(RegisterType::C, 0x89);
    WriteRegisterByte(RegisterType::D, 0x52);
    WriteRegisterByte(RegisterType::E, 0x32);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x33);
    WriteRegisterByte(RegisterType::L, 0x3B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x8C4D, 0x10);
    WriteMemory(0x8C4C, 0x80);
    WriteMemory(0x21E0, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8F);
    CheckRegisterByte(RegisterType::B, 0xF3);
    CheckRegisterByte(RegisterType::C, 0x89);
    CheckRegisterByte(RegisterType::D, 0x10);
    CheckRegisterByte(RegisterType::E, 0x80);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x33);
    CheckRegisterByte(RegisterType::L, 0x3B);
    CheckRegisterWord(RegisterType::PC, 0x21E1);
    CheckRegisterWord(RegisterType::SP, 0x8C4E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x21E0, 0xD1);
    CheckMemory(0x8C4C, 0x80);
    CheckMemory(0x8C4D, 0x10);
}

void test_D1_037E()
{
    if (skip_test_D1_037E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFD7E);
    WriteRegisterWord(RegisterType::SP, 0xA0C4);
    WriteRegisterByte(RegisterType::A, 0x80);
    WriteRegisterByte(RegisterType::B, 0x0B);
    WriteRegisterByte(RegisterType::C, 0x43);
    WriteRegisterByte(RegisterType::D, 0x9B);
    WriteRegisterByte(RegisterType::E, 0x66);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x87);
    WriteRegisterByte(RegisterType::L, 0x3A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFD7E, 0xD1);
    WriteMemory(0xA0C5, 0x73);
    WriteMemory(0xA0C4, 0xC7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x80);
    CheckRegisterByte(RegisterType::B, 0x0B);
    CheckRegisterByte(RegisterType::C, 0x43);
    CheckRegisterByte(RegisterType::D, 0x73);
    CheckRegisterByte(RegisterType::E, 0xC7);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x87);
    CheckRegisterByte(RegisterType::L, 0x3A);
    CheckRegisterWord(RegisterType::PC, 0xFD7F);
    CheckRegisterWord(RegisterType::SP, 0xA0C6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA0C4, 0xC7);
    CheckMemory(0xA0C5, 0x73);
    CheckMemory(0xFD7E, 0xD1);
}

void test_D1_037F()
{
    if (skip_test_D1_037F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC695);
    WriteRegisterWord(RegisterType::SP, 0xD43F);
    WriteRegisterByte(RegisterType::A, 0x4A);
    WriteRegisterByte(RegisterType::B, 0x11);
    WriteRegisterByte(RegisterType::C, 0x79);
    WriteRegisterByte(RegisterType::D, 0x4F);
    WriteRegisterByte(RegisterType::E, 0x19);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xFB);
    WriteRegisterByte(RegisterType::L, 0xF9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD440, 0x27);
    WriteMemory(0xD43F, 0x84);
    WriteMemory(0xC695, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4A);
    CheckRegisterByte(RegisterType::B, 0x11);
    CheckRegisterByte(RegisterType::C, 0x79);
    CheckRegisterByte(RegisterType::D, 0x27);
    CheckRegisterByte(RegisterType::E, 0x84);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xFB);
    CheckRegisterByte(RegisterType::L, 0xF9);
    CheckRegisterWord(RegisterType::PC, 0xC696);
    CheckRegisterWord(RegisterType::SP, 0xD441);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC695, 0xD1);
    CheckMemory(0xD43F, 0x84);
    CheckMemory(0xD440, 0x27);
}

void test_D1_0380()
{
    if (skip_test_D1_0380)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD3F5);
    WriteRegisterWord(RegisterType::SP, 0x3B73);
    WriteRegisterByte(RegisterType::A, 0xE9);
    WriteRegisterByte(RegisterType::B, 0x72);
    WriteRegisterByte(RegisterType::C, 0xB1);
    WriteRegisterByte(RegisterType::D, 0xD7);
    WriteRegisterByte(RegisterType::E, 0xB4);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x96);
    WriteRegisterByte(RegisterType::L, 0xF7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD3F5, 0xD1);
    WriteMemory(0x3B74, 0x6A);
    WriteMemory(0x3B73, 0x0F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE9);
    CheckRegisterByte(RegisterType::B, 0x72);
    CheckRegisterByte(RegisterType::C, 0xB1);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0x0F);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x96);
    CheckRegisterByte(RegisterType::L, 0xF7);
    CheckRegisterWord(RegisterType::PC, 0xD3F6);
    CheckRegisterWord(RegisterType::SP, 0x3B75);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3B73, 0x0F);
    CheckMemory(0x3B74, 0x6A);
    CheckMemory(0xD3F5, 0xD1);
}

void test_D1_0381()
{
    if (skip_test_D1_0381)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x27E8);
    WriteRegisterWord(RegisterType::SP, 0x6DDC);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x5C);
    WriteRegisterByte(RegisterType::E, 0x8C);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0xA6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6DDD, 0xDA);
    WriteMemory(0x6DDC, 0x1B);
    WriteMemory(0x27E8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0xA6);
    CheckRegisterWord(RegisterType::PC, 0x27E9);
    CheckRegisterWord(RegisterType::SP, 0x6DDE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x27E8, 0xD1);
    CheckMemory(0x6DDC, 0x1B);
    CheckMemory(0x6DDD, 0xDA);
}

void test_D1_0382()
{
    if (skip_test_D1_0382)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x51C7);
    WriteRegisterWord(RegisterType::SP, 0xAAF7);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0xA3);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xF1);
    WriteRegisterByte(RegisterType::L, 0x44);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xAAF8, 0x30);
    WriteMemory(0xAAF7, 0xB9);
    WriteMemory(0x51C7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0x30);
    CheckRegisterByte(RegisterType::E, 0xB9);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xF1);
    CheckRegisterByte(RegisterType::L, 0x44);
    CheckRegisterWord(RegisterType::PC, 0x51C8);
    CheckRegisterWord(RegisterType::SP, 0xAAF9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x51C7, 0xD1);
    CheckMemory(0xAAF7, 0xB9);
    CheckMemory(0xAAF8, 0x30);
}

void test_D1_0383()
{
    if (skip_test_D1_0383)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA074);
    WriteRegisterWord(RegisterType::SP, 0xCDE9);
    WriteRegisterByte(RegisterType::A, 0x04);
    WriteRegisterByte(RegisterType::B, 0xF6);
    WriteRegisterByte(RegisterType::C, 0xDE);
    WriteRegisterByte(RegisterType::D, 0x53);
    WriteRegisterByte(RegisterType::E, 0x60);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x31);
    WriteRegisterByte(RegisterType::L, 0x99);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xCDEA, 0x97);
    WriteMemory(0xCDE9, 0x78);
    WriteMemory(0xA074, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x04);
    CheckRegisterByte(RegisterType::B, 0xF6);
    CheckRegisterByte(RegisterType::C, 0xDE);
    CheckRegisterByte(RegisterType::D, 0x97);
    CheckRegisterByte(RegisterType::E, 0x78);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x31);
    CheckRegisterByte(RegisterType::L, 0x99);
    CheckRegisterWord(RegisterType::PC, 0xA075);
    CheckRegisterWord(RegisterType::SP, 0xCDEB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA074, 0xD1);
    CheckMemory(0xCDE9, 0x78);
    CheckMemory(0xCDEA, 0x97);
}

void test_D1_0384()
{
    if (skip_test_D1_0384)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1C24);
    WriteRegisterWord(RegisterType::SP, 0x4790);
    WriteRegisterByte(RegisterType::A, 0x89);
    WriteRegisterByte(RegisterType::B, 0xB8);
    WriteRegisterByte(RegisterType::C, 0x3B);
    WriteRegisterByte(RegisterType::D, 0xA1);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0x74);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x4791, 0x7E);
    WriteMemory(0x4790, 0xB8);
    WriteMemory(0x1C24, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x89);
    CheckRegisterByte(RegisterType::B, 0xB8);
    CheckRegisterByte(RegisterType::C, 0x3B);
    CheckRegisterByte(RegisterType::D, 0x7E);
    CheckRegisterByte(RegisterType::E, 0xB8);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0x74);
    CheckRegisterWord(RegisterType::PC, 0x1C25);
    CheckRegisterWord(RegisterType::SP, 0x4792);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1C24, 0xD1);
    CheckMemory(0x4790, 0xB8);
    CheckMemory(0x4791, 0x7E);
}

void test_D1_0385()
{
    if (skip_test_D1_0385)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4B3B);
    WriteRegisterWord(RegisterType::SP, 0x3A14);
    WriteRegisterByte(RegisterType::A, 0x5C);
    WriteRegisterByte(RegisterType::B, 0xB2);
    WriteRegisterByte(RegisterType::C, 0xB5);
    WriteRegisterByte(RegisterType::D, 0xEC);
    WriteRegisterByte(RegisterType::E, 0xED);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x06);
    WriteRegisterByte(RegisterType::L, 0x99);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x4B3B, 0xD1);
    WriteMemory(0x3A15, 0x31);
    WriteMemory(0x3A14, 0x9D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5C);
    CheckRegisterByte(RegisterType::B, 0xB2);
    CheckRegisterByte(RegisterType::C, 0xB5);
    CheckRegisterByte(RegisterType::D, 0x31);
    CheckRegisterByte(RegisterType::E, 0x9D);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x06);
    CheckRegisterByte(RegisterType::L, 0x99);
    CheckRegisterWord(RegisterType::PC, 0x4B3C);
    CheckRegisterWord(RegisterType::SP, 0x3A16);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3A14, 0x9D);
    CheckMemory(0x3A15, 0x31);
    CheckMemory(0x4B3B, 0xD1);
}

void test_D1_0386()
{
    if (skip_test_D1_0386)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0B44);
    WriteRegisterWord(RegisterType::SP, 0x25F4);
    WriteRegisterByte(RegisterType::A, 0xDA);
    WriteRegisterByte(RegisterType::B, 0xB0);
    WriteRegisterByte(RegisterType::C, 0xFC);
    WriteRegisterByte(RegisterType::D, 0x1D);
    WriteRegisterByte(RegisterType::E, 0x1E);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0xD9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x25F5, 0xC6);
    WriteMemory(0x25F4, 0x31);
    WriteMemory(0x0B44, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDA);
    CheckRegisterByte(RegisterType::B, 0xB0);
    CheckRegisterByte(RegisterType::C, 0xFC);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0x31);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0xD9);
    CheckRegisterWord(RegisterType::PC, 0x0B45);
    CheckRegisterWord(RegisterType::SP, 0x25F6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0B44, 0xD1);
    CheckMemory(0x25F4, 0x31);
    CheckMemory(0x25F5, 0xC6);
}

void test_D1_0387()
{
    if (skip_test_D1_0387)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x90EC);
    WriteRegisterWord(RegisterType::SP, 0x45E4);
    WriteRegisterByte(RegisterType::A, 0x51);
    WriteRegisterByte(RegisterType::B, 0x08);
    WriteRegisterByte(RegisterType::C, 0xAC);
    WriteRegisterByte(RegisterType::D, 0xCA);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0xF5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x90EC, 0xD1);
    WriteMemory(0x45E5, 0xBA);
    WriteMemory(0x45E4, 0x76);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x51);
    CheckRegisterByte(RegisterType::B, 0x08);
    CheckRegisterByte(RegisterType::C, 0xAC);
    CheckRegisterByte(RegisterType::D, 0xBA);
    CheckRegisterByte(RegisterType::E, 0x76);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0xF5);
    CheckRegisterWord(RegisterType::PC, 0x90ED);
    CheckRegisterWord(RegisterType::SP, 0x45E6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x45E4, 0x76);
    CheckMemory(0x45E5, 0xBA);
    CheckMemory(0x90EC, 0xD1);
}

void test_D1_0388()
{
    if (skip_test_D1_0388)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x841D);
    WriteRegisterWord(RegisterType::SP, 0xC07A);
    WriteRegisterByte(RegisterType::A, 0x27);
    WriteRegisterByte(RegisterType::B, 0xF2);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0x94);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x25);
    WriteRegisterByte(RegisterType::L, 0x0B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC07B, 0xDA);
    WriteMemory(0xC07A, 0x07);
    WriteMemory(0x841D, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x27);
    CheckRegisterByte(RegisterType::B, 0xF2);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0x07);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x25);
    CheckRegisterByte(RegisterType::L, 0x0B);
    CheckRegisterWord(RegisterType::PC, 0x841E);
    CheckRegisterWord(RegisterType::SP, 0xC07C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x841D, 0xD1);
    CheckMemory(0xC07A, 0x07);
    CheckMemory(0xC07B, 0xDA);
}

void test_D1_0389()
{
    if (skip_test_D1_0389)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x660B);
    WriteRegisterWord(RegisterType::SP, 0x6B58);
    WriteRegisterByte(RegisterType::A, 0xBC);
    WriteRegisterByte(RegisterType::B, 0x4A);
    WriteRegisterByte(RegisterType::C, 0xBB);
    WriteRegisterByte(RegisterType::D, 0x7A);
    WriteRegisterByte(RegisterType::E, 0xC9);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0xAD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6B59, 0xB2);
    WriteMemory(0x6B58, 0x25);
    WriteMemory(0x660B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBC);
    CheckRegisterByte(RegisterType::B, 0x4A);
    CheckRegisterByte(RegisterType::C, 0xBB);
    CheckRegisterByte(RegisterType::D, 0xB2);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0xAD);
    CheckRegisterWord(RegisterType::PC, 0x660C);
    CheckRegisterWord(RegisterType::SP, 0x6B5A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x660B, 0xD1);
    CheckMemory(0x6B58, 0x25);
    CheckMemory(0x6B59, 0xB2);
}

void test_D1_038A()
{
    if (skip_test_D1_038A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD8D9);
    WriteRegisterWord(RegisterType::SP, 0x3AA4);
    WriteRegisterByte(RegisterType::A, 0x85);
    WriteRegisterByte(RegisterType::B, 0xAA);
    WriteRegisterByte(RegisterType::C, 0x10);
    WriteRegisterByte(RegisterType::D, 0xE4);
    WriteRegisterByte(RegisterType::E, 0x64);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xA0);
    WriteRegisterByte(RegisterType::L, 0xCC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD8D9, 0xD1);
    WriteMemory(0x3AA5, 0x53);
    WriteMemory(0x3AA4, 0xE8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x85);
    CheckRegisterByte(RegisterType::B, 0xAA);
    CheckRegisterByte(RegisterType::C, 0x10);
    CheckRegisterByte(RegisterType::D, 0x53);
    CheckRegisterByte(RegisterType::E, 0xE8);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xA0);
    CheckRegisterByte(RegisterType::L, 0xCC);
    CheckRegisterWord(RegisterType::PC, 0xD8DA);
    CheckRegisterWord(RegisterType::SP, 0x3AA6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3AA4, 0xE8);
    CheckMemory(0x3AA5, 0x53);
    CheckMemory(0xD8D9, 0xD1);
}

void test_D1_038B()
{
    if (skip_test_D1_038B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC75F);
    WriteRegisterWord(RegisterType::SP, 0x60BF);
    WriteRegisterByte(RegisterType::A, 0x6A);
    WriteRegisterByte(RegisterType::B, 0x90);
    WriteRegisterByte(RegisterType::C, 0x9E);
    WriteRegisterByte(RegisterType::D, 0x02);
    WriteRegisterByte(RegisterType::E, 0xE3);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x5C);
    WriteRegisterByte(RegisterType::L, 0x96);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC75F, 0xD1);
    WriteMemory(0x60C0, 0xFD);
    WriteMemory(0x60BF, 0x95);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6A);
    CheckRegisterByte(RegisterType::B, 0x90);
    CheckRegisterByte(RegisterType::C, 0x9E);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0x95);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x5C);
    CheckRegisterByte(RegisterType::L, 0x96);
    CheckRegisterWord(RegisterType::PC, 0xC760);
    CheckRegisterWord(RegisterType::SP, 0x60C1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x60BF, 0x95);
    CheckMemory(0x60C0, 0xFD);
    CheckMemory(0xC75F, 0xD1);
}

void test_D1_038C()
{
    if (skip_test_D1_038C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7B97);
    WriteRegisterWord(RegisterType::SP, 0x1DC8);
    WriteRegisterByte(RegisterType::A, 0xCE);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x3D);
    WriteRegisterByte(RegisterType::E, 0x0C);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x72);
    WriteRegisterByte(RegisterType::L, 0x0F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7B97, 0xD1);
    WriteMemory(0x1DC9, 0x9B);
    WriteMemory(0x1DC8, 0x73);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCE);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0x9B);
    CheckRegisterByte(RegisterType::E, 0x73);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x72);
    CheckRegisterByte(RegisterType::L, 0x0F);
    CheckRegisterWord(RegisterType::PC, 0x7B98);
    CheckRegisterWord(RegisterType::SP, 0x1DCA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1DC8, 0x73);
    CheckMemory(0x1DC9, 0x9B);
    CheckMemory(0x7B97, 0xD1);
}

void test_D1_038D()
{
    if (skip_test_D1_038D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9D44);
    WriteRegisterWord(RegisterType::SP, 0xA957);
    WriteRegisterByte(RegisterType::A, 0x5D);
    WriteRegisterByte(RegisterType::B, 0xE5);
    WriteRegisterByte(RegisterType::C, 0xFF);
    WriteRegisterByte(RegisterType::D, 0x8D);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x14);
    WriteRegisterByte(RegisterType::L, 0x0D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA958, 0xC0);
    WriteMemory(0xA957, 0x72);
    WriteMemory(0x9D44, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5D);
    CheckRegisterByte(RegisterType::B, 0xE5);
    CheckRegisterByte(RegisterType::C, 0xFF);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0x72);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x14);
    CheckRegisterByte(RegisterType::L, 0x0D);
    CheckRegisterWord(RegisterType::PC, 0x9D45);
    CheckRegisterWord(RegisterType::SP, 0xA959);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9D44, 0xD1);
    CheckMemory(0xA957, 0x72);
    CheckMemory(0xA958, 0xC0);
}

void test_D1_038E()
{
    if (skip_test_D1_038E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5B1B);
    WriteRegisterWord(RegisterType::SP, 0xBBAF);
    WriteRegisterByte(RegisterType::A, 0x2B);
    WriteRegisterByte(RegisterType::B, 0x6E);
    WriteRegisterByte(RegisterType::C, 0xA9);
    WriteRegisterByte(RegisterType::D, 0x4D);
    WriteRegisterByte(RegisterType::E, 0xD6);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x4D);
    WriteRegisterByte(RegisterType::L, 0xAE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBBB0, 0xC9);
    WriteMemory(0xBBAF, 0xA9);
    WriteMemory(0x5B1B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2B);
    CheckRegisterByte(RegisterType::B, 0x6E);
    CheckRegisterByte(RegisterType::C, 0xA9);
    CheckRegisterByte(RegisterType::D, 0xC9);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x4D);
    CheckRegisterByte(RegisterType::L, 0xAE);
    CheckRegisterWord(RegisterType::PC, 0x5B1C);
    CheckRegisterWord(RegisterType::SP, 0xBBB1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5B1B, 0xD1);
    CheckMemory(0xBBAF, 0xA9);
    CheckMemory(0xBBB0, 0xC9);
}

void test_D1_038F()
{
    if (skip_test_D1_038F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x22F2);
    WriteRegisterWord(RegisterType::SP, 0x4D20);
    WriteRegisterByte(RegisterType::A, 0x86);
    WriteRegisterByte(RegisterType::B, 0x30);
    WriteRegisterByte(RegisterType::C, 0x2B);
    WriteRegisterByte(RegisterType::D, 0xFB);
    WriteRegisterByte(RegisterType::E, 0xB7);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x96);
    WriteRegisterByte(RegisterType::L, 0xF3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x4D21, 0x04);
    WriteMemory(0x4D20, 0x07);
    WriteMemory(0x22F2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x86);
    CheckRegisterByte(RegisterType::B, 0x30);
    CheckRegisterByte(RegisterType::C, 0x2B);
    CheckRegisterByte(RegisterType::D, 0x04);
    CheckRegisterByte(RegisterType::E, 0x07);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x96);
    CheckRegisterByte(RegisterType::L, 0xF3);
    CheckRegisterWord(RegisterType::PC, 0x22F3);
    CheckRegisterWord(RegisterType::SP, 0x4D22);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x22F2, 0xD1);
    CheckMemory(0x4D20, 0x07);
    CheckMemory(0x4D21, 0x04);
}

void test_D1_0390()
{
    if (skip_test_D1_0390)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFE07);
    WriteRegisterWord(RegisterType::SP, 0xDEA7);
    WriteRegisterByte(RegisterType::A, 0xF4);
    WriteRegisterByte(RegisterType::B, 0x4A);
    WriteRegisterByte(RegisterType::C, 0xF1);
    WriteRegisterByte(RegisterType::D, 0xBD);
    WriteRegisterByte(RegisterType::E, 0x71);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xB8);
    WriteRegisterByte(RegisterType::L, 0x4E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFE07, 0xD1);
    WriteMemory(0xDEA8, 0x7F);
    WriteMemory(0xDEA7, 0xC0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF4);
    CheckRegisterByte(RegisterType::B, 0x4A);
    CheckRegisterByte(RegisterType::C, 0xF1);
    CheckRegisterByte(RegisterType::D, 0x7F);
    CheckRegisterByte(RegisterType::E, 0xC0);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xB8);
    CheckRegisterByte(RegisterType::L, 0x4E);
    CheckRegisterWord(RegisterType::PC, 0xFE08);
    CheckRegisterWord(RegisterType::SP, 0xDEA9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDEA7, 0xC0);
    CheckMemory(0xDEA8, 0x7F);
    CheckMemory(0xFE07, 0xD1);
}

void test_D1_0391()
{
    if (skip_test_D1_0391)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEA64);
    WriteRegisterWord(RegisterType::SP, 0xEFE1);
    WriteRegisterByte(RegisterType::A, 0x61);
    WriteRegisterByte(RegisterType::B, 0x74);
    WriteRegisterByte(RegisterType::C, 0x9D);
    WriteRegisterByte(RegisterType::D, 0xFF);
    WriteRegisterByte(RegisterType::E, 0x1D);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEFE2, 0x4A);
    WriteMemory(0xEFE1, 0x52);
    WriteMemory(0xEA64, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x61);
    CheckRegisterByte(RegisterType::B, 0x74);
    CheckRegisterByte(RegisterType::C, 0x9D);
    CheckRegisterByte(RegisterType::D, 0x4A);
    CheckRegisterByte(RegisterType::E, 0x52);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0xEA65);
    CheckRegisterWord(RegisterType::SP, 0xEFE3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEA64, 0xD1);
    CheckMemory(0xEFE1, 0x52);
    CheckMemory(0xEFE2, 0x4A);
}

void test_D1_0392()
{
    if (skip_test_D1_0392)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x31A6);
    WriteRegisterWord(RegisterType::SP, 0x5D7C);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0x8C);
    WriteRegisterByte(RegisterType::C, 0xB3);
    WriteRegisterByte(RegisterType::D, 0x04);
    WriteRegisterByte(RegisterType::E, 0xFE);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x78);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5D7D, 0xA8);
    WriteMemory(0x5D7C, 0x10);
    WriteMemory(0x31A6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0x8C);
    CheckRegisterByte(RegisterType::C, 0xB3);
    CheckRegisterByte(RegisterType::D, 0xA8);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x78);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0x31A7);
    CheckRegisterWord(RegisterType::SP, 0x5D7E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x31A6, 0xD1);
    CheckMemory(0x5D7C, 0x10);
    CheckMemory(0x5D7D, 0xA8);
}

void test_D1_0393()
{
    if (skip_test_D1_0393)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2B3A);
    WriteRegisterWord(RegisterType::SP, 0x83C5);
    WriteRegisterByte(RegisterType::A, 0x3E);
    WriteRegisterByte(RegisterType::B, 0x62);
    WriteRegisterByte(RegisterType::C, 0x73);
    WriteRegisterByte(RegisterType::D, 0xD1);
    WriteRegisterByte(RegisterType::E, 0xBA);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x99);
    WriteRegisterByte(RegisterType::L, 0x55);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x83C6, 0x20);
    WriteMemory(0x83C5, 0x04);
    WriteMemory(0x2B3A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3E);
    CheckRegisterByte(RegisterType::B, 0x62);
    CheckRegisterByte(RegisterType::C, 0x73);
    CheckRegisterByte(RegisterType::D, 0x20);
    CheckRegisterByte(RegisterType::E, 0x04);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x99);
    CheckRegisterByte(RegisterType::L, 0x55);
    CheckRegisterWord(RegisterType::PC, 0x2B3B);
    CheckRegisterWord(RegisterType::SP, 0x83C7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2B3A, 0xD1);
    CheckMemory(0x83C5, 0x04);
    CheckMemory(0x83C6, 0x20);
}

void test_D1_0394()
{
    if (skip_test_D1_0394)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2714);
    WriteRegisterWord(RegisterType::SP, 0x1ED7);
    WriteRegisterByte(RegisterType::A, 0x98);
    WriteRegisterByte(RegisterType::B, 0xD6);
    WriteRegisterByte(RegisterType::C, 0x9D);
    WriteRegisterByte(RegisterType::D, 0x9C);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x19);
    WriteRegisterByte(RegisterType::L, 0xCB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x2714, 0xD1);
    WriteMemory(0x1ED8, 0x83);
    WriteMemory(0x1ED7, 0x7E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x98);
    CheckRegisterByte(RegisterType::B, 0xD6);
    CheckRegisterByte(RegisterType::C, 0x9D);
    CheckRegisterByte(RegisterType::D, 0x83);
    CheckRegisterByte(RegisterType::E, 0x7E);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x19);
    CheckRegisterByte(RegisterType::L, 0xCB);
    CheckRegisterWord(RegisterType::PC, 0x2715);
    CheckRegisterWord(RegisterType::SP, 0x1ED9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1ED7, 0x7E);
    CheckMemory(0x1ED8, 0x83);
    CheckMemory(0x2714, 0xD1);
}

void test_D1_0395()
{
    if (skip_test_D1_0395)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x82E0);
    WriteRegisterWord(RegisterType::SP, 0xD575);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0x1A);
    WriteRegisterByte(RegisterType::C, 0x38);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0x37);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x3C);
    WriteRegisterByte(RegisterType::L, 0x5E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD576, 0x29);
    WriteMemory(0xD575, 0x49);
    WriteMemory(0x82E0, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0x1A);
    CheckRegisterByte(RegisterType::C, 0x38);
    CheckRegisterByte(RegisterType::D, 0x29);
    CheckRegisterByte(RegisterType::E, 0x49);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x3C);
    CheckRegisterByte(RegisterType::L, 0x5E);
    CheckRegisterWord(RegisterType::PC, 0x82E1);
    CheckRegisterWord(RegisterType::SP, 0xD577);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x82E0, 0xD1);
    CheckMemory(0xD575, 0x49);
    CheckMemory(0xD576, 0x29);
}

void test_D1_0396()
{
    if (skip_test_D1_0396)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA266);
    WriteRegisterWord(RegisterType::SP, 0x66C4);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0x9E);
    WriteRegisterByte(RegisterType::C, 0x44);
    WriteRegisterByte(RegisterType::D, 0xA2);
    WriteRegisterByte(RegisterType::E, 0xCD);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x02);
    WriteRegisterByte(RegisterType::L, 0x15);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA266, 0xD1);
    WriteMemory(0x66C5, 0x21);
    WriteMemory(0x66C4, 0xED);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0x9E);
    CheckRegisterByte(RegisterType::C, 0x44);
    CheckRegisterByte(RegisterType::D, 0x21);
    CheckRegisterByte(RegisterType::E, 0xED);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x02);
    CheckRegisterByte(RegisterType::L, 0x15);
    CheckRegisterWord(RegisterType::PC, 0xA267);
    CheckRegisterWord(RegisterType::SP, 0x66C6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x66C4, 0xED);
    CheckMemory(0x66C5, 0x21);
    CheckMemory(0xA266, 0xD1);
}

void test_D1_0397()
{
    if (skip_test_D1_0397)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3F1B);
    WriteRegisterWord(RegisterType::SP, 0xD8DC);
    WriteRegisterByte(RegisterType::A, 0x13);
    WriteRegisterByte(RegisterType::B, 0x1F);
    WriteRegisterByte(RegisterType::C, 0x50);
    WriteRegisterByte(RegisterType::D, 0xD5);
    WriteRegisterByte(RegisterType::E, 0x09);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0x36);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD8DD, 0x47);
    WriteMemory(0xD8DC, 0x9D);
    WriteMemory(0x3F1B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x13);
    CheckRegisterByte(RegisterType::B, 0x1F);
    CheckRegisterByte(RegisterType::C, 0x50);
    CheckRegisterByte(RegisterType::D, 0x47);
    CheckRegisterByte(RegisterType::E, 0x9D);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0x36);
    CheckRegisterWord(RegisterType::PC, 0x3F1C);
    CheckRegisterWord(RegisterType::SP, 0xD8DE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3F1B, 0xD1);
    CheckMemory(0xD8DC, 0x9D);
    CheckMemory(0xD8DD, 0x47);
}

void test_D1_0398()
{
    if (skip_test_D1_0398)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7A76);
    WriteRegisterWord(RegisterType::SP, 0x7E05);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0x4D);
    WriteRegisterByte(RegisterType::C, 0x27);
    WriteRegisterByte(RegisterType::D, 0x22);
    WriteRegisterByte(RegisterType::E, 0x68);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD0);
    WriteRegisterByte(RegisterType::L, 0xD0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7E06, 0x3B);
    WriteMemory(0x7E05, 0xC6);
    WriteMemory(0x7A76, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0x4D);
    CheckRegisterByte(RegisterType::C, 0x27);
    CheckRegisterByte(RegisterType::D, 0x3B);
    CheckRegisterByte(RegisterType::E, 0xC6);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD0);
    CheckRegisterByte(RegisterType::L, 0xD0);
    CheckRegisterWord(RegisterType::PC, 0x7A77);
    CheckRegisterWord(RegisterType::SP, 0x7E07);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7A76, 0xD1);
    CheckMemory(0x7E05, 0xC6);
    CheckMemory(0x7E06, 0x3B);
}

void test_D1_0399()
{
    if (skip_test_D1_0399)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x82D6);
    WriteRegisterWord(RegisterType::SP, 0xB91A);
    WriteRegisterByte(RegisterType::A, 0x16);
    WriteRegisterByte(RegisterType::B, 0x31);
    WriteRegisterByte(RegisterType::C, 0xEA);
    WriteRegisterByte(RegisterType::D, 0x09);
    WriteRegisterByte(RegisterType::E, 0x6F);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x08);
    WriteRegisterByte(RegisterType::L, 0x28);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB91B, 0xC3);
    WriteMemory(0xB91A, 0x7A);
    WriteMemory(0x82D6, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x16);
    CheckRegisterByte(RegisterType::B, 0x31);
    CheckRegisterByte(RegisterType::C, 0xEA);
    CheckRegisterByte(RegisterType::D, 0xC3);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x08);
    CheckRegisterByte(RegisterType::L, 0x28);
    CheckRegisterWord(RegisterType::PC, 0x82D7);
    CheckRegisterWord(RegisterType::SP, 0xB91C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x82D6, 0xD1);
    CheckMemory(0xB91A, 0x7A);
    CheckMemory(0xB91B, 0xC3);
}

void test_D1_039A()
{
    if (skip_test_D1_039A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x935F);
    WriteRegisterWord(RegisterType::SP, 0xCD82);
    WriteRegisterByte(RegisterType::A, 0xE8);
    WriteRegisterByte(RegisterType::B, 0x2E);
    WriteRegisterByte(RegisterType::C, 0xE7);
    WriteRegisterByte(RegisterType::D, 0xF9);
    WriteRegisterByte(RegisterType::E, 0xD7);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xC4);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCD83, 0x9A);
    WriteMemory(0xCD82, 0x3D);
    WriteMemory(0x935F, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE8);
    CheckRegisterByte(RegisterType::B, 0x2E);
    CheckRegisterByte(RegisterType::C, 0xE7);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0x3D);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xC4);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0x9360);
    CheckRegisterWord(RegisterType::SP, 0xCD84);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x935F, 0xD1);
    CheckMemory(0xCD82, 0x3D);
    CheckMemory(0xCD83, 0x9A);
}

void test_D1_039B()
{
    if (skip_test_D1_039B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6DBD);
    WriteRegisterWord(RegisterType::SP, 0x16BF);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0x8C);
    WriteRegisterByte(RegisterType::C, 0xBB);
    WriteRegisterByte(RegisterType::D, 0x61);
    WriteRegisterByte(RegisterType::E, 0x34);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x1D);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6DBD, 0xD1);
    WriteMemory(0x16C0, 0x03);
    WriteMemory(0x16BF, 0xD7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0x8C);
    CheckRegisterByte(RegisterType::C, 0xBB);
    CheckRegisterByte(RegisterType::D, 0x03);
    CheckRegisterByte(RegisterType::E, 0xD7);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x1D);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0x6DBE);
    CheckRegisterWord(RegisterType::SP, 0x16C1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x16BF, 0xD7);
    CheckMemory(0x16C0, 0x03);
    CheckMemory(0x6DBD, 0xD1);
}

void test_D1_039C()
{
    if (skip_test_D1_039C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x418C);
    WriteRegisterWord(RegisterType::SP, 0xE574);
    WriteRegisterByte(RegisterType::A, 0x15);
    WriteRegisterByte(RegisterType::B, 0xAC);
    WriteRegisterByte(RegisterType::C, 0x9B);
    WriteRegisterByte(RegisterType::D, 0x0E);
    WriteRegisterByte(RegisterType::E, 0xB7);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xC8);
    WriteRegisterByte(RegisterType::L, 0xAC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE575, 0xF5);
    WriteMemory(0xE574, 0x80);
    WriteMemory(0x418C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x15);
    CheckRegisterByte(RegisterType::B, 0xAC);
    CheckRegisterByte(RegisterType::C, 0x9B);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x80);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xC8);
    CheckRegisterByte(RegisterType::L, 0xAC);
    CheckRegisterWord(RegisterType::PC, 0x418D);
    CheckRegisterWord(RegisterType::SP, 0xE576);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x418C, 0xD1);
    CheckMemory(0xE574, 0x80);
    CheckMemory(0xE575, 0xF5);
}

void test_D1_039D()
{
    if (skip_test_D1_039D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9468);
    WriteRegisterWord(RegisterType::SP, 0xF5C4);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0x84);
    WriteRegisterByte(RegisterType::C, 0xB5);
    WriteRegisterByte(RegisterType::D, 0x08);
    WriteRegisterByte(RegisterType::E, 0x98);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xC9);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF5C5, 0x49);
    WriteMemory(0xF5C4, 0x41);
    WriteMemory(0x9468, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0x84);
    CheckRegisterByte(RegisterType::C, 0xB5);
    CheckRegisterByte(RegisterType::D, 0x49);
    CheckRegisterByte(RegisterType::E, 0x41);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xC9);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0x9469);
    CheckRegisterWord(RegisterType::SP, 0xF5C6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9468, 0xD1);
    CheckMemory(0xF5C4, 0x41);
    CheckMemory(0xF5C5, 0x49);
}

void test_D1_039E()
{
    if (skip_test_D1_039E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x06C8);
    WriteRegisterWord(RegisterType::SP, 0x6BB1);
    WriteRegisterByte(RegisterType::A, 0x8C);
    WriteRegisterByte(RegisterType::B, 0x94);
    WriteRegisterByte(RegisterType::C, 0x4A);
    WriteRegisterByte(RegisterType::D, 0x77);
    WriteRegisterByte(RegisterType::E, 0xB8);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x6B);
    WriteRegisterByte(RegisterType::L, 0xF1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6BB2, 0xDA);
    WriteMemory(0x6BB1, 0x95);
    WriteMemory(0x06C8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8C);
    CheckRegisterByte(RegisterType::B, 0x94);
    CheckRegisterByte(RegisterType::C, 0x4A);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0x95);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x6B);
    CheckRegisterByte(RegisterType::L, 0xF1);
    CheckRegisterWord(RegisterType::PC, 0x06C9);
    CheckRegisterWord(RegisterType::SP, 0x6BB3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x06C8, 0xD1);
    CheckMemory(0x6BB1, 0x95);
    CheckMemory(0x6BB2, 0xDA);
}

void test_D1_039F()
{
    if (skip_test_D1_039F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAB76);
    WriteRegisterWord(RegisterType::SP, 0xCA94);
    WriteRegisterByte(RegisterType::A, 0xA4);
    WriteRegisterByte(RegisterType::B, 0x85);
    WriteRegisterByte(RegisterType::C, 0x9C);
    WriteRegisterByte(RegisterType::D, 0x60);
    WriteRegisterByte(RegisterType::E, 0x5A);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x34);
    WriteRegisterByte(RegisterType::L, 0x7B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xCA95, 0xBB);
    WriteMemory(0xCA94, 0x66);
    WriteMemory(0xAB76, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA4);
    CheckRegisterByte(RegisterType::B, 0x85);
    CheckRegisterByte(RegisterType::C, 0x9C);
    CheckRegisterByte(RegisterType::D, 0xBB);
    CheckRegisterByte(RegisterType::E, 0x66);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x34);
    CheckRegisterByte(RegisterType::L, 0x7B);
    CheckRegisterWord(RegisterType::PC, 0xAB77);
    CheckRegisterWord(RegisterType::SP, 0xCA96);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAB76, 0xD1);
    CheckMemory(0xCA94, 0x66);
    CheckMemory(0xCA95, 0xBB);
}

void test_D1_03A0()
{
    if (skip_test_D1_03A0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2F90);
    WriteRegisterWord(RegisterType::SP, 0x6CBE);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0xAF);
    WriteRegisterByte(RegisterType::C, 0xA9);
    WriteRegisterByte(RegisterType::D, 0x6B);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x90);
    WriteRegisterByte(RegisterType::L, 0x82);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x6CBF, 0xC5);
    WriteMemory(0x6CBE, 0x6A);
    WriteMemory(0x2F90, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0xAF);
    CheckRegisterByte(RegisterType::C, 0xA9);
    CheckRegisterByte(RegisterType::D, 0xC5);
    CheckRegisterByte(RegisterType::E, 0x6A);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x90);
    CheckRegisterByte(RegisterType::L, 0x82);
    CheckRegisterWord(RegisterType::PC, 0x2F91);
    CheckRegisterWord(RegisterType::SP, 0x6CC0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2F90, 0xD1);
    CheckMemory(0x6CBE, 0x6A);
    CheckMemory(0x6CBF, 0xC5);
}

void test_D1_03A1()
{
    if (skip_test_D1_03A1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEEFF);
    WriteRegisterWord(RegisterType::SP, 0x8908);
    WriteRegisterByte(RegisterType::A, 0x43);
    WriteRegisterByte(RegisterType::B, 0x27);
    WriteRegisterByte(RegisterType::C, 0xC2);
    WriteRegisterByte(RegisterType::D, 0xD2);
    WriteRegisterByte(RegisterType::E, 0x4A);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x5F);
    WriteRegisterByte(RegisterType::L, 0xEA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEEFF, 0xD1);
    WriteMemory(0x8909, 0xB5);
    WriteMemory(0x8908, 0x00);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x43);
    CheckRegisterByte(RegisterType::B, 0x27);
    CheckRegisterByte(RegisterType::C, 0xC2);
    CheckRegisterByte(RegisterType::D, 0xB5);
    CheckRegisterByte(RegisterType::E, 0x00);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x5F);
    CheckRegisterByte(RegisterType::L, 0xEA);
    CheckRegisterWord(RegisterType::PC, 0xEF00);
    CheckRegisterWord(RegisterType::SP, 0x890A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8908, 0x00);
    CheckMemory(0x8909, 0xB5);
    CheckMemory(0xEEFF, 0xD1);
}

void test_D1_03A2()
{
    if (skip_test_D1_03A2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4F9C);
    WriteRegisterWord(RegisterType::SP, 0x2F9F);
    WriteRegisterByte(RegisterType::A, 0xFB);
    WriteRegisterByte(RegisterType::B, 0xB3);
    WriteRegisterByte(RegisterType::C, 0x8A);
    WriteRegisterByte(RegisterType::D, 0x6D);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x27);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4F9C, 0xD1);
    WriteMemory(0x2FA0, 0x54);
    WriteMemory(0x2F9F, 0x4B);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFB);
    CheckRegisterByte(RegisterType::B, 0xB3);
    CheckRegisterByte(RegisterType::C, 0x8A);
    CheckRegisterByte(RegisterType::D, 0x54);
    CheckRegisterByte(RegisterType::E, 0x4B);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x27);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0x4F9D);
    CheckRegisterWord(RegisterType::SP, 0x2FA1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2F9F, 0x4B);
    CheckMemory(0x2FA0, 0x54);
    CheckMemory(0x4F9C, 0xD1);
}

void test_D1_03A3()
{
    if (skip_test_D1_03A3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB3C8);
    WriteRegisterWord(RegisterType::SP, 0x1206);
    WriteRegisterByte(RegisterType::A, 0x99);
    WriteRegisterByte(RegisterType::B, 0x03);
    WriteRegisterByte(RegisterType::C, 0x9B);
    WriteRegisterByte(RegisterType::D, 0x03);
    WriteRegisterByte(RegisterType::E, 0xCF);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x07);
    WriteRegisterByte(RegisterType::L, 0x07);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB3C8, 0xD1);
    WriteMemory(0x1207, 0xF8);
    WriteMemory(0x1206, 0xFA);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x99);
    CheckRegisterByte(RegisterType::B, 0x03);
    CheckRegisterByte(RegisterType::C, 0x9B);
    CheckRegisterByte(RegisterType::D, 0xF8);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x07);
    CheckRegisterByte(RegisterType::L, 0x07);
    CheckRegisterWord(RegisterType::PC, 0xB3C9);
    CheckRegisterWord(RegisterType::SP, 0x1208);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1206, 0xFA);
    CheckMemory(0x1207, 0xF8);
    CheckMemory(0xB3C8, 0xD1);
}

void test_D1_03A4()
{
    if (skip_test_D1_03A4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF72A);
    WriteRegisterWord(RegisterType::SP, 0x71DD);
    WriteRegisterByte(RegisterType::A, 0x3B);
    WriteRegisterByte(RegisterType::B, 0x0D);
    WriteRegisterByte(RegisterType::C, 0xDF);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0xA8);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0xA8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF72A, 0xD1);
    WriteMemory(0x71DE, 0x92);
    WriteMemory(0x71DD, 0xD9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3B);
    CheckRegisterByte(RegisterType::B, 0x0D);
    CheckRegisterByte(RegisterType::C, 0xDF);
    CheckRegisterByte(RegisterType::D, 0x92);
    CheckRegisterByte(RegisterType::E, 0xD9);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0xA8);
    CheckRegisterWord(RegisterType::PC, 0xF72B);
    CheckRegisterWord(RegisterType::SP, 0x71DF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x71DD, 0xD9);
    CheckMemory(0x71DE, 0x92);
    CheckMemory(0xF72A, 0xD1);
}

void test_D1_03A5()
{
    if (skip_test_D1_03A5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC051);
    WriteRegisterWord(RegisterType::SP, 0xB3F3);
    WriteRegisterByte(RegisterType::A, 0x73);
    WriteRegisterByte(RegisterType::B, 0xE4);
    WriteRegisterByte(RegisterType::C, 0x1B);
    WriteRegisterByte(RegisterType::D, 0x79);
    WriteRegisterByte(RegisterType::E, 0x4C);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0x6A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC051, 0xD1);
    WriteMemory(0xB3F4, 0x66);
    WriteMemory(0xB3F3, 0xD9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x73);
    CheckRegisterByte(RegisterType::B, 0xE4);
    CheckRegisterByte(RegisterType::C, 0x1B);
    CheckRegisterByte(RegisterType::D, 0x66);
    CheckRegisterByte(RegisterType::E, 0xD9);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0x6A);
    CheckRegisterWord(RegisterType::PC, 0xC052);
    CheckRegisterWord(RegisterType::SP, 0xB3F5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB3F3, 0xD9);
    CheckMemory(0xB3F4, 0x66);
    CheckMemory(0xC051, 0xD1);
}

void test_D1_03A6()
{
    if (skip_test_D1_03A6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA9D9);
    WriteRegisterWord(RegisterType::SP, 0xA11C);
    WriteRegisterByte(RegisterType::A, 0x6B);
    WriteRegisterByte(RegisterType::B, 0x2E);
    WriteRegisterByte(RegisterType::C, 0x27);
    WriteRegisterByte(RegisterType::D, 0x16);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xB2);
    WriteRegisterByte(RegisterType::L, 0xC5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA9D9, 0xD1);
    WriteMemory(0xA11D, 0x69);
    WriteMemory(0xA11C, 0xFB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6B);
    CheckRegisterByte(RegisterType::B, 0x2E);
    CheckRegisterByte(RegisterType::C, 0x27);
    CheckRegisterByte(RegisterType::D, 0x69);
    CheckRegisterByte(RegisterType::E, 0xFB);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xB2);
    CheckRegisterByte(RegisterType::L, 0xC5);
    CheckRegisterWord(RegisterType::PC, 0xA9DA);
    CheckRegisterWord(RegisterType::SP, 0xA11E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA11C, 0xFB);
    CheckMemory(0xA11D, 0x69);
    CheckMemory(0xA9D9, 0xD1);
}

void test_D1_03A7()
{
    if (skip_test_D1_03A7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x36C2);
    WriteRegisterWord(RegisterType::SP, 0xFCA4);
    WriteRegisterByte(RegisterType::A, 0xDA);
    WriteRegisterByte(RegisterType::B, 0x60);
    WriteRegisterByte(RegisterType::C, 0x56);
    WriteRegisterByte(RegisterType::D, 0xCD);
    WriteRegisterByte(RegisterType::E, 0x75);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0xDD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFCA5, 0x01);
    WriteMemory(0xFCA4, 0xA4);
    WriteMemory(0x36C2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDA);
    CheckRegisterByte(RegisterType::B, 0x60);
    CheckRegisterByte(RegisterType::C, 0x56);
    CheckRegisterByte(RegisterType::D, 0x01);
    CheckRegisterByte(RegisterType::E, 0xA4);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0xDD);
    CheckRegisterWord(RegisterType::PC, 0x36C3);
    CheckRegisterWord(RegisterType::SP, 0xFCA6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x36C2, 0xD1);
    CheckMemory(0xFCA4, 0xA4);
    CheckMemory(0xFCA5, 0x01);
}

void test_D1_03A8()
{
    if (skip_test_D1_03A8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBEB6);
    WriteRegisterWord(RegisterType::SP, 0x3635);
    WriteRegisterByte(RegisterType::A, 0x7E);
    WriteRegisterByte(RegisterType::B, 0x3C);
    WriteRegisterByte(RegisterType::C, 0x7D);
    WriteRegisterByte(RegisterType::D, 0x45);
    WriteRegisterByte(RegisterType::E, 0x9B);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x51);
    WriteRegisterByte(RegisterType::L, 0x1D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBEB6, 0xD1);
    WriteMemory(0x3636, 0xB1);
    WriteMemory(0x3635, 0xDB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7E);
    CheckRegisterByte(RegisterType::B, 0x3C);
    CheckRegisterByte(RegisterType::C, 0x7D);
    CheckRegisterByte(RegisterType::D, 0xB1);
    CheckRegisterByte(RegisterType::E, 0xDB);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x51);
    CheckRegisterByte(RegisterType::L, 0x1D);
    CheckRegisterWord(RegisterType::PC, 0xBEB7);
    CheckRegisterWord(RegisterType::SP, 0x3637);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3635, 0xDB);
    CheckMemory(0x3636, 0xB1);
    CheckMemory(0xBEB6, 0xD1);
}

void test_D1_03A9()
{
    if (skip_test_D1_03A9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3931);
    WriteRegisterWord(RegisterType::SP, 0x5278);
    WriteRegisterByte(RegisterType::A, 0xAD);
    WriteRegisterByte(RegisterType::B, 0xA8);
    WriteRegisterByte(RegisterType::C, 0x51);
    WriteRegisterByte(RegisterType::D, 0x38);
    WriteRegisterByte(RegisterType::E, 0xC9);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xE7);
    WriteRegisterByte(RegisterType::L, 0xDB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x5279, 0x74);
    WriteMemory(0x5278, 0xEB);
    WriteMemory(0x3931, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAD);
    CheckRegisterByte(RegisterType::B, 0xA8);
    CheckRegisterByte(RegisterType::C, 0x51);
    CheckRegisterByte(RegisterType::D, 0x74);
    CheckRegisterByte(RegisterType::E, 0xEB);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xE7);
    CheckRegisterByte(RegisterType::L, 0xDB);
    CheckRegisterWord(RegisterType::PC, 0x3932);
    CheckRegisterWord(RegisterType::SP, 0x527A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3931, 0xD1);
    CheckMemory(0x5278, 0xEB);
    CheckMemory(0x5279, 0x74);
}

void test_D1_03AA()
{
    if (skip_test_D1_03AA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x47C1);
    WriteRegisterWord(RegisterType::SP, 0x2136);
    WriteRegisterByte(RegisterType::A, 0xAE);
    WriteRegisterByte(RegisterType::B, 0xDB);
    WriteRegisterByte(RegisterType::C, 0xB5);
    WriteRegisterByte(RegisterType::D, 0xD9);
    WriteRegisterByte(RegisterType::E, 0xC4);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x9A);
    WriteRegisterByte(RegisterType::L, 0xB9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x47C1, 0xD1);
    WriteMemory(0x2137, 0xB1);
    WriteMemory(0x2136, 0x1F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAE);
    CheckRegisterByte(RegisterType::B, 0xDB);
    CheckRegisterByte(RegisterType::C, 0xB5);
    CheckRegisterByte(RegisterType::D, 0xB1);
    CheckRegisterByte(RegisterType::E, 0x1F);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x9A);
    CheckRegisterByte(RegisterType::L, 0xB9);
    CheckRegisterWord(RegisterType::PC, 0x47C2);
    CheckRegisterWord(RegisterType::SP, 0x2138);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2136, 0x1F);
    CheckMemory(0x2137, 0xB1);
    CheckMemory(0x47C1, 0xD1);
}

void test_D1_03AB()
{
    if (skip_test_D1_03AB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA76A);
    WriteRegisterWord(RegisterType::SP, 0x59DF);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0xD2);
    WriteRegisterByte(RegisterType::C, 0x5E);
    WriteRegisterByte(RegisterType::D, 0x07);
    WriteRegisterByte(RegisterType::E, 0x24);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x61);
    WriteRegisterByte(RegisterType::L, 0x89);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xA76A, 0xD1);
    WriteMemory(0x59E0, 0xAF);
    WriteMemory(0x59DF, 0xB3);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0xD2);
    CheckRegisterByte(RegisterType::C, 0x5E);
    CheckRegisterByte(RegisterType::D, 0xAF);
    CheckRegisterByte(RegisterType::E, 0xB3);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x61);
    CheckRegisterByte(RegisterType::L, 0x89);
    CheckRegisterWord(RegisterType::PC, 0xA76B);
    CheckRegisterWord(RegisterType::SP, 0x59E1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x59DF, 0xB3);
    CheckMemory(0x59E0, 0xAF);
    CheckMemory(0xA76A, 0xD1);
}

void test_D1_03AC()
{
    if (skip_test_D1_03AC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF39A);
    WriteRegisterWord(RegisterType::SP, 0xFB55);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0xFF);
    WriteRegisterByte(RegisterType::C, 0xAD);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0x29);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x04);
    WriteRegisterByte(RegisterType::L, 0x15);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFB56, 0x58);
    WriteMemory(0xFB55, 0x59);
    WriteMemory(0xF39A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0xFF);
    CheckRegisterByte(RegisterType::C, 0xAD);
    CheckRegisterByte(RegisterType::D, 0x58);
    CheckRegisterByte(RegisterType::E, 0x59);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x04);
    CheckRegisterByte(RegisterType::L, 0x15);
    CheckRegisterWord(RegisterType::PC, 0xF39B);
    CheckRegisterWord(RegisterType::SP, 0xFB57);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF39A, 0xD1);
    CheckMemory(0xFB55, 0x59);
    CheckMemory(0xFB56, 0x58);
}

void test_D1_03AD()
{
    if (skip_test_D1_03AD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDEDC);
    WriteRegisterWord(RegisterType::SP, 0x28B0);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0xAB);
    WriteRegisterByte(RegisterType::C, 0xD0);
    WriteRegisterByte(RegisterType::D, 0x67);
    WriteRegisterByte(RegisterType::E, 0x35);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x72);
    WriteRegisterByte(RegisterType::L, 0xA5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDEDC, 0xD1);
    WriteMemory(0x28B1, 0x87);
    WriteMemory(0x28B0, 0xFB);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0xAB);
    CheckRegisterByte(RegisterType::C, 0xD0);
    CheckRegisterByte(RegisterType::D, 0x87);
    CheckRegisterByte(RegisterType::E, 0xFB);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x72);
    CheckRegisterByte(RegisterType::L, 0xA5);
    CheckRegisterWord(RegisterType::PC, 0xDEDD);
    CheckRegisterWord(RegisterType::SP, 0x28B2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x28B0, 0xFB);
    CheckMemory(0x28B1, 0x87);
    CheckMemory(0xDEDC, 0xD1);
}

void test_D1_03AE()
{
    if (skip_test_D1_03AE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x14D2);
    WriteRegisterWord(RegisterType::SP, 0xB724);
    WriteRegisterByte(RegisterType::A, 0xE1);
    WriteRegisterByte(RegisterType::B, 0x06);
    WriteRegisterByte(RegisterType::C, 0xE2);
    WriteRegisterByte(RegisterType::D, 0x8D);
    WriteRegisterByte(RegisterType::E, 0x2B);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xDE);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB725, 0xBE);
    WriteMemory(0xB724, 0x5A);
    WriteMemory(0x14D2, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE1);
    CheckRegisterByte(RegisterType::B, 0x06);
    CheckRegisterByte(RegisterType::C, 0xE2);
    CheckRegisterByte(RegisterType::D, 0xBE);
    CheckRegisterByte(RegisterType::E, 0x5A);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xDE);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0x14D3);
    CheckRegisterWord(RegisterType::SP, 0xB726);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x14D2, 0xD1);
    CheckMemory(0xB724, 0x5A);
    CheckMemory(0xB725, 0xBE);
}

void test_D1_03AF()
{
    if (skip_test_D1_03AF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x41B7);
    WriteRegisterWord(RegisterType::SP, 0x1E1D);
    WriteRegisterByte(RegisterType::A, 0x11);
    WriteRegisterByte(RegisterType::B, 0x7C);
    WriteRegisterByte(RegisterType::C, 0xF2);
    WriteRegisterByte(RegisterType::D, 0x42);
    WriteRegisterByte(RegisterType::E, 0x1F);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x2D);
    WriteRegisterByte(RegisterType::L, 0x8C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x41B7, 0xD1);
    WriteMemory(0x1E1E, 0xFB);
    WriteMemory(0x1E1D, 0x4D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x11);
    CheckRegisterByte(RegisterType::B, 0x7C);
    CheckRegisterByte(RegisterType::C, 0xF2);
    CheckRegisterByte(RegisterType::D, 0xFB);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x2D);
    CheckRegisterByte(RegisterType::L, 0x8C);
    CheckRegisterWord(RegisterType::PC, 0x41B8);
    CheckRegisterWord(RegisterType::SP, 0x1E1F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1E1D, 0x4D);
    CheckMemory(0x1E1E, 0xFB);
    CheckMemory(0x41B7, 0xD1);
}

void test_D1_03B0()
{
    if (skip_test_D1_03B0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEC37);
    WriteRegisterWord(RegisterType::SP, 0x9A6A);
    WriteRegisterByte(RegisterType::A, 0xA5);
    WriteRegisterByte(RegisterType::B, 0xE0);
    WriteRegisterByte(RegisterType::C, 0xDA);
    WriteRegisterByte(RegisterType::D, 0xFD);
    WriteRegisterByte(RegisterType::E, 0x58);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x0B);
    WriteRegisterByte(RegisterType::L, 0x73);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xEC37, 0xD1);
    WriteMemory(0x9A6B, 0xA7);
    WriteMemory(0x9A6A, 0x12);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA5);
    CheckRegisterByte(RegisterType::B, 0xE0);
    CheckRegisterByte(RegisterType::C, 0xDA);
    CheckRegisterByte(RegisterType::D, 0xA7);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x0B);
    CheckRegisterByte(RegisterType::L, 0x73);
    CheckRegisterWord(RegisterType::PC, 0xEC38);
    CheckRegisterWord(RegisterType::SP, 0x9A6C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9A6A, 0x12);
    CheckMemory(0x9A6B, 0xA7);
    CheckMemory(0xEC37, 0xD1);
}

void test_D1_03B1()
{
    if (skip_test_D1_03B1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBD47);
    WriteRegisterWord(RegisterType::SP, 0x78C4);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0x3B);
    WriteRegisterByte(RegisterType::C, 0x4F);
    WriteRegisterByte(RegisterType::D, 0xD0);
    WriteRegisterByte(RegisterType::E, 0x4E);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x2F);
    WriteRegisterByte(RegisterType::L, 0xF9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBD47, 0xD1);
    WriteMemory(0x78C5, 0xB2);
    WriteMemory(0x78C4, 0x9A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0x3B);
    CheckRegisterByte(RegisterType::C, 0x4F);
    CheckRegisterByte(RegisterType::D, 0xB2);
    CheckRegisterByte(RegisterType::E, 0x9A);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x2F);
    CheckRegisterByte(RegisterType::L, 0xF9);
    CheckRegisterWord(RegisterType::PC, 0xBD48);
    CheckRegisterWord(RegisterType::SP, 0x78C6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x78C4, 0x9A);
    CheckMemory(0x78C5, 0xB2);
    CheckMemory(0xBD47, 0xD1);
}

void test_D1_03B2()
{
    if (skip_test_D1_03B2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x380C);
    WriteRegisterWord(RegisterType::SP, 0xDD73);
    WriteRegisterByte(RegisterType::A, 0x9E);
    WriteRegisterByte(RegisterType::B, 0xE0);
    WriteRegisterByte(RegisterType::C, 0x1C);
    WriteRegisterByte(RegisterType::D, 0xFF);
    WriteRegisterByte(RegisterType::E, 0x1B);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x09);
    WriteRegisterByte(RegisterType::L, 0x62);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDD74, 0x20);
    WriteMemory(0xDD73, 0x49);
    WriteMemory(0x380C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9E);
    CheckRegisterByte(RegisterType::B, 0xE0);
    CheckRegisterByte(RegisterType::C, 0x1C);
    CheckRegisterByte(RegisterType::D, 0x20);
    CheckRegisterByte(RegisterType::E, 0x49);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x09);
    CheckRegisterByte(RegisterType::L, 0x62);
    CheckRegisterWord(RegisterType::PC, 0x380D);
    CheckRegisterWord(RegisterType::SP, 0xDD75);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x380C, 0xD1);
    CheckMemory(0xDD73, 0x49);
    CheckMemory(0xDD74, 0x20);
}

void test_D1_03B3()
{
    if (skip_test_D1_03B3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9C77);
    WriteRegisterWord(RegisterType::SP, 0x8844);
    WriteRegisterByte(RegisterType::A, 0x30);
    WriteRegisterByte(RegisterType::B, 0x77);
    WriteRegisterByte(RegisterType::C, 0xDD);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0xD7);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0xEC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9C77, 0xD1);
    WriteMemory(0x8845, 0x10);
    WriteMemory(0x8844, 0x7E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x30);
    CheckRegisterByte(RegisterType::B, 0x77);
    CheckRegisterByte(RegisterType::C, 0xDD);
    CheckRegisterByte(RegisterType::D, 0x10);
    CheckRegisterByte(RegisterType::E, 0x7E);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0xEC);
    CheckRegisterWord(RegisterType::PC, 0x9C78);
    CheckRegisterWord(RegisterType::SP, 0x8846);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8844, 0x7E);
    CheckMemory(0x8845, 0x10);
    CheckMemory(0x9C77, 0xD1);
}

void test_D1_03B4()
{
    if (skip_test_D1_03B4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBFEA);
    WriteRegisterWord(RegisterType::SP, 0x5E59);
    WriteRegisterByte(RegisterType::A, 0x30);
    WriteRegisterByte(RegisterType::B, 0xA8);
    WriteRegisterByte(RegisterType::C, 0x6D);
    WriteRegisterByte(RegisterType::D, 0xCC);
    WriteRegisterByte(RegisterType::E, 0x9F);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBFEA, 0xD1);
    WriteMemory(0x5E5A, 0x2E);
    WriteMemory(0x5E59, 0xE4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x30);
    CheckRegisterByte(RegisterType::B, 0xA8);
    CheckRegisterByte(RegisterType::C, 0x6D);
    CheckRegisterByte(RegisterType::D, 0x2E);
    CheckRegisterByte(RegisterType::E, 0xE4);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0xBFEB);
    CheckRegisterWord(RegisterType::SP, 0x5E5B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5E59, 0xE4);
    CheckMemory(0x5E5A, 0x2E);
    CheckMemory(0xBFEA, 0xD1);
}

void test_D1_03B5()
{
    if (skip_test_D1_03B5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC009);
    WriteRegisterWord(RegisterType::SP, 0x6EC3);
    WriteRegisterByte(RegisterType::A, 0x63);
    WriteRegisterByte(RegisterType::B, 0xDF);
    WriteRegisterByte(RegisterType::C, 0x78);
    WriteRegisterByte(RegisterType::D, 0xF6);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xAB);
    WriteRegisterByte(RegisterType::L, 0x28);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC009, 0xD1);
    WriteMemory(0x6EC4, 0x65);
    WriteMemory(0x6EC3, 0x92);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x63);
    CheckRegisterByte(RegisterType::B, 0xDF);
    CheckRegisterByte(RegisterType::C, 0x78);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0x92);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xAB);
    CheckRegisterByte(RegisterType::L, 0x28);
    CheckRegisterWord(RegisterType::PC, 0xC00A);
    CheckRegisterWord(RegisterType::SP, 0x6EC5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6EC3, 0x92);
    CheckMemory(0x6EC4, 0x65);
    CheckMemory(0xC009, 0xD1);
}

void test_D1_03B6()
{
    if (skip_test_D1_03B6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC00C);
    WriteRegisterWord(RegisterType::SP, 0x035B);
    WriteRegisterByte(RegisterType::A, 0xE7);
    WriteRegisterByte(RegisterType::B, 0xD5);
    WriteRegisterByte(RegisterType::C, 0xC7);
    WriteRegisterByte(RegisterType::D, 0x4E);
    WriteRegisterByte(RegisterType::E, 0xC3);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x92);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC00C, 0xD1);
    WriteMemory(0x035C, 0xEF);
    WriteMemory(0x035B, 0xD2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE7);
    CheckRegisterByte(RegisterType::B, 0xD5);
    CheckRegisterByte(RegisterType::C, 0xC7);
    CheckRegisterByte(RegisterType::D, 0xEF);
    CheckRegisterByte(RegisterType::E, 0xD2);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x92);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0xC00D);
    CheckRegisterWord(RegisterType::SP, 0x035D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x035B, 0xD2);
    CheckMemory(0x035C, 0xEF);
    CheckMemory(0xC00C, 0xD1);
}

void test_D1_03B7()
{
    if (skip_test_D1_03B7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD4CA);
    WriteRegisterWord(RegisterType::SP, 0x6C75);
    WriteRegisterByte(RegisterType::A, 0x5E);
    WriteRegisterByte(RegisterType::B, 0x2D);
    WriteRegisterByte(RegisterType::C, 0xC8);
    WriteRegisterByte(RegisterType::D, 0x18);
    WriteRegisterByte(RegisterType::E, 0x84);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x8A);
    WriteRegisterByte(RegisterType::L, 0xD3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xD4CA, 0xD1);
    WriteMemory(0x6C76, 0x0A);
    WriteMemory(0x6C75, 0xEF);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5E);
    CheckRegisterByte(RegisterType::B, 0x2D);
    CheckRegisterByte(RegisterType::C, 0xC8);
    CheckRegisterByte(RegisterType::D, 0x0A);
    CheckRegisterByte(RegisterType::E, 0xEF);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x8A);
    CheckRegisterByte(RegisterType::L, 0xD3);
    CheckRegisterWord(RegisterType::PC, 0xD4CB);
    CheckRegisterWord(RegisterType::SP, 0x6C77);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6C75, 0xEF);
    CheckMemory(0x6C76, 0x0A);
    CheckMemory(0xD4CA, 0xD1);
}

void test_D1_03B8()
{
    if (skip_test_D1_03B8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD68F);
    WriteRegisterWord(RegisterType::SP, 0x9FC8);
    WriteRegisterByte(RegisterType::A, 0x93);
    WriteRegisterByte(RegisterType::B, 0x61);
    WriteRegisterByte(RegisterType::C, 0x30);
    WriteRegisterByte(RegisterType::D, 0x24);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xEE);
    WriteRegisterByte(RegisterType::L, 0x47);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD68F, 0xD1);
    WriteMemory(0x9FC9, 0x17);
    WriteMemory(0x9FC8, 0xC1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x93);
    CheckRegisterByte(RegisterType::B, 0x61);
    CheckRegisterByte(RegisterType::C, 0x30);
    CheckRegisterByte(RegisterType::D, 0x17);
    CheckRegisterByte(RegisterType::E, 0xC1);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xEE);
    CheckRegisterByte(RegisterType::L, 0x47);
    CheckRegisterWord(RegisterType::PC, 0xD690);
    CheckRegisterWord(RegisterType::SP, 0x9FCA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9FC8, 0xC1);
    CheckMemory(0x9FC9, 0x17);
    CheckMemory(0xD68F, 0xD1);
}

void test_D1_03B9()
{
    if (skip_test_D1_03B9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x36B7);
    WriteRegisterWord(RegisterType::SP, 0xD582);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x81);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0x65);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x72);
    WriteRegisterByte(RegisterType::L, 0x41);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xD583, 0xD0);
    WriteMemory(0xD582, 0x71);
    WriteMemory(0x36B7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x81);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0xD0);
    CheckRegisterByte(RegisterType::E, 0x71);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x72);
    CheckRegisterByte(RegisterType::L, 0x41);
    CheckRegisterWord(RegisterType::PC, 0x36B8);
    CheckRegisterWord(RegisterType::SP, 0xD584);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x36B7, 0xD1);
    CheckMemory(0xD582, 0x71);
    CheckMemory(0xD583, 0xD0);
}

void test_D1_03BA()
{
    if (skip_test_D1_03BA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x80F6);
    WriteRegisterWord(RegisterType::SP, 0x2439);
    WriteRegisterByte(RegisterType::A, 0xDB);
    WriteRegisterByte(RegisterType::B, 0xAD);
    WriteRegisterByte(RegisterType::C, 0x81);
    WriteRegisterByte(RegisterType::D, 0x0E);
    WriteRegisterByte(RegisterType::E, 0x17);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xA0);
    WriteRegisterByte(RegisterType::L, 0x64);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x80F6, 0xD1);
    WriteMemory(0x243A, 0xB6);
    WriteMemory(0x2439, 0x41);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDB);
    CheckRegisterByte(RegisterType::B, 0xAD);
    CheckRegisterByte(RegisterType::C, 0x81);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0x41);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xA0);
    CheckRegisterByte(RegisterType::L, 0x64);
    CheckRegisterWord(RegisterType::PC, 0x80F7);
    CheckRegisterWord(RegisterType::SP, 0x243B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2439, 0x41);
    CheckMemory(0x243A, 0xB6);
    CheckMemory(0x80F6, 0xD1);
}

void test_D1_03BB()
{
    if (skip_test_D1_03BB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA4AD);
    WriteRegisterWord(RegisterType::SP, 0x9275);
    WriteRegisterByte(RegisterType::A, 0xBE);
    WriteRegisterByte(RegisterType::B, 0x80);
    WriteRegisterByte(RegisterType::C, 0xC6);
    WriteRegisterByte(RegisterType::D, 0x13);
    WriteRegisterByte(RegisterType::E, 0xDF);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x1B);
    WriteRegisterByte(RegisterType::L, 0x23);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA4AD, 0xD1);
    WriteMemory(0x9276, 0xCC);
    WriteMemory(0x9275, 0xC2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBE);
    CheckRegisterByte(RegisterType::B, 0x80);
    CheckRegisterByte(RegisterType::C, 0xC6);
    CheckRegisterByte(RegisterType::D, 0xCC);
    CheckRegisterByte(RegisterType::E, 0xC2);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x1B);
    CheckRegisterByte(RegisterType::L, 0x23);
    CheckRegisterWord(RegisterType::PC, 0xA4AE);
    CheckRegisterWord(RegisterType::SP, 0x9277);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9275, 0xC2);
    CheckMemory(0x9276, 0xCC);
    CheckMemory(0xA4AD, 0xD1);
}

void test_D1_03BC()
{
    if (skip_test_D1_03BC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6870);
    WriteRegisterWord(RegisterType::SP, 0xBF2B);
    WriteRegisterByte(RegisterType::A, 0xD4);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0x6D);
    WriteRegisterByte(RegisterType::D, 0x94);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0xA0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBF2C, 0x2E);
    WriteMemory(0xBF2B, 0xE4);
    WriteMemory(0x6870, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD4);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0x6D);
    CheckRegisterByte(RegisterType::D, 0x2E);
    CheckRegisterByte(RegisterType::E, 0xE4);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0xA0);
    CheckRegisterWord(RegisterType::PC, 0x6871);
    CheckRegisterWord(RegisterType::SP, 0xBF2D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6870, 0xD1);
    CheckMemory(0xBF2B, 0xE4);
    CheckMemory(0xBF2C, 0x2E);
}

void test_D1_03BD()
{
    if (skip_test_D1_03BD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x031B);
    WriteRegisterWord(RegisterType::SP, 0xDFCE);
    WriteRegisterByte(RegisterType::A, 0x47);
    WriteRegisterByte(RegisterType::B, 0xDC);
    WriteRegisterByte(RegisterType::C, 0x24);
    WriteRegisterByte(RegisterType::D, 0x02);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xCD);
    WriteRegisterByte(RegisterType::L, 0x45);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xDFCF, 0xB1);
    WriteMemory(0xDFCE, 0xE4);
    WriteMemory(0x031B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x47);
    CheckRegisterByte(RegisterType::B, 0xDC);
    CheckRegisterByte(RegisterType::C, 0x24);
    CheckRegisterByte(RegisterType::D, 0xB1);
    CheckRegisterByte(RegisterType::E, 0xE4);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xCD);
    CheckRegisterByte(RegisterType::L, 0x45);
    CheckRegisterWord(RegisterType::PC, 0x031C);
    CheckRegisterWord(RegisterType::SP, 0xDFD0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x031B, 0xD1);
    CheckMemory(0xDFCE, 0xE4);
    CheckMemory(0xDFCF, 0xB1);
}

void test_D1_03BE()
{
    if (skip_test_D1_03BE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC780);
    WriteRegisterWord(RegisterType::SP, 0xA3FF);
    WriteRegisterByte(RegisterType::A, 0x43);
    WriteRegisterByte(RegisterType::B, 0xD2);
    WriteRegisterByte(RegisterType::C, 0xDA);
    WriteRegisterByte(RegisterType::D, 0x20);
    WriteRegisterByte(RegisterType::E, 0x18);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x2F);
    WriteRegisterByte(RegisterType::L, 0xD0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xC780, 0xD1);
    WriteMemory(0xA400, 0xED);
    WriteMemory(0xA3FF, 0x29);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x43);
    CheckRegisterByte(RegisterType::B, 0xD2);
    CheckRegisterByte(RegisterType::C, 0xDA);
    CheckRegisterByte(RegisterType::D, 0xED);
    CheckRegisterByte(RegisterType::E, 0x29);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x2F);
    CheckRegisterByte(RegisterType::L, 0xD0);
    CheckRegisterWord(RegisterType::PC, 0xC781);
    CheckRegisterWord(RegisterType::SP, 0xA401);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA3FF, 0x29);
    CheckMemory(0xA400, 0xED);
    CheckMemory(0xC780, 0xD1);
}

void test_D1_03BF()
{
    if (skip_test_D1_03BF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4798);
    WriteRegisterWord(RegisterType::SP, 0x8776);
    WriteRegisterByte(RegisterType::A, 0x99);
    WriteRegisterByte(RegisterType::B, 0x0D);
    WriteRegisterByte(RegisterType::C, 0x35);
    WriteRegisterByte(RegisterType::D, 0x3E);
    WriteRegisterByte(RegisterType::E, 0x9C);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0x0C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x8777, 0x0F);
    WriteMemory(0x8776, 0x99);
    WriteMemory(0x4798, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x99);
    CheckRegisterByte(RegisterType::B, 0x0D);
    CheckRegisterByte(RegisterType::C, 0x35);
    CheckRegisterByte(RegisterType::D, 0x0F);
    CheckRegisterByte(RegisterType::E, 0x99);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0x0C);
    CheckRegisterWord(RegisterType::PC, 0x4799);
    CheckRegisterWord(RegisterType::SP, 0x8778);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4798, 0xD1);
    CheckMemory(0x8776, 0x99);
    CheckMemory(0x8777, 0x0F);
}

void test_D1_03C0()
{
    if (skip_test_D1_03C0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0EFB);
    WriteRegisterWord(RegisterType::SP, 0xECF8);
    WriteRegisterByte(RegisterType::A, 0xE9);
    WriteRegisterByte(RegisterType::B, 0xE2);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0x91);
    WriteRegisterByte(RegisterType::E, 0xFB);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xFB);
    WriteRegisterByte(RegisterType::L, 0x6F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xECF9, 0x14);
    WriteMemory(0xECF8, 0x76);
    WriteMemory(0x0EFB, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE9);
    CheckRegisterByte(RegisterType::B, 0xE2);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0x14);
    CheckRegisterByte(RegisterType::E, 0x76);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xFB);
    CheckRegisterByte(RegisterType::L, 0x6F);
    CheckRegisterWord(RegisterType::PC, 0x0EFC);
    CheckRegisterWord(RegisterType::SP, 0xECFA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0EFB, 0xD1);
    CheckMemory(0xECF8, 0x76);
    CheckMemory(0xECF9, 0x14);
}

void test_D1_03C1()
{
    if (skip_test_D1_03C1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0AA0);
    WriteRegisterWord(RegisterType::SP, 0x1B3C);
    WriteRegisterByte(RegisterType::A, 0xF1);
    WriteRegisterByte(RegisterType::B, 0xCC);
    WriteRegisterByte(RegisterType::C, 0x81);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0xD6);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x77);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x1B3D, 0xDC);
    WriteMemory(0x1B3C, 0xC3);
    WriteMemory(0x0AA0, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF1);
    CheckRegisterByte(RegisterType::B, 0xCC);
    CheckRegisterByte(RegisterType::C, 0x81);
    CheckRegisterByte(RegisterType::D, 0xDC);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x77);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0x0AA1);
    CheckRegisterWord(RegisterType::SP, 0x1B3E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0AA0, 0xD1);
    CheckMemory(0x1B3C, 0xC3);
    CheckMemory(0x1B3D, 0xDC);
}

void test_D1_03C2()
{
    if (skip_test_D1_03C2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x31A0);
    WriteRegisterWord(RegisterType::SP, 0x3074);
    WriteRegisterByte(RegisterType::A, 0x4B);
    WriteRegisterByte(RegisterType::B, 0x77);
    WriteRegisterByte(RegisterType::C, 0xC4);
    WriteRegisterByte(RegisterType::D, 0x62);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x26);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x31A0, 0xD1);
    WriteMemory(0x3075, 0x00);
    WriteMemory(0x3074, 0x54);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4B);
    CheckRegisterByte(RegisterType::B, 0x77);
    CheckRegisterByte(RegisterType::C, 0xC4);
    CheckRegisterByte(RegisterType::D, 0x00);
    CheckRegisterByte(RegisterType::E, 0x54);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x26);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0x31A1);
    CheckRegisterWord(RegisterType::SP, 0x3076);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3074, 0x54);
    CheckMemory(0x3075, 0x00);
    CheckMemory(0x31A0, 0xD1);
}

void test_D1_03C3()
{
    if (skip_test_D1_03C3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2382);
    WriteRegisterWord(RegisterType::SP, 0x94C3);
    WriteRegisterByte(RegisterType::A, 0x7D);
    WriteRegisterByte(RegisterType::B, 0x70);
    WriteRegisterByte(RegisterType::C, 0x02);
    WriteRegisterByte(RegisterType::D, 0x05);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x38);
    WriteRegisterByte(RegisterType::L, 0xF9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x94C4, 0xFD);
    WriteMemory(0x94C3, 0x0B);
    WriteMemory(0x2382, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7D);
    CheckRegisterByte(RegisterType::B, 0x70);
    CheckRegisterByte(RegisterType::C, 0x02);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0x0B);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x38);
    CheckRegisterByte(RegisterType::L, 0xF9);
    CheckRegisterWord(RegisterType::PC, 0x2383);
    CheckRegisterWord(RegisterType::SP, 0x94C5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2382, 0xD1);
    CheckMemory(0x94C3, 0x0B);
    CheckMemory(0x94C4, 0xFD);
}

void test_D1_03C4()
{
    if (skip_test_D1_03C4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4ABD);
    WriteRegisterWord(RegisterType::SP, 0x0116);
    WriteRegisterByte(RegisterType::A, 0x70);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0x6D);
    WriteRegisterByte(RegisterType::D, 0x2B);
    WriteRegisterByte(RegisterType::E, 0x65);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x88);
    WriteRegisterByte(RegisterType::L, 0x01);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4ABD, 0xD1);
    WriteMemory(0x0117, 0xB1);
    WriteMemory(0x0116, 0x58);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x70);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0x6D);
    CheckRegisterByte(RegisterType::D, 0xB1);
    CheckRegisterByte(RegisterType::E, 0x58);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x88);
    CheckRegisterByte(RegisterType::L, 0x01);
    CheckRegisterWord(RegisterType::PC, 0x4ABE);
    CheckRegisterWord(RegisterType::SP, 0x0118);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0116, 0x58);
    CheckMemory(0x0117, 0xB1);
    CheckMemory(0x4ABD, 0xD1);
}

void test_D1_03C5()
{
    if (skip_test_D1_03C5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7AD7);
    WriteRegisterWord(RegisterType::SP, 0x4E5D);
    WriteRegisterByte(RegisterType::A, 0x19);
    WriteRegisterByte(RegisterType::B, 0xD9);
    WriteRegisterByte(RegisterType::C, 0x10);
    WriteRegisterByte(RegisterType::D, 0xE4);
    WriteRegisterByte(RegisterType::E, 0x4C);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xE9);
    WriteRegisterByte(RegisterType::L, 0xC4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x7AD7, 0xD1);
    WriteMemory(0x4E5E, 0x46);
    WriteMemory(0x4E5D, 0x42);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x19);
    CheckRegisterByte(RegisterType::B, 0xD9);
    CheckRegisterByte(RegisterType::C, 0x10);
    CheckRegisterByte(RegisterType::D, 0x46);
    CheckRegisterByte(RegisterType::E, 0x42);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xE9);
    CheckRegisterByte(RegisterType::L, 0xC4);
    CheckRegisterWord(RegisterType::PC, 0x7AD8);
    CheckRegisterWord(RegisterType::SP, 0x4E5F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4E5D, 0x42);
    CheckMemory(0x4E5E, 0x46);
    CheckMemory(0x7AD7, 0xD1);
}

void test_D1_03C6()
{
    if (skip_test_D1_03C6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x976A);
    WriteRegisterWord(RegisterType::SP, 0xBB9A);
    WriteRegisterByte(RegisterType::A, 0x75);
    WriteRegisterByte(RegisterType::B, 0xE3);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0x73);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBB9B, 0x7E);
    WriteMemory(0xBB9A, 0x64);
    WriteMemory(0x976A, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x75);
    CheckRegisterByte(RegisterType::B, 0xE3);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0x7E);
    CheckRegisterByte(RegisterType::E, 0x64);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0x976B);
    CheckRegisterWord(RegisterType::SP, 0xBB9C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x976A, 0xD1);
    CheckMemory(0xBB9A, 0x64);
    CheckMemory(0xBB9B, 0x7E);
}

void test_D1_03C7()
{
    if (skip_test_D1_03C7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD18);
    WriteRegisterWord(RegisterType::SP, 0xE622);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0xD9);
    WriteRegisterByte(RegisterType::C, 0x68);
    WriteRegisterByte(RegisterType::D, 0xE0);
    WriteRegisterByte(RegisterType::E, 0x41);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xDA);
    WriteRegisterByte(RegisterType::L, 0xD0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xE623, 0xCD);
    WriteMemory(0xE622, 0x5C);
    WriteMemory(0xCD18, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0xD9);
    CheckRegisterByte(RegisterType::C, 0x68);
    CheckRegisterByte(RegisterType::D, 0xCD);
    CheckRegisterByte(RegisterType::E, 0x5C);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xDA);
    CheckRegisterByte(RegisterType::L, 0xD0);
    CheckRegisterWord(RegisterType::PC, 0xCD19);
    CheckRegisterWord(RegisterType::SP, 0xE624);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCD18, 0xD1);
    CheckMemory(0xE622, 0x5C);
    CheckMemory(0xE623, 0xCD);
}

void test_D1_03C8()
{
    if (skip_test_D1_03C8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0928);
    WriteRegisterWord(RegisterType::SP, 0xBB3F);
    WriteRegisterByte(RegisterType::A, 0x01);
    WriteRegisterByte(RegisterType::B, 0x72);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0x1A);
    WriteRegisterByte(RegisterType::E, 0xE8);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x08);
    WriteRegisterByte(RegisterType::L, 0x74);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xBB40, 0xC2);
    WriteMemory(0xBB3F, 0x60);
    WriteMemory(0x0928, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x01);
    CheckRegisterByte(RegisterType::B, 0x72);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0xC2);
    CheckRegisterByte(RegisterType::E, 0x60);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x08);
    CheckRegisterByte(RegisterType::L, 0x74);
    CheckRegisterWord(RegisterType::PC, 0x0929);
    CheckRegisterWord(RegisterType::SP, 0xBB41);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0928, 0xD1);
    CheckMemory(0xBB3F, 0x60);
    CheckMemory(0xBB40, 0xC2);
}

void test_D1_03C9()
{
    if (skip_test_D1_03C9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x62E8);
    WriteRegisterWord(RegisterType::SP, 0xBF6E);
    WriteRegisterByte(RegisterType::A, 0x35);
    WriteRegisterByte(RegisterType::B, 0x9A);
    WriteRegisterByte(RegisterType::C, 0xFA);
    WriteRegisterByte(RegisterType::D, 0x97);
    WriteRegisterByte(RegisterType::E, 0xA7);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0x8C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xBF6F, 0x26);
    WriteMemory(0xBF6E, 0xA0);
    WriteMemory(0x62E8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x35);
    CheckRegisterByte(RegisterType::B, 0x9A);
    CheckRegisterByte(RegisterType::C, 0xFA);
    CheckRegisterByte(RegisterType::D, 0x26);
    CheckRegisterByte(RegisterType::E, 0xA0);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0x8C);
    CheckRegisterWord(RegisterType::PC, 0x62E9);
    CheckRegisterWord(RegisterType::SP, 0xBF70);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x62E8, 0xD1);
    CheckMemory(0xBF6E, 0xA0);
    CheckMemory(0xBF6F, 0x26);
}

void test_D1_03CA()
{
    if (skip_test_D1_03CA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6D9F);
    WriteRegisterWord(RegisterType::SP, 0x0742);
    WriteRegisterByte(RegisterType::A, 0x07);
    WriteRegisterByte(RegisterType::B, 0xAD);
    WriteRegisterByte(RegisterType::C, 0x67);
    WriteRegisterByte(RegisterType::D, 0x47);
    WriteRegisterByte(RegisterType::E, 0x40);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xC2);
    WriteRegisterByte(RegisterType::L, 0xB2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6D9F, 0xD1);
    WriteMemory(0x0743, 0x77);
    WriteMemory(0x0742, 0x95);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x07);
    CheckRegisterByte(RegisterType::B, 0xAD);
    CheckRegisterByte(RegisterType::C, 0x67);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0x95);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xC2);
    CheckRegisterByte(RegisterType::L, 0xB2);
    CheckRegisterWord(RegisterType::PC, 0x6DA0);
    CheckRegisterWord(RegisterType::SP, 0x0744);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0742, 0x95);
    CheckMemory(0x0743, 0x77);
    CheckMemory(0x6D9F, 0xD1);
}

void test_D1_03CB()
{
    if (skip_test_D1_03CB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE1F2);
    WriteRegisterWord(RegisterType::SP, 0x1F69);
    WriteRegisterByte(RegisterType::A, 0xD4);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0xF5);
    WriteRegisterByte(RegisterType::D, 0x17);
    WriteRegisterByte(RegisterType::E, 0xF2);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0x2A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE1F2, 0xD1);
    WriteMemory(0x1F6A, 0x76);
    WriteMemory(0x1F69, 0xC9);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD4);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0xF5);
    CheckRegisterByte(RegisterType::D, 0x76);
    CheckRegisterByte(RegisterType::E, 0xC9);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0x2A);
    CheckRegisterWord(RegisterType::PC, 0xE1F3);
    CheckRegisterWord(RegisterType::SP, 0x1F6B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1F69, 0xC9);
    CheckMemory(0x1F6A, 0x76);
    CheckMemory(0xE1F2, 0xD1);
}

void test_D1_03CC()
{
    if (skip_test_D1_03CC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4F18);
    WriteRegisterWord(RegisterType::SP, 0xE8FE);
    WriteRegisterByte(RegisterType::A, 0xA9);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0x9A);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x12);
    WriteRegisterByte(RegisterType::L, 0x87);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xE8FF, 0x3F);
    WriteMemory(0xE8FE, 0x45);
    WriteMemory(0x4F18, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA9);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0x3F);
    CheckRegisterByte(RegisterType::E, 0x45);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x12);
    CheckRegisterByte(RegisterType::L, 0x87);
    CheckRegisterWord(RegisterType::PC, 0x4F19);
    CheckRegisterWord(RegisterType::SP, 0xE900);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4F18, 0xD1);
    CheckMemory(0xE8FE, 0x45);
    CheckMemory(0xE8FF, 0x3F);
}

void test_D1_03CD()
{
    if (skip_test_D1_03CD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x55EF);
    WriteRegisterWord(RegisterType::SP, 0x5454);
    WriteRegisterByte(RegisterType::A, 0x20);
    WriteRegisterByte(RegisterType::B, 0xC6);
    WriteRegisterByte(RegisterType::C, 0x2C);
    WriteRegisterByte(RegisterType::D, 0xC1);
    WriteRegisterByte(RegisterType::E, 0x62);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x00);
    WriteRegisterByte(RegisterType::L, 0x3E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x55EF, 0xD1);
    WriteMemory(0x5455, 0xB8);
    WriteMemory(0x5454, 0xF7);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x20);
    CheckRegisterByte(RegisterType::B, 0xC6);
    CheckRegisterByte(RegisterType::C, 0x2C);
    CheckRegisterByte(RegisterType::D, 0xB8);
    CheckRegisterByte(RegisterType::E, 0xF7);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x00);
    CheckRegisterByte(RegisterType::L, 0x3E);
    CheckRegisterWord(RegisterType::PC, 0x55F0);
    CheckRegisterWord(RegisterType::SP, 0x5456);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5454, 0xF7);
    CheckMemory(0x5455, 0xB8);
    CheckMemory(0x55EF, 0xD1);
}

void test_D1_03CE()
{
    if (skip_test_D1_03CE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x11B8);
    WriteRegisterWord(RegisterType::SP, 0x3583);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0xE2);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0x97);
    WriteRegisterByte(RegisterType::E, 0x80);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xBB);
    WriteRegisterByte(RegisterType::L, 0x14);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x3584, 0x15);
    WriteMemory(0x3583, 0xEA);
    WriteMemory(0x11B8, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0xE2);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0x15);
    CheckRegisterByte(RegisterType::E, 0xEA);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xBB);
    CheckRegisterByte(RegisterType::L, 0x14);
    CheckRegisterWord(RegisterType::PC, 0x11B9);
    CheckRegisterWord(RegisterType::SP, 0x3585);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x11B8, 0xD1);
    CheckMemory(0x3583, 0xEA);
    CheckMemory(0x3584, 0x15);
}

void test_D1_03CF()
{
    if (skip_test_D1_03CF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB4EB);
    WriteRegisterWord(RegisterType::SP, 0x4CFC);
    WriteRegisterByte(RegisterType::A, 0x5C);
    WriteRegisterByte(RegisterType::B, 0x3F);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0xDD);
    WriteRegisterByte(RegisterType::E, 0x5C);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0x9C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB4EB, 0xD1);
    WriteMemory(0x4CFD, 0x1E);
    WriteMemory(0x4CFC, 0x35);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5C);
    CheckRegisterByte(RegisterType::B, 0x3F);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0x1E);
    CheckRegisterByte(RegisterType::E, 0x35);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0x9C);
    CheckRegisterWord(RegisterType::PC, 0xB4EC);
    CheckRegisterWord(RegisterType::SP, 0x4CFE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4CFC, 0x35);
    CheckMemory(0x4CFD, 0x1E);
    CheckMemory(0xB4EB, 0xD1);
}

void test_D1_03D0()
{
    if (skip_test_D1_03D0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4B42);
    WriteRegisterWord(RegisterType::SP, 0x166D);
    WriteRegisterByte(RegisterType::A, 0xE2);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x96);
    WriteRegisterByte(RegisterType::D, 0xB4);
    WriteRegisterByte(RegisterType::E, 0x63);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x83);
    WriteRegisterByte(RegisterType::L, 0x42);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x4B42, 0xD1);
    WriteMemory(0x166E, 0x7B);
    WriteMemory(0x166D, 0xFE);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE2);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x96);
    CheckRegisterByte(RegisterType::D, 0x7B);
    CheckRegisterByte(RegisterType::E, 0xFE);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x83);
    CheckRegisterByte(RegisterType::L, 0x42);
    CheckRegisterWord(RegisterType::PC, 0x4B43);
    CheckRegisterWord(RegisterType::SP, 0x166F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x166D, 0xFE);
    CheckMemory(0x166E, 0x7B);
    CheckMemory(0x4B42, 0xD1);
}

void test_D1_03D1()
{
    if (skip_test_D1_03D1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFBB6);
    WriteRegisterWord(RegisterType::SP, 0xCC51);
    WriteRegisterByte(RegisterType::A, 0x67);
    WriteRegisterByte(RegisterType::B, 0x2A);
    WriteRegisterByte(RegisterType::C, 0xD2);
    WriteRegisterByte(RegisterType::D, 0xEA);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xE4);
    WriteRegisterByte(RegisterType::L, 0x13);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFBB6, 0xD1);
    WriteMemory(0xCC52, 0xC3);
    WriteMemory(0xCC51, 0x1D);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x67);
    CheckRegisterByte(RegisterType::B, 0x2A);
    CheckRegisterByte(RegisterType::C, 0xD2);
    CheckRegisterByte(RegisterType::D, 0xC3);
    CheckRegisterByte(RegisterType::E, 0x1D);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xE4);
    CheckRegisterByte(RegisterType::L, 0x13);
    CheckRegisterWord(RegisterType::PC, 0xFBB7);
    CheckRegisterWord(RegisterType::SP, 0xCC53);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCC51, 0x1D);
    CheckMemory(0xCC52, 0xC3);
    CheckMemory(0xFBB6, 0xD1);
}

void test_D1_03D2()
{
    if (skip_test_D1_03D2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6E94);
    WriteRegisterWord(RegisterType::SP, 0x0D4A);
    WriteRegisterByte(RegisterType::A, 0xE9);
    WriteRegisterByte(RegisterType::B, 0x3B);
    WriteRegisterByte(RegisterType::C, 0x1D);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x06);
    WriteRegisterByte(RegisterType::L, 0xD9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6E94, 0xD1);
    WriteMemory(0x0D4B, 0x16);
    WriteMemory(0x0D4A, 0x52);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE9);
    CheckRegisterByte(RegisterType::B, 0x3B);
    CheckRegisterByte(RegisterType::C, 0x1D);
    CheckRegisterByte(RegisterType::D, 0x16);
    CheckRegisterByte(RegisterType::E, 0x52);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x06);
    CheckRegisterByte(RegisterType::L, 0xD9);
    CheckRegisterWord(RegisterType::PC, 0x6E95);
    CheckRegisterWord(RegisterType::SP, 0x0D4C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0D4A, 0x52);
    CheckMemory(0x0D4B, 0x16);
    CheckMemory(0x6E94, 0xD1);
}

void test_D1_03D3()
{
    if (skip_test_D1_03D3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEDFC);
    WriteRegisterWord(RegisterType::SP, 0xC325);
    WriteRegisterByte(RegisterType::A, 0x5D);
    WriteRegisterByte(RegisterType::B, 0xD5);
    WriteRegisterByte(RegisterType::C, 0x06);
    WriteRegisterByte(RegisterType::D, 0x94);
    WriteRegisterByte(RegisterType::E, 0x25);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x92);
    WriteRegisterByte(RegisterType::L, 0xC1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xEDFC, 0xD1);
    WriteMemory(0xC326, 0x23);
    WriteMemory(0xC325, 0xB1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5D);
    CheckRegisterByte(RegisterType::B, 0xD5);
    CheckRegisterByte(RegisterType::C, 0x06);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0xB1);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x92);
    CheckRegisterByte(RegisterType::L, 0xC1);
    CheckRegisterWord(RegisterType::PC, 0xEDFD);
    CheckRegisterWord(RegisterType::SP, 0xC327);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC325, 0xB1);
    CheckMemory(0xC326, 0x23);
    CheckMemory(0xEDFC, 0xD1);
}

void test_D1_03D4()
{
    if (skip_test_D1_03D4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA692);
    WriteRegisterWord(RegisterType::SP, 0x67C0);
    WriteRegisterByte(RegisterType::A, 0xCA);
    WriteRegisterByte(RegisterType::B, 0x4A);
    WriteRegisterByte(RegisterType::C, 0x9B);
    WriteRegisterByte(RegisterType::D, 0x79);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xC8);
    WriteRegisterByte(RegisterType::L, 0xD6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xA692, 0xD1);
    WriteMemory(0x67C1, 0xD1);
    WriteMemory(0x67C0, 0x01);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCA);
    CheckRegisterByte(RegisterType::B, 0x4A);
    CheckRegisterByte(RegisterType::C, 0x9B);
    CheckRegisterByte(RegisterType::D, 0xD1);
    CheckRegisterByte(RegisterType::E, 0x01);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xC8);
    CheckRegisterByte(RegisterType::L, 0xD6);
    CheckRegisterWord(RegisterType::PC, 0xA693);
    CheckRegisterWord(RegisterType::SP, 0x67C2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x67C0, 0x01);
    CheckMemory(0x67C1, 0xD1);
    CheckMemory(0xA692, 0xD1);
}

void test_D1_03D5()
{
    if (skip_test_D1_03D5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x76BF);
    WriteRegisterWord(RegisterType::SP, 0x5E97);
    WriteRegisterByte(RegisterType::A, 0xB7);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0x76);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x9B);
    WriteRegisterByte(RegisterType::L, 0x10);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x76BF, 0xD1);
    WriteMemory(0x5E98, 0x49);
    WriteMemory(0x5E97, 0x0A);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB7);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0x76);
    CheckRegisterByte(RegisterType::D, 0x49);
    CheckRegisterByte(RegisterType::E, 0x0A);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x9B);
    CheckRegisterByte(RegisterType::L, 0x10);
    CheckRegisterWord(RegisterType::PC, 0x76C0);
    CheckRegisterWord(RegisterType::SP, 0x5E99);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5E97, 0x0A);
    CheckMemory(0x5E98, 0x49);
    CheckMemory(0x76BF, 0xD1);
}

void test_D1_03D6()
{
    if (skip_test_D1_03D6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5103);
    WriteRegisterWord(RegisterType::SP, 0x2B0F);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0x9B);
    WriteRegisterByte(RegisterType::C, 0x56);
    WriteRegisterByte(RegisterType::D, 0x2F);
    WriteRegisterByte(RegisterType::E, 0x00);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0x23);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x5103, 0xD1);
    WriteMemory(0x2B10, 0x9A);
    WriteMemory(0x2B0F, 0xE2);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0x9B);
    CheckRegisterByte(RegisterType::C, 0x56);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0xE2);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0x23);
    CheckRegisterWord(RegisterType::PC, 0x5104);
    CheckRegisterWord(RegisterType::SP, 0x2B11);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2B0F, 0xE2);
    CheckMemory(0x2B10, 0x9A);
    CheckMemory(0x5103, 0xD1);
}

void test_D1_03D7()
{
    if (skip_test_D1_03D7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x77AA);
    WriteRegisterWord(RegisterType::SP, 0xB4EF);
    WriteRegisterByte(RegisterType::A, 0x86);
    WriteRegisterByte(RegisterType::B, 0x85);
    WriteRegisterByte(RegisterType::C, 0x22);
    WriteRegisterByte(RegisterType::D, 0xFE);
    WriteRegisterByte(RegisterType::E, 0x41);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xBB);
    WriteRegisterByte(RegisterType::L, 0x01);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB4F0, 0xB9);
    WriteMemory(0xB4EF, 0x9B);
    WriteMemory(0x77AA, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x86);
    CheckRegisterByte(RegisterType::B, 0x85);
    CheckRegisterByte(RegisterType::C, 0x22);
    CheckRegisterByte(RegisterType::D, 0xB9);
    CheckRegisterByte(RegisterType::E, 0x9B);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xBB);
    CheckRegisterByte(RegisterType::L, 0x01);
    CheckRegisterWord(RegisterType::PC, 0x77AB);
    CheckRegisterWord(RegisterType::SP, 0xB4F1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x77AA, 0xD1);
    CheckMemory(0xB4EF, 0x9B);
    CheckMemory(0xB4F0, 0xB9);
}

void test_D1_03D8()
{
    if (skip_test_D1_03D8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF3B7);
    WriteRegisterWord(RegisterType::SP, 0x4BD7);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0x58);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0xA2);
    WriteRegisterByte(RegisterType::E, 0xD8);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xA1);
    WriteRegisterByte(RegisterType::L, 0xE3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xF3B7, 0xD1);
    WriteMemory(0x4BD8, 0x95);
    WriteMemory(0x4BD7, 0x4F);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0x58);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0x95);
    CheckRegisterByte(RegisterType::E, 0x4F);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xA1);
    CheckRegisterByte(RegisterType::L, 0xE3);
    CheckRegisterWord(RegisterType::PC, 0xF3B8);
    CheckRegisterWord(RegisterType::SP, 0x4BD9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4BD7, 0x4F);
    CheckMemory(0x4BD8, 0x95);
    CheckMemory(0xF3B7, 0xD1);
}

void test_D1_03D9()
{
    if (skip_test_D1_03D9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4EE5);
    WriteRegisterWord(RegisterType::SP, 0x783F);
    WriteRegisterByte(RegisterType::A, 0xFF);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0x67);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xA5);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7840, 0xCC);
    WriteMemory(0x783F, 0x2C);
    WriteMemory(0x4EE5, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFF);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0xCC);
    CheckRegisterByte(RegisterType::E, 0x2C);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xA5);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0x4EE6);
    CheckRegisterWord(RegisterType::SP, 0x7841);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4EE5, 0xD1);
    CheckMemory(0x783F, 0x2C);
    CheckMemory(0x7840, 0xCC);
}

void test_D1_03DA()
{
    if (skip_test_D1_03DA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC7FA);
    WriteRegisterWord(RegisterType::SP, 0x124A);
    WriteRegisterByte(RegisterType::A, 0x75);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0x8C);
    WriteRegisterByte(RegisterType::E, 0x8A);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0x0E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC7FA, 0xD1);
    WriteMemory(0x124B, 0x6B);
    WriteMemory(0x124A, 0x97);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x75);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0x6B);
    CheckRegisterByte(RegisterType::E, 0x97);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0x0E);
    CheckRegisterWord(RegisterType::PC, 0xC7FB);
    CheckRegisterWord(RegisterType::SP, 0x124C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x124A, 0x97);
    CheckMemory(0x124B, 0x6B);
    CheckMemory(0xC7FA, 0xD1);
}

void test_D1_03DB()
{
    if (skip_test_D1_03DB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x254C);
    WriteRegisterWord(RegisterType::SP, 0x7E36);
    WriteRegisterByte(RegisterType::A, 0x77);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0x92);
    WriteRegisterByte(RegisterType::D, 0xFF);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xC9);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x7E37, 0xC2);
    WriteMemory(0x7E36, 0xB9);
    WriteMemory(0x254C, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x77);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0x92);
    CheckRegisterByte(RegisterType::D, 0xC2);
    CheckRegisterByte(RegisterType::E, 0xB9);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xC9);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0x254D);
    CheckRegisterWord(RegisterType::SP, 0x7E38);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x254C, 0xD1);
    CheckMemory(0x7E36, 0xB9);
    CheckMemory(0x7E37, 0xC2);
}

void test_D1_03DC()
{
    if (skip_test_D1_03DC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2BD5);
    WriteRegisterWord(RegisterType::SP, 0x1A68);
    WriteRegisterByte(RegisterType::A, 0x98);
    WriteRegisterByte(RegisterType::B, 0xF9);
    WriteRegisterByte(RegisterType::C, 0x03);
    WriteRegisterByte(RegisterType::D, 0x01);
    WriteRegisterByte(RegisterType::E, 0xB3);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x31);
    WriteRegisterByte(RegisterType::L, 0x4F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x2BD5, 0xD1);
    WriteMemory(0x1A69, 0x29);
    WriteMemory(0x1A68, 0xAC);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x98);
    CheckRegisterByte(RegisterType::B, 0xF9);
    CheckRegisterByte(RegisterType::C, 0x03);
    CheckRegisterByte(RegisterType::D, 0x29);
    CheckRegisterByte(RegisterType::E, 0xAC);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x31);
    CheckRegisterByte(RegisterType::L, 0x4F);
    CheckRegisterWord(RegisterType::PC, 0x2BD6);
    CheckRegisterWord(RegisterType::SP, 0x1A6A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1A68, 0xAC);
    CheckMemory(0x1A69, 0x29);
    CheckMemory(0x2BD5, 0xD1);
}

void test_D1_03DD()
{
    if (skip_test_D1_03DD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x213C);
    WriteRegisterWord(RegisterType::SP, 0x1EF6);
    WriteRegisterByte(RegisterType::A, 0x64);
    WriteRegisterByte(RegisterType::B, 0xA6);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0x90);
    WriteRegisterByte(RegisterType::E, 0xB2);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xD0);
    WriteRegisterByte(RegisterType::L, 0x1F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x213C, 0xD1);
    WriteMemory(0x1EF7, 0xC6);
    WriteMemory(0x1EF6, 0xE8);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x64);
    CheckRegisterByte(RegisterType::B, 0xA6);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0xE8);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xD0);
    CheckRegisterByte(RegisterType::L, 0x1F);
    CheckRegisterWord(RegisterType::PC, 0x213D);
    CheckRegisterWord(RegisterType::SP, 0x1EF8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1EF6, 0xE8);
    CheckMemory(0x1EF7, 0xC6);
    CheckMemory(0x213C, 0xD1);
}

void test_D1_03DE()
{
    if (skip_test_D1_03DE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x444B);
    WriteRegisterWord(RegisterType::SP, 0x9931);
    WriteRegisterByte(RegisterType::A, 0xF7);
    WriteRegisterByte(RegisterType::B, 0x22);
    WriteRegisterByte(RegisterType::C, 0xA7);
    WriteRegisterByte(RegisterType::D, 0x24);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x48);
    WriteRegisterByte(RegisterType::L, 0xD0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x9932, 0x3C);
    WriteMemory(0x9931, 0xA2);
    WriteMemory(0x444B, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF7);
    CheckRegisterByte(RegisterType::B, 0x22);
    CheckRegisterByte(RegisterType::C, 0xA7);
    CheckRegisterByte(RegisterType::D, 0x3C);
    CheckRegisterByte(RegisterType::E, 0xA2);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x48);
    CheckRegisterByte(RegisterType::L, 0xD0);
    CheckRegisterWord(RegisterType::PC, 0x444C);
    CheckRegisterWord(RegisterType::SP, 0x9933);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x444B, 0xD1);
    CheckMemory(0x9931, 0xA2);
    CheckMemory(0x9932, 0x3C);
}

void test_D1_03DF()
{
    if (skip_test_D1_03DF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1BA9);
    WriteRegisterWord(RegisterType::SP, 0xC1BD);
    WriteRegisterByte(RegisterType::A, 0x22);
    WriteRegisterByte(RegisterType::B, 0xDC);
    WriteRegisterByte(RegisterType::C, 0x59);
    WriteRegisterByte(RegisterType::D, 0xA7);
    WriteRegisterByte(RegisterType::E, 0x89);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x95);
    WriteRegisterByte(RegisterType::L, 0x4F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xC1BE, 0x95);
    WriteMemory(0xC1BD, 0x5F);
    WriteMemory(0x1BA9, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x22);
    CheckRegisterByte(RegisterType::B, 0xDC);
    CheckRegisterByte(RegisterType::C, 0x59);
    CheckRegisterByte(RegisterType::D, 0x95);
    CheckRegisterByte(RegisterType::E, 0x5F);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x95);
    CheckRegisterByte(RegisterType::L, 0x4F);
    CheckRegisterWord(RegisterType::PC, 0x1BAA);
    CheckRegisterWord(RegisterType::SP, 0xC1BF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1BA9, 0xD1);
    CheckMemory(0xC1BD, 0x5F);
    CheckMemory(0xC1BE, 0x95);
}

void test_D1_03E0()
{
    if (skip_test_D1_03E0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1BA5);
    WriteRegisterWord(RegisterType::SP, 0x0EC3);
    WriteRegisterByte(RegisterType::A, 0x09);
    WriteRegisterByte(RegisterType::B, 0x07);
    WriteRegisterByte(RegisterType::C, 0x2F);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0x36);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x72);
    WriteRegisterByte(RegisterType::L, 0x37);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x1BA5, 0xD1);
    WriteMemory(0x0EC4, 0x0B);
    WriteMemory(0x0EC3, 0x81);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x09);
    CheckRegisterByte(RegisterType::B, 0x07);
    CheckRegisterByte(RegisterType::C, 0x2F);
    CheckRegisterByte(RegisterType::D, 0x0B);
    CheckRegisterByte(RegisterType::E, 0x81);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x72);
    CheckRegisterByte(RegisterType::L, 0x37);
    CheckRegisterWord(RegisterType::PC, 0x1BA6);
    CheckRegisterWord(RegisterType::SP, 0x0EC5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0EC3, 0x81);
    CheckMemory(0x0EC4, 0x0B);
    CheckMemory(0x1BA5, 0xD1);
}

void test_D1_03E1()
{
    if (skip_test_D1_03E1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6914);
    WriteRegisterWord(RegisterType::SP, 0x3FE6);
    WriteRegisterByte(RegisterType::A, 0xEF);
    WriteRegisterByte(RegisterType::B, 0x2A);
    WriteRegisterByte(RegisterType::C, 0x0F);
    WriteRegisterByte(RegisterType::D, 0xC1);
    WriteRegisterByte(RegisterType::E, 0x68);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x5D);
    WriteRegisterByte(RegisterType::L, 0x38);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6914, 0xD1);
    WriteMemory(0x3FE7, 0x18);
    WriteMemory(0x3FE6, 0x84);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEF);
    CheckRegisterByte(RegisterType::B, 0x2A);
    CheckRegisterByte(RegisterType::C, 0x0F);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0x84);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x5D);
    CheckRegisterByte(RegisterType::L, 0x38);
    CheckRegisterWord(RegisterType::PC, 0x6915);
    CheckRegisterWord(RegisterType::SP, 0x3FE8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3FE6, 0x84);
    CheckMemory(0x3FE7, 0x18);
    CheckMemory(0x6914, 0xD1);
}

void test_D1_03E2()
{
    if (skip_test_D1_03E2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2EE3);
    WriteRegisterWord(RegisterType::SP, 0xB988);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0xB1);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0x72);
    WriteRegisterByte(RegisterType::E, 0x67);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xA0);
    WriteRegisterByte(RegisterType::L, 0xD1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB989, 0x70);
    WriteMemory(0xB988, 0x25);
    WriteMemory(0x2EE3, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0xB1);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0x70);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xA0);
    CheckRegisterByte(RegisterType::L, 0xD1);
    CheckRegisterWord(RegisterType::PC, 0x2EE4);
    CheckRegisterWord(RegisterType::SP, 0xB98A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2EE3, 0xD1);
    CheckMemory(0xB988, 0x25);
    CheckMemory(0xB989, 0x70);
}

void test_D1_03E3()
{
    if (skip_test_D1_03E3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x83E7);
    WriteRegisterWord(RegisterType::SP, 0xB782);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0x9A);
    WriteRegisterByte(RegisterType::C, 0x07);
    WriteRegisterByte(RegisterType::D, 0xD6);
    WriteRegisterByte(RegisterType::E, 0x1E);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xDA);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xB783, 0xD4);
    WriteMemory(0xB782, 0xBD);
    WriteMemory(0x83E7, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0x9A);
    CheckRegisterByte(RegisterType::C, 0x07);
    CheckRegisterByte(RegisterType::D, 0xD4);
    CheckRegisterByte(RegisterType::E, 0xBD);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xDA);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0x83E8);
    CheckRegisterWord(RegisterType::SP, 0xB784);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x83E7, 0xD1);
    CheckMemory(0xB782, 0xBD);
    CheckMemory(0xB783, 0xD4);
}

void test_D1_03E4()
{
    if (skip_test_D1_03E4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6F0D);
    WriteRegisterWord(RegisterType::SP, 0x0A90);
    WriteRegisterByte(RegisterType::A, 0xAD);
    WriteRegisterByte(RegisterType::B, 0xE2);
    WriteRegisterByte(RegisterType::C, 0x8B);
    WriteRegisterByte(RegisterType::D, 0xC7);
    WriteRegisterByte(RegisterType::E, 0x2E);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x96);
    WriteRegisterByte(RegisterType::L, 0xDA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x6F0D, 0xD1);
    WriteMemory(0x0A91, 0xCF);
    WriteMemory(0x0A90, 0x3E);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAD);
    CheckRegisterByte(RegisterType::B, 0xE2);
    CheckRegisterByte(RegisterType::C, 0x8B);
    CheckRegisterByte(RegisterType::D, 0xCF);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x96);
    CheckRegisterByte(RegisterType::L, 0xDA);
    CheckRegisterWord(RegisterType::PC, 0x6F0E);
    CheckRegisterWord(RegisterType::SP, 0x0A92);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0A90, 0x3E);
    CheckMemory(0x0A91, 0xCF);
    CheckMemory(0x6F0D, 0xD1);
}

void test_D1_03E5()
{
    if (skip_test_D1_03E5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB0C8);
    WriteRegisterWord(RegisterType::SP, 0x6870);
    WriteRegisterByte(RegisterType::A, 0x13);
    WriteRegisterByte(RegisterType::B, 0x3A);
    WriteRegisterByte(RegisterType::C, 0x87);
    WriteRegisterByte(RegisterType::D, 0x1C);
    WriteRegisterByte(RegisterType::E, 0x45);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xF1);
    WriteRegisterByte(RegisterType::L, 0x76);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xB0C8, 0xD1);
    WriteMemory(0x6871, 0x21);
    WriteMemory(0x6870, 0xF1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x13);
    CheckRegisterByte(RegisterType::B, 0x3A);
    CheckRegisterByte(RegisterType::C, 0x87);
    CheckRegisterByte(RegisterType::D, 0x21);
    CheckRegisterByte(RegisterType::E, 0xF1);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xF1);
    CheckRegisterByte(RegisterType::L, 0x76);
    CheckRegisterWord(RegisterType::PC, 0xB0C9);
    CheckRegisterWord(RegisterType::SP, 0x6872);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6870, 0xF1);
    CheckMemory(0x6871, 0x21);
    CheckMemory(0xB0C8, 0xD1);
}

void test_D1_03E6()
{
    if (skip_test_D1_03E6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x544B);
    WriteRegisterWord(RegisterType::SP, 0x504B);
    WriteRegisterByte(RegisterType::A, 0x6F);
    WriteRegisterByte(RegisterType::B, 0x27);
    WriteRegisterByte(RegisterType::C, 0x21);
    WriteRegisterByte(RegisterType::D, 0x83);
    WriteRegisterByte(RegisterType::E, 0x4F);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x1E);
    WriteRegisterByte(RegisterType::L, 0xB6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0x544B, 0xD1);
    WriteMemory(0x504C, 0xEC);
    WriteMemory(0x504B, 0xC4);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6F);
    CheckRegisterByte(RegisterType::B, 0x27);
    CheckRegisterByte(RegisterType::C, 0x21);
    CheckRegisterByte(RegisterType::D, 0xEC);
    CheckRegisterByte(RegisterType::E, 0xC4);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x1E);
    CheckRegisterByte(RegisterType::L, 0xB6);
    CheckRegisterWord(RegisterType::PC, 0x544C);
    CheckRegisterWord(RegisterType::SP, 0x504D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x504B, 0xC4);
    CheckMemory(0x504C, 0xEC);
    CheckMemory(0x544B, 0xD1);
}

void test_D1_03E7()
{
    if (skip_test_D1_03E7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2376);
    WriteRegisterWord(RegisterType::SP, 0x4C97);
    WriteRegisterByte(RegisterType::A, 0x6A);
    WriteRegisterByte(RegisterType::B, 0x53);
    WriteRegisterByte(RegisterType::C, 0xD3);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0x97);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0x4C98, 0xF1);
    WriteMemory(0x4C97, 0x59);
    WriteMemory(0x2376, 0xD1);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6A);
    CheckRegisterByte(RegisterType::B, 0x53);
    CheckRegisterByte(RegisterType::C, 0xD3);
    CheckRegisterByte(RegisterType::D, 0xF1);
    CheckRegisterByte(RegisterType::E, 0x59);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0x97);
    CheckRegisterWord(RegisterType::PC, 0x2377);
    CheckRegisterWord(RegisterType::SP, 0x4C99);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2376, 0xD1);
    CheckMemory(0x4C97, 0x59);
    CheckMemory(0x4C98, 0xF1);
}

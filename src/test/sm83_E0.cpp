// File autogenerated by ./scripts/generate_tests_sm83.py
#include <test/include/acutest.h>

#include <cpu/include/instruction_ld.hpp>
#include <cpu/include/registers.hpp>
#include <memory/include/memory.hpp>

using namespace pgb::common;
using namespace pgb::memory;
using namespace pgb::cpu;

static auto registers = RegisterFile();
static auto mmap      = MemoryMap(registers, MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);


#define WriteRegisterWord(register, value) do { auto result = mmap.WriteWord(register, value); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); } while(0)
#define WriteRegisterByte(register, value) do { auto result = mmap.WriteByte(register, value); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); } while(0)
#define WriteRegisterFlag(value) do { TEST_ASSERT(static_cast<const Byte>(mmap.WriteFlagByte(static_cast<const Byte&>(value))) == 0x00); } while(0)
#define WriteMemory(address, value) do { auto result = mmap.WriteByte(address, value); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); } while(0)

#define CheckRegisterWord(register, value) do { auto result = mmap.ReadWord(register); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); TEST_ASSERT(static_cast<const Word&>(result) == value); } while(0)
#define CheckRegisterByte(register, value) do { auto result = mmap.ReadByte(register); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); TEST_ASSERT(static_cast<const Byte&>(result) == value); } while(0)
#define CheckRegisterFlag(value) do { TEST_ASSERT(static_cast<const Byte>(mmap.ReadFlagByte()) == value); } while(0)
#define CheckMemory(address, value) do { auto result = mmap.ReadByte(address); TEST_ASSERT_(result.IsSuccess(), "%s", result.GetStatusDescription()); TEST_ASSERT_(static_cast<const Byte&>(result) == value, "%hhu != %hhu", static_cast<const Byte&>(result).data, value); } while(0)

static_assert(instruction::InstructionRegistryNoPrefix::Callbacks[0xE0] != nullptr);
static_assert(instruction::InstructionRegistryNoPrefix::Ticks[0xE0] != 0);

const bool skip_test_E0_0000 = false;
const bool skip_test_E0_0001 = false;
const bool skip_test_E0_0002 = false;
const bool skip_test_E0_0003 = false;
const bool skip_test_E0_0004 = false;
const bool skip_test_E0_0005 = false;
const bool skip_test_E0_0006 = false;
const bool skip_test_E0_0007 = false;
const bool skip_test_E0_0008 = false;
const bool skip_test_E0_0009 = false;
const bool skip_test_E0_000A = false;
const bool skip_test_E0_000B = false;
const bool skip_test_E0_000C = false;
const bool skip_test_E0_000D = false;
const bool skip_test_E0_000E = false;
const bool skip_test_E0_000F = false;
const bool skip_test_E0_0010 = false;
const bool skip_test_E0_0011 = false;
const bool skip_test_E0_0012 = false;
const bool skip_test_E0_0013 = false;
const bool skip_test_E0_0014 = false;
const bool skip_test_E0_0015 = false;
const bool skip_test_E0_0016 = false;
const bool skip_test_E0_0017 = false;
const bool skip_test_E0_0018 = false;
const bool skip_test_E0_0019 = false;
const bool skip_test_E0_001A = false;
const bool skip_test_E0_001B = false;
const bool skip_test_E0_001C = false;
const bool skip_test_E0_001D = false;
const bool skip_test_E0_001E = false;
const bool skip_test_E0_001F = false;
const bool skip_test_E0_0020 = false;
const bool skip_test_E0_0021 = false;
const bool skip_test_E0_0022 = false;
const bool skip_test_E0_0023 = false;
const bool skip_test_E0_0024 = false;
const bool skip_test_E0_0025 = false;
const bool skip_test_E0_0026 = false;
const bool skip_test_E0_0027 = false;
const bool skip_test_E0_0028 = false;
const bool skip_test_E0_0029 = false;
const bool skip_test_E0_002A = false;
const bool skip_test_E0_002B = false;
const bool skip_test_E0_002C = false;
const bool skip_test_E0_002D = false;
const bool skip_test_E0_002E = false;
const bool skip_test_E0_002F = false;
const bool skip_test_E0_0030 = false;
const bool skip_test_E0_0031 = false;
const bool skip_test_E0_0032 = false;
const bool skip_test_E0_0033 = false;
const bool skip_test_E0_0034 = false;
const bool skip_test_E0_0035 = false;
const bool skip_test_E0_0036 = false;
const bool skip_test_E0_0037 = false;
const bool skip_test_E0_0038 = false;
const bool skip_test_E0_0039 = false;
const bool skip_test_E0_003A = false;
const bool skip_test_E0_003B = false;
const bool skip_test_E0_003C = false;
const bool skip_test_E0_003D = false;
const bool skip_test_E0_003E = false;
const bool skip_test_E0_003F = false;
const bool skip_test_E0_0040 = false;
const bool skip_test_E0_0041 = false;
const bool skip_test_E0_0042 = false;
const bool skip_test_E0_0043 = false;
const bool skip_test_E0_0044 = false;
const bool skip_test_E0_0045 = false;
const bool skip_test_E0_0046 = false;
const bool skip_test_E0_0047 = false;
const bool skip_test_E0_0048 = false;
const bool skip_test_E0_0049 = false;
const bool skip_test_E0_004A = false;
const bool skip_test_E0_004B = false;
const bool skip_test_E0_004C = false;
const bool skip_test_E0_004D = false;
const bool skip_test_E0_004E = false;
const bool skip_test_E0_004F = false;
const bool skip_test_E0_0050 = false;
const bool skip_test_E0_0051 = false;
const bool skip_test_E0_0052 = false;
const bool skip_test_E0_0053 = false;
const bool skip_test_E0_0054 = false;
const bool skip_test_E0_0055 = false;
const bool skip_test_E0_0056 = false;
const bool skip_test_E0_0057 = false;
const bool skip_test_E0_0058 = false;
const bool skip_test_E0_0059 = false;
const bool skip_test_E0_005A = false;
const bool skip_test_E0_005B = false;
const bool skip_test_E0_005C = false;
const bool skip_test_E0_005D = false;
const bool skip_test_E0_005E = false;
const bool skip_test_E0_005F = false;
const bool skip_test_E0_0060 = false;
const bool skip_test_E0_0061 = false;
const bool skip_test_E0_0062 = false;
const bool skip_test_E0_0063 = false;
const bool skip_test_E0_0064 = false;
const bool skip_test_E0_0065 = false;
const bool skip_test_E0_0066 = false;
const bool skip_test_E0_0067 = false;
const bool skip_test_E0_0068 = false;
const bool skip_test_E0_0069 = false;
const bool skip_test_E0_006A = false;
const bool skip_test_E0_006B = false;
const bool skip_test_E0_006C = false;
const bool skip_test_E0_006D = false;
const bool skip_test_E0_006E = false;
const bool skip_test_E0_006F = false;
const bool skip_test_E0_0070 = false;
const bool skip_test_E0_0071 = false;
const bool skip_test_E0_0072 = false;
const bool skip_test_E0_0073 = false;
const bool skip_test_E0_0074 = false;
const bool skip_test_E0_0075 = false;
const bool skip_test_E0_0076 = false;
const bool skip_test_E0_0077 = false;
const bool skip_test_E0_0078 = false;
const bool skip_test_E0_0079 = false;
const bool skip_test_E0_007A = false;
const bool skip_test_E0_007B = false;
const bool skip_test_E0_007C = false;
const bool skip_test_E0_007D = false;
const bool skip_test_E0_007E = false;
const bool skip_test_E0_007F = false;
const bool skip_test_E0_0080 = false;
const bool skip_test_E0_0081 = false;
const bool skip_test_E0_0082 = false;
const bool skip_test_E0_0083 = false;
const bool skip_test_E0_0084 = false;
const bool skip_test_E0_0085 = false;
const bool skip_test_E0_0086 = false;
const bool skip_test_E0_0087 = false;
const bool skip_test_E0_0088 = false;
const bool skip_test_E0_0089 = false;
const bool skip_test_E0_008A = false;
const bool skip_test_E0_008B = false;
const bool skip_test_E0_008C = false;
const bool skip_test_E0_008D = false;
const bool skip_test_E0_008E = false;
const bool skip_test_E0_008F = false;
const bool skip_test_E0_0090 = false;
const bool skip_test_E0_0091 = false;
const bool skip_test_E0_0092 = false;
const bool skip_test_E0_0093 = false;
const bool skip_test_E0_0094 = false;
const bool skip_test_E0_0095 = false;
const bool skip_test_E0_0096 = false;
const bool skip_test_E0_0097 = false;
const bool skip_test_E0_0098 = false;
const bool skip_test_E0_0099 = false;
const bool skip_test_E0_009A = false;
const bool skip_test_E0_009B = false;
const bool skip_test_E0_009C = false;
const bool skip_test_E0_009D = false;
const bool skip_test_E0_009E = false;
const bool skip_test_E0_009F = false;
const bool skip_test_E0_00A0 = false;
const bool skip_test_E0_00A1 = false;
const bool skip_test_E0_00A2 = false;
const bool skip_test_E0_00A3 = false;
const bool skip_test_E0_00A4 = false;
const bool skip_test_E0_00A5 = false;
const bool skip_test_E0_00A6 = false;
const bool skip_test_E0_00A7 = false;
const bool skip_test_E0_00A8 = false;
const bool skip_test_E0_00A9 = false;
const bool skip_test_E0_00AA = false;
const bool skip_test_E0_00AB = false;
const bool skip_test_E0_00AC = false;
const bool skip_test_E0_00AD = false;
const bool skip_test_E0_00AE = false;
const bool skip_test_E0_00AF = false;
const bool skip_test_E0_00B0 = false;
const bool skip_test_E0_00B1 = false;
const bool skip_test_E0_00B2 = false;
const bool skip_test_E0_00B3 = false;
const bool skip_test_E0_00B4 = false;
const bool skip_test_E0_00B5 = false;
const bool skip_test_E0_00B6 = false;
const bool skip_test_E0_00B7 = false;
const bool skip_test_E0_00B8 = false;
const bool skip_test_E0_00B9 = false;
const bool skip_test_E0_00BA = false;
const bool skip_test_E0_00BB = false;
const bool skip_test_E0_00BC = false;
const bool skip_test_E0_00BD = false;
const bool skip_test_E0_00BE = false;
const bool skip_test_E0_00BF = false;
const bool skip_test_E0_00C0 = false;
const bool skip_test_E0_00C1 = false;
const bool skip_test_E0_00C2 = false;
const bool skip_test_E0_00C3 = false;
const bool skip_test_E0_00C4 = false;
const bool skip_test_E0_00C5 = false;
const bool skip_test_E0_00C6 = false;
const bool skip_test_E0_00C7 = true;
const bool skip_test_E0_00C8 = false;
const bool skip_test_E0_00C9 = false;
const bool skip_test_E0_00CA = false;
const bool skip_test_E0_00CB = false;
const bool skip_test_E0_00CC = false;
const bool skip_test_E0_00CD = false;
const bool skip_test_E0_00CE = false;
const bool skip_test_E0_00CF = false;
const bool skip_test_E0_00D0 = false;
const bool skip_test_E0_00D1 = false;
const bool skip_test_E0_00D2 = false;
const bool skip_test_E0_00D3 = false;
const bool skip_test_E0_00D4 = false;
const bool skip_test_E0_00D5 = false;
const bool skip_test_E0_00D6 = false;
const bool skip_test_E0_00D7 = false;
const bool skip_test_E0_00D8 = false;
const bool skip_test_E0_00D9 = false;
const bool skip_test_E0_00DA = false;
const bool skip_test_E0_00DB = false;
const bool skip_test_E0_00DC = false;
const bool skip_test_E0_00DD = false;
const bool skip_test_E0_00DE = false;
const bool skip_test_E0_00DF = false;
const bool skip_test_E0_00E0 = false;
const bool skip_test_E0_00E1 = false;
const bool skip_test_E0_00E2 = false;
const bool skip_test_E0_00E3 = false;
const bool skip_test_E0_00E4 = false;
const bool skip_test_E0_00E5 = false;
const bool skip_test_E0_00E6 = false;
const bool skip_test_E0_00E7 = false;
const bool skip_test_E0_00E8 = false;
const bool skip_test_E0_00E9 = false;
const bool skip_test_E0_00EA = false;
const bool skip_test_E0_00EB = false;
const bool skip_test_E0_00EC = false;
const bool skip_test_E0_00ED = false;
const bool skip_test_E0_00EE = false;
const bool skip_test_E0_00EF = false;
const bool skip_test_E0_00F0 = false;
const bool skip_test_E0_00F1 = false;
const bool skip_test_E0_00F2 = false;
const bool skip_test_E0_00F3 = false;
const bool skip_test_E0_00F4 = false;
const bool skip_test_E0_00F5 = false;
const bool skip_test_E0_00F6 = false;
const bool skip_test_E0_00F7 = false;
const bool skip_test_E0_00F8 = false;
const bool skip_test_E0_00F9 = false;
const bool skip_test_E0_00FA = false;
const bool skip_test_E0_00FB = false;
const bool skip_test_E0_00FC = false;
const bool skip_test_E0_00FD = false;
const bool skip_test_E0_00FE = false;
const bool skip_test_E0_00FF = false;
const bool skip_test_E0_0100 = false;
const bool skip_test_E0_0101 = false;
const bool skip_test_E0_0102 = false;
const bool skip_test_E0_0103 = false;
const bool skip_test_E0_0104 = false;
const bool skip_test_E0_0105 = false;
const bool skip_test_E0_0106 = false;
const bool skip_test_E0_0107 = false;
const bool skip_test_E0_0108 = false;
const bool skip_test_E0_0109 = false;
const bool skip_test_E0_010A = false;
const bool skip_test_E0_010B = false;
const bool skip_test_E0_010C = false;
const bool skip_test_E0_010D = false;
const bool skip_test_E0_010E = false;
const bool skip_test_E0_010F = false;
const bool skip_test_E0_0110 = false;
const bool skip_test_E0_0111 = false;
const bool skip_test_E0_0112 = false;
const bool skip_test_E0_0113 = false;
const bool skip_test_E0_0114 = false;
const bool skip_test_E0_0115 = false;
const bool skip_test_E0_0116 = false;
const bool skip_test_E0_0117 = false;
const bool skip_test_E0_0118 = false;
const bool skip_test_E0_0119 = false;
const bool skip_test_E0_011A = false;
const bool skip_test_E0_011B = false;
const bool skip_test_E0_011C = false;
const bool skip_test_E0_011D = false;
const bool skip_test_E0_011E = false;
const bool skip_test_E0_011F = false;
const bool skip_test_E0_0120 = false;
const bool skip_test_E0_0121 = false;
const bool skip_test_E0_0122 = false;
const bool skip_test_E0_0123 = false;
const bool skip_test_E0_0124 = false;
const bool skip_test_E0_0125 = false;
const bool skip_test_E0_0126 = false;
const bool skip_test_E0_0127 = false;
const bool skip_test_E0_0128 = false;
const bool skip_test_E0_0129 = false;
const bool skip_test_E0_012A = false;
const bool skip_test_E0_012B = false;
const bool skip_test_E0_012C = false;
const bool skip_test_E0_012D = false;
const bool skip_test_E0_012E = false;
const bool skip_test_E0_012F = false;
const bool skip_test_E0_0130 = false;
const bool skip_test_E0_0131 = false;
const bool skip_test_E0_0132 = false;
const bool skip_test_E0_0133 = false;
const bool skip_test_E0_0134 = false;
const bool skip_test_E0_0135 = false;
const bool skip_test_E0_0136 = false;
const bool skip_test_E0_0137 = false;
const bool skip_test_E0_0138 = false;
const bool skip_test_E0_0139 = false;
const bool skip_test_E0_013A = false;
const bool skip_test_E0_013B = false;
const bool skip_test_E0_013C = false;
const bool skip_test_E0_013D = false;
const bool skip_test_E0_013E = false;
const bool skip_test_E0_013F = false;
const bool skip_test_E0_0140 = false;
const bool skip_test_E0_0141 = false;
const bool skip_test_E0_0142 = false;
const bool skip_test_E0_0143 = false;
const bool skip_test_E0_0144 = false;
const bool skip_test_E0_0145 = false;
const bool skip_test_E0_0146 = false;
const bool skip_test_E0_0147 = false;
const bool skip_test_E0_0148 = false;
const bool skip_test_E0_0149 = false;
const bool skip_test_E0_014A = false;
const bool skip_test_E0_014B = false;
const bool skip_test_E0_014C = false;
const bool skip_test_E0_014D = false;
const bool skip_test_E0_014E = false;
const bool skip_test_E0_014F = false;
const bool skip_test_E0_0150 = false;
const bool skip_test_E0_0151 = false;
const bool skip_test_E0_0152 = false;
const bool skip_test_E0_0153 = false;
const bool skip_test_E0_0154 = false;
const bool skip_test_E0_0155 = false;
const bool skip_test_E0_0156 = false;
const bool skip_test_E0_0157 = false;
const bool skip_test_E0_0158 = false;
const bool skip_test_E0_0159 = false;
const bool skip_test_E0_015A = false;
const bool skip_test_E0_015B = false;
const bool skip_test_E0_015C = false;
const bool skip_test_E0_015D = false;
const bool skip_test_E0_015E = false;
const bool skip_test_E0_015F = false;
const bool skip_test_E0_0160 = false;
const bool skip_test_E0_0161 = false;
const bool skip_test_E0_0162 = false;
const bool skip_test_E0_0163 = false;
const bool skip_test_E0_0164 = false;
const bool skip_test_E0_0165 = false;
const bool skip_test_E0_0166 = false;
const bool skip_test_E0_0167 = false;
const bool skip_test_E0_0168 = false;
const bool skip_test_E0_0169 = false;
const bool skip_test_E0_016A = false;
const bool skip_test_E0_016B = false;
const bool skip_test_E0_016C = false;
const bool skip_test_E0_016D = false;
const bool skip_test_E0_016E = false;
const bool skip_test_E0_016F = false;
const bool skip_test_E0_0170 = false;
const bool skip_test_E0_0171 = false;
const bool skip_test_E0_0172 = false;
const bool skip_test_E0_0173 = false;
const bool skip_test_E0_0174 = false;
const bool skip_test_E0_0175 = false;
const bool skip_test_E0_0176 = false;
const bool skip_test_E0_0177 = false;
const bool skip_test_E0_0178 = false;
const bool skip_test_E0_0179 = false;
const bool skip_test_E0_017A = false;
const bool skip_test_E0_017B = false;
const bool skip_test_E0_017C = false;
const bool skip_test_E0_017D = false;
const bool skip_test_E0_017E = false;
const bool skip_test_E0_017F = false;
const bool skip_test_E0_0180 = false;
const bool skip_test_E0_0181 = false;
const bool skip_test_E0_0182 = false;
const bool skip_test_E0_0183 = false;
const bool skip_test_E0_0184 = false;
const bool skip_test_E0_0185 = false;
const bool skip_test_E0_0186 = false;
const bool skip_test_E0_0187 = false;
const bool skip_test_E0_0188 = false;
const bool skip_test_E0_0189 = false;
const bool skip_test_E0_018A = false;
const bool skip_test_E0_018B = false;
const bool skip_test_E0_018C = false;
const bool skip_test_E0_018D = false;
const bool skip_test_E0_018E = false;
const bool skip_test_E0_018F = false;
const bool skip_test_E0_0190 = false;
const bool skip_test_E0_0191 = false;
const bool skip_test_E0_0192 = false;
const bool skip_test_E0_0193 = false;
const bool skip_test_E0_0194 = false;
const bool skip_test_E0_0195 = false;
const bool skip_test_E0_0196 = false;
const bool skip_test_E0_0197 = false;
const bool skip_test_E0_0198 = false;
const bool skip_test_E0_0199 = false;
const bool skip_test_E0_019A = false;
const bool skip_test_E0_019B = false;
const bool skip_test_E0_019C = false;
const bool skip_test_E0_019D = false;
const bool skip_test_E0_019E = false;
const bool skip_test_E0_019F = false;
const bool skip_test_E0_01A0 = false;
const bool skip_test_E0_01A1 = false;
const bool skip_test_E0_01A2 = false;
const bool skip_test_E0_01A3 = false;
const bool skip_test_E0_01A4 = false;
const bool skip_test_E0_01A5 = false;
const bool skip_test_E0_01A6 = false;
const bool skip_test_E0_01A7 = false;
const bool skip_test_E0_01A8 = false;
const bool skip_test_E0_01A9 = false;
const bool skip_test_E0_01AA = false;
const bool skip_test_E0_01AB = false;
const bool skip_test_E0_01AC = false;
const bool skip_test_E0_01AD = false;
const bool skip_test_E0_01AE = false;
const bool skip_test_E0_01AF = false;
const bool skip_test_E0_01B0 = false;
const bool skip_test_E0_01B1 = false;
const bool skip_test_E0_01B2 = false;
const bool skip_test_E0_01B3 = false;
const bool skip_test_E0_01B4 = false;
const bool skip_test_E0_01B5 = false;
const bool skip_test_E0_01B6 = false;
const bool skip_test_E0_01B7 = false;
const bool skip_test_E0_01B8 = false;
const bool skip_test_E0_01B9 = false;
const bool skip_test_E0_01BA = false;
const bool skip_test_E0_01BB = false;
const bool skip_test_E0_01BC = false;
const bool skip_test_E0_01BD = false;
const bool skip_test_E0_01BE = false;
const bool skip_test_E0_01BF = false;
const bool skip_test_E0_01C0 = false;
const bool skip_test_E0_01C1 = false;
const bool skip_test_E0_01C2 = false;
const bool skip_test_E0_01C3 = false;
const bool skip_test_E0_01C4 = false;
const bool skip_test_E0_01C5 = false;
const bool skip_test_E0_01C6 = false;
const bool skip_test_E0_01C7 = false;
const bool skip_test_E0_01C8 = false;
const bool skip_test_E0_01C9 = false;
const bool skip_test_E0_01CA = false;
const bool skip_test_E0_01CB = false;
const bool skip_test_E0_01CC = false;
const bool skip_test_E0_01CD = false;
const bool skip_test_E0_01CE = false;
const bool skip_test_E0_01CF = false;
const bool skip_test_E0_01D0 = false;
const bool skip_test_E0_01D1 = false;
const bool skip_test_E0_01D2 = false;
const bool skip_test_E0_01D3 = false;
const bool skip_test_E0_01D4 = false;
const bool skip_test_E0_01D5 = false;
const bool skip_test_E0_01D6 = false;
const bool skip_test_E0_01D7 = false;
const bool skip_test_E0_01D8 = false;
const bool skip_test_E0_01D9 = false;
const bool skip_test_E0_01DA = false;
const bool skip_test_E0_01DB = false;
const bool skip_test_E0_01DC = false;
const bool skip_test_E0_01DD = false;
const bool skip_test_E0_01DE = false;
const bool skip_test_E0_01DF = false;
const bool skip_test_E0_01E0 = false;
const bool skip_test_E0_01E1 = false;
const bool skip_test_E0_01E2 = false;
const bool skip_test_E0_01E3 = false;
const bool skip_test_E0_01E4 = true;
const bool skip_test_E0_01E5 = false;
const bool skip_test_E0_01E6 = false;
const bool skip_test_E0_01E7 = false;
const bool skip_test_E0_01E8 = false;
const bool skip_test_E0_01E9 = false;
const bool skip_test_E0_01EA = false;
const bool skip_test_E0_01EB = false;
const bool skip_test_E0_01EC = false;
const bool skip_test_E0_01ED = false;
const bool skip_test_E0_01EE = false;
const bool skip_test_E0_01EF = false;
const bool skip_test_E0_01F0 = false;
const bool skip_test_E0_01F1 = false;
const bool skip_test_E0_01F2 = false;
const bool skip_test_E0_01F3 = false;
const bool skip_test_E0_01F4 = false;
const bool skip_test_E0_01F5 = false;
const bool skip_test_E0_01F6 = false;
const bool skip_test_E0_01F7 = false;
const bool skip_test_E0_01F8 = false;
const bool skip_test_E0_01F9 = false;
const bool skip_test_E0_01FA = false;
const bool skip_test_E0_01FB = false;
const bool skip_test_E0_01FC = false;
const bool skip_test_E0_01FD = false;
const bool skip_test_E0_01FE = false;
const bool skip_test_E0_01FF = false;
const bool skip_test_E0_0200 = false;
const bool skip_test_E0_0201 = false;
const bool skip_test_E0_0202 = false;
const bool skip_test_E0_0203 = false;
const bool skip_test_E0_0204 = false;
const bool skip_test_E0_0205 = false;
const bool skip_test_E0_0206 = false;
const bool skip_test_E0_0207 = false;
const bool skip_test_E0_0208 = false;
const bool skip_test_E0_0209 = false;
const bool skip_test_E0_020A = false;
const bool skip_test_E0_020B = false;
const bool skip_test_E0_020C = false;
const bool skip_test_E0_020D = false;
const bool skip_test_E0_020E = false;
const bool skip_test_E0_020F = false;
const bool skip_test_E0_0210 = false;
const bool skip_test_E0_0211 = false;
const bool skip_test_E0_0212 = false;
const bool skip_test_E0_0213 = false;
const bool skip_test_E0_0214 = false;
const bool skip_test_E0_0215 = false;
const bool skip_test_E0_0216 = false;
const bool skip_test_E0_0217 = false;
const bool skip_test_E0_0218 = false;
const bool skip_test_E0_0219 = false;
const bool skip_test_E0_021A = false;
const bool skip_test_E0_021B = false;
const bool skip_test_E0_021C = false;
const bool skip_test_E0_021D = false;
const bool skip_test_E0_021E = false;
const bool skip_test_E0_021F = false;
const bool skip_test_E0_0220 = false;
const bool skip_test_E0_0221 = false;
const bool skip_test_E0_0222 = false;
const bool skip_test_E0_0223 = false;
const bool skip_test_E0_0224 = false;
const bool skip_test_E0_0225 = false;
const bool skip_test_E0_0226 = false;
const bool skip_test_E0_0227 = false;
const bool skip_test_E0_0228 = false;
const bool skip_test_E0_0229 = false;
const bool skip_test_E0_022A = false;
const bool skip_test_E0_022B = false;
const bool skip_test_E0_022C = false;
const bool skip_test_E0_022D = false;
const bool skip_test_E0_022E = false;
const bool skip_test_E0_022F = false;
const bool skip_test_E0_0230 = false;
const bool skip_test_E0_0231 = false;
const bool skip_test_E0_0232 = false;
const bool skip_test_E0_0233 = false;
const bool skip_test_E0_0234 = false;
const bool skip_test_E0_0235 = false;
const bool skip_test_E0_0236 = false;
const bool skip_test_E0_0237 = false;
const bool skip_test_E0_0238 = false;
const bool skip_test_E0_0239 = false;
const bool skip_test_E0_023A = false;
const bool skip_test_E0_023B = false;
const bool skip_test_E0_023C = false;
const bool skip_test_E0_023D = false;
const bool skip_test_E0_023E = false;
const bool skip_test_E0_023F = false;
const bool skip_test_E0_0240 = false;
const bool skip_test_E0_0241 = false;
const bool skip_test_E0_0242 = false;
const bool skip_test_E0_0243 = false;
const bool skip_test_E0_0244 = false;
const bool skip_test_E0_0245 = false;
const bool skip_test_E0_0246 = false;
const bool skip_test_E0_0247 = false;
const bool skip_test_E0_0248 = false;
const bool skip_test_E0_0249 = false;
const bool skip_test_E0_024A = false;
const bool skip_test_E0_024B = false;
const bool skip_test_E0_024C = false;
const bool skip_test_E0_024D = false;
const bool skip_test_E0_024E = false;
const bool skip_test_E0_024F = false;
const bool skip_test_E0_0250 = false;
const bool skip_test_E0_0251 = false;
const bool skip_test_E0_0252 = false;
const bool skip_test_E0_0253 = false;
const bool skip_test_E0_0254 = false;
const bool skip_test_E0_0255 = false;
const bool skip_test_E0_0256 = false;
const bool skip_test_E0_0257 = false;
const bool skip_test_E0_0258 = false;
const bool skip_test_E0_0259 = false;
const bool skip_test_E0_025A = false;
const bool skip_test_E0_025B = false;
const bool skip_test_E0_025C = false;
const bool skip_test_E0_025D = false;
const bool skip_test_E0_025E = false;
const bool skip_test_E0_025F = false;
const bool skip_test_E0_0260 = false;
const bool skip_test_E0_0261 = false;
const bool skip_test_E0_0262 = false;
const bool skip_test_E0_0263 = false;
const bool skip_test_E0_0264 = false;
const bool skip_test_E0_0265 = false;
const bool skip_test_E0_0266 = false;
const bool skip_test_E0_0267 = false;
const bool skip_test_E0_0268 = false;
const bool skip_test_E0_0269 = false;
const bool skip_test_E0_026A = false;
const bool skip_test_E0_026B = false;
const bool skip_test_E0_026C = false;
const bool skip_test_E0_026D = false;
const bool skip_test_E0_026E = false;
const bool skip_test_E0_026F = false;
const bool skip_test_E0_0270 = false;
const bool skip_test_E0_0271 = false;
const bool skip_test_E0_0272 = false;
const bool skip_test_E0_0273 = false;
const bool skip_test_E0_0274 = false;
const bool skip_test_E0_0275 = false;
const bool skip_test_E0_0276 = false;
const bool skip_test_E0_0277 = false;
const bool skip_test_E0_0278 = false;
const bool skip_test_E0_0279 = false;
const bool skip_test_E0_027A = false;
const bool skip_test_E0_027B = false;
const bool skip_test_E0_027C = false;
const bool skip_test_E0_027D = false;
const bool skip_test_E0_027E = false;
const bool skip_test_E0_027F = false;
const bool skip_test_E0_0280 = false;
const bool skip_test_E0_0281 = false;
const bool skip_test_E0_0282 = false;
const bool skip_test_E0_0283 = false;
const bool skip_test_E0_0284 = false;
const bool skip_test_E0_0285 = false;
const bool skip_test_E0_0286 = false;
const bool skip_test_E0_0287 = false;
const bool skip_test_E0_0288 = false;
const bool skip_test_E0_0289 = false;
const bool skip_test_E0_028A = false;
const bool skip_test_E0_028B = false;
const bool skip_test_E0_028C = false;
const bool skip_test_E0_028D = false;
const bool skip_test_E0_028E = false;
const bool skip_test_E0_028F = false;
const bool skip_test_E0_0290 = false;
const bool skip_test_E0_0291 = false;
const bool skip_test_E0_0292 = false;
const bool skip_test_E0_0293 = false;
const bool skip_test_E0_0294 = false;
const bool skip_test_E0_0295 = false;
const bool skip_test_E0_0296 = false;
const bool skip_test_E0_0297 = false;
const bool skip_test_E0_0298 = false;
const bool skip_test_E0_0299 = false;
const bool skip_test_E0_029A = false;
const bool skip_test_E0_029B = false;
const bool skip_test_E0_029C = false;
const bool skip_test_E0_029D = false;
const bool skip_test_E0_029E = false;
const bool skip_test_E0_029F = false;
const bool skip_test_E0_02A0 = false;
const bool skip_test_E0_02A1 = false;
const bool skip_test_E0_02A2 = false;
const bool skip_test_E0_02A3 = false;
const bool skip_test_E0_02A4 = false;
const bool skip_test_E0_02A5 = false;
const bool skip_test_E0_02A6 = false;
const bool skip_test_E0_02A7 = false;
const bool skip_test_E0_02A8 = false;
const bool skip_test_E0_02A9 = false;
const bool skip_test_E0_02AA = false;
const bool skip_test_E0_02AB = false;
const bool skip_test_E0_02AC = false;
const bool skip_test_E0_02AD = false;
const bool skip_test_E0_02AE = false;
const bool skip_test_E0_02AF = false;
const bool skip_test_E0_02B0 = false;
const bool skip_test_E0_02B1 = false;
const bool skip_test_E0_02B2 = false;
const bool skip_test_E0_02B3 = false;
const bool skip_test_E0_02B4 = false;
const bool skip_test_E0_02B5 = false;
const bool skip_test_E0_02B6 = false;
const bool skip_test_E0_02B7 = false;
const bool skip_test_E0_02B8 = false;
const bool skip_test_E0_02B9 = false;
const bool skip_test_E0_02BA = false;
const bool skip_test_E0_02BB = false;
const bool skip_test_E0_02BC = false;
const bool skip_test_E0_02BD = false;
const bool skip_test_E0_02BE = false;
const bool skip_test_E0_02BF = false;
const bool skip_test_E0_02C0 = false;
const bool skip_test_E0_02C1 = false;
const bool skip_test_E0_02C2 = false;
const bool skip_test_E0_02C3 = false;
const bool skip_test_E0_02C4 = false;
const bool skip_test_E0_02C5 = false;
const bool skip_test_E0_02C6 = false;
const bool skip_test_E0_02C7 = false;
const bool skip_test_E0_02C8 = false;
const bool skip_test_E0_02C9 = false;
const bool skip_test_E0_02CA = false;
const bool skip_test_E0_02CB = false;
const bool skip_test_E0_02CC = false;
const bool skip_test_E0_02CD = false;
const bool skip_test_E0_02CE = false;
const bool skip_test_E0_02CF = false;
const bool skip_test_E0_02D0 = false;
const bool skip_test_E0_02D1 = false;
const bool skip_test_E0_02D2 = false;
const bool skip_test_E0_02D3 = false;
const bool skip_test_E0_02D4 = false;
const bool skip_test_E0_02D5 = false;
const bool skip_test_E0_02D6 = false;
const bool skip_test_E0_02D7 = false;
const bool skip_test_E0_02D8 = false;
const bool skip_test_E0_02D9 = false;
const bool skip_test_E0_02DA = false;
const bool skip_test_E0_02DB = false;
const bool skip_test_E0_02DC = false;
const bool skip_test_E0_02DD = false;
const bool skip_test_E0_02DE = false;
const bool skip_test_E0_02DF = false;
const bool skip_test_E0_02E0 = false;
const bool skip_test_E0_02E1 = false;
const bool skip_test_E0_02E2 = false;
const bool skip_test_E0_02E3 = false;
const bool skip_test_E0_02E4 = false;
const bool skip_test_E0_02E5 = false;
const bool skip_test_E0_02E6 = false;
const bool skip_test_E0_02E7 = false;
const bool skip_test_E0_02E8 = false;
const bool skip_test_E0_02E9 = false;
const bool skip_test_E0_02EA = false;
const bool skip_test_E0_02EB = false;
const bool skip_test_E0_02EC = false;
const bool skip_test_E0_02ED = false;
const bool skip_test_E0_02EE = false;
const bool skip_test_E0_02EF = false;
const bool skip_test_E0_02F0 = false;
const bool skip_test_E0_02F1 = false;
const bool skip_test_E0_02F2 = false;
const bool skip_test_E0_02F3 = false;
const bool skip_test_E0_02F4 = false;
const bool skip_test_E0_02F5 = false;
const bool skip_test_E0_02F6 = false;
const bool skip_test_E0_02F7 = false;
const bool skip_test_E0_02F8 = false;
const bool skip_test_E0_02F9 = false;
const bool skip_test_E0_02FA = false;
const bool skip_test_E0_02FB = false;
const bool skip_test_E0_02FC = false;
const bool skip_test_E0_02FD = false;
const bool skip_test_E0_02FE = false;
const bool skip_test_E0_02FF = false;
const bool skip_test_E0_0300 = false;
const bool skip_test_E0_0301 = false;
const bool skip_test_E0_0302 = false;
const bool skip_test_E0_0303 = false;
const bool skip_test_E0_0304 = false;
const bool skip_test_E0_0305 = false;
const bool skip_test_E0_0306 = false;
const bool skip_test_E0_0307 = false;
const bool skip_test_E0_0308 = false;
const bool skip_test_E0_0309 = false;
const bool skip_test_E0_030A = false;
const bool skip_test_E0_030B = false;
const bool skip_test_E0_030C = false;
const bool skip_test_E0_030D = false;
const bool skip_test_E0_030E = false;
const bool skip_test_E0_030F = false;
const bool skip_test_E0_0310 = false;
const bool skip_test_E0_0311 = false;
const bool skip_test_E0_0312 = false;
const bool skip_test_E0_0313 = false;
const bool skip_test_E0_0314 = false;
const bool skip_test_E0_0315 = false;
const bool skip_test_E0_0316 = false;
const bool skip_test_E0_0317 = false;
const bool skip_test_E0_0318 = false;
const bool skip_test_E0_0319 = false;
const bool skip_test_E0_031A = false;
const bool skip_test_E0_031B = false;
const bool skip_test_E0_031C = false;
const bool skip_test_E0_031D = false;
const bool skip_test_E0_031E = false;
const bool skip_test_E0_031F = false;
const bool skip_test_E0_0320 = false;
const bool skip_test_E0_0321 = false;
const bool skip_test_E0_0322 = false;
const bool skip_test_E0_0323 = false;
const bool skip_test_E0_0324 = false;
const bool skip_test_E0_0325 = false;
const bool skip_test_E0_0326 = false;
const bool skip_test_E0_0327 = false;
const bool skip_test_E0_0328 = false;
const bool skip_test_E0_0329 = false;
const bool skip_test_E0_032A = false;
const bool skip_test_E0_032B = false;
const bool skip_test_E0_032C = false;
const bool skip_test_E0_032D = false;
const bool skip_test_E0_032E = false;
const bool skip_test_E0_032F = false;
const bool skip_test_E0_0330 = false;
const bool skip_test_E0_0331 = false;
const bool skip_test_E0_0332 = false;
const bool skip_test_E0_0333 = false;
const bool skip_test_E0_0334 = false;
const bool skip_test_E0_0335 = false;
const bool skip_test_E0_0336 = false;
const bool skip_test_E0_0337 = false;
const bool skip_test_E0_0338 = false;
const bool skip_test_E0_0339 = false;
const bool skip_test_E0_033A = false;
const bool skip_test_E0_033B = false;
const bool skip_test_E0_033C = false;
const bool skip_test_E0_033D = false;
const bool skip_test_E0_033E = false;
const bool skip_test_E0_033F = false;
const bool skip_test_E0_0340 = false;
const bool skip_test_E0_0341 = false;
const bool skip_test_E0_0342 = true;
const bool skip_test_E0_0343 = false;
const bool skip_test_E0_0344 = false;
const bool skip_test_E0_0345 = true;
const bool skip_test_E0_0346 = false;
const bool skip_test_E0_0347 = false;
const bool skip_test_E0_0348 = false;
const bool skip_test_E0_0349 = false;
const bool skip_test_E0_034A = false;
const bool skip_test_E0_034B = false;
const bool skip_test_E0_034C = false;
const bool skip_test_E0_034D = false;
const bool skip_test_E0_034E = false;
const bool skip_test_E0_034F = false;
const bool skip_test_E0_0350 = false;
const bool skip_test_E0_0351 = false;
const bool skip_test_E0_0352 = false;
const bool skip_test_E0_0353 = false;
const bool skip_test_E0_0354 = false;
const bool skip_test_E0_0355 = false;
const bool skip_test_E0_0356 = false;
const bool skip_test_E0_0357 = false;
const bool skip_test_E0_0358 = false;
const bool skip_test_E0_0359 = false;
const bool skip_test_E0_035A = false;
const bool skip_test_E0_035B = false;
const bool skip_test_E0_035C = false;
const bool skip_test_E0_035D = false;
const bool skip_test_E0_035E = false;
const bool skip_test_E0_035F = false;
const bool skip_test_E0_0360 = false;
const bool skip_test_E0_0361 = false;
const bool skip_test_E0_0362 = false;
const bool skip_test_E0_0363 = false;
const bool skip_test_E0_0364 = false;
const bool skip_test_E0_0365 = false;
const bool skip_test_E0_0366 = false;
const bool skip_test_E0_0367 = false;
const bool skip_test_E0_0368 = false;
const bool skip_test_E0_0369 = false;
const bool skip_test_E0_036A = false;
const bool skip_test_E0_036B = false;
const bool skip_test_E0_036C = false;
const bool skip_test_E0_036D = false;
const bool skip_test_E0_036E = false;
const bool skip_test_E0_036F = false;
const bool skip_test_E0_0370 = false;
const bool skip_test_E0_0371 = false;
const bool skip_test_E0_0372 = false;
const bool skip_test_E0_0373 = false;
const bool skip_test_E0_0374 = false;
const bool skip_test_E0_0375 = false;
const bool skip_test_E0_0376 = false;
const bool skip_test_E0_0377 = false;
const bool skip_test_E0_0378 = false;
const bool skip_test_E0_0379 = false;
const bool skip_test_E0_037A = false;
const bool skip_test_E0_037B = false;
const bool skip_test_E0_037C = false;
const bool skip_test_E0_037D = false;
const bool skip_test_E0_037E = false;
const bool skip_test_E0_037F = false;
const bool skip_test_E0_0380 = false;
const bool skip_test_E0_0381 = false;
const bool skip_test_E0_0382 = false;
const bool skip_test_E0_0383 = false;
const bool skip_test_E0_0384 = false;
const bool skip_test_E0_0385 = false;
const bool skip_test_E0_0386 = false;
const bool skip_test_E0_0387 = false;
const bool skip_test_E0_0388 = false;
const bool skip_test_E0_0389 = false;
const bool skip_test_E0_038A = false;
const bool skip_test_E0_038B = false;
const bool skip_test_E0_038C = false;
const bool skip_test_E0_038D = false;
const bool skip_test_E0_038E = false;
const bool skip_test_E0_038F = false;
const bool skip_test_E0_0390 = false;
const bool skip_test_E0_0391 = false;
const bool skip_test_E0_0392 = false;
const bool skip_test_E0_0393 = false;
const bool skip_test_E0_0394 = false;
const bool skip_test_E0_0395 = false;
const bool skip_test_E0_0396 = false;
const bool skip_test_E0_0397 = false;
const bool skip_test_E0_0398 = false;
const bool skip_test_E0_0399 = false;
const bool skip_test_E0_039A = false;
const bool skip_test_E0_039B = false;
const bool skip_test_E0_039C = false;
const bool skip_test_E0_039D = false;
const bool skip_test_E0_039E = false;
const bool skip_test_E0_039F = false;
const bool skip_test_E0_03A0 = false;
const bool skip_test_E0_03A1 = false;
const bool skip_test_E0_03A2 = false;
const bool skip_test_E0_03A3 = true;
const bool skip_test_E0_03A4 = false;
const bool skip_test_E0_03A5 = false;
const bool skip_test_E0_03A6 = false;
const bool skip_test_E0_03A7 = false;
const bool skip_test_E0_03A8 = false;
const bool skip_test_E0_03A9 = false;
const bool skip_test_E0_03AA = false;
const bool skip_test_E0_03AB = false;
const bool skip_test_E0_03AC = false;
const bool skip_test_E0_03AD = false;
const bool skip_test_E0_03AE = false;
const bool skip_test_E0_03AF = false;
const bool skip_test_E0_03B0 = false;
const bool skip_test_E0_03B1 = false;
const bool skip_test_E0_03B2 = false;
const bool skip_test_E0_03B3 = false;
const bool skip_test_E0_03B4 = false;
const bool skip_test_E0_03B5 = false;
const bool skip_test_E0_03B6 = false;
const bool skip_test_E0_03B7 = false;
const bool skip_test_E0_03B8 = false;
const bool skip_test_E0_03B9 = false;
const bool skip_test_E0_03BA = false;
const bool skip_test_E0_03BB = false;
const bool skip_test_E0_03BC = false;
const bool skip_test_E0_03BD = false;
const bool skip_test_E0_03BE = false;
const bool skip_test_E0_03BF = false;
const bool skip_test_E0_03C0 = false;
const bool skip_test_E0_03C1 = false;
const bool skip_test_E0_03C2 = false;
const bool skip_test_E0_03C3 = false;
const bool skip_test_E0_03C4 = false;
const bool skip_test_E0_03C5 = false;
const bool skip_test_E0_03C6 = false;
const bool skip_test_E0_03C7 = false;
const bool skip_test_E0_03C8 = false;
const bool skip_test_E0_03C9 = false;
const bool skip_test_E0_03CA = false;
const bool skip_test_E0_03CB = false;
const bool skip_test_E0_03CC = false;
const bool skip_test_E0_03CD = false;
const bool skip_test_E0_03CE = false;
const bool skip_test_E0_03CF = false;
const bool skip_test_E0_03D0 = false;
const bool skip_test_E0_03D1 = false;
const bool skip_test_E0_03D2 = false;
const bool skip_test_E0_03D3 = false;
const bool skip_test_E0_03D4 = false;
const bool skip_test_E0_03D5 = false;
const bool skip_test_E0_03D6 = false;
const bool skip_test_E0_03D7 = false;
const bool skip_test_E0_03D8 = false;
const bool skip_test_E0_03D9 = false;
const bool skip_test_E0_03DA = false;
const bool skip_test_E0_03DB = false;
const bool skip_test_E0_03DC = false;
const bool skip_test_E0_03DD = false;
const bool skip_test_E0_03DE = false;
const bool skip_test_E0_03DF = false;
const bool skip_test_E0_03E0 = false;
const bool skip_test_E0_03E1 = false;
const bool skip_test_E0_03E2 = false;
const bool skip_test_E0_03E3 = false;
const bool skip_test_E0_03E4 = false;
const bool skip_test_E0_03E5 = false;
const bool skip_test_E0_03E6 = false;
const bool skip_test_E0_03E7 = false;
void test_E0_0000(void);
void test_E0_0001(void);
void test_E0_0002(void);
void test_E0_0003(void);
void test_E0_0004(void);
void test_E0_0005(void);
void test_E0_0006(void);
void test_E0_0007(void);
void test_E0_0008(void);
void test_E0_0009(void);
void test_E0_000A(void);
void test_E0_000B(void);
void test_E0_000C(void);
void test_E0_000D(void);
void test_E0_000E(void);
void test_E0_000F(void);
void test_E0_0010(void);
void test_E0_0011(void);
void test_E0_0012(void);
void test_E0_0013(void);
void test_E0_0014(void);
void test_E0_0015(void);
void test_E0_0016(void);
void test_E0_0017(void);
void test_E0_0018(void);
void test_E0_0019(void);
void test_E0_001A(void);
void test_E0_001B(void);
void test_E0_001C(void);
void test_E0_001D(void);
void test_E0_001E(void);
void test_E0_001F(void);
void test_E0_0020(void);
void test_E0_0021(void);
void test_E0_0022(void);
void test_E0_0023(void);
void test_E0_0024(void);
void test_E0_0025(void);
void test_E0_0026(void);
void test_E0_0027(void);
void test_E0_0028(void);
void test_E0_0029(void);
void test_E0_002A(void);
void test_E0_002B(void);
void test_E0_002C(void);
void test_E0_002D(void);
void test_E0_002E(void);
void test_E0_002F(void);
void test_E0_0030(void);
void test_E0_0031(void);
void test_E0_0032(void);
void test_E0_0033(void);
void test_E0_0034(void);
void test_E0_0035(void);
void test_E0_0036(void);
void test_E0_0037(void);
void test_E0_0038(void);
void test_E0_0039(void);
void test_E0_003A(void);
void test_E0_003B(void);
void test_E0_003C(void);
void test_E0_003D(void);
void test_E0_003E(void);
void test_E0_003F(void);
void test_E0_0040(void);
void test_E0_0041(void);
void test_E0_0042(void);
void test_E0_0043(void);
void test_E0_0044(void);
void test_E0_0045(void);
void test_E0_0046(void);
void test_E0_0047(void);
void test_E0_0048(void);
void test_E0_0049(void);
void test_E0_004A(void);
void test_E0_004B(void);
void test_E0_004C(void);
void test_E0_004D(void);
void test_E0_004E(void);
void test_E0_004F(void);
void test_E0_0050(void);
void test_E0_0051(void);
void test_E0_0052(void);
void test_E0_0053(void);
void test_E0_0054(void);
void test_E0_0055(void);
void test_E0_0056(void);
void test_E0_0057(void);
void test_E0_0058(void);
void test_E0_0059(void);
void test_E0_005A(void);
void test_E0_005B(void);
void test_E0_005C(void);
void test_E0_005D(void);
void test_E0_005E(void);
void test_E0_005F(void);
void test_E0_0060(void);
void test_E0_0061(void);
void test_E0_0062(void);
void test_E0_0063(void);
void test_E0_0064(void);
void test_E0_0065(void);
void test_E0_0066(void);
void test_E0_0067(void);
void test_E0_0068(void);
void test_E0_0069(void);
void test_E0_006A(void);
void test_E0_006B(void);
void test_E0_006C(void);
void test_E0_006D(void);
void test_E0_006E(void);
void test_E0_006F(void);
void test_E0_0070(void);
void test_E0_0071(void);
void test_E0_0072(void);
void test_E0_0073(void);
void test_E0_0074(void);
void test_E0_0075(void);
void test_E0_0076(void);
void test_E0_0077(void);
void test_E0_0078(void);
void test_E0_0079(void);
void test_E0_007A(void);
void test_E0_007B(void);
void test_E0_007C(void);
void test_E0_007D(void);
void test_E0_007E(void);
void test_E0_007F(void);
void test_E0_0080(void);
void test_E0_0081(void);
void test_E0_0082(void);
void test_E0_0083(void);
void test_E0_0084(void);
void test_E0_0085(void);
void test_E0_0086(void);
void test_E0_0087(void);
void test_E0_0088(void);
void test_E0_0089(void);
void test_E0_008A(void);
void test_E0_008B(void);
void test_E0_008C(void);
void test_E0_008D(void);
void test_E0_008E(void);
void test_E0_008F(void);
void test_E0_0090(void);
void test_E0_0091(void);
void test_E0_0092(void);
void test_E0_0093(void);
void test_E0_0094(void);
void test_E0_0095(void);
void test_E0_0096(void);
void test_E0_0097(void);
void test_E0_0098(void);
void test_E0_0099(void);
void test_E0_009A(void);
void test_E0_009B(void);
void test_E0_009C(void);
void test_E0_009D(void);
void test_E0_009E(void);
void test_E0_009F(void);
void test_E0_00A0(void);
void test_E0_00A1(void);
void test_E0_00A2(void);
void test_E0_00A3(void);
void test_E0_00A4(void);
void test_E0_00A5(void);
void test_E0_00A6(void);
void test_E0_00A7(void);
void test_E0_00A8(void);
void test_E0_00A9(void);
void test_E0_00AA(void);
void test_E0_00AB(void);
void test_E0_00AC(void);
void test_E0_00AD(void);
void test_E0_00AE(void);
void test_E0_00AF(void);
void test_E0_00B0(void);
void test_E0_00B1(void);
void test_E0_00B2(void);
void test_E0_00B3(void);
void test_E0_00B4(void);
void test_E0_00B5(void);
void test_E0_00B6(void);
void test_E0_00B7(void);
void test_E0_00B8(void);
void test_E0_00B9(void);
void test_E0_00BA(void);
void test_E0_00BB(void);
void test_E0_00BC(void);
void test_E0_00BD(void);
void test_E0_00BE(void);
void test_E0_00BF(void);
void test_E0_00C0(void);
void test_E0_00C1(void);
void test_E0_00C2(void);
void test_E0_00C3(void);
void test_E0_00C4(void);
void test_E0_00C5(void);
void test_E0_00C6(void);
void test_E0_00C7(void);
void test_E0_00C8(void);
void test_E0_00C9(void);
void test_E0_00CA(void);
void test_E0_00CB(void);
void test_E0_00CC(void);
void test_E0_00CD(void);
void test_E0_00CE(void);
void test_E0_00CF(void);
void test_E0_00D0(void);
void test_E0_00D1(void);
void test_E0_00D2(void);
void test_E0_00D3(void);
void test_E0_00D4(void);
void test_E0_00D5(void);
void test_E0_00D6(void);
void test_E0_00D7(void);
void test_E0_00D8(void);
void test_E0_00D9(void);
void test_E0_00DA(void);
void test_E0_00DB(void);
void test_E0_00DC(void);
void test_E0_00DD(void);
void test_E0_00DE(void);
void test_E0_00DF(void);
void test_E0_00E0(void);
void test_E0_00E1(void);
void test_E0_00E2(void);
void test_E0_00E3(void);
void test_E0_00E4(void);
void test_E0_00E5(void);
void test_E0_00E6(void);
void test_E0_00E7(void);
void test_E0_00E8(void);
void test_E0_00E9(void);
void test_E0_00EA(void);
void test_E0_00EB(void);
void test_E0_00EC(void);
void test_E0_00ED(void);
void test_E0_00EE(void);
void test_E0_00EF(void);
void test_E0_00F0(void);
void test_E0_00F1(void);
void test_E0_00F2(void);
void test_E0_00F3(void);
void test_E0_00F4(void);
void test_E0_00F5(void);
void test_E0_00F6(void);
void test_E0_00F7(void);
void test_E0_00F8(void);
void test_E0_00F9(void);
void test_E0_00FA(void);
void test_E0_00FB(void);
void test_E0_00FC(void);
void test_E0_00FD(void);
void test_E0_00FE(void);
void test_E0_00FF(void);
void test_E0_0100(void);
void test_E0_0101(void);
void test_E0_0102(void);
void test_E0_0103(void);
void test_E0_0104(void);
void test_E0_0105(void);
void test_E0_0106(void);
void test_E0_0107(void);
void test_E0_0108(void);
void test_E0_0109(void);
void test_E0_010A(void);
void test_E0_010B(void);
void test_E0_010C(void);
void test_E0_010D(void);
void test_E0_010E(void);
void test_E0_010F(void);
void test_E0_0110(void);
void test_E0_0111(void);
void test_E0_0112(void);
void test_E0_0113(void);
void test_E0_0114(void);
void test_E0_0115(void);
void test_E0_0116(void);
void test_E0_0117(void);
void test_E0_0118(void);
void test_E0_0119(void);
void test_E0_011A(void);
void test_E0_011B(void);
void test_E0_011C(void);
void test_E0_011D(void);
void test_E0_011E(void);
void test_E0_011F(void);
void test_E0_0120(void);
void test_E0_0121(void);
void test_E0_0122(void);
void test_E0_0123(void);
void test_E0_0124(void);
void test_E0_0125(void);
void test_E0_0126(void);
void test_E0_0127(void);
void test_E0_0128(void);
void test_E0_0129(void);
void test_E0_012A(void);
void test_E0_012B(void);
void test_E0_012C(void);
void test_E0_012D(void);
void test_E0_012E(void);
void test_E0_012F(void);
void test_E0_0130(void);
void test_E0_0131(void);
void test_E0_0132(void);
void test_E0_0133(void);
void test_E0_0134(void);
void test_E0_0135(void);
void test_E0_0136(void);
void test_E0_0137(void);
void test_E0_0138(void);
void test_E0_0139(void);
void test_E0_013A(void);
void test_E0_013B(void);
void test_E0_013C(void);
void test_E0_013D(void);
void test_E0_013E(void);
void test_E0_013F(void);
void test_E0_0140(void);
void test_E0_0141(void);
void test_E0_0142(void);
void test_E0_0143(void);
void test_E0_0144(void);
void test_E0_0145(void);
void test_E0_0146(void);
void test_E0_0147(void);
void test_E0_0148(void);
void test_E0_0149(void);
void test_E0_014A(void);
void test_E0_014B(void);
void test_E0_014C(void);
void test_E0_014D(void);
void test_E0_014E(void);
void test_E0_014F(void);
void test_E0_0150(void);
void test_E0_0151(void);
void test_E0_0152(void);
void test_E0_0153(void);
void test_E0_0154(void);
void test_E0_0155(void);
void test_E0_0156(void);
void test_E0_0157(void);
void test_E0_0158(void);
void test_E0_0159(void);
void test_E0_015A(void);
void test_E0_015B(void);
void test_E0_015C(void);
void test_E0_015D(void);
void test_E0_015E(void);
void test_E0_015F(void);
void test_E0_0160(void);
void test_E0_0161(void);
void test_E0_0162(void);
void test_E0_0163(void);
void test_E0_0164(void);
void test_E0_0165(void);
void test_E0_0166(void);
void test_E0_0167(void);
void test_E0_0168(void);
void test_E0_0169(void);
void test_E0_016A(void);
void test_E0_016B(void);
void test_E0_016C(void);
void test_E0_016D(void);
void test_E0_016E(void);
void test_E0_016F(void);
void test_E0_0170(void);
void test_E0_0171(void);
void test_E0_0172(void);
void test_E0_0173(void);
void test_E0_0174(void);
void test_E0_0175(void);
void test_E0_0176(void);
void test_E0_0177(void);
void test_E0_0178(void);
void test_E0_0179(void);
void test_E0_017A(void);
void test_E0_017B(void);
void test_E0_017C(void);
void test_E0_017D(void);
void test_E0_017E(void);
void test_E0_017F(void);
void test_E0_0180(void);
void test_E0_0181(void);
void test_E0_0182(void);
void test_E0_0183(void);
void test_E0_0184(void);
void test_E0_0185(void);
void test_E0_0186(void);
void test_E0_0187(void);
void test_E0_0188(void);
void test_E0_0189(void);
void test_E0_018A(void);
void test_E0_018B(void);
void test_E0_018C(void);
void test_E0_018D(void);
void test_E0_018E(void);
void test_E0_018F(void);
void test_E0_0190(void);
void test_E0_0191(void);
void test_E0_0192(void);
void test_E0_0193(void);
void test_E0_0194(void);
void test_E0_0195(void);
void test_E0_0196(void);
void test_E0_0197(void);
void test_E0_0198(void);
void test_E0_0199(void);
void test_E0_019A(void);
void test_E0_019B(void);
void test_E0_019C(void);
void test_E0_019D(void);
void test_E0_019E(void);
void test_E0_019F(void);
void test_E0_01A0(void);
void test_E0_01A1(void);
void test_E0_01A2(void);
void test_E0_01A3(void);
void test_E0_01A4(void);
void test_E0_01A5(void);
void test_E0_01A6(void);
void test_E0_01A7(void);
void test_E0_01A8(void);
void test_E0_01A9(void);
void test_E0_01AA(void);
void test_E0_01AB(void);
void test_E0_01AC(void);
void test_E0_01AD(void);
void test_E0_01AE(void);
void test_E0_01AF(void);
void test_E0_01B0(void);
void test_E0_01B1(void);
void test_E0_01B2(void);
void test_E0_01B3(void);
void test_E0_01B4(void);
void test_E0_01B5(void);
void test_E0_01B6(void);
void test_E0_01B7(void);
void test_E0_01B8(void);
void test_E0_01B9(void);
void test_E0_01BA(void);
void test_E0_01BB(void);
void test_E0_01BC(void);
void test_E0_01BD(void);
void test_E0_01BE(void);
void test_E0_01BF(void);
void test_E0_01C0(void);
void test_E0_01C1(void);
void test_E0_01C2(void);
void test_E0_01C3(void);
void test_E0_01C4(void);
void test_E0_01C5(void);
void test_E0_01C6(void);
void test_E0_01C7(void);
void test_E0_01C8(void);
void test_E0_01C9(void);
void test_E0_01CA(void);
void test_E0_01CB(void);
void test_E0_01CC(void);
void test_E0_01CD(void);
void test_E0_01CE(void);
void test_E0_01CF(void);
void test_E0_01D0(void);
void test_E0_01D1(void);
void test_E0_01D2(void);
void test_E0_01D3(void);
void test_E0_01D4(void);
void test_E0_01D5(void);
void test_E0_01D6(void);
void test_E0_01D7(void);
void test_E0_01D8(void);
void test_E0_01D9(void);
void test_E0_01DA(void);
void test_E0_01DB(void);
void test_E0_01DC(void);
void test_E0_01DD(void);
void test_E0_01DE(void);
void test_E0_01DF(void);
void test_E0_01E0(void);
void test_E0_01E1(void);
void test_E0_01E2(void);
void test_E0_01E3(void);
void test_E0_01E4(void);
void test_E0_01E5(void);
void test_E0_01E6(void);
void test_E0_01E7(void);
void test_E0_01E8(void);
void test_E0_01E9(void);
void test_E0_01EA(void);
void test_E0_01EB(void);
void test_E0_01EC(void);
void test_E0_01ED(void);
void test_E0_01EE(void);
void test_E0_01EF(void);
void test_E0_01F0(void);
void test_E0_01F1(void);
void test_E0_01F2(void);
void test_E0_01F3(void);
void test_E0_01F4(void);
void test_E0_01F5(void);
void test_E0_01F6(void);
void test_E0_01F7(void);
void test_E0_01F8(void);
void test_E0_01F9(void);
void test_E0_01FA(void);
void test_E0_01FB(void);
void test_E0_01FC(void);
void test_E0_01FD(void);
void test_E0_01FE(void);
void test_E0_01FF(void);
void test_E0_0200(void);
void test_E0_0201(void);
void test_E0_0202(void);
void test_E0_0203(void);
void test_E0_0204(void);
void test_E0_0205(void);
void test_E0_0206(void);
void test_E0_0207(void);
void test_E0_0208(void);
void test_E0_0209(void);
void test_E0_020A(void);
void test_E0_020B(void);
void test_E0_020C(void);
void test_E0_020D(void);
void test_E0_020E(void);
void test_E0_020F(void);
void test_E0_0210(void);
void test_E0_0211(void);
void test_E0_0212(void);
void test_E0_0213(void);
void test_E0_0214(void);
void test_E0_0215(void);
void test_E0_0216(void);
void test_E0_0217(void);
void test_E0_0218(void);
void test_E0_0219(void);
void test_E0_021A(void);
void test_E0_021B(void);
void test_E0_021C(void);
void test_E0_021D(void);
void test_E0_021E(void);
void test_E0_021F(void);
void test_E0_0220(void);
void test_E0_0221(void);
void test_E0_0222(void);
void test_E0_0223(void);
void test_E0_0224(void);
void test_E0_0225(void);
void test_E0_0226(void);
void test_E0_0227(void);
void test_E0_0228(void);
void test_E0_0229(void);
void test_E0_022A(void);
void test_E0_022B(void);
void test_E0_022C(void);
void test_E0_022D(void);
void test_E0_022E(void);
void test_E0_022F(void);
void test_E0_0230(void);
void test_E0_0231(void);
void test_E0_0232(void);
void test_E0_0233(void);
void test_E0_0234(void);
void test_E0_0235(void);
void test_E0_0236(void);
void test_E0_0237(void);
void test_E0_0238(void);
void test_E0_0239(void);
void test_E0_023A(void);
void test_E0_023B(void);
void test_E0_023C(void);
void test_E0_023D(void);
void test_E0_023E(void);
void test_E0_023F(void);
void test_E0_0240(void);
void test_E0_0241(void);
void test_E0_0242(void);
void test_E0_0243(void);
void test_E0_0244(void);
void test_E0_0245(void);
void test_E0_0246(void);
void test_E0_0247(void);
void test_E0_0248(void);
void test_E0_0249(void);
void test_E0_024A(void);
void test_E0_024B(void);
void test_E0_024C(void);
void test_E0_024D(void);
void test_E0_024E(void);
void test_E0_024F(void);
void test_E0_0250(void);
void test_E0_0251(void);
void test_E0_0252(void);
void test_E0_0253(void);
void test_E0_0254(void);
void test_E0_0255(void);
void test_E0_0256(void);
void test_E0_0257(void);
void test_E0_0258(void);
void test_E0_0259(void);
void test_E0_025A(void);
void test_E0_025B(void);
void test_E0_025C(void);
void test_E0_025D(void);
void test_E0_025E(void);
void test_E0_025F(void);
void test_E0_0260(void);
void test_E0_0261(void);
void test_E0_0262(void);
void test_E0_0263(void);
void test_E0_0264(void);
void test_E0_0265(void);
void test_E0_0266(void);
void test_E0_0267(void);
void test_E0_0268(void);
void test_E0_0269(void);
void test_E0_026A(void);
void test_E0_026B(void);
void test_E0_026C(void);
void test_E0_026D(void);
void test_E0_026E(void);
void test_E0_026F(void);
void test_E0_0270(void);
void test_E0_0271(void);
void test_E0_0272(void);
void test_E0_0273(void);
void test_E0_0274(void);
void test_E0_0275(void);
void test_E0_0276(void);
void test_E0_0277(void);
void test_E0_0278(void);
void test_E0_0279(void);
void test_E0_027A(void);
void test_E0_027B(void);
void test_E0_027C(void);
void test_E0_027D(void);
void test_E0_027E(void);
void test_E0_027F(void);
void test_E0_0280(void);
void test_E0_0281(void);
void test_E0_0282(void);
void test_E0_0283(void);
void test_E0_0284(void);
void test_E0_0285(void);
void test_E0_0286(void);
void test_E0_0287(void);
void test_E0_0288(void);
void test_E0_0289(void);
void test_E0_028A(void);
void test_E0_028B(void);
void test_E0_028C(void);
void test_E0_028D(void);
void test_E0_028E(void);
void test_E0_028F(void);
void test_E0_0290(void);
void test_E0_0291(void);
void test_E0_0292(void);
void test_E0_0293(void);
void test_E0_0294(void);
void test_E0_0295(void);
void test_E0_0296(void);
void test_E0_0297(void);
void test_E0_0298(void);
void test_E0_0299(void);
void test_E0_029A(void);
void test_E0_029B(void);
void test_E0_029C(void);
void test_E0_029D(void);
void test_E0_029E(void);
void test_E0_029F(void);
void test_E0_02A0(void);
void test_E0_02A1(void);
void test_E0_02A2(void);
void test_E0_02A3(void);
void test_E0_02A4(void);
void test_E0_02A5(void);
void test_E0_02A6(void);
void test_E0_02A7(void);
void test_E0_02A8(void);
void test_E0_02A9(void);
void test_E0_02AA(void);
void test_E0_02AB(void);
void test_E0_02AC(void);
void test_E0_02AD(void);
void test_E0_02AE(void);
void test_E0_02AF(void);
void test_E0_02B0(void);
void test_E0_02B1(void);
void test_E0_02B2(void);
void test_E0_02B3(void);
void test_E0_02B4(void);
void test_E0_02B5(void);
void test_E0_02B6(void);
void test_E0_02B7(void);
void test_E0_02B8(void);
void test_E0_02B9(void);
void test_E0_02BA(void);
void test_E0_02BB(void);
void test_E0_02BC(void);
void test_E0_02BD(void);
void test_E0_02BE(void);
void test_E0_02BF(void);
void test_E0_02C0(void);
void test_E0_02C1(void);
void test_E0_02C2(void);
void test_E0_02C3(void);
void test_E0_02C4(void);
void test_E0_02C5(void);
void test_E0_02C6(void);
void test_E0_02C7(void);
void test_E0_02C8(void);
void test_E0_02C9(void);
void test_E0_02CA(void);
void test_E0_02CB(void);
void test_E0_02CC(void);
void test_E0_02CD(void);
void test_E0_02CE(void);
void test_E0_02CF(void);
void test_E0_02D0(void);
void test_E0_02D1(void);
void test_E0_02D2(void);
void test_E0_02D3(void);
void test_E0_02D4(void);
void test_E0_02D5(void);
void test_E0_02D6(void);
void test_E0_02D7(void);
void test_E0_02D8(void);
void test_E0_02D9(void);
void test_E0_02DA(void);
void test_E0_02DB(void);
void test_E0_02DC(void);
void test_E0_02DD(void);
void test_E0_02DE(void);
void test_E0_02DF(void);
void test_E0_02E0(void);
void test_E0_02E1(void);
void test_E0_02E2(void);
void test_E0_02E3(void);
void test_E0_02E4(void);
void test_E0_02E5(void);
void test_E0_02E6(void);
void test_E0_02E7(void);
void test_E0_02E8(void);
void test_E0_02E9(void);
void test_E0_02EA(void);
void test_E0_02EB(void);
void test_E0_02EC(void);
void test_E0_02ED(void);
void test_E0_02EE(void);
void test_E0_02EF(void);
void test_E0_02F0(void);
void test_E0_02F1(void);
void test_E0_02F2(void);
void test_E0_02F3(void);
void test_E0_02F4(void);
void test_E0_02F5(void);
void test_E0_02F6(void);
void test_E0_02F7(void);
void test_E0_02F8(void);
void test_E0_02F9(void);
void test_E0_02FA(void);
void test_E0_02FB(void);
void test_E0_02FC(void);
void test_E0_02FD(void);
void test_E0_02FE(void);
void test_E0_02FF(void);
void test_E0_0300(void);
void test_E0_0301(void);
void test_E0_0302(void);
void test_E0_0303(void);
void test_E0_0304(void);
void test_E0_0305(void);
void test_E0_0306(void);
void test_E0_0307(void);
void test_E0_0308(void);
void test_E0_0309(void);
void test_E0_030A(void);
void test_E0_030B(void);
void test_E0_030C(void);
void test_E0_030D(void);
void test_E0_030E(void);
void test_E0_030F(void);
void test_E0_0310(void);
void test_E0_0311(void);
void test_E0_0312(void);
void test_E0_0313(void);
void test_E0_0314(void);
void test_E0_0315(void);
void test_E0_0316(void);
void test_E0_0317(void);
void test_E0_0318(void);
void test_E0_0319(void);
void test_E0_031A(void);
void test_E0_031B(void);
void test_E0_031C(void);
void test_E0_031D(void);
void test_E0_031E(void);
void test_E0_031F(void);
void test_E0_0320(void);
void test_E0_0321(void);
void test_E0_0322(void);
void test_E0_0323(void);
void test_E0_0324(void);
void test_E0_0325(void);
void test_E0_0326(void);
void test_E0_0327(void);
void test_E0_0328(void);
void test_E0_0329(void);
void test_E0_032A(void);
void test_E0_032B(void);
void test_E0_032C(void);
void test_E0_032D(void);
void test_E0_032E(void);
void test_E0_032F(void);
void test_E0_0330(void);
void test_E0_0331(void);
void test_E0_0332(void);
void test_E0_0333(void);
void test_E0_0334(void);
void test_E0_0335(void);
void test_E0_0336(void);
void test_E0_0337(void);
void test_E0_0338(void);
void test_E0_0339(void);
void test_E0_033A(void);
void test_E0_033B(void);
void test_E0_033C(void);
void test_E0_033D(void);
void test_E0_033E(void);
void test_E0_033F(void);
void test_E0_0340(void);
void test_E0_0341(void);
void test_E0_0342(void);
void test_E0_0343(void);
void test_E0_0344(void);
void test_E0_0345(void);
void test_E0_0346(void);
void test_E0_0347(void);
void test_E0_0348(void);
void test_E0_0349(void);
void test_E0_034A(void);
void test_E0_034B(void);
void test_E0_034C(void);
void test_E0_034D(void);
void test_E0_034E(void);
void test_E0_034F(void);
void test_E0_0350(void);
void test_E0_0351(void);
void test_E0_0352(void);
void test_E0_0353(void);
void test_E0_0354(void);
void test_E0_0355(void);
void test_E0_0356(void);
void test_E0_0357(void);
void test_E0_0358(void);
void test_E0_0359(void);
void test_E0_035A(void);
void test_E0_035B(void);
void test_E0_035C(void);
void test_E0_035D(void);
void test_E0_035E(void);
void test_E0_035F(void);
void test_E0_0360(void);
void test_E0_0361(void);
void test_E0_0362(void);
void test_E0_0363(void);
void test_E0_0364(void);
void test_E0_0365(void);
void test_E0_0366(void);
void test_E0_0367(void);
void test_E0_0368(void);
void test_E0_0369(void);
void test_E0_036A(void);
void test_E0_036B(void);
void test_E0_036C(void);
void test_E0_036D(void);
void test_E0_036E(void);
void test_E0_036F(void);
void test_E0_0370(void);
void test_E0_0371(void);
void test_E0_0372(void);
void test_E0_0373(void);
void test_E0_0374(void);
void test_E0_0375(void);
void test_E0_0376(void);
void test_E0_0377(void);
void test_E0_0378(void);
void test_E0_0379(void);
void test_E0_037A(void);
void test_E0_037B(void);
void test_E0_037C(void);
void test_E0_037D(void);
void test_E0_037E(void);
void test_E0_037F(void);
void test_E0_0380(void);
void test_E0_0381(void);
void test_E0_0382(void);
void test_E0_0383(void);
void test_E0_0384(void);
void test_E0_0385(void);
void test_E0_0386(void);
void test_E0_0387(void);
void test_E0_0388(void);
void test_E0_0389(void);
void test_E0_038A(void);
void test_E0_038B(void);
void test_E0_038C(void);
void test_E0_038D(void);
void test_E0_038E(void);
void test_E0_038F(void);
void test_E0_0390(void);
void test_E0_0391(void);
void test_E0_0392(void);
void test_E0_0393(void);
void test_E0_0394(void);
void test_E0_0395(void);
void test_E0_0396(void);
void test_E0_0397(void);
void test_E0_0398(void);
void test_E0_0399(void);
void test_E0_039A(void);
void test_E0_039B(void);
void test_E0_039C(void);
void test_E0_039D(void);
void test_E0_039E(void);
void test_E0_039F(void);
void test_E0_03A0(void);
void test_E0_03A1(void);
void test_E0_03A2(void);
void test_E0_03A3(void);
void test_E0_03A4(void);
void test_E0_03A5(void);
void test_E0_03A6(void);
void test_E0_03A7(void);
void test_E0_03A8(void);
void test_E0_03A9(void);
void test_E0_03AA(void);
void test_E0_03AB(void);
void test_E0_03AC(void);
void test_E0_03AD(void);
void test_E0_03AE(void);
void test_E0_03AF(void);
void test_E0_03B0(void);
void test_E0_03B1(void);
void test_E0_03B2(void);
void test_E0_03B3(void);
void test_E0_03B4(void);
void test_E0_03B5(void);
void test_E0_03B6(void);
void test_E0_03B7(void);
void test_E0_03B8(void);
void test_E0_03B9(void);
void test_E0_03BA(void);
void test_E0_03BB(void);
void test_E0_03BC(void);
void test_E0_03BD(void);
void test_E0_03BE(void);
void test_E0_03BF(void);
void test_E0_03C0(void);
void test_E0_03C1(void);
void test_E0_03C2(void);
void test_E0_03C3(void);
void test_E0_03C4(void);
void test_E0_03C5(void);
void test_E0_03C6(void);
void test_E0_03C7(void);
void test_E0_03C8(void);
void test_E0_03C9(void);
void test_E0_03CA(void);
void test_E0_03CB(void);
void test_E0_03CC(void);
void test_E0_03CD(void);
void test_E0_03CE(void);
void test_E0_03CF(void);
void test_E0_03D0(void);
void test_E0_03D1(void);
void test_E0_03D2(void);
void test_E0_03D3(void);
void test_E0_03D4(void);
void test_E0_03D5(void);
void test_E0_03D6(void);
void test_E0_03D7(void);
void test_E0_03D8(void);
void test_E0_03D9(void);
void test_E0_03DA(void);
void test_E0_03DB(void);
void test_E0_03DC(void);
void test_E0_03DD(void);
void test_E0_03DE(void);
void test_E0_03DF(void);
void test_E0_03E0(void);
void test_E0_03E1(void);
void test_E0_03E2(void);
void test_E0_03E3(void);
void test_E0_03E4(void);
void test_E0_03E5(void);
void test_E0_03E6(void);
void test_E0_03E7(void);
TEST_LIST = {
    { "E0_0000", test_E0_0000 },
    { "E0_0001", test_E0_0001 },
    { "E0_0002", test_E0_0002 },
    { "E0_0003", test_E0_0003 },
    { "E0_0004", test_E0_0004 },
    { "E0_0005", test_E0_0005 },
    { "E0_0006", test_E0_0006 },
    { "E0_0007", test_E0_0007 },
    { "E0_0008", test_E0_0008 },
    { "E0_0009", test_E0_0009 },
    { "E0_000A", test_E0_000A },
    { "E0_000B", test_E0_000B },
    { "E0_000C", test_E0_000C },
    { "E0_000D", test_E0_000D },
    { "E0_000E", test_E0_000E },
    { "E0_000F", test_E0_000F },
    { "E0_0010", test_E0_0010 },
    { "E0_0011", test_E0_0011 },
    { "E0_0012", test_E0_0012 },
    { "E0_0013", test_E0_0013 },
    { "E0_0014", test_E0_0014 },
    { "E0_0015", test_E0_0015 },
    { "E0_0016", test_E0_0016 },
    { "E0_0017", test_E0_0017 },
    { "E0_0018", test_E0_0018 },
    { "E0_0019", test_E0_0019 },
    { "E0_001A", test_E0_001A },
    { "E0_001B", test_E0_001B },
    { "E0_001C", test_E0_001C },
    { "E0_001D", test_E0_001D },
    { "E0_001E", test_E0_001E },
    { "E0_001F", test_E0_001F },
    { "E0_0020", test_E0_0020 },
    { "E0_0021", test_E0_0021 },
    { "E0_0022", test_E0_0022 },
    { "E0_0023", test_E0_0023 },
    { "E0_0024", test_E0_0024 },
    { "E0_0025", test_E0_0025 },
    { "E0_0026", test_E0_0026 },
    { "E0_0027", test_E0_0027 },
    { "E0_0028", test_E0_0028 },
    { "E0_0029", test_E0_0029 },
    { "E0_002A", test_E0_002A },
    { "E0_002B", test_E0_002B },
    { "E0_002C", test_E0_002C },
    { "E0_002D", test_E0_002D },
    { "E0_002E", test_E0_002E },
    { "E0_002F", test_E0_002F },
    { "E0_0030", test_E0_0030 },
    { "E0_0031", test_E0_0031 },
    { "E0_0032", test_E0_0032 },
    { "E0_0033", test_E0_0033 },
    { "E0_0034", test_E0_0034 },
    { "E0_0035", test_E0_0035 },
    { "E0_0036", test_E0_0036 },
    { "E0_0037", test_E0_0037 },
    { "E0_0038", test_E0_0038 },
    { "E0_0039", test_E0_0039 },
    { "E0_003A", test_E0_003A },
    { "E0_003B", test_E0_003B },
    { "E0_003C", test_E0_003C },
    { "E0_003D", test_E0_003D },
    { "E0_003E", test_E0_003E },
    { "E0_003F", test_E0_003F },
    { "E0_0040", test_E0_0040 },
    { "E0_0041", test_E0_0041 },
    { "E0_0042", test_E0_0042 },
    { "E0_0043", test_E0_0043 },
    { "E0_0044", test_E0_0044 },
    { "E0_0045", test_E0_0045 },
    { "E0_0046", test_E0_0046 },
    { "E0_0047", test_E0_0047 },
    { "E0_0048", test_E0_0048 },
    { "E0_0049", test_E0_0049 },
    { "E0_004A", test_E0_004A },
    { "E0_004B", test_E0_004B },
    { "E0_004C", test_E0_004C },
    { "E0_004D", test_E0_004D },
    { "E0_004E", test_E0_004E },
    { "E0_004F", test_E0_004F },
    { "E0_0050", test_E0_0050 },
    { "E0_0051", test_E0_0051 },
    { "E0_0052", test_E0_0052 },
    { "E0_0053", test_E0_0053 },
    { "E0_0054", test_E0_0054 },
    { "E0_0055", test_E0_0055 },
    { "E0_0056", test_E0_0056 },
    { "E0_0057", test_E0_0057 },
    { "E0_0058", test_E0_0058 },
    { "E0_0059", test_E0_0059 },
    { "E0_005A", test_E0_005A },
    { "E0_005B", test_E0_005B },
    { "E0_005C", test_E0_005C },
    { "E0_005D", test_E0_005D },
    { "E0_005E", test_E0_005E },
    { "E0_005F", test_E0_005F },
    { "E0_0060", test_E0_0060 },
    { "E0_0061", test_E0_0061 },
    { "E0_0062", test_E0_0062 },
    { "E0_0063", test_E0_0063 },
    { "E0_0064", test_E0_0064 },
    { "E0_0065", test_E0_0065 },
    { "E0_0066", test_E0_0066 },
    { "E0_0067", test_E0_0067 },
    { "E0_0068", test_E0_0068 },
    { "E0_0069", test_E0_0069 },
    { "E0_006A", test_E0_006A },
    { "E0_006B", test_E0_006B },
    { "E0_006C", test_E0_006C },
    { "E0_006D", test_E0_006D },
    { "E0_006E", test_E0_006E },
    { "E0_006F", test_E0_006F },
    { "E0_0070", test_E0_0070 },
    { "E0_0071", test_E0_0071 },
    { "E0_0072", test_E0_0072 },
    { "E0_0073", test_E0_0073 },
    { "E0_0074", test_E0_0074 },
    { "E0_0075", test_E0_0075 },
    { "E0_0076", test_E0_0076 },
    { "E0_0077", test_E0_0077 },
    { "E0_0078", test_E0_0078 },
    { "E0_0079", test_E0_0079 },
    { "E0_007A", test_E0_007A },
    { "E0_007B", test_E0_007B },
    { "E0_007C", test_E0_007C },
    { "E0_007D", test_E0_007D },
    { "E0_007E", test_E0_007E },
    { "E0_007F", test_E0_007F },
    { "E0_0080", test_E0_0080 },
    { "E0_0081", test_E0_0081 },
    { "E0_0082", test_E0_0082 },
    { "E0_0083", test_E0_0083 },
    { "E0_0084", test_E0_0084 },
    { "E0_0085", test_E0_0085 },
    { "E0_0086", test_E0_0086 },
    { "E0_0087", test_E0_0087 },
    { "E0_0088", test_E0_0088 },
    { "E0_0089", test_E0_0089 },
    { "E0_008A", test_E0_008A },
    { "E0_008B", test_E0_008B },
    { "E0_008C", test_E0_008C },
    { "E0_008D", test_E0_008D },
    { "E0_008E", test_E0_008E },
    { "E0_008F", test_E0_008F },
    { "E0_0090", test_E0_0090 },
    { "E0_0091", test_E0_0091 },
    { "E0_0092", test_E0_0092 },
    { "E0_0093", test_E0_0093 },
    { "E0_0094", test_E0_0094 },
    { "E0_0095", test_E0_0095 },
    { "E0_0096", test_E0_0096 },
    { "E0_0097", test_E0_0097 },
    { "E0_0098", test_E0_0098 },
    { "E0_0099", test_E0_0099 },
    { "E0_009A", test_E0_009A },
    { "E0_009B", test_E0_009B },
    { "E0_009C", test_E0_009C },
    { "E0_009D", test_E0_009D },
    { "E0_009E", test_E0_009E },
    { "E0_009F", test_E0_009F },
    { "E0_00A0", test_E0_00A0 },
    { "E0_00A1", test_E0_00A1 },
    { "E0_00A2", test_E0_00A2 },
    { "E0_00A3", test_E0_00A3 },
    { "E0_00A4", test_E0_00A4 },
    { "E0_00A5", test_E0_00A5 },
    { "E0_00A6", test_E0_00A6 },
    { "E0_00A7", test_E0_00A7 },
    { "E0_00A8", test_E0_00A8 },
    { "E0_00A9", test_E0_00A9 },
    { "E0_00AA", test_E0_00AA },
    { "E0_00AB", test_E0_00AB },
    { "E0_00AC", test_E0_00AC },
    { "E0_00AD", test_E0_00AD },
    { "E0_00AE", test_E0_00AE },
    { "E0_00AF", test_E0_00AF },
    { "E0_00B0", test_E0_00B0 },
    { "E0_00B1", test_E0_00B1 },
    { "E0_00B2", test_E0_00B2 },
    { "E0_00B3", test_E0_00B3 },
    { "E0_00B4", test_E0_00B4 },
    { "E0_00B5", test_E0_00B5 },
    { "E0_00B6", test_E0_00B6 },
    { "E0_00B7", test_E0_00B7 },
    { "E0_00B8", test_E0_00B8 },
    { "E0_00B9", test_E0_00B9 },
    { "E0_00BA", test_E0_00BA },
    { "E0_00BB", test_E0_00BB },
    { "E0_00BC", test_E0_00BC },
    { "E0_00BD", test_E0_00BD },
    { "E0_00BE", test_E0_00BE },
    { "E0_00BF", test_E0_00BF },
    { "E0_00C0", test_E0_00C0 },
    { "E0_00C1", test_E0_00C1 },
    { "E0_00C2", test_E0_00C2 },
    { "E0_00C3", test_E0_00C3 },
    { "E0_00C4", test_E0_00C4 },
    { "E0_00C5", test_E0_00C5 },
    { "E0_00C6", test_E0_00C6 },
    { "E0_00C7", test_E0_00C7 },
    { "E0_00C8", test_E0_00C8 },
    { "E0_00C9", test_E0_00C9 },
    { "E0_00CA", test_E0_00CA },
    { "E0_00CB", test_E0_00CB },
    { "E0_00CC", test_E0_00CC },
    { "E0_00CD", test_E0_00CD },
    { "E0_00CE", test_E0_00CE },
    { "E0_00CF", test_E0_00CF },
    { "E0_00D0", test_E0_00D0 },
    { "E0_00D1", test_E0_00D1 },
    { "E0_00D2", test_E0_00D2 },
    { "E0_00D3", test_E0_00D3 },
    { "E0_00D4", test_E0_00D4 },
    { "E0_00D5", test_E0_00D5 },
    { "E0_00D6", test_E0_00D6 },
    { "E0_00D7", test_E0_00D7 },
    { "E0_00D8", test_E0_00D8 },
    { "E0_00D9", test_E0_00D9 },
    { "E0_00DA", test_E0_00DA },
    { "E0_00DB", test_E0_00DB },
    { "E0_00DC", test_E0_00DC },
    { "E0_00DD", test_E0_00DD },
    { "E0_00DE", test_E0_00DE },
    { "E0_00DF", test_E0_00DF },
    { "E0_00E0", test_E0_00E0 },
    { "E0_00E1", test_E0_00E1 },
    { "E0_00E2", test_E0_00E2 },
    { "E0_00E3", test_E0_00E3 },
    { "E0_00E4", test_E0_00E4 },
    { "E0_00E5", test_E0_00E5 },
    { "E0_00E6", test_E0_00E6 },
    { "E0_00E7", test_E0_00E7 },
    { "E0_00E8", test_E0_00E8 },
    { "E0_00E9", test_E0_00E9 },
    { "E0_00EA", test_E0_00EA },
    { "E0_00EB", test_E0_00EB },
    { "E0_00EC", test_E0_00EC },
    { "E0_00ED", test_E0_00ED },
    { "E0_00EE", test_E0_00EE },
    { "E0_00EF", test_E0_00EF },
    { "E0_00F0", test_E0_00F0 },
    { "E0_00F1", test_E0_00F1 },
    { "E0_00F2", test_E0_00F2 },
    { "E0_00F3", test_E0_00F3 },
    { "E0_00F4", test_E0_00F4 },
    { "E0_00F5", test_E0_00F5 },
    { "E0_00F6", test_E0_00F6 },
    { "E0_00F7", test_E0_00F7 },
    { "E0_00F8", test_E0_00F8 },
    { "E0_00F9", test_E0_00F9 },
    { "E0_00FA", test_E0_00FA },
    { "E0_00FB", test_E0_00FB },
    { "E0_00FC", test_E0_00FC },
    { "E0_00FD", test_E0_00FD },
    { "E0_00FE", test_E0_00FE },
    { "E0_00FF", test_E0_00FF },
    { "E0_0100", test_E0_0100 },
    { "E0_0101", test_E0_0101 },
    { "E0_0102", test_E0_0102 },
    { "E0_0103", test_E0_0103 },
    { "E0_0104", test_E0_0104 },
    { "E0_0105", test_E0_0105 },
    { "E0_0106", test_E0_0106 },
    { "E0_0107", test_E0_0107 },
    { "E0_0108", test_E0_0108 },
    { "E0_0109", test_E0_0109 },
    { "E0_010A", test_E0_010A },
    { "E0_010B", test_E0_010B },
    { "E0_010C", test_E0_010C },
    { "E0_010D", test_E0_010D },
    { "E0_010E", test_E0_010E },
    { "E0_010F", test_E0_010F },
    { "E0_0110", test_E0_0110 },
    { "E0_0111", test_E0_0111 },
    { "E0_0112", test_E0_0112 },
    { "E0_0113", test_E0_0113 },
    { "E0_0114", test_E0_0114 },
    { "E0_0115", test_E0_0115 },
    { "E0_0116", test_E0_0116 },
    { "E0_0117", test_E0_0117 },
    { "E0_0118", test_E0_0118 },
    { "E0_0119", test_E0_0119 },
    { "E0_011A", test_E0_011A },
    { "E0_011B", test_E0_011B },
    { "E0_011C", test_E0_011C },
    { "E0_011D", test_E0_011D },
    { "E0_011E", test_E0_011E },
    { "E0_011F", test_E0_011F },
    { "E0_0120", test_E0_0120 },
    { "E0_0121", test_E0_0121 },
    { "E0_0122", test_E0_0122 },
    { "E0_0123", test_E0_0123 },
    { "E0_0124", test_E0_0124 },
    { "E0_0125", test_E0_0125 },
    { "E0_0126", test_E0_0126 },
    { "E0_0127", test_E0_0127 },
    { "E0_0128", test_E0_0128 },
    { "E0_0129", test_E0_0129 },
    { "E0_012A", test_E0_012A },
    { "E0_012B", test_E0_012B },
    { "E0_012C", test_E0_012C },
    { "E0_012D", test_E0_012D },
    { "E0_012E", test_E0_012E },
    { "E0_012F", test_E0_012F },
    { "E0_0130", test_E0_0130 },
    { "E0_0131", test_E0_0131 },
    { "E0_0132", test_E0_0132 },
    { "E0_0133", test_E0_0133 },
    { "E0_0134", test_E0_0134 },
    { "E0_0135", test_E0_0135 },
    { "E0_0136", test_E0_0136 },
    { "E0_0137", test_E0_0137 },
    { "E0_0138", test_E0_0138 },
    { "E0_0139", test_E0_0139 },
    { "E0_013A", test_E0_013A },
    { "E0_013B", test_E0_013B },
    { "E0_013C", test_E0_013C },
    { "E0_013D", test_E0_013D },
    { "E0_013E", test_E0_013E },
    { "E0_013F", test_E0_013F },
    { "E0_0140", test_E0_0140 },
    { "E0_0141", test_E0_0141 },
    { "E0_0142", test_E0_0142 },
    { "E0_0143", test_E0_0143 },
    { "E0_0144", test_E0_0144 },
    { "E0_0145", test_E0_0145 },
    { "E0_0146", test_E0_0146 },
    { "E0_0147", test_E0_0147 },
    { "E0_0148", test_E0_0148 },
    { "E0_0149", test_E0_0149 },
    { "E0_014A", test_E0_014A },
    { "E0_014B", test_E0_014B },
    { "E0_014C", test_E0_014C },
    { "E0_014D", test_E0_014D },
    { "E0_014E", test_E0_014E },
    { "E0_014F", test_E0_014F },
    { "E0_0150", test_E0_0150 },
    { "E0_0151", test_E0_0151 },
    { "E0_0152", test_E0_0152 },
    { "E0_0153", test_E0_0153 },
    { "E0_0154", test_E0_0154 },
    { "E0_0155", test_E0_0155 },
    { "E0_0156", test_E0_0156 },
    { "E0_0157", test_E0_0157 },
    { "E0_0158", test_E0_0158 },
    { "E0_0159", test_E0_0159 },
    { "E0_015A", test_E0_015A },
    { "E0_015B", test_E0_015B },
    { "E0_015C", test_E0_015C },
    { "E0_015D", test_E0_015D },
    { "E0_015E", test_E0_015E },
    { "E0_015F", test_E0_015F },
    { "E0_0160", test_E0_0160 },
    { "E0_0161", test_E0_0161 },
    { "E0_0162", test_E0_0162 },
    { "E0_0163", test_E0_0163 },
    { "E0_0164", test_E0_0164 },
    { "E0_0165", test_E0_0165 },
    { "E0_0166", test_E0_0166 },
    { "E0_0167", test_E0_0167 },
    { "E0_0168", test_E0_0168 },
    { "E0_0169", test_E0_0169 },
    { "E0_016A", test_E0_016A },
    { "E0_016B", test_E0_016B },
    { "E0_016C", test_E0_016C },
    { "E0_016D", test_E0_016D },
    { "E0_016E", test_E0_016E },
    { "E0_016F", test_E0_016F },
    { "E0_0170", test_E0_0170 },
    { "E0_0171", test_E0_0171 },
    { "E0_0172", test_E0_0172 },
    { "E0_0173", test_E0_0173 },
    { "E0_0174", test_E0_0174 },
    { "E0_0175", test_E0_0175 },
    { "E0_0176", test_E0_0176 },
    { "E0_0177", test_E0_0177 },
    { "E0_0178", test_E0_0178 },
    { "E0_0179", test_E0_0179 },
    { "E0_017A", test_E0_017A },
    { "E0_017B", test_E0_017B },
    { "E0_017C", test_E0_017C },
    { "E0_017D", test_E0_017D },
    { "E0_017E", test_E0_017E },
    { "E0_017F", test_E0_017F },
    { "E0_0180", test_E0_0180 },
    { "E0_0181", test_E0_0181 },
    { "E0_0182", test_E0_0182 },
    { "E0_0183", test_E0_0183 },
    { "E0_0184", test_E0_0184 },
    { "E0_0185", test_E0_0185 },
    { "E0_0186", test_E0_0186 },
    { "E0_0187", test_E0_0187 },
    { "E0_0188", test_E0_0188 },
    { "E0_0189", test_E0_0189 },
    { "E0_018A", test_E0_018A },
    { "E0_018B", test_E0_018B },
    { "E0_018C", test_E0_018C },
    { "E0_018D", test_E0_018D },
    { "E0_018E", test_E0_018E },
    { "E0_018F", test_E0_018F },
    { "E0_0190", test_E0_0190 },
    { "E0_0191", test_E0_0191 },
    { "E0_0192", test_E0_0192 },
    { "E0_0193", test_E0_0193 },
    { "E0_0194", test_E0_0194 },
    { "E0_0195", test_E0_0195 },
    { "E0_0196", test_E0_0196 },
    { "E0_0197", test_E0_0197 },
    { "E0_0198", test_E0_0198 },
    { "E0_0199", test_E0_0199 },
    { "E0_019A", test_E0_019A },
    { "E0_019B", test_E0_019B },
    { "E0_019C", test_E0_019C },
    { "E0_019D", test_E0_019D },
    { "E0_019E", test_E0_019E },
    { "E0_019F", test_E0_019F },
    { "E0_01A0", test_E0_01A0 },
    { "E0_01A1", test_E0_01A1 },
    { "E0_01A2", test_E0_01A2 },
    { "E0_01A3", test_E0_01A3 },
    { "E0_01A4", test_E0_01A4 },
    { "E0_01A5", test_E0_01A5 },
    { "E0_01A6", test_E0_01A6 },
    { "E0_01A7", test_E0_01A7 },
    { "E0_01A8", test_E0_01A8 },
    { "E0_01A9", test_E0_01A9 },
    { "E0_01AA", test_E0_01AA },
    { "E0_01AB", test_E0_01AB },
    { "E0_01AC", test_E0_01AC },
    { "E0_01AD", test_E0_01AD },
    { "E0_01AE", test_E0_01AE },
    { "E0_01AF", test_E0_01AF },
    { "E0_01B0", test_E0_01B0 },
    { "E0_01B1", test_E0_01B1 },
    { "E0_01B2", test_E0_01B2 },
    { "E0_01B3", test_E0_01B3 },
    { "E0_01B4", test_E0_01B4 },
    { "E0_01B5", test_E0_01B5 },
    { "E0_01B6", test_E0_01B6 },
    { "E0_01B7", test_E0_01B7 },
    { "E0_01B8", test_E0_01B8 },
    { "E0_01B9", test_E0_01B9 },
    { "E0_01BA", test_E0_01BA },
    { "E0_01BB", test_E0_01BB },
    { "E0_01BC", test_E0_01BC },
    { "E0_01BD", test_E0_01BD },
    { "E0_01BE", test_E0_01BE },
    { "E0_01BF", test_E0_01BF },
    { "E0_01C0", test_E0_01C0 },
    { "E0_01C1", test_E0_01C1 },
    { "E0_01C2", test_E0_01C2 },
    { "E0_01C3", test_E0_01C3 },
    { "E0_01C4", test_E0_01C4 },
    { "E0_01C5", test_E0_01C5 },
    { "E0_01C6", test_E0_01C6 },
    { "E0_01C7", test_E0_01C7 },
    { "E0_01C8", test_E0_01C8 },
    { "E0_01C9", test_E0_01C9 },
    { "E0_01CA", test_E0_01CA },
    { "E0_01CB", test_E0_01CB },
    { "E0_01CC", test_E0_01CC },
    { "E0_01CD", test_E0_01CD },
    { "E0_01CE", test_E0_01CE },
    { "E0_01CF", test_E0_01CF },
    { "E0_01D0", test_E0_01D0 },
    { "E0_01D1", test_E0_01D1 },
    { "E0_01D2", test_E0_01D2 },
    { "E0_01D3", test_E0_01D3 },
    { "E0_01D4", test_E0_01D4 },
    { "E0_01D5", test_E0_01D5 },
    { "E0_01D6", test_E0_01D6 },
    { "E0_01D7", test_E0_01D7 },
    { "E0_01D8", test_E0_01D8 },
    { "E0_01D9", test_E0_01D9 },
    { "E0_01DA", test_E0_01DA },
    { "E0_01DB", test_E0_01DB },
    { "E0_01DC", test_E0_01DC },
    { "E0_01DD", test_E0_01DD },
    { "E0_01DE", test_E0_01DE },
    { "E0_01DF", test_E0_01DF },
    { "E0_01E0", test_E0_01E0 },
    { "E0_01E1", test_E0_01E1 },
    { "E0_01E2", test_E0_01E2 },
    { "E0_01E3", test_E0_01E3 },
    { "E0_01E4", test_E0_01E4 },
    { "E0_01E5", test_E0_01E5 },
    { "E0_01E6", test_E0_01E6 },
    { "E0_01E7", test_E0_01E7 },
    { "E0_01E8", test_E0_01E8 },
    { "E0_01E9", test_E0_01E9 },
    { "E0_01EA", test_E0_01EA },
    { "E0_01EB", test_E0_01EB },
    { "E0_01EC", test_E0_01EC },
    { "E0_01ED", test_E0_01ED },
    { "E0_01EE", test_E0_01EE },
    { "E0_01EF", test_E0_01EF },
    { "E0_01F0", test_E0_01F0 },
    { "E0_01F1", test_E0_01F1 },
    { "E0_01F2", test_E0_01F2 },
    { "E0_01F3", test_E0_01F3 },
    { "E0_01F4", test_E0_01F4 },
    { "E0_01F5", test_E0_01F5 },
    { "E0_01F6", test_E0_01F6 },
    { "E0_01F7", test_E0_01F7 },
    { "E0_01F8", test_E0_01F8 },
    { "E0_01F9", test_E0_01F9 },
    { "E0_01FA", test_E0_01FA },
    { "E0_01FB", test_E0_01FB },
    { "E0_01FC", test_E0_01FC },
    { "E0_01FD", test_E0_01FD },
    { "E0_01FE", test_E0_01FE },
    { "E0_01FF", test_E0_01FF },
    { "E0_0200", test_E0_0200 },
    { "E0_0201", test_E0_0201 },
    { "E0_0202", test_E0_0202 },
    { "E0_0203", test_E0_0203 },
    { "E0_0204", test_E0_0204 },
    { "E0_0205", test_E0_0205 },
    { "E0_0206", test_E0_0206 },
    { "E0_0207", test_E0_0207 },
    { "E0_0208", test_E0_0208 },
    { "E0_0209", test_E0_0209 },
    { "E0_020A", test_E0_020A },
    { "E0_020B", test_E0_020B },
    { "E0_020C", test_E0_020C },
    { "E0_020D", test_E0_020D },
    { "E0_020E", test_E0_020E },
    { "E0_020F", test_E0_020F },
    { "E0_0210", test_E0_0210 },
    { "E0_0211", test_E0_0211 },
    { "E0_0212", test_E0_0212 },
    { "E0_0213", test_E0_0213 },
    { "E0_0214", test_E0_0214 },
    { "E0_0215", test_E0_0215 },
    { "E0_0216", test_E0_0216 },
    { "E0_0217", test_E0_0217 },
    { "E0_0218", test_E0_0218 },
    { "E0_0219", test_E0_0219 },
    { "E0_021A", test_E0_021A },
    { "E0_021B", test_E0_021B },
    { "E0_021C", test_E0_021C },
    { "E0_021D", test_E0_021D },
    { "E0_021E", test_E0_021E },
    { "E0_021F", test_E0_021F },
    { "E0_0220", test_E0_0220 },
    { "E0_0221", test_E0_0221 },
    { "E0_0222", test_E0_0222 },
    { "E0_0223", test_E0_0223 },
    { "E0_0224", test_E0_0224 },
    { "E0_0225", test_E0_0225 },
    { "E0_0226", test_E0_0226 },
    { "E0_0227", test_E0_0227 },
    { "E0_0228", test_E0_0228 },
    { "E0_0229", test_E0_0229 },
    { "E0_022A", test_E0_022A },
    { "E0_022B", test_E0_022B },
    { "E0_022C", test_E0_022C },
    { "E0_022D", test_E0_022D },
    { "E0_022E", test_E0_022E },
    { "E0_022F", test_E0_022F },
    { "E0_0230", test_E0_0230 },
    { "E0_0231", test_E0_0231 },
    { "E0_0232", test_E0_0232 },
    { "E0_0233", test_E0_0233 },
    { "E0_0234", test_E0_0234 },
    { "E0_0235", test_E0_0235 },
    { "E0_0236", test_E0_0236 },
    { "E0_0237", test_E0_0237 },
    { "E0_0238", test_E0_0238 },
    { "E0_0239", test_E0_0239 },
    { "E0_023A", test_E0_023A },
    { "E0_023B", test_E0_023B },
    { "E0_023C", test_E0_023C },
    { "E0_023D", test_E0_023D },
    { "E0_023E", test_E0_023E },
    { "E0_023F", test_E0_023F },
    { "E0_0240", test_E0_0240 },
    { "E0_0241", test_E0_0241 },
    { "E0_0242", test_E0_0242 },
    { "E0_0243", test_E0_0243 },
    { "E0_0244", test_E0_0244 },
    { "E0_0245", test_E0_0245 },
    { "E0_0246", test_E0_0246 },
    { "E0_0247", test_E0_0247 },
    { "E0_0248", test_E0_0248 },
    { "E0_0249", test_E0_0249 },
    { "E0_024A", test_E0_024A },
    { "E0_024B", test_E0_024B },
    { "E0_024C", test_E0_024C },
    { "E0_024D", test_E0_024D },
    { "E0_024E", test_E0_024E },
    { "E0_024F", test_E0_024F },
    { "E0_0250", test_E0_0250 },
    { "E0_0251", test_E0_0251 },
    { "E0_0252", test_E0_0252 },
    { "E0_0253", test_E0_0253 },
    { "E0_0254", test_E0_0254 },
    { "E0_0255", test_E0_0255 },
    { "E0_0256", test_E0_0256 },
    { "E0_0257", test_E0_0257 },
    { "E0_0258", test_E0_0258 },
    { "E0_0259", test_E0_0259 },
    { "E0_025A", test_E0_025A },
    { "E0_025B", test_E0_025B },
    { "E0_025C", test_E0_025C },
    { "E0_025D", test_E0_025D },
    { "E0_025E", test_E0_025E },
    { "E0_025F", test_E0_025F },
    { "E0_0260", test_E0_0260 },
    { "E0_0261", test_E0_0261 },
    { "E0_0262", test_E0_0262 },
    { "E0_0263", test_E0_0263 },
    { "E0_0264", test_E0_0264 },
    { "E0_0265", test_E0_0265 },
    { "E0_0266", test_E0_0266 },
    { "E0_0267", test_E0_0267 },
    { "E0_0268", test_E0_0268 },
    { "E0_0269", test_E0_0269 },
    { "E0_026A", test_E0_026A },
    { "E0_026B", test_E0_026B },
    { "E0_026C", test_E0_026C },
    { "E0_026D", test_E0_026D },
    { "E0_026E", test_E0_026E },
    { "E0_026F", test_E0_026F },
    { "E0_0270", test_E0_0270 },
    { "E0_0271", test_E0_0271 },
    { "E0_0272", test_E0_0272 },
    { "E0_0273", test_E0_0273 },
    { "E0_0274", test_E0_0274 },
    { "E0_0275", test_E0_0275 },
    { "E0_0276", test_E0_0276 },
    { "E0_0277", test_E0_0277 },
    { "E0_0278", test_E0_0278 },
    { "E0_0279", test_E0_0279 },
    { "E0_027A", test_E0_027A },
    { "E0_027B", test_E0_027B },
    { "E0_027C", test_E0_027C },
    { "E0_027D", test_E0_027D },
    { "E0_027E", test_E0_027E },
    { "E0_027F", test_E0_027F },
    { "E0_0280", test_E0_0280 },
    { "E0_0281", test_E0_0281 },
    { "E0_0282", test_E0_0282 },
    { "E0_0283", test_E0_0283 },
    { "E0_0284", test_E0_0284 },
    { "E0_0285", test_E0_0285 },
    { "E0_0286", test_E0_0286 },
    { "E0_0287", test_E0_0287 },
    { "E0_0288", test_E0_0288 },
    { "E0_0289", test_E0_0289 },
    { "E0_028A", test_E0_028A },
    { "E0_028B", test_E0_028B },
    { "E0_028C", test_E0_028C },
    { "E0_028D", test_E0_028D },
    { "E0_028E", test_E0_028E },
    { "E0_028F", test_E0_028F },
    { "E0_0290", test_E0_0290 },
    { "E0_0291", test_E0_0291 },
    { "E0_0292", test_E0_0292 },
    { "E0_0293", test_E0_0293 },
    { "E0_0294", test_E0_0294 },
    { "E0_0295", test_E0_0295 },
    { "E0_0296", test_E0_0296 },
    { "E0_0297", test_E0_0297 },
    { "E0_0298", test_E0_0298 },
    { "E0_0299", test_E0_0299 },
    { "E0_029A", test_E0_029A },
    { "E0_029B", test_E0_029B },
    { "E0_029C", test_E0_029C },
    { "E0_029D", test_E0_029D },
    { "E0_029E", test_E0_029E },
    { "E0_029F", test_E0_029F },
    { "E0_02A0", test_E0_02A0 },
    { "E0_02A1", test_E0_02A1 },
    { "E0_02A2", test_E0_02A2 },
    { "E0_02A3", test_E0_02A3 },
    { "E0_02A4", test_E0_02A4 },
    { "E0_02A5", test_E0_02A5 },
    { "E0_02A6", test_E0_02A6 },
    { "E0_02A7", test_E0_02A7 },
    { "E0_02A8", test_E0_02A8 },
    { "E0_02A9", test_E0_02A9 },
    { "E0_02AA", test_E0_02AA },
    { "E0_02AB", test_E0_02AB },
    { "E0_02AC", test_E0_02AC },
    { "E0_02AD", test_E0_02AD },
    { "E0_02AE", test_E0_02AE },
    { "E0_02AF", test_E0_02AF },
    { "E0_02B0", test_E0_02B0 },
    { "E0_02B1", test_E0_02B1 },
    { "E0_02B2", test_E0_02B2 },
    { "E0_02B3", test_E0_02B3 },
    { "E0_02B4", test_E0_02B4 },
    { "E0_02B5", test_E0_02B5 },
    { "E0_02B6", test_E0_02B6 },
    { "E0_02B7", test_E0_02B7 },
    { "E0_02B8", test_E0_02B8 },
    { "E0_02B9", test_E0_02B9 },
    { "E0_02BA", test_E0_02BA },
    { "E0_02BB", test_E0_02BB },
    { "E0_02BC", test_E0_02BC },
    { "E0_02BD", test_E0_02BD },
    { "E0_02BE", test_E0_02BE },
    { "E0_02BF", test_E0_02BF },
    { "E0_02C0", test_E0_02C0 },
    { "E0_02C1", test_E0_02C1 },
    { "E0_02C2", test_E0_02C2 },
    { "E0_02C3", test_E0_02C3 },
    { "E0_02C4", test_E0_02C4 },
    { "E0_02C5", test_E0_02C5 },
    { "E0_02C6", test_E0_02C6 },
    { "E0_02C7", test_E0_02C7 },
    { "E0_02C8", test_E0_02C8 },
    { "E0_02C9", test_E0_02C9 },
    { "E0_02CA", test_E0_02CA },
    { "E0_02CB", test_E0_02CB },
    { "E0_02CC", test_E0_02CC },
    { "E0_02CD", test_E0_02CD },
    { "E0_02CE", test_E0_02CE },
    { "E0_02CF", test_E0_02CF },
    { "E0_02D0", test_E0_02D0 },
    { "E0_02D1", test_E0_02D1 },
    { "E0_02D2", test_E0_02D2 },
    { "E0_02D3", test_E0_02D3 },
    { "E0_02D4", test_E0_02D4 },
    { "E0_02D5", test_E0_02D5 },
    { "E0_02D6", test_E0_02D6 },
    { "E0_02D7", test_E0_02D7 },
    { "E0_02D8", test_E0_02D8 },
    { "E0_02D9", test_E0_02D9 },
    { "E0_02DA", test_E0_02DA },
    { "E0_02DB", test_E0_02DB },
    { "E0_02DC", test_E0_02DC },
    { "E0_02DD", test_E0_02DD },
    { "E0_02DE", test_E0_02DE },
    { "E0_02DF", test_E0_02DF },
    { "E0_02E0", test_E0_02E0 },
    { "E0_02E1", test_E0_02E1 },
    { "E0_02E2", test_E0_02E2 },
    { "E0_02E3", test_E0_02E3 },
    { "E0_02E4", test_E0_02E4 },
    { "E0_02E5", test_E0_02E5 },
    { "E0_02E6", test_E0_02E6 },
    { "E0_02E7", test_E0_02E7 },
    { "E0_02E8", test_E0_02E8 },
    { "E0_02E9", test_E0_02E9 },
    { "E0_02EA", test_E0_02EA },
    { "E0_02EB", test_E0_02EB },
    { "E0_02EC", test_E0_02EC },
    { "E0_02ED", test_E0_02ED },
    { "E0_02EE", test_E0_02EE },
    { "E0_02EF", test_E0_02EF },
    { "E0_02F0", test_E0_02F0 },
    { "E0_02F1", test_E0_02F1 },
    { "E0_02F2", test_E0_02F2 },
    { "E0_02F3", test_E0_02F3 },
    { "E0_02F4", test_E0_02F4 },
    { "E0_02F5", test_E0_02F5 },
    { "E0_02F6", test_E0_02F6 },
    { "E0_02F7", test_E0_02F7 },
    { "E0_02F8", test_E0_02F8 },
    { "E0_02F9", test_E0_02F9 },
    { "E0_02FA", test_E0_02FA },
    { "E0_02FB", test_E0_02FB },
    { "E0_02FC", test_E0_02FC },
    { "E0_02FD", test_E0_02FD },
    { "E0_02FE", test_E0_02FE },
    { "E0_02FF", test_E0_02FF },
    { "E0_0300", test_E0_0300 },
    { "E0_0301", test_E0_0301 },
    { "E0_0302", test_E0_0302 },
    { "E0_0303", test_E0_0303 },
    { "E0_0304", test_E0_0304 },
    { "E0_0305", test_E0_0305 },
    { "E0_0306", test_E0_0306 },
    { "E0_0307", test_E0_0307 },
    { "E0_0308", test_E0_0308 },
    { "E0_0309", test_E0_0309 },
    { "E0_030A", test_E0_030A },
    { "E0_030B", test_E0_030B },
    { "E0_030C", test_E0_030C },
    { "E0_030D", test_E0_030D },
    { "E0_030E", test_E0_030E },
    { "E0_030F", test_E0_030F },
    { "E0_0310", test_E0_0310 },
    { "E0_0311", test_E0_0311 },
    { "E0_0312", test_E0_0312 },
    { "E0_0313", test_E0_0313 },
    { "E0_0314", test_E0_0314 },
    { "E0_0315", test_E0_0315 },
    { "E0_0316", test_E0_0316 },
    { "E0_0317", test_E0_0317 },
    { "E0_0318", test_E0_0318 },
    { "E0_0319", test_E0_0319 },
    { "E0_031A", test_E0_031A },
    { "E0_031B", test_E0_031B },
    { "E0_031C", test_E0_031C },
    { "E0_031D", test_E0_031D },
    { "E0_031E", test_E0_031E },
    { "E0_031F", test_E0_031F },
    { "E0_0320", test_E0_0320 },
    { "E0_0321", test_E0_0321 },
    { "E0_0322", test_E0_0322 },
    { "E0_0323", test_E0_0323 },
    { "E0_0324", test_E0_0324 },
    { "E0_0325", test_E0_0325 },
    { "E0_0326", test_E0_0326 },
    { "E0_0327", test_E0_0327 },
    { "E0_0328", test_E0_0328 },
    { "E0_0329", test_E0_0329 },
    { "E0_032A", test_E0_032A },
    { "E0_032B", test_E0_032B },
    { "E0_032C", test_E0_032C },
    { "E0_032D", test_E0_032D },
    { "E0_032E", test_E0_032E },
    { "E0_032F", test_E0_032F },
    { "E0_0330", test_E0_0330 },
    { "E0_0331", test_E0_0331 },
    { "E0_0332", test_E0_0332 },
    { "E0_0333", test_E0_0333 },
    { "E0_0334", test_E0_0334 },
    { "E0_0335", test_E0_0335 },
    { "E0_0336", test_E0_0336 },
    { "E0_0337", test_E0_0337 },
    { "E0_0338", test_E0_0338 },
    { "E0_0339", test_E0_0339 },
    { "E0_033A", test_E0_033A },
    { "E0_033B", test_E0_033B },
    { "E0_033C", test_E0_033C },
    { "E0_033D", test_E0_033D },
    { "E0_033E", test_E0_033E },
    { "E0_033F", test_E0_033F },
    { "E0_0340", test_E0_0340 },
    { "E0_0341", test_E0_0341 },
    { "E0_0342", test_E0_0342 },
    { "E0_0343", test_E0_0343 },
    { "E0_0344", test_E0_0344 },
    { "E0_0345", test_E0_0345 },
    { "E0_0346", test_E0_0346 },
    { "E0_0347", test_E0_0347 },
    { "E0_0348", test_E0_0348 },
    { "E0_0349", test_E0_0349 },
    { "E0_034A", test_E0_034A },
    { "E0_034B", test_E0_034B },
    { "E0_034C", test_E0_034C },
    { "E0_034D", test_E0_034D },
    { "E0_034E", test_E0_034E },
    { "E0_034F", test_E0_034F },
    { "E0_0350", test_E0_0350 },
    { "E0_0351", test_E0_0351 },
    { "E0_0352", test_E0_0352 },
    { "E0_0353", test_E0_0353 },
    { "E0_0354", test_E0_0354 },
    { "E0_0355", test_E0_0355 },
    { "E0_0356", test_E0_0356 },
    { "E0_0357", test_E0_0357 },
    { "E0_0358", test_E0_0358 },
    { "E0_0359", test_E0_0359 },
    { "E0_035A", test_E0_035A },
    { "E0_035B", test_E0_035B },
    { "E0_035C", test_E0_035C },
    { "E0_035D", test_E0_035D },
    { "E0_035E", test_E0_035E },
    { "E0_035F", test_E0_035F },
    { "E0_0360", test_E0_0360 },
    { "E0_0361", test_E0_0361 },
    { "E0_0362", test_E0_0362 },
    { "E0_0363", test_E0_0363 },
    { "E0_0364", test_E0_0364 },
    { "E0_0365", test_E0_0365 },
    { "E0_0366", test_E0_0366 },
    { "E0_0367", test_E0_0367 },
    { "E0_0368", test_E0_0368 },
    { "E0_0369", test_E0_0369 },
    { "E0_036A", test_E0_036A },
    { "E0_036B", test_E0_036B },
    { "E0_036C", test_E0_036C },
    { "E0_036D", test_E0_036D },
    { "E0_036E", test_E0_036E },
    { "E0_036F", test_E0_036F },
    { "E0_0370", test_E0_0370 },
    { "E0_0371", test_E0_0371 },
    { "E0_0372", test_E0_0372 },
    { "E0_0373", test_E0_0373 },
    { "E0_0374", test_E0_0374 },
    { "E0_0375", test_E0_0375 },
    { "E0_0376", test_E0_0376 },
    { "E0_0377", test_E0_0377 },
    { "E0_0378", test_E0_0378 },
    { "E0_0379", test_E0_0379 },
    { "E0_037A", test_E0_037A },
    { "E0_037B", test_E0_037B },
    { "E0_037C", test_E0_037C },
    { "E0_037D", test_E0_037D },
    { "E0_037E", test_E0_037E },
    { "E0_037F", test_E0_037F },
    { "E0_0380", test_E0_0380 },
    { "E0_0381", test_E0_0381 },
    { "E0_0382", test_E0_0382 },
    { "E0_0383", test_E0_0383 },
    { "E0_0384", test_E0_0384 },
    { "E0_0385", test_E0_0385 },
    { "E0_0386", test_E0_0386 },
    { "E0_0387", test_E0_0387 },
    { "E0_0388", test_E0_0388 },
    { "E0_0389", test_E0_0389 },
    { "E0_038A", test_E0_038A },
    { "E0_038B", test_E0_038B },
    { "E0_038C", test_E0_038C },
    { "E0_038D", test_E0_038D },
    { "E0_038E", test_E0_038E },
    { "E0_038F", test_E0_038F },
    { "E0_0390", test_E0_0390 },
    { "E0_0391", test_E0_0391 },
    { "E0_0392", test_E0_0392 },
    { "E0_0393", test_E0_0393 },
    { "E0_0394", test_E0_0394 },
    { "E0_0395", test_E0_0395 },
    { "E0_0396", test_E0_0396 },
    { "E0_0397", test_E0_0397 },
    { "E0_0398", test_E0_0398 },
    { "E0_0399", test_E0_0399 },
    { "E0_039A", test_E0_039A },
    { "E0_039B", test_E0_039B },
    { "E0_039C", test_E0_039C },
    { "E0_039D", test_E0_039D },
    { "E0_039E", test_E0_039E },
    { "E0_039F", test_E0_039F },
    { "E0_03A0", test_E0_03A0 },
    { "E0_03A1", test_E0_03A1 },
    { "E0_03A2", test_E0_03A2 },
    { "E0_03A3", test_E0_03A3 },
    { "E0_03A4", test_E0_03A4 },
    { "E0_03A5", test_E0_03A5 },
    { "E0_03A6", test_E0_03A6 },
    { "E0_03A7", test_E0_03A7 },
    { "E0_03A8", test_E0_03A8 },
    { "E0_03A9", test_E0_03A9 },
    { "E0_03AA", test_E0_03AA },
    { "E0_03AB", test_E0_03AB },
    { "E0_03AC", test_E0_03AC },
    { "E0_03AD", test_E0_03AD },
    { "E0_03AE", test_E0_03AE },
    { "E0_03AF", test_E0_03AF },
    { "E0_03B0", test_E0_03B0 },
    { "E0_03B1", test_E0_03B1 },
    { "E0_03B2", test_E0_03B2 },
    { "E0_03B3", test_E0_03B3 },
    { "E0_03B4", test_E0_03B4 },
    { "E0_03B5", test_E0_03B5 },
    { "E0_03B6", test_E0_03B6 },
    { "E0_03B7", test_E0_03B7 },
    { "E0_03B8", test_E0_03B8 },
    { "E0_03B9", test_E0_03B9 },
    { "E0_03BA", test_E0_03BA },
    { "E0_03BB", test_E0_03BB },
    { "E0_03BC", test_E0_03BC },
    { "E0_03BD", test_E0_03BD },
    { "E0_03BE", test_E0_03BE },
    { "E0_03BF", test_E0_03BF },
    { "E0_03C0", test_E0_03C0 },
    { "E0_03C1", test_E0_03C1 },
    { "E0_03C2", test_E0_03C2 },
    { "E0_03C3", test_E0_03C3 },
    { "E0_03C4", test_E0_03C4 },
    { "E0_03C5", test_E0_03C5 },
    { "E0_03C6", test_E0_03C6 },
    { "E0_03C7", test_E0_03C7 },
    { "E0_03C8", test_E0_03C8 },
    { "E0_03C9", test_E0_03C9 },
    { "E0_03CA", test_E0_03CA },
    { "E0_03CB", test_E0_03CB },
    { "E0_03CC", test_E0_03CC },
    { "E0_03CD", test_E0_03CD },
    { "E0_03CE", test_E0_03CE },
    { "E0_03CF", test_E0_03CF },
    { "E0_03D0", test_E0_03D0 },
    { "E0_03D1", test_E0_03D1 },
    { "E0_03D2", test_E0_03D2 },
    { "E0_03D3", test_E0_03D3 },
    { "E0_03D4", test_E0_03D4 },
    { "E0_03D5", test_E0_03D5 },
    { "E0_03D6", test_E0_03D6 },
    { "E0_03D7", test_E0_03D7 },
    { "E0_03D8", test_E0_03D8 },
    { "E0_03D9", test_E0_03D9 },
    { "E0_03DA", test_E0_03DA },
    { "E0_03DB", test_E0_03DB },
    { "E0_03DC", test_E0_03DC },
    { "E0_03DD", test_E0_03DD },
    { "E0_03DE", test_E0_03DE },
    { "E0_03DF", test_E0_03DF },
    { "E0_03E0", test_E0_03E0 },
    { "E0_03E1", test_E0_03E1 },
    { "E0_03E2", test_E0_03E2 },
    { "E0_03E3", test_E0_03E3 },
    { "E0_03E4", test_E0_03E4 },
    { "E0_03E5", test_E0_03E5 },
    { "E0_03E6", test_E0_03E6 },
    { "E0_03E7", test_E0_03E7 },
    {NULL, NULL}
};

void test_E0_0000()
{
    if (skip_test_E0_0000)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA616);
    WriteRegisterWord(RegisterType::SP, 0xED39);
    WriteRegisterByte(RegisterType::A, 0xA7);
    WriteRegisterByte(RegisterType::B, 0xE1);
    WriteRegisterByte(RegisterType::C, 0xF8);
    WriteRegisterByte(RegisterType::D, 0xB9);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xF8);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC8, 0x00);
    WriteMemory(0xA617, 0xC8);
    WriteMemory(0xA616, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA7);
    CheckRegisterByte(RegisterType::B, 0xE1);
    CheckRegisterByte(RegisterType::C, 0xF8);
    CheckRegisterByte(RegisterType::D, 0xB9);
    CheckRegisterByte(RegisterType::E, 0xDC);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xF8);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0xA618);
    CheckRegisterWord(RegisterType::SP, 0xED39);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA616, 0xE0);
    CheckMemory(0xA617, 0xC8);
    CheckMemory(0xFFC8, 0xA7);
}

void test_E0_0001()
{
    if (skip_test_E0_0001)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAF55);
    WriteRegisterWord(RegisterType::SP, 0x5D56);
    WriteRegisterByte(RegisterType::A, 0xA4);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0xB9);
    WriteRegisterByte(RegisterType::E, 0x91);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x25);
    WriteRegisterByte(RegisterType::L, 0x66);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF3F, 0x00);
    WriteMemory(0xAF56, 0x3F);
    WriteMemory(0xAF55, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA4);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0xB9);
    CheckRegisterByte(RegisterType::E, 0x91);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x25);
    CheckRegisterByte(RegisterType::L, 0x66);
    CheckRegisterWord(RegisterType::PC, 0xAF57);
    CheckRegisterWord(RegisterType::SP, 0x5D56);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAF55, 0xE0);
    CheckMemory(0xAF56, 0x3F);
    CheckMemory(0xFF3F, 0xA4);
}

void test_E0_0002()
{
    if (skip_test_E0_0002)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5050);
    WriteRegisterWord(RegisterType::SP, 0xA765);
    WriteRegisterByte(RegisterType::A, 0x91);
    WriteRegisterByte(RegisterType::B, 0x0C);
    WriteRegisterByte(RegisterType::C, 0xC6);
    WriteRegisterByte(RegisterType::D, 0xCA);
    WriteRegisterByte(RegisterType::E, 0x5A);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x95);
    WriteRegisterByte(RegisterType::L, 0x55);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE0, 0x00);
    WriteMemory(0x5051, 0xE0);
    WriteMemory(0x5050, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x91);
    CheckRegisterByte(RegisterType::B, 0x0C);
    CheckRegisterByte(RegisterType::C, 0xC6);
    CheckRegisterByte(RegisterType::D, 0xCA);
    CheckRegisterByte(RegisterType::E, 0x5A);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x95);
    CheckRegisterByte(RegisterType::L, 0x55);
    CheckRegisterWord(RegisterType::PC, 0x5052);
    CheckRegisterWord(RegisterType::SP, 0xA765);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5050, 0xE0);
    CheckMemory(0x5051, 0xE0);
    CheckMemory(0xFFE0, 0x91);
}

void test_E0_0003()
{
    if (skip_test_E0_0003)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0AD9);
    WriteRegisterWord(RegisterType::SP, 0xAE68);
    WriteRegisterByte(RegisterType::A, 0x30);
    WriteRegisterByte(RegisterType::B, 0x96);
    WriteRegisterByte(RegisterType::C, 0xA0);
    WriteRegisterByte(RegisterType::D, 0x12);
    WriteRegisterByte(RegisterType::E, 0x3B);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x4E);
    WriteRegisterByte(RegisterType::L, 0xDD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF22, 0x00);
    WriteMemory(0x0ADA, 0x22);
    WriteMemory(0x0AD9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x30);
    CheckRegisterByte(RegisterType::B, 0x96);
    CheckRegisterByte(RegisterType::C, 0xA0);
    CheckRegisterByte(RegisterType::D, 0x12);
    CheckRegisterByte(RegisterType::E, 0x3B);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x4E);
    CheckRegisterByte(RegisterType::L, 0xDD);
    CheckRegisterWord(RegisterType::PC, 0x0ADB);
    CheckRegisterWord(RegisterType::SP, 0xAE68);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0AD9, 0xE0);
    CheckMemory(0x0ADA, 0x22);
    CheckMemory(0xFF22, 0x30);
}

void test_E0_0004()
{
    if (skip_test_E0_0004)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1F38);
    WriteRegisterWord(RegisterType::SP, 0x91BC);
    WriteRegisterByte(RegisterType::A, 0x20);
    WriteRegisterByte(RegisterType::B, 0x27);
    WriteRegisterByte(RegisterType::C, 0x45);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0x45);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x9F);
    WriteRegisterByte(RegisterType::L, 0x02);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF96, 0x00);
    WriteMemory(0x1F39, 0x96);
    WriteMemory(0x1F38, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x20);
    CheckRegisterByte(RegisterType::B, 0x27);
    CheckRegisterByte(RegisterType::C, 0x45);
    CheckRegisterByte(RegisterType::D, 0xA9);
    CheckRegisterByte(RegisterType::E, 0x45);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x9F);
    CheckRegisterByte(RegisterType::L, 0x02);
    CheckRegisterWord(RegisterType::PC, 0x1F3A);
    CheckRegisterWord(RegisterType::SP, 0x91BC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1F38, 0xE0);
    CheckMemory(0x1F39, 0x96);
    CheckMemory(0xFF96, 0x20);
}

void test_E0_0005()
{
    if (skip_test_E0_0005)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3E45);
    WriteRegisterWord(RegisterType::SP, 0x44FA);
    WriteRegisterByte(RegisterType::A, 0xB1);
    WriteRegisterByte(RegisterType::B, 0x3E);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0xE3);
    WriteRegisterByte(RegisterType::E, 0xBB);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xD3);
    WriteRegisterByte(RegisterType::L, 0x14);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF2A, 0x00);
    WriteMemory(0x3E46, 0x2A);
    WriteMemory(0x3E45, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB1);
    CheckRegisterByte(RegisterType::B, 0x3E);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0xE3);
    CheckRegisterByte(RegisterType::E, 0xBB);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xD3);
    CheckRegisterByte(RegisterType::L, 0x14);
    CheckRegisterWord(RegisterType::PC, 0x3E47);
    CheckRegisterWord(RegisterType::SP, 0x44FA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3E45, 0xE0);
    CheckMemory(0x3E46, 0x2A);
    CheckMemory(0xFF2A, 0xB1);
}

void test_E0_0006()
{
    if (skip_test_E0_0006)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3FE6);
    WriteRegisterWord(RegisterType::SP, 0x6ECA);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0x68);
    WriteRegisterByte(RegisterType::E, 0xA4);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x69);
    WriteRegisterByte(RegisterType::L, 0x54);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF18, 0x00);
    WriteMemory(0x3FE7, 0x18);
    WriteMemory(0x3FE6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0x68);
    CheckRegisterByte(RegisterType::E, 0xA4);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x69);
    CheckRegisterByte(RegisterType::L, 0x54);
    CheckRegisterWord(RegisterType::PC, 0x3FE8);
    CheckRegisterWord(RegisterType::SP, 0x6ECA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3FE6, 0xE0);
    CheckMemory(0x3FE7, 0x18);
    CheckMemory(0xFF18, 0xC7);
}

void test_E0_0007()
{
    if (skip_test_E0_0007)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA391);
    WriteRegisterWord(RegisterType::SP, 0xA54A);
    WriteRegisterByte(RegisterType::A, 0xBC);
    WriteRegisterByte(RegisterType::B, 0x13);
    WriteRegisterByte(RegisterType::C, 0xCC);
    WriteRegisterByte(RegisterType::D, 0xC2);
    WriteRegisterByte(RegisterType::E, 0x3C);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x6F);
    WriteRegisterByte(RegisterType::L, 0x20);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFEA, 0x00);
    WriteMemory(0xA392, 0xEA);
    WriteMemory(0xA391, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBC);
    CheckRegisterByte(RegisterType::B, 0x13);
    CheckRegisterByte(RegisterType::C, 0xCC);
    CheckRegisterByte(RegisterType::D, 0xC2);
    CheckRegisterByte(RegisterType::E, 0x3C);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x6F);
    CheckRegisterByte(RegisterType::L, 0x20);
    CheckRegisterWord(RegisterType::PC, 0xA393);
    CheckRegisterWord(RegisterType::SP, 0xA54A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA391, 0xE0);
    CheckMemory(0xA392, 0xEA);
    CheckMemory(0xFFEA, 0xBC);
}

void test_E0_0008()
{
    if (skip_test_E0_0008)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x95C7);
    WriteRegisterWord(RegisterType::SP, 0x6702);
    WriteRegisterByte(RegisterType::A, 0x09);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0x9F);
    WriteRegisterByte(RegisterType::D, 0x36);
    WriteRegisterByte(RegisterType::E, 0x91);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xD6);
    WriteRegisterByte(RegisterType::L, 0x84);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC0, 0x00);
    WriteMemory(0x95C8, 0xC0);
    WriteMemory(0x95C7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x09);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0x9F);
    CheckRegisterByte(RegisterType::D, 0x36);
    CheckRegisterByte(RegisterType::E, 0x91);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xD6);
    CheckRegisterByte(RegisterType::L, 0x84);
    CheckRegisterWord(RegisterType::PC, 0x95C9);
    CheckRegisterWord(RegisterType::SP, 0x6702);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x95C7, 0xE0);
    CheckMemory(0x95C8, 0xC0);
    CheckMemory(0xFFC0, 0x09);
}

void test_E0_0009()
{
    if (skip_test_E0_0009)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDA00);
    WriteRegisterWord(RegisterType::SP, 0x126E);
    WriteRegisterByte(RegisterType::A, 0x52);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0xDA);
    WriteRegisterByte(RegisterType::D, 0x55);
    WriteRegisterByte(RegisterType::E, 0x77);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x84);
    WriteRegisterByte(RegisterType::L, 0xF6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF8B, 0x00);
    WriteMemory(0xDA01, 0x8B);
    WriteMemory(0xDA00, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x52);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0xDA);
    CheckRegisterByte(RegisterType::D, 0x55);
    CheckRegisterByte(RegisterType::E, 0x77);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x84);
    CheckRegisterByte(RegisterType::L, 0xF6);
    CheckRegisterWord(RegisterType::PC, 0xDA02);
    CheckRegisterWord(RegisterType::SP, 0x126E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDA00, 0xE0);
    CheckMemory(0xDA01, 0x8B);
    CheckMemory(0xFF8B, 0x52);
}

void test_E0_000A()
{
    if (skip_test_E0_000A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEF7F);
    WriteRegisterWord(RegisterType::SP, 0xFFB0);
    WriteRegisterByte(RegisterType::A, 0xB3);
    WriteRegisterByte(RegisterType::B, 0xB9);
    WriteRegisterByte(RegisterType::C, 0xF7);
    WriteRegisterByte(RegisterType::D, 0xA5);
    WriteRegisterByte(RegisterType::E, 0xA9);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xD8);
    WriteRegisterByte(RegisterType::L, 0xBA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8C, 0x00);
    WriteMemory(0xEF80, 0x8C);
    WriteMemory(0xEF7F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB3);
    CheckRegisterByte(RegisterType::B, 0xB9);
    CheckRegisterByte(RegisterType::C, 0xF7);
    CheckRegisterByte(RegisterType::D, 0xA5);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xD8);
    CheckRegisterByte(RegisterType::L, 0xBA);
    CheckRegisterWord(RegisterType::PC, 0xEF81);
    CheckRegisterWord(RegisterType::SP, 0xFFB0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEF7F, 0xE0);
    CheckMemory(0xEF80, 0x8C);
    CheckMemory(0xFF8C, 0xB3);
}

void test_E0_000B()
{
    if (skip_test_E0_000B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB5A8);
    WriteRegisterWord(RegisterType::SP, 0x105B);
    WriteRegisterByte(RegisterType::A, 0x84);
    WriteRegisterByte(RegisterType::B, 0x2D);
    WriteRegisterByte(RegisterType::C, 0x91);
    WriteRegisterByte(RegisterType::D, 0xB1);
    WriteRegisterByte(RegisterType::E, 0xCD);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x61);
    WriteRegisterByte(RegisterType::L, 0xC2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3E, 0x00);
    WriteMemory(0xB5A9, 0x3E);
    WriteMemory(0xB5A8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x84);
    CheckRegisterByte(RegisterType::B, 0x2D);
    CheckRegisterByte(RegisterType::C, 0x91);
    CheckRegisterByte(RegisterType::D, 0xB1);
    CheckRegisterByte(RegisterType::E, 0xCD);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x61);
    CheckRegisterByte(RegisterType::L, 0xC2);
    CheckRegisterWord(RegisterType::PC, 0xB5AA);
    CheckRegisterWord(RegisterType::SP, 0x105B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB5A8, 0xE0);
    CheckMemory(0xB5A9, 0x3E);
    CheckMemory(0xFF3E, 0x84);
}

void test_E0_000C()
{
    if (skip_test_E0_000C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x14F9);
    WriteRegisterWord(RegisterType::SP, 0xF6F1);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0x87);
    WriteRegisterByte(RegisterType::C, 0x19);
    WriteRegisterByte(RegisterType::D, 0xFF);
    WriteRegisterByte(RegisterType::E, 0x91);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0x10);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6D, 0x00);
    WriteMemory(0x14FA, 0x6D);
    WriteMemory(0x14F9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0x87);
    CheckRegisterByte(RegisterType::C, 0x19);
    CheckRegisterByte(RegisterType::D, 0xFF);
    CheckRegisterByte(RegisterType::E, 0x91);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0x10);
    CheckRegisterWord(RegisterType::PC, 0x14FB);
    CheckRegisterWord(RegisterType::SP, 0xF6F1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x14F9, 0xE0);
    CheckMemory(0x14FA, 0x6D);
    CheckMemory(0xFF6D, 0xBD);
}

void test_E0_000D()
{
    if (skip_test_E0_000D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x92DB);
    WriteRegisterWord(RegisterType::SP, 0xEEEB);
    WriteRegisterByte(RegisterType::A, 0xB9);
    WriteRegisterByte(RegisterType::B, 0x37);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0x64);
    WriteRegisterByte(RegisterType::E, 0x4A);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x58);
    WriteRegisterByte(RegisterType::L, 0x54);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF53, 0x00);
    WriteMemory(0x92DC, 0x53);
    WriteMemory(0x92DB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB9);
    CheckRegisterByte(RegisterType::B, 0x37);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0x64);
    CheckRegisterByte(RegisterType::E, 0x4A);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x58);
    CheckRegisterByte(RegisterType::L, 0x54);
    CheckRegisterWord(RegisterType::PC, 0x92DD);
    CheckRegisterWord(RegisterType::SP, 0xEEEB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x92DB, 0xE0);
    CheckMemory(0x92DC, 0x53);
    CheckMemory(0xFF53, 0xB9);
}

void test_E0_000E()
{
    if (skip_test_E0_000E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC803);
    WriteRegisterWord(RegisterType::SP, 0x8400);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0xB5);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0x26);
    WriteRegisterByte(RegisterType::E, 0xA9);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xEE);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF56, 0x00);
    WriteMemory(0xC804, 0x56);
    WriteMemory(0xC803, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0xB5);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0x26);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xEE);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0xC805);
    CheckRegisterWord(RegisterType::SP, 0x8400);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC803, 0xE0);
    CheckMemory(0xC804, 0x56);
    CheckMemory(0xFF56, 0x95);
}

void test_E0_000F()
{
    if (skip_test_E0_000F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0106);
    WriteRegisterWord(RegisterType::SP, 0x5FBF);
    WriteRegisterByte(RegisterType::A, 0xA4);
    WriteRegisterByte(RegisterType::B, 0x59);
    WriteRegisterByte(RegisterType::C, 0x80);
    WriteRegisterByte(RegisterType::D, 0xE1);
    WriteRegisterByte(RegisterType::E, 0xB9);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD0);
    WriteRegisterByte(RegisterType::L, 0x9C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8F, 0x00);
    WriteMemory(0x0107, 0x8F);
    WriteMemory(0x0106, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA4);
    CheckRegisterByte(RegisterType::B, 0x59);
    CheckRegisterByte(RegisterType::C, 0x80);
    CheckRegisterByte(RegisterType::D, 0xE1);
    CheckRegisterByte(RegisterType::E, 0xB9);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD0);
    CheckRegisterByte(RegisterType::L, 0x9C);
    CheckRegisterWord(RegisterType::PC, 0x0108);
    CheckRegisterWord(RegisterType::SP, 0x5FBF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0106, 0xE0);
    CheckMemory(0x0107, 0x8F);
    CheckMemory(0xFF8F, 0xA4);
}

void test_E0_0010()
{
    if (skip_test_E0_0010)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB20C);
    WriteRegisterWord(RegisterType::SP, 0xDD34);
    WriteRegisterByte(RegisterType::A, 0x4A);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0x87);
    WriteRegisterByte(RegisterType::D, 0x1B);
    WriteRegisterByte(RegisterType::E, 0x25);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x2B);
    WriteRegisterByte(RegisterType::L, 0x11);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFDC, 0x00);
    WriteMemory(0xB20D, 0xDC);
    WriteMemory(0xB20C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4A);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0x87);
    CheckRegisterByte(RegisterType::D, 0x1B);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x2B);
    CheckRegisterByte(RegisterType::L, 0x11);
    CheckRegisterWord(RegisterType::PC, 0xB20E);
    CheckRegisterWord(RegisterType::SP, 0xDD34);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB20C, 0xE0);
    CheckMemory(0xB20D, 0xDC);
    CheckMemory(0xFFDC, 0x4A);
}

void test_E0_0011()
{
    if (skip_test_E0_0011)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA573);
    WriteRegisterWord(RegisterType::SP, 0x97D0);
    WriteRegisterByte(RegisterType::A, 0x14);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x46);
    WriteRegisterByte(RegisterType::D, 0x2E);
    WriteRegisterByte(RegisterType::E, 0xEA);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xBB);
    WriteRegisterByte(RegisterType::L, 0x91);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF90, 0x00);
    WriteMemory(0xA574, 0x90);
    WriteMemory(0xA573, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x14);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x46);
    CheckRegisterByte(RegisterType::D, 0x2E);
    CheckRegisterByte(RegisterType::E, 0xEA);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xBB);
    CheckRegisterByte(RegisterType::L, 0x91);
    CheckRegisterWord(RegisterType::PC, 0xA575);
    CheckRegisterWord(RegisterType::SP, 0x97D0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA573, 0xE0);
    CheckMemory(0xA574, 0x90);
    CheckMemory(0xFF90, 0x14);
}

void test_E0_0012()
{
    if (skip_test_E0_0012)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAD52);
    WriteRegisterWord(RegisterType::SP, 0x1F4D);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0xF0);
    WriteRegisterByte(RegisterType::C, 0xBF);
    WriteRegisterByte(RegisterType::D, 0xE6);
    WriteRegisterByte(RegisterType::E, 0x61);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD8);
    WriteRegisterByte(RegisterType::L, 0xAE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8B, 0x00);
    WriteMemory(0xAD53, 0x8B);
    WriteMemory(0xAD52, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0xF0);
    CheckRegisterByte(RegisterType::C, 0xBF);
    CheckRegisterByte(RegisterType::D, 0xE6);
    CheckRegisterByte(RegisterType::E, 0x61);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD8);
    CheckRegisterByte(RegisterType::L, 0xAE);
    CheckRegisterWord(RegisterType::PC, 0xAD54);
    CheckRegisterWord(RegisterType::SP, 0x1F4D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAD52, 0xE0);
    CheckMemory(0xAD53, 0x8B);
    CheckMemory(0xFF8B, 0x92);
}

void test_E0_0013()
{
    if (skip_test_E0_0013)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA3C9);
    WriteRegisterWord(RegisterType::SP, 0x84AD);
    WriteRegisterByte(RegisterType::A, 0xF6);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0xE3);
    WriteRegisterByte(RegisterType::E, 0x7E);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x2E);
    WriteRegisterByte(RegisterType::L, 0xB8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD5, 0x00);
    WriteMemory(0xA3CA, 0xD5);
    WriteMemory(0xA3C9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF6);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0xE3);
    CheckRegisterByte(RegisterType::E, 0x7E);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x2E);
    CheckRegisterByte(RegisterType::L, 0xB8);
    CheckRegisterWord(RegisterType::PC, 0xA3CB);
    CheckRegisterWord(RegisterType::SP, 0x84AD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA3C9, 0xE0);
    CheckMemory(0xA3CA, 0xD5);
    CheckMemory(0xFFD5, 0xF6);
}

void test_E0_0014()
{
    if (skip_test_E0_0014)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9057);
    WriteRegisterWord(RegisterType::SP, 0xC50C);
    WriteRegisterByte(RegisterType::A, 0xB9);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0x2A);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0x1E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB4, 0x00);
    WriteMemory(0x9058, 0xB4);
    WriteMemory(0x9057, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB9);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0x2A);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0x1E);
    CheckRegisterWord(RegisterType::PC, 0x9059);
    CheckRegisterWord(RegisterType::SP, 0xC50C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9057, 0xE0);
    CheckMemory(0x9058, 0xB4);
    CheckMemory(0xFFB4, 0xB9);
}

void test_E0_0015()
{
    if (skip_test_E0_0015)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x86FF);
    WriteRegisterWord(RegisterType::SP, 0xD245);
    WriteRegisterByte(RegisterType::A, 0xF5);
    WriteRegisterByte(RegisterType::B, 0x0D);
    WriteRegisterByte(RegisterType::C, 0x2F);
    WriteRegisterByte(RegisterType::D, 0x42);
    WriteRegisterByte(RegisterType::E, 0xD6);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0x09);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF98, 0x00);
    WriteMemory(0x8700, 0x98);
    WriteMemory(0x86FF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF5);
    CheckRegisterByte(RegisterType::B, 0x0D);
    CheckRegisterByte(RegisterType::C, 0x2F);
    CheckRegisterByte(RegisterType::D, 0x42);
    CheckRegisterByte(RegisterType::E, 0xD6);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0x09);
    CheckRegisterWord(RegisterType::PC, 0x8701);
    CheckRegisterWord(RegisterType::SP, 0xD245);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x86FF, 0xE0);
    CheckMemory(0x8700, 0x98);
    CheckMemory(0xFF98, 0xF5);
}

void test_E0_0016()
{
    if (skip_test_E0_0016)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6E21);
    WriteRegisterWord(RegisterType::SP, 0x45C6);
    WriteRegisterByte(RegisterType::A, 0x05);
    WriteRegisterByte(RegisterType::B, 0xCD);
    WriteRegisterByte(RegisterType::C, 0x66);
    WriteRegisterByte(RegisterType::D, 0x31);
    WriteRegisterByte(RegisterType::E, 0x76);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xBA);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF11, 0x00);
    WriteMemory(0x6E22, 0x11);
    WriteMemory(0x6E21, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x05);
    CheckRegisterByte(RegisterType::B, 0xCD);
    CheckRegisterByte(RegisterType::C, 0x66);
    CheckRegisterByte(RegisterType::D, 0x31);
    CheckRegisterByte(RegisterType::E, 0x76);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xBA);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0x6E23);
    CheckRegisterWord(RegisterType::SP, 0x45C6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6E21, 0xE0);
    CheckMemory(0x6E22, 0x11);
    CheckMemory(0xFF11, 0x05);
}

void test_E0_0017()
{
    if (skip_test_E0_0017)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1F57);
    WriteRegisterWord(RegisterType::SP, 0x3D0E);
    WriteRegisterByte(RegisterType::A, 0x6A);
    WriteRegisterByte(RegisterType::B, 0x17);
    WriteRegisterByte(RegisterType::C, 0xEB);
    WriteRegisterByte(RegisterType::D, 0xED);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x0B);
    WriteRegisterByte(RegisterType::L, 0xD5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC1, 0x00);
    WriteMemory(0x1F58, 0xC1);
    WriteMemory(0x1F57, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6A);
    CheckRegisterByte(RegisterType::B, 0x17);
    CheckRegisterByte(RegisterType::C, 0xEB);
    CheckRegisterByte(RegisterType::D, 0xED);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x0B);
    CheckRegisterByte(RegisterType::L, 0xD5);
    CheckRegisterWord(RegisterType::PC, 0x1F59);
    CheckRegisterWord(RegisterType::SP, 0x3D0E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1F57, 0xE0);
    CheckMemory(0x1F58, 0xC1);
    CheckMemory(0xFFC1, 0x6A);
}

void test_E0_0018()
{
    if (skip_test_E0_0018)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9E69);
    WriteRegisterWord(RegisterType::SP, 0xD733);
    WriteRegisterByte(RegisterType::A, 0xDF);
    WriteRegisterByte(RegisterType::B, 0x16);
    WriteRegisterByte(RegisterType::C, 0xFA);
    WriteRegisterByte(RegisterType::D, 0x04);
    WriteRegisterByte(RegisterType::E, 0x00);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0x9F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF7F, 0x00);
    WriteMemory(0x9E6A, 0x7F);
    WriteMemory(0x9E69, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDF);
    CheckRegisterByte(RegisterType::B, 0x16);
    CheckRegisterByte(RegisterType::C, 0xFA);
    CheckRegisterByte(RegisterType::D, 0x04);
    CheckRegisterByte(RegisterType::E, 0x00);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0x9F);
    CheckRegisterWord(RegisterType::PC, 0x9E6B);
    CheckRegisterWord(RegisterType::SP, 0xD733);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9E69, 0xE0);
    CheckMemory(0x9E6A, 0x7F);
    CheckMemory(0xFF7F, 0xDF);
}

void test_E0_0019()
{
    if (skip_test_E0_0019)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9665);
    WriteRegisterWord(RegisterType::SP, 0xBE05);
    WriteRegisterByte(RegisterType::A, 0x15);
    WriteRegisterByte(RegisterType::B, 0x17);
    WriteRegisterByte(RegisterType::C, 0xEE);
    WriteRegisterByte(RegisterType::D, 0xD9);
    WriteRegisterByte(RegisterType::E, 0x7E);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x54);
    WriteRegisterByte(RegisterType::L, 0x25);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5B, 0x00);
    WriteMemory(0x9666, 0x5B);
    WriteMemory(0x9665, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x15);
    CheckRegisterByte(RegisterType::B, 0x17);
    CheckRegisterByte(RegisterType::C, 0xEE);
    CheckRegisterByte(RegisterType::D, 0xD9);
    CheckRegisterByte(RegisterType::E, 0x7E);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x54);
    CheckRegisterByte(RegisterType::L, 0x25);
    CheckRegisterWord(RegisterType::PC, 0x9667);
    CheckRegisterWord(RegisterType::SP, 0xBE05);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9665, 0xE0);
    CheckMemory(0x9666, 0x5B);
    CheckMemory(0xFF5B, 0x15);
}

void test_E0_001A()
{
    if (skip_test_E0_001A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCB99);
    WriteRegisterWord(RegisterType::SP, 0x6BDF);
    WriteRegisterByte(RegisterType::A, 0xAD);
    WriteRegisterByte(RegisterType::B, 0x72);
    WriteRegisterByte(RegisterType::C, 0x50);
    WriteRegisterByte(RegisterType::D, 0xA3);
    WriteRegisterByte(RegisterType::E, 0x0B);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xE5);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF48, 0x00);
    WriteMemory(0xCB9A, 0x48);
    WriteMemory(0xCB99, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAD);
    CheckRegisterByte(RegisterType::B, 0x72);
    CheckRegisterByte(RegisterType::C, 0x50);
    CheckRegisterByte(RegisterType::D, 0xA3);
    CheckRegisterByte(RegisterType::E, 0x0B);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xE5);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0xCB9B);
    CheckRegisterWord(RegisterType::SP, 0x6BDF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCB99, 0xE0);
    CheckMemory(0xCB9A, 0x48);
    CheckMemory(0xFF48, 0xAD);
}

void test_E0_001B()
{
    if (skip_test_E0_001B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xADEB);
    WriteRegisterWord(RegisterType::SP, 0x9BD3);
    WriteRegisterByte(RegisterType::A, 0x89);
    WriteRegisterByte(RegisterType::B, 0xB3);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0x57);
    WriteRegisterByte(RegisterType::E, 0x5B);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x4F);
    WriteRegisterByte(RegisterType::L, 0x5C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC1, 0x00);
    WriteMemory(0xADEC, 0xC1);
    WriteMemory(0xADEB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x89);
    CheckRegisterByte(RegisterType::B, 0xB3);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0x57);
    CheckRegisterByte(RegisterType::E, 0x5B);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x4F);
    CheckRegisterByte(RegisterType::L, 0x5C);
    CheckRegisterWord(RegisterType::PC, 0xADED);
    CheckRegisterWord(RegisterType::SP, 0x9BD3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xADEB, 0xE0);
    CheckMemory(0xADEC, 0xC1);
    CheckMemory(0xFFC1, 0x89);
}

void test_E0_001C()
{
    if (skip_test_E0_001C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3745);
    WriteRegisterWord(RegisterType::SP, 0xA2C8);
    WriteRegisterByte(RegisterType::A, 0xBC);
    WriteRegisterByte(RegisterType::B, 0x3C);
    WriteRegisterByte(RegisterType::C, 0x1C);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0xB8);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xBC);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4D, 0x00);
    WriteMemory(0x3746, 0x4D);
    WriteMemory(0x3745, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBC);
    CheckRegisterByte(RegisterType::B, 0x3C);
    CheckRegisterByte(RegisterType::C, 0x1C);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0xB8);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xBC);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0x3747);
    CheckRegisterWord(RegisterType::SP, 0xA2C8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3745, 0xE0);
    CheckMemory(0x3746, 0x4D);
    CheckMemory(0xFF4D, 0xBC);
}

void test_E0_001D()
{
    if (skip_test_E0_001D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA009);
    WriteRegisterWord(RegisterType::SP, 0x4BF8);
    WriteRegisterByte(RegisterType::A, 0xEA);
    WriteRegisterByte(RegisterType::B, 0x0D);
    WriteRegisterByte(RegisterType::C, 0x84);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0x89);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x98);
    WriteRegisterByte(RegisterType::L, 0x55);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB6, 0x00);
    WriteMemory(0xA00A, 0xB6);
    WriteMemory(0xA009, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEA);
    CheckRegisterByte(RegisterType::B, 0x0D);
    CheckRegisterByte(RegisterType::C, 0x84);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0x89);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x98);
    CheckRegisterByte(RegisterType::L, 0x55);
    CheckRegisterWord(RegisterType::PC, 0xA00B);
    CheckRegisterWord(RegisterType::SP, 0x4BF8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA009, 0xE0);
    CheckMemory(0xA00A, 0xB6);
    CheckMemory(0xFFB6, 0xEA);
}

void test_E0_001E()
{
    if (skip_test_E0_001E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4DC5);
    WriteRegisterWord(RegisterType::SP, 0xC9F2);
    WriteRegisterByte(RegisterType::A, 0x29);
    WriteRegisterByte(RegisterType::B, 0x5B);
    WriteRegisterByte(RegisterType::C, 0xC8);
    WriteRegisterByte(RegisterType::D, 0xD1);
    WriteRegisterByte(RegisterType::E, 0x78);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0xDF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF10, 0x00);
    WriteMemory(0x4DC6, 0x10);
    WriteMemory(0x4DC5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x29);
    CheckRegisterByte(RegisterType::B, 0x5B);
    CheckRegisterByte(RegisterType::C, 0xC8);
    CheckRegisterByte(RegisterType::D, 0xD1);
    CheckRegisterByte(RegisterType::E, 0x78);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0xDF);
    CheckRegisterWord(RegisterType::PC, 0x4DC7);
    CheckRegisterWord(RegisterType::SP, 0xC9F2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4DC5, 0xE0);
    CheckMemory(0x4DC6, 0x10);
    CheckMemory(0xFF10, 0x29);
}

void test_E0_001F()
{
    if (skip_test_E0_001F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x673A);
    WriteRegisterWord(RegisterType::SP, 0x5CE5);
    WriteRegisterByte(RegisterType::A, 0xFA);
    WriteRegisterByte(RegisterType::B, 0x87);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0xDD);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0x87);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFBC, 0x00);
    WriteMemory(0x673B, 0xBC);
    WriteMemory(0x673A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFA);
    CheckRegisterByte(RegisterType::B, 0x87);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0xDD);
    CheckRegisterByte(RegisterType::E, 0xEE);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0x87);
    CheckRegisterWord(RegisterType::PC, 0x673C);
    CheckRegisterWord(RegisterType::SP, 0x5CE5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x673A, 0xE0);
    CheckMemory(0x673B, 0xBC);
    CheckMemory(0xFFBC, 0xFA);
}

void test_E0_0020()
{
    if (skip_test_E0_0020)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5EC5);
    WriteRegisterWord(RegisterType::SP, 0xE3A1);
    WriteRegisterByte(RegisterType::A, 0x01);
    WriteRegisterByte(RegisterType::B, 0x45);
    WriteRegisterByte(RegisterType::C, 0xCF);
    WriteRegisterByte(RegisterType::D, 0x6E);
    WriteRegisterByte(RegisterType::E, 0xC0);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x9B);
    WriteRegisterByte(RegisterType::L, 0xF1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC7, 0x00);
    WriteMemory(0x5EC6, 0xC7);
    WriteMemory(0x5EC5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x01);
    CheckRegisterByte(RegisterType::B, 0x45);
    CheckRegisterByte(RegisterType::C, 0xCF);
    CheckRegisterByte(RegisterType::D, 0x6E);
    CheckRegisterByte(RegisterType::E, 0xC0);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x9B);
    CheckRegisterByte(RegisterType::L, 0xF1);
    CheckRegisterWord(RegisterType::PC, 0x5EC7);
    CheckRegisterWord(RegisterType::SP, 0xE3A1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5EC5, 0xE0);
    CheckMemory(0x5EC6, 0xC7);
    CheckMemory(0xFFC7, 0x01);
}

void test_E0_0021()
{
    if (skip_test_E0_0021)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA4E3);
    WriteRegisterWord(RegisterType::SP, 0xB142);
    WriteRegisterByte(RegisterType::A, 0x7B);
    WriteRegisterByte(RegisterType::B, 0x37);
    WriteRegisterByte(RegisterType::C, 0xD0);
    WriteRegisterByte(RegisterType::D, 0xCA);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x9A);
    WriteRegisterByte(RegisterType::L, 0xFC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF67, 0x00);
    WriteMemory(0xA4E4, 0x67);
    WriteMemory(0xA4E3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7B);
    CheckRegisterByte(RegisterType::B, 0x37);
    CheckRegisterByte(RegisterType::C, 0xD0);
    CheckRegisterByte(RegisterType::D, 0xCA);
    CheckRegisterByte(RegisterType::E, 0xE7);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x9A);
    CheckRegisterByte(RegisterType::L, 0xFC);
    CheckRegisterWord(RegisterType::PC, 0xA4E5);
    CheckRegisterWord(RegisterType::SP, 0xB142);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA4E3, 0xE0);
    CheckMemory(0xA4E4, 0x67);
    CheckMemory(0xFF67, 0x7B);
}

void test_E0_0022()
{
    if (skip_test_E0_0022)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6C29);
    WriteRegisterWord(RegisterType::SP, 0x034D);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0xFC);
    WriteRegisterByte(RegisterType::D, 0x19);
    WriteRegisterByte(RegisterType::E, 0xB1);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xB8);
    WriteRegisterByte(RegisterType::L, 0x88);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8B, 0x00);
    WriteMemory(0x6C2A, 0x8B);
    WriteMemory(0x6C29, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0xFC);
    CheckRegisterByte(RegisterType::D, 0x19);
    CheckRegisterByte(RegisterType::E, 0xB1);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xB8);
    CheckRegisterByte(RegisterType::L, 0x88);
    CheckRegisterWord(RegisterType::PC, 0x6C2B);
    CheckRegisterWord(RegisterType::SP, 0x034D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6C29, 0xE0);
    CheckMemory(0x6C2A, 0x8B);
    CheckMemory(0xFF8B, 0x56);
}

void test_E0_0023()
{
    if (skip_test_E0_0023)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAB74);
    WriteRegisterWord(RegisterType::SP, 0x897E);
    WriteRegisterByte(RegisterType::A, 0xEA);
    WriteRegisterByte(RegisterType::B, 0xB3);
    WriteRegisterByte(RegisterType::C, 0x78);
    WriteRegisterByte(RegisterType::D, 0xF4);
    WriteRegisterByte(RegisterType::E, 0x99);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0x59);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF41, 0x00);
    WriteMemory(0xAB75, 0x41);
    WriteMemory(0xAB74, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEA);
    CheckRegisterByte(RegisterType::B, 0xB3);
    CheckRegisterByte(RegisterType::C, 0x78);
    CheckRegisterByte(RegisterType::D, 0xF4);
    CheckRegisterByte(RegisterType::E, 0x99);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0x59);
    CheckRegisterWord(RegisterType::PC, 0xAB76);
    CheckRegisterWord(RegisterType::SP, 0x897E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAB74, 0xE0);
    CheckMemory(0xAB75, 0x41);
    CheckMemory(0xFF41, 0xEA);
}

void test_E0_0024()
{
    if (skip_test_E0_0024)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0906);
    WriteRegisterWord(RegisterType::SP, 0x55AE);
    WriteRegisterByte(RegisterType::A, 0x76);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0xD6);
    WriteRegisterByte(RegisterType::D, 0x1E);
    WriteRegisterByte(RegisterType::E, 0x97);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x60);
    WriteRegisterByte(RegisterType::L, 0xDB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA7, 0x00);
    WriteMemory(0x0907, 0xA7);
    WriteMemory(0x0906, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x76);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0xD6);
    CheckRegisterByte(RegisterType::D, 0x1E);
    CheckRegisterByte(RegisterType::E, 0x97);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x60);
    CheckRegisterByte(RegisterType::L, 0xDB);
    CheckRegisterWord(RegisterType::PC, 0x0908);
    CheckRegisterWord(RegisterType::SP, 0x55AE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0906, 0xE0);
    CheckMemory(0x0907, 0xA7);
    CheckMemory(0xFFA7, 0x76);
}

void test_E0_0025()
{
    if (skip_test_E0_0025)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF146);
    WriteRegisterWord(RegisterType::SP, 0x7183);
    WriteRegisterByte(RegisterType::A, 0x6C);
    WriteRegisterByte(RegisterType::B, 0xA0);
    WriteRegisterByte(RegisterType::C, 0xE0);
    WriteRegisterByte(RegisterType::D, 0xC9);
    WriteRegisterByte(RegisterType::E, 0x55);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x84);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF27, 0x00);
    WriteMemory(0xF147, 0x27);
    WriteMemory(0xF146, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6C);
    CheckRegisterByte(RegisterType::B, 0xA0);
    CheckRegisterByte(RegisterType::C, 0xE0);
    CheckRegisterByte(RegisterType::D, 0xC9);
    CheckRegisterByte(RegisterType::E, 0x55);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x84);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0xF148);
    CheckRegisterWord(RegisterType::SP, 0x7183);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF146, 0xE0);
    CheckMemory(0xF147, 0x27);
    CheckMemory(0xFF27, 0x6C);
}

void test_E0_0026()
{
    if (skip_test_E0_0026)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4D42);
    WriteRegisterWord(RegisterType::SP, 0x51CB);
    WriteRegisterByte(RegisterType::A, 0xA0);
    WriteRegisterByte(RegisterType::B, 0x8E);
    WriteRegisterByte(RegisterType::C, 0x25);
    WriteRegisterByte(RegisterType::D, 0xF7);
    WriteRegisterByte(RegisterType::E, 0xA4);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x4B);
    WriteRegisterByte(RegisterType::L, 0x3D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFEC, 0x00);
    WriteMemory(0x4D43, 0xEC);
    WriteMemory(0x4D42, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA0);
    CheckRegisterByte(RegisterType::B, 0x8E);
    CheckRegisterByte(RegisterType::C, 0x25);
    CheckRegisterByte(RegisterType::D, 0xF7);
    CheckRegisterByte(RegisterType::E, 0xA4);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x4B);
    CheckRegisterByte(RegisterType::L, 0x3D);
    CheckRegisterWord(RegisterType::PC, 0x4D44);
    CheckRegisterWord(RegisterType::SP, 0x51CB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4D42, 0xE0);
    CheckMemory(0x4D43, 0xEC);
    CheckMemory(0xFFEC, 0xA0);
}

void test_E0_0027()
{
    if (skip_test_E0_0027)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6527);
    WriteRegisterWord(RegisterType::SP, 0x0F92);
    WriteRegisterByte(RegisterType::A, 0xB6);
    WriteRegisterByte(RegisterType::B, 0x09);
    WriteRegisterByte(RegisterType::C, 0x66);
    WriteRegisterByte(RegisterType::D, 0xF1);
    WriteRegisterByte(RegisterType::E, 0x7D);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0x73);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCB, 0x00);
    WriteMemory(0x6528, 0xCB);
    WriteMemory(0x6527, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB6);
    CheckRegisterByte(RegisterType::B, 0x09);
    CheckRegisterByte(RegisterType::C, 0x66);
    CheckRegisterByte(RegisterType::D, 0xF1);
    CheckRegisterByte(RegisterType::E, 0x7D);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0x73);
    CheckRegisterWord(RegisterType::PC, 0x6529);
    CheckRegisterWord(RegisterType::SP, 0x0F92);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6527, 0xE0);
    CheckMemory(0x6528, 0xCB);
    CheckMemory(0xFFCB, 0xB6);
}

void test_E0_0028()
{
    if (skip_test_E0_0028)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2D59);
    WriteRegisterWord(RegisterType::SP, 0x4047);
    WriteRegisterByte(RegisterType::A, 0x64);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0x3B);
    WriteRegisterByte(RegisterType::D, 0x2F);
    WriteRegisterByte(RegisterType::E, 0xD9);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x01);
    WriteRegisterByte(RegisterType::L, 0x22);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9C, 0x00);
    WriteMemory(0x2D5A, 0x9C);
    WriteMemory(0x2D59, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x64);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0x3B);
    CheckRegisterByte(RegisterType::D, 0x2F);
    CheckRegisterByte(RegisterType::E, 0xD9);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x01);
    CheckRegisterByte(RegisterType::L, 0x22);
    CheckRegisterWord(RegisterType::PC, 0x2D5B);
    CheckRegisterWord(RegisterType::SP, 0x4047);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2D59, 0xE0);
    CheckMemory(0x2D5A, 0x9C);
    CheckMemory(0xFF9C, 0x64);
}

void test_E0_0029()
{
    if (skip_test_E0_0029)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x767E);
    WriteRegisterWord(RegisterType::SP, 0x565C);
    WriteRegisterByte(RegisterType::A, 0xF7);
    WriteRegisterByte(RegisterType::B, 0x7A);
    WriteRegisterByte(RegisterType::C, 0x27);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0xAA);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xEE);
    WriteRegisterByte(RegisterType::L, 0x36);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC4, 0x00);
    WriteMemory(0x767F, 0xC4);
    WriteMemory(0x767E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF7);
    CheckRegisterByte(RegisterType::B, 0x7A);
    CheckRegisterByte(RegisterType::C, 0x27);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0xAA);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xEE);
    CheckRegisterByte(RegisterType::L, 0x36);
    CheckRegisterWord(RegisterType::PC, 0x7680);
    CheckRegisterWord(RegisterType::SP, 0x565C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x767E, 0xE0);
    CheckMemory(0x767F, 0xC4);
    CheckMemory(0xFFC4, 0xF7);
}

void test_E0_002A()
{
    if (skip_test_E0_002A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9E54);
    WriteRegisterWord(RegisterType::SP, 0xDFB8);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0x64);
    WriteRegisterByte(RegisterType::C, 0x1B);
    WriteRegisterByte(RegisterType::D, 0xDC);
    WriteRegisterByte(RegisterType::E, 0xBF);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x09);
    WriteRegisterByte(RegisterType::L, 0xB0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF60, 0x00);
    WriteMemory(0x9E55, 0x60);
    WriteMemory(0x9E54, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0x64);
    CheckRegisterByte(RegisterType::C, 0x1B);
    CheckRegisterByte(RegisterType::D, 0xDC);
    CheckRegisterByte(RegisterType::E, 0xBF);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x09);
    CheckRegisterByte(RegisterType::L, 0xB0);
    CheckRegisterWord(RegisterType::PC, 0x9E56);
    CheckRegisterWord(RegisterType::SP, 0xDFB8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9E54, 0xE0);
    CheckMemory(0x9E55, 0x60);
    CheckMemory(0xFF60, 0x9B);
}

void test_E0_002B()
{
    if (skip_test_E0_002B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9B19);
    WriteRegisterWord(RegisterType::SP, 0xC92B);
    WriteRegisterByte(RegisterType::A, 0x1F);
    WriteRegisterByte(RegisterType::B, 0xB4);
    WriteRegisterByte(RegisterType::C, 0x7D);
    WriteRegisterByte(RegisterType::D, 0x01);
    WriteRegisterByte(RegisterType::E, 0xDA);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x33);
    WriteRegisterByte(RegisterType::L, 0xE2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA4, 0x00);
    WriteMemory(0x9B1A, 0xA4);
    WriteMemory(0x9B19, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1F);
    CheckRegisterByte(RegisterType::B, 0xB4);
    CheckRegisterByte(RegisterType::C, 0x7D);
    CheckRegisterByte(RegisterType::D, 0x01);
    CheckRegisterByte(RegisterType::E, 0xDA);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x33);
    CheckRegisterByte(RegisterType::L, 0xE2);
    CheckRegisterWord(RegisterType::PC, 0x9B1B);
    CheckRegisterWord(RegisterType::SP, 0xC92B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9B19, 0xE0);
    CheckMemory(0x9B1A, 0xA4);
    CheckMemory(0xFFA4, 0x1F);
}

void test_E0_002C()
{
    if (skip_test_E0_002C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6671);
    WriteRegisterWord(RegisterType::SP, 0x2470);
    WriteRegisterByte(RegisterType::A, 0xC9);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0x9D);
    WriteRegisterByte(RegisterType::D, 0x68);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xEF);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF15, 0x00);
    WriteMemory(0x6672, 0x15);
    WriteMemory(0x6671, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC9);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0x9D);
    CheckRegisterByte(RegisterType::D, 0x68);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xEF);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0x6673);
    CheckRegisterWord(RegisterType::SP, 0x2470);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6671, 0xE0);
    CheckMemory(0x6672, 0x15);
    CheckMemory(0xFF15, 0xC9);
}

void test_E0_002D()
{
    if (skip_test_E0_002D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x53E4);
    WriteRegisterWord(RegisterType::SP, 0xA006);
    WriteRegisterByte(RegisterType::A, 0xAC);
    WriteRegisterByte(RegisterType::B, 0xA9);
    WriteRegisterByte(RegisterType::C, 0x11);
    WriteRegisterByte(RegisterType::D, 0x52);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0x4E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF2A, 0x00);
    WriteMemory(0x53E5, 0x2A);
    WriteMemory(0x53E4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAC);
    CheckRegisterByte(RegisterType::B, 0xA9);
    CheckRegisterByte(RegisterType::C, 0x11);
    CheckRegisterByte(RegisterType::D, 0x52);
    CheckRegisterByte(RegisterType::E, 0xC7);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0x4E);
    CheckRegisterWord(RegisterType::PC, 0x53E6);
    CheckRegisterWord(RegisterType::SP, 0xA006);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x53E4, 0xE0);
    CheckMemory(0x53E5, 0x2A);
    CheckMemory(0xFF2A, 0xAC);
}

void test_E0_002E()
{
    if (skip_test_E0_002E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1042);
    WriteRegisterWord(RegisterType::SP, 0xB0F2);
    WriteRegisterByte(RegisterType::A, 0x98);
    WriteRegisterByte(RegisterType::B, 0x26);
    WriteRegisterByte(RegisterType::C, 0xFF);
    WriteRegisterByte(RegisterType::D, 0x01);
    WriteRegisterByte(RegisterType::E, 0x5C);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0x38);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE6, 0x00);
    WriteMemory(0x1043, 0xE6);
    WriteMemory(0x1042, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x98);
    CheckRegisterByte(RegisterType::B, 0x26);
    CheckRegisterByte(RegisterType::C, 0xFF);
    CheckRegisterByte(RegisterType::D, 0x01);
    CheckRegisterByte(RegisterType::E, 0x5C);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0x38);
    CheckRegisterWord(RegisterType::PC, 0x1044);
    CheckRegisterWord(RegisterType::SP, 0xB0F2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1042, 0xE0);
    CheckMemory(0x1043, 0xE6);
    CheckMemory(0xFFE6, 0x98);
}

void test_E0_002F()
{
    if (skip_test_E0_002F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD1F7);
    WriteRegisterWord(RegisterType::SP, 0x1E54);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0x96);
    WriteRegisterByte(RegisterType::C, 0x50);
    WriteRegisterByte(RegisterType::D, 0x2F);
    WriteRegisterByte(RegisterType::E, 0x41);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xF2);
    WriteRegisterByte(RegisterType::L, 0x77);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF52, 0x00);
    WriteMemory(0xD1F8, 0x52);
    WriteMemory(0xD1F7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0x96);
    CheckRegisterByte(RegisterType::C, 0x50);
    CheckRegisterByte(RegisterType::D, 0x2F);
    CheckRegisterByte(RegisterType::E, 0x41);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xF2);
    CheckRegisterByte(RegisterType::L, 0x77);
    CheckRegisterWord(RegisterType::PC, 0xD1F9);
    CheckRegisterWord(RegisterType::SP, 0x1E54);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD1F7, 0xE0);
    CheckMemory(0xD1F8, 0x52);
    CheckMemory(0xFF52, 0x69);
}

void test_E0_0030()
{
    if (skip_test_E0_0030)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1EC7);
    WriteRegisterWord(RegisterType::SP, 0x85CF);
    WriteRegisterByte(RegisterType::A, 0x7E);
    WriteRegisterByte(RegisterType::B, 0x04);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0x53);
    WriteRegisterByte(RegisterType::E, 0xBB);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0x8D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0D, 0x00);
    WriteMemory(0x1EC8, 0x0D);
    WriteMemory(0x1EC7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7E);
    CheckRegisterByte(RegisterType::B, 0x04);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0x53);
    CheckRegisterByte(RegisterType::E, 0xBB);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0x8D);
    CheckRegisterWord(RegisterType::PC, 0x1EC9);
    CheckRegisterWord(RegisterType::SP, 0x85CF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1EC7, 0xE0);
    CheckMemory(0x1EC8, 0x0D);
    CheckMemory(0xFF0D, 0x7E);
}

void test_E0_0031()
{
    if (skip_test_E0_0031)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1083);
    WriteRegisterWord(RegisterType::SP, 0x7FAC);
    WriteRegisterByte(RegisterType::A, 0x13);
    WriteRegisterByte(RegisterType::B, 0x83);
    WriteRegisterByte(RegisterType::C, 0xED);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0x29);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x29);
    WriteRegisterByte(RegisterType::L, 0x7A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAF, 0x00);
    WriteMemory(0x1084, 0xAF);
    WriteMemory(0x1083, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x13);
    CheckRegisterByte(RegisterType::B, 0x83);
    CheckRegisterByte(RegisterType::C, 0xED);
    CheckRegisterByte(RegisterType::D, 0xDE);
    CheckRegisterByte(RegisterType::E, 0x29);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x29);
    CheckRegisterByte(RegisterType::L, 0x7A);
    CheckRegisterWord(RegisterType::PC, 0x1085);
    CheckRegisterWord(RegisterType::SP, 0x7FAC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1083, 0xE0);
    CheckMemory(0x1084, 0xAF);
    CheckMemory(0xFFAF, 0x13);
}

void test_E0_0032()
{
    if (skip_test_E0_0032)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5D4D);
    WriteRegisterWord(RegisterType::SP, 0x405F);
    WriteRegisterByte(RegisterType::A, 0x5E);
    WriteRegisterByte(RegisterType::B, 0xCE);
    WriteRegisterByte(RegisterType::C, 0x8A);
    WriteRegisterByte(RegisterType::D, 0x89);
    WriteRegisterByte(RegisterType::E, 0x8F);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x69);
    WriteRegisterByte(RegisterType::L, 0xBE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAF, 0x00);
    WriteMemory(0x5D4E, 0xAF);
    WriteMemory(0x5D4D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5E);
    CheckRegisterByte(RegisterType::B, 0xCE);
    CheckRegisterByte(RegisterType::C, 0x8A);
    CheckRegisterByte(RegisterType::D, 0x89);
    CheckRegisterByte(RegisterType::E, 0x8F);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x69);
    CheckRegisterByte(RegisterType::L, 0xBE);
    CheckRegisterWord(RegisterType::PC, 0x5D4F);
    CheckRegisterWord(RegisterType::SP, 0x405F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5D4D, 0xE0);
    CheckMemory(0x5D4E, 0xAF);
    CheckMemory(0xFFAF, 0x5E);
}

void test_E0_0033()
{
    if (skip_test_E0_0033)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9984);
    WriteRegisterWord(RegisterType::SP, 0x59E1);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0x30);
    WriteRegisterByte(RegisterType::C, 0x22);
    WriteRegisterByte(RegisterType::D, 0x13);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x94);
    WriteRegisterByte(RegisterType::L, 0x9D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3C, 0x00);
    WriteMemory(0x9985, 0x3C);
    WriteMemory(0x9984, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0x30);
    CheckRegisterByte(RegisterType::C, 0x22);
    CheckRegisterByte(RegisterType::D, 0x13);
    CheckRegisterByte(RegisterType::E, 0xE7);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x94);
    CheckRegisterByte(RegisterType::L, 0x9D);
    CheckRegisterWord(RegisterType::PC, 0x9986);
    CheckRegisterWord(RegisterType::SP, 0x59E1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9984, 0xE0);
    CheckMemory(0x9985, 0x3C);
    CheckMemory(0xFF3C, 0x24);
}

void test_E0_0034()
{
    if (skip_test_E0_0034)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x48D3);
    WriteRegisterWord(RegisterType::SP, 0x7C33);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0x51);
    WriteRegisterByte(RegisterType::D, 0x51);
    WriteRegisterByte(RegisterType::E, 0xB7);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x53);
    WriteRegisterByte(RegisterType::L, 0x7E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF1F, 0x00);
    WriteMemory(0x48D4, 0x1F);
    WriteMemory(0x48D3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0x51);
    CheckRegisterByte(RegisterType::D, 0x51);
    CheckRegisterByte(RegisterType::E, 0xB7);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x53);
    CheckRegisterByte(RegisterType::L, 0x7E);
    CheckRegisterWord(RegisterType::PC, 0x48D5);
    CheckRegisterWord(RegisterType::SP, 0x7C33);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x48D3, 0xE0);
    CheckMemory(0x48D4, 0x1F);
    CheckMemory(0xFF1F, 0xCC);
}

void test_E0_0035()
{
    if (skip_test_E0_0035)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4E1D);
    WriteRegisterWord(RegisterType::SP, 0x9352);
    WriteRegisterByte(RegisterType::A, 0xB4);
    WriteRegisterByte(RegisterType::B, 0xD5);
    WriteRegisterByte(RegisterType::C, 0xF8);
    WriteRegisterByte(RegisterType::D, 0x42);
    WriteRegisterByte(RegisterType::E, 0x4E);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xA5);
    WriteRegisterByte(RegisterType::L, 0x6D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF21, 0x00);
    WriteMemory(0x4E1E, 0x21);
    WriteMemory(0x4E1D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB4);
    CheckRegisterByte(RegisterType::B, 0xD5);
    CheckRegisterByte(RegisterType::C, 0xF8);
    CheckRegisterByte(RegisterType::D, 0x42);
    CheckRegisterByte(RegisterType::E, 0x4E);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xA5);
    CheckRegisterByte(RegisterType::L, 0x6D);
    CheckRegisterWord(RegisterType::PC, 0x4E1F);
    CheckRegisterWord(RegisterType::SP, 0x9352);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4E1D, 0xE0);
    CheckMemory(0x4E1E, 0x21);
    CheckMemory(0xFF21, 0xB4);
}

void test_E0_0036()
{
    if (skip_test_E0_0036)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE0CA);
    WriteRegisterWord(RegisterType::SP, 0x75F7);
    WriteRegisterByte(RegisterType::A, 0x47);
    WriteRegisterByte(RegisterType::B, 0x56);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0x31);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xEA);
    WriteRegisterByte(RegisterType::L, 0xE5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF20, 0x00);
    WriteMemory(0xE0CB, 0x20);
    WriteMemory(0xE0CA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x47);
    CheckRegisterByte(RegisterType::B, 0x56);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0x31);
    CheckRegisterByte(RegisterType::E, 0xA5);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xEA);
    CheckRegisterByte(RegisterType::L, 0xE5);
    CheckRegisterWord(RegisterType::PC, 0xE0CC);
    CheckRegisterWord(RegisterType::SP, 0x75F7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE0CA, 0xE0);
    CheckMemory(0xE0CB, 0x20);
    CheckMemory(0xFF20, 0x47);
}

void test_E0_0037()
{
    if (skip_test_E0_0037)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5AF0);
    WriteRegisterWord(RegisterType::SP, 0x7F83);
    WriteRegisterByte(RegisterType::A, 0x31);
    WriteRegisterByte(RegisterType::B, 0x29);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0x51);
    WriteRegisterByte(RegisterType::E, 0x44);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xCC);
    WriteRegisterByte(RegisterType::L, 0x6E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE5, 0x00);
    WriteMemory(0x5AF1, 0xE5);
    WriteMemory(0x5AF0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x31);
    CheckRegisterByte(RegisterType::B, 0x29);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0x51);
    CheckRegisterByte(RegisterType::E, 0x44);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xCC);
    CheckRegisterByte(RegisterType::L, 0x6E);
    CheckRegisterWord(RegisterType::PC, 0x5AF2);
    CheckRegisterWord(RegisterType::SP, 0x7F83);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5AF0, 0xE0);
    CheckMemory(0x5AF1, 0xE5);
    CheckMemory(0xFFE5, 0x31);
}

void test_E0_0038()
{
    if (skip_test_E0_0038)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFAB4);
    WriteRegisterWord(RegisterType::SP, 0x2550);
    WriteRegisterByte(RegisterType::A, 0x5C);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0xBB);
    WriteRegisterByte(RegisterType::D, 0x03);
    WriteRegisterByte(RegisterType::E, 0x25);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x72);
    WriteRegisterByte(RegisterType::L, 0x27);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF6F, 0x00);
    WriteMemory(0xFAB5, 0x6F);
    WriteMemory(0xFAB4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5C);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0xBB);
    CheckRegisterByte(RegisterType::D, 0x03);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x72);
    CheckRegisterByte(RegisterType::L, 0x27);
    CheckRegisterWord(RegisterType::PC, 0xFAB6);
    CheckRegisterWord(RegisterType::SP, 0x2550);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFAB4, 0xE0);
    CheckMemory(0xFAB5, 0x6F);
    CheckMemory(0xFF6F, 0x5C);
}

void test_E0_0039()
{
    if (skip_test_E0_0039)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4E97);
    WriteRegisterWord(RegisterType::SP, 0x200E);
    WriteRegisterByte(RegisterType::A, 0x2D);
    WriteRegisterByte(RegisterType::B, 0xA5);
    WriteRegisterByte(RegisterType::C, 0x90);
    WriteRegisterByte(RegisterType::D, 0x4D);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x5F);
    WriteRegisterByte(RegisterType::L, 0x8F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD6, 0x00);
    WriteMemory(0x4E98, 0xD6);
    WriteMemory(0x4E97, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2D);
    CheckRegisterByte(RegisterType::B, 0xA5);
    CheckRegisterByte(RegisterType::C, 0x90);
    CheckRegisterByte(RegisterType::D, 0x4D);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x5F);
    CheckRegisterByte(RegisterType::L, 0x8F);
    CheckRegisterWord(RegisterType::PC, 0x4E99);
    CheckRegisterWord(RegisterType::SP, 0x200E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4E97, 0xE0);
    CheckMemory(0x4E98, 0xD6);
    CheckMemory(0xFFD6, 0x2D);
}

void test_E0_003A()
{
    if (skip_test_E0_003A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6565);
    WriteRegisterWord(RegisterType::SP, 0x2DF3);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0xCA);
    WriteRegisterByte(RegisterType::C, 0x91);
    WriteRegisterByte(RegisterType::D, 0x13);
    WriteRegisterByte(RegisterType::E, 0x37);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9B, 0x00);
    WriteMemory(0x6566, 0x9B);
    WriteMemory(0x6565, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0xCA);
    CheckRegisterByte(RegisterType::C, 0x91);
    CheckRegisterByte(RegisterType::D, 0x13);
    CheckRegisterByte(RegisterType::E, 0x37);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0x6567);
    CheckRegisterWord(RegisterType::SP, 0x2DF3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6565, 0xE0);
    CheckMemory(0x6566, 0x9B);
    CheckMemory(0xFF9B, 0xD1);
}

void test_E0_003B()
{
    if (skip_test_E0_003B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4903);
    WriteRegisterWord(RegisterType::SP, 0x37E3);
    WriteRegisterByte(RegisterType::A, 0x8C);
    WriteRegisterByte(RegisterType::B, 0x84);
    WriteRegisterByte(RegisterType::C, 0xE8);
    WriteRegisterByte(RegisterType::D, 0x35);
    WriteRegisterByte(RegisterType::E, 0x1C);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xE6);
    WriteRegisterByte(RegisterType::L, 0x79);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF6E, 0x00);
    WriteMemory(0x4904, 0x6E);
    WriteMemory(0x4903, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8C);
    CheckRegisterByte(RegisterType::B, 0x84);
    CheckRegisterByte(RegisterType::C, 0xE8);
    CheckRegisterByte(RegisterType::D, 0x35);
    CheckRegisterByte(RegisterType::E, 0x1C);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xE6);
    CheckRegisterByte(RegisterType::L, 0x79);
    CheckRegisterWord(RegisterType::PC, 0x4905);
    CheckRegisterWord(RegisterType::SP, 0x37E3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4903, 0xE0);
    CheckMemory(0x4904, 0x6E);
    CheckMemory(0xFF6E, 0x8C);
}

void test_E0_003C()
{
    if (skip_test_E0_003C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x356B);
    WriteRegisterWord(RegisterType::SP, 0xE8ED);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0xD4);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0x21);
    WriteRegisterByte(RegisterType::E, 0x3C);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0x36);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA2, 0x00);
    WriteMemory(0x356C, 0xA2);
    WriteMemory(0x356B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0xD4);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0x21);
    CheckRegisterByte(RegisterType::E, 0x3C);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0x36);
    CheckRegisterWord(RegisterType::PC, 0x356D);
    CheckRegisterWord(RegisterType::SP, 0xE8ED);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x356B, 0xE0);
    CheckMemory(0x356C, 0xA2);
    CheckMemory(0xFFA2, 0xBD);
}

void test_E0_003D()
{
    if (skip_test_E0_003D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD632);
    WriteRegisterWord(RegisterType::SP, 0xEBF6);
    WriteRegisterByte(RegisterType::A, 0xFC);
    WriteRegisterByte(RegisterType::B, 0x29);
    WriteRegisterByte(RegisterType::C, 0x30);
    WriteRegisterByte(RegisterType::D, 0x63);
    WriteRegisterByte(RegisterType::E, 0xBE);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x2F);
    WriteRegisterByte(RegisterType::L, 0x78);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF82, 0x00);
    WriteMemory(0xD633, 0x82);
    WriteMemory(0xD632, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFC);
    CheckRegisterByte(RegisterType::B, 0x29);
    CheckRegisterByte(RegisterType::C, 0x30);
    CheckRegisterByte(RegisterType::D, 0x63);
    CheckRegisterByte(RegisterType::E, 0xBE);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x2F);
    CheckRegisterByte(RegisterType::L, 0x78);
    CheckRegisterWord(RegisterType::PC, 0xD634);
    CheckRegisterWord(RegisterType::SP, 0xEBF6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD632, 0xE0);
    CheckMemory(0xD633, 0x82);
    CheckMemory(0xFF82, 0xFC);
}

void test_E0_003E()
{
    if (skip_test_E0_003E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDF01);
    WriteRegisterWord(RegisterType::SP, 0x1DCE);
    WriteRegisterByte(RegisterType::A, 0x8A);
    WriteRegisterByte(RegisterType::B, 0x9B);
    WriteRegisterByte(RegisterType::C, 0x55);
    WriteRegisterByte(RegisterType::D, 0x43);
    WriteRegisterByte(RegisterType::E, 0xBC);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x3F);
    WriteRegisterByte(RegisterType::L, 0xF3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF48, 0x00);
    WriteMemory(0xDF02, 0x48);
    WriteMemory(0xDF01, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8A);
    CheckRegisterByte(RegisterType::B, 0x9B);
    CheckRegisterByte(RegisterType::C, 0x55);
    CheckRegisterByte(RegisterType::D, 0x43);
    CheckRegisterByte(RegisterType::E, 0xBC);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x3F);
    CheckRegisterByte(RegisterType::L, 0xF3);
    CheckRegisterWord(RegisterType::PC, 0xDF03);
    CheckRegisterWord(RegisterType::SP, 0x1DCE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDF01, 0xE0);
    CheckMemory(0xDF02, 0x48);
    CheckMemory(0xFF48, 0x8A);
}

void test_E0_003F()
{
    if (skip_test_E0_003F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3B0A);
    WriteRegisterWord(RegisterType::SP, 0xB594);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0xA0);
    WriteRegisterByte(RegisterType::C, 0x53);
    WriteRegisterByte(RegisterType::D, 0xD3);
    WriteRegisterByte(RegisterType::E, 0x4C);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x16);
    WriteRegisterByte(RegisterType::L, 0xA1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAD, 0x00);
    WriteMemory(0x3B0B, 0xAD);
    WriteMemory(0x3B0A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0xA0);
    CheckRegisterByte(RegisterType::C, 0x53);
    CheckRegisterByte(RegisterType::D, 0xD3);
    CheckRegisterByte(RegisterType::E, 0x4C);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x16);
    CheckRegisterByte(RegisterType::L, 0xA1);
    CheckRegisterWord(RegisterType::PC, 0x3B0C);
    CheckRegisterWord(RegisterType::SP, 0xB594);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3B0A, 0xE0);
    CheckMemory(0x3B0B, 0xAD);
    CheckMemory(0xFFAD, 0x32);
}

void test_E0_0040()
{
    if (skip_test_E0_0040)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4212);
    WriteRegisterWord(RegisterType::SP, 0xEDAC);
    WriteRegisterByte(RegisterType::A, 0x5C);
    WriteRegisterByte(RegisterType::B, 0x94);
    WriteRegisterByte(RegisterType::C, 0x5C);
    WriteRegisterByte(RegisterType::D, 0x60);
    WriteRegisterByte(RegisterType::E, 0x4F);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x5E);
    WriteRegisterByte(RegisterType::L, 0x8C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8D, 0x00);
    WriteMemory(0x4213, 0x8D);
    WriteMemory(0x4212, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5C);
    CheckRegisterByte(RegisterType::B, 0x94);
    CheckRegisterByte(RegisterType::C, 0x5C);
    CheckRegisterByte(RegisterType::D, 0x60);
    CheckRegisterByte(RegisterType::E, 0x4F);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x5E);
    CheckRegisterByte(RegisterType::L, 0x8C);
    CheckRegisterWord(RegisterType::PC, 0x4214);
    CheckRegisterWord(RegisterType::SP, 0xEDAC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4212, 0xE0);
    CheckMemory(0x4213, 0x8D);
    CheckMemory(0xFF8D, 0x5C);
}

void test_E0_0041()
{
    if (skip_test_E0_0041)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x702A);
    WriteRegisterWord(RegisterType::SP, 0x02E6);
    WriteRegisterByte(RegisterType::A, 0xDE);
    WriteRegisterByte(RegisterType::B, 0xCB);
    WriteRegisterByte(RegisterType::C, 0x3B);
    WriteRegisterByte(RegisterType::D, 0x0C);
    WriteRegisterByte(RegisterType::E, 0x19);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x13);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4C, 0x00);
    WriteMemory(0x702B, 0x4C);
    WriteMemory(0x702A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDE);
    CheckRegisterByte(RegisterType::B, 0xCB);
    CheckRegisterByte(RegisterType::C, 0x3B);
    CheckRegisterByte(RegisterType::D, 0x0C);
    CheckRegisterByte(RegisterType::E, 0x19);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x13);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0x702C);
    CheckRegisterWord(RegisterType::SP, 0x02E6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x702A, 0xE0);
    CheckMemory(0x702B, 0x4C);
    CheckMemory(0xFF4C, 0xDE);
}

void test_E0_0042()
{
    if (skip_test_E0_0042)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB52E);
    WriteRegisterWord(RegisterType::SP, 0x0EAC);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0x1A);
    WriteRegisterByte(RegisterType::D, 0xEC);
    WriteRegisterByte(RegisterType::E, 0x31);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x08);
    WriteRegisterByte(RegisterType::L, 0x93);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF77, 0x00);
    WriteMemory(0xB52F, 0x77);
    WriteMemory(0xB52E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0x1A);
    CheckRegisterByte(RegisterType::D, 0xEC);
    CheckRegisterByte(RegisterType::E, 0x31);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x08);
    CheckRegisterByte(RegisterType::L, 0x93);
    CheckRegisterWord(RegisterType::PC, 0xB530);
    CheckRegisterWord(RegisterType::SP, 0x0EAC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB52E, 0xE0);
    CheckMemory(0xB52F, 0x77);
    CheckMemory(0xFF77, 0x69);
}

void test_E0_0043()
{
    if (skip_test_E0_0043)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB6D2);
    WriteRegisterWord(RegisterType::SP, 0x6200);
    WriteRegisterByte(RegisterType::A, 0x21);
    WriteRegisterByte(RegisterType::B, 0x2D);
    WriteRegisterByte(RegisterType::C, 0x93);
    WriteRegisterByte(RegisterType::D, 0xDB);
    WriteRegisterByte(RegisterType::E, 0x2F);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xB4);
    WriteRegisterByte(RegisterType::L, 0x5F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDC, 0x00);
    WriteMemory(0xB6D3, 0xDC);
    WriteMemory(0xB6D2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x21);
    CheckRegisterByte(RegisterType::B, 0x2D);
    CheckRegisterByte(RegisterType::C, 0x93);
    CheckRegisterByte(RegisterType::D, 0xDB);
    CheckRegisterByte(RegisterType::E, 0x2F);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xB4);
    CheckRegisterByte(RegisterType::L, 0x5F);
    CheckRegisterWord(RegisterType::PC, 0xB6D4);
    CheckRegisterWord(RegisterType::SP, 0x6200);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB6D2, 0xE0);
    CheckMemory(0xB6D3, 0xDC);
    CheckMemory(0xFFDC, 0x21);
}

void test_E0_0044()
{
    if (skip_test_E0_0044)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1FA0);
    WriteRegisterWord(RegisterType::SP, 0x5FDF);
    WriteRegisterByte(RegisterType::A, 0x21);
    WriteRegisterByte(RegisterType::B, 0xF1);
    WriteRegisterByte(RegisterType::C, 0x67);
    WriteRegisterByte(RegisterType::D, 0x56);
    WriteRegisterByte(RegisterType::E, 0x9B);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x1C);
    WriteRegisterByte(RegisterType::L, 0x46);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFBE, 0x00);
    WriteMemory(0x1FA1, 0xBE);
    WriteMemory(0x1FA0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x21);
    CheckRegisterByte(RegisterType::B, 0xF1);
    CheckRegisterByte(RegisterType::C, 0x67);
    CheckRegisterByte(RegisterType::D, 0x56);
    CheckRegisterByte(RegisterType::E, 0x9B);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x1C);
    CheckRegisterByte(RegisterType::L, 0x46);
    CheckRegisterWord(RegisterType::PC, 0x1FA2);
    CheckRegisterWord(RegisterType::SP, 0x5FDF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1FA0, 0xE0);
    CheckMemory(0x1FA1, 0xBE);
    CheckMemory(0xFFBE, 0x21);
}

void test_E0_0045()
{
    if (skip_test_E0_0045)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9D50);
    WriteRegisterWord(RegisterType::SP, 0x9F3A);
    WriteRegisterByte(RegisterType::A, 0x4C);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0xB1);
    WriteRegisterByte(RegisterType::D, 0x35);
    WriteRegisterByte(RegisterType::E, 0x1E);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x25);
    WriteRegisterByte(RegisterType::L, 0x28);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF1F, 0x00);
    WriteMemory(0x9D51, 0x1F);
    WriteMemory(0x9D50, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4C);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0xB1);
    CheckRegisterByte(RegisterType::D, 0x35);
    CheckRegisterByte(RegisterType::E, 0x1E);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x25);
    CheckRegisterByte(RegisterType::L, 0x28);
    CheckRegisterWord(RegisterType::PC, 0x9D52);
    CheckRegisterWord(RegisterType::SP, 0x9F3A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9D50, 0xE0);
    CheckMemory(0x9D51, 0x1F);
    CheckMemory(0xFF1F, 0x4C);
}

void test_E0_0046()
{
    if (skip_test_E0_0046)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x46C3);
    WriteRegisterWord(RegisterType::SP, 0x1A43);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0x09);
    WriteRegisterByte(RegisterType::C, 0x41);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0x6C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF74, 0x00);
    WriteMemory(0x46C4, 0x74);
    WriteMemory(0x46C3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0x09);
    CheckRegisterByte(RegisterType::C, 0x41);
    CheckRegisterByte(RegisterType::D, 0xEE);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0x6C);
    CheckRegisterWord(RegisterType::PC, 0x46C5);
    CheckRegisterWord(RegisterType::SP, 0x1A43);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x46C3, 0xE0);
    CheckMemory(0x46C4, 0x74);
    CheckMemory(0xFF74, 0x44);
}

void test_E0_0047()
{
    if (skip_test_E0_0047)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8CB7);
    WriteRegisterWord(RegisterType::SP, 0x8FF6);
    WriteRegisterByte(RegisterType::A, 0x90);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0xE6);
    WriteRegisterByte(RegisterType::D, 0xC0);
    WriteRegisterByte(RegisterType::E, 0xB6);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x23);
    WriteRegisterByte(RegisterType::L, 0x15);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF2, 0x00);
    WriteMemory(0x8CB8, 0xF2);
    WriteMemory(0x8CB7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x90);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0xE6);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0xB6);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x23);
    CheckRegisterByte(RegisterType::L, 0x15);
    CheckRegisterWord(RegisterType::PC, 0x8CB9);
    CheckRegisterWord(RegisterType::SP, 0x8FF6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8CB7, 0xE0);
    CheckMemory(0x8CB8, 0xF2);
    CheckMemory(0xFFF2, 0x90);
}

void test_E0_0048()
{
    if (skip_test_E0_0048)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x03AA);
    WriteRegisterWord(RegisterType::SP, 0x8CF7);
    WriteRegisterByte(RegisterType::A, 0x00);
    WriteRegisterByte(RegisterType::B, 0x5A);
    WriteRegisterByte(RegisterType::C, 0xC6);
    WriteRegisterByte(RegisterType::D, 0x5C);
    WriteRegisterByte(RegisterType::E, 0xCA);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x62);
    WriteRegisterByte(RegisterType::L, 0xF4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF00, 0x00);
    WriteMemory(0x03AB, 0x00);
    WriteMemory(0x03AA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x00);
    CheckRegisterByte(RegisterType::B, 0x5A);
    CheckRegisterByte(RegisterType::C, 0xC6);
    CheckRegisterByte(RegisterType::D, 0x5C);
    CheckRegisterByte(RegisterType::E, 0xCA);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x62);
    CheckRegisterByte(RegisterType::L, 0xF4);
    CheckRegisterWord(RegisterType::PC, 0x03AC);
    CheckRegisterWord(RegisterType::SP, 0x8CF7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x03AA, 0xE0);
    CheckMemory(0x03AB, 0x00);
    CheckMemory(0xFF00, 0x00);
}

void test_E0_0049()
{
    if (skip_test_E0_0049)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x78C5);
    WriteRegisterWord(RegisterType::SP, 0xFB44);
    WriteRegisterByte(RegisterType::A, 0xB3);
    WriteRegisterByte(RegisterType::B, 0xB1);
    WriteRegisterByte(RegisterType::C, 0xC2);
    WriteRegisterByte(RegisterType::D, 0x1F);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x20);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD1, 0x00);
    WriteMemory(0x78C6, 0xD1);
    WriteMemory(0x78C5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB3);
    CheckRegisterByte(RegisterType::B, 0xB1);
    CheckRegisterByte(RegisterType::C, 0xC2);
    CheckRegisterByte(RegisterType::D, 0x1F);
    CheckRegisterByte(RegisterType::E, 0x95);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x20);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0x78C7);
    CheckRegisterWord(RegisterType::SP, 0xFB44);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x78C5, 0xE0);
    CheckMemory(0x78C6, 0xD1);
    CheckMemory(0xFFD1, 0xB3);
}

void test_E0_004A()
{
    if (skip_test_E0_004A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7C1B);
    WriteRegisterWord(RegisterType::SP, 0xFF08);
    WriteRegisterByte(RegisterType::A, 0x06);
    WriteRegisterByte(RegisterType::B, 0x6C);
    WriteRegisterByte(RegisterType::C, 0x63);
    WriteRegisterByte(RegisterType::D, 0x78);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xCC);
    WriteRegisterByte(RegisterType::L, 0x8D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF19, 0x00);
    WriteMemory(0x7C1C, 0x19);
    WriteMemory(0x7C1B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x06);
    CheckRegisterByte(RegisterType::B, 0x6C);
    CheckRegisterByte(RegisterType::C, 0x63);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xCC);
    CheckRegisterByte(RegisterType::L, 0x8D);
    CheckRegisterWord(RegisterType::PC, 0x7C1D);
    CheckRegisterWord(RegisterType::SP, 0xFF08);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7C1B, 0xE0);
    CheckMemory(0x7C1C, 0x19);
    CheckMemory(0xFF19, 0x06);
}

void test_E0_004B()
{
    if (skip_test_E0_004B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF497);
    WriteRegisterWord(RegisterType::SP, 0x1185);
    WriteRegisterByte(RegisterType::A, 0x36);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0xD9);
    WriteRegisterByte(RegisterType::D, 0x46);
    WriteRegisterByte(RegisterType::E, 0xEF);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xD4);
    WriteRegisterByte(RegisterType::L, 0x8F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAE, 0x00);
    WriteMemory(0xF498, 0xAE);
    WriteMemory(0xF497, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x36);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0xD9);
    CheckRegisterByte(RegisterType::D, 0x46);
    CheckRegisterByte(RegisterType::E, 0xEF);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xD4);
    CheckRegisterByte(RegisterType::L, 0x8F);
    CheckRegisterWord(RegisterType::PC, 0xF499);
    CheckRegisterWord(RegisterType::SP, 0x1185);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF497, 0xE0);
    CheckMemory(0xF498, 0xAE);
    CheckMemory(0xFFAE, 0x36);
}

void test_E0_004C()
{
    if (skip_test_E0_004C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7F84);
    WriteRegisterWord(RegisterType::SP, 0x5542);
    WriteRegisterByte(RegisterType::A, 0xE0);
    WriteRegisterByte(RegisterType::B, 0x13);
    WriteRegisterByte(RegisterType::C, 0x31);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0x3A);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xCC);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8F, 0x00);
    WriteMemory(0x7F85, 0x8F);
    WriteMemory(0x7F84, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE0);
    CheckRegisterByte(RegisterType::B, 0x13);
    CheckRegisterByte(RegisterType::C, 0x31);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xCC);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0x7F86);
    CheckRegisterWord(RegisterType::SP, 0x5542);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7F84, 0xE0);
    CheckMemory(0x7F85, 0x8F);
    CheckMemory(0xFF8F, 0xE0);
}

void test_E0_004D()
{
    if (skip_test_E0_004D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x57FA);
    WriteRegisterWord(RegisterType::SP, 0x317E);
    WriteRegisterByte(RegisterType::A, 0x8C);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0x93);
    WriteRegisterByte(RegisterType::D, 0xF8);
    WriteRegisterByte(RegisterType::E, 0x0A);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xD3);
    WriteRegisterByte(RegisterType::L, 0x6E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFDE, 0x00);
    WriteMemory(0x57FB, 0xDE);
    WriteMemory(0x57FA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8C);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0x93);
    CheckRegisterByte(RegisterType::D, 0xF8);
    CheckRegisterByte(RegisterType::E, 0x0A);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xD3);
    CheckRegisterByte(RegisterType::L, 0x6E);
    CheckRegisterWord(RegisterType::PC, 0x57FC);
    CheckRegisterWord(RegisterType::SP, 0x317E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x57FA, 0xE0);
    CheckMemory(0x57FB, 0xDE);
    CheckMemory(0xFFDE, 0x8C);
}

void test_E0_004E()
{
    if (skip_test_E0_004E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x28F0);
    WriteRegisterWord(RegisterType::SP, 0x665E);
    WriteRegisterByte(RegisterType::A, 0x1C);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0x53);
    WriteRegisterByte(RegisterType::D, 0xED);
    WriteRegisterByte(RegisterType::E, 0xEA);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x60);
    WriteRegisterByte(RegisterType::L, 0x1C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5E, 0x00);
    WriteMemory(0x28F1, 0x5E);
    WriteMemory(0x28F0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1C);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0x53);
    CheckRegisterByte(RegisterType::D, 0xED);
    CheckRegisterByte(RegisterType::E, 0xEA);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x60);
    CheckRegisterByte(RegisterType::L, 0x1C);
    CheckRegisterWord(RegisterType::PC, 0x28F2);
    CheckRegisterWord(RegisterType::SP, 0x665E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x28F0, 0xE0);
    CheckMemory(0x28F1, 0x5E);
    CheckMemory(0xFF5E, 0x1C);
}

void test_E0_004F()
{
    if (skip_test_E0_004F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x246E);
    WriteRegisterWord(RegisterType::SP, 0x591C);
    WriteRegisterByte(RegisterType::A, 0xCB);
    WriteRegisterByte(RegisterType::B, 0x8A);
    WriteRegisterByte(RegisterType::C, 0xC2);
    WriteRegisterByte(RegisterType::D, 0x28);
    WriteRegisterByte(RegisterType::E, 0x71);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xB7);
    WriteRegisterByte(RegisterType::L, 0xF9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA2, 0x00);
    WriteMemory(0x246F, 0xA2);
    WriteMemory(0x246E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCB);
    CheckRegisterByte(RegisterType::B, 0x8A);
    CheckRegisterByte(RegisterType::C, 0xC2);
    CheckRegisterByte(RegisterType::D, 0x28);
    CheckRegisterByte(RegisterType::E, 0x71);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xB7);
    CheckRegisterByte(RegisterType::L, 0xF9);
    CheckRegisterWord(RegisterType::PC, 0x2470);
    CheckRegisterWord(RegisterType::SP, 0x591C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x246E, 0xE0);
    CheckMemory(0x246F, 0xA2);
    CheckMemory(0xFFA2, 0xCB);
}

void test_E0_0050()
{
    if (skip_test_E0_0050)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9F45);
    WriteRegisterWord(RegisterType::SP, 0xBC0D);
    WriteRegisterByte(RegisterType::A, 0x38);
    WriteRegisterByte(RegisterType::B, 0x9F);
    WriteRegisterByte(RegisterType::C, 0xE2);
    WriteRegisterByte(RegisterType::D, 0x07);
    WriteRegisterByte(RegisterType::E, 0xC8);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x1E);
    WriteRegisterByte(RegisterType::L, 0xA2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA2, 0x00);
    WriteMemory(0x9F46, 0xA2);
    WriteMemory(0x9F45, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x38);
    CheckRegisterByte(RegisterType::B, 0x9F);
    CheckRegisterByte(RegisterType::C, 0xE2);
    CheckRegisterByte(RegisterType::D, 0x07);
    CheckRegisterByte(RegisterType::E, 0xC8);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x1E);
    CheckRegisterByte(RegisterType::L, 0xA2);
    CheckRegisterWord(RegisterType::PC, 0x9F47);
    CheckRegisterWord(RegisterType::SP, 0xBC0D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9F45, 0xE0);
    CheckMemory(0x9F46, 0xA2);
    CheckMemory(0xFFA2, 0x38);
}

void test_E0_0051()
{
    if (skip_test_E0_0051)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2610);
    WriteRegisterWord(RegisterType::SP, 0xF3CA);
    WriteRegisterByte(RegisterType::A, 0x4E);
    WriteRegisterByte(RegisterType::B, 0x27);
    WriteRegisterByte(RegisterType::C, 0xAF);
    WriteRegisterByte(RegisterType::D, 0x79);
    WriteRegisterByte(RegisterType::E, 0x62);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0xBE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9A, 0x00);
    WriteMemory(0x2611, 0x9A);
    WriteMemory(0x2610, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4E);
    CheckRegisterByte(RegisterType::B, 0x27);
    CheckRegisterByte(RegisterType::C, 0xAF);
    CheckRegisterByte(RegisterType::D, 0x79);
    CheckRegisterByte(RegisterType::E, 0x62);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0xBE);
    CheckRegisterWord(RegisterType::PC, 0x2612);
    CheckRegisterWord(RegisterType::SP, 0xF3CA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2610, 0xE0);
    CheckMemory(0x2611, 0x9A);
    CheckMemory(0xFF9A, 0x4E);
}

void test_E0_0052()
{
    if (skip_test_E0_0052)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBDB3);
    WriteRegisterWord(RegisterType::SP, 0x489C);
    WriteRegisterByte(RegisterType::A, 0x68);
    WriteRegisterByte(RegisterType::B, 0x74);
    WriteRegisterByte(RegisterType::C, 0x90);
    WriteRegisterByte(RegisterType::D, 0x87);
    WriteRegisterByte(RegisterType::E, 0xA4);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x7D);
    WriteRegisterByte(RegisterType::L, 0x2A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE8, 0x00);
    WriteMemory(0xBDB4, 0xE8);
    WriteMemory(0xBDB3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x68);
    CheckRegisterByte(RegisterType::B, 0x74);
    CheckRegisterByte(RegisterType::C, 0x90);
    CheckRegisterByte(RegisterType::D, 0x87);
    CheckRegisterByte(RegisterType::E, 0xA4);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x7D);
    CheckRegisterByte(RegisterType::L, 0x2A);
    CheckRegisterWord(RegisterType::PC, 0xBDB5);
    CheckRegisterWord(RegisterType::SP, 0x489C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBDB3, 0xE0);
    CheckMemory(0xBDB4, 0xE8);
    CheckMemory(0xFFE8, 0x68);
}

void test_E0_0053()
{
    if (skip_test_E0_0053)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE2E1);
    WriteRegisterWord(RegisterType::SP, 0x47A2);
    WriteRegisterByte(RegisterType::A, 0xFA);
    WriteRegisterByte(RegisterType::B, 0x6E);
    WriteRegisterByte(RegisterType::C, 0x03);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0x46);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x64);
    WriteRegisterByte(RegisterType::L, 0x9B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCA, 0x00);
    WriteMemory(0xE2E2, 0xCA);
    WriteMemory(0xE2E1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFA);
    CheckRegisterByte(RegisterType::B, 0x6E);
    CheckRegisterByte(RegisterType::C, 0x03);
    CheckRegisterByte(RegisterType::D, 0xAB);
    CheckRegisterByte(RegisterType::E, 0x46);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x64);
    CheckRegisterByte(RegisterType::L, 0x9B);
    CheckRegisterWord(RegisterType::PC, 0xE2E3);
    CheckRegisterWord(RegisterType::SP, 0x47A2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE2E1, 0xE0);
    CheckMemory(0xE2E2, 0xCA);
    CheckMemory(0xFFCA, 0xFA);
}

void test_E0_0054()
{
    if (skip_test_E0_0054)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA707);
    WriteRegisterWord(RegisterType::SP, 0x4C0B);
    WriteRegisterByte(RegisterType::A, 0xEC);
    WriteRegisterByte(RegisterType::B, 0x2B);
    WriteRegisterByte(RegisterType::C, 0xEA);
    WriteRegisterByte(RegisterType::D, 0x79);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x45);
    WriteRegisterByte(RegisterType::L, 0x4A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAF, 0x00);
    WriteMemory(0xA708, 0xAF);
    WriteMemory(0xA707, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEC);
    CheckRegisterByte(RegisterType::B, 0x2B);
    CheckRegisterByte(RegisterType::C, 0xEA);
    CheckRegisterByte(RegisterType::D, 0x79);
    CheckRegisterByte(RegisterType::E, 0x86);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x45);
    CheckRegisterByte(RegisterType::L, 0x4A);
    CheckRegisterWord(RegisterType::PC, 0xA709);
    CheckRegisterWord(RegisterType::SP, 0x4C0B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA707, 0xE0);
    CheckMemory(0xA708, 0xAF);
    CheckMemory(0xFFAF, 0xEC);
}

void test_E0_0055()
{
    if (skip_test_E0_0055)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4C94);
    WriteRegisterWord(RegisterType::SP, 0xD36A);
    WriteRegisterByte(RegisterType::A, 0x60);
    WriteRegisterByte(RegisterType::B, 0x7E);
    WriteRegisterByte(RegisterType::C, 0x1B);
    WriteRegisterByte(RegisterType::D, 0x98);
    WriteRegisterByte(RegisterType::E, 0x97);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xA1);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE1, 0x00);
    WriteMemory(0x4C95, 0xE1);
    WriteMemory(0x4C94, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x60);
    CheckRegisterByte(RegisterType::B, 0x7E);
    CheckRegisterByte(RegisterType::C, 0x1B);
    CheckRegisterByte(RegisterType::D, 0x98);
    CheckRegisterByte(RegisterType::E, 0x97);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xA1);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0x4C96);
    CheckRegisterWord(RegisterType::SP, 0xD36A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4C94, 0xE0);
    CheckMemory(0x4C95, 0xE1);
    CheckMemory(0xFFE1, 0x60);
}

void test_E0_0056()
{
    if (skip_test_E0_0056)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x22DB);
    WriteRegisterWord(RegisterType::SP, 0xB36F);
    WriteRegisterByte(RegisterType::A, 0xFA);
    WriteRegisterByte(RegisterType::B, 0xCC);
    WriteRegisterByte(RegisterType::C, 0xFD);
    WriteRegisterByte(RegisterType::D, 0x2F);
    WriteRegisterByte(RegisterType::E, 0xD0);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xA1);
    WriteRegisterByte(RegisterType::L, 0x3D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF2A, 0x00);
    WriteMemory(0x22DC, 0x2A);
    WriteMemory(0x22DB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFA);
    CheckRegisterByte(RegisterType::B, 0xCC);
    CheckRegisterByte(RegisterType::C, 0xFD);
    CheckRegisterByte(RegisterType::D, 0x2F);
    CheckRegisterByte(RegisterType::E, 0xD0);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xA1);
    CheckRegisterByte(RegisterType::L, 0x3D);
    CheckRegisterWord(RegisterType::PC, 0x22DD);
    CheckRegisterWord(RegisterType::SP, 0xB36F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x22DB, 0xE0);
    CheckMemory(0x22DC, 0x2A);
    CheckMemory(0xFF2A, 0xFA);
}

void test_E0_0057()
{
    if (skip_test_E0_0057)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD9ED);
    WriteRegisterWord(RegisterType::SP, 0xCBA9);
    WriteRegisterByte(RegisterType::A, 0xA6);
    WriteRegisterByte(RegisterType::B, 0x21);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0x30);
    WriteRegisterByte(RegisterType::E, 0xD0);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x63);
    WriteRegisterByte(RegisterType::L, 0x04);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF04, 0x00);
    WriteMemory(0xD9EE, 0x04);
    WriteMemory(0xD9ED, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA6);
    CheckRegisterByte(RegisterType::B, 0x21);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0x30);
    CheckRegisterByte(RegisterType::E, 0xD0);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x63);
    CheckRegisterByte(RegisterType::L, 0x04);
    CheckRegisterWord(RegisterType::PC, 0xD9EF);
    CheckRegisterWord(RegisterType::SP, 0xCBA9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD9ED, 0xE0);
    CheckMemory(0xD9EE, 0x04);
    CheckMemory(0xFF04, 0xA6);
}

void test_E0_0058()
{
    if (skip_test_E0_0058)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC44E);
    WriteRegisterWord(RegisterType::SP, 0xE5FD);
    WriteRegisterByte(RegisterType::A, 0x4A);
    WriteRegisterByte(RegisterType::B, 0xE8);
    WriteRegisterByte(RegisterType::C, 0x11);
    WriteRegisterByte(RegisterType::D, 0xD1);
    WriteRegisterByte(RegisterType::E, 0xA2);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x71);
    WriteRegisterByte(RegisterType::L, 0x8F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFED, 0x00);
    WriteMemory(0xC44F, 0xED);
    WriteMemory(0xC44E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4A);
    CheckRegisterByte(RegisterType::B, 0xE8);
    CheckRegisterByte(RegisterType::C, 0x11);
    CheckRegisterByte(RegisterType::D, 0xD1);
    CheckRegisterByte(RegisterType::E, 0xA2);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x71);
    CheckRegisterByte(RegisterType::L, 0x8F);
    CheckRegisterWord(RegisterType::PC, 0xC450);
    CheckRegisterWord(RegisterType::SP, 0xE5FD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC44E, 0xE0);
    CheckMemory(0xC44F, 0xED);
    CheckMemory(0xFFED, 0x4A);
}

void test_E0_0059()
{
    if (skip_test_E0_0059)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6A63);
    WriteRegisterWord(RegisterType::SP, 0x387A);
    WriteRegisterByte(RegisterType::A, 0x6C);
    WriteRegisterByte(RegisterType::B, 0xFF);
    WriteRegisterByte(RegisterType::C, 0x84);
    WriteRegisterByte(RegisterType::D, 0x47);
    WriteRegisterByte(RegisterType::E, 0xF6);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x6B);
    WriteRegisterByte(RegisterType::L, 0x31);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5F, 0x00);
    WriteMemory(0x6A64, 0x5F);
    WriteMemory(0x6A63, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6C);
    CheckRegisterByte(RegisterType::B, 0xFF);
    CheckRegisterByte(RegisterType::C, 0x84);
    CheckRegisterByte(RegisterType::D, 0x47);
    CheckRegisterByte(RegisterType::E, 0xF6);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x6B);
    CheckRegisterByte(RegisterType::L, 0x31);
    CheckRegisterWord(RegisterType::PC, 0x6A65);
    CheckRegisterWord(RegisterType::SP, 0x387A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6A63, 0xE0);
    CheckMemory(0x6A64, 0x5F);
    CheckMemory(0xFF5F, 0x6C);
}

void test_E0_005A()
{
    if (skip_test_E0_005A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC1B1);
    WriteRegisterWord(RegisterType::SP, 0xBDAF);
    WriteRegisterByte(RegisterType::A, 0xEC);
    WriteRegisterByte(RegisterType::B, 0x3A);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0x29);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x9A);
    WriteRegisterByte(RegisterType::L, 0x93);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA6, 0x00);
    WriteMemory(0xC1B2, 0xA6);
    WriteMemory(0xC1B1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEC);
    CheckRegisterByte(RegisterType::B, 0x3A);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0xCE);
    CheckRegisterByte(RegisterType::E, 0x29);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x9A);
    CheckRegisterByte(RegisterType::L, 0x93);
    CheckRegisterWord(RegisterType::PC, 0xC1B3);
    CheckRegisterWord(RegisterType::SP, 0xBDAF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC1B1, 0xE0);
    CheckMemory(0xC1B2, 0xA6);
    CheckMemory(0xFFA6, 0xEC);
}

void test_E0_005B()
{
    if (skip_test_E0_005B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9F96);
    WriteRegisterWord(RegisterType::SP, 0x39A2);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0x7A);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0xB2);
    WriteRegisterByte(RegisterType::E, 0xBC);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0x8F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF15, 0x00);
    WriteMemory(0x9F97, 0x15);
    WriteMemory(0x9F96, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0x7A);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0xB2);
    CheckRegisterByte(RegisterType::E, 0xBC);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0x8F);
    CheckRegisterWord(RegisterType::PC, 0x9F98);
    CheckRegisterWord(RegisterType::SP, 0x39A2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9F96, 0xE0);
    CheckMemory(0x9F97, 0x15);
    CheckMemory(0xFF15, 0xA1);
}

void test_E0_005C()
{
    if (skip_test_E0_005C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB5F4);
    WriteRegisterWord(RegisterType::SP, 0x3F21);
    WriteRegisterByte(RegisterType::A, 0xA4);
    WriteRegisterByte(RegisterType::B, 0xF0);
    WriteRegisterByte(RegisterType::C, 0xCA);
    WriteRegisterByte(RegisterType::D, 0x8B);
    WriteRegisterByte(RegisterType::E, 0xF1);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0x01);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF61, 0x00);
    WriteMemory(0xB5F5, 0x61);
    WriteMemory(0xB5F4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA4);
    CheckRegisterByte(RegisterType::B, 0xF0);
    CheckRegisterByte(RegisterType::C, 0xCA);
    CheckRegisterByte(RegisterType::D, 0x8B);
    CheckRegisterByte(RegisterType::E, 0xF1);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0x01);
    CheckRegisterWord(RegisterType::PC, 0xB5F6);
    CheckRegisterWord(RegisterType::SP, 0x3F21);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB5F4, 0xE0);
    CheckMemory(0xB5F5, 0x61);
    CheckMemory(0xFF61, 0xA4);
}

void test_E0_005D()
{
    if (skip_test_E0_005D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE764);
    WriteRegisterWord(RegisterType::SP, 0xFDFB);
    WriteRegisterByte(RegisterType::A, 0xAE);
    WriteRegisterByte(RegisterType::B, 0x48);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0xCD);
    WriteRegisterByte(RegisterType::E, 0xA8);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x62);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8B, 0x00);
    WriteMemory(0xE765, 0x8B);
    WriteMemory(0xE764, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAE);
    CheckRegisterByte(RegisterType::B, 0x48);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0xCD);
    CheckRegisterByte(RegisterType::E, 0xA8);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x62);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0xE766);
    CheckRegisterWord(RegisterType::SP, 0xFDFB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE764, 0xE0);
    CheckMemory(0xE765, 0x8B);
    CheckMemory(0xFF8B, 0xAE);
}

void test_E0_005E()
{
    if (skip_test_E0_005E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9C33);
    WriteRegisterWord(RegisterType::SP, 0xDA13);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0xEF);
    WriteRegisterByte(RegisterType::C, 0x96);
    WriteRegisterByte(RegisterType::D, 0x92);
    WriteRegisterByte(RegisterType::E, 0x06);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xB7);
    WriteRegisterByte(RegisterType::L, 0x07);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA2, 0x00);
    WriteMemory(0x9C34, 0xA2);
    WriteMemory(0x9C33, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0xEF);
    CheckRegisterByte(RegisterType::C, 0x96);
    CheckRegisterByte(RegisterType::D, 0x92);
    CheckRegisterByte(RegisterType::E, 0x06);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xB7);
    CheckRegisterByte(RegisterType::L, 0x07);
    CheckRegisterWord(RegisterType::PC, 0x9C35);
    CheckRegisterWord(RegisterType::SP, 0xDA13);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9C33, 0xE0);
    CheckMemory(0x9C34, 0xA2);
    CheckMemory(0xFFA2, 0x92);
}

void test_E0_005F()
{
    if (skip_test_E0_005F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA632);
    WriteRegisterWord(RegisterType::SP, 0xF8CE);
    WriteRegisterByte(RegisterType::A, 0x89);
    WriteRegisterByte(RegisterType::B, 0x2E);
    WriteRegisterByte(RegisterType::C, 0x15);
    WriteRegisterByte(RegisterType::D, 0x71);
    WriteRegisterByte(RegisterType::E, 0x58);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x36);
    WriteRegisterByte(RegisterType::L, 0xAF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB1, 0x00);
    WriteMemory(0xA633, 0xB1);
    WriteMemory(0xA632, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x89);
    CheckRegisterByte(RegisterType::B, 0x2E);
    CheckRegisterByte(RegisterType::C, 0x15);
    CheckRegisterByte(RegisterType::D, 0x71);
    CheckRegisterByte(RegisterType::E, 0x58);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x36);
    CheckRegisterByte(RegisterType::L, 0xAF);
    CheckRegisterWord(RegisterType::PC, 0xA634);
    CheckRegisterWord(RegisterType::SP, 0xF8CE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA632, 0xE0);
    CheckMemory(0xA633, 0xB1);
    CheckMemory(0xFFB1, 0x89);
}

void test_E0_0060()
{
    if (skip_test_E0_0060)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4829);
    WriteRegisterWord(RegisterType::SP, 0xEEF2);
    WriteRegisterByte(RegisterType::A, 0x1B);
    WriteRegisterByte(RegisterType::B, 0x1C);
    WriteRegisterByte(RegisterType::C, 0x8C);
    WriteRegisterByte(RegisterType::D, 0x59);
    WriteRegisterByte(RegisterType::E, 0x49);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x8B);
    WriteRegisterByte(RegisterType::L, 0x02);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF51, 0x00);
    WriteMemory(0x482A, 0x51);
    WriteMemory(0x4829, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1B);
    CheckRegisterByte(RegisterType::B, 0x1C);
    CheckRegisterByte(RegisterType::C, 0x8C);
    CheckRegisterByte(RegisterType::D, 0x59);
    CheckRegisterByte(RegisterType::E, 0x49);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x8B);
    CheckRegisterByte(RegisterType::L, 0x02);
    CheckRegisterWord(RegisterType::PC, 0x482B);
    CheckRegisterWord(RegisterType::SP, 0xEEF2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4829, 0xE0);
    CheckMemory(0x482A, 0x51);
    CheckMemory(0xFF51, 0x1B);
}

void test_E0_0061()
{
    if (skip_test_E0_0061)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFF81);
    WriteRegisterWord(RegisterType::SP, 0xD714);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0x85);
    WriteRegisterByte(RegisterType::C, 0xDD);
    WriteRegisterByte(RegisterType::D, 0x78);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x04);
    WriteRegisterByte(RegisterType::L, 0x84);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF82, 0x5E);
    WriteMemory(0xFF81, 0xE0);
    WriteMemory(0xFF5E, 0x00);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0x85);
    CheckRegisterByte(RegisterType::C, 0xDD);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0x0F);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x04);
    CheckRegisterByte(RegisterType::L, 0x84);
    CheckRegisterWord(RegisterType::PC, 0xFF83);
    CheckRegisterWord(RegisterType::SP, 0xD714);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFF5E, 0x9B);
    CheckMemory(0xFF81, 0xE0);
    CheckMemory(0xFF82, 0x5E);
}

void test_E0_0062()
{
    if (skip_test_E0_0062)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0AD5);
    WriteRegisterWord(RegisterType::SP, 0x17BF);
    WriteRegisterByte(RegisterType::A, 0xAE);
    WriteRegisterByte(RegisterType::B, 0x85);
    WriteRegisterByte(RegisterType::C, 0x31);
    WriteRegisterByte(RegisterType::D, 0x96);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x9E);
    WriteRegisterByte(RegisterType::L, 0xA1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF7A, 0x00);
    WriteMemory(0x0AD6, 0x7A);
    WriteMemory(0x0AD5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAE);
    CheckRegisterByte(RegisterType::B, 0x85);
    CheckRegisterByte(RegisterType::C, 0x31);
    CheckRegisterByte(RegisterType::D, 0x96);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x9E);
    CheckRegisterByte(RegisterType::L, 0xA1);
    CheckRegisterWord(RegisterType::PC, 0x0AD7);
    CheckRegisterWord(RegisterType::SP, 0x17BF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0AD5, 0xE0);
    CheckMemory(0x0AD6, 0x7A);
    CheckMemory(0xFF7A, 0xAE);
}

void test_E0_0063()
{
    if (skip_test_E0_0063)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x64C8);
    WriteRegisterWord(RegisterType::SP, 0x4DF3);
    WriteRegisterByte(RegisterType::A, 0x6D);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0x5C);
    WriteRegisterByte(RegisterType::D, 0xE0);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC3);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAD, 0x00);
    WriteMemory(0x64C9, 0xAD);
    WriteMemory(0x64C8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6D);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0x5C);
    CheckRegisterByte(RegisterType::D, 0xE0);
    CheckRegisterByte(RegisterType::E, 0x74);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC3);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0x64CA);
    CheckRegisterWord(RegisterType::SP, 0x4DF3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x64C8, 0xE0);
    CheckMemory(0x64C9, 0xAD);
    CheckMemory(0xFFAD, 0x6D);
}

void test_E0_0064()
{
    if (skip_test_E0_0064)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x82CB);
    WriteRegisterWord(RegisterType::SP, 0xAE65);
    WriteRegisterByte(RegisterType::A, 0xB0);
    WriteRegisterByte(RegisterType::B, 0x96);
    WriteRegisterByte(RegisterType::C, 0x54);
    WriteRegisterByte(RegisterType::D, 0x21);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x60);
    WriteRegisterByte(RegisterType::L, 0x61);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF77, 0x00);
    WriteMemory(0x82CC, 0x77);
    WriteMemory(0x82CB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB0);
    CheckRegisterByte(RegisterType::B, 0x96);
    CheckRegisterByte(RegisterType::C, 0x54);
    CheckRegisterByte(RegisterType::D, 0x21);
    CheckRegisterByte(RegisterType::E, 0xDC);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x60);
    CheckRegisterByte(RegisterType::L, 0x61);
    CheckRegisterWord(RegisterType::PC, 0x82CD);
    CheckRegisterWord(RegisterType::SP, 0xAE65);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x82CB, 0xE0);
    CheckMemory(0x82CC, 0x77);
    CheckMemory(0xFF77, 0xB0);
}

void test_E0_0065()
{
    if (skip_test_E0_0065)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC728);
    WriteRegisterWord(RegisterType::SP, 0x9564);
    WriteRegisterByte(RegisterType::A, 0x62);
    WriteRegisterByte(RegisterType::B, 0x30);
    WriteRegisterByte(RegisterType::C, 0xF1);
    WriteRegisterByte(RegisterType::D, 0x7F);
    WriteRegisterByte(RegisterType::E, 0xF2);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x86);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFBB, 0x00);
    WriteMemory(0xC729, 0xBB);
    WriteMemory(0xC728, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x62);
    CheckRegisterByte(RegisterType::B, 0x30);
    CheckRegisterByte(RegisterType::C, 0xF1);
    CheckRegisterByte(RegisterType::D, 0x7F);
    CheckRegisterByte(RegisterType::E, 0xF2);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x86);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0xC72A);
    CheckRegisterWord(RegisterType::SP, 0x9564);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC728, 0xE0);
    CheckMemory(0xC729, 0xBB);
    CheckMemory(0xFFBB, 0x62);
}

void test_E0_0066()
{
    if (skip_test_E0_0066)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x295F);
    WriteRegisterWord(RegisterType::SP, 0x1E58);
    WriteRegisterByte(RegisterType::A, 0x49);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0x8A);
    WriteRegisterByte(RegisterType::D, 0xF9);
    WriteRegisterByte(RegisterType::E, 0xB6);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x92);
    WriteRegisterByte(RegisterType::L, 0x0A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFE, 0x00);
    WriteMemory(0x2960, 0xFE);
    WriteMemory(0x295F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x49);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0x8A);
    CheckRegisterByte(RegisterType::D, 0xF9);
    CheckRegisterByte(RegisterType::E, 0xB6);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x92);
    CheckRegisterByte(RegisterType::L, 0x0A);
    CheckRegisterWord(RegisterType::PC, 0x2961);
    CheckRegisterWord(RegisterType::SP, 0x1E58);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x295F, 0xE0);
    CheckMemory(0x2960, 0xFE);
    CheckMemory(0xFFFE, 0x49);
}

void test_E0_0067()
{
    if (skip_test_E0_0067)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8180);
    WriteRegisterWord(RegisterType::SP, 0x385D);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0xE8);
    WriteRegisterByte(RegisterType::C, 0xDC);
    WriteRegisterByte(RegisterType::D, 0x7C);
    WriteRegisterByte(RegisterType::E, 0x45);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x24);
    WriteRegisterByte(RegisterType::L, 0xE3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF51, 0x00);
    WriteMemory(0x8181, 0x51);
    WriteMemory(0x8180, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0xE8);
    CheckRegisterByte(RegisterType::C, 0xDC);
    CheckRegisterByte(RegisterType::D, 0x7C);
    CheckRegisterByte(RegisterType::E, 0x45);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x24);
    CheckRegisterByte(RegisterType::L, 0xE3);
    CheckRegisterWord(RegisterType::PC, 0x8182);
    CheckRegisterWord(RegisterType::SP, 0x385D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8180, 0xE0);
    CheckMemory(0x8181, 0x51);
    CheckMemory(0xFF51, 0x44);
}

void test_E0_0068()
{
    if (skip_test_E0_0068)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE0B6);
    WriteRegisterWord(RegisterType::SP, 0x2C21);
    WriteRegisterByte(RegisterType::A, 0xA3);
    WriteRegisterByte(RegisterType::B, 0x93);
    WriteRegisterByte(RegisterType::C, 0x22);
    WriteRegisterByte(RegisterType::D, 0x18);
    WriteRegisterByte(RegisterType::E, 0x31);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xDE);
    WriteRegisterByte(RegisterType::L, 0x28);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF2F, 0x00);
    WriteMemory(0xE0B7, 0x2F);
    WriteMemory(0xE0B6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA3);
    CheckRegisterByte(RegisterType::B, 0x93);
    CheckRegisterByte(RegisterType::C, 0x22);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0x31);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xDE);
    CheckRegisterByte(RegisterType::L, 0x28);
    CheckRegisterWord(RegisterType::PC, 0xE0B8);
    CheckRegisterWord(RegisterType::SP, 0x2C21);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE0B6, 0xE0);
    CheckMemory(0xE0B7, 0x2F);
    CheckMemory(0xFF2F, 0xA3);
}

void test_E0_0069()
{
    if (skip_test_E0_0069)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF27F);
    WriteRegisterWord(RegisterType::SP, 0x1EE0);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x6E);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0xF1);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x61);
    WriteRegisterByte(RegisterType::L, 0x5A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF66, 0x00);
    WriteMemory(0xF280, 0x66);
    WriteMemory(0xF27F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x6E);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0xF1);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x61);
    CheckRegisterByte(RegisterType::L, 0x5A);
    CheckRegisterWord(RegisterType::PC, 0xF281);
    CheckRegisterWord(RegisterType::SP, 0x1EE0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF27F, 0xE0);
    CheckMemory(0xF280, 0x66);
    CheckMemory(0xFF66, 0xC2);
}

void test_E0_006A()
{
    if (skip_test_E0_006A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC5EC);
    WriteRegisterWord(RegisterType::SP, 0xA1E7);
    WriteRegisterByte(RegisterType::A, 0x16);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0x00);
    WriteRegisterByte(RegisterType::D, 0xD6);
    WriteRegisterByte(RegisterType::E, 0x79);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x4E);
    WriteRegisterByte(RegisterType::L, 0x79);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF04, 0x00);
    WriteMemory(0xC5ED, 0x04);
    WriteMemory(0xC5EC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x16);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0x00);
    CheckRegisterByte(RegisterType::D, 0xD6);
    CheckRegisterByte(RegisterType::E, 0x79);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x4E);
    CheckRegisterByte(RegisterType::L, 0x79);
    CheckRegisterWord(RegisterType::PC, 0xC5EE);
    CheckRegisterWord(RegisterType::SP, 0xA1E7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC5EC, 0xE0);
    CheckMemory(0xC5ED, 0x04);
    CheckMemory(0xFF04, 0x16);
}

void test_E0_006B()
{
    if (skip_test_E0_006B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD17A);
    WriteRegisterWord(RegisterType::SP, 0x4EA1);
    WriteRegisterByte(RegisterType::A, 0x68);
    WriteRegisterByte(RegisterType::B, 0x9F);
    WriteRegisterByte(RegisterType::C, 0x1D);
    WriteRegisterByte(RegisterType::D, 0x68);
    WriteRegisterByte(RegisterType::E, 0x1B);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x38);
    WriteRegisterByte(RegisterType::L, 0x1A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF75, 0x00);
    WriteMemory(0xD17B, 0x75);
    WriteMemory(0xD17A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x68);
    CheckRegisterByte(RegisterType::B, 0x9F);
    CheckRegisterByte(RegisterType::C, 0x1D);
    CheckRegisterByte(RegisterType::D, 0x68);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x38);
    CheckRegisterByte(RegisterType::L, 0x1A);
    CheckRegisterWord(RegisterType::PC, 0xD17C);
    CheckRegisterWord(RegisterType::SP, 0x4EA1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD17A, 0xE0);
    CheckMemory(0xD17B, 0x75);
    CheckMemory(0xFF75, 0x68);
}

void test_E0_006C()
{
    if (skip_test_E0_006C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA9E1);
    WriteRegisterWord(RegisterType::SP, 0x5B2A);
    WriteRegisterByte(RegisterType::A, 0xF5);
    WriteRegisterByte(RegisterType::B, 0x9B);
    WriteRegisterByte(RegisterType::C, 0xB3);
    WriteRegisterByte(RegisterType::D, 0xF2);
    WriteRegisterByte(RegisterType::E, 0xE4);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x7B);
    WriteRegisterByte(RegisterType::L, 0xBE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF18, 0x00);
    WriteMemory(0xA9E2, 0x18);
    WriteMemory(0xA9E1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF5);
    CheckRegisterByte(RegisterType::B, 0x9B);
    CheckRegisterByte(RegisterType::C, 0xB3);
    CheckRegisterByte(RegisterType::D, 0xF2);
    CheckRegisterByte(RegisterType::E, 0xE4);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x7B);
    CheckRegisterByte(RegisterType::L, 0xBE);
    CheckRegisterWord(RegisterType::PC, 0xA9E3);
    CheckRegisterWord(RegisterType::SP, 0x5B2A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA9E1, 0xE0);
    CheckMemory(0xA9E2, 0x18);
    CheckMemory(0xFF18, 0xF5);
}

void test_E0_006D()
{
    if (skip_test_E0_006D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x00F1);
    WriteRegisterWord(RegisterType::SP, 0x263A);
    WriteRegisterByte(RegisterType::A, 0x89);
    WriteRegisterByte(RegisterType::B, 0xAF);
    WriteRegisterByte(RegisterType::C, 0x73);
    WriteRegisterByte(RegisterType::D, 0x08);
    WriteRegisterByte(RegisterType::E, 0xA3);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xF2);
    WriteRegisterByte(RegisterType::L, 0xAF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD4, 0x00);
    WriteMemory(0x00F2, 0xD4);
    WriteMemory(0x00F1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x89);
    CheckRegisterByte(RegisterType::B, 0xAF);
    CheckRegisterByte(RegisterType::C, 0x73);
    CheckRegisterByte(RegisterType::D, 0x08);
    CheckRegisterByte(RegisterType::E, 0xA3);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xF2);
    CheckRegisterByte(RegisterType::L, 0xAF);
    CheckRegisterWord(RegisterType::PC, 0x00F3);
    CheckRegisterWord(RegisterType::SP, 0x263A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x00F1, 0xE0);
    CheckMemory(0x00F2, 0xD4);
    CheckMemory(0xFFD4, 0x89);
}

void test_E0_006E()
{
    if (skip_test_E0_006E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x22B6);
    WriteRegisterWord(RegisterType::SP, 0x11DD);
    WriteRegisterByte(RegisterType::A, 0x25);
    WriteRegisterByte(RegisterType::B, 0x12);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0xB0);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x86);
    WriteRegisterByte(RegisterType::L, 0x52);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF31, 0x00);
    WriteMemory(0x22B7, 0x31);
    WriteMemory(0x22B6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x25);
    CheckRegisterByte(RegisterType::B, 0x12);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0xB0);
    CheckRegisterByte(RegisterType::E, 0xC7);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x86);
    CheckRegisterByte(RegisterType::L, 0x52);
    CheckRegisterWord(RegisterType::PC, 0x22B8);
    CheckRegisterWord(RegisterType::SP, 0x11DD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x22B6, 0xE0);
    CheckMemory(0x22B7, 0x31);
    CheckMemory(0xFF31, 0x25);
}

void test_E0_006F()
{
    if (skip_test_E0_006F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDB85);
    WriteRegisterWord(RegisterType::SP, 0xC016);
    WriteRegisterByte(RegisterType::A, 0x7D);
    WriteRegisterByte(RegisterType::B, 0xC2);
    WriteRegisterByte(RegisterType::C, 0x3A);
    WriteRegisterByte(RegisterType::D, 0x55);
    WriteRegisterByte(RegisterType::E, 0xBE);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x13);
    WriteRegisterByte(RegisterType::L, 0xC3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF1A, 0x00);
    WriteMemory(0xDB86, 0x1A);
    WriteMemory(0xDB85, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7D);
    CheckRegisterByte(RegisterType::B, 0xC2);
    CheckRegisterByte(RegisterType::C, 0x3A);
    CheckRegisterByte(RegisterType::D, 0x55);
    CheckRegisterByte(RegisterType::E, 0xBE);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x13);
    CheckRegisterByte(RegisterType::L, 0xC3);
    CheckRegisterWord(RegisterType::PC, 0xDB87);
    CheckRegisterWord(RegisterType::SP, 0xC016);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDB85, 0xE0);
    CheckMemory(0xDB86, 0x1A);
    CheckMemory(0xFF1A, 0x7D);
}

void test_E0_0070()
{
    if (skip_test_E0_0070)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x378D);
    WriteRegisterWord(RegisterType::SP, 0xC6F6);
    WriteRegisterByte(RegisterType::A, 0x68);
    WriteRegisterByte(RegisterType::B, 0x51);
    WriteRegisterByte(RegisterType::C, 0xC1);
    WriteRegisterByte(RegisterType::D, 0x7A);
    WriteRegisterByte(RegisterType::E, 0xC2);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x01);
    WriteRegisterByte(RegisterType::L, 0x75);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF87, 0x00);
    WriteMemory(0x378E, 0x87);
    WriteMemory(0x378D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x68);
    CheckRegisterByte(RegisterType::B, 0x51);
    CheckRegisterByte(RegisterType::C, 0xC1);
    CheckRegisterByte(RegisterType::D, 0x7A);
    CheckRegisterByte(RegisterType::E, 0xC2);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x01);
    CheckRegisterByte(RegisterType::L, 0x75);
    CheckRegisterWord(RegisterType::PC, 0x378F);
    CheckRegisterWord(RegisterType::SP, 0xC6F6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x378D, 0xE0);
    CheckMemory(0x378E, 0x87);
    CheckMemory(0xFF87, 0x68);
}

void test_E0_0071()
{
    if (skip_test_E0_0071)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCE18);
    WriteRegisterWord(RegisterType::SP, 0xED41);
    WriteRegisterByte(RegisterType::A, 0x8E);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x24);
    WriteRegisterByte(RegisterType::D, 0x11);
    WriteRegisterByte(RegisterType::E, 0x0C);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xF4);
    WriteRegisterByte(RegisterType::L, 0xEF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC6, 0x00);
    WriteMemory(0xCE19, 0xC6);
    WriteMemory(0xCE18, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8E);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x24);
    CheckRegisterByte(RegisterType::D, 0x11);
    CheckRegisterByte(RegisterType::E, 0x0C);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xF4);
    CheckRegisterByte(RegisterType::L, 0xEF);
    CheckRegisterWord(RegisterType::PC, 0xCE1A);
    CheckRegisterWord(RegisterType::SP, 0xED41);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCE18, 0xE0);
    CheckMemory(0xCE19, 0xC6);
    CheckMemory(0xFFC6, 0x8E);
}

void test_E0_0072()
{
    if (skip_test_E0_0072)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9BD3);
    WriteRegisterWord(RegisterType::SP, 0xFE5A);
    WriteRegisterByte(RegisterType::A, 0xDC);
    WriteRegisterByte(RegisterType::B, 0xA3);
    WriteRegisterByte(RegisterType::C, 0x86);
    WriteRegisterByte(RegisterType::D, 0x0D);
    WriteRegisterByte(RegisterType::E, 0x6C);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xB9);
    WriteRegisterByte(RegisterType::L, 0x45);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF74, 0x00);
    WriteMemory(0x9BD4, 0x74);
    WriteMemory(0x9BD3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDC);
    CheckRegisterByte(RegisterType::B, 0xA3);
    CheckRegisterByte(RegisterType::C, 0x86);
    CheckRegisterByte(RegisterType::D, 0x0D);
    CheckRegisterByte(RegisterType::E, 0x6C);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xB9);
    CheckRegisterByte(RegisterType::L, 0x45);
    CheckRegisterWord(RegisterType::PC, 0x9BD5);
    CheckRegisterWord(RegisterType::SP, 0xFE5A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9BD3, 0xE0);
    CheckMemory(0x9BD4, 0x74);
    CheckMemory(0xFF74, 0xDC);
}

void test_E0_0073()
{
    if (skip_test_E0_0073)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD0A4);
    WriteRegisterWord(RegisterType::SP, 0xB61D);
    WriteRegisterByte(RegisterType::A, 0x55);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0x64);
    WriteRegisterByte(RegisterType::D, 0x26);
    WriteRegisterByte(RegisterType::E, 0xB3);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x57);
    WriteRegisterByte(RegisterType::L, 0x15);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4E, 0x00);
    WriteMemory(0xD0A5, 0x4E);
    WriteMemory(0xD0A4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x55);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0x64);
    CheckRegisterByte(RegisterType::D, 0x26);
    CheckRegisterByte(RegisterType::E, 0xB3);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x57);
    CheckRegisterByte(RegisterType::L, 0x15);
    CheckRegisterWord(RegisterType::PC, 0xD0A6);
    CheckRegisterWord(RegisterType::SP, 0xB61D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD0A4, 0xE0);
    CheckMemory(0xD0A5, 0x4E);
    CheckMemory(0xFF4E, 0x55);
}

void test_E0_0074()
{
    if (skip_test_E0_0074)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC620);
    WriteRegisterWord(RegisterType::SP, 0xC42F);
    WriteRegisterByte(RegisterType::A, 0x0E);
    WriteRegisterByte(RegisterType::B, 0xC7);
    WriteRegisterByte(RegisterType::C, 0xEE);
    WriteRegisterByte(RegisterType::D, 0xA1);
    WriteRegisterByte(RegisterType::E, 0xDE);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x8A);
    WriteRegisterByte(RegisterType::L, 0x93);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF65, 0x00);
    WriteMemory(0xC621, 0x65);
    WriteMemory(0xC620, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0E);
    CheckRegisterByte(RegisterType::B, 0xC7);
    CheckRegisterByte(RegisterType::C, 0xEE);
    CheckRegisterByte(RegisterType::D, 0xA1);
    CheckRegisterByte(RegisterType::E, 0xDE);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x8A);
    CheckRegisterByte(RegisterType::L, 0x93);
    CheckRegisterWord(RegisterType::PC, 0xC622);
    CheckRegisterWord(RegisterType::SP, 0xC42F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC620, 0xE0);
    CheckMemory(0xC621, 0x65);
    CheckMemory(0xFF65, 0x0E);
}

void test_E0_0075()
{
    if (skip_test_E0_0075)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x284B);
    WriteRegisterWord(RegisterType::SP, 0x768F);
    WriteRegisterByte(RegisterType::A, 0x45);
    WriteRegisterByte(RegisterType::B, 0xD3);
    WriteRegisterByte(RegisterType::C, 0x0E);
    WriteRegisterByte(RegisterType::D, 0x96);
    WriteRegisterByte(RegisterType::E, 0x2F);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xDF);
    WriteRegisterByte(RegisterType::L, 0x16);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF08, 0x00);
    WriteMemory(0x284C, 0x08);
    WriteMemory(0x284B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x45);
    CheckRegisterByte(RegisterType::B, 0xD3);
    CheckRegisterByte(RegisterType::C, 0x0E);
    CheckRegisterByte(RegisterType::D, 0x96);
    CheckRegisterByte(RegisterType::E, 0x2F);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xDF);
    CheckRegisterByte(RegisterType::L, 0x16);
    CheckRegisterWord(RegisterType::PC, 0x284D);
    CheckRegisterWord(RegisterType::SP, 0x768F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x284B, 0xE0);
    CheckMemory(0x284C, 0x08);
    CheckMemory(0xFF08, 0x45);
}

void test_E0_0076()
{
    if (skip_test_E0_0076)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB2E4);
    WriteRegisterWord(RegisterType::SP, 0x0CDF);
    WriteRegisterByte(RegisterType::A, 0xFD);
    WriteRegisterByte(RegisterType::B, 0x92);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0xCF);
    WriteRegisterByte(RegisterType::E, 0x3D);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x49);
    WriteRegisterByte(RegisterType::L, 0x8A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF1, 0x00);
    WriteMemory(0xB2E5, 0xF1);
    WriteMemory(0xB2E4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFD);
    CheckRegisterByte(RegisterType::B, 0x92);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0xCF);
    CheckRegisterByte(RegisterType::E, 0x3D);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x49);
    CheckRegisterByte(RegisterType::L, 0x8A);
    CheckRegisterWord(RegisterType::PC, 0xB2E6);
    CheckRegisterWord(RegisterType::SP, 0x0CDF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB2E4, 0xE0);
    CheckMemory(0xB2E5, 0xF1);
    CheckMemory(0xFFF1, 0xFD);
}

void test_E0_0077()
{
    if (skip_test_E0_0077)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x20FA);
    WriteRegisterWord(RegisterType::SP, 0x0919);
    WriteRegisterByte(RegisterType::A, 0xF3);
    WriteRegisterByte(RegisterType::B, 0xDC);
    WriteRegisterByte(RegisterType::C, 0x6E);
    WriteRegisterByte(RegisterType::D, 0xBE);
    WriteRegisterByte(RegisterType::E, 0x46);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x8C);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF07, 0x00);
    WriteMemory(0x20FB, 0x07);
    WriteMemory(0x20FA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF3);
    CheckRegisterByte(RegisterType::B, 0xDC);
    CheckRegisterByte(RegisterType::C, 0x6E);
    CheckRegisterByte(RegisterType::D, 0xBE);
    CheckRegisterByte(RegisterType::E, 0x46);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x8C);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0x20FC);
    CheckRegisterWord(RegisterType::SP, 0x0919);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x20FA, 0xE0);
    CheckMemory(0x20FB, 0x07);
    CheckMemory(0xFF07, 0xF3);
}

void test_E0_0078()
{
    if (skip_test_E0_0078)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC1EC);
    WriteRegisterWord(RegisterType::SP, 0xADA3);
    WriteRegisterByte(RegisterType::A, 0x84);
    WriteRegisterByte(RegisterType::B, 0xF9);
    WriteRegisterByte(RegisterType::C, 0xFB);
    WriteRegisterByte(RegisterType::D, 0x0C);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC5, 0x00);
    WriteMemory(0xC1ED, 0xC5);
    WriteMemory(0xC1EC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x84);
    CheckRegisterByte(RegisterType::B, 0xF9);
    CheckRegisterByte(RegisterType::C, 0xFB);
    CheckRegisterByte(RegisterType::D, 0x0C);
    CheckRegisterByte(RegisterType::E, 0x0F);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0xC1EE);
    CheckRegisterWord(RegisterType::SP, 0xADA3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC1EC, 0xE0);
    CheckMemory(0xC1ED, 0xC5);
    CheckMemory(0xFFC5, 0x84);
}

void test_E0_0079()
{
    if (skip_test_E0_0079)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2DC1);
    WriteRegisterWord(RegisterType::SP, 0x101F);
    WriteRegisterByte(RegisterType::A, 0x75);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x0F);
    WriteRegisterByte(RegisterType::D, 0x6C);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x40);
    WriteRegisterByte(RegisterType::L, 0x3E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3F, 0x00);
    WriteMemory(0x2DC2, 0x3F);
    WriteMemory(0x2DC1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x75);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x0F);
    CheckRegisterByte(RegisterType::D, 0x6C);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x40);
    CheckRegisterByte(RegisterType::L, 0x3E);
    CheckRegisterWord(RegisterType::PC, 0x2DC3);
    CheckRegisterWord(RegisterType::SP, 0x101F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2DC1, 0xE0);
    CheckMemory(0x2DC2, 0x3F);
    CheckMemory(0xFF3F, 0x75);
}

void test_E0_007A()
{
    if (skip_test_E0_007A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0FC6);
    WriteRegisterWord(RegisterType::SP, 0x6B74);
    WriteRegisterByte(RegisterType::A, 0xFC);
    WriteRegisterByte(RegisterType::B, 0xA5);
    WriteRegisterByte(RegisterType::C, 0xF4);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0x7C);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x38);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6E, 0x00);
    WriteMemory(0x0FC7, 0x6E);
    WriteMemory(0x0FC6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFC);
    CheckRegisterByte(RegisterType::B, 0xA5);
    CheckRegisterByte(RegisterType::C, 0xF4);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0x7C);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x38);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0x0FC8);
    CheckRegisterWord(RegisterType::SP, 0x6B74);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0FC6, 0xE0);
    CheckMemory(0x0FC7, 0x6E);
    CheckMemory(0xFF6E, 0xFC);
}

void test_E0_007B()
{
    if (skip_test_E0_007B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB33C);
    WriteRegisterWord(RegisterType::SP, 0x8DB6);
    WriteRegisterByte(RegisterType::A, 0x5B);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0x6D);
    WriteRegisterByte(RegisterType::D, 0x96);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x98);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF3D, 0x00);
    WriteMemory(0xB33D, 0x3D);
    WriteMemory(0xB33C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5B);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0x6D);
    CheckRegisterByte(RegisterType::D, 0x96);
    CheckRegisterByte(RegisterType::E, 0x86);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x98);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0xB33E);
    CheckRegisterWord(RegisterType::SP, 0x8DB6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB33C, 0xE0);
    CheckMemory(0xB33D, 0x3D);
    CheckMemory(0xFF3D, 0x5B);
}

void test_E0_007C()
{
    if (skip_test_E0_007C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE95A);
    WriteRegisterWord(RegisterType::SP, 0xDB36);
    WriteRegisterByte(RegisterType::A, 0xCE);
    WriteRegisterByte(RegisterType::B, 0x46);
    WriteRegisterByte(RegisterType::C, 0x3B);
    WriteRegisterByte(RegisterType::D, 0xF9);
    WriteRegisterByte(RegisterType::E, 0xB5);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xC8);
    WriteRegisterByte(RegisterType::L, 0x2E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2E, 0x00);
    WriteMemory(0xE95B, 0x2E);
    WriteMemory(0xE95A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCE);
    CheckRegisterByte(RegisterType::B, 0x46);
    CheckRegisterByte(RegisterType::C, 0x3B);
    CheckRegisterByte(RegisterType::D, 0xF9);
    CheckRegisterByte(RegisterType::E, 0xB5);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xC8);
    CheckRegisterByte(RegisterType::L, 0x2E);
    CheckRegisterWord(RegisterType::PC, 0xE95C);
    CheckRegisterWord(RegisterType::SP, 0xDB36);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE95A, 0xE0);
    CheckMemory(0xE95B, 0x2E);
    CheckMemory(0xFF2E, 0xCE);
}

void test_E0_007D()
{
    if (skip_test_E0_007D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDC40);
    WriteRegisterWord(RegisterType::SP, 0x1DE0);
    WriteRegisterByte(RegisterType::A, 0xA9);
    WriteRegisterByte(RegisterType::B, 0xFE);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0x25);
    WriteRegisterByte(RegisterType::E, 0x22);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0x5C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF91, 0x00);
    WriteMemory(0xDC41, 0x91);
    WriteMemory(0xDC40, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA9);
    CheckRegisterByte(RegisterType::B, 0xFE);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0x25);
    CheckRegisterByte(RegisterType::E, 0x22);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0x5C);
    CheckRegisterWord(RegisterType::PC, 0xDC42);
    CheckRegisterWord(RegisterType::SP, 0x1DE0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDC40, 0xE0);
    CheckMemory(0xDC41, 0x91);
    CheckMemory(0xFF91, 0xA9);
}

void test_E0_007E()
{
    if (skip_test_E0_007E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9E97);
    WriteRegisterWord(RegisterType::SP, 0xC068);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0xD5);
    WriteRegisterByte(RegisterType::C, 0x92);
    WriteRegisterByte(RegisterType::D, 0xDA);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x00);
    WriteRegisterByte(RegisterType::L, 0x24);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF42, 0x00);
    WriteMemory(0x9E98, 0x42);
    WriteMemory(0x9E97, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0xD5);
    CheckRegisterByte(RegisterType::C, 0x92);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0xE0);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x00);
    CheckRegisterByte(RegisterType::L, 0x24);
    CheckRegisterWord(RegisterType::PC, 0x9E99);
    CheckRegisterWord(RegisterType::SP, 0xC068);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9E97, 0xE0);
    CheckMemory(0x9E98, 0x42);
    CheckMemory(0xFF42, 0xA1);
}

void test_E0_007F()
{
    if (skip_test_E0_007F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9ABE);
    WriteRegisterWord(RegisterType::SP, 0xAEE4);
    WriteRegisterByte(RegisterType::A, 0x1F);
    WriteRegisterByte(RegisterType::B, 0x52);
    WriteRegisterByte(RegisterType::C, 0xA3);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0x25);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xBB);
    WriteRegisterByte(RegisterType::L, 0x75);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF27, 0x00);
    WriteMemory(0x9ABF, 0x27);
    WriteMemory(0x9ABE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1F);
    CheckRegisterByte(RegisterType::B, 0x52);
    CheckRegisterByte(RegisterType::C, 0xA3);
    CheckRegisterByte(RegisterType::D, 0xAB);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xBB);
    CheckRegisterByte(RegisterType::L, 0x75);
    CheckRegisterWord(RegisterType::PC, 0x9AC0);
    CheckRegisterWord(RegisterType::SP, 0xAEE4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9ABE, 0xE0);
    CheckMemory(0x9ABF, 0x27);
    CheckMemory(0xFF27, 0x1F);
}

void test_E0_0080()
{
    if (skip_test_E0_0080)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x697A);
    WriteRegisterWord(RegisterType::SP, 0x27AC);
    WriteRegisterByte(RegisterType::A, 0xF3);
    WriteRegisterByte(RegisterType::B, 0x72);
    WriteRegisterByte(RegisterType::C, 0x55);
    WriteRegisterByte(RegisterType::D, 0xAC);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x5C);
    WriteRegisterByte(RegisterType::L, 0xD6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF2E, 0x00);
    WriteMemory(0x697B, 0x2E);
    WriteMemory(0x697A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF3);
    CheckRegisterByte(RegisterType::B, 0x72);
    CheckRegisterByte(RegisterType::C, 0x55);
    CheckRegisterByte(RegisterType::D, 0xAC);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x5C);
    CheckRegisterByte(RegisterType::L, 0xD6);
    CheckRegisterWord(RegisterType::PC, 0x697C);
    CheckRegisterWord(RegisterType::SP, 0x27AC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x697A, 0xE0);
    CheckMemory(0x697B, 0x2E);
    CheckMemory(0xFF2E, 0xF3);
}

void test_E0_0081()
{
    if (skip_test_E0_0081)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0EDA);
    WriteRegisterWord(RegisterType::SP, 0x3A90);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0xF3);
    WriteRegisterByte(RegisterType::C, 0x96);
    WriteRegisterByte(RegisterType::D, 0x36);
    WriteRegisterByte(RegisterType::E, 0x57);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x16);
    WriteRegisterByte(RegisterType::L, 0x6C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF65, 0x00);
    WriteMemory(0x0EDB, 0x65);
    WriteMemory(0x0EDA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0xF3);
    CheckRegisterByte(RegisterType::C, 0x96);
    CheckRegisterByte(RegisterType::D, 0x36);
    CheckRegisterByte(RegisterType::E, 0x57);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x16);
    CheckRegisterByte(RegisterType::L, 0x6C);
    CheckRegisterWord(RegisterType::PC, 0x0EDC);
    CheckRegisterWord(RegisterType::SP, 0x3A90);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0EDA, 0xE0);
    CheckMemory(0x0EDB, 0x65);
    CheckMemory(0xFF65, 0xA1);
}

void test_E0_0082()
{
    if (skip_test_E0_0082)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x13E0);
    WriteRegisterWord(RegisterType::SP, 0x0241);
    WriteRegisterByte(RegisterType::A, 0x77);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0xF1);
    WriteRegisterByte(RegisterType::D, 0xFD);
    WriteRegisterByte(RegisterType::E, 0x85);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x60);
    WriteRegisterByte(RegisterType::L, 0xE6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4F, 0x00);
    WriteMemory(0x13E1, 0x4F);
    WriteMemory(0x13E0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x77);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0xF1);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0x85);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x60);
    CheckRegisterByte(RegisterType::L, 0xE6);
    CheckRegisterWord(RegisterType::PC, 0x13E2);
    CheckRegisterWord(RegisterType::SP, 0x0241);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x13E0, 0xE0);
    CheckMemory(0x13E1, 0x4F);
    CheckMemory(0xFF4F, 0x77);
}

void test_E0_0083()
{
    if (skip_test_E0_0083)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x45A0);
    WriteRegisterWord(RegisterType::SP, 0x2F10);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0x35);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0x3B);
    WriteRegisterByte(RegisterType::E, 0x27);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x08);
    WriteRegisterByte(RegisterType::L, 0x0C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD7, 0x00);
    WriteMemory(0x45A1, 0xD7);
    WriteMemory(0x45A0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0x35);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0x3B);
    CheckRegisterByte(RegisterType::E, 0x27);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x08);
    CheckRegisterByte(RegisterType::L, 0x0C);
    CheckRegisterWord(RegisterType::PC, 0x45A2);
    CheckRegisterWord(RegisterType::SP, 0x2F10);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x45A0, 0xE0);
    CheckMemory(0x45A1, 0xD7);
    CheckMemory(0xFFD7, 0xC1);
}

void test_E0_0084()
{
    if (skip_test_E0_0084)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD740);
    WriteRegisterWord(RegisterType::SP, 0xCE3E);
    WriteRegisterByte(RegisterType::A, 0x00);
    WriteRegisterByte(RegisterType::B, 0x3D);
    WriteRegisterByte(RegisterType::C, 0x43);
    WriteRegisterByte(RegisterType::D, 0x6D);
    WriteRegisterByte(RegisterType::E, 0x02);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xDF);
    WriteRegisterByte(RegisterType::L, 0x42);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4C, 0x00);
    WriteMemory(0xD741, 0x4C);
    WriteMemory(0xD740, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x00);
    CheckRegisterByte(RegisterType::B, 0x3D);
    CheckRegisterByte(RegisterType::C, 0x43);
    CheckRegisterByte(RegisterType::D, 0x6D);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xDF);
    CheckRegisterByte(RegisterType::L, 0x42);
    CheckRegisterWord(RegisterType::PC, 0xD742);
    CheckRegisterWord(RegisterType::SP, 0xCE3E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD740, 0xE0);
    CheckMemory(0xD741, 0x4C);
    CheckMemory(0xFF4C, 0x00);
}

void test_E0_0085()
{
    if (skip_test_E0_0085)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0CA0);
    WriteRegisterWord(RegisterType::SP, 0x8B51);
    WriteRegisterByte(RegisterType::A, 0x0F);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x47);
    WriteRegisterByte(RegisterType::D, 0x4B);
    WriteRegisterByte(RegisterType::E, 0x1A);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x41);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF59, 0x00);
    WriteMemory(0x0CA1, 0x59);
    WriteMemory(0x0CA0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0F);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x47);
    CheckRegisterByte(RegisterType::D, 0x4B);
    CheckRegisterByte(RegisterType::E, 0x1A);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x41);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0x0CA2);
    CheckRegisterWord(RegisterType::SP, 0x8B51);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0CA0, 0xE0);
    CheckMemory(0x0CA1, 0x59);
    CheckMemory(0xFF59, 0x0F);
}

void test_E0_0086()
{
    if (skip_test_E0_0086)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x17C0);
    WriteRegisterWord(RegisterType::SP, 0xAD01);
    WriteRegisterByte(RegisterType::A, 0x62);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0x2B);
    WriteRegisterByte(RegisterType::E, 0x6F);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD6);
    WriteRegisterByte(RegisterType::L, 0x41);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF3, 0x00);
    WriteMemory(0x17C1, 0xF3);
    WriteMemory(0x17C0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x62);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0x2B);
    CheckRegisterByte(RegisterType::E, 0x6F);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD6);
    CheckRegisterByte(RegisterType::L, 0x41);
    CheckRegisterWord(RegisterType::PC, 0x17C2);
    CheckRegisterWord(RegisterType::SP, 0xAD01);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x17C0, 0xE0);
    CheckMemory(0x17C1, 0xF3);
    CheckMemory(0xFFF3, 0x62);
}

void test_E0_0087()
{
    if (skip_test_E0_0087)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x852A);
    WriteRegisterWord(RegisterType::SP, 0x2BAF);
    WriteRegisterByte(RegisterType::A, 0xEB);
    WriteRegisterByte(RegisterType::B, 0x60);
    WriteRegisterByte(RegisterType::C, 0xD3);
    WriteRegisterByte(RegisterType::D, 0xA3);
    WriteRegisterByte(RegisterType::E, 0x29);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x24);
    WriteRegisterByte(RegisterType::L, 0xE6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF2A, 0x00);
    WriteMemory(0x852B, 0x2A);
    WriteMemory(0x852A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEB);
    CheckRegisterByte(RegisterType::B, 0x60);
    CheckRegisterByte(RegisterType::C, 0xD3);
    CheckRegisterByte(RegisterType::D, 0xA3);
    CheckRegisterByte(RegisterType::E, 0x29);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x24);
    CheckRegisterByte(RegisterType::L, 0xE6);
    CheckRegisterWord(RegisterType::PC, 0x852C);
    CheckRegisterWord(RegisterType::SP, 0x2BAF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x852A, 0xE0);
    CheckMemory(0x852B, 0x2A);
    CheckMemory(0xFF2A, 0xEB);
}

void test_E0_0088()
{
    if (skip_test_E0_0088)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6BDF);
    WriteRegisterWord(RegisterType::SP, 0xF78C);
    WriteRegisterByte(RegisterType::A, 0x00);
    WriteRegisterByte(RegisterType::B, 0xBA);
    WriteRegisterByte(RegisterType::C, 0x6F);
    WriteRegisterByte(RegisterType::D, 0xEC);
    WriteRegisterByte(RegisterType::E, 0x18);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0x4E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0E, 0x00);
    WriteMemory(0x6BE0, 0x0E);
    WriteMemory(0x6BDF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x00);
    CheckRegisterByte(RegisterType::B, 0xBA);
    CheckRegisterByte(RegisterType::C, 0x6F);
    CheckRegisterByte(RegisterType::D, 0xEC);
    CheckRegisterByte(RegisterType::E, 0x18);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0x4E);
    CheckRegisterWord(RegisterType::PC, 0x6BE1);
    CheckRegisterWord(RegisterType::SP, 0xF78C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6BDF, 0xE0);
    CheckMemory(0x6BE0, 0x0E);
    CheckMemory(0xFF0E, 0x00);
}

void test_E0_0089()
{
    if (skip_test_E0_0089)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3B7F);
    WriteRegisterWord(RegisterType::SP, 0x077D);
    WriteRegisterByte(RegisterType::A, 0x53);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0xD0);
    WriteRegisterByte(RegisterType::D, 0x01);
    WriteRegisterByte(RegisterType::E, 0x64);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xCB);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF48, 0x00);
    WriteMemory(0x3B80, 0x48);
    WriteMemory(0x3B7F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x53);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0xD0);
    CheckRegisterByte(RegisterType::D, 0x01);
    CheckRegisterByte(RegisterType::E, 0x64);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xCB);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0x3B81);
    CheckRegisterWord(RegisterType::SP, 0x077D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3B7F, 0xE0);
    CheckMemory(0x3B80, 0x48);
    CheckMemory(0xFF48, 0x53);
}

void test_E0_008A()
{
    if (skip_test_E0_008A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9F09);
    WriteRegisterWord(RegisterType::SP, 0xC117);
    WriteRegisterByte(RegisterType::A, 0x67);
    WriteRegisterByte(RegisterType::B, 0x31);
    WriteRegisterByte(RegisterType::C, 0x1D);
    WriteRegisterByte(RegisterType::D, 0x33);
    WriteRegisterByte(RegisterType::E, 0x02);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xFC);
    WriteRegisterByte(RegisterType::L, 0xA5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD5, 0x00);
    WriteMemory(0x9F0A, 0xD5);
    WriteMemory(0x9F09, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x67);
    CheckRegisterByte(RegisterType::B, 0x31);
    CheckRegisterByte(RegisterType::C, 0x1D);
    CheckRegisterByte(RegisterType::D, 0x33);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xFC);
    CheckRegisterByte(RegisterType::L, 0xA5);
    CheckRegisterWord(RegisterType::PC, 0x9F0B);
    CheckRegisterWord(RegisterType::SP, 0xC117);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9F09, 0xE0);
    CheckMemory(0x9F0A, 0xD5);
    CheckMemory(0xFFD5, 0x67);
}

void test_E0_008B()
{
    if (skip_test_E0_008B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3A58);
    WriteRegisterWord(RegisterType::SP, 0xCAEE);
    WriteRegisterByte(RegisterType::A, 0xA5);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0x8A);
    WriteRegisterByte(RegisterType::D, 0x55);
    WriteRegisterByte(RegisterType::E, 0xC8);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x8D);
    WriteRegisterByte(RegisterType::L, 0xC9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB8, 0x00);
    WriteMemory(0x3A59, 0xB8);
    WriteMemory(0x3A58, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA5);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0x8A);
    CheckRegisterByte(RegisterType::D, 0x55);
    CheckRegisterByte(RegisterType::E, 0xC8);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x8D);
    CheckRegisterByte(RegisterType::L, 0xC9);
    CheckRegisterWord(RegisterType::PC, 0x3A5A);
    CheckRegisterWord(RegisterType::SP, 0xCAEE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3A58, 0xE0);
    CheckMemory(0x3A59, 0xB8);
    CheckMemory(0xFFB8, 0xA5);
}

void test_E0_008C()
{
    if (skip_test_E0_008C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0F2F);
    WriteRegisterWord(RegisterType::SP, 0xB64A);
    WriteRegisterByte(RegisterType::A, 0x8A);
    WriteRegisterByte(RegisterType::B, 0xE5);
    WriteRegisterByte(RegisterType::C, 0xE7);
    WriteRegisterByte(RegisterType::D, 0xFA);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xB8);
    WriteRegisterByte(RegisterType::L, 0xFA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF51, 0x00);
    WriteMemory(0x0F30, 0x51);
    WriteMemory(0x0F2F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8A);
    CheckRegisterByte(RegisterType::B, 0xE5);
    CheckRegisterByte(RegisterType::C, 0xE7);
    CheckRegisterByte(RegisterType::D, 0xFA);
    CheckRegisterByte(RegisterType::E, 0x86);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xB8);
    CheckRegisterByte(RegisterType::L, 0xFA);
    CheckRegisterWord(RegisterType::PC, 0x0F31);
    CheckRegisterWord(RegisterType::SP, 0xB64A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0F2F, 0xE0);
    CheckMemory(0x0F30, 0x51);
    CheckMemory(0xFF51, 0x8A);
}

void test_E0_008D()
{
    if (skip_test_E0_008D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD808);
    WriteRegisterWord(RegisterType::SP, 0xEA75);
    WriteRegisterByte(RegisterType::A, 0xF5);
    WriteRegisterByte(RegisterType::B, 0x53);
    WriteRegisterByte(RegisterType::C, 0x5B);
    WriteRegisterByte(RegisterType::D, 0x46);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0x92);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD7, 0x00);
    WriteMemory(0xD809, 0xD7);
    WriteMemory(0xD808, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF5);
    CheckRegisterByte(RegisterType::B, 0x53);
    CheckRegisterByte(RegisterType::C, 0x5B);
    CheckRegisterByte(RegisterType::D, 0x46);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0x92);
    CheckRegisterWord(RegisterType::PC, 0xD80A);
    CheckRegisterWord(RegisterType::SP, 0xEA75);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD808, 0xE0);
    CheckMemory(0xD809, 0xD7);
    CheckMemory(0xFFD7, 0xF5);
}

void test_E0_008E()
{
    if (skip_test_E0_008E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x62EC);
    WriteRegisterWord(RegisterType::SP, 0x5550);
    WriteRegisterByte(RegisterType::A, 0xA3);
    WriteRegisterByte(RegisterType::B, 0x66);
    WriteRegisterByte(RegisterType::C, 0x81);
    WriteRegisterByte(RegisterType::D, 0x68);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x73);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF90, 0x00);
    WriteMemory(0x62ED, 0x90);
    WriteMemory(0x62EC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA3);
    CheckRegisterByte(RegisterType::B, 0x66);
    CheckRegisterByte(RegisterType::C, 0x81);
    CheckRegisterByte(RegisterType::D, 0x68);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x73);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0x62EE);
    CheckRegisterWord(RegisterType::SP, 0x5550);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x62EC, 0xE0);
    CheckMemory(0x62ED, 0x90);
    CheckMemory(0xFF90, 0xA3);
}

void test_E0_008F()
{
    if (skip_test_E0_008F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xED92);
    WriteRegisterWord(RegisterType::SP, 0x229F);
    WriteRegisterByte(RegisterType::A, 0x14);
    WriteRegisterByte(RegisterType::B, 0x71);
    WriteRegisterByte(RegisterType::C, 0xFB);
    WriteRegisterByte(RegisterType::D, 0xC3);
    WriteRegisterByte(RegisterType::E, 0x1C);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x0A);
    WriteRegisterByte(RegisterType::L, 0x45);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3B, 0x00);
    WriteMemory(0xED93, 0x3B);
    WriteMemory(0xED92, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x14);
    CheckRegisterByte(RegisterType::B, 0x71);
    CheckRegisterByte(RegisterType::C, 0xFB);
    CheckRegisterByte(RegisterType::D, 0xC3);
    CheckRegisterByte(RegisterType::E, 0x1C);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x0A);
    CheckRegisterByte(RegisterType::L, 0x45);
    CheckRegisterWord(RegisterType::PC, 0xED94);
    CheckRegisterWord(RegisterType::SP, 0x229F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xED92, 0xE0);
    CheckMemory(0xED93, 0x3B);
    CheckMemory(0xFF3B, 0x14);
}

void test_E0_0090()
{
    if (skip_test_E0_0090)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC511);
    WriteRegisterWord(RegisterType::SP, 0xACE0);
    WriteRegisterByte(RegisterType::A, 0x48);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0x8F);
    WriteRegisterByte(RegisterType::D, 0x9D);
    WriteRegisterByte(RegisterType::E, 0xDD);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xFB);
    WriteRegisterByte(RegisterType::L, 0x52);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4D, 0x00);
    WriteMemory(0xC512, 0x4D);
    WriteMemory(0xC511, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x48);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0x8F);
    CheckRegisterByte(RegisterType::D, 0x9D);
    CheckRegisterByte(RegisterType::E, 0xDD);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xFB);
    CheckRegisterByte(RegisterType::L, 0x52);
    CheckRegisterWord(RegisterType::PC, 0xC513);
    CheckRegisterWord(RegisterType::SP, 0xACE0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC511, 0xE0);
    CheckMemory(0xC512, 0x4D);
    CheckMemory(0xFF4D, 0x48);
}

void test_E0_0091()
{
    if (skip_test_E0_0091)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x098D);
    WriteRegisterWord(RegisterType::SP, 0x2741);
    WriteRegisterByte(RegisterType::A, 0xD7);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0xE3);
    WriteRegisterByte(RegisterType::D, 0x70);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x6A);
    WriteRegisterByte(RegisterType::L, 0x83);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF80, 0x00);
    WriteMemory(0x098E, 0x80);
    WriteMemory(0x098D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD7);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0xE3);
    CheckRegisterByte(RegisterType::D, 0x70);
    CheckRegisterByte(RegisterType::E, 0x86);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x6A);
    CheckRegisterByte(RegisterType::L, 0x83);
    CheckRegisterWord(RegisterType::PC, 0x098F);
    CheckRegisterWord(RegisterType::SP, 0x2741);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x098D, 0xE0);
    CheckMemory(0x098E, 0x80);
    CheckMemory(0xFF80, 0xD7);
}

void test_E0_0092()
{
    if (skip_test_E0_0092)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x524B);
    WriteRegisterWord(RegisterType::SP, 0x859E);
    WriteRegisterByte(RegisterType::A, 0x0C);
    WriteRegisterByte(RegisterType::B, 0xA2);
    WriteRegisterByte(RegisterType::C, 0xEE);
    WriteRegisterByte(RegisterType::D, 0x1D);
    WriteRegisterByte(RegisterType::E, 0xAB);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x87);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE4, 0x00);
    WriteMemory(0x524C, 0xE4);
    WriteMemory(0x524B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0C);
    CheckRegisterByte(RegisterType::B, 0xA2);
    CheckRegisterByte(RegisterType::C, 0xEE);
    CheckRegisterByte(RegisterType::D, 0x1D);
    CheckRegisterByte(RegisterType::E, 0xAB);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x87);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0x524D);
    CheckRegisterWord(RegisterType::SP, 0x859E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x524B, 0xE0);
    CheckMemory(0x524C, 0xE4);
    CheckMemory(0xFFE4, 0x0C);
}

void test_E0_0093()
{
    if (skip_test_E0_0093)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x366E);
    WriteRegisterWord(RegisterType::SP, 0x009E);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0xED);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0x80);
    WriteRegisterByte(RegisterType::E, 0x9D);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4C, 0x00);
    WriteMemory(0x366F, 0x4C);
    WriteMemory(0x366E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0xED);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0x80);
    CheckRegisterByte(RegisterType::E, 0x9D);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0x3670);
    CheckRegisterWord(RegisterType::SP, 0x009E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x366E, 0xE0);
    CheckMemory(0x366F, 0x4C);
    CheckMemory(0xFF4C, 0xBD);
}

void test_E0_0094()
{
    if (skip_test_E0_0094)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA788);
    WriteRegisterWord(RegisterType::SP, 0xB6FF);
    WriteRegisterByte(RegisterType::A, 0x73);
    WriteRegisterByte(RegisterType::B, 0xB9);
    WriteRegisterByte(RegisterType::C, 0x89);
    WriteRegisterByte(RegisterType::D, 0x05);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x3F);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF92, 0x00);
    WriteMemory(0xA789, 0x92);
    WriteMemory(0xA788, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x73);
    CheckRegisterByte(RegisterType::B, 0xB9);
    CheckRegisterByte(RegisterType::C, 0x89);
    CheckRegisterByte(RegisterType::D, 0x05);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x3F);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0xA78A);
    CheckRegisterWord(RegisterType::SP, 0xB6FF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA788, 0xE0);
    CheckMemory(0xA789, 0x92);
    CheckMemory(0xFF92, 0x73);
}

void test_E0_0095()
{
    if (skip_test_E0_0095)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x08C8);
    WriteRegisterWord(RegisterType::SP, 0xC7CB);
    WriteRegisterByte(RegisterType::A, 0xD3);
    WriteRegisterByte(RegisterType::B, 0x49);
    WriteRegisterByte(RegisterType::C, 0x78);
    WriteRegisterByte(RegisterType::D, 0xEA);
    WriteRegisterByte(RegisterType::E, 0xC3);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x38);
    WriteRegisterByte(RegisterType::L, 0x36);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF97, 0x00);
    WriteMemory(0x08C9, 0x97);
    WriteMemory(0x08C8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD3);
    CheckRegisterByte(RegisterType::B, 0x49);
    CheckRegisterByte(RegisterType::C, 0x78);
    CheckRegisterByte(RegisterType::D, 0xEA);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x38);
    CheckRegisterByte(RegisterType::L, 0x36);
    CheckRegisterWord(RegisterType::PC, 0x08CA);
    CheckRegisterWord(RegisterType::SP, 0xC7CB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x08C8, 0xE0);
    CheckMemory(0x08C9, 0x97);
    CheckMemory(0xFF97, 0xD3);
}

void test_E0_0096()
{
    if (skip_test_E0_0096)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x152A);
    WriteRegisterWord(RegisterType::SP, 0xA1E8);
    WriteRegisterByte(RegisterType::A, 0xB2);
    WriteRegisterByte(RegisterType::B, 0x32);
    WriteRegisterByte(RegisterType::C, 0xCD);
    WriteRegisterByte(RegisterType::D, 0x9B);
    WriteRegisterByte(RegisterType::E, 0x0C);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xB5);
    WriteRegisterByte(RegisterType::L, 0x13);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF2D, 0x00);
    WriteMemory(0x152B, 0x2D);
    WriteMemory(0x152A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB2);
    CheckRegisterByte(RegisterType::B, 0x32);
    CheckRegisterByte(RegisterType::C, 0xCD);
    CheckRegisterByte(RegisterType::D, 0x9B);
    CheckRegisterByte(RegisterType::E, 0x0C);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xB5);
    CheckRegisterByte(RegisterType::L, 0x13);
    CheckRegisterWord(RegisterType::PC, 0x152C);
    CheckRegisterWord(RegisterType::SP, 0xA1E8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x152A, 0xE0);
    CheckMemory(0x152B, 0x2D);
    CheckMemory(0xFF2D, 0xB2);
}

void test_E0_0097()
{
    if (skip_test_E0_0097)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA847);
    WriteRegisterWord(RegisterType::SP, 0x1B00);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0x3C);
    WriteRegisterByte(RegisterType::C, 0x41);
    WriteRegisterByte(RegisterType::D, 0x82);
    WriteRegisterByte(RegisterType::E, 0x3A);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xD6);
    WriteRegisterByte(RegisterType::L, 0x4B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2A, 0x00);
    WriteMemory(0xA848, 0x2A);
    WriteMemory(0xA847, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0x3C);
    CheckRegisterByte(RegisterType::C, 0x41);
    CheckRegisterByte(RegisterType::D, 0x82);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xD6);
    CheckRegisterByte(RegisterType::L, 0x4B);
    CheckRegisterWord(RegisterType::PC, 0xA849);
    CheckRegisterWord(RegisterType::SP, 0x1B00);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA847, 0xE0);
    CheckMemory(0xA848, 0x2A);
    CheckMemory(0xFF2A, 0xBD);
}

void test_E0_0098()
{
    if (skip_test_E0_0098)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x87AC);
    WriteRegisterWord(RegisterType::SP, 0xD0C2);
    WriteRegisterByte(RegisterType::A, 0xBC);
    WriteRegisterByte(RegisterType::B, 0x3E);
    WriteRegisterByte(RegisterType::C, 0x06);
    WriteRegisterByte(RegisterType::D, 0xD5);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xD3);
    WriteRegisterByte(RegisterType::L, 0x7D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCB, 0x00);
    WriteMemory(0x87AD, 0xCB);
    WriteMemory(0x87AC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBC);
    CheckRegisterByte(RegisterType::B, 0x3E);
    CheckRegisterByte(RegisterType::C, 0x06);
    CheckRegisterByte(RegisterType::D, 0xD5);
    CheckRegisterByte(RegisterType::E, 0x59);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xD3);
    CheckRegisterByte(RegisterType::L, 0x7D);
    CheckRegisterWord(RegisterType::PC, 0x87AE);
    CheckRegisterWord(RegisterType::SP, 0xD0C2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x87AC, 0xE0);
    CheckMemory(0x87AD, 0xCB);
    CheckMemory(0xFFCB, 0xBC);
}

void test_E0_0099()
{
    if (skip_test_E0_0099)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2ABF);
    WriteRegisterWord(RegisterType::SP, 0x739C);
    WriteRegisterByte(RegisterType::A, 0x08);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0xBD);
    WriteRegisterByte(RegisterType::D, 0x41);
    WriteRegisterByte(RegisterType::E, 0xCD);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xEF);
    WriteRegisterByte(RegisterType::L, 0xAB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAD, 0x00);
    WriteMemory(0x2AC0, 0xAD);
    WriteMemory(0x2ABF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x08);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0xBD);
    CheckRegisterByte(RegisterType::D, 0x41);
    CheckRegisterByte(RegisterType::E, 0xCD);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xEF);
    CheckRegisterByte(RegisterType::L, 0xAB);
    CheckRegisterWord(RegisterType::PC, 0x2AC1);
    CheckRegisterWord(RegisterType::SP, 0x739C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2ABF, 0xE0);
    CheckMemory(0x2AC0, 0xAD);
    CheckMemory(0xFFAD, 0x08);
}

void test_E0_009A()
{
    if (skip_test_E0_009A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x702F);
    WriteRegisterWord(RegisterType::SP, 0x67DE);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0xED);
    WriteRegisterByte(RegisterType::C, 0xA3);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0x63);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x89);
    WriteRegisterByte(RegisterType::L, 0x4B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9E, 0x00);
    WriteMemory(0x7030, 0x9E);
    WriteMemory(0x702F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0xED);
    CheckRegisterByte(RegisterType::C, 0xA3);
    CheckRegisterByte(RegisterType::D, 0xEE);
    CheckRegisterByte(RegisterType::E, 0x63);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x89);
    CheckRegisterByte(RegisterType::L, 0x4B);
    CheckRegisterWord(RegisterType::PC, 0x7031);
    CheckRegisterWord(RegisterType::SP, 0x67DE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x702F, 0xE0);
    CheckMemory(0x7030, 0x9E);
    CheckMemory(0xFF9E, 0x9B);
}

void test_E0_009B()
{
    if (skip_test_E0_009B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC886);
    WriteRegisterWord(RegisterType::SP, 0x567E);
    WriteRegisterByte(RegisterType::A, 0x9F);
    WriteRegisterByte(RegisterType::B, 0x44);
    WriteRegisterByte(RegisterType::C, 0x59);
    WriteRegisterByte(RegisterType::D, 0x75);
    WriteRegisterByte(RegisterType::E, 0xC8);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x2A);
    WriteRegisterByte(RegisterType::L, 0xAC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB5, 0x00);
    WriteMemory(0xC887, 0xB5);
    WriteMemory(0xC886, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9F);
    CheckRegisterByte(RegisterType::B, 0x44);
    CheckRegisterByte(RegisterType::C, 0x59);
    CheckRegisterByte(RegisterType::D, 0x75);
    CheckRegisterByte(RegisterType::E, 0xC8);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x2A);
    CheckRegisterByte(RegisterType::L, 0xAC);
    CheckRegisterWord(RegisterType::PC, 0xC888);
    CheckRegisterWord(RegisterType::SP, 0x567E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC886, 0xE0);
    CheckMemory(0xC887, 0xB5);
    CheckMemory(0xFFB5, 0x9F);
}

void test_E0_009C()
{
    if (skip_test_E0_009C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x82E1);
    WriteRegisterWord(RegisterType::SP, 0x9A43);
    WriteRegisterByte(RegisterType::A, 0x63);
    WriteRegisterByte(RegisterType::B, 0xC0);
    WriteRegisterByte(RegisterType::C, 0xDE);
    WriteRegisterByte(RegisterType::D, 0x72);
    WriteRegisterByte(RegisterType::E, 0xDB);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xEF);
    WriteRegisterByte(RegisterType::L, 0x4A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5F, 0x00);
    WriteMemory(0x82E2, 0x5F);
    WriteMemory(0x82E1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x63);
    CheckRegisterByte(RegisterType::B, 0xC0);
    CheckRegisterByte(RegisterType::C, 0xDE);
    CheckRegisterByte(RegisterType::D, 0x72);
    CheckRegisterByte(RegisterType::E, 0xDB);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xEF);
    CheckRegisterByte(RegisterType::L, 0x4A);
    CheckRegisterWord(RegisterType::PC, 0x82E3);
    CheckRegisterWord(RegisterType::SP, 0x9A43);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x82E1, 0xE0);
    CheckMemory(0x82E2, 0x5F);
    CheckMemory(0xFF5F, 0x63);
}

void test_E0_009D()
{
    if (skip_test_E0_009D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1822);
    WriteRegisterWord(RegisterType::SP, 0xC087);
    WriteRegisterByte(RegisterType::A, 0x05);
    WriteRegisterByte(RegisterType::B, 0x74);
    WriteRegisterByte(RegisterType::C, 0x48);
    WriteRegisterByte(RegisterType::D, 0x58);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0x93);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF42, 0x00);
    WriteMemory(0x1823, 0x42);
    WriteMemory(0x1822, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x05);
    CheckRegisterByte(RegisterType::B, 0x74);
    CheckRegisterByte(RegisterType::C, 0x48);
    CheckRegisterByte(RegisterType::D, 0x58);
    CheckRegisterByte(RegisterType::E, 0x5E);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0x93);
    CheckRegisterWord(RegisterType::PC, 0x1824);
    CheckRegisterWord(RegisterType::SP, 0xC087);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1822, 0xE0);
    CheckMemory(0x1823, 0x42);
    CheckMemory(0xFF42, 0x05);
}

void test_E0_009E()
{
    if (skip_test_E0_009E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFE6D);
    WriteRegisterWord(RegisterType::SP, 0xE653);
    WriteRegisterByte(RegisterType::A, 0xF7);
    WriteRegisterByte(RegisterType::B, 0x3B);
    WriteRegisterByte(RegisterType::C, 0x60);
    WriteRegisterByte(RegisterType::D, 0xEA);
    WriteRegisterByte(RegisterType::E, 0x00);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xBB);
    WriteRegisterByte(RegisterType::L, 0x6E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC8, 0x00);
    WriteMemory(0xFE6E, 0xC8);
    WriteMemory(0xFE6D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF7);
    CheckRegisterByte(RegisterType::B, 0x3B);
    CheckRegisterByte(RegisterType::C, 0x60);
    CheckRegisterByte(RegisterType::D, 0xEA);
    CheckRegisterByte(RegisterType::E, 0x00);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xBB);
    CheckRegisterByte(RegisterType::L, 0x6E);
    CheckRegisterWord(RegisterType::PC, 0xFE6F);
    CheckRegisterWord(RegisterType::SP, 0xE653);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFE6D, 0xE0);
    CheckMemory(0xFE6E, 0xC8);
    CheckMemory(0xFFC8, 0xF7);
}

void test_E0_009F()
{
    if (skip_test_E0_009F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0083);
    WriteRegisterWord(RegisterType::SP, 0x39D4);
    WriteRegisterByte(RegisterType::A, 0xD7);
    WriteRegisterByte(RegisterType::B, 0x0B);
    WriteRegisterByte(RegisterType::C, 0xE6);
    WriteRegisterByte(RegisterType::D, 0x3C);
    WriteRegisterByte(RegisterType::E, 0xEF);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0x02);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF23, 0x00);
    WriteMemory(0x0084, 0x23);
    WriteMemory(0x0083, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD7);
    CheckRegisterByte(RegisterType::B, 0x0B);
    CheckRegisterByte(RegisterType::C, 0xE6);
    CheckRegisterByte(RegisterType::D, 0x3C);
    CheckRegisterByte(RegisterType::E, 0xEF);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0x02);
    CheckRegisterWord(RegisterType::PC, 0x0085);
    CheckRegisterWord(RegisterType::SP, 0x39D4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0083, 0xE0);
    CheckMemory(0x0084, 0x23);
    CheckMemory(0xFF23, 0xD7);
}

void test_E0_00A0()
{
    if (skip_test_E0_00A0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1132);
    WriteRegisterWord(RegisterType::SP, 0x15FA);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0x46);
    WriteRegisterByte(RegisterType::C, 0xA1);
    WriteRegisterByte(RegisterType::D, 0x52);
    WriteRegisterByte(RegisterType::E, 0x0D);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0x42);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF43, 0x00);
    WriteMemory(0x1133, 0x43);
    WriteMemory(0x1132, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0x46);
    CheckRegisterByte(RegisterType::C, 0xA1);
    CheckRegisterByte(RegisterType::D, 0x52);
    CheckRegisterByte(RegisterType::E, 0x0D);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0x42);
    CheckRegisterWord(RegisterType::PC, 0x1134);
    CheckRegisterWord(RegisterType::SP, 0x15FA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1132, 0xE0);
    CheckMemory(0x1133, 0x43);
    CheckMemory(0xFF43, 0xCD);
}

void test_E0_00A1()
{
    if (skip_test_E0_00A1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x08EE);
    WriteRegisterWord(RegisterType::SP, 0x7460);
    WriteRegisterByte(RegisterType::A, 0xCB);
    WriteRegisterByte(RegisterType::B, 0x00);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0x9F);
    WriteRegisterByte(RegisterType::E, 0xB6);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x19);
    WriteRegisterByte(RegisterType::L, 0xA7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4C, 0x00);
    WriteMemory(0x08EF, 0x4C);
    WriteMemory(0x08EE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCB);
    CheckRegisterByte(RegisterType::B, 0x00);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0xB6);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x19);
    CheckRegisterByte(RegisterType::L, 0xA7);
    CheckRegisterWord(RegisterType::PC, 0x08F0);
    CheckRegisterWord(RegisterType::SP, 0x7460);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x08EE, 0xE0);
    CheckMemory(0x08EF, 0x4C);
    CheckMemory(0xFF4C, 0xCB);
}

void test_E0_00A2()
{
    if (skip_test_E0_00A2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x465D);
    WriteRegisterWord(RegisterType::SP, 0xDFC0);
    WriteRegisterByte(RegisterType::A, 0x6E);
    WriteRegisterByte(RegisterType::B, 0x36);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x24);
    WriteRegisterByte(RegisterType::L, 0x06);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAC, 0x00);
    WriteMemory(0x465E, 0xAC);
    WriteMemory(0x465D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6E);
    CheckRegisterByte(RegisterType::B, 0x36);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0x7B);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x24);
    CheckRegisterByte(RegisterType::L, 0x06);
    CheckRegisterWord(RegisterType::PC, 0x465F);
    CheckRegisterWord(RegisterType::SP, 0xDFC0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x465D, 0xE0);
    CheckMemory(0x465E, 0xAC);
    CheckMemory(0xFFAC, 0x6E);
}

void test_E0_00A3()
{
    if (skip_test_E0_00A3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4777);
    WriteRegisterWord(RegisterType::SP, 0xA5C2);
    WriteRegisterByte(RegisterType::A, 0x7D);
    WriteRegisterByte(RegisterType::B, 0xF0);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0xBE);
    WriteRegisterByte(RegisterType::E, 0xD3);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x0F);
    WriteRegisterByte(RegisterType::L, 0x70);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF58, 0x00);
    WriteMemory(0x4778, 0x58);
    WriteMemory(0x4777, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7D);
    CheckRegisterByte(RegisterType::B, 0xF0);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0xBE);
    CheckRegisterByte(RegisterType::E, 0xD3);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x0F);
    CheckRegisterByte(RegisterType::L, 0x70);
    CheckRegisterWord(RegisterType::PC, 0x4779);
    CheckRegisterWord(RegisterType::SP, 0xA5C2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4777, 0xE0);
    CheckMemory(0x4778, 0x58);
    CheckMemory(0xFF58, 0x7D);
}

void test_E0_00A4()
{
    if (skip_test_E0_00A4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAF0D);
    WriteRegisterWord(RegisterType::SP, 0xEFF0);
    WriteRegisterByte(RegisterType::A, 0x55);
    WriteRegisterByte(RegisterType::B, 0x7B);
    WriteRegisterByte(RegisterType::C, 0xDA);
    WriteRegisterByte(RegisterType::D, 0x81);
    WriteRegisterByte(RegisterType::E, 0x0C);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x07);
    WriteRegisterByte(RegisterType::L, 0xE0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF86, 0x00);
    WriteMemory(0xAF0E, 0x86);
    WriteMemory(0xAF0D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x55);
    CheckRegisterByte(RegisterType::B, 0x7B);
    CheckRegisterByte(RegisterType::C, 0xDA);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0x0C);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x07);
    CheckRegisterByte(RegisterType::L, 0xE0);
    CheckRegisterWord(RegisterType::PC, 0xAF0F);
    CheckRegisterWord(RegisterType::SP, 0xEFF0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAF0D, 0xE0);
    CheckMemory(0xAF0E, 0x86);
    CheckMemory(0xFF86, 0x55);
}

void test_E0_00A5()
{
    if (skip_test_E0_00A5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x342A);
    WriteRegisterWord(RegisterType::SP, 0x8902);
    WriteRegisterByte(RegisterType::A, 0x05);
    WriteRegisterByte(RegisterType::B, 0xAC);
    WriteRegisterByte(RegisterType::C, 0x7C);
    WriteRegisterByte(RegisterType::D, 0x5D);
    WriteRegisterByte(RegisterType::E, 0x1C);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xA1);
    WriteRegisterByte(RegisterType::L, 0x2C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA6, 0x00);
    WriteMemory(0x342B, 0xA6);
    WriteMemory(0x342A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x05);
    CheckRegisterByte(RegisterType::B, 0xAC);
    CheckRegisterByte(RegisterType::C, 0x7C);
    CheckRegisterByte(RegisterType::D, 0x5D);
    CheckRegisterByte(RegisterType::E, 0x1C);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xA1);
    CheckRegisterByte(RegisterType::L, 0x2C);
    CheckRegisterWord(RegisterType::PC, 0x342C);
    CheckRegisterWord(RegisterType::SP, 0x8902);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x342A, 0xE0);
    CheckMemory(0x342B, 0xA6);
    CheckMemory(0xFFA6, 0x05);
}

void test_E0_00A6()
{
    if (skip_test_E0_00A6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2591);
    WriteRegisterWord(RegisterType::SP, 0x05C0);
    WriteRegisterByte(RegisterType::A, 0x4F);
    WriteRegisterByte(RegisterType::B, 0x23);
    WriteRegisterByte(RegisterType::C, 0xDE);
    WriteRegisterByte(RegisterType::D, 0x91);
    WriteRegisterByte(RegisterType::E, 0xDF);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0x74);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6D, 0x00);
    WriteMemory(0x2592, 0x6D);
    WriteMemory(0x2591, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4F);
    CheckRegisterByte(RegisterType::B, 0x23);
    CheckRegisterByte(RegisterType::C, 0xDE);
    CheckRegisterByte(RegisterType::D, 0x91);
    CheckRegisterByte(RegisterType::E, 0xDF);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0x74);
    CheckRegisterWord(RegisterType::PC, 0x2593);
    CheckRegisterWord(RegisterType::SP, 0x05C0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2591, 0xE0);
    CheckMemory(0x2592, 0x6D);
    CheckMemory(0xFF6D, 0x4F);
}

void test_E0_00A7()
{
    if (skip_test_E0_00A7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x902F);
    WriteRegisterWord(RegisterType::SP, 0x2883);
    WriteRegisterByte(RegisterType::A, 0x6D);
    WriteRegisterByte(RegisterType::B, 0x63);
    WriteRegisterByte(RegisterType::C, 0x1B);
    WriteRegisterByte(RegisterType::D, 0x4E);
    WriteRegisterByte(RegisterType::E, 0xDF);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x1F);
    WriteRegisterByte(RegisterType::L, 0x00);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB6, 0x00);
    WriteMemory(0x9030, 0xB6);
    WriteMemory(0x902F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6D);
    CheckRegisterByte(RegisterType::B, 0x63);
    CheckRegisterByte(RegisterType::C, 0x1B);
    CheckRegisterByte(RegisterType::D, 0x4E);
    CheckRegisterByte(RegisterType::E, 0xDF);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x1F);
    CheckRegisterByte(RegisterType::L, 0x00);
    CheckRegisterWord(RegisterType::PC, 0x9031);
    CheckRegisterWord(RegisterType::SP, 0x2883);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x902F, 0xE0);
    CheckMemory(0x9030, 0xB6);
    CheckMemory(0xFFB6, 0x6D);
}

void test_E0_00A8()
{
    if (skip_test_E0_00A8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x99DC);
    WriteRegisterWord(RegisterType::SP, 0xB206);
    WriteRegisterByte(RegisterType::A, 0x29);
    WriteRegisterByte(RegisterType::B, 0x17);
    WriteRegisterByte(RegisterType::C, 0x4D);
    WriteRegisterByte(RegisterType::D, 0x57);
    WriteRegisterByte(RegisterType::E, 0x6D);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x7B);
    WriteRegisterByte(RegisterType::L, 0xDD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6F, 0x00);
    WriteMemory(0x99DD, 0x6F);
    WriteMemory(0x99DC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x29);
    CheckRegisterByte(RegisterType::B, 0x17);
    CheckRegisterByte(RegisterType::C, 0x4D);
    CheckRegisterByte(RegisterType::D, 0x57);
    CheckRegisterByte(RegisterType::E, 0x6D);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x7B);
    CheckRegisterByte(RegisterType::L, 0xDD);
    CheckRegisterWord(RegisterType::PC, 0x99DE);
    CheckRegisterWord(RegisterType::SP, 0xB206);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x99DC, 0xE0);
    CheckMemory(0x99DD, 0x6F);
    CheckMemory(0xFF6F, 0x29);
}

void test_E0_00A9()
{
    if (skip_test_E0_00A9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF443);
    WriteRegisterWord(RegisterType::SP, 0x8053);
    WriteRegisterByte(RegisterType::A, 0x6E);
    WriteRegisterByte(RegisterType::B, 0x53);
    WriteRegisterByte(RegisterType::C, 0xC3);
    WriteRegisterByte(RegisterType::D, 0x20);
    WriteRegisterByte(RegisterType::E, 0xD2);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x20);
    WriteRegisterByte(RegisterType::L, 0x97);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF7C, 0x00);
    WriteMemory(0xF444, 0x7C);
    WriteMemory(0xF443, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6E);
    CheckRegisterByte(RegisterType::B, 0x53);
    CheckRegisterByte(RegisterType::C, 0xC3);
    CheckRegisterByte(RegisterType::D, 0x20);
    CheckRegisterByte(RegisterType::E, 0xD2);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x20);
    CheckRegisterByte(RegisterType::L, 0x97);
    CheckRegisterWord(RegisterType::PC, 0xF445);
    CheckRegisterWord(RegisterType::SP, 0x8053);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF443, 0xE0);
    CheckMemory(0xF444, 0x7C);
    CheckMemory(0xFF7C, 0x6E);
}

void test_E0_00AA()
{
    if (skip_test_E0_00AA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFB7E);
    WriteRegisterWord(RegisterType::SP, 0x7D3C);
    WriteRegisterByte(RegisterType::A, 0x63);
    WriteRegisterByte(RegisterType::B, 0x0B);
    WriteRegisterByte(RegisterType::C, 0x42);
    WriteRegisterByte(RegisterType::D, 0xB9);
    WriteRegisterByte(RegisterType::E, 0xFF);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x55);
    WriteRegisterByte(RegisterType::L, 0x02);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD9, 0x00);
    WriteMemory(0xFB7F, 0xD9);
    WriteMemory(0xFB7E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x63);
    CheckRegisterByte(RegisterType::B, 0x0B);
    CheckRegisterByte(RegisterType::C, 0x42);
    CheckRegisterByte(RegisterType::D, 0xB9);
    CheckRegisterByte(RegisterType::E, 0xFF);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x55);
    CheckRegisterByte(RegisterType::L, 0x02);
    CheckRegisterWord(RegisterType::PC, 0xFB80);
    CheckRegisterWord(RegisterType::SP, 0x7D3C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFB7E, 0xE0);
    CheckMemory(0xFB7F, 0xD9);
    CheckMemory(0xFFD9, 0x63);
}

void test_E0_00AB()
{
    if (skip_test_E0_00AB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x40FB);
    WriteRegisterWord(RegisterType::SP, 0xC08D);
    WriteRegisterByte(RegisterType::A, 0xDA);
    WriteRegisterByte(RegisterType::B, 0x59);
    WriteRegisterByte(RegisterType::C, 0x4F);
    WriteRegisterByte(RegisterType::D, 0x0F);
    WriteRegisterByte(RegisterType::E, 0xDE);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xAF);
    WriteRegisterByte(RegisterType::L, 0x2E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF03, 0x00);
    WriteMemory(0x40FC, 0x03);
    WriteMemory(0x40FB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDA);
    CheckRegisterByte(RegisterType::B, 0x59);
    CheckRegisterByte(RegisterType::C, 0x4F);
    CheckRegisterByte(RegisterType::D, 0x0F);
    CheckRegisterByte(RegisterType::E, 0xDE);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xAF);
    CheckRegisterByte(RegisterType::L, 0x2E);
    CheckRegisterWord(RegisterType::PC, 0x40FD);
    CheckRegisterWord(RegisterType::SP, 0xC08D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x40FB, 0xE0);
    CheckMemory(0x40FC, 0x03);
    CheckMemory(0xFF03, 0xDA);
}

void test_E0_00AC()
{
    if (skip_test_E0_00AC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4EFE);
    WriteRegisterWord(RegisterType::SP, 0x2592);
    WriteRegisterByte(RegisterType::A, 0x25);
    WriteRegisterByte(RegisterType::B, 0xA5);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0xE3);
    WriteRegisterByte(RegisterType::E, 0xA3);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x2E);
    WriteRegisterByte(RegisterType::L, 0xCF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF67, 0x00);
    WriteMemory(0x4EFF, 0x67);
    WriteMemory(0x4EFE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x25);
    CheckRegisterByte(RegisterType::B, 0xA5);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0xE3);
    CheckRegisterByte(RegisterType::E, 0xA3);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x2E);
    CheckRegisterByte(RegisterType::L, 0xCF);
    CheckRegisterWord(RegisterType::PC, 0x4F00);
    CheckRegisterWord(RegisterType::SP, 0x2592);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4EFE, 0xE0);
    CheckMemory(0x4EFF, 0x67);
    CheckMemory(0xFF67, 0x25);
}

void test_E0_00AD()
{
    if (skip_test_E0_00AD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x05C1);
    WriteRegisterWord(RegisterType::SP, 0x3561);
    WriteRegisterByte(RegisterType::A, 0xED);
    WriteRegisterByte(RegisterType::B, 0x2C);
    WriteRegisterByte(RegisterType::C, 0xFB);
    WriteRegisterByte(RegisterType::D, 0x15);
    WriteRegisterByte(RegisterType::E, 0x17);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x60);
    WriteRegisterByte(RegisterType::L, 0x0C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF24, 0x00);
    WriteMemory(0x05C2, 0x24);
    WriteMemory(0x05C1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xED);
    CheckRegisterByte(RegisterType::B, 0x2C);
    CheckRegisterByte(RegisterType::C, 0xFB);
    CheckRegisterByte(RegisterType::D, 0x15);
    CheckRegisterByte(RegisterType::E, 0x17);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x60);
    CheckRegisterByte(RegisterType::L, 0x0C);
    CheckRegisterWord(RegisterType::PC, 0x05C3);
    CheckRegisterWord(RegisterType::SP, 0x3561);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x05C1, 0xE0);
    CheckMemory(0x05C2, 0x24);
    CheckMemory(0xFF24, 0xED);
}

void test_E0_00AE()
{
    if (skip_test_E0_00AE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1F9D);
    WriteRegisterWord(RegisterType::SP, 0xA81D);
    WriteRegisterByte(RegisterType::A, 0xAF);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0xDC);
    WriteRegisterByte(RegisterType::D, 0xED);
    WriteRegisterByte(RegisterType::E, 0xA2);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x32);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD0, 0x00);
    WriteMemory(0x1F9E, 0xD0);
    WriteMemory(0x1F9D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAF);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0xDC);
    CheckRegisterByte(RegisterType::D, 0xED);
    CheckRegisterByte(RegisterType::E, 0xA2);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x32);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0x1F9F);
    CheckRegisterWord(RegisterType::SP, 0xA81D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1F9D, 0xE0);
    CheckMemory(0x1F9E, 0xD0);
    CheckMemory(0xFFD0, 0xAF);
}

void test_E0_00AF()
{
    if (skip_test_E0_00AF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD8D);
    WriteRegisterWord(RegisterType::SP, 0xD28C);
    WriteRegisterByte(RegisterType::A, 0x4B);
    WriteRegisterByte(RegisterType::B, 0x13);
    WriteRegisterByte(RegisterType::C, 0x99);
    WriteRegisterByte(RegisterType::D, 0x73);
    WriteRegisterByte(RegisterType::E, 0xCE);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xD3);
    WriteRegisterByte(RegisterType::L, 0x74);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFD, 0x00);
    WriteMemory(0xCD8E, 0xFD);
    WriteMemory(0xCD8D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4B);
    CheckRegisterByte(RegisterType::B, 0x13);
    CheckRegisterByte(RegisterType::C, 0x99);
    CheckRegisterByte(RegisterType::D, 0x73);
    CheckRegisterByte(RegisterType::E, 0xCE);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xD3);
    CheckRegisterByte(RegisterType::L, 0x74);
    CheckRegisterWord(RegisterType::PC, 0xCD8F);
    CheckRegisterWord(RegisterType::SP, 0xD28C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCD8D, 0xE0);
    CheckMemory(0xCD8E, 0xFD);
    CheckMemory(0xFFFD, 0x4B);
}

void test_E0_00B0()
{
    if (skip_test_E0_00B0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6972);
    WriteRegisterWord(RegisterType::SP, 0x8F4E);
    WriteRegisterByte(RegisterType::A, 0x43);
    WriteRegisterByte(RegisterType::B, 0x94);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0x0D);
    WriteRegisterByte(RegisterType::E, 0xCB);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x3B);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF60, 0x00);
    WriteMemory(0x6973, 0x60);
    WriteMemory(0x6972, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x43);
    CheckRegisterByte(RegisterType::B, 0x94);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0x0D);
    CheckRegisterByte(RegisterType::E, 0xCB);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x3B);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0x6974);
    CheckRegisterWord(RegisterType::SP, 0x8F4E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6972, 0xE0);
    CheckMemory(0x6973, 0x60);
    CheckMemory(0xFF60, 0x43);
}

void test_E0_00B1()
{
    if (skip_test_E0_00B1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF806);
    WriteRegisterWord(RegisterType::SP, 0x32D2);
    WriteRegisterByte(RegisterType::A, 0x5D);
    WriteRegisterByte(RegisterType::B, 0x90);
    WriteRegisterByte(RegisterType::C, 0x42);
    WriteRegisterByte(RegisterType::D, 0xA5);
    WriteRegisterByte(RegisterType::E, 0x20);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xB8);
    WriteRegisterByte(RegisterType::L, 0xEF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF8A, 0x00);
    WriteMemory(0xF807, 0x8A);
    WriteMemory(0xF806, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5D);
    CheckRegisterByte(RegisterType::B, 0x90);
    CheckRegisterByte(RegisterType::C, 0x42);
    CheckRegisterByte(RegisterType::D, 0xA5);
    CheckRegisterByte(RegisterType::E, 0x20);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xB8);
    CheckRegisterByte(RegisterType::L, 0xEF);
    CheckRegisterWord(RegisterType::PC, 0xF808);
    CheckRegisterWord(RegisterType::SP, 0x32D2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF806, 0xE0);
    CheckMemory(0xF807, 0x8A);
    CheckMemory(0xFF8A, 0x5D);
}

void test_E0_00B2()
{
    if (skip_test_E0_00B2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8A0F);
    WriteRegisterWord(RegisterType::SP, 0xD418);
    WriteRegisterByte(RegisterType::A, 0xAA);
    WriteRegisterByte(RegisterType::B, 0x9F);
    WriteRegisterByte(RegisterType::C, 0x7B);
    WriteRegisterByte(RegisterType::D, 0xC8);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x94);
    WriteRegisterByte(RegisterType::L, 0x73);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF75, 0x00);
    WriteMemory(0x8A10, 0x75);
    WriteMemory(0x8A0F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAA);
    CheckRegisterByte(RegisterType::B, 0x9F);
    CheckRegisterByte(RegisterType::C, 0x7B);
    CheckRegisterByte(RegisterType::D, 0xC8);
    CheckRegisterByte(RegisterType::E, 0x53);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x94);
    CheckRegisterByte(RegisterType::L, 0x73);
    CheckRegisterWord(RegisterType::PC, 0x8A11);
    CheckRegisterWord(RegisterType::SP, 0xD418);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8A0F, 0xE0);
    CheckMemory(0x8A10, 0x75);
    CheckMemory(0xFF75, 0xAA);
}

void test_E0_00B3()
{
    if (skip_test_E0_00B3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEE3B);
    WriteRegisterWord(RegisterType::SP, 0xFBAB);
    WriteRegisterByte(RegisterType::A, 0x2A);
    WriteRegisterByte(RegisterType::B, 0xFD);
    WriteRegisterByte(RegisterType::C, 0xE2);
    WriteRegisterByte(RegisterType::D, 0xD9);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x13);
    WriteRegisterByte(RegisterType::L, 0x42);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF7B, 0x00);
    WriteMemory(0xEE3C, 0x7B);
    WriteMemory(0xEE3B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2A);
    CheckRegisterByte(RegisterType::B, 0xFD);
    CheckRegisterByte(RegisterType::C, 0xE2);
    CheckRegisterByte(RegisterType::D, 0xD9);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x13);
    CheckRegisterByte(RegisterType::L, 0x42);
    CheckRegisterWord(RegisterType::PC, 0xEE3D);
    CheckRegisterWord(RegisterType::SP, 0xFBAB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEE3B, 0xE0);
    CheckMemory(0xEE3C, 0x7B);
    CheckMemory(0xFF7B, 0x2A);
}

void test_E0_00B4()
{
    if (skip_test_E0_00B4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD512);
    WriteRegisterWord(RegisterType::SP, 0x5443);
    WriteRegisterByte(RegisterType::A, 0x81);
    WriteRegisterByte(RegisterType::B, 0x04);
    WriteRegisterByte(RegisterType::C, 0xD6);
    WriteRegisterByte(RegisterType::D, 0xFD);
    WriteRegisterByte(RegisterType::E, 0x4B);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xC8);
    WriteRegisterByte(RegisterType::L, 0x3D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCE, 0x00);
    WriteMemory(0xD513, 0xCE);
    WriteMemory(0xD512, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x81);
    CheckRegisterByte(RegisterType::B, 0x04);
    CheckRegisterByte(RegisterType::C, 0xD6);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0x4B);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xC8);
    CheckRegisterByte(RegisterType::L, 0x3D);
    CheckRegisterWord(RegisterType::PC, 0xD514);
    CheckRegisterWord(RegisterType::SP, 0x5443);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD512, 0xE0);
    CheckMemory(0xD513, 0xCE);
    CheckMemory(0xFFCE, 0x81);
}

void test_E0_00B5()
{
    if (skip_test_E0_00B5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC9EB);
    WriteRegisterWord(RegisterType::SP, 0x3370);
    WriteRegisterByte(RegisterType::A, 0xB4);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0xCC);
    WriteRegisterByte(RegisterType::D, 0x69);
    WriteRegisterByte(RegisterType::E, 0xC4);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x4A);
    WriteRegisterByte(RegisterType::L, 0xAB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF6D, 0x00);
    WriteMemory(0xC9EC, 0x6D);
    WriteMemory(0xC9EB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB4);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0xCC);
    CheckRegisterByte(RegisterType::D, 0x69);
    CheckRegisterByte(RegisterType::E, 0xC4);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x4A);
    CheckRegisterByte(RegisterType::L, 0xAB);
    CheckRegisterWord(RegisterType::PC, 0xC9ED);
    CheckRegisterWord(RegisterType::SP, 0x3370);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC9EB, 0xE0);
    CheckMemory(0xC9EC, 0x6D);
    CheckMemory(0xFF6D, 0xB4);
}

void test_E0_00B6()
{
    if (skip_test_E0_00B6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x290F);
    WriteRegisterWord(RegisterType::SP, 0x8929);
    WriteRegisterByte(RegisterType::A, 0x76);
    WriteRegisterByte(RegisterType::B, 0x2B);
    WriteRegisterByte(RegisterType::C, 0x5F);
    WriteRegisterByte(RegisterType::D, 0x32);
    WriteRegisterByte(RegisterType::E, 0xB7);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x8B);
    WriteRegisterByte(RegisterType::L, 0x2A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC2, 0x00);
    WriteMemory(0x2910, 0xC2);
    WriteMemory(0x290F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x76);
    CheckRegisterByte(RegisterType::B, 0x2B);
    CheckRegisterByte(RegisterType::C, 0x5F);
    CheckRegisterByte(RegisterType::D, 0x32);
    CheckRegisterByte(RegisterType::E, 0xB7);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x8B);
    CheckRegisterByte(RegisterType::L, 0x2A);
    CheckRegisterWord(RegisterType::PC, 0x2911);
    CheckRegisterWord(RegisterType::SP, 0x8929);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x290F, 0xE0);
    CheckMemory(0x2910, 0xC2);
    CheckMemory(0xFFC2, 0x76);
}

void test_E0_00B7()
{
    if (skip_test_E0_00B7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7862);
    WriteRegisterWord(RegisterType::SP, 0x1EB8);
    WriteRegisterByte(RegisterType::A, 0x43);
    WriteRegisterByte(RegisterType::B, 0xDF);
    WriteRegisterByte(RegisterType::C, 0x45);
    WriteRegisterByte(RegisterType::D, 0x86);
    WriteRegisterByte(RegisterType::E, 0xF8);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0x3E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB1, 0x00);
    WriteMemory(0x7863, 0xB1);
    WriteMemory(0x7862, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x43);
    CheckRegisterByte(RegisterType::B, 0xDF);
    CheckRegisterByte(RegisterType::C, 0x45);
    CheckRegisterByte(RegisterType::D, 0x86);
    CheckRegisterByte(RegisterType::E, 0xF8);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0x3E);
    CheckRegisterWord(RegisterType::PC, 0x7864);
    CheckRegisterWord(RegisterType::SP, 0x1EB8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7862, 0xE0);
    CheckMemory(0x7863, 0xB1);
    CheckMemory(0xFFB1, 0x43);
}

void test_E0_00B8()
{
    if (skip_test_E0_00B8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5392);
    WriteRegisterWord(RegisterType::SP, 0x2D9A);
    WriteRegisterByte(RegisterType::A, 0x77);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x3D);
    WriteRegisterByte(RegisterType::D, 0x62);
    WriteRegisterByte(RegisterType::E, 0x61);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xAF);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF6, 0x00);
    WriteMemory(0x5393, 0xF6);
    WriteMemory(0x5392, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x77);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x3D);
    CheckRegisterByte(RegisterType::D, 0x62);
    CheckRegisterByte(RegisterType::E, 0x61);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xAF);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0x5394);
    CheckRegisterWord(RegisterType::SP, 0x2D9A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5392, 0xE0);
    CheckMemory(0x5393, 0xF6);
    CheckMemory(0xFFF6, 0x77);
}

void test_E0_00B9()
{
    if (skip_test_E0_00B9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7597);
    WriteRegisterWord(RegisterType::SP, 0x69AD);
    WriteRegisterByte(RegisterType::A, 0x33);
    WriteRegisterByte(RegisterType::B, 0xC7);
    WriteRegisterByte(RegisterType::C, 0x3F);
    WriteRegisterByte(RegisterType::D, 0x11);
    WriteRegisterByte(RegisterType::E, 0xB9);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x1A);
    WriteRegisterByte(RegisterType::L, 0xE1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF07, 0x00);
    WriteMemory(0x7598, 0x07);
    WriteMemory(0x7597, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x33);
    CheckRegisterByte(RegisterType::B, 0xC7);
    CheckRegisterByte(RegisterType::C, 0x3F);
    CheckRegisterByte(RegisterType::D, 0x11);
    CheckRegisterByte(RegisterType::E, 0xB9);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x1A);
    CheckRegisterByte(RegisterType::L, 0xE1);
    CheckRegisterWord(RegisterType::PC, 0x7599);
    CheckRegisterWord(RegisterType::SP, 0x69AD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7597, 0xE0);
    CheckMemory(0x7598, 0x07);
    CheckMemory(0xFF07, 0x33);
}

void test_E0_00BA()
{
    if (skip_test_E0_00BA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xADDC);
    WriteRegisterWord(RegisterType::SP, 0x9038);
    WriteRegisterByte(RegisterType::A, 0xA7);
    WriteRegisterByte(RegisterType::B, 0xBB);
    WriteRegisterByte(RegisterType::C, 0x41);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0x26);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x1F);
    WriteRegisterByte(RegisterType::L, 0xDD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9A, 0x00);
    WriteMemory(0xADDD, 0x9A);
    WriteMemory(0xADDC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA7);
    CheckRegisterByte(RegisterType::B, 0xBB);
    CheckRegisterByte(RegisterType::C, 0x41);
    CheckRegisterByte(RegisterType::D, 0xCE);
    CheckRegisterByte(RegisterType::E, 0x26);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x1F);
    CheckRegisterByte(RegisterType::L, 0xDD);
    CheckRegisterWord(RegisterType::PC, 0xADDE);
    CheckRegisterWord(RegisterType::SP, 0x9038);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xADDC, 0xE0);
    CheckMemory(0xADDD, 0x9A);
    CheckMemory(0xFF9A, 0xA7);
}

void test_E0_00BB()
{
    if (skip_test_E0_00BB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBD98);
    WriteRegisterWord(RegisterType::SP, 0x2285);
    WriteRegisterByte(RegisterType::A, 0x02);
    WriteRegisterByte(RegisterType::B, 0x3E);
    WriteRegisterByte(RegisterType::C, 0xB8);
    WriteRegisterByte(RegisterType::D, 0x5E);
    WriteRegisterByte(RegisterType::E, 0x6C);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0xA9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9E, 0x00);
    WriteMemory(0xBD99, 0x9E);
    WriteMemory(0xBD98, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x02);
    CheckRegisterByte(RegisterType::B, 0x3E);
    CheckRegisterByte(RegisterType::C, 0xB8);
    CheckRegisterByte(RegisterType::D, 0x5E);
    CheckRegisterByte(RegisterType::E, 0x6C);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0xA9);
    CheckRegisterWord(RegisterType::PC, 0xBD9A);
    CheckRegisterWord(RegisterType::SP, 0x2285);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBD98, 0xE0);
    CheckMemory(0xBD99, 0x9E);
    CheckMemory(0xFF9E, 0x02);
}

void test_E0_00BC()
{
    if (skip_test_E0_00BC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3948);
    WriteRegisterWord(RegisterType::SP, 0xD437);
    WriteRegisterByte(RegisterType::A, 0xFB);
    WriteRegisterByte(RegisterType::B, 0x1D);
    WriteRegisterByte(RegisterType::C, 0x3D);
    WriteRegisterByte(RegisterType::D, 0xE6);
    WriteRegisterByte(RegisterType::E, 0x47);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x5A);
    WriteRegisterByte(RegisterType::L, 0xF0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3A, 0x00);
    WriteMemory(0x3949, 0x3A);
    WriteMemory(0x3948, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFB);
    CheckRegisterByte(RegisterType::B, 0x1D);
    CheckRegisterByte(RegisterType::C, 0x3D);
    CheckRegisterByte(RegisterType::D, 0xE6);
    CheckRegisterByte(RegisterType::E, 0x47);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x5A);
    CheckRegisterByte(RegisterType::L, 0xF0);
    CheckRegisterWord(RegisterType::PC, 0x394A);
    CheckRegisterWord(RegisterType::SP, 0xD437);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3948, 0xE0);
    CheckMemory(0x3949, 0x3A);
    CheckMemory(0xFF3A, 0xFB);
}

void test_E0_00BD()
{
    if (skip_test_E0_00BD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1F36);
    WriteRegisterWord(RegisterType::SP, 0xC8B7);
    WriteRegisterByte(RegisterType::A, 0x0C);
    WriteRegisterByte(RegisterType::B, 0xA5);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0x05);
    WriteRegisterByte(RegisterType::E, 0x52);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x91);
    WriteRegisterByte(RegisterType::L, 0x1D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF02, 0x00);
    WriteMemory(0x1F37, 0x02);
    WriteMemory(0x1F36, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0C);
    CheckRegisterByte(RegisterType::B, 0xA5);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0x05);
    CheckRegisterByte(RegisterType::E, 0x52);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x91);
    CheckRegisterByte(RegisterType::L, 0x1D);
    CheckRegisterWord(RegisterType::PC, 0x1F38);
    CheckRegisterWord(RegisterType::SP, 0xC8B7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1F36, 0xE0);
    CheckMemory(0x1F37, 0x02);
    CheckMemory(0xFF02, 0x0C);
}

void test_E0_00BE()
{
    if (skip_test_E0_00BE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFE8D);
    WriteRegisterWord(RegisterType::SP, 0x96CC);
    WriteRegisterByte(RegisterType::A, 0x62);
    WriteRegisterByte(RegisterType::B, 0xA6);
    WriteRegisterByte(RegisterType::C, 0x8B);
    WriteRegisterByte(RegisterType::D, 0xD1);
    WriteRegisterByte(RegisterType::E, 0x6C);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x16);
    WriteRegisterByte(RegisterType::L, 0x32);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAB, 0x00);
    WriteMemory(0xFE8E, 0xAB);
    WriteMemory(0xFE8D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x62);
    CheckRegisterByte(RegisterType::B, 0xA6);
    CheckRegisterByte(RegisterType::C, 0x8B);
    CheckRegisterByte(RegisterType::D, 0xD1);
    CheckRegisterByte(RegisterType::E, 0x6C);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x16);
    CheckRegisterByte(RegisterType::L, 0x32);
    CheckRegisterWord(RegisterType::PC, 0xFE8F);
    CheckRegisterWord(RegisterType::SP, 0x96CC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFE8D, 0xE0);
    CheckMemory(0xFE8E, 0xAB);
    CheckMemory(0xFFAB, 0x62);
}

void test_E0_00BF()
{
    if (skip_test_E0_00BF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2B29);
    WriteRegisterWord(RegisterType::SP, 0xABC9);
    WriteRegisterByte(RegisterType::A, 0x29);
    WriteRegisterByte(RegisterType::B, 0x75);
    WriteRegisterByte(RegisterType::C, 0xA8);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0x9F);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x29);
    WriteRegisterByte(RegisterType::L, 0x81);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF18, 0x00);
    WriteMemory(0x2B2A, 0x18);
    WriteMemory(0x2B29, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x29);
    CheckRegisterByte(RegisterType::B, 0x75);
    CheckRegisterByte(RegisterType::C, 0xA8);
    CheckRegisterByte(RegisterType::D, 0xA9);
    CheckRegisterByte(RegisterType::E, 0x9F);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x29);
    CheckRegisterByte(RegisterType::L, 0x81);
    CheckRegisterWord(RegisterType::PC, 0x2B2B);
    CheckRegisterWord(RegisterType::SP, 0xABC9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2B29, 0xE0);
    CheckMemory(0x2B2A, 0x18);
    CheckMemory(0xFF18, 0x29);
}

void test_E0_00C0()
{
    if (skip_test_E0_00C0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8DA5);
    WriteRegisterWord(RegisterType::SP, 0x91C6);
    WriteRegisterByte(RegisterType::A, 0xAD);
    WriteRegisterByte(RegisterType::B, 0x78);
    WriteRegisterByte(RegisterType::C, 0x02);
    WriteRegisterByte(RegisterType::D, 0xBD);
    WriteRegisterByte(RegisterType::E, 0x1B);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x2E);
    WriteRegisterByte(RegisterType::L, 0x0B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF32, 0x00);
    WriteMemory(0x8DA6, 0x32);
    WriteMemory(0x8DA5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAD);
    CheckRegisterByte(RegisterType::B, 0x78);
    CheckRegisterByte(RegisterType::C, 0x02);
    CheckRegisterByte(RegisterType::D, 0xBD);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x2E);
    CheckRegisterByte(RegisterType::L, 0x0B);
    CheckRegisterWord(RegisterType::PC, 0x8DA7);
    CheckRegisterWord(RegisterType::SP, 0x91C6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8DA5, 0xE0);
    CheckMemory(0x8DA6, 0x32);
    CheckMemory(0xFF32, 0xAD);
}

void test_E0_00C1()
{
    if (skip_test_E0_00C1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x25E1);
    WriteRegisterWord(RegisterType::SP, 0x5F36);
    WriteRegisterByte(RegisterType::A, 0x57);
    WriteRegisterByte(RegisterType::B, 0xCA);
    WriteRegisterByte(RegisterType::C, 0x40);
    WriteRegisterByte(RegisterType::D, 0x1A);
    WriteRegisterByte(RegisterType::E, 0x98);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x2C);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF07, 0x00);
    WriteMemory(0x25E2, 0x07);
    WriteMemory(0x25E1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x57);
    CheckRegisterByte(RegisterType::B, 0xCA);
    CheckRegisterByte(RegisterType::C, 0x40);
    CheckRegisterByte(RegisterType::D, 0x1A);
    CheckRegisterByte(RegisterType::E, 0x98);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x2C);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0x25E3);
    CheckRegisterWord(RegisterType::SP, 0x5F36);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x25E1, 0xE0);
    CheckMemory(0x25E2, 0x07);
    CheckMemory(0xFF07, 0x57);
}

void test_E0_00C2()
{
    if (skip_test_E0_00C2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6C47);
    WriteRegisterWord(RegisterType::SP, 0x7522);
    WriteRegisterByte(RegisterType::A, 0x9D);
    WriteRegisterByte(RegisterType::B, 0x24);
    WriteRegisterByte(RegisterType::C, 0x9A);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0xB9);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0x38);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE9, 0x00);
    WriteMemory(0x6C48, 0xE9);
    WriteMemory(0x6C47, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9D);
    CheckRegisterByte(RegisterType::B, 0x24);
    CheckRegisterByte(RegisterType::C, 0x9A);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0xB9);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0x38);
    CheckRegisterWord(RegisterType::PC, 0x6C49);
    CheckRegisterWord(RegisterType::SP, 0x7522);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6C47, 0xE0);
    CheckMemory(0x6C48, 0xE9);
    CheckMemory(0xFFE9, 0x9D);
}

void test_E0_00C3()
{
    if (skip_test_E0_00C3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x54B6);
    WriteRegisterWord(RegisterType::SP, 0xDFFC);
    WriteRegisterByte(RegisterType::A, 0xAF);
    WriteRegisterByte(RegisterType::B, 0x18);
    WriteRegisterByte(RegisterType::C, 0x5B);
    WriteRegisterByte(RegisterType::D, 0x1D);
    WriteRegisterByte(RegisterType::E, 0x04);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xB8);
    WriteRegisterByte(RegisterType::L, 0x61);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB3, 0x00);
    WriteMemory(0x54B7, 0xB3);
    WriteMemory(0x54B6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAF);
    CheckRegisterByte(RegisterType::B, 0x18);
    CheckRegisterByte(RegisterType::C, 0x5B);
    CheckRegisterByte(RegisterType::D, 0x1D);
    CheckRegisterByte(RegisterType::E, 0x04);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xB8);
    CheckRegisterByte(RegisterType::L, 0x61);
    CheckRegisterWord(RegisterType::PC, 0x54B8);
    CheckRegisterWord(RegisterType::SP, 0xDFFC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x54B6, 0xE0);
    CheckMemory(0x54B7, 0xB3);
    CheckMemory(0xFFB3, 0xAF);
}

void test_E0_00C4()
{
    if (skip_test_E0_00C4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5FFA);
    WriteRegisterWord(RegisterType::SP, 0x1F66);
    WriteRegisterByte(RegisterType::A, 0xE7);
    WriteRegisterByte(RegisterType::B, 0x0B);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0x94);
    WriteRegisterByte(RegisterType::E, 0xA1);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0x34);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF57, 0x00);
    WriteMemory(0x5FFB, 0x57);
    WriteMemory(0x5FFA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE7);
    CheckRegisterByte(RegisterType::B, 0x0B);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0x94);
    CheckRegisterByte(RegisterType::E, 0xA1);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0x34);
    CheckRegisterWord(RegisterType::PC, 0x5FFC);
    CheckRegisterWord(RegisterType::SP, 0x1F66);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5FFA, 0xE0);
    CheckMemory(0x5FFB, 0x57);
    CheckMemory(0xFF57, 0xE7);
}

void test_E0_00C5()
{
    if (skip_test_E0_00C5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD61C);
    WriteRegisterWord(RegisterType::SP, 0x2038);
    WriteRegisterByte(RegisterType::A, 0xE8);
    WriteRegisterByte(RegisterType::B, 0x61);
    WriteRegisterByte(RegisterType::C, 0x45);
    WriteRegisterByte(RegisterType::D, 0xEF);
    WriteRegisterByte(RegisterType::E, 0x91);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x95);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5D, 0x00);
    WriteMemory(0xD61D, 0x5D);
    WriteMemory(0xD61C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE8);
    CheckRegisterByte(RegisterType::B, 0x61);
    CheckRegisterByte(RegisterType::C, 0x45);
    CheckRegisterByte(RegisterType::D, 0xEF);
    CheckRegisterByte(RegisterType::E, 0x91);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x95);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0xD61E);
    CheckRegisterWord(RegisterType::SP, 0x2038);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD61C, 0xE0);
    CheckMemory(0xD61D, 0x5D);
    CheckMemory(0xFF5D, 0xE8);
}

void test_E0_00C6()
{
    if (skip_test_E0_00C6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x68DC);
    WriteRegisterWord(RegisterType::SP, 0xC078);
    WriteRegisterByte(RegisterType::A, 0xF9);
    WriteRegisterByte(RegisterType::B, 0x18);
    WriteRegisterByte(RegisterType::C, 0x62);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0x14);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x3F);
    WriteRegisterByte(RegisterType::L, 0x22);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF87, 0x00);
    WriteMemory(0x68DD, 0x87);
    WriteMemory(0x68DC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF9);
    CheckRegisterByte(RegisterType::B, 0x18);
    CheckRegisterByte(RegisterType::C, 0x62);
    CheckRegisterByte(RegisterType::D, 0x74);
    CheckRegisterByte(RegisterType::E, 0x14);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x3F);
    CheckRegisterByte(RegisterType::L, 0x22);
    CheckRegisterWord(RegisterType::PC, 0x68DE);
    CheckRegisterWord(RegisterType::SP, 0xC078);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x68DC, 0xE0);
    CheckMemory(0x68DD, 0x87);
    CheckMemory(0xFF87, 0xF9);
}

void test_E0_00C7()
{
    if (skip_test_E0_00C7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFEEF);
    WriteRegisterWord(RegisterType::SP, 0x7B19);
    WriteRegisterByte(RegisterType::A, 0x8E);
    WriteRegisterByte(RegisterType::B, 0x03);
    WriteRegisterByte(RegisterType::C, 0x51);
    WriteRegisterByte(RegisterType::D, 0xED);
    WriteRegisterByte(RegisterType::E, 0x69);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF35, 0x00);
    WriteMemory(0xFEF0, 0x35);
    WriteMemory(0xFEEF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8E);
    CheckRegisterByte(RegisterType::B, 0x03);
    CheckRegisterByte(RegisterType::C, 0x51);
    CheckRegisterByte(RegisterType::D, 0xED);
    CheckRegisterByte(RegisterType::E, 0x69);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0xFEF1);
    CheckRegisterWord(RegisterType::SP, 0x7B19);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFEEF, 0xE0);
    CheckMemory(0xFEF0, 0x35);
    CheckMemory(0xFF35, 0x8E);
}

void test_E0_00C8()
{
    if (skip_test_E0_00C8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC3CF);
    WriteRegisterWord(RegisterType::SP, 0x02D7);
    WriteRegisterByte(RegisterType::A, 0xF3);
    WriteRegisterByte(RegisterType::B, 0x29);
    WriteRegisterByte(RegisterType::C, 0x7C);
    WriteRegisterByte(RegisterType::D, 0x36);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xB2);
    WriteRegisterByte(RegisterType::L, 0xAB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF03, 0x00);
    WriteMemory(0xC3D0, 0x03);
    WriteMemory(0xC3CF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF3);
    CheckRegisterByte(RegisterType::B, 0x29);
    CheckRegisterByte(RegisterType::C, 0x7C);
    CheckRegisterByte(RegisterType::D, 0x36);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xB2);
    CheckRegisterByte(RegisterType::L, 0xAB);
    CheckRegisterWord(RegisterType::PC, 0xC3D1);
    CheckRegisterWord(RegisterType::SP, 0x02D7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC3CF, 0xE0);
    CheckMemory(0xC3D0, 0x03);
    CheckMemory(0xFF03, 0xF3);
}

void test_E0_00C9()
{
    if (skip_test_E0_00C9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEE56);
    WriteRegisterWord(RegisterType::SP, 0xFC25);
    WriteRegisterByte(RegisterType::A, 0x15);
    WriteRegisterByte(RegisterType::B, 0x26);
    WriteRegisterByte(RegisterType::C, 0x36);
    WriteRegisterByte(RegisterType::D, 0x29);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0xFC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9C, 0x00);
    WriteMemory(0xEE57, 0x9C);
    WriteMemory(0xEE56, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x15);
    CheckRegisterByte(RegisterType::B, 0x26);
    CheckRegisterByte(RegisterType::C, 0x36);
    CheckRegisterByte(RegisterType::D, 0x29);
    CheckRegisterByte(RegisterType::E, 0xC5);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0xFC);
    CheckRegisterWord(RegisterType::PC, 0xEE58);
    CheckRegisterWord(RegisterType::SP, 0xFC25);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xEE56, 0xE0);
    CheckMemory(0xEE57, 0x9C);
    CheckMemory(0xFF9C, 0x15);
}

void test_E0_00CA()
{
    if (skip_test_E0_00CA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCAB5);
    WriteRegisterWord(RegisterType::SP, 0xF345);
    WriteRegisterByte(RegisterType::A, 0x4C);
    WriteRegisterByte(RegisterType::B, 0xB9);
    WriteRegisterByte(RegisterType::C, 0xB2);
    WriteRegisterByte(RegisterType::D, 0x79);
    WriteRegisterByte(RegisterType::E, 0x2C);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0x6D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF42, 0x00);
    WriteMemory(0xCAB6, 0x42);
    WriteMemory(0xCAB5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4C);
    CheckRegisterByte(RegisterType::B, 0xB9);
    CheckRegisterByte(RegisterType::C, 0xB2);
    CheckRegisterByte(RegisterType::D, 0x79);
    CheckRegisterByte(RegisterType::E, 0x2C);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0x6D);
    CheckRegisterWord(RegisterType::PC, 0xCAB7);
    CheckRegisterWord(RegisterType::SP, 0xF345);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCAB5, 0xE0);
    CheckMemory(0xCAB6, 0x42);
    CheckMemory(0xFF42, 0x4C);
}

void test_E0_00CB()
{
    if (skip_test_E0_00CB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3CED);
    WriteRegisterWord(RegisterType::SP, 0x3AAC);
    WriteRegisterByte(RegisterType::A, 0x15);
    WriteRegisterByte(RegisterType::B, 0xBF);
    WriteRegisterByte(RegisterType::C, 0xF8);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0xAD);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x9F);
    WriteRegisterByte(RegisterType::L, 0xFF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB2, 0x00);
    WriteMemory(0x3CEE, 0xB2);
    WriteMemory(0x3CED, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x15);
    CheckRegisterByte(RegisterType::B, 0xBF);
    CheckRegisterByte(RegisterType::C, 0xF8);
    CheckRegisterByte(RegisterType::D, 0x76);
    CheckRegisterByte(RegisterType::E, 0xAD);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x9F);
    CheckRegisterByte(RegisterType::L, 0xFF);
    CheckRegisterWord(RegisterType::PC, 0x3CEF);
    CheckRegisterWord(RegisterType::SP, 0x3AAC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3CED, 0xE0);
    CheckMemory(0x3CEE, 0xB2);
    CheckMemory(0xFFB2, 0x15);
}

void test_E0_00CC()
{
    if (skip_test_E0_00CC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFA14);
    WriteRegisterWord(RegisterType::SP, 0xA67D);
    WriteRegisterByte(RegisterType::A, 0x4F);
    WriteRegisterByte(RegisterType::B, 0x82);
    WriteRegisterByte(RegisterType::C, 0x27);
    WriteRegisterByte(RegisterType::D, 0xE3);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x70);
    WriteRegisterByte(RegisterType::L, 0x19);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA6, 0x00);
    WriteMemory(0xFA15, 0xA6);
    WriteMemory(0xFA14, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4F);
    CheckRegisterByte(RegisterType::B, 0x82);
    CheckRegisterByte(RegisterType::C, 0x27);
    CheckRegisterByte(RegisterType::D, 0xE3);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x70);
    CheckRegisterByte(RegisterType::L, 0x19);
    CheckRegisterWord(RegisterType::PC, 0xFA16);
    CheckRegisterWord(RegisterType::SP, 0xA67D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFA14, 0xE0);
    CheckMemory(0xFA15, 0xA6);
    CheckMemory(0xFFA6, 0x4F);
}

void test_E0_00CD()
{
    if (skip_test_E0_00CD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB250);
    WriteRegisterWord(RegisterType::SP, 0xE8AD);
    WriteRegisterByte(RegisterType::A, 0x29);
    WriteRegisterByte(RegisterType::B, 0xB5);
    WriteRegisterByte(RegisterType::C, 0x0B);
    WriteRegisterByte(RegisterType::D, 0xD9);
    WriteRegisterByte(RegisterType::E, 0x20);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xEA);
    WriteRegisterByte(RegisterType::L, 0x76);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6D, 0x00);
    WriteMemory(0xB251, 0x6D);
    WriteMemory(0xB250, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x29);
    CheckRegisterByte(RegisterType::B, 0xB5);
    CheckRegisterByte(RegisterType::C, 0x0B);
    CheckRegisterByte(RegisterType::D, 0xD9);
    CheckRegisterByte(RegisterType::E, 0x20);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xEA);
    CheckRegisterByte(RegisterType::L, 0x76);
    CheckRegisterWord(RegisterType::PC, 0xB252);
    CheckRegisterWord(RegisterType::SP, 0xE8AD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB250, 0xE0);
    CheckMemory(0xB251, 0x6D);
    CheckMemory(0xFF6D, 0x29);
}

void test_E0_00CE()
{
    if (skip_test_E0_00CE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF570);
    WriteRegisterWord(RegisterType::SP, 0xA21A);
    WriteRegisterByte(RegisterType::A, 0x81);
    WriteRegisterByte(RegisterType::B, 0xBB);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0xA7);
    WriteRegisterByte(RegisterType::E, 0x48);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x3B);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF98, 0x00);
    WriteMemory(0xF571, 0x98);
    WriteMemory(0xF570, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x81);
    CheckRegisterByte(RegisterType::B, 0xBB);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0xA7);
    CheckRegisterByte(RegisterType::E, 0x48);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x3B);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0xF572);
    CheckRegisterWord(RegisterType::SP, 0xA21A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF570, 0xE0);
    CheckMemory(0xF571, 0x98);
    CheckMemory(0xFF98, 0x81);
}

void test_E0_00CF()
{
    if (skip_test_E0_00CF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x10D7);
    WriteRegisterWord(RegisterType::SP, 0x08DD);
    WriteRegisterByte(RegisterType::A, 0x89);
    WriteRegisterByte(RegisterType::B, 0xDE);
    WriteRegisterByte(RegisterType::C, 0x0D);
    WriteRegisterByte(RegisterType::D, 0x89);
    WriteRegisterByte(RegisterType::E, 0x25);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0xE7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8A, 0x00);
    WriteMemory(0x10D8, 0x8A);
    WriteMemory(0x10D7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x89);
    CheckRegisterByte(RegisterType::B, 0xDE);
    CheckRegisterByte(RegisterType::C, 0x0D);
    CheckRegisterByte(RegisterType::D, 0x89);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0xE7);
    CheckRegisterWord(RegisterType::PC, 0x10D9);
    CheckRegisterWord(RegisterType::SP, 0x08DD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x10D7, 0xE0);
    CheckMemory(0x10D8, 0x8A);
    CheckMemory(0xFF8A, 0x89);
}

void test_E0_00D0()
{
    if (skip_test_E0_00D0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x242C);
    WriteRegisterWord(RegisterType::SP, 0x3CFB);
    WriteRegisterByte(RegisterType::A, 0x88);
    WriteRegisterByte(RegisterType::B, 0x08);
    WriteRegisterByte(RegisterType::C, 0xE0);
    WriteRegisterByte(RegisterType::D, 0x1B);
    WriteRegisterByte(RegisterType::E, 0xB2);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xD8);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF09, 0x00);
    WriteMemory(0x242D, 0x09);
    WriteMemory(0x242C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x88);
    CheckRegisterByte(RegisterType::B, 0x08);
    CheckRegisterByte(RegisterType::C, 0xE0);
    CheckRegisterByte(RegisterType::D, 0x1B);
    CheckRegisterByte(RegisterType::E, 0xB2);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xD8);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0x242E);
    CheckRegisterWord(RegisterType::SP, 0x3CFB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x242C, 0xE0);
    CheckMemory(0x242D, 0x09);
    CheckMemory(0xFF09, 0x88);
}

void test_E0_00D1()
{
    if (skip_test_E0_00D1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF6E0);
    WriteRegisterWord(RegisterType::SP, 0xD4BE);
    WriteRegisterByte(RegisterType::A, 0xDF);
    WriteRegisterByte(RegisterType::B, 0x77);
    WriteRegisterByte(RegisterType::C, 0xC0);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0xC6);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x6E);
    WriteRegisterByte(RegisterType::L, 0x7C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF58, 0x00);
    WriteMemory(0xF6E1, 0x58);
    WriteMemory(0xF6E0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDF);
    CheckRegisterByte(RegisterType::B, 0x77);
    CheckRegisterByte(RegisterType::C, 0xC0);
    CheckRegisterByte(RegisterType::D, 0xAB);
    CheckRegisterByte(RegisterType::E, 0xC6);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x6E);
    CheckRegisterByte(RegisterType::L, 0x7C);
    CheckRegisterWord(RegisterType::PC, 0xF6E2);
    CheckRegisterWord(RegisterType::SP, 0xD4BE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF6E0, 0xE0);
    CheckMemory(0xF6E1, 0x58);
    CheckMemory(0xFF58, 0xDF);
}

void test_E0_00D2()
{
    if (skip_test_E0_00D2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x50F5);
    WriteRegisterWord(RegisterType::SP, 0xBCE6);
    WriteRegisterByte(RegisterType::A, 0x9A);
    WriteRegisterByte(RegisterType::B, 0x53);
    WriteRegisterByte(RegisterType::C, 0x7D);
    WriteRegisterByte(RegisterType::D, 0x52);
    WriteRegisterByte(RegisterType::E, 0x8C);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x63);
    WriteRegisterByte(RegisterType::L, 0x0B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAB, 0x00);
    WriteMemory(0x50F6, 0xAB);
    WriteMemory(0x50F5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9A);
    CheckRegisterByte(RegisterType::B, 0x53);
    CheckRegisterByte(RegisterType::C, 0x7D);
    CheckRegisterByte(RegisterType::D, 0x52);
    CheckRegisterByte(RegisterType::E, 0x8C);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x63);
    CheckRegisterByte(RegisterType::L, 0x0B);
    CheckRegisterWord(RegisterType::PC, 0x50F7);
    CheckRegisterWord(RegisterType::SP, 0xBCE6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x50F5, 0xE0);
    CheckMemory(0x50F6, 0xAB);
    CheckMemory(0xFFAB, 0x9A);
}

void test_E0_00D3()
{
    if (skip_test_E0_00D3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE0F5);
    WriteRegisterWord(RegisterType::SP, 0x97E2);
    WriteRegisterByte(RegisterType::A, 0x9F);
    WriteRegisterByte(RegisterType::B, 0x32);
    WriteRegisterByte(RegisterType::C, 0x00);
    WriteRegisterByte(RegisterType::D, 0xF7);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0x41);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFED, 0x00);
    WriteMemory(0xE0F6, 0xED);
    WriteMemory(0xE0F5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9F);
    CheckRegisterByte(RegisterType::B, 0x32);
    CheckRegisterByte(RegisterType::C, 0x00);
    CheckRegisterByte(RegisterType::D, 0xF7);
    CheckRegisterByte(RegisterType::E, 0xC7);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0x41);
    CheckRegisterWord(RegisterType::PC, 0xE0F7);
    CheckRegisterWord(RegisterType::SP, 0x97E2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE0F5, 0xE0);
    CheckMemory(0xE0F6, 0xED);
    CheckMemory(0xFFED, 0x9F);
}

void test_E0_00D4()
{
    if (skip_test_E0_00D4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD97C);
    WriteRegisterWord(RegisterType::SP, 0x57AD);
    WriteRegisterByte(RegisterType::A, 0x7C);
    WriteRegisterByte(RegisterType::B, 0x16);
    WriteRegisterByte(RegisterType::C, 0xE0);
    WriteRegisterByte(RegisterType::D, 0xFC);
    WriteRegisterByte(RegisterType::E, 0xF1);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0x3A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF8A, 0x00);
    WriteMemory(0xD97D, 0x8A);
    WriteMemory(0xD97C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7C);
    CheckRegisterByte(RegisterType::B, 0x16);
    CheckRegisterByte(RegisterType::C, 0xE0);
    CheckRegisterByte(RegisterType::D, 0xFC);
    CheckRegisterByte(RegisterType::E, 0xF1);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0x3A);
    CheckRegisterWord(RegisterType::PC, 0xD97E);
    CheckRegisterWord(RegisterType::SP, 0x57AD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD97C, 0xE0);
    CheckMemory(0xD97D, 0x8A);
    CheckMemory(0xFF8A, 0x7C);
}

void test_E0_00D5()
{
    if (skip_test_E0_00D5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x52BE);
    WriteRegisterWord(RegisterType::SP, 0xA8AC);
    WriteRegisterByte(RegisterType::A, 0xE6);
    WriteRegisterByte(RegisterType::B, 0x1B);
    WriteRegisterByte(RegisterType::C, 0x76);
    WriteRegisterByte(RegisterType::D, 0x7E);
    WriteRegisterByte(RegisterType::E, 0xC3);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xB7);
    WriteRegisterByte(RegisterType::L, 0x73);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9A, 0x00);
    WriteMemory(0x52BF, 0x9A);
    WriteMemory(0x52BE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE6);
    CheckRegisterByte(RegisterType::B, 0x1B);
    CheckRegisterByte(RegisterType::C, 0x76);
    CheckRegisterByte(RegisterType::D, 0x7E);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xB7);
    CheckRegisterByte(RegisterType::L, 0x73);
    CheckRegisterWord(RegisterType::PC, 0x52C0);
    CheckRegisterWord(RegisterType::SP, 0xA8AC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x52BE, 0xE0);
    CheckMemory(0x52BF, 0x9A);
    CheckMemory(0xFF9A, 0xE6);
}

void test_E0_00D6()
{
    if (skip_test_E0_00D6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1F2D);
    WriteRegisterWord(RegisterType::SP, 0x3074);
    WriteRegisterByte(RegisterType::A, 0x66);
    WriteRegisterByte(RegisterType::B, 0x59);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0xC8);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0xB8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF23, 0x00);
    WriteMemory(0x1F2E, 0x23);
    WriteMemory(0x1F2D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x66);
    CheckRegisterByte(RegisterType::B, 0x59);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0xC8);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0xB8);
    CheckRegisterWord(RegisterType::PC, 0x1F2F);
    CheckRegisterWord(RegisterType::SP, 0x3074);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1F2D, 0xE0);
    CheckMemory(0x1F2E, 0x23);
    CheckMemory(0xFF23, 0x66);
}

void test_E0_00D7()
{
    if (skip_test_E0_00D7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE582);
    WriteRegisterWord(RegisterType::SP, 0x8B68);
    WriteRegisterByte(RegisterType::A, 0x11);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0x3F);
    WriteRegisterByte(RegisterType::D, 0x78);
    WriteRegisterByte(RegisterType::E, 0xFB);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x1C);
    WriteRegisterByte(RegisterType::L, 0x54);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8F, 0x00);
    WriteMemory(0xE583, 0x8F);
    WriteMemory(0xE582, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x11);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0x3F);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0xFB);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x1C);
    CheckRegisterByte(RegisterType::L, 0x54);
    CheckRegisterWord(RegisterType::PC, 0xE584);
    CheckRegisterWord(RegisterType::SP, 0x8B68);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE582, 0xE0);
    CheckMemory(0xE583, 0x8F);
    CheckMemory(0xFF8F, 0x11);
}

void test_E0_00D8()
{
    if (skip_test_E0_00D8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x60F3);
    WriteRegisterWord(RegisterType::SP, 0x54CC);
    WriteRegisterByte(RegisterType::A, 0x30);
    WriteRegisterByte(RegisterType::B, 0xEF);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0x9F);
    WriteRegisterByte(RegisterType::E, 0x47);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xA8);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAB, 0x00);
    WriteMemory(0x60F4, 0xAB);
    WriteMemory(0x60F3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x30);
    CheckRegisterByte(RegisterType::B, 0xEF);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0x47);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xA8);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0x60F5);
    CheckRegisterWord(RegisterType::SP, 0x54CC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x60F3, 0xE0);
    CheckMemory(0x60F4, 0xAB);
    CheckMemory(0xFFAB, 0x30);
}

void test_E0_00D9()
{
    if (skip_test_E0_00D9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7C19);
    WriteRegisterWord(RegisterType::SP, 0x66F1);
    WriteRegisterByte(RegisterType::A, 0xEF);
    WriteRegisterByte(RegisterType::B, 0x64);
    WriteRegisterByte(RegisterType::C, 0xD7);
    WriteRegisterByte(RegisterType::D, 0xF9);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0x45);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2F, 0x00);
    WriteMemory(0x7C1A, 0x2F);
    WriteMemory(0x7C19, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEF);
    CheckRegisterByte(RegisterType::B, 0x64);
    CheckRegisterByte(RegisterType::C, 0xD7);
    CheckRegisterByte(RegisterType::D, 0xF9);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0x45);
    CheckRegisterWord(RegisterType::PC, 0x7C1B);
    CheckRegisterWord(RegisterType::SP, 0x66F1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7C19, 0xE0);
    CheckMemory(0x7C1A, 0x2F);
    CheckMemory(0xFF2F, 0xEF);
}

void test_E0_00DA()
{
    if (skip_test_E0_00DA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3473);
    WriteRegisterWord(RegisterType::SP, 0x81CE);
    WriteRegisterByte(RegisterType::A, 0xCE);
    WriteRegisterByte(RegisterType::B, 0x43);
    WriteRegisterByte(RegisterType::C, 0x8F);
    WriteRegisterByte(RegisterType::D, 0x8F);
    WriteRegisterByte(RegisterType::E, 0x49);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0x69);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF63, 0x00);
    WriteMemory(0x3474, 0x63);
    WriteMemory(0x3473, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCE);
    CheckRegisterByte(RegisterType::B, 0x43);
    CheckRegisterByte(RegisterType::C, 0x8F);
    CheckRegisterByte(RegisterType::D, 0x8F);
    CheckRegisterByte(RegisterType::E, 0x49);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0x69);
    CheckRegisterWord(RegisterType::PC, 0x3475);
    CheckRegisterWord(RegisterType::SP, 0x81CE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3473, 0xE0);
    CheckMemory(0x3474, 0x63);
    CheckMemory(0xFF63, 0xCE);
}

void test_E0_00DB()
{
    if (skip_test_E0_00DB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBA8D);
    WriteRegisterWord(RegisterType::SP, 0x33A9);
    WriteRegisterByte(RegisterType::A, 0xCB);
    WriteRegisterByte(RegisterType::B, 0x73);
    WriteRegisterByte(RegisterType::C, 0xC8);
    WriteRegisterByte(RegisterType::D, 0x78);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC4);
    WriteRegisterByte(RegisterType::L, 0xAE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF27, 0x00);
    WriteMemory(0xBA8E, 0x27);
    WriteMemory(0xBA8D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCB);
    CheckRegisterByte(RegisterType::B, 0x73);
    CheckRegisterByte(RegisterType::C, 0xC8);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC4);
    CheckRegisterByte(RegisterType::L, 0xAE);
    CheckRegisterWord(RegisterType::PC, 0xBA8F);
    CheckRegisterWord(RegisterType::SP, 0x33A9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBA8D, 0xE0);
    CheckMemory(0xBA8E, 0x27);
    CheckMemory(0xFF27, 0xCB);
}

void test_E0_00DC()
{
    if (skip_test_E0_00DC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEF51);
    WriteRegisterWord(RegisterType::SP, 0x386B);
    WriteRegisterByte(RegisterType::A, 0xF5);
    WriteRegisterByte(RegisterType::B, 0xDE);
    WriteRegisterByte(RegisterType::C, 0xF4);
    WriteRegisterByte(RegisterType::D, 0x5F);
    WriteRegisterByte(RegisterType::E, 0xAA);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xEA);
    WriteRegisterByte(RegisterType::L, 0xD7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF63, 0x00);
    WriteMemory(0xEF52, 0x63);
    WriteMemory(0xEF51, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF5);
    CheckRegisterByte(RegisterType::B, 0xDE);
    CheckRegisterByte(RegisterType::C, 0xF4);
    CheckRegisterByte(RegisterType::D, 0x5F);
    CheckRegisterByte(RegisterType::E, 0xAA);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xEA);
    CheckRegisterByte(RegisterType::L, 0xD7);
    CheckRegisterWord(RegisterType::PC, 0xEF53);
    CheckRegisterWord(RegisterType::SP, 0x386B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEF51, 0xE0);
    CheckMemory(0xEF52, 0x63);
    CheckMemory(0xFF63, 0xF5);
}

void test_E0_00DD()
{
    if (skip_test_E0_00DD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x62A1);
    WriteRegisterWord(RegisterType::SP, 0xC600);
    WriteRegisterByte(RegisterType::A, 0xB5);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0x12);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0x40);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xE4);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFEC, 0x00);
    WriteMemory(0x62A2, 0xEC);
    WriteMemory(0x62A1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB5);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0x12);
    CheckRegisterByte(RegisterType::D, 0xA9);
    CheckRegisterByte(RegisterType::E, 0x40);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xE4);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0x62A3);
    CheckRegisterWord(RegisterType::SP, 0xC600);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x62A1, 0xE0);
    CheckMemory(0x62A2, 0xEC);
    CheckMemory(0xFFEC, 0xB5);
}

void test_E0_00DE()
{
    if (skip_test_E0_00DE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB2D3);
    WriteRegisterWord(RegisterType::SP, 0xA3C8);
    WriteRegisterByte(RegisterType::A, 0xD8);
    WriteRegisterByte(RegisterType::B, 0x06);
    WriteRegisterByte(RegisterType::C, 0x3D);
    WriteRegisterByte(RegisterType::D, 0x91);
    WriteRegisterByte(RegisterType::E, 0x54);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xEF);
    WriteRegisterByte(RegisterType::L, 0x19);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF17, 0x00);
    WriteMemory(0xB2D4, 0x17);
    WriteMemory(0xB2D3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD8);
    CheckRegisterByte(RegisterType::B, 0x06);
    CheckRegisterByte(RegisterType::C, 0x3D);
    CheckRegisterByte(RegisterType::D, 0x91);
    CheckRegisterByte(RegisterType::E, 0x54);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xEF);
    CheckRegisterByte(RegisterType::L, 0x19);
    CheckRegisterWord(RegisterType::PC, 0xB2D5);
    CheckRegisterWord(RegisterType::SP, 0xA3C8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB2D3, 0xE0);
    CheckMemory(0xB2D4, 0x17);
    CheckMemory(0xFF17, 0xD8);
}

void test_E0_00DF()
{
    if (skip_test_E0_00DF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9FDE);
    WriteRegisterWord(RegisterType::SP, 0x763C);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0xE7);
    WriteRegisterByte(RegisterType::C, 0xE8);
    WriteRegisterByte(RegisterType::D, 0xF1);
    WriteRegisterByte(RegisterType::E, 0x54);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0x0D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC6, 0x00);
    WriteMemory(0x9FDF, 0xC6);
    WriteMemory(0x9FDE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0xE7);
    CheckRegisterByte(RegisterType::C, 0xE8);
    CheckRegisterByte(RegisterType::D, 0xF1);
    CheckRegisterByte(RegisterType::E, 0x54);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0x0D);
    CheckRegisterWord(RegisterType::PC, 0x9FE0);
    CheckRegisterWord(RegisterType::SP, 0x763C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9FDE, 0xE0);
    CheckMemory(0x9FDF, 0xC6);
    CheckMemory(0xFFC6, 0xCD);
}

void test_E0_00E0()
{
    if (skip_test_E0_00E0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3203);
    WriteRegisterWord(RegisterType::SP, 0x23DD);
    WriteRegisterByte(RegisterType::A, 0x2B);
    WriteRegisterByte(RegisterType::B, 0x2B);
    WriteRegisterByte(RegisterType::C, 0x33);
    WriteRegisterByte(RegisterType::D, 0x65);
    WriteRegisterByte(RegisterType::E, 0x8F);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x87);
    WriteRegisterByte(RegisterType::L, 0xA6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB0, 0x00);
    WriteMemory(0x3204, 0xB0);
    WriteMemory(0x3203, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2B);
    CheckRegisterByte(RegisterType::B, 0x2B);
    CheckRegisterByte(RegisterType::C, 0x33);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0x8F);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x87);
    CheckRegisterByte(RegisterType::L, 0xA6);
    CheckRegisterWord(RegisterType::PC, 0x3205);
    CheckRegisterWord(RegisterType::SP, 0x23DD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3203, 0xE0);
    CheckMemory(0x3204, 0xB0);
    CheckMemory(0xFFB0, 0x2B);
}

void test_E0_00E1()
{
    if (skip_test_E0_00E1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0EE5);
    WriteRegisterWord(RegisterType::SP, 0xA568);
    WriteRegisterByte(RegisterType::A, 0xB6);
    WriteRegisterByte(RegisterType::B, 0x8D);
    WriteRegisterByte(RegisterType::C, 0x55);
    WriteRegisterByte(RegisterType::D, 0x3F);
    WriteRegisterByte(RegisterType::E, 0x2E);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0x76);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA4, 0x00);
    WriteMemory(0x0EE6, 0xA4);
    WriteMemory(0x0EE5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB6);
    CheckRegisterByte(RegisterType::B, 0x8D);
    CheckRegisterByte(RegisterType::C, 0x55);
    CheckRegisterByte(RegisterType::D, 0x3F);
    CheckRegisterByte(RegisterType::E, 0x2E);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0x76);
    CheckRegisterWord(RegisterType::PC, 0x0EE7);
    CheckRegisterWord(RegisterType::SP, 0xA568);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0EE5, 0xE0);
    CheckMemory(0x0EE6, 0xA4);
    CheckMemory(0xFFA4, 0xB6);
}

void test_E0_00E2()
{
    if (skip_test_E0_00E2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB2D9);
    WriteRegisterWord(RegisterType::SP, 0xE117);
    WriteRegisterByte(RegisterType::A, 0x54);
    WriteRegisterByte(RegisterType::B, 0x47);
    WriteRegisterByte(RegisterType::C, 0xF4);
    WriteRegisterByte(RegisterType::D, 0x08);
    WriteRegisterByte(RegisterType::E, 0xCD);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x04);
    WriteRegisterByte(RegisterType::L, 0xED);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF09, 0x00);
    WriteMemory(0xB2DA, 0x09);
    WriteMemory(0xB2D9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x54);
    CheckRegisterByte(RegisterType::B, 0x47);
    CheckRegisterByte(RegisterType::C, 0xF4);
    CheckRegisterByte(RegisterType::D, 0x08);
    CheckRegisterByte(RegisterType::E, 0xCD);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x04);
    CheckRegisterByte(RegisterType::L, 0xED);
    CheckRegisterWord(RegisterType::PC, 0xB2DB);
    CheckRegisterWord(RegisterType::SP, 0xE117);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB2D9, 0xE0);
    CheckMemory(0xB2DA, 0x09);
    CheckMemory(0xFF09, 0x54);
}

void test_E0_00E3()
{
    if (skip_test_E0_00E3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4CB0);
    WriteRegisterWord(RegisterType::SP, 0x0E9F);
    WriteRegisterByte(RegisterType::A, 0x21);
    WriteRegisterByte(RegisterType::B, 0xC9);
    WriteRegisterByte(RegisterType::C, 0xF9);
    WriteRegisterByte(RegisterType::D, 0x51);
    WriteRegisterByte(RegisterType::E, 0xD3);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x24);
    WriteRegisterByte(RegisterType::L, 0x09);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFDB, 0x00);
    WriteMemory(0x4CB1, 0xDB);
    WriteMemory(0x4CB0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x21);
    CheckRegisterByte(RegisterType::B, 0xC9);
    CheckRegisterByte(RegisterType::C, 0xF9);
    CheckRegisterByte(RegisterType::D, 0x51);
    CheckRegisterByte(RegisterType::E, 0xD3);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x24);
    CheckRegisterByte(RegisterType::L, 0x09);
    CheckRegisterWord(RegisterType::PC, 0x4CB2);
    CheckRegisterWord(RegisterType::SP, 0x0E9F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4CB0, 0xE0);
    CheckMemory(0x4CB1, 0xDB);
    CheckMemory(0xFFDB, 0x21);
}

void test_E0_00E4()
{
    if (skip_test_E0_00E4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x90D5);
    WriteRegisterWord(RegisterType::SP, 0x8B83);
    WriteRegisterByte(RegisterType::A, 0x97);
    WriteRegisterByte(RegisterType::B, 0xE4);
    WriteRegisterByte(RegisterType::C, 0xD4);
    WriteRegisterByte(RegisterType::D, 0xCC);
    WriteRegisterByte(RegisterType::E, 0x4A);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x31);
    WriteRegisterByte(RegisterType::L, 0xE9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA9, 0x00);
    WriteMemory(0x90D6, 0xA9);
    WriteMemory(0x90D5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x97);
    CheckRegisterByte(RegisterType::B, 0xE4);
    CheckRegisterByte(RegisterType::C, 0xD4);
    CheckRegisterByte(RegisterType::D, 0xCC);
    CheckRegisterByte(RegisterType::E, 0x4A);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x31);
    CheckRegisterByte(RegisterType::L, 0xE9);
    CheckRegisterWord(RegisterType::PC, 0x90D7);
    CheckRegisterWord(RegisterType::SP, 0x8B83);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x90D5, 0xE0);
    CheckMemory(0x90D6, 0xA9);
    CheckMemory(0xFFA9, 0x97);
}

void test_E0_00E5()
{
    if (skip_test_E0_00E5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8B5E);
    WriteRegisterWord(RegisterType::SP, 0x14AB);
    WriteRegisterByte(RegisterType::A, 0x10);
    WriteRegisterByte(RegisterType::B, 0x36);
    WriteRegisterByte(RegisterType::C, 0x72);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0x9B);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x29);
    WriteRegisterByte(RegisterType::L, 0x13);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC5, 0x00);
    WriteMemory(0x8B5F, 0xC5);
    WriteMemory(0x8B5E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x10);
    CheckRegisterByte(RegisterType::B, 0x36);
    CheckRegisterByte(RegisterType::C, 0x72);
    CheckRegisterByte(RegisterType::D, 0xA9);
    CheckRegisterByte(RegisterType::E, 0x9B);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x29);
    CheckRegisterByte(RegisterType::L, 0x13);
    CheckRegisterWord(RegisterType::PC, 0x8B60);
    CheckRegisterWord(RegisterType::SP, 0x14AB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8B5E, 0xE0);
    CheckMemory(0x8B5F, 0xC5);
    CheckMemory(0xFFC5, 0x10);
}

void test_E0_00E6()
{
    if (skip_test_E0_00E6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x92FA);
    WriteRegisterWord(RegisterType::SP, 0xBBD2);
    WriteRegisterByte(RegisterType::A, 0xFC);
    WriteRegisterByte(RegisterType::B, 0x91);
    WriteRegisterByte(RegisterType::C, 0x68);
    WriteRegisterByte(RegisterType::D, 0x89);
    WriteRegisterByte(RegisterType::E, 0xCE);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xA9);
    WriteRegisterByte(RegisterType::L, 0xEB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF0F, 0x00);
    WriteMemory(0x92FB, 0x0F);
    WriteMemory(0x92FA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFC);
    CheckRegisterByte(RegisterType::B, 0x91);
    CheckRegisterByte(RegisterType::C, 0x68);
    CheckRegisterByte(RegisterType::D, 0x89);
    CheckRegisterByte(RegisterType::E, 0xCE);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xA9);
    CheckRegisterByte(RegisterType::L, 0xEB);
    CheckRegisterWord(RegisterType::PC, 0x92FC);
    CheckRegisterWord(RegisterType::SP, 0xBBD2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x92FA, 0xE0);
    CheckMemory(0x92FB, 0x0F);
    CheckMemory(0xFF0F, 0xFC);
}

void test_E0_00E7()
{
    if (skip_test_E0_00E7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x865C);
    WriteRegisterWord(RegisterType::SP, 0x9018);
    WriteRegisterByte(RegisterType::A, 0x81);
    WriteRegisterByte(RegisterType::B, 0xBD);
    WriteRegisterByte(RegisterType::C, 0x69);
    WriteRegisterByte(RegisterType::D, 0x13);
    WriteRegisterByte(RegisterType::E, 0x08);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x1A);
    WriteRegisterByte(RegisterType::L, 0x3A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9F, 0x00);
    WriteMemory(0x865D, 0x9F);
    WriteMemory(0x865C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x81);
    CheckRegisterByte(RegisterType::B, 0xBD);
    CheckRegisterByte(RegisterType::C, 0x69);
    CheckRegisterByte(RegisterType::D, 0x13);
    CheckRegisterByte(RegisterType::E, 0x08);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x1A);
    CheckRegisterByte(RegisterType::L, 0x3A);
    CheckRegisterWord(RegisterType::PC, 0x865E);
    CheckRegisterWord(RegisterType::SP, 0x9018);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x865C, 0xE0);
    CheckMemory(0x865D, 0x9F);
    CheckMemory(0xFF9F, 0x81);
}

void test_E0_00E8()
{
    if (skip_test_E0_00E8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFE79);
    WriteRegisterWord(RegisterType::SP, 0x181B);
    WriteRegisterByte(RegisterType::A, 0x5D);
    WriteRegisterByte(RegisterType::B, 0xB4);
    WriteRegisterByte(RegisterType::C, 0x15);
    WriteRegisterByte(RegisterType::D, 0xF7);
    WriteRegisterByte(RegisterType::E, 0x55);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x67);
    WriteRegisterByte(RegisterType::L, 0xDB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF88, 0x00);
    WriteMemory(0xFE7A, 0x88);
    WriteMemory(0xFE79, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5D);
    CheckRegisterByte(RegisterType::B, 0xB4);
    CheckRegisterByte(RegisterType::C, 0x15);
    CheckRegisterByte(RegisterType::D, 0xF7);
    CheckRegisterByte(RegisterType::E, 0x55);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x67);
    CheckRegisterByte(RegisterType::L, 0xDB);
    CheckRegisterWord(RegisterType::PC, 0xFE7B);
    CheckRegisterWord(RegisterType::SP, 0x181B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFE79, 0xE0);
    CheckMemory(0xFE7A, 0x88);
    CheckMemory(0xFF88, 0x5D);
}

void test_E0_00E9()
{
    if (skip_test_E0_00E9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8424);
    WriteRegisterWord(RegisterType::SP, 0xEB05);
    WriteRegisterByte(RegisterType::A, 0x77);
    WriteRegisterByte(RegisterType::B, 0x41);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0x07);
    WriteRegisterByte(RegisterType::E, 0x6D);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x71);
    WriteRegisterByte(RegisterType::L, 0x8E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF35, 0x00);
    WriteMemory(0x8425, 0x35);
    WriteMemory(0x8424, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x77);
    CheckRegisterByte(RegisterType::B, 0x41);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0x07);
    CheckRegisterByte(RegisterType::E, 0x6D);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x71);
    CheckRegisterByte(RegisterType::L, 0x8E);
    CheckRegisterWord(RegisterType::PC, 0x8426);
    CheckRegisterWord(RegisterType::SP, 0xEB05);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8424, 0xE0);
    CheckMemory(0x8425, 0x35);
    CheckMemory(0xFF35, 0x77);
}

void test_E0_00EA()
{
    if (skip_test_E0_00EA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x120E);
    WriteRegisterWord(RegisterType::SP, 0xC07A);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0x01);
    WriteRegisterByte(RegisterType::C, 0xA4);
    WriteRegisterByte(RegisterType::D, 0xF2);
    WriteRegisterByte(RegisterType::E, 0x35);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xA1);
    WriteRegisterByte(RegisterType::L, 0xAA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF94, 0x00);
    WriteMemory(0x120F, 0x94);
    WriteMemory(0x120E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0x01);
    CheckRegisterByte(RegisterType::C, 0xA4);
    CheckRegisterByte(RegisterType::D, 0xF2);
    CheckRegisterByte(RegisterType::E, 0x35);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xA1);
    CheckRegisterByte(RegisterType::L, 0xAA);
    CheckRegisterWord(RegisterType::PC, 0x1210);
    CheckRegisterWord(RegisterType::SP, 0xC07A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x120E, 0xE0);
    CheckMemory(0x120F, 0x94);
    CheckMemory(0xFF94, 0x32);
}

void test_E0_00EB()
{
    if (skip_test_E0_00EB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2D3F);
    WriteRegisterWord(RegisterType::SP, 0xE290);
    WriteRegisterByte(RegisterType::A, 0xAA);
    WriteRegisterByte(RegisterType::B, 0x58);
    WriteRegisterByte(RegisterType::C, 0x5C);
    WriteRegisterByte(RegisterType::D, 0x0B);
    WriteRegisterByte(RegisterType::E, 0xD9);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x14);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE9, 0x00);
    WriteMemory(0x2D40, 0xE9);
    WriteMemory(0x2D3F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAA);
    CheckRegisterByte(RegisterType::B, 0x58);
    CheckRegisterByte(RegisterType::C, 0x5C);
    CheckRegisterByte(RegisterType::D, 0x0B);
    CheckRegisterByte(RegisterType::E, 0xD9);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x14);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0x2D41);
    CheckRegisterWord(RegisterType::SP, 0xE290);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2D3F, 0xE0);
    CheckMemory(0x2D40, 0xE9);
    CheckMemory(0xFFE9, 0xAA);
}

void test_E0_00EC()
{
    if (skip_test_E0_00EC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBF0D);
    WriteRegisterWord(RegisterType::SP, 0x0D5F);
    WriteRegisterByte(RegisterType::A, 0x60);
    WriteRegisterByte(RegisterType::B, 0x29);
    WriteRegisterByte(RegisterType::C, 0xF5);
    WriteRegisterByte(RegisterType::D, 0x2E);
    WriteRegisterByte(RegisterType::E, 0xD2);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xDB);
    WriteRegisterByte(RegisterType::L, 0x5C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFEA, 0x00);
    WriteMemory(0xBF0E, 0xEA);
    WriteMemory(0xBF0D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x60);
    CheckRegisterByte(RegisterType::B, 0x29);
    CheckRegisterByte(RegisterType::C, 0xF5);
    CheckRegisterByte(RegisterType::D, 0x2E);
    CheckRegisterByte(RegisterType::E, 0xD2);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xDB);
    CheckRegisterByte(RegisterType::L, 0x5C);
    CheckRegisterWord(RegisterType::PC, 0xBF0F);
    CheckRegisterWord(RegisterType::SP, 0x0D5F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBF0D, 0xE0);
    CheckMemory(0xBF0E, 0xEA);
    CheckMemory(0xFFEA, 0x60);
}

void test_E0_00ED()
{
    if (skip_test_E0_00ED)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBDC4);
    WriteRegisterWord(RegisterType::SP, 0x370B);
    WriteRegisterByte(RegisterType::A, 0xBF);
    WriteRegisterByte(RegisterType::B, 0x10);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0x6E);
    WriteRegisterByte(RegisterType::E, 0x4C);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x86);
    WriteRegisterByte(RegisterType::L, 0xE5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF59, 0x00);
    WriteMemory(0xBDC5, 0x59);
    WriteMemory(0xBDC4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBF);
    CheckRegisterByte(RegisterType::B, 0x10);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0x6E);
    CheckRegisterByte(RegisterType::E, 0x4C);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x86);
    CheckRegisterByte(RegisterType::L, 0xE5);
    CheckRegisterWord(RegisterType::PC, 0xBDC6);
    CheckRegisterWord(RegisterType::SP, 0x370B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBDC4, 0xE0);
    CheckMemory(0xBDC5, 0x59);
    CheckMemory(0xFF59, 0xBF);
}

void test_E0_00EE()
{
    if (skip_test_E0_00EE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC734);
    WriteRegisterWord(RegisterType::SP, 0xC0C5);
    WriteRegisterByte(RegisterType::A, 0xF5);
    WriteRegisterByte(RegisterType::B, 0x50);
    WriteRegisterByte(RegisterType::C, 0x8D);
    WriteRegisterByte(RegisterType::D, 0x65);
    WriteRegisterByte(RegisterType::E, 0x72);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x83);
    WriteRegisterByte(RegisterType::L, 0x8E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA8, 0x00);
    WriteMemory(0xC735, 0xA8);
    WriteMemory(0xC734, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF5);
    CheckRegisterByte(RegisterType::B, 0x50);
    CheckRegisterByte(RegisterType::C, 0x8D);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0x72);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x83);
    CheckRegisterByte(RegisterType::L, 0x8E);
    CheckRegisterWord(RegisterType::PC, 0xC736);
    CheckRegisterWord(RegisterType::SP, 0xC0C5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC734, 0xE0);
    CheckMemory(0xC735, 0xA8);
    CheckMemory(0xFFA8, 0xF5);
}

void test_E0_00EF()
{
    if (skip_test_E0_00EF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3621);
    WriteRegisterWord(RegisterType::SP, 0x1120);
    WriteRegisterByte(RegisterType::A, 0xF6);
    WriteRegisterByte(RegisterType::B, 0x14);
    WriteRegisterByte(RegisterType::C, 0xFC);
    WriteRegisterByte(RegisterType::D, 0xBB);
    WriteRegisterByte(RegisterType::E, 0xCC);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x7E);
    WriteRegisterByte(RegisterType::L, 0xC0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF60, 0x00);
    WriteMemory(0x3622, 0x60);
    WriteMemory(0x3621, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF6);
    CheckRegisterByte(RegisterType::B, 0x14);
    CheckRegisterByte(RegisterType::C, 0xFC);
    CheckRegisterByte(RegisterType::D, 0xBB);
    CheckRegisterByte(RegisterType::E, 0xCC);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x7E);
    CheckRegisterByte(RegisterType::L, 0xC0);
    CheckRegisterWord(RegisterType::PC, 0x3623);
    CheckRegisterWord(RegisterType::SP, 0x1120);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3621, 0xE0);
    CheckMemory(0x3622, 0x60);
    CheckMemory(0xFF60, 0xF6);
}

void test_E0_00F0()
{
    if (skip_test_E0_00F0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA2DE);
    WriteRegisterWord(RegisterType::SP, 0x9EA5);
    WriteRegisterByte(RegisterType::A, 0x5B);
    WriteRegisterByte(RegisterType::B, 0x3C);
    WriteRegisterByte(RegisterType::C, 0x4F);
    WriteRegisterByte(RegisterType::D, 0x37);
    WriteRegisterByte(RegisterType::E, 0xDD);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x83);
    WriteRegisterByte(RegisterType::L, 0xB4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF58, 0x00);
    WriteMemory(0xA2DF, 0x58);
    WriteMemory(0xA2DE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5B);
    CheckRegisterByte(RegisterType::B, 0x3C);
    CheckRegisterByte(RegisterType::C, 0x4F);
    CheckRegisterByte(RegisterType::D, 0x37);
    CheckRegisterByte(RegisterType::E, 0xDD);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x83);
    CheckRegisterByte(RegisterType::L, 0xB4);
    CheckRegisterWord(RegisterType::PC, 0xA2E0);
    CheckRegisterWord(RegisterType::SP, 0x9EA5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA2DE, 0xE0);
    CheckMemory(0xA2DF, 0x58);
    CheckMemory(0xFF58, 0x5B);
}

void test_E0_00F1()
{
    if (skip_test_E0_00F1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x474D);
    WriteRegisterWord(RegisterType::SP, 0x0894);
    WriteRegisterByte(RegisterType::A, 0x35);
    WriteRegisterByte(RegisterType::B, 0x71);
    WriteRegisterByte(RegisterType::C, 0x0D);
    WriteRegisterByte(RegisterType::D, 0xE9);
    WriteRegisterByte(RegisterType::E, 0x88);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xAB);
    WriteRegisterByte(RegisterType::L, 0x13);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF19, 0x00);
    WriteMemory(0x474E, 0x19);
    WriteMemory(0x474D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x35);
    CheckRegisterByte(RegisterType::B, 0x71);
    CheckRegisterByte(RegisterType::C, 0x0D);
    CheckRegisterByte(RegisterType::D, 0xE9);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xAB);
    CheckRegisterByte(RegisterType::L, 0x13);
    CheckRegisterWord(RegisterType::PC, 0x474F);
    CheckRegisterWord(RegisterType::SP, 0x0894);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x474D, 0xE0);
    CheckMemory(0x474E, 0x19);
    CheckMemory(0xFF19, 0x35);
}

void test_E0_00F2()
{
    if (skip_test_E0_00F2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x82BC);
    WriteRegisterWord(RegisterType::SP, 0x330A);
    WriteRegisterByte(RegisterType::A, 0xEA);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0x53);
    WriteRegisterByte(RegisterType::D, 0xBB);
    WriteRegisterByte(RegisterType::E, 0x88);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x0A);
    WriteRegisterByte(RegisterType::L, 0x77);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB7, 0x00);
    WriteMemory(0x82BD, 0xB7);
    WriteMemory(0x82BC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEA);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0x53);
    CheckRegisterByte(RegisterType::D, 0xBB);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x0A);
    CheckRegisterByte(RegisterType::L, 0x77);
    CheckRegisterWord(RegisterType::PC, 0x82BE);
    CheckRegisterWord(RegisterType::SP, 0x330A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x82BC, 0xE0);
    CheckMemory(0x82BD, 0xB7);
    CheckMemory(0xFFB7, 0xEA);
}

void test_E0_00F3()
{
    if (skip_test_E0_00F3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x70F8);
    WriteRegisterWord(RegisterType::SP, 0x791C);
    WriteRegisterByte(RegisterType::A, 0x40);
    WriteRegisterByte(RegisterType::B, 0x26);
    WriteRegisterByte(RegisterType::C, 0xBA);
    WriteRegisterByte(RegisterType::D, 0x9E);
    WriteRegisterByte(RegisterType::E, 0xF4);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xB4);
    WriteRegisterByte(RegisterType::L, 0xDA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF41, 0x00);
    WriteMemory(0x70F9, 0x41);
    WriteMemory(0x70F8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x40);
    CheckRegisterByte(RegisterType::B, 0x26);
    CheckRegisterByte(RegisterType::C, 0xBA);
    CheckRegisterByte(RegisterType::D, 0x9E);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xB4);
    CheckRegisterByte(RegisterType::L, 0xDA);
    CheckRegisterWord(RegisterType::PC, 0x70FA);
    CheckRegisterWord(RegisterType::SP, 0x791C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x70F8, 0xE0);
    CheckMemory(0x70F9, 0x41);
    CheckMemory(0xFF41, 0x40);
}

void test_E0_00F4()
{
    if (skip_test_E0_00F4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB7B5);
    WriteRegisterWord(RegisterType::SP, 0xE81A);
    WriteRegisterByte(RegisterType::A, 0x8C);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0xA2);
    WriteRegisterByte(RegisterType::D, 0x24);
    WriteRegisterByte(RegisterType::E, 0x65);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0xFF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD0, 0x00);
    WriteMemory(0xB7B6, 0xD0);
    WriteMemory(0xB7B5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8C);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0xA2);
    CheckRegisterByte(RegisterType::D, 0x24);
    CheckRegisterByte(RegisterType::E, 0x65);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0xFF);
    CheckRegisterWord(RegisterType::PC, 0xB7B7);
    CheckRegisterWord(RegisterType::SP, 0xE81A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB7B5, 0xE0);
    CheckMemory(0xB7B6, 0xD0);
    CheckMemory(0xFFD0, 0x8C);
}

void test_E0_00F5()
{
    if (skip_test_E0_00F5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF821);
    WriteRegisterWord(RegisterType::SP, 0xAD0F);
    WriteRegisterByte(RegisterType::A, 0xDF);
    WriteRegisterByte(RegisterType::B, 0x79);
    WriteRegisterByte(RegisterType::C, 0x8F);
    WriteRegisterByte(RegisterType::D, 0xE1);
    WriteRegisterByte(RegisterType::E, 0x78);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF86, 0x00);
    WriteMemory(0xF822, 0x86);
    WriteMemory(0xF821, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDF);
    CheckRegisterByte(RegisterType::B, 0x79);
    CheckRegisterByte(RegisterType::C, 0x8F);
    CheckRegisterByte(RegisterType::D, 0xE1);
    CheckRegisterByte(RegisterType::E, 0x78);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0xF823);
    CheckRegisterWord(RegisterType::SP, 0xAD0F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF821, 0xE0);
    CheckMemory(0xF822, 0x86);
    CheckMemory(0xFF86, 0xDF);
}

void test_E0_00F6()
{
    if (skip_test_E0_00F6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1452);
    WriteRegisterWord(RegisterType::SP, 0x8477);
    WriteRegisterByte(RegisterType::A, 0x38);
    WriteRegisterByte(RegisterType::B, 0x31);
    WriteRegisterByte(RegisterType::C, 0xCD);
    WriteRegisterByte(RegisterType::D, 0x42);
    WriteRegisterByte(RegisterType::E, 0x9B);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xF8);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF57, 0x00);
    WriteMemory(0x1453, 0x57);
    WriteMemory(0x1452, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x38);
    CheckRegisterByte(RegisterType::B, 0x31);
    CheckRegisterByte(RegisterType::C, 0xCD);
    CheckRegisterByte(RegisterType::D, 0x42);
    CheckRegisterByte(RegisterType::E, 0x9B);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xF8);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0x1454);
    CheckRegisterWord(RegisterType::SP, 0x8477);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1452, 0xE0);
    CheckMemory(0x1453, 0x57);
    CheckMemory(0xFF57, 0x38);
}

void test_E0_00F7()
{
    if (skip_test_E0_00F7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2746);
    WriteRegisterWord(RegisterType::SP, 0x064C);
    WriteRegisterByte(RegisterType::A, 0xC0);
    WriteRegisterByte(RegisterType::B, 0x0C);
    WriteRegisterByte(RegisterType::C, 0x0D);
    WriteRegisterByte(RegisterType::D, 0x16);
    WriteRegisterByte(RegisterType::E, 0xFB);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x7E);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF61, 0x00);
    WriteMemory(0x2747, 0x61);
    WriteMemory(0x2746, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC0);
    CheckRegisterByte(RegisterType::B, 0x0C);
    CheckRegisterByte(RegisterType::C, 0x0D);
    CheckRegisterByte(RegisterType::D, 0x16);
    CheckRegisterByte(RegisterType::E, 0xFB);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x7E);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0x2748);
    CheckRegisterWord(RegisterType::SP, 0x064C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2746, 0xE0);
    CheckMemory(0x2747, 0x61);
    CheckMemory(0xFF61, 0xC0);
}

void test_E0_00F8()
{
    if (skip_test_E0_00F8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3AFE);
    WriteRegisterWord(RegisterType::SP, 0x98EF);
    WriteRegisterByte(RegisterType::A, 0x68);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0x40);
    WriteRegisterByte(RegisterType::D, 0x5A);
    WriteRegisterByte(RegisterType::E, 0x0E);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x08);
    WriteRegisterByte(RegisterType::L, 0xC5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF16, 0x00);
    WriteMemory(0x3AFF, 0x16);
    WriteMemory(0x3AFE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x68);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0x40);
    CheckRegisterByte(RegisterType::D, 0x5A);
    CheckRegisterByte(RegisterType::E, 0x0E);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x08);
    CheckRegisterByte(RegisterType::L, 0xC5);
    CheckRegisterWord(RegisterType::PC, 0x3B00);
    CheckRegisterWord(RegisterType::SP, 0x98EF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3AFE, 0xE0);
    CheckMemory(0x3AFF, 0x16);
    CheckMemory(0xFF16, 0x68);
}

void test_E0_00F9()
{
    if (skip_test_E0_00F9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5C42);
    WriteRegisterWord(RegisterType::SP, 0x33FC);
    WriteRegisterByte(RegisterType::A, 0xAC);
    WriteRegisterByte(RegisterType::B, 0x2E);
    WriteRegisterByte(RegisterType::C, 0xA3);
    WriteRegisterByte(RegisterType::D, 0xFD);
    WriteRegisterByte(RegisterType::E, 0x6F);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x07);
    WriteRegisterByte(RegisterType::L, 0xD1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5D, 0x00);
    WriteMemory(0x5C43, 0x5D);
    WriteMemory(0x5C42, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAC);
    CheckRegisterByte(RegisterType::B, 0x2E);
    CheckRegisterByte(RegisterType::C, 0xA3);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0x6F);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x07);
    CheckRegisterByte(RegisterType::L, 0xD1);
    CheckRegisterWord(RegisterType::PC, 0x5C44);
    CheckRegisterWord(RegisterType::SP, 0x33FC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5C42, 0xE0);
    CheckMemory(0x5C43, 0x5D);
    CheckMemory(0xFF5D, 0xAC);
}

void test_E0_00FA()
{
    if (skip_test_E0_00FA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF98F);
    WriteRegisterWord(RegisterType::SP, 0xDC60);
    WriteRegisterByte(RegisterType::A, 0x2A);
    WriteRegisterByte(RegisterType::B, 0x3C);
    WriteRegisterByte(RegisterType::C, 0xBF);
    WriteRegisterByte(RegisterType::D, 0x6F);
    WriteRegisterByte(RegisterType::E, 0x5C);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x12);
    WriteRegisterByte(RegisterType::L, 0xA6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF6E, 0x00);
    WriteMemory(0xF990, 0x6E);
    WriteMemory(0xF98F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2A);
    CheckRegisterByte(RegisterType::B, 0x3C);
    CheckRegisterByte(RegisterType::C, 0xBF);
    CheckRegisterByte(RegisterType::D, 0x6F);
    CheckRegisterByte(RegisterType::E, 0x5C);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x12);
    CheckRegisterByte(RegisterType::L, 0xA6);
    CheckRegisterWord(RegisterType::PC, 0xF991);
    CheckRegisterWord(RegisterType::SP, 0xDC60);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF98F, 0xE0);
    CheckMemory(0xF990, 0x6E);
    CheckMemory(0xFF6E, 0x2A);
}

void test_E0_00FB()
{
    if (skip_test_E0_00FB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x402F);
    WriteRegisterWord(RegisterType::SP, 0xD4CD);
    WriteRegisterByte(RegisterType::A, 0xC8);
    WriteRegisterByte(RegisterType::B, 0xF7);
    WriteRegisterByte(RegisterType::C, 0xF2);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x04);
    WriteRegisterByte(RegisterType::L, 0x43);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF42, 0x00);
    WriteMemory(0x4030, 0x42);
    WriteMemory(0x402F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC8);
    CheckRegisterByte(RegisterType::B, 0xF7);
    CheckRegisterByte(RegisterType::C, 0xF2);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x04);
    CheckRegisterByte(RegisterType::L, 0x43);
    CheckRegisterWord(RegisterType::PC, 0x4031);
    CheckRegisterWord(RegisterType::SP, 0xD4CD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x402F, 0xE0);
    CheckMemory(0x4030, 0x42);
    CheckMemory(0xFF42, 0xC8);
}

void test_E0_00FC()
{
    if (skip_test_E0_00FC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8F48);
    WriteRegisterWord(RegisterType::SP, 0x2A9E);
    WriteRegisterByte(RegisterType::A, 0x74);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0x92);
    WriteRegisterByte(RegisterType::D, 0xB2);
    WriteRegisterByte(RegisterType::E, 0x24);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0x43);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5E, 0x00);
    WriteMemory(0x8F49, 0x5E);
    WriteMemory(0x8F48, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x74);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0x92);
    CheckRegisterByte(RegisterType::D, 0xB2);
    CheckRegisterByte(RegisterType::E, 0x24);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0x43);
    CheckRegisterWord(RegisterType::PC, 0x8F4A);
    CheckRegisterWord(RegisterType::SP, 0x2A9E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8F48, 0xE0);
    CheckMemory(0x8F49, 0x5E);
    CheckMemory(0xFF5E, 0x74);
}

void test_E0_00FD()
{
    if (skip_test_E0_00FD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2B81);
    WriteRegisterWord(RegisterType::SP, 0xE9B4);
    WriteRegisterByte(RegisterType::A, 0xD8);
    WriteRegisterByte(RegisterType::B, 0xD8);
    WriteRegisterByte(RegisterType::C, 0x58);
    WriteRegisterByte(RegisterType::D, 0xAA);
    WriteRegisterByte(RegisterType::E, 0xE1);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x1A);
    WriteRegisterByte(RegisterType::L, 0x7B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC2, 0x00);
    WriteMemory(0x2B82, 0xC2);
    WriteMemory(0x2B81, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD8);
    CheckRegisterByte(RegisterType::B, 0xD8);
    CheckRegisterByte(RegisterType::C, 0x58);
    CheckRegisterByte(RegisterType::D, 0xAA);
    CheckRegisterByte(RegisterType::E, 0xE1);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x1A);
    CheckRegisterByte(RegisterType::L, 0x7B);
    CheckRegisterWord(RegisterType::PC, 0x2B83);
    CheckRegisterWord(RegisterType::SP, 0xE9B4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2B81, 0xE0);
    CheckMemory(0x2B82, 0xC2);
    CheckMemory(0xFFC2, 0xD8);
}

void test_E0_00FE()
{
    if (skip_test_E0_00FE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAE04);
    WriteRegisterWord(RegisterType::SP, 0x2E52);
    WriteRegisterByte(RegisterType::A, 0x18);
    WriteRegisterByte(RegisterType::B, 0xD3);
    WriteRegisterByte(RegisterType::C, 0x9E);
    WriteRegisterByte(RegisterType::D, 0x3E);
    WriteRegisterByte(RegisterType::E, 0x42);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x1A);
    WriteRegisterByte(RegisterType::L, 0x28);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFFE, 0x00);
    WriteMemory(0xAE05, 0xFE);
    WriteMemory(0xAE04, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x18);
    CheckRegisterByte(RegisterType::B, 0xD3);
    CheckRegisterByte(RegisterType::C, 0x9E);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0x42);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x1A);
    CheckRegisterByte(RegisterType::L, 0x28);
    CheckRegisterWord(RegisterType::PC, 0xAE06);
    CheckRegisterWord(RegisterType::SP, 0x2E52);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAE04, 0xE0);
    CheckMemory(0xAE05, 0xFE);
    CheckMemory(0xFFFE, 0x18);
}

void test_E0_00FF()
{
    if (skip_test_E0_00FF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAFE3);
    WriteRegisterWord(RegisterType::SP, 0x9DE6);
    WriteRegisterByte(RegisterType::A, 0xEC);
    WriteRegisterByte(RegisterType::B, 0xD8);
    WriteRegisterByte(RegisterType::C, 0x75);
    WriteRegisterByte(RegisterType::D, 0x78);
    WriteRegisterByte(RegisterType::E, 0x81);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xEE);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA2, 0x00);
    WriteMemory(0xAFE4, 0xA2);
    WriteMemory(0xAFE3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEC);
    CheckRegisterByte(RegisterType::B, 0xD8);
    CheckRegisterByte(RegisterType::C, 0x75);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0x81);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xEE);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0xAFE5);
    CheckRegisterWord(RegisterType::SP, 0x9DE6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAFE3, 0xE0);
    CheckMemory(0xAFE4, 0xA2);
    CheckMemory(0xFFA2, 0xEC);
}

void test_E0_0100()
{
    if (skip_test_E0_0100)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4E70);
    WriteRegisterWord(RegisterType::SP, 0xABAC);
    WriteRegisterByte(RegisterType::A, 0x04);
    WriteRegisterByte(RegisterType::B, 0xE3);
    WriteRegisterByte(RegisterType::C, 0xF0);
    WriteRegisterByte(RegisterType::D, 0x78);
    WriteRegisterByte(RegisterType::E, 0xAB);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x71);
    WriteRegisterByte(RegisterType::L, 0xF5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0E, 0x00);
    WriteMemory(0x4E71, 0x0E);
    WriteMemory(0x4E70, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x04);
    CheckRegisterByte(RegisterType::B, 0xE3);
    CheckRegisterByte(RegisterType::C, 0xF0);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0xAB);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x71);
    CheckRegisterByte(RegisterType::L, 0xF5);
    CheckRegisterWord(RegisterType::PC, 0x4E72);
    CheckRegisterWord(RegisterType::SP, 0xABAC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4E70, 0xE0);
    CheckMemory(0x4E71, 0x0E);
    CheckMemory(0xFF0E, 0x04);
}

void test_E0_0101()
{
    if (skip_test_E0_0101)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEE68);
    WriteRegisterWord(RegisterType::SP, 0x5FFD);
    WriteRegisterByte(RegisterType::A, 0xD3);
    WriteRegisterByte(RegisterType::B, 0x69);
    WriteRegisterByte(RegisterType::C, 0x92);
    WriteRegisterByte(RegisterType::D, 0xB4);
    WriteRegisterByte(RegisterType::E, 0x36);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x2F);
    WriteRegisterByte(RegisterType::L, 0xF1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4E, 0x00);
    WriteMemory(0xEE69, 0x4E);
    WriteMemory(0xEE68, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD3);
    CheckRegisterByte(RegisterType::B, 0x69);
    CheckRegisterByte(RegisterType::C, 0x92);
    CheckRegisterByte(RegisterType::D, 0xB4);
    CheckRegisterByte(RegisterType::E, 0x36);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x2F);
    CheckRegisterByte(RegisterType::L, 0xF1);
    CheckRegisterWord(RegisterType::PC, 0xEE6A);
    CheckRegisterWord(RegisterType::SP, 0x5FFD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xEE68, 0xE0);
    CheckMemory(0xEE69, 0x4E);
    CheckMemory(0xFF4E, 0xD3);
}

void test_E0_0102()
{
    if (skip_test_E0_0102)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD004);
    WriteRegisterWord(RegisterType::SP, 0x2849);
    WriteRegisterByte(RegisterType::A, 0x3C);
    WriteRegisterByte(RegisterType::B, 0xEF);
    WriteRegisterByte(RegisterType::C, 0xEB);
    WriteRegisterByte(RegisterType::D, 0x97);
    WriteRegisterByte(RegisterType::E, 0xDE);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0xCC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCD, 0x00);
    WriteMemory(0xD005, 0xCD);
    WriteMemory(0xD004, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3C);
    CheckRegisterByte(RegisterType::B, 0xEF);
    CheckRegisterByte(RegisterType::C, 0xEB);
    CheckRegisterByte(RegisterType::D, 0x97);
    CheckRegisterByte(RegisterType::E, 0xDE);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0xCC);
    CheckRegisterWord(RegisterType::PC, 0xD006);
    CheckRegisterWord(RegisterType::SP, 0x2849);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD004, 0xE0);
    CheckMemory(0xD005, 0xCD);
    CheckMemory(0xFFCD, 0x3C);
}

void test_E0_0103()
{
    if (skip_test_E0_0103)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6BA2);
    WriteRegisterWord(RegisterType::SP, 0xA26A);
    WriteRegisterByte(RegisterType::A, 0xE9);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x77);
    WriteRegisterByte(RegisterType::D, 0xB0);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0xF7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF43, 0x00);
    WriteMemory(0x6BA3, 0x43);
    WriteMemory(0x6BA2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE9);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x77);
    CheckRegisterByte(RegisterType::D, 0xB0);
    CheckRegisterByte(RegisterType::E, 0xC7);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0xF7);
    CheckRegisterWord(RegisterType::PC, 0x6BA4);
    CheckRegisterWord(RegisterType::SP, 0xA26A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6BA2, 0xE0);
    CheckMemory(0x6BA3, 0x43);
    CheckMemory(0xFF43, 0xE9);
}

void test_E0_0104()
{
    if (skip_test_E0_0104)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFAF7);
    WriteRegisterWord(RegisterType::SP, 0x497E);
    WriteRegisterByte(RegisterType::A, 0x27);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0x35);
    WriteRegisterByte(RegisterType::D, 0x6E);
    WriteRegisterByte(RegisterType::E, 0x90);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xAB);
    WriteRegisterByte(RegisterType::L, 0x32);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF37, 0x00);
    WriteMemory(0xFAF8, 0x37);
    WriteMemory(0xFAF7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x27);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0x35);
    CheckRegisterByte(RegisterType::D, 0x6E);
    CheckRegisterByte(RegisterType::E, 0x90);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xAB);
    CheckRegisterByte(RegisterType::L, 0x32);
    CheckRegisterWord(RegisterType::PC, 0xFAF9);
    CheckRegisterWord(RegisterType::SP, 0x497E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFAF7, 0xE0);
    CheckMemory(0xFAF8, 0x37);
    CheckMemory(0xFF37, 0x27);
}

void test_E0_0105()
{
    if (skip_test_E0_0105)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x453E);
    WriteRegisterWord(RegisterType::SP, 0xDF59);
    WriteRegisterByte(RegisterType::A, 0xA8);
    WriteRegisterByte(RegisterType::B, 0x79);
    WriteRegisterByte(RegisterType::C, 0x45);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0x54);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0x03);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF08, 0x00);
    WriteMemory(0x453F, 0x08);
    WriteMemory(0x453E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA8);
    CheckRegisterByte(RegisterType::B, 0x79);
    CheckRegisterByte(RegisterType::C, 0x45);
    CheckRegisterByte(RegisterType::D, 0x76);
    CheckRegisterByte(RegisterType::E, 0x54);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0x03);
    CheckRegisterWord(RegisterType::PC, 0x4540);
    CheckRegisterWord(RegisterType::SP, 0xDF59);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x453E, 0xE0);
    CheckMemory(0x453F, 0x08);
    CheckMemory(0xFF08, 0xA8);
}

void test_E0_0106()
{
    if (skip_test_E0_0106)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB962);
    WriteRegisterWord(RegisterType::SP, 0x26E1);
    WriteRegisterByte(RegisterType::A, 0xB8);
    WriteRegisterByte(RegisterType::B, 0x28);
    WriteRegisterByte(RegisterType::C, 0x74);
    WriteRegisterByte(RegisterType::D, 0x32);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0x5E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF71, 0x00);
    WriteMemory(0xB963, 0x71);
    WriteMemory(0xB962, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB8);
    CheckRegisterByte(RegisterType::B, 0x28);
    CheckRegisterByte(RegisterType::C, 0x74);
    CheckRegisterByte(RegisterType::D, 0x32);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0x5E);
    CheckRegisterWord(RegisterType::PC, 0xB964);
    CheckRegisterWord(RegisterType::SP, 0x26E1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB962, 0xE0);
    CheckMemory(0xB963, 0x71);
    CheckMemory(0xFF71, 0xB8);
}

void test_E0_0107()
{
    if (skip_test_E0_0107)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x11F0);
    WriteRegisterWord(RegisterType::SP, 0xF937);
    WriteRegisterByte(RegisterType::A, 0x42);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0x3D);
    WriteRegisterByte(RegisterType::D, 0x18);
    WriteRegisterByte(RegisterType::E, 0xC1);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x04);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9D, 0x00);
    WriteMemory(0x11F1, 0x9D);
    WriteMemory(0x11F0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x42);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0x3D);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0xC1);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x04);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0x11F2);
    CheckRegisterWord(RegisterType::SP, 0xF937);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x11F0, 0xE0);
    CheckMemory(0x11F1, 0x9D);
    CheckMemory(0xFF9D, 0x42);
}

void test_E0_0108()
{
    if (skip_test_E0_0108)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE3A9);
    WriteRegisterWord(RegisterType::SP, 0x29CA);
    WriteRegisterByte(RegisterType::A, 0x41);
    WriteRegisterByte(RegisterType::B, 0xCE);
    WriteRegisterByte(RegisterType::C, 0xF7);
    WriteRegisterByte(RegisterType::D, 0x90);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x04);
    WriteRegisterByte(RegisterType::L, 0x2E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF38, 0x00);
    WriteMemory(0xE3AA, 0x38);
    WriteMemory(0xE3A9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x41);
    CheckRegisterByte(RegisterType::B, 0xCE);
    CheckRegisterByte(RegisterType::C, 0xF7);
    CheckRegisterByte(RegisterType::D, 0x90);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x04);
    CheckRegisterByte(RegisterType::L, 0x2E);
    CheckRegisterWord(RegisterType::PC, 0xE3AB);
    CheckRegisterWord(RegisterType::SP, 0x29CA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE3A9, 0xE0);
    CheckMemory(0xE3AA, 0x38);
    CheckMemory(0xFF38, 0x41);
}

void test_E0_0109()
{
    if (skip_test_E0_0109)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8952);
    WriteRegisterWord(RegisterType::SP, 0xCFA1);
    WriteRegisterByte(RegisterType::A, 0x23);
    WriteRegisterByte(RegisterType::B, 0x4E);
    WriteRegisterByte(RegisterType::C, 0xBF);
    WriteRegisterByte(RegisterType::D, 0x86);
    WriteRegisterByte(RegisterType::E, 0x2C);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xC0);
    WriteRegisterByte(RegisterType::L, 0x4D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF3E, 0x00);
    WriteMemory(0x8953, 0x3E);
    WriteMemory(0x8952, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x23);
    CheckRegisterByte(RegisterType::B, 0x4E);
    CheckRegisterByte(RegisterType::C, 0xBF);
    CheckRegisterByte(RegisterType::D, 0x86);
    CheckRegisterByte(RegisterType::E, 0x2C);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xC0);
    CheckRegisterByte(RegisterType::L, 0x4D);
    CheckRegisterWord(RegisterType::PC, 0x8954);
    CheckRegisterWord(RegisterType::SP, 0xCFA1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8952, 0xE0);
    CheckMemory(0x8953, 0x3E);
    CheckMemory(0xFF3E, 0x23);
}

void test_E0_010A()
{
    if (skip_test_E0_010A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x895F);
    WriteRegisterWord(RegisterType::SP, 0x5176);
    WriteRegisterByte(RegisterType::A, 0x61);
    WriteRegisterByte(RegisterType::B, 0xAD);
    WriteRegisterByte(RegisterType::C, 0xF3);
    WriteRegisterByte(RegisterType::D, 0x8B);
    WriteRegisterByte(RegisterType::E, 0x8E);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xBC);
    WriteRegisterByte(RegisterType::L, 0x31);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF86, 0x00);
    WriteMemory(0x8960, 0x86);
    WriteMemory(0x895F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x61);
    CheckRegisterByte(RegisterType::B, 0xAD);
    CheckRegisterByte(RegisterType::C, 0xF3);
    CheckRegisterByte(RegisterType::D, 0x8B);
    CheckRegisterByte(RegisterType::E, 0x8E);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xBC);
    CheckRegisterByte(RegisterType::L, 0x31);
    CheckRegisterWord(RegisterType::PC, 0x8961);
    CheckRegisterWord(RegisterType::SP, 0x5176);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x895F, 0xE0);
    CheckMemory(0x8960, 0x86);
    CheckMemory(0xFF86, 0x61);
}

void test_E0_010B()
{
    if (skip_test_E0_010B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8E49);
    WriteRegisterWord(RegisterType::SP, 0xF5DA);
    WriteRegisterByte(RegisterType::A, 0xD7);
    WriteRegisterByte(RegisterType::B, 0x23);
    WriteRegisterByte(RegisterType::C, 0x66);
    WriteRegisterByte(RegisterType::D, 0xDB);
    WriteRegisterByte(RegisterType::E, 0x1B);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0xF7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF77, 0x00);
    WriteMemory(0x8E4A, 0x77);
    WriteMemory(0x8E49, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD7);
    CheckRegisterByte(RegisterType::B, 0x23);
    CheckRegisterByte(RegisterType::C, 0x66);
    CheckRegisterByte(RegisterType::D, 0xDB);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0xF7);
    CheckRegisterWord(RegisterType::PC, 0x8E4B);
    CheckRegisterWord(RegisterType::SP, 0xF5DA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8E49, 0xE0);
    CheckMemory(0x8E4A, 0x77);
    CheckMemory(0xFF77, 0xD7);
}

void test_E0_010C()
{
    if (skip_test_E0_010C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0D5E);
    WriteRegisterWord(RegisterType::SP, 0xC098);
    WriteRegisterByte(RegisterType::A, 0xAB);
    WriteRegisterByte(RegisterType::B, 0x51);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0xEA);
    WriteRegisterByte(RegisterType::E, 0x1A);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xB2);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5F, 0x00);
    WriteMemory(0x0D5F, 0x5F);
    WriteMemory(0x0D5E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAB);
    CheckRegisterByte(RegisterType::B, 0x51);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0xEA);
    CheckRegisterByte(RegisterType::E, 0x1A);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xB2);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0x0D60);
    CheckRegisterWord(RegisterType::SP, 0xC098);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0D5E, 0xE0);
    CheckMemory(0x0D5F, 0x5F);
    CheckMemory(0xFF5F, 0xAB);
}

void test_E0_010D()
{
    if (skip_test_E0_010D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x46E7);
    WriteRegisterWord(RegisterType::SP, 0xB8A5);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0x53);
    WriteRegisterByte(RegisterType::C, 0xCA);
    WriteRegisterByte(RegisterType::D, 0x1A);
    WriteRegisterByte(RegisterType::E, 0x79);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD1);
    WriteRegisterByte(RegisterType::L, 0xAF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF52, 0x00);
    WriteMemory(0x46E8, 0x52);
    WriteMemory(0x46E7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0x53);
    CheckRegisterByte(RegisterType::C, 0xCA);
    CheckRegisterByte(RegisterType::D, 0x1A);
    CheckRegisterByte(RegisterType::E, 0x79);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD1);
    CheckRegisterByte(RegisterType::L, 0xAF);
    CheckRegisterWord(RegisterType::PC, 0x46E9);
    CheckRegisterWord(RegisterType::SP, 0xB8A5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x46E7, 0xE0);
    CheckMemory(0x46E8, 0x52);
    CheckMemory(0xFF52, 0x78);
}

void test_E0_010E()
{
    if (skip_test_E0_010E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x367C);
    WriteRegisterWord(RegisterType::SP, 0xACBD);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0xB7);
    WriteRegisterByte(RegisterType::E, 0x4E);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x2C);
    WriteRegisterByte(RegisterType::L, 0xC6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF9, 0x00);
    WriteMemory(0x367D, 0xF9);
    WriteMemory(0x367C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0xB7);
    CheckRegisterByte(RegisterType::E, 0x4E);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x2C);
    CheckRegisterByte(RegisterType::L, 0xC6);
    CheckRegisterWord(RegisterType::PC, 0x367E);
    CheckRegisterWord(RegisterType::SP, 0xACBD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x367C, 0xE0);
    CheckMemory(0x367D, 0xF9);
    CheckMemory(0xFFF9, 0x95);
}

void test_E0_010F()
{
    if (skip_test_E0_010F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDA5E);
    WriteRegisterWord(RegisterType::SP, 0x3E31);
    WriteRegisterByte(RegisterType::A, 0xF0);
    WriteRegisterByte(RegisterType::B, 0x41);
    WriteRegisterByte(RegisterType::C, 0x54);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0x66);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x20);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6C, 0x00);
    WriteMemory(0xDA5F, 0x6C);
    WriteMemory(0xDA5E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF0);
    CheckRegisterByte(RegisterType::B, 0x41);
    CheckRegisterByte(RegisterType::C, 0x54);
    CheckRegisterByte(RegisterType::D, 0xAB);
    CheckRegisterByte(RegisterType::E, 0x66);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x20);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0xDA60);
    CheckRegisterWord(RegisterType::SP, 0x3E31);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDA5E, 0xE0);
    CheckMemory(0xDA5F, 0x6C);
    CheckMemory(0xFF6C, 0xF0);
}

void test_E0_0110()
{
    if (skip_test_E0_0110)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3A0E);
    WriteRegisterWord(RegisterType::SP, 0x87CD);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0xCA);
    WriteRegisterByte(RegisterType::D, 0x5F);
    WriteRegisterByte(RegisterType::E, 0xD8);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x67);
    WriteRegisterByte(RegisterType::L, 0xEB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC1, 0x00);
    WriteMemory(0x3A0F, 0xC1);
    WriteMemory(0x3A0E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0xCA);
    CheckRegisterByte(RegisterType::D, 0x5F);
    CheckRegisterByte(RegisterType::E, 0xD8);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x67);
    CheckRegisterByte(RegisterType::L, 0xEB);
    CheckRegisterWord(RegisterType::PC, 0x3A10);
    CheckRegisterWord(RegisterType::SP, 0x87CD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3A0E, 0xE0);
    CheckMemory(0x3A0F, 0xC1);
    CheckMemory(0xFFC1, 0x95);
}

void test_E0_0111()
{
    if (skip_test_E0_0111)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9728);
    WriteRegisterWord(RegisterType::SP, 0x7418);
    WriteRegisterByte(RegisterType::A, 0x9A);
    WriteRegisterByte(RegisterType::B, 0xD9);
    WriteRegisterByte(RegisterType::C, 0x24);
    WriteRegisterByte(RegisterType::D, 0x05);
    WriteRegisterByte(RegisterType::E, 0xB3);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xC3);
    WriteRegisterByte(RegisterType::L, 0x54);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC1, 0x00);
    WriteMemory(0x9729, 0xC1);
    WriteMemory(0x9728, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9A);
    CheckRegisterByte(RegisterType::B, 0xD9);
    CheckRegisterByte(RegisterType::C, 0x24);
    CheckRegisterByte(RegisterType::D, 0x05);
    CheckRegisterByte(RegisterType::E, 0xB3);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xC3);
    CheckRegisterByte(RegisterType::L, 0x54);
    CheckRegisterWord(RegisterType::PC, 0x972A);
    CheckRegisterWord(RegisterType::SP, 0x7418);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9728, 0xE0);
    CheckMemory(0x9729, 0xC1);
    CheckMemory(0xFFC1, 0x9A);
}

void test_E0_0112()
{
    if (skip_test_E0_0112)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6804);
    WriteRegisterWord(RegisterType::SP, 0x8F91);
    WriteRegisterByte(RegisterType::A, 0x96);
    WriteRegisterByte(RegisterType::B, 0xEA);
    WriteRegisterByte(RegisterType::C, 0x3B);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0x60);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0x06);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF12, 0x00);
    WriteMemory(0x6805, 0x12);
    WriteMemory(0x6804, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x96);
    CheckRegisterByte(RegisterType::B, 0xEA);
    CheckRegisterByte(RegisterType::C, 0x3B);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0x60);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0x06);
    CheckRegisterWord(RegisterType::PC, 0x6806);
    CheckRegisterWord(RegisterType::SP, 0x8F91);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6804, 0xE0);
    CheckMemory(0x6805, 0x12);
    CheckMemory(0xFF12, 0x96);
}

void test_E0_0113()
{
    if (skip_test_E0_0113)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE50C);
    WriteRegisterWord(RegisterType::SP, 0xC23D);
    WriteRegisterByte(RegisterType::A, 0x70);
    WriteRegisterByte(RegisterType::B, 0xE6);
    WriteRegisterByte(RegisterType::C, 0x3C);
    WriteRegisterByte(RegisterType::D, 0xB9);
    WriteRegisterByte(RegisterType::E, 0x40);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x63);
    WriteRegisterByte(RegisterType::L, 0xEA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCB, 0x00);
    WriteMemory(0xE50D, 0xCB);
    WriteMemory(0xE50C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x70);
    CheckRegisterByte(RegisterType::B, 0xE6);
    CheckRegisterByte(RegisterType::C, 0x3C);
    CheckRegisterByte(RegisterType::D, 0xB9);
    CheckRegisterByte(RegisterType::E, 0x40);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x63);
    CheckRegisterByte(RegisterType::L, 0xEA);
    CheckRegisterWord(RegisterType::PC, 0xE50E);
    CheckRegisterWord(RegisterType::SP, 0xC23D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE50C, 0xE0);
    CheckMemory(0xE50D, 0xCB);
    CheckMemory(0xFFCB, 0x70);
}

void test_E0_0114()
{
    if (skip_test_E0_0114)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0CA7);
    WriteRegisterWord(RegisterType::SP, 0x923A);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0xF6);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0xB4);
    WriteRegisterByte(RegisterType::E, 0xA1);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xDE);
    WriteRegisterByte(RegisterType::L, 0x04);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2D, 0x00);
    WriteMemory(0x0CA8, 0x2D);
    WriteMemory(0x0CA7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0xF6);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0xB4);
    CheckRegisterByte(RegisterType::E, 0xA1);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xDE);
    CheckRegisterByte(RegisterType::L, 0x04);
    CheckRegisterWord(RegisterType::PC, 0x0CA9);
    CheckRegisterWord(RegisterType::SP, 0x923A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0CA7, 0xE0);
    CheckMemory(0x0CA8, 0x2D);
    CheckMemory(0xFF2D, 0x95);
}

void test_E0_0115()
{
    if (skip_test_E0_0115)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x11EE);
    WriteRegisterWord(RegisterType::SP, 0x0882);
    WriteRegisterByte(RegisterType::A, 0x37);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0x98);
    WriteRegisterByte(RegisterType::D, 0xB4);
    WriteRegisterByte(RegisterType::E, 0x73);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x45);
    WriteRegisterByte(RegisterType::L, 0x51);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE3, 0x00);
    WriteMemory(0x11EF, 0xE3);
    WriteMemory(0x11EE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x37);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0x98);
    CheckRegisterByte(RegisterType::D, 0xB4);
    CheckRegisterByte(RegisterType::E, 0x73);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x45);
    CheckRegisterByte(RegisterType::L, 0x51);
    CheckRegisterWord(RegisterType::PC, 0x11F0);
    CheckRegisterWord(RegisterType::SP, 0x0882);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x11EE, 0xE0);
    CheckMemory(0x11EF, 0xE3);
    CheckMemory(0xFFE3, 0x37);
}

void test_E0_0116()
{
    if (skip_test_E0_0116)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8472);
    WriteRegisterWord(RegisterType::SP, 0x80D6);
    WriteRegisterByte(RegisterType::A, 0x3F);
    WriteRegisterByte(RegisterType::B, 0x32);
    WriteRegisterByte(RegisterType::C, 0x47);
    WriteRegisterByte(RegisterType::D, 0xDF);
    WriteRegisterByte(RegisterType::E, 0x97);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xCA);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5D, 0x00);
    WriteMemory(0x8473, 0x5D);
    WriteMemory(0x8472, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3F);
    CheckRegisterByte(RegisterType::B, 0x32);
    CheckRegisterByte(RegisterType::C, 0x47);
    CheckRegisterByte(RegisterType::D, 0xDF);
    CheckRegisterByte(RegisterType::E, 0x97);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xCA);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0x8474);
    CheckRegisterWord(RegisterType::SP, 0x80D6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8472, 0xE0);
    CheckMemory(0x8473, 0x5D);
    CheckMemory(0xFF5D, 0x3F);
}

void test_E0_0117()
{
    if (skip_test_E0_0117)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBA00);
    WriteRegisterWord(RegisterType::SP, 0x8452);
    WriteRegisterByte(RegisterType::A, 0x09);
    WriteRegisterByte(RegisterType::B, 0xF2);
    WriteRegisterByte(RegisterType::C, 0x8B);
    WriteRegisterByte(RegisterType::D, 0xA2);
    WriteRegisterByte(RegisterType::E, 0x26);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x33);
    WriteRegisterByte(RegisterType::L, 0xC2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5E, 0x00);
    WriteMemory(0xBA01, 0x5E);
    WriteMemory(0xBA00, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x09);
    CheckRegisterByte(RegisterType::B, 0xF2);
    CheckRegisterByte(RegisterType::C, 0x8B);
    CheckRegisterByte(RegisterType::D, 0xA2);
    CheckRegisterByte(RegisterType::E, 0x26);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x33);
    CheckRegisterByte(RegisterType::L, 0xC2);
    CheckRegisterWord(RegisterType::PC, 0xBA02);
    CheckRegisterWord(RegisterType::SP, 0x8452);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBA00, 0xE0);
    CheckMemory(0xBA01, 0x5E);
    CheckMemory(0xFF5E, 0x09);
}

void test_E0_0118()
{
    if (skip_test_E0_0118)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1ADC);
    WriteRegisterWord(RegisterType::SP, 0x2473);
    WriteRegisterByte(RegisterType::A, 0xF2);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0xDA);
    WriteRegisterByte(RegisterType::D, 0x25);
    WriteRegisterByte(RegisterType::E, 0xC3);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x56);
    WriteRegisterByte(RegisterType::L, 0x53);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA3, 0x00);
    WriteMemory(0x1ADD, 0xA3);
    WriteMemory(0x1ADC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF2);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0xDA);
    CheckRegisterByte(RegisterType::D, 0x25);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x56);
    CheckRegisterByte(RegisterType::L, 0x53);
    CheckRegisterWord(RegisterType::PC, 0x1ADE);
    CheckRegisterWord(RegisterType::SP, 0x2473);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1ADC, 0xE0);
    CheckMemory(0x1ADD, 0xA3);
    CheckMemory(0xFFA3, 0xF2);
}

void test_E0_0119()
{
    if (skip_test_E0_0119)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xACF0);
    WriteRegisterWord(RegisterType::SP, 0x482C);
    WriteRegisterByte(RegisterType::A, 0x10);
    WriteRegisterByte(RegisterType::B, 0xC7);
    WriteRegisterByte(RegisterType::C, 0x41);
    WriteRegisterByte(RegisterType::D, 0x4C);
    WriteRegisterByte(RegisterType::E, 0xF4);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xC0);
    WriteRegisterByte(RegisterType::L, 0xA2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF59, 0x00);
    WriteMemory(0xACF1, 0x59);
    WriteMemory(0xACF0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x10);
    CheckRegisterByte(RegisterType::B, 0xC7);
    CheckRegisterByte(RegisterType::C, 0x41);
    CheckRegisterByte(RegisterType::D, 0x4C);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xC0);
    CheckRegisterByte(RegisterType::L, 0xA2);
    CheckRegisterWord(RegisterType::PC, 0xACF2);
    CheckRegisterWord(RegisterType::SP, 0x482C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xACF0, 0xE0);
    CheckMemory(0xACF1, 0x59);
    CheckMemory(0xFF59, 0x10);
}

void test_E0_011A()
{
    if (skip_test_E0_011A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x064F);
    WriteRegisterWord(RegisterType::SP, 0x11D4);
    WriteRegisterByte(RegisterType::A, 0x73);
    WriteRegisterByte(RegisterType::B, 0xB9);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0x39);
    WriteRegisterByte(RegisterType::E, 0xDD);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x82);
    WriteRegisterByte(RegisterType::L, 0x07);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2F, 0x00);
    WriteMemory(0x0650, 0x2F);
    WriteMemory(0x064F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x73);
    CheckRegisterByte(RegisterType::B, 0xB9);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0x39);
    CheckRegisterByte(RegisterType::E, 0xDD);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x82);
    CheckRegisterByte(RegisterType::L, 0x07);
    CheckRegisterWord(RegisterType::PC, 0x0651);
    CheckRegisterWord(RegisterType::SP, 0x11D4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x064F, 0xE0);
    CheckMemory(0x0650, 0x2F);
    CheckMemory(0xFF2F, 0x73);
}

void test_E0_011B()
{
    if (skip_test_E0_011B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x163A);
    WriteRegisterWord(RegisterType::SP, 0x2F8B);
    WriteRegisterByte(RegisterType::A, 0x0C);
    WriteRegisterByte(RegisterType::B, 0x0F);
    WriteRegisterByte(RegisterType::C, 0x6C);
    WriteRegisterByte(RegisterType::D, 0x92);
    WriteRegisterByte(RegisterType::E, 0xBA);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xC1);
    WriteRegisterByte(RegisterType::L, 0xF2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3E, 0x00);
    WriteMemory(0x163B, 0x3E);
    WriteMemory(0x163A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0C);
    CheckRegisterByte(RegisterType::B, 0x0F);
    CheckRegisterByte(RegisterType::C, 0x6C);
    CheckRegisterByte(RegisterType::D, 0x92);
    CheckRegisterByte(RegisterType::E, 0xBA);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xC1);
    CheckRegisterByte(RegisterType::L, 0xF2);
    CheckRegisterWord(RegisterType::PC, 0x163C);
    CheckRegisterWord(RegisterType::SP, 0x2F8B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x163A, 0xE0);
    CheckMemory(0x163B, 0x3E);
    CheckMemory(0xFF3E, 0x0C);
}

void test_E0_011C()
{
    if (skip_test_E0_011C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD605);
    WriteRegisterWord(RegisterType::SP, 0x7991);
    WriteRegisterByte(RegisterType::A, 0x86);
    WriteRegisterByte(RegisterType::B, 0xE1);
    WriteRegisterByte(RegisterType::C, 0x54);
    WriteRegisterByte(RegisterType::D, 0x17);
    WriteRegisterByte(RegisterType::E, 0xA0);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x60);
    WriteRegisterByte(RegisterType::L, 0xA5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF70, 0x00);
    WriteMemory(0xD606, 0x70);
    WriteMemory(0xD605, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x86);
    CheckRegisterByte(RegisterType::B, 0xE1);
    CheckRegisterByte(RegisterType::C, 0x54);
    CheckRegisterByte(RegisterType::D, 0x17);
    CheckRegisterByte(RegisterType::E, 0xA0);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x60);
    CheckRegisterByte(RegisterType::L, 0xA5);
    CheckRegisterWord(RegisterType::PC, 0xD607);
    CheckRegisterWord(RegisterType::SP, 0x7991);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD605, 0xE0);
    CheckMemory(0xD606, 0x70);
    CheckMemory(0xFF70, 0x86);
}

void test_E0_011D()
{
    if (skip_test_E0_011D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x41DC);
    WriteRegisterWord(RegisterType::SP, 0xCC89);
    WriteRegisterByte(RegisterType::A, 0x48);
    WriteRegisterByte(RegisterType::B, 0x70);
    WriteRegisterByte(RegisterType::C, 0x99);
    WriteRegisterByte(RegisterType::D, 0x7D);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xF2);
    WriteRegisterByte(RegisterType::L, 0xE2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF24, 0x00);
    WriteMemory(0x41DD, 0x24);
    WriteMemory(0x41DC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x48);
    CheckRegisterByte(RegisterType::B, 0x70);
    CheckRegisterByte(RegisterType::C, 0x99);
    CheckRegisterByte(RegisterType::D, 0x7D);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xF2);
    CheckRegisterByte(RegisterType::L, 0xE2);
    CheckRegisterWord(RegisterType::PC, 0x41DE);
    CheckRegisterWord(RegisterType::SP, 0xCC89);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x41DC, 0xE0);
    CheckMemory(0x41DD, 0x24);
    CheckMemory(0xFF24, 0x48);
}

void test_E0_011E()
{
    if (skip_test_E0_011E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1612);
    WriteRegisterWord(RegisterType::SP, 0x2FE3);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0x31);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0x2A);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xCF);
    WriteRegisterByte(RegisterType::L, 0x4C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFBA, 0x00);
    WriteMemory(0x1613, 0xBA);
    WriteMemory(0x1612, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0x31);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0x2A);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xCF);
    CheckRegisterByte(RegisterType::L, 0x4C);
    CheckRegisterWord(RegisterType::PC, 0x1614);
    CheckRegisterWord(RegisterType::SP, 0x2FE3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1612, 0xE0);
    CheckMemory(0x1613, 0xBA);
    CheckMemory(0xFFBA, 0x44);
}

void test_E0_011F()
{
    if (skip_test_E0_011F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4CF8);
    WriteRegisterWord(RegisterType::SP, 0x3709);
    WriteRegisterByte(RegisterType::A, 0x83);
    WriteRegisterByte(RegisterType::B, 0xD6);
    WriteRegisterByte(RegisterType::C, 0x5E);
    WriteRegisterByte(RegisterType::D, 0x5B);
    WriteRegisterByte(RegisterType::E, 0xBB);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xB7);
    WriteRegisterByte(RegisterType::L, 0x79);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9F, 0x00);
    WriteMemory(0x4CF9, 0x9F);
    WriteMemory(0x4CF8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x83);
    CheckRegisterByte(RegisterType::B, 0xD6);
    CheckRegisterByte(RegisterType::C, 0x5E);
    CheckRegisterByte(RegisterType::D, 0x5B);
    CheckRegisterByte(RegisterType::E, 0xBB);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xB7);
    CheckRegisterByte(RegisterType::L, 0x79);
    CheckRegisterWord(RegisterType::PC, 0x4CFA);
    CheckRegisterWord(RegisterType::SP, 0x3709);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4CF8, 0xE0);
    CheckMemory(0x4CF9, 0x9F);
    CheckMemory(0xFF9F, 0x83);
}

void test_E0_0120()
{
    if (skip_test_E0_0120)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1E06);
    WriteRegisterWord(RegisterType::SP, 0xA9A9);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0x69);
    WriteRegisterByte(RegisterType::D, 0x5A);
    WriteRegisterByte(RegisterType::E, 0x77);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xDB);
    WriteRegisterByte(RegisterType::L, 0x63);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF75, 0x00);
    WriteMemory(0x1E07, 0x75);
    WriteMemory(0x1E06, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0x69);
    CheckRegisterByte(RegisterType::D, 0x5A);
    CheckRegisterByte(RegisterType::E, 0x77);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xDB);
    CheckRegisterByte(RegisterType::L, 0x63);
    CheckRegisterWord(RegisterType::PC, 0x1E08);
    CheckRegisterWord(RegisterType::SP, 0xA9A9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1E06, 0xE0);
    CheckMemory(0x1E07, 0x75);
    CheckMemory(0xFF75, 0x24);
}

void test_E0_0121()
{
    if (skip_test_E0_0121)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x808A);
    WriteRegisterWord(RegisterType::SP, 0x2453);
    WriteRegisterByte(RegisterType::A, 0xF6);
    WriteRegisterByte(RegisterType::B, 0xC0);
    WriteRegisterByte(RegisterType::C, 0x47);
    WriteRegisterByte(RegisterType::D, 0xC2);
    WriteRegisterByte(RegisterType::E, 0xEB);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x2C);
    WriteRegisterByte(RegisterType::L, 0x85);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF16, 0x00);
    WriteMemory(0x808B, 0x16);
    WriteMemory(0x808A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF6);
    CheckRegisterByte(RegisterType::B, 0xC0);
    CheckRegisterByte(RegisterType::C, 0x47);
    CheckRegisterByte(RegisterType::D, 0xC2);
    CheckRegisterByte(RegisterType::E, 0xEB);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x2C);
    CheckRegisterByte(RegisterType::L, 0x85);
    CheckRegisterWord(RegisterType::PC, 0x808C);
    CheckRegisterWord(RegisterType::SP, 0x2453);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x808A, 0xE0);
    CheckMemory(0x808B, 0x16);
    CheckMemory(0xFF16, 0xF6);
}

void test_E0_0122()
{
    if (skip_test_E0_0122)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9CB0);
    WriteRegisterWord(RegisterType::SP, 0xA957);
    WriteRegisterByte(RegisterType::A, 0xED);
    WriteRegisterByte(RegisterType::B, 0xE9);
    WriteRegisterByte(RegisterType::C, 0x03);
    WriteRegisterByte(RegisterType::D, 0x0D);
    WriteRegisterByte(RegisterType::E, 0x37);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0x17);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF31, 0x00);
    WriteMemory(0x9CB1, 0x31);
    WriteMemory(0x9CB0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xED);
    CheckRegisterByte(RegisterType::B, 0xE9);
    CheckRegisterByte(RegisterType::C, 0x03);
    CheckRegisterByte(RegisterType::D, 0x0D);
    CheckRegisterByte(RegisterType::E, 0x37);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0x17);
    CheckRegisterWord(RegisterType::PC, 0x9CB2);
    CheckRegisterWord(RegisterType::SP, 0xA957);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9CB0, 0xE0);
    CheckMemory(0x9CB1, 0x31);
    CheckMemory(0xFF31, 0xED);
}

void test_E0_0123()
{
    if (skip_test_E0_0123)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF4C6);
    WriteRegisterWord(RegisterType::SP, 0x8671);
    WriteRegisterByte(RegisterType::A, 0xF8);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0x51);
    WriteRegisterByte(RegisterType::D, 0x77);
    WriteRegisterByte(RegisterType::E, 0x0B);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xF3);
    WriteRegisterByte(RegisterType::L, 0xCF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF25, 0x00);
    WriteMemory(0xF4C7, 0x25);
    WriteMemory(0xF4C6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF8);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0x51);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0x0B);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xF3);
    CheckRegisterByte(RegisterType::L, 0xCF);
    CheckRegisterWord(RegisterType::PC, 0xF4C8);
    CheckRegisterWord(RegisterType::SP, 0x8671);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF4C6, 0xE0);
    CheckMemory(0xF4C7, 0x25);
    CheckMemory(0xFF25, 0xF8);
}

void test_E0_0124()
{
    if (skip_test_E0_0124)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2455);
    WriteRegisterWord(RegisterType::SP, 0x8AC6);
    WriteRegisterByte(RegisterType::A, 0xDE);
    WriteRegisterByte(RegisterType::B, 0x9F);
    WriteRegisterByte(RegisterType::C, 0xA3);
    WriteRegisterByte(RegisterType::D, 0x6F);
    WriteRegisterByte(RegisterType::E, 0xD2);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x96);
    WriteRegisterByte(RegisterType::L, 0x42);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF83, 0x00);
    WriteMemory(0x2456, 0x83);
    WriteMemory(0x2455, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDE);
    CheckRegisterByte(RegisterType::B, 0x9F);
    CheckRegisterByte(RegisterType::C, 0xA3);
    CheckRegisterByte(RegisterType::D, 0x6F);
    CheckRegisterByte(RegisterType::E, 0xD2);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x96);
    CheckRegisterByte(RegisterType::L, 0x42);
    CheckRegisterWord(RegisterType::PC, 0x2457);
    CheckRegisterWord(RegisterType::SP, 0x8AC6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2455, 0xE0);
    CheckMemory(0x2456, 0x83);
    CheckMemory(0xFF83, 0xDE);
}

void test_E0_0125()
{
    if (skip_test_E0_0125)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2490);
    WriteRegisterWord(RegisterType::SP, 0x5A68);
    WriteRegisterByte(RegisterType::A, 0x23);
    WriteRegisterByte(RegisterType::B, 0x43);
    WriteRegisterByte(RegisterType::C, 0xD1);
    WriteRegisterByte(RegisterType::D, 0xA2);
    WriteRegisterByte(RegisterType::E, 0x8F);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xA9);
    WriteRegisterByte(RegisterType::L, 0xD1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEB, 0x00);
    WriteMemory(0x2491, 0xEB);
    WriteMemory(0x2490, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x23);
    CheckRegisterByte(RegisterType::B, 0x43);
    CheckRegisterByte(RegisterType::C, 0xD1);
    CheckRegisterByte(RegisterType::D, 0xA2);
    CheckRegisterByte(RegisterType::E, 0x8F);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xA9);
    CheckRegisterByte(RegisterType::L, 0xD1);
    CheckRegisterWord(RegisterType::PC, 0x2492);
    CheckRegisterWord(RegisterType::SP, 0x5A68);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2490, 0xE0);
    CheckMemory(0x2491, 0xEB);
    CheckMemory(0xFFEB, 0x23);
}

void test_E0_0126()
{
    if (skip_test_E0_0126)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD01B);
    WriteRegisterWord(RegisterType::SP, 0x66E3);
    WriteRegisterByte(RegisterType::A, 0x48);
    WriteRegisterByte(RegisterType::B, 0x95);
    WriteRegisterByte(RegisterType::C, 0x8E);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0xEC);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xE3);
    WriteRegisterByte(RegisterType::L, 0x23);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAD, 0x00);
    WriteMemory(0xD01C, 0xAD);
    WriteMemory(0xD01B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x48);
    CheckRegisterByte(RegisterType::B, 0x95);
    CheckRegisterByte(RegisterType::C, 0x8E);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0xEC);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xE3);
    CheckRegisterByte(RegisterType::L, 0x23);
    CheckRegisterWord(RegisterType::PC, 0xD01D);
    CheckRegisterWord(RegisterType::SP, 0x66E3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD01B, 0xE0);
    CheckMemory(0xD01C, 0xAD);
    CheckMemory(0xFFAD, 0x48);
}

void test_E0_0127()
{
    if (skip_test_E0_0127)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x084C);
    WriteRegisterWord(RegisterType::SP, 0xA27F);
    WriteRegisterByte(RegisterType::A, 0x51);
    WriteRegisterByte(RegisterType::B, 0x04);
    WriteRegisterByte(RegisterType::C, 0x32);
    WriteRegisterByte(RegisterType::D, 0x5E);
    WriteRegisterByte(RegisterType::E, 0x85);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x6E);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD2, 0x00);
    WriteMemory(0x084D, 0xD2);
    WriteMemory(0x084C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x51);
    CheckRegisterByte(RegisterType::B, 0x04);
    CheckRegisterByte(RegisterType::C, 0x32);
    CheckRegisterByte(RegisterType::D, 0x5E);
    CheckRegisterByte(RegisterType::E, 0x85);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x6E);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0x084E);
    CheckRegisterWord(RegisterType::SP, 0xA27F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x084C, 0xE0);
    CheckMemory(0x084D, 0xD2);
    CheckMemory(0xFFD2, 0x51);
}

void test_E0_0128()
{
    if (skip_test_E0_0128)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC75D);
    WriteRegisterWord(RegisterType::SP, 0x98EA);
    WriteRegisterByte(RegisterType::A, 0x5D);
    WriteRegisterByte(RegisterType::B, 0xDD);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0x8B);
    WriteRegisterByte(RegisterType::E, 0x85);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x37);
    WriteRegisterByte(RegisterType::L, 0x97);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF09, 0x00);
    WriteMemory(0xC75E, 0x09);
    WriteMemory(0xC75D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5D);
    CheckRegisterByte(RegisterType::B, 0xDD);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0x8B);
    CheckRegisterByte(RegisterType::E, 0x85);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x37);
    CheckRegisterByte(RegisterType::L, 0x97);
    CheckRegisterWord(RegisterType::PC, 0xC75F);
    CheckRegisterWord(RegisterType::SP, 0x98EA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC75D, 0xE0);
    CheckMemory(0xC75E, 0x09);
    CheckMemory(0xFF09, 0x5D);
}

void test_E0_0129()
{
    if (skip_test_E0_0129)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5DCD);
    WriteRegisterWord(RegisterType::SP, 0x2D3E);
    WriteRegisterByte(RegisterType::A, 0x59);
    WriteRegisterByte(RegisterType::B, 0x60);
    WriteRegisterByte(RegisterType::C, 0xD8);
    WriteRegisterByte(RegisterType::D, 0x75);
    WriteRegisterByte(RegisterType::E, 0xE8);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xC8);
    WriteRegisterByte(RegisterType::L, 0xF0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC4, 0x00);
    WriteMemory(0x5DCE, 0xC4);
    WriteMemory(0x5DCD, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x59);
    CheckRegisterByte(RegisterType::B, 0x60);
    CheckRegisterByte(RegisterType::C, 0xD8);
    CheckRegisterByte(RegisterType::D, 0x75);
    CheckRegisterByte(RegisterType::E, 0xE8);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xC8);
    CheckRegisterByte(RegisterType::L, 0xF0);
    CheckRegisterWord(RegisterType::PC, 0x5DCF);
    CheckRegisterWord(RegisterType::SP, 0x2D3E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5DCD, 0xE0);
    CheckMemory(0x5DCE, 0xC4);
    CheckMemory(0xFFC4, 0x59);
}

void test_E0_012A()
{
    if (skip_test_E0_012A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0598);
    WriteRegisterWord(RegisterType::SP, 0xE3D1);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0x27);
    WriteRegisterByte(RegisterType::C, 0x1B);
    WriteRegisterByte(RegisterType::D, 0xDC);
    WriteRegisterByte(RegisterType::E, 0xB3);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x99);
    WriteRegisterByte(RegisterType::L, 0xFE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEB, 0x00);
    WriteMemory(0x0599, 0xEB);
    WriteMemory(0x0598, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0x27);
    CheckRegisterByte(RegisterType::C, 0x1B);
    CheckRegisterByte(RegisterType::D, 0xDC);
    CheckRegisterByte(RegisterType::E, 0xB3);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x99);
    CheckRegisterByte(RegisterType::L, 0xFE);
    CheckRegisterWord(RegisterType::PC, 0x059A);
    CheckRegisterWord(RegisterType::SP, 0xE3D1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0598, 0xE0);
    CheckMemory(0x0599, 0xEB);
    CheckMemory(0xFFEB, 0x71);
}

void test_E0_012B()
{
    if (skip_test_E0_012B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x89AA);
    WriteRegisterWord(RegisterType::SP, 0x5A83);
    WriteRegisterByte(RegisterType::A, 0xFC);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0xA7);
    WriteRegisterByte(RegisterType::D, 0x1E);
    WriteRegisterByte(RegisterType::E, 0xDE);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x9E);
    WriteRegisterByte(RegisterType::L, 0x45);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF96, 0x00);
    WriteMemory(0x89AB, 0x96);
    WriteMemory(0x89AA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFC);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0xA7);
    CheckRegisterByte(RegisterType::D, 0x1E);
    CheckRegisterByte(RegisterType::E, 0xDE);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x9E);
    CheckRegisterByte(RegisterType::L, 0x45);
    CheckRegisterWord(RegisterType::PC, 0x89AC);
    CheckRegisterWord(RegisterType::SP, 0x5A83);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x89AA, 0xE0);
    CheckMemory(0x89AB, 0x96);
    CheckMemory(0xFF96, 0xFC);
}

void test_E0_012C()
{
    if (skip_test_E0_012C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0ECB);
    WriteRegisterWord(RegisterType::SP, 0x9580);
    WriteRegisterByte(RegisterType::A, 0x10);
    WriteRegisterByte(RegisterType::B, 0x77);
    WriteRegisterByte(RegisterType::C, 0xD3);
    WriteRegisterByte(RegisterType::D, 0xEB);
    WriteRegisterByte(RegisterType::E, 0xE8);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0xBA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6E, 0x00);
    WriteMemory(0x0ECC, 0x6E);
    WriteMemory(0x0ECB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x10);
    CheckRegisterByte(RegisterType::B, 0x77);
    CheckRegisterByte(RegisterType::C, 0xD3);
    CheckRegisterByte(RegisterType::D, 0xEB);
    CheckRegisterByte(RegisterType::E, 0xE8);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0xBA);
    CheckRegisterWord(RegisterType::PC, 0x0ECD);
    CheckRegisterWord(RegisterType::SP, 0x9580);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0ECB, 0xE0);
    CheckMemory(0x0ECC, 0x6E);
    CheckMemory(0xFF6E, 0x10);
}

void test_E0_012D()
{
    if (skip_test_E0_012D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6261);
    WriteRegisterWord(RegisterType::SP, 0x2F00);
    WriteRegisterByte(RegisterType::A, 0x3C);
    WriteRegisterByte(RegisterType::B, 0xE4);
    WriteRegisterByte(RegisterType::C, 0x02);
    WriteRegisterByte(RegisterType::D, 0x0D);
    WriteRegisterByte(RegisterType::E, 0x34);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xFE);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF26, 0x00);
    WriteMemory(0x6262, 0x26);
    WriteMemory(0x6261, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3C);
    CheckRegisterByte(RegisterType::B, 0xE4);
    CheckRegisterByte(RegisterType::C, 0x02);
    CheckRegisterByte(RegisterType::D, 0x0D);
    CheckRegisterByte(RegisterType::E, 0x34);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xFE);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0x6263);
    CheckRegisterWord(RegisterType::SP, 0x2F00);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6261, 0xE0);
    CheckMemory(0x6262, 0x26);
    CheckMemory(0xFF26, 0x3C);
}

void test_E0_012E()
{
    if (skip_test_E0_012E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF07B);
    WriteRegisterWord(RegisterType::SP, 0xCED2);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0xCD);
    WriteRegisterByte(RegisterType::C, 0x36);
    WriteRegisterByte(RegisterType::D, 0xFF);
    WriteRegisterByte(RegisterType::E, 0xC0);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x7F);
    WriteRegisterByte(RegisterType::L, 0x8A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF74, 0x00);
    WriteMemory(0xF07C, 0x74);
    WriteMemory(0xF07B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0xCD);
    CheckRegisterByte(RegisterType::C, 0x36);
    CheckRegisterByte(RegisterType::D, 0xFF);
    CheckRegisterByte(RegisterType::E, 0xC0);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x7F);
    CheckRegisterByte(RegisterType::L, 0x8A);
    CheckRegisterWord(RegisterType::PC, 0xF07D);
    CheckRegisterWord(RegisterType::SP, 0xCED2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF07B, 0xE0);
    CheckMemory(0xF07C, 0x74);
    CheckMemory(0xFF74, 0x72);
}

void test_E0_012F()
{
    if (skip_test_E0_012F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB34B);
    WriteRegisterWord(RegisterType::SP, 0x9665);
    WriteRegisterByte(RegisterType::A, 0x5F);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0x81);
    WriteRegisterByte(RegisterType::E, 0x85);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x2E);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC9, 0x00);
    WriteMemory(0xB34C, 0xC9);
    WriteMemory(0xB34B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5F);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0x85);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x2E);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0xB34D);
    CheckRegisterWord(RegisterType::SP, 0x9665);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB34B, 0xE0);
    CheckMemory(0xB34C, 0xC9);
    CheckMemory(0xFFC9, 0x5F);
}

void test_E0_0130()
{
    if (skip_test_E0_0130)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1AED);
    WriteRegisterWord(RegisterType::SP, 0x1582);
    WriteRegisterByte(RegisterType::A, 0x62);
    WriteRegisterByte(RegisterType::B, 0x3E);
    WriteRegisterByte(RegisterType::C, 0x02);
    WriteRegisterByte(RegisterType::D, 0x1D);
    WriteRegisterByte(RegisterType::E, 0xED);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0xC3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCB, 0x00);
    WriteMemory(0x1AEE, 0xCB);
    WriteMemory(0x1AED, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x62);
    CheckRegisterByte(RegisterType::B, 0x3E);
    CheckRegisterByte(RegisterType::C, 0x02);
    CheckRegisterByte(RegisterType::D, 0x1D);
    CheckRegisterByte(RegisterType::E, 0xED);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0xC3);
    CheckRegisterWord(RegisterType::PC, 0x1AEF);
    CheckRegisterWord(RegisterType::SP, 0x1582);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1AED, 0xE0);
    CheckMemory(0x1AEE, 0xCB);
    CheckMemory(0xFFCB, 0x62);
}

void test_E0_0131()
{
    if (skip_test_E0_0131)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x256C);
    WriteRegisterWord(RegisterType::SP, 0x7B36);
    WriteRegisterByte(RegisterType::A, 0x1D);
    WriteRegisterByte(RegisterType::B, 0x9C);
    WriteRegisterByte(RegisterType::C, 0x5C);
    WriteRegisterByte(RegisterType::D, 0xF9);
    WriteRegisterByte(RegisterType::E, 0x92);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x99);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF1E, 0x00);
    WriteMemory(0x256D, 0x1E);
    WriteMemory(0x256C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1D);
    CheckRegisterByte(RegisterType::B, 0x9C);
    CheckRegisterByte(RegisterType::C, 0x5C);
    CheckRegisterByte(RegisterType::D, 0xF9);
    CheckRegisterByte(RegisterType::E, 0x92);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x99);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0x256E);
    CheckRegisterWord(RegisterType::SP, 0x7B36);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x256C, 0xE0);
    CheckMemory(0x256D, 0x1E);
    CheckMemory(0xFF1E, 0x1D);
}

void test_E0_0132()
{
    if (skip_test_E0_0132)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6B0B);
    WriteRegisterWord(RegisterType::SP, 0xBE63);
    WriteRegisterByte(RegisterType::A, 0x22);
    WriteRegisterByte(RegisterType::B, 0x5B);
    WriteRegisterByte(RegisterType::C, 0x96);
    WriteRegisterByte(RegisterType::D, 0x4F);
    WriteRegisterByte(RegisterType::E, 0x4D);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xDC);
    WriteRegisterByte(RegisterType::L, 0xF7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCA, 0x00);
    WriteMemory(0x6B0C, 0xCA);
    WriteMemory(0x6B0B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x22);
    CheckRegisterByte(RegisterType::B, 0x5B);
    CheckRegisterByte(RegisterType::C, 0x96);
    CheckRegisterByte(RegisterType::D, 0x4F);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xDC);
    CheckRegisterByte(RegisterType::L, 0xF7);
    CheckRegisterWord(RegisterType::PC, 0x6B0D);
    CheckRegisterWord(RegisterType::SP, 0xBE63);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6B0B, 0xE0);
    CheckMemory(0x6B0C, 0xCA);
    CheckMemory(0xFFCA, 0x22);
}

void test_E0_0133()
{
    if (skip_test_E0_0133)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA6D4);
    WriteRegisterWord(RegisterType::SP, 0x75FC);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0x63);
    WriteRegisterByte(RegisterType::D, 0x7A);
    WriteRegisterByte(RegisterType::E, 0x90);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x1C);
    WriteRegisterByte(RegisterType::L, 0x27);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF39, 0x00);
    WriteMemory(0xA6D5, 0x39);
    WriteMemory(0xA6D4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0x63);
    CheckRegisterByte(RegisterType::D, 0x7A);
    CheckRegisterByte(RegisterType::E, 0x90);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x1C);
    CheckRegisterByte(RegisterType::L, 0x27);
    CheckRegisterWord(RegisterType::PC, 0xA6D6);
    CheckRegisterWord(RegisterType::SP, 0x75FC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA6D4, 0xE0);
    CheckMemory(0xA6D5, 0x39);
    CheckMemory(0xFF39, 0xD9);
}

void test_E0_0134()
{
    if (skip_test_E0_0134)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEFB4);
    WriteRegisterWord(RegisterType::SP, 0xAFCD);
    WriteRegisterByte(RegisterType::A, 0x01);
    WriteRegisterByte(RegisterType::B, 0xA2);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0xB4);
    WriteRegisterByte(RegisterType::E, 0xD4);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x6A);
    WriteRegisterByte(RegisterType::L, 0xA5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF29, 0x00);
    WriteMemory(0xEFB5, 0x29);
    WriteMemory(0xEFB4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x01);
    CheckRegisterByte(RegisterType::B, 0xA2);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0xB4);
    CheckRegisterByte(RegisterType::E, 0xD4);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x6A);
    CheckRegisterByte(RegisterType::L, 0xA5);
    CheckRegisterWord(RegisterType::PC, 0xEFB6);
    CheckRegisterWord(RegisterType::SP, 0xAFCD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xEFB4, 0xE0);
    CheckMemory(0xEFB5, 0x29);
    CheckMemory(0xFF29, 0x01);
}

void test_E0_0135()
{
    if (skip_test_E0_0135)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2635);
    WriteRegisterWord(RegisterType::SP, 0xD59D);
    WriteRegisterByte(RegisterType::A, 0xF4);
    WriteRegisterByte(RegisterType::B, 0xAA);
    WriteRegisterByte(RegisterType::C, 0x93);
    WriteRegisterByte(RegisterType::D, 0x80);
    WriteRegisterByte(RegisterType::E, 0xB4);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xD9);
    WriteRegisterByte(RegisterType::L, 0xE7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF09, 0x00);
    WriteMemory(0x2636, 0x09);
    WriteMemory(0x2635, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF4);
    CheckRegisterByte(RegisterType::B, 0xAA);
    CheckRegisterByte(RegisterType::C, 0x93);
    CheckRegisterByte(RegisterType::D, 0x80);
    CheckRegisterByte(RegisterType::E, 0xB4);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xD9);
    CheckRegisterByte(RegisterType::L, 0xE7);
    CheckRegisterWord(RegisterType::PC, 0x2637);
    CheckRegisterWord(RegisterType::SP, 0xD59D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2635, 0xE0);
    CheckMemory(0x2636, 0x09);
    CheckMemory(0xFF09, 0xF4);
}

void test_E0_0136()
{
    if (skip_test_E0_0136)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5392);
    WriteRegisterWord(RegisterType::SP, 0x00F3);
    WriteRegisterByte(RegisterType::A, 0x3F);
    WriteRegisterByte(RegisterType::B, 0x66);
    WriteRegisterByte(RegisterType::C, 0xCF);
    WriteRegisterByte(RegisterType::D, 0x18);
    WriteRegisterByte(RegisterType::E, 0x50);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x4D);
    WriteRegisterByte(RegisterType::L, 0x8D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF6, 0x00);
    WriteMemory(0x5393, 0xF6);
    WriteMemory(0x5392, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3F);
    CheckRegisterByte(RegisterType::B, 0x66);
    CheckRegisterByte(RegisterType::C, 0xCF);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0x50);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x4D);
    CheckRegisterByte(RegisterType::L, 0x8D);
    CheckRegisterWord(RegisterType::PC, 0x5394);
    CheckRegisterWord(RegisterType::SP, 0x00F3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5392, 0xE0);
    CheckMemory(0x5393, 0xF6);
    CheckMemory(0xFFF6, 0x3F);
}

void test_E0_0137()
{
    if (skip_test_E0_0137)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3E99);
    WriteRegisterWord(RegisterType::SP, 0x4DAC);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0x3C);
    WriteRegisterByte(RegisterType::D, 0x9E);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x67);
    WriteRegisterByte(RegisterType::L, 0x70);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE4, 0x00);
    WriteMemory(0x3E9A, 0xE4);
    WriteMemory(0x3E99, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0x3C);
    CheckRegisterByte(RegisterType::D, 0x9E);
    CheckRegisterByte(RegisterType::E, 0xA5);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x67);
    CheckRegisterByte(RegisterType::L, 0x70);
    CheckRegisterWord(RegisterType::PC, 0x3E9B);
    CheckRegisterWord(RegisterType::SP, 0x4DAC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3E99, 0xE0);
    CheckMemory(0x3E9A, 0xE4);
    CheckMemory(0xFFE4, 0x9B);
}

void test_E0_0138()
{
    if (skip_test_E0_0138)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBE9F);
    WriteRegisterWord(RegisterType::SP, 0x6E4E);
    WriteRegisterByte(RegisterType::A, 0xE2);
    WriteRegisterByte(RegisterType::B, 0xBF);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0xD2);
    WriteRegisterByte(RegisterType::E, 0x2A);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x91);
    WriteRegisterByte(RegisterType::L, 0x9D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6C, 0x00);
    WriteMemory(0xBEA0, 0x6C);
    WriteMemory(0xBE9F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE2);
    CheckRegisterByte(RegisterType::B, 0xBF);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0xD2);
    CheckRegisterByte(RegisterType::E, 0x2A);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x91);
    CheckRegisterByte(RegisterType::L, 0x9D);
    CheckRegisterWord(RegisterType::PC, 0xBEA1);
    CheckRegisterWord(RegisterType::SP, 0x6E4E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBE9F, 0xE0);
    CheckMemory(0xBEA0, 0x6C);
    CheckMemory(0xFF6C, 0xE2);
}

void test_E0_0139()
{
    if (skip_test_E0_0139)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD0C1);
    WriteRegisterWord(RegisterType::SP, 0x7033);
    WriteRegisterByte(RegisterType::A, 0x3F);
    WriteRegisterByte(RegisterType::B, 0x91);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0xC1);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x3B);
    WriteRegisterByte(RegisterType::L, 0xF2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFBF, 0x00);
    WriteMemory(0xD0C2, 0xBF);
    WriteMemory(0xD0C1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3F);
    CheckRegisterByte(RegisterType::B, 0x91);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0x99);
    CheckRegisterByte(RegisterType::E, 0xC1);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x3B);
    CheckRegisterByte(RegisterType::L, 0xF2);
    CheckRegisterWord(RegisterType::PC, 0xD0C3);
    CheckRegisterWord(RegisterType::SP, 0x7033);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD0C1, 0xE0);
    CheckMemory(0xD0C2, 0xBF);
    CheckMemory(0xFFBF, 0x3F);
}

void test_E0_013A()
{
    if (skip_test_E0_013A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0B66);
    WriteRegisterWord(RegisterType::SP, 0xD60E);
    WriteRegisterByte(RegisterType::A, 0xF4);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0xFA);
    WriteRegisterByte(RegisterType::D, 0xBA);
    WriteRegisterByte(RegisterType::E, 0xAD);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x24);
    WriteRegisterByte(RegisterType::L, 0xE0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2F, 0x00);
    WriteMemory(0x0B67, 0x2F);
    WriteMemory(0x0B66, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF4);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0xFA);
    CheckRegisterByte(RegisterType::D, 0xBA);
    CheckRegisterByte(RegisterType::E, 0xAD);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x24);
    CheckRegisterByte(RegisterType::L, 0xE0);
    CheckRegisterWord(RegisterType::PC, 0x0B68);
    CheckRegisterWord(RegisterType::SP, 0xD60E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0B66, 0xE0);
    CheckMemory(0x0B67, 0x2F);
    CheckMemory(0xFF2F, 0xF4);
}

void test_E0_013B()
{
    if (skip_test_E0_013B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4C87);
    WriteRegisterWord(RegisterType::SP, 0x7BB1);
    WriteRegisterByte(RegisterType::A, 0x2F);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0x65);
    WriteRegisterByte(RegisterType::D, 0x53);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x42);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF33, 0x00);
    WriteMemory(0x4C88, 0x33);
    WriteMemory(0x4C87, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2F);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0x65);
    CheckRegisterByte(RegisterType::D, 0x53);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x42);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0x4C89);
    CheckRegisterWord(RegisterType::SP, 0x7BB1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4C87, 0xE0);
    CheckMemory(0x4C88, 0x33);
    CheckMemory(0xFF33, 0x2F);
}

void test_E0_013C()
{
    if (skip_test_E0_013C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0094);
    WriteRegisterWord(RegisterType::SP, 0xC441);
    WriteRegisterByte(RegisterType::A, 0x82);
    WriteRegisterByte(RegisterType::B, 0xD4);
    WriteRegisterByte(RegisterType::C, 0x49);
    WriteRegisterByte(RegisterType::D, 0x90);
    WriteRegisterByte(RegisterType::E, 0x02);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xDA);
    WriteRegisterByte(RegisterType::L, 0x2A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4C, 0x00);
    WriteMemory(0x0095, 0x4C);
    WriteMemory(0x0094, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x82);
    CheckRegisterByte(RegisterType::B, 0xD4);
    CheckRegisterByte(RegisterType::C, 0x49);
    CheckRegisterByte(RegisterType::D, 0x90);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xDA);
    CheckRegisterByte(RegisterType::L, 0x2A);
    CheckRegisterWord(RegisterType::PC, 0x0096);
    CheckRegisterWord(RegisterType::SP, 0xC441);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0094, 0xE0);
    CheckMemory(0x0095, 0x4C);
    CheckMemory(0xFF4C, 0x82);
}

void test_E0_013D()
{
    if (skip_test_E0_013D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAD0A);
    WriteRegisterWord(RegisterType::SP, 0x132A);
    WriteRegisterByte(RegisterType::A, 0x06);
    WriteRegisterByte(RegisterType::B, 0x47);
    WriteRegisterByte(RegisterType::C, 0xD5);
    WriteRegisterByte(RegisterType::D, 0x0F);
    WriteRegisterByte(RegisterType::E, 0xB8);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x5D);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF35, 0x00);
    WriteMemory(0xAD0B, 0x35);
    WriteMemory(0xAD0A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x06);
    CheckRegisterByte(RegisterType::B, 0x47);
    CheckRegisterByte(RegisterType::C, 0xD5);
    CheckRegisterByte(RegisterType::D, 0x0F);
    CheckRegisterByte(RegisterType::E, 0xB8);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x5D);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0xAD0C);
    CheckRegisterWord(RegisterType::SP, 0x132A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAD0A, 0xE0);
    CheckMemory(0xAD0B, 0x35);
    CheckMemory(0xFF35, 0x06);
}

void test_E0_013E()
{
    if (skip_test_E0_013E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB998);
    WriteRegisterWord(RegisterType::SP, 0x4EF3);
    WriteRegisterByte(RegisterType::A, 0x65);
    WriteRegisterByte(RegisterType::B, 0x7B);
    WriteRegisterByte(RegisterType::C, 0x60);
    WriteRegisterByte(RegisterType::D, 0x2F);
    WriteRegisterByte(RegisterType::E, 0xF7);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x56);
    WriteRegisterByte(RegisterType::L, 0x94);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB3, 0x00);
    WriteMemory(0xB999, 0xB3);
    WriteMemory(0xB998, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x65);
    CheckRegisterByte(RegisterType::B, 0x7B);
    CheckRegisterByte(RegisterType::C, 0x60);
    CheckRegisterByte(RegisterType::D, 0x2F);
    CheckRegisterByte(RegisterType::E, 0xF7);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x56);
    CheckRegisterByte(RegisterType::L, 0x94);
    CheckRegisterWord(RegisterType::PC, 0xB99A);
    CheckRegisterWord(RegisterType::SP, 0x4EF3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB998, 0xE0);
    CheckMemory(0xB999, 0xB3);
    CheckMemory(0xFFB3, 0x65);
}

void test_E0_013F()
{
    if (skip_test_E0_013F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8D22);
    WriteRegisterWord(RegisterType::SP, 0xBBE6);
    WriteRegisterByte(RegisterType::A, 0xD8);
    WriteRegisterByte(RegisterType::B, 0xDD);
    WriteRegisterByte(RegisterType::C, 0x55);
    WriteRegisterByte(RegisterType::D, 0x8C);
    WriteRegisterByte(RegisterType::E, 0xCB);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xC1);
    WriteRegisterByte(RegisterType::L, 0x7D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD2, 0x00);
    WriteMemory(0x8D23, 0xD2);
    WriteMemory(0x8D22, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD8);
    CheckRegisterByte(RegisterType::B, 0xDD);
    CheckRegisterByte(RegisterType::C, 0x55);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0xCB);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xC1);
    CheckRegisterByte(RegisterType::L, 0x7D);
    CheckRegisterWord(RegisterType::PC, 0x8D24);
    CheckRegisterWord(RegisterType::SP, 0xBBE6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8D22, 0xE0);
    CheckMemory(0x8D23, 0xD2);
    CheckMemory(0xFFD2, 0xD8);
}

void test_E0_0140()
{
    if (skip_test_E0_0140)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0F91);
    WriteRegisterWord(RegisterType::SP, 0xFA2D);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0x6D);
    WriteRegisterByte(RegisterType::C, 0x44);
    WriteRegisterByte(RegisterType::D, 0x59);
    WriteRegisterByte(RegisterType::E, 0xA9);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xD9);
    WriteRegisterByte(RegisterType::L, 0x85);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE8, 0x00);
    WriteMemory(0x0F92, 0xE8);
    WriteMemory(0x0F91, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0x6D);
    CheckRegisterByte(RegisterType::C, 0x44);
    CheckRegisterByte(RegisterType::D, 0x59);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xD9);
    CheckRegisterByte(RegisterType::L, 0x85);
    CheckRegisterWord(RegisterType::PC, 0x0F93);
    CheckRegisterWord(RegisterType::SP, 0xFA2D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0F91, 0xE0);
    CheckMemory(0x0F92, 0xE8);
    CheckMemory(0xFFE8, 0x72);
}

void test_E0_0141()
{
    if (skip_test_E0_0141)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD01E);
    WriteRegisterWord(RegisterType::SP, 0xE561);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0x41);
    WriteRegisterByte(RegisterType::C, 0x8C);
    WriteRegisterByte(RegisterType::D, 0x0E);
    WriteRegisterByte(RegisterType::E, 0xEC);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x79);
    WriteRegisterByte(RegisterType::L, 0x5E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFF, 0x00);
    WriteMemory(0xD01F, 0xFF);
    WriteMemory(0xD01E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0x41);
    CheckRegisterByte(RegisterType::C, 0x8C);
    CheckRegisterByte(RegisterType::D, 0x0E);
    CheckRegisterByte(RegisterType::E, 0xEC);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x79);
    CheckRegisterByte(RegisterType::L, 0x5E);
    CheckRegisterWord(RegisterType::PC, 0xD020);
    CheckRegisterWord(RegisterType::SP, 0xE561);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD01E, 0xE0);
    CheckMemory(0xD01F, 0xFF);
    CheckMemory(0xFFFF, 0x56);
}

void test_E0_0142()
{
    if (skip_test_E0_0142)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x46A4);
    WriteRegisterWord(RegisterType::SP, 0xA753);
    WriteRegisterByte(RegisterType::A, 0xDF);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0xD2);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0x4A);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x4A);
    WriteRegisterByte(RegisterType::L, 0xA0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB8, 0x00);
    WriteMemory(0x46A5, 0xB8);
    WriteMemory(0x46A4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDF);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0xD2);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0x4A);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x4A);
    CheckRegisterByte(RegisterType::L, 0xA0);
    CheckRegisterWord(RegisterType::PC, 0x46A6);
    CheckRegisterWord(RegisterType::SP, 0xA753);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x46A4, 0xE0);
    CheckMemory(0x46A5, 0xB8);
    CheckMemory(0xFFB8, 0xDF);
}

void test_E0_0143()
{
    if (skip_test_E0_0143)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3C1A);
    WriteRegisterWord(RegisterType::SP, 0xD574);
    WriteRegisterByte(RegisterType::A, 0xCE);
    WriteRegisterByte(RegisterType::B, 0x49);
    WriteRegisterByte(RegisterType::C, 0x5F);
    WriteRegisterByte(RegisterType::D, 0x79);
    WriteRegisterByte(RegisterType::E, 0xB7);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x4B);
    WriteRegisterByte(RegisterType::L, 0xB0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF73, 0x00);
    WriteMemory(0x3C1B, 0x73);
    WriteMemory(0x3C1A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCE);
    CheckRegisterByte(RegisterType::B, 0x49);
    CheckRegisterByte(RegisterType::C, 0x5F);
    CheckRegisterByte(RegisterType::D, 0x79);
    CheckRegisterByte(RegisterType::E, 0xB7);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x4B);
    CheckRegisterByte(RegisterType::L, 0xB0);
    CheckRegisterWord(RegisterType::PC, 0x3C1C);
    CheckRegisterWord(RegisterType::SP, 0xD574);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3C1A, 0xE0);
    CheckMemory(0x3C1B, 0x73);
    CheckMemory(0xFF73, 0xCE);
}

void test_E0_0144()
{
    if (skip_test_E0_0144)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9A4E);
    WriteRegisterWord(RegisterType::SP, 0x9E30);
    WriteRegisterByte(RegisterType::A, 0x35);
    WriteRegisterByte(RegisterType::B, 0x77);
    WriteRegisterByte(RegisterType::C, 0xB8);
    WriteRegisterByte(RegisterType::D, 0xF8);
    WriteRegisterByte(RegisterType::E, 0xD4);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x43);
    WriteRegisterByte(RegisterType::L, 0x6F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAD, 0x00);
    WriteMemory(0x9A4F, 0xAD);
    WriteMemory(0x9A4E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x35);
    CheckRegisterByte(RegisterType::B, 0x77);
    CheckRegisterByte(RegisterType::C, 0xB8);
    CheckRegisterByte(RegisterType::D, 0xF8);
    CheckRegisterByte(RegisterType::E, 0xD4);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x43);
    CheckRegisterByte(RegisterType::L, 0x6F);
    CheckRegisterWord(RegisterType::PC, 0x9A50);
    CheckRegisterWord(RegisterType::SP, 0x9E30);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9A4E, 0xE0);
    CheckMemory(0x9A4F, 0xAD);
    CheckMemory(0xFFAD, 0x35);
}

void test_E0_0145()
{
    if (skip_test_E0_0145)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x75A1);
    WriteRegisterWord(RegisterType::SP, 0x7716);
    WriteRegisterByte(RegisterType::A, 0xC5);
    WriteRegisterByte(RegisterType::B, 0x55);
    WriteRegisterByte(RegisterType::C, 0x00);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xD4);
    WriteRegisterByte(RegisterType::L, 0x03);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF83, 0x00);
    WriteMemory(0x75A2, 0x83);
    WriteMemory(0x75A1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC5);
    CheckRegisterByte(RegisterType::B, 0x55);
    CheckRegisterByte(RegisterType::C, 0x00);
    CheckRegisterByte(RegisterType::D, 0x76);
    CheckRegisterByte(RegisterType::E, 0xDC);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xD4);
    CheckRegisterByte(RegisterType::L, 0x03);
    CheckRegisterWord(RegisterType::PC, 0x75A3);
    CheckRegisterWord(RegisterType::SP, 0x7716);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x75A1, 0xE0);
    CheckMemory(0x75A2, 0x83);
    CheckMemory(0xFF83, 0xC5);
}

void test_E0_0146()
{
    if (skip_test_E0_0146)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF5A5);
    WriteRegisterWord(RegisterType::SP, 0xC384);
    WriteRegisterByte(RegisterType::A, 0x3E);
    WriteRegisterByte(RegisterType::B, 0xED);
    WriteRegisterByte(RegisterType::C, 0x5B);
    WriteRegisterByte(RegisterType::D, 0x92);
    WriteRegisterByte(RegisterType::E, 0x5B);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0x39);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF58, 0x00);
    WriteMemory(0xF5A6, 0x58);
    WriteMemory(0xF5A5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3E);
    CheckRegisterByte(RegisterType::B, 0xED);
    CheckRegisterByte(RegisterType::C, 0x5B);
    CheckRegisterByte(RegisterType::D, 0x92);
    CheckRegisterByte(RegisterType::E, 0x5B);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0x39);
    CheckRegisterWord(RegisterType::PC, 0xF5A7);
    CheckRegisterWord(RegisterType::SP, 0xC384);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF5A5, 0xE0);
    CheckMemory(0xF5A6, 0x58);
    CheckMemory(0xFF58, 0x3E);
}

void test_E0_0147()
{
    if (skip_test_E0_0147)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAF74);
    WriteRegisterWord(RegisterType::SP, 0xEBCB);
    WriteRegisterByte(RegisterType::A, 0xB3);
    WriteRegisterByte(RegisterType::B, 0xBD);
    WriteRegisterByte(RegisterType::C, 0x72);
    WriteRegisterByte(RegisterType::D, 0x38);
    WriteRegisterByte(RegisterType::E, 0x54);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x6E);
    WriteRegisterByte(RegisterType::L, 0x69);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF03, 0x00);
    WriteMemory(0xAF75, 0x03);
    WriteMemory(0xAF74, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB3);
    CheckRegisterByte(RegisterType::B, 0xBD);
    CheckRegisterByte(RegisterType::C, 0x72);
    CheckRegisterByte(RegisterType::D, 0x38);
    CheckRegisterByte(RegisterType::E, 0x54);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x6E);
    CheckRegisterByte(RegisterType::L, 0x69);
    CheckRegisterWord(RegisterType::PC, 0xAF76);
    CheckRegisterWord(RegisterType::SP, 0xEBCB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAF74, 0xE0);
    CheckMemory(0xAF75, 0x03);
    CheckMemory(0xFF03, 0xB3);
}

void test_E0_0148()
{
    if (skip_test_E0_0148)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFDD7);
    WriteRegisterWord(RegisterType::SP, 0xE11A);
    WriteRegisterByte(RegisterType::A, 0x1B);
    WriteRegisterByte(RegisterType::B, 0x80);
    WriteRegisterByte(RegisterType::C, 0x8E);
    WriteRegisterByte(RegisterType::D, 0xB1);
    WriteRegisterByte(RegisterType::E, 0x63);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0x12);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5F, 0x00);
    WriteMemory(0xFDD8, 0x5F);
    WriteMemory(0xFDD7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1B);
    CheckRegisterByte(RegisterType::B, 0x80);
    CheckRegisterByte(RegisterType::C, 0x8E);
    CheckRegisterByte(RegisterType::D, 0xB1);
    CheckRegisterByte(RegisterType::E, 0x63);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0x12);
    CheckRegisterWord(RegisterType::PC, 0xFDD9);
    CheckRegisterWord(RegisterType::SP, 0xE11A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFDD7, 0xE0);
    CheckMemory(0xFDD8, 0x5F);
    CheckMemory(0xFF5F, 0x1B);
}

void test_E0_0149()
{
    if (skip_test_E0_0149)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4268);
    WriteRegisterWord(RegisterType::SP, 0x3619);
    WriteRegisterByte(RegisterType::A, 0x65);
    WriteRegisterByte(RegisterType::B, 0xB2);
    WriteRegisterByte(RegisterType::C, 0x86);
    WriteRegisterByte(RegisterType::D, 0xCF);
    WriteRegisterByte(RegisterType::E, 0x02);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0x98);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF7, 0x00);
    WriteMemory(0x4269, 0xF7);
    WriteMemory(0x4268, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x65);
    CheckRegisterByte(RegisterType::B, 0xB2);
    CheckRegisterByte(RegisterType::C, 0x86);
    CheckRegisterByte(RegisterType::D, 0xCF);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0x98);
    CheckRegisterWord(RegisterType::PC, 0x426A);
    CheckRegisterWord(RegisterType::SP, 0x3619);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4268, 0xE0);
    CheckMemory(0x4269, 0xF7);
    CheckMemory(0xFFF7, 0x65);
}

void test_E0_014A()
{
    if (skip_test_E0_014A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4A7D);
    WriteRegisterWord(RegisterType::SP, 0x8AAB);
    WriteRegisterByte(RegisterType::A, 0x0A);
    WriteRegisterByte(RegisterType::B, 0x25);
    WriteRegisterByte(RegisterType::C, 0xEA);
    WriteRegisterByte(RegisterType::D, 0xF6);
    WriteRegisterByte(RegisterType::E, 0x50);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xE4);
    WriteRegisterByte(RegisterType::L, 0xC5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF70, 0x00);
    WriteMemory(0x4A7E, 0x70);
    WriteMemory(0x4A7D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0A);
    CheckRegisterByte(RegisterType::B, 0x25);
    CheckRegisterByte(RegisterType::C, 0xEA);
    CheckRegisterByte(RegisterType::D, 0xF6);
    CheckRegisterByte(RegisterType::E, 0x50);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xE4);
    CheckRegisterByte(RegisterType::L, 0xC5);
    CheckRegisterWord(RegisterType::PC, 0x4A7F);
    CheckRegisterWord(RegisterType::SP, 0x8AAB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4A7D, 0xE0);
    CheckMemory(0x4A7E, 0x70);
    CheckMemory(0xFF70, 0x0A);
}

void test_E0_014B()
{
    if (skip_test_E0_014B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD384);
    WriteRegisterWord(RegisterType::SP, 0xCB38);
    WriteRegisterByte(RegisterType::A, 0x73);
    WriteRegisterByte(RegisterType::B, 0x3E);
    WriteRegisterByte(RegisterType::C, 0x8E);
    WriteRegisterByte(RegisterType::D, 0x54);
    WriteRegisterByte(RegisterType::E, 0x72);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x89);
    WriteRegisterByte(RegisterType::L, 0xCC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB3, 0x00);
    WriteMemory(0xD385, 0xB3);
    WriteMemory(0xD384, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x73);
    CheckRegisterByte(RegisterType::B, 0x3E);
    CheckRegisterByte(RegisterType::C, 0x8E);
    CheckRegisterByte(RegisterType::D, 0x54);
    CheckRegisterByte(RegisterType::E, 0x72);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x89);
    CheckRegisterByte(RegisterType::L, 0xCC);
    CheckRegisterWord(RegisterType::PC, 0xD386);
    CheckRegisterWord(RegisterType::SP, 0xCB38);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD384, 0xE0);
    CheckMemory(0xD385, 0xB3);
    CheckMemory(0xFFB3, 0x73);
}

void test_E0_014C()
{
    if (skip_test_E0_014C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x77BE);
    WriteRegisterWord(RegisterType::SP, 0xDCC2);
    WriteRegisterByte(RegisterType::A, 0x1C);
    WriteRegisterByte(RegisterType::B, 0x07);
    WriteRegisterByte(RegisterType::C, 0xDC);
    WriteRegisterByte(RegisterType::D, 0x3F);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF7, 0x00);
    WriteMemory(0x77BF, 0xF7);
    WriteMemory(0x77BE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1C);
    CheckRegisterByte(RegisterType::B, 0x07);
    CheckRegisterByte(RegisterType::C, 0xDC);
    CheckRegisterByte(RegisterType::D, 0x3F);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0x77C0);
    CheckRegisterWord(RegisterType::SP, 0xDCC2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x77BE, 0xE0);
    CheckMemory(0x77BF, 0xF7);
    CheckMemory(0xFFF7, 0x1C);
}

void test_E0_014D()
{
    if (skip_test_E0_014D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDE62);
    WriteRegisterWord(RegisterType::SP, 0xFBBF);
    WriteRegisterByte(RegisterType::A, 0x6B);
    WriteRegisterByte(RegisterType::B, 0x53);
    WriteRegisterByte(RegisterType::C, 0x9B);
    WriteRegisterByte(RegisterType::D, 0xB3);
    WriteRegisterByte(RegisterType::E, 0x79);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x9D);
    WriteRegisterByte(RegisterType::L, 0xF1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD9, 0x00);
    WriteMemory(0xDE63, 0xD9);
    WriteMemory(0xDE62, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6B);
    CheckRegisterByte(RegisterType::B, 0x53);
    CheckRegisterByte(RegisterType::C, 0x9B);
    CheckRegisterByte(RegisterType::D, 0xB3);
    CheckRegisterByte(RegisterType::E, 0x79);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x9D);
    CheckRegisterByte(RegisterType::L, 0xF1);
    CheckRegisterWord(RegisterType::PC, 0xDE64);
    CheckRegisterWord(RegisterType::SP, 0xFBBF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDE62, 0xE0);
    CheckMemory(0xDE63, 0xD9);
    CheckMemory(0xFFD9, 0x6B);
}

void test_E0_014E()
{
    if (skip_test_E0_014E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF60E);
    WriteRegisterWord(RegisterType::SP, 0xF9CB);
    WriteRegisterByte(RegisterType::A, 0x61);
    WriteRegisterByte(RegisterType::B, 0xCD);
    WriteRegisterByte(RegisterType::C, 0x9F);
    WriteRegisterByte(RegisterType::D, 0xB5);
    WriteRegisterByte(RegisterType::E, 0x21);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x53);
    WriteRegisterByte(RegisterType::L, 0xC6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF78, 0x00);
    WriteMemory(0xF60F, 0x78);
    WriteMemory(0xF60E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x61);
    CheckRegisterByte(RegisterType::B, 0xCD);
    CheckRegisterByte(RegisterType::C, 0x9F);
    CheckRegisterByte(RegisterType::D, 0xB5);
    CheckRegisterByte(RegisterType::E, 0x21);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x53);
    CheckRegisterByte(RegisterType::L, 0xC6);
    CheckRegisterWord(RegisterType::PC, 0xF610);
    CheckRegisterWord(RegisterType::SP, 0xF9CB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF60E, 0xE0);
    CheckMemory(0xF60F, 0x78);
    CheckMemory(0xFF78, 0x61);
}

void test_E0_014F()
{
    if (skip_test_E0_014F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3807);
    WriteRegisterWord(RegisterType::SP, 0xB5F5);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0x42);
    WriteRegisterByte(RegisterType::C, 0x75);
    WriteRegisterByte(RegisterType::D, 0x92);
    WriteRegisterByte(RegisterType::E, 0x4E);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x8E);
    WriteRegisterByte(RegisterType::L, 0xB6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF0E, 0x00);
    WriteMemory(0x3808, 0x0E);
    WriteMemory(0x3807, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0x42);
    CheckRegisterByte(RegisterType::C, 0x75);
    CheckRegisterByte(RegisterType::D, 0x92);
    CheckRegisterByte(RegisterType::E, 0x4E);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x8E);
    CheckRegisterByte(RegisterType::L, 0xB6);
    CheckRegisterWord(RegisterType::PC, 0x3809);
    CheckRegisterWord(RegisterType::SP, 0xB5F5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3807, 0xE0);
    CheckMemory(0x3808, 0x0E);
    CheckMemory(0xFF0E, 0xD9);
}

void test_E0_0150()
{
    if (skip_test_E0_0150)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFF07);
    WriteRegisterWord(RegisterType::SP, 0x6F88);
    WriteRegisterByte(RegisterType::A, 0xA0);
    WriteRegisterByte(RegisterType::B, 0xE0);
    WriteRegisterByte(RegisterType::C, 0xA0);
    WriteRegisterByte(RegisterType::D, 0xA7);
    WriteRegisterByte(RegisterType::E, 0x06);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x92);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2B, 0x00);
    WriteMemory(0xFF08, 0x2B);
    WriteMemory(0xFF07, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA0);
    CheckRegisterByte(RegisterType::B, 0xE0);
    CheckRegisterByte(RegisterType::C, 0xA0);
    CheckRegisterByte(RegisterType::D, 0xA7);
    CheckRegisterByte(RegisterType::E, 0x06);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x92);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0xFF09);
    CheckRegisterWord(RegisterType::SP, 0x6F88);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFF07, 0xE0);
    CheckMemory(0xFF08, 0x2B);
    CheckMemory(0xFF2B, 0xA0);
}

void test_E0_0151()
{
    if (skip_test_E0_0151)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB45C);
    WriteRegisterWord(RegisterType::SP, 0x9AFD);
    WriteRegisterByte(RegisterType::A, 0xD3);
    WriteRegisterByte(RegisterType::B, 0x58);
    WriteRegisterByte(RegisterType::C, 0x97);
    WriteRegisterByte(RegisterType::D, 0x8D);
    WriteRegisterByte(RegisterType::E, 0xD2);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x00);
    WriteRegisterByte(RegisterType::L, 0xC0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3B, 0x00);
    WriteMemory(0xB45D, 0x3B);
    WriteMemory(0xB45C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD3);
    CheckRegisterByte(RegisterType::B, 0x58);
    CheckRegisterByte(RegisterType::C, 0x97);
    CheckRegisterByte(RegisterType::D, 0x8D);
    CheckRegisterByte(RegisterType::E, 0xD2);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x00);
    CheckRegisterByte(RegisterType::L, 0xC0);
    CheckRegisterWord(RegisterType::PC, 0xB45E);
    CheckRegisterWord(RegisterType::SP, 0x9AFD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB45C, 0xE0);
    CheckMemory(0xB45D, 0x3B);
    CheckMemory(0xFF3B, 0xD3);
}

void test_E0_0152()
{
    if (skip_test_E0_0152)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFB8F);
    WriteRegisterWord(RegisterType::SP, 0xCCC1);
    WriteRegisterByte(RegisterType::A, 0x0C);
    WriteRegisterByte(RegisterType::B, 0x8E);
    WriteRegisterByte(RegisterType::C, 0x44);
    WriteRegisterByte(RegisterType::D, 0x2C);
    WriteRegisterByte(RegisterType::E, 0x1B);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x88);
    WriteRegisterByte(RegisterType::L, 0xCD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF67, 0x00);
    WriteMemory(0xFB90, 0x67);
    WriteMemory(0xFB8F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0C);
    CheckRegisterByte(RegisterType::B, 0x8E);
    CheckRegisterByte(RegisterType::C, 0x44);
    CheckRegisterByte(RegisterType::D, 0x2C);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x88);
    CheckRegisterByte(RegisterType::L, 0xCD);
    CheckRegisterWord(RegisterType::PC, 0xFB91);
    CheckRegisterWord(RegisterType::SP, 0xCCC1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFB8F, 0xE0);
    CheckMemory(0xFB90, 0x67);
    CheckMemory(0xFF67, 0x0C);
}

void test_E0_0153()
{
    if (skip_test_E0_0153)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8D88);
    WriteRegisterWord(RegisterType::SP, 0x3FBF);
    WriteRegisterByte(RegisterType::A, 0xE5);
    WriteRegisterByte(RegisterType::B, 0x26);
    WriteRegisterByte(RegisterType::C, 0xCC);
    WriteRegisterByte(RegisterType::D, 0x54);
    WriteRegisterByte(RegisterType::E, 0xDA);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x35);
    WriteRegisterByte(RegisterType::L, 0xF5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF99, 0x00);
    WriteMemory(0x8D89, 0x99);
    WriteMemory(0x8D88, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE5);
    CheckRegisterByte(RegisterType::B, 0x26);
    CheckRegisterByte(RegisterType::C, 0xCC);
    CheckRegisterByte(RegisterType::D, 0x54);
    CheckRegisterByte(RegisterType::E, 0xDA);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x35);
    CheckRegisterByte(RegisterType::L, 0xF5);
    CheckRegisterWord(RegisterType::PC, 0x8D8A);
    CheckRegisterWord(RegisterType::SP, 0x3FBF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8D88, 0xE0);
    CheckMemory(0x8D89, 0x99);
    CheckMemory(0xFF99, 0xE5);
}

void test_E0_0154()
{
    if (skip_test_E0_0154)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x220E);
    WriteRegisterWord(RegisterType::SP, 0x89C3);
    WriteRegisterByte(RegisterType::A, 0x59);
    WriteRegisterByte(RegisterType::B, 0x28);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0x19);
    WriteRegisterByte(RegisterType::E, 0xC3);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xE0);
    WriteRegisterByte(RegisterType::L, 0xE2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF29, 0x00);
    WriteMemory(0x220F, 0x29);
    WriteMemory(0x220E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x59);
    CheckRegisterByte(RegisterType::B, 0x28);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0x19);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xE0);
    CheckRegisterByte(RegisterType::L, 0xE2);
    CheckRegisterWord(RegisterType::PC, 0x2210);
    CheckRegisterWord(RegisterType::SP, 0x89C3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x220E, 0xE0);
    CheckMemory(0x220F, 0x29);
    CheckMemory(0xFF29, 0x59);
}

void test_E0_0155()
{
    if (skip_test_E0_0155)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9BF7);
    WriteRegisterWord(RegisterType::SP, 0x020C);
    WriteRegisterByte(RegisterType::A, 0x94);
    WriteRegisterByte(RegisterType::B, 0x4E);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0x9E);
    WriteRegisterByte(RegisterType::E, 0xF6);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x10);
    WriteRegisterByte(RegisterType::L, 0xA7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB7, 0x00);
    WriteMemory(0x9BF8, 0xB7);
    WriteMemory(0x9BF7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x94);
    CheckRegisterByte(RegisterType::B, 0x4E);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0x9E);
    CheckRegisterByte(RegisterType::E, 0xF6);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x10);
    CheckRegisterByte(RegisterType::L, 0xA7);
    CheckRegisterWord(RegisterType::PC, 0x9BF9);
    CheckRegisterWord(RegisterType::SP, 0x020C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9BF7, 0xE0);
    CheckMemory(0x9BF8, 0xB7);
    CheckMemory(0xFFB7, 0x94);
}

void test_E0_0156()
{
    if (skip_test_E0_0156)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6E8B);
    WriteRegisterWord(RegisterType::SP, 0x2E54);
    WriteRegisterByte(RegisterType::A, 0xAC);
    WriteRegisterByte(RegisterType::B, 0x37);
    WriteRegisterByte(RegisterType::C, 0x2C);
    WriteRegisterByte(RegisterType::D, 0xA1);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xB2);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFC, 0x00);
    WriteMemory(0x6E8C, 0xFC);
    WriteMemory(0x6E8B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAC);
    CheckRegisterByte(RegisterType::B, 0x37);
    CheckRegisterByte(RegisterType::C, 0x2C);
    CheckRegisterByte(RegisterType::D, 0xA1);
    CheckRegisterByte(RegisterType::E, 0x5E);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xB2);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0x6E8D);
    CheckRegisterWord(RegisterType::SP, 0x2E54);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6E8B, 0xE0);
    CheckMemory(0x6E8C, 0xFC);
    CheckMemory(0xFFFC, 0xAC);
}

void test_E0_0157()
{
    if (skip_test_E0_0157)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF074);
    WriteRegisterWord(RegisterType::SP, 0x9084);
    WriteRegisterByte(RegisterType::A, 0x8D);
    WriteRegisterByte(RegisterType::B, 0xC3);
    WriteRegisterByte(RegisterType::C, 0xBB);
    WriteRegisterByte(RegisterType::D, 0x6B);
    WriteRegisterByte(RegisterType::E, 0xD0);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0xD5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAE, 0x00);
    WriteMemory(0xF075, 0xAE);
    WriteMemory(0xF074, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8D);
    CheckRegisterByte(RegisterType::B, 0xC3);
    CheckRegisterByte(RegisterType::C, 0xBB);
    CheckRegisterByte(RegisterType::D, 0x6B);
    CheckRegisterByte(RegisterType::E, 0xD0);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0xD5);
    CheckRegisterWord(RegisterType::PC, 0xF076);
    CheckRegisterWord(RegisterType::SP, 0x9084);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF074, 0xE0);
    CheckMemory(0xF075, 0xAE);
    CheckMemory(0xFFAE, 0x8D);
}

void test_E0_0158()
{
    if (skip_test_E0_0158)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x017F);
    WriteRegisterWord(RegisterType::SP, 0xF752);
    WriteRegisterByte(RegisterType::A, 0x8F);
    WriteRegisterByte(RegisterType::B, 0xF1);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0xDB);
    WriteRegisterByte(RegisterType::E, 0x31);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0x16);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5E, 0x00);
    WriteMemory(0x0180, 0x5E);
    WriteMemory(0x017F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8F);
    CheckRegisterByte(RegisterType::B, 0xF1);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0xDB);
    CheckRegisterByte(RegisterType::E, 0x31);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0x16);
    CheckRegisterWord(RegisterType::PC, 0x0181);
    CheckRegisterWord(RegisterType::SP, 0xF752);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x017F, 0xE0);
    CheckMemory(0x0180, 0x5E);
    CheckMemory(0xFF5E, 0x8F);
}

void test_E0_0159()
{
    if (skip_test_E0_0159)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x54E5);
    WriteRegisterWord(RegisterType::SP, 0xF18A);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0x7C);
    WriteRegisterByte(RegisterType::C, 0x17);
    WriteRegisterByte(RegisterType::D, 0x91);
    WriteRegisterByte(RegisterType::E, 0x88);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xB4);
    WriteRegisterByte(RegisterType::L, 0xD3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF07, 0x00);
    WriteMemory(0x54E6, 0x07);
    WriteMemory(0x54E5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0x7C);
    CheckRegisterByte(RegisterType::C, 0x17);
    CheckRegisterByte(RegisterType::D, 0x91);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xB4);
    CheckRegisterByte(RegisterType::L, 0xD3);
    CheckRegisterWord(RegisterType::PC, 0x54E7);
    CheckRegisterWord(RegisterType::SP, 0xF18A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x54E5, 0xE0);
    CheckMemory(0x54E6, 0x07);
    CheckMemory(0xFF07, 0xD0);
}

void test_E0_015A()
{
    if (skip_test_E0_015A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA67A);
    WriteRegisterWord(RegisterType::SP, 0xEEF9);
    WriteRegisterByte(RegisterType::A, 0x97);
    WriteRegisterByte(RegisterType::B, 0x56);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0x09);
    WriteRegisterByte(RegisterType::E, 0x82);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0xE5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD0, 0x00);
    WriteMemory(0xA67B, 0xD0);
    WriteMemory(0xA67A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x97);
    CheckRegisterByte(RegisterType::B, 0x56);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0x82);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0xE5);
    CheckRegisterWord(RegisterType::PC, 0xA67C);
    CheckRegisterWord(RegisterType::SP, 0xEEF9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA67A, 0xE0);
    CheckMemory(0xA67B, 0xD0);
    CheckMemory(0xFFD0, 0x97);
}

void test_E0_015B()
{
    if (skip_test_E0_015B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6DA4);
    WriteRegisterWord(RegisterType::SP, 0x3030);
    WriteRegisterByte(RegisterType::A, 0xFF);
    WriteRegisterByte(RegisterType::B, 0xE5);
    WriteRegisterByte(RegisterType::C, 0xA6);
    WriteRegisterByte(RegisterType::D, 0x8D);
    WriteRegisterByte(RegisterType::E, 0x70);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xA1);
    WriteRegisterByte(RegisterType::L, 0xE1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF76, 0x00);
    WriteMemory(0x6DA5, 0x76);
    WriteMemory(0x6DA4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFF);
    CheckRegisterByte(RegisterType::B, 0xE5);
    CheckRegisterByte(RegisterType::C, 0xA6);
    CheckRegisterByte(RegisterType::D, 0x8D);
    CheckRegisterByte(RegisterType::E, 0x70);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xA1);
    CheckRegisterByte(RegisterType::L, 0xE1);
    CheckRegisterWord(RegisterType::PC, 0x6DA6);
    CheckRegisterWord(RegisterType::SP, 0x3030);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6DA4, 0xE0);
    CheckMemory(0x6DA5, 0x76);
    CheckMemory(0xFF76, 0xFF);
}

void test_E0_015C()
{
    if (skip_test_E0_015C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBD93);
    WriteRegisterWord(RegisterType::SP, 0xB98B);
    WriteRegisterByte(RegisterType::A, 0x16);
    WriteRegisterByte(RegisterType::B, 0x92);
    WriteRegisterByte(RegisterType::C, 0x6C);
    WriteRegisterByte(RegisterType::D, 0xA4);
    WriteRegisterByte(RegisterType::E, 0xD8);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xA3);
    WriteRegisterByte(RegisterType::L, 0x8A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA6, 0x00);
    WriteMemory(0xBD94, 0xA6);
    WriteMemory(0xBD93, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x16);
    CheckRegisterByte(RegisterType::B, 0x92);
    CheckRegisterByte(RegisterType::C, 0x6C);
    CheckRegisterByte(RegisterType::D, 0xA4);
    CheckRegisterByte(RegisterType::E, 0xD8);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xA3);
    CheckRegisterByte(RegisterType::L, 0x8A);
    CheckRegisterWord(RegisterType::PC, 0xBD95);
    CheckRegisterWord(RegisterType::SP, 0xB98B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBD93, 0xE0);
    CheckMemory(0xBD94, 0xA6);
    CheckMemory(0xFFA6, 0x16);
}

void test_E0_015D()
{
    if (skip_test_E0_015D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x07A9);
    WriteRegisterWord(RegisterType::SP, 0xD037);
    WriteRegisterByte(RegisterType::A, 0x35);
    WriteRegisterByte(RegisterType::B, 0xA1);
    WriteRegisterByte(RegisterType::C, 0x52);
    WriteRegisterByte(RegisterType::D, 0x93);
    WriteRegisterByte(RegisterType::E, 0xEA);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xB9);
    WriteRegisterByte(RegisterType::L, 0xB4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF25, 0x00);
    WriteMemory(0x07AA, 0x25);
    WriteMemory(0x07A9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x35);
    CheckRegisterByte(RegisterType::B, 0xA1);
    CheckRegisterByte(RegisterType::C, 0x52);
    CheckRegisterByte(RegisterType::D, 0x93);
    CheckRegisterByte(RegisterType::E, 0xEA);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xB9);
    CheckRegisterByte(RegisterType::L, 0xB4);
    CheckRegisterWord(RegisterType::PC, 0x07AB);
    CheckRegisterWord(RegisterType::SP, 0xD037);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x07A9, 0xE0);
    CheckMemory(0x07AA, 0x25);
    CheckMemory(0xFF25, 0x35);
}

void test_E0_015E()
{
    if (skip_test_E0_015E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3BBF);
    WriteRegisterWord(RegisterType::SP, 0x9838);
    WriteRegisterByte(RegisterType::A, 0x0F);
    WriteRegisterByte(RegisterType::B, 0xE3);
    WriteRegisterByte(RegisterType::C, 0xC4);
    WriteRegisterByte(RegisterType::D, 0x81);
    WriteRegisterByte(RegisterType::E, 0xA4);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x2C);
    WriteRegisterByte(RegisterType::L, 0x5C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5B, 0x00);
    WriteMemory(0x3BC0, 0x5B);
    WriteMemory(0x3BBF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0F);
    CheckRegisterByte(RegisterType::B, 0xE3);
    CheckRegisterByte(RegisterType::C, 0xC4);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0xA4);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x2C);
    CheckRegisterByte(RegisterType::L, 0x5C);
    CheckRegisterWord(RegisterType::PC, 0x3BC1);
    CheckRegisterWord(RegisterType::SP, 0x9838);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3BBF, 0xE0);
    CheckMemory(0x3BC0, 0x5B);
    CheckMemory(0xFF5B, 0x0F);
}

void test_E0_015F()
{
    if (skip_test_E0_015F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x321E);
    WriteRegisterWord(RegisterType::SP, 0xF409);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0x9B);
    WriteRegisterByte(RegisterType::C, 0x4F);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0x5B);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x65);
    WriteRegisterByte(RegisterType::L, 0x99);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCA, 0x00);
    WriteMemory(0x321F, 0xCA);
    WriteMemory(0x321E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0x9B);
    CheckRegisterByte(RegisterType::C, 0x4F);
    CheckRegisterByte(RegisterType::D, 0xA6);
    CheckRegisterByte(RegisterType::E, 0x5B);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x65);
    CheckRegisterByte(RegisterType::L, 0x99);
    CheckRegisterWord(RegisterType::PC, 0x3220);
    CheckRegisterWord(RegisterType::SP, 0xF409);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x321E, 0xE0);
    CheckMemory(0x321F, 0xCA);
    CheckMemory(0xFFCA, 0x32);
}

void test_E0_0160()
{
    if (skip_test_E0_0160)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDCF2);
    WriteRegisterWord(RegisterType::SP, 0x065E);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0x8C);
    WriteRegisterByte(RegisterType::C, 0x74);
    WriteRegisterByte(RegisterType::D, 0x04);
    WriteRegisterByte(RegisterType::E, 0xA0);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x12);
    WriteRegisterByte(RegisterType::L, 0xAD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF34, 0x00);
    WriteMemory(0xDCF3, 0x34);
    WriteMemory(0xDCF2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0x8C);
    CheckRegisterByte(RegisterType::C, 0x74);
    CheckRegisterByte(RegisterType::D, 0x04);
    CheckRegisterByte(RegisterType::E, 0xA0);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x12);
    CheckRegisterByte(RegisterType::L, 0xAD);
    CheckRegisterWord(RegisterType::PC, 0xDCF4);
    CheckRegisterWord(RegisterType::SP, 0x065E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDCF2, 0xE0);
    CheckMemory(0xDCF3, 0x34);
    CheckMemory(0xFF34, 0x95);
}

void test_E0_0161()
{
    if (skip_test_E0_0161)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDB7B);
    WriteRegisterWord(RegisterType::SP, 0xE13E);
    WriteRegisterByte(RegisterType::A, 0x2F);
    WriteRegisterByte(RegisterType::B, 0x9A);
    WriteRegisterByte(RegisterType::C, 0xA8);
    WriteRegisterByte(RegisterType::D, 0x9E);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xE9);
    WriteRegisterByte(RegisterType::L, 0xD9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB8, 0x00);
    WriteMemory(0xDB7C, 0xB8);
    WriteMemory(0xDB7B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2F);
    CheckRegisterByte(RegisterType::B, 0x9A);
    CheckRegisterByte(RegisterType::C, 0xA8);
    CheckRegisterByte(RegisterType::D, 0x9E);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xE9);
    CheckRegisterByte(RegisterType::L, 0xD9);
    CheckRegisterWord(RegisterType::PC, 0xDB7D);
    CheckRegisterWord(RegisterType::SP, 0xE13E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDB7B, 0xE0);
    CheckMemory(0xDB7C, 0xB8);
    CheckMemory(0xFFB8, 0x2F);
}

void test_E0_0162()
{
    if (skip_test_E0_0162)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x92A7);
    WriteRegisterWord(RegisterType::SP, 0x477C);
    WriteRegisterByte(RegisterType::A, 0x6D);
    WriteRegisterByte(RegisterType::B, 0xA3);
    WriteRegisterByte(RegisterType::C, 0x61);
    WriteRegisterByte(RegisterType::D, 0xF2);
    WriteRegisterByte(RegisterType::E, 0x5C);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x18);
    WriteRegisterByte(RegisterType::L, 0x97);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF25, 0x00);
    WriteMemory(0x92A8, 0x25);
    WriteMemory(0x92A7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6D);
    CheckRegisterByte(RegisterType::B, 0xA3);
    CheckRegisterByte(RegisterType::C, 0x61);
    CheckRegisterByte(RegisterType::D, 0xF2);
    CheckRegisterByte(RegisterType::E, 0x5C);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x18);
    CheckRegisterByte(RegisterType::L, 0x97);
    CheckRegisterWord(RegisterType::PC, 0x92A9);
    CheckRegisterWord(RegisterType::SP, 0x477C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x92A7, 0xE0);
    CheckMemory(0x92A8, 0x25);
    CheckMemory(0xFF25, 0x6D);
}

void test_E0_0163()
{
    if (skip_test_E0_0163)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA6CC);
    WriteRegisterWord(RegisterType::SP, 0xD72C);
    WriteRegisterByte(RegisterType::A, 0xBE);
    WriteRegisterByte(RegisterType::B, 0x42);
    WriteRegisterByte(RegisterType::C, 0x30);
    WriteRegisterByte(RegisterType::D, 0xDD);
    WriteRegisterByte(RegisterType::E, 0x2E);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0x43);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF68, 0x00);
    WriteMemory(0xA6CD, 0x68);
    WriteMemory(0xA6CC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBE);
    CheckRegisterByte(RegisterType::B, 0x42);
    CheckRegisterByte(RegisterType::C, 0x30);
    CheckRegisterByte(RegisterType::D, 0xDD);
    CheckRegisterByte(RegisterType::E, 0x2E);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0x43);
    CheckRegisterWord(RegisterType::PC, 0xA6CE);
    CheckRegisterWord(RegisterType::SP, 0xD72C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA6CC, 0xE0);
    CheckMemory(0xA6CD, 0x68);
    CheckMemory(0xFF68, 0xBE);
}

void test_E0_0164()
{
    if (skip_test_E0_0164)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE4E9);
    WriteRegisterWord(RegisterType::SP, 0x5E2D);
    WriteRegisterByte(RegisterType::A, 0x13);
    WriteRegisterByte(RegisterType::B, 0xD2);
    WriteRegisterByte(RegisterType::C, 0xCA);
    WriteRegisterByte(RegisterType::D, 0x26);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x41);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFBF, 0x00);
    WriteMemory(0xE4EA, 0xBF);
    WriteMemory(0xE4E9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x13);
    CheckRegisterByte(RegisterType::B, 0xD2);
    CheckRegisterByte(RegisterType::C, 0xCA);
    CheckRegisterByte(RegisterType::D, 0x26);
    CheckRegisterByte(RegisterType::E, 0xC5);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x41);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0xE4EB);
    CheckRegisterWord(RegisterType::SP, 0x5E2D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE4E9, 0xE0);
    CheckMemory(0xE4EA, 0xBF);
    CheckMemory(0xFFBF, 0x13);
}

void test_E0_0165()
{
    if (skip_test_E0_0165)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0BA2);
    WriteRegisterWord(RegisterType::SP, 0xABF9);
    WriteRegisterByte(RegisterType::A, 0x0B);
    WriteRegisterByte(RegisterType::B, 0xC3);
    WriteRegisterByte(RegisterType::C, 0x29);
    WriteRegisterByte(RegisterType::D, 0x1E);
    WriteRegisterByte(RegisterType::E, 0x2E);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xE0);
    WriteRegisterByte(RegisterType::L, 0x69);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6A, 0x00);
    WriteMemory(0x0BA3, 0x6A);
    WriteMemory(0x0BA2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0B);
    CheckRegisterByte(RegisterType::B, 0xC3);
    CheckRegisterByte(RegisterType::C, 0x29);
    CheckRegisterByte(RegisterType::D, 0x1E);
    CheckRegisterByte(RegisterType::E, 0x2E);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xE0);
    CheckRegisterByte(RegisterType::L, 0x69);
    CheckRegisterWord(RegisterType::PC, 0x0BA4);
    CheckRegisterWord(RegisterType::SP, 0xABF9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0BA2, 0xE0);
    CheckMemory(0x0BA3, 0x6A);
    CheckMemory(0xFF6A, 0x0B);
}

void test_E0_0166()
{
    if (skip_test_E0_0166)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2779);
    WriteRegisterWord(RegisterType::SP, 0x8371);
    WriteRegisterByte(RegisterType::A, 0x28);
    WriteRegisterByte(RegisterType::B, 0xC2);
    WriteRegisterByte(RegisterType::C, 0x95);
    WriteRegisterByte(RegisterType::D, 0xBE);
    WriteRegisterByte(RegisterType::E, 0xDF);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x9D);
    WriteRegisterByte(RegisterType::L, 0xC5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF53, 0x00);
    WriteMemory(0x277A, 0x53);
    WriteMemory(0x2779, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x28);
    CheckRegisterByte(RegisterType::B, 0xC2);
    CheckRegisterByte(RegisterType::C, 0x95);
    CheckRegisterByte(RegisterType::D, 0xBE);
    CheckRegisterByte(RegisterType::E, 0xDF);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x9D);
    CheckRegisterByte(RegisterType::L, 0xC5);
    CheckRegisterWord(RegisterType::PC, 0x277B);
    CheckRegisterWord(RegisterType::SP, 0x8371);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2779, 0xE0);
    CheckMemory(0x277A, 0x53);
    CheckMemory(0xFF53, 0x28);
}

void test_E0_0167()
{
    if (skip_test_E0_0167)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8EFD);
    WriteRegisterWord(RegisterType::SP, 0x272E);
    WriteRegisterByte(RegisterType::A, 0xDF);
    WriteRegisterByte(RegisterType::B, 0x2A);
    WriteRegisterByte(RegisterType::C, 0x3F);
    WriteRegisterByte(RegisterType::D, 0x53);
    WriteRegisterByte(RegisterType::E, 0x47);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xAF);
    WriteRegisterByte(RegisterType::L, 0x17);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF64, 0x00);
    WriteMemory(0x8EFE, 0x64);
    WriteMemory(0x8EFD, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDF);
    CheckRegisterByte(RegisterType::B, 0x2A);
    CheckRegisterByte(RegisterType::C, 0x3F);
    CheckRegisterByte(RegisterType::D, 0x53);
    CheckRegisterByte(RegisterType::E, 0x47);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xAF);
    CheckRegisterByte(RegisterType::L, 0x17);
    CheckRegisterWord(RegisterType::PC, 0x8EFF);
    CheckRegisterWord(RegisterType::SP, 0x272E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8EFD, 0xE0);
    CheckMemory(0x8EFE, 0x64);
    CheckMemory(0xFF64, 0xDF);
}

void test_E0_0168()
{
    if (skip_test_E0_0168)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE862);
    WriteRegisterWord(RegisterType::SP, 0x58C7);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x66);
    WriteRegisterByte(RegisterType::C, 0x6D);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0xDF);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xB1);
    WriteRegisterByte(RegisterType::L, 0x5C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC0, 0x00);
    WriteMemory(0xE863, 0xC0);
    WriteMemory(0xE862, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x66);
    CheckRegisterByte(RegisterType::C, 0x6D);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0xDF);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xB1);
    CheckRegisterByte(RegisterType::L, 0x5C);
    CheckRegisterWord(RegisterType::PC, 0xE864);
    CheckRegisterWord(RegisterType::SP, 0x58C7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE862, 0xE0);
    CheckMemory(0xE863, 0xC0);
    CheckMemory(0xFFC0, 0xC2);
}

void test_E0_0169()
{
    if (skip_test_E0_0169)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD67);
    WriteRegisterWord(RegisterType::SP, 0x5E39);
    WriteRegisterByte(RegisterType::A, 0x3A);
    WriteRegisterByte(RegisterType::B, 0xD8);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0x97);
    WriteRegisterByte(RegisterType::E, 0x77);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x36);
    WriteRegisterByte(RegisterType::L, 0x1C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA3, 0x00);
    WriteMemory(0xCD68, 0xA3);
    WriteMemory(0xCD67, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3A);
    CheckRegisterByte(RegisterType::B, 0xD8);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0x97);
    CheckRegisterByte(RegisterType::E, 0x77);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x36);
    CheckRegisterByte(RegisterType::L, 0x1C);
    CheckRegisterWord(RegisterType::PC, 0xCD69);
    CheckRegisterWord(RegisterType::SP, 0x5E39);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCD67, 0xE0);
    CheckMemory(0xCD68, 0xA3);
    CheckMemory(0xFFA3, 0x3A);
}

void test_E0_016A()
{
    if (skip_test_E0_016A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC748);
    WriteRegisterWord(RegisterType::SP, 0xECCA);
    WriteRegisterByte(RegisterType::A, 0x7B);
    WriteRegisterByte(RegisterType::B, 0x23);
    WriteRegisterByte(RegisterType::C, 0xC2);
    WriteRegisterByte(RegisterType::D, 0x09);
    WriteRegisterByte(RegisterType::E, 0x0B);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x97);
    WriteRegisterByte(RegisterType::L, 0x8F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF95, 0x00);
    WriteMemory(0xC749, 0x95);
    WriteMemory(0xC748, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7B);
    CheckRegisterByte(RegisterType::B, 0x23);
    CheckRegisterByte(RegisterType::C, 0xC2);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0x0B);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x97);
    CheckRegisterByte(RegisterType::L, 0x8F);
    CheckRegisterWord(RegisterType::PC, 0xC74A);
    CheckRegisterWord(RegisterType::SP, 0xECCA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC748, 0xE0);
    CheckMemory(0xC749, 0x95);
    CheckMemory(0xFF95, 0x7B);
}

void test_E0_016B()
{
    if (skip_test_E0_016B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDE27);
    WriteRegisterWord(RegisterType::SP, 0x9618);
    WriteRegisterByte(RegisterType::A, 0x68);
    WriteRegisterByte(RegisterType::B, 0x8B);
    WriteRegisterByte(RegisterType::C, 0xF5);
    WriteRegisterByte(RegisterType::D, 0x49);
    WriteRegisterByte(RegisterType::E, 0xDE);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x2F);
    WriteRegisterByte(RegisterType::L, 0xC8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2F, 0x00);
    WriteMemory(0xDE28, 0x2F);
    WriteMemory(0xDE27, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x68);
    CheckRegisterByte(RegisterType::B, 0x8B);
    CheckRegisterByte(RegisterType::C, 0xF5);
    CheckRegisterByte(RegisterType::D, 0x49);
    CheckRegisterByte(RegisterType::E, 0xDE);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x2F);
    CheckRegisterByte(RegisterType::L, 0xC8);
    CheckRegisterWord(RegisterType::PC, 0xDE29);
    CheckRegisterWord(RegisterType::SP, 0x9618);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDE27, 0xE0);
    CheckMemory(0xDE28, 0x2F);
    CheckMemory(0xFF2F, 0x68);
}

void test_E0_016C()
{
    if (skip_test_E0_016C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xABA9);
    WriteRegisterWord(RegisterType::SP, 0x3A71);
    WriteRegisterByte(RegisterType::A, 0x54);
    WriteRegisterByte(RegisterType::B, 0x91);
    WriteRegisterByte(RegisterType::C, 0xDD);
    WriteRegisterByte(RegisterType::D, 0xC1);
    WriteRegisterByte(RegisterType::E, 0xD9);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x85);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEE, 0x00);
    WriteMemory(0xABAA, 0xEE);
    WriteMemory(0xABA9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x54);
    CheckRegisterByte(RegisterType::B, 0x91);
    CheckRegisterByte(RegisterType::C, 0xDD);
    CheckRegisterByte(RegisterType::D, 0xC1);
    CheckRegisterByte(RegisterType::E, 0xD9);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x85);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0xABAB);
    CheckRegisterWord(RegisterType::SP, 0x3A71);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xABA9, 0xE0);
    CheckMemory(0xABAA, 0xEE);
    CheckMemory(0xFFEE, 0x54);
}

void test_E0_016D()
{
    if (skip_test_E0_016D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDD60);
    WriteRegisterWord(RegisterType::SP, 0xEB21);
    WriteRegisterByte(RegisterType::A, 0x8F);
    WriteRegisterByte(RegisterType::B, 0x73);
    WriteRegisterByte(RegisterType::C, 0xB2);
    WriteRegisterByte(RegisterType::D, 0xE8);
    WriteRegisterByte(RegisterType::E, 0x88);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC7, 0x00);
    WriteMemory(0xDD61, 0xC7);
    WriteMemory(0xDD60, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8F);
    CheckRegisterByte(RegisterType::B, 0x73);
    CheckRegisterByte(RegisterType::C, 0xB2);
    CheckRegisterByte(RegisterType::D, 0xE8);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0xDD62);
    CheckRegisterWord(RegisterType::SP, 0xEB21);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDD60, 0xE0);
    CheckMemory(0xDD61, 0xC7);
    CheckMemory(0xFFC7, 0x8F);
}

void test_E0_016E()
{
    if (skip_test_E0_016E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDD14);
    WriteRegisterWord(RegisterType::SP, 0xE3B2);
    WriteRegisterByte(RegisterType::A, 0x2B);
    WriteRegisterByte(RegisterType::B, 0x5A);
    WriteRegisterByte(RegisterType::C, 0x9A);
    WriteRegisterByte(RegisterType::D, 0x78);
    WriteRegisterByte(RegisterType::E, 0xD4);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x68);
    WriteRegisterByte(RegisterType::L, 0x40);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF92, 0x00);
    WriteMemory(0xDD15, 0x92);
    WriteMemory(0xDD14, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2B);
    CheckRegisterByte(RegisterType::B, 0x5A);
    CheckRegisterByte(RegisterType::C, 0x9A);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0xD4);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x68);
    CheckRegisterByte(RegisterType::L, 0x40);
    CheckRegisterWord(RegisterType::PC, 0xDD16);
    CheckRegisterWord(RegisterType::SP, 0xE3B2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDD14, 0xE0);
    CheckMemory(0xDD15, 0x92);
    CheckMemory(0xFF92, 0x2B);
}

void test_E0_016F()
{
    if (skip_test_E0_016F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0859);
    WriteRegisterWord(RegisterType::SP, 0xFAF7);
    WriteRegisterByte(RegisterType::A, 0xB0);
    WriteRegisterByte(RegisterType::B, 0x34);
    WriteRegisterByte(RegisterType::C, 0x6D);
    WriteRegisterByte(RegisterType::D, 0xB9);
    WriteRegisterByte(RegisterType::E, 0x32);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xF8);
    WriteRegisterByte(RegisterType::L, 0x5C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFB, 0x00);
    WriteMemory(0x085A, 0xFB);
    WriteMemory(0x0859, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB0);
    CheckRegisterByte(RegisterType::B, 0x34);
    CheckRegisterByte(RegisterType::C, 0x6D);
    CheckRegisterByte(RegisterType::D, 0xB9);
    CheckRegisterByte(RegisterType::E, 0x32);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xF8);
    CheckRegisterByte(RegisterType::L, 0x5C);
    CheckRegisterWord(RegisterType::PC, 0x085B);
    CheckRegisterWord(RegisterType::SP, 0xFAF7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0859, 0xE0);
    CheckMemory(0x085A, 0xFB);
    CheckMemory(0xFFFB, 0xB0);
}

void test_E0_0170()
{
    if (skip_test_E0_0170)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x177D);
    WriteRegisterWord(RegisterType::SP, 0x945F);
    WriteRegisterByte(RegisterType::A, 0xC6);
    WriteRegisterByte(RegisterType::B, 0xD4);
    WriteRegisterByte(RegisterType::C, 0x4E);
    WriteRegisterByte(RegisterType::D, 0x6D);
    WriteRegisterByte(RegisterType::E, 0xAA);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x64);
    WriteRegisterByte(RegisterType::L, 0x2D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFDC, 0x00);
    WriteMemory(0x177E, 0xDC);
    WriteMemory(0x177D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC6);
    CheckRegisterByte(RegisterType::B, 0xD4);
    CheckRegisterByte(RegisterType::C, 0x4E);
    CheckRegisterByte(RegisterType::D, 0x6D);
    CheckRegisterByte(RegisterType::E, 0xAA);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x64);
    CheckRegisterByte(RegisterType::L, 0x2D);
    CheckRegisterWord(RegisterType::PC, 0x177F);
    CheckRegisterWord(RegisterType::SP, 0x945F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x177D, 0xE0);
    CheckMemory(0x177E, 0xDC);
    CheckMemory(0xFFDC, 0xC6);
}

void test_E0_0171()
{
    if (skip_test_E0_0171)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDE98);
    WriteRegisterWord(RegisterType::SP, 0x05FE);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x6B);
    WriteRegisterByte(RegisterType::D, 0xC7);
    WriteRegisterByte(RegisterType::E, 0x56);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x00);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF9, 0x00);
    WriteMemory(0xDE99, 0xF9);
    WriteMemory(0xDE98, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x6B);
    CheckRegisterByte(RegisterType::D, 0xC7);
    CheckRegisterByte(RegisterType::E, 0x56);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x00);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0xDE9A);
    CheckRegisterWord(RegisterType::SP, 0x05FE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDE98, 0xE0);
    CheckMemory(0xDE99, 0xF9);
    CheckMemory(0xFFF9, 0xCC);
}

void test_E0_0172()
{
    if (skip_test_E0_0172)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB15D);
    WriteRegisterWord(RegisterType::SP, 0xB4D8);
    WriteRegisterByte(RegisterType::A, 0x47);
    WriteRegisterByte(RegisterType::B, 0xE2);
    WriteRegisterByte(RegisterType::C, 0x79);
    WriteRegisterByte(RegisterType::D, 0x2F);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x10);
    WriteRegisterByte(RegisterType::L, 0x10);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF6, 0x00);
    WriteMemory(0xB15E, 0xF6);
    WriteMemory(0xB15D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x47);
    CheckRegisterByte(RegisterType::B, 0xE2);
    CheckRegisterByte(RegisterType::C, 0x79);
    CheckRegisterByte(RegisterType::D, 0x2F);
    CheckRegisterByte(RegisterType::E, 0xF5);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x10);
    CheckRegisterByte(RegisterType::L, 0x10);
    CheckRegisterWord(RegisterType::PC, 0xB15F);
    CheckRegisterWord(RegisterType::SP, 0xB4D8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB15D, 0xE0);
    CheckMemory(0xB15E, 0xF6);
    CheckMemory(0xFFF6, 0x47);
}

void test_E0_0173()
{
    if (skip_test_E0_0173)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x922A);
    WriteRegisterWord(RegisterType::SP, 0x0F9E);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0x74);
    WriteRegisterByte(RegisterType::C, 0x33);
    WriteRegisterByte(RegisterType::D, 0x98);
    WriteRegisterByte(RegisterType::E, 0x13);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xBA);
    WriteRegisterByte(RegisterType::L, 0x3A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAB, 0x00);
    WriteMemory(0x922B, 0xAB);
    WriteMemory(0x922A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0x74);
    CheckRegisterByte(RegisterType::C, 0x33);
    CheckRegisterByte(RegisterType::D, 0x98);
    CheckRegisterByte(RegisterType::E, 0x13);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xBA);
    CheckRegisterByte(RegisterType::L, 0x3A);
    CheckRegisterWord(RegisterType::PC, 0x922C);
    CheckRegisterWord(RegisterType::SP, 0x0F9E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x922A, 0xE0);
    CheckMemory(0x922B, 0xAB);
    CheckMemory(0xFFAB, 0x71);
}

void test_E0_0174()
{
    if (skip_test_E0_0174)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x875D);
    WriteRegisterWord(RegisterType::SP, 0x5391);
    WriteRegisterByte(RegisterType::A, 0xA7);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0xC1);
    WriteRegisterByte(RegisterType::D, 0x3C);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xF5);
    WriteRegisterByte(RegisterType::L, 0xB6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFBD, 0x00);
    WriteMemory(0x875E, 0xBD);
    WriteMemory(0x875D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA7);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0xC1);
    CheckRegisterByte(RegisterType::D, 0x3C);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xF5);
    CheckRegisterByte(RegisterType::L, 0xB6);
    CheckRegisterWord(RegisterType::PC, 0x875F);
    CheckRegisterWord(RegisterType::SP, 0x5391);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x875D, 0xE0);
    CheckMemory(0x875E, 0xBD);
    CheckMemory(0xFFBD, 0xA7);
}

void test_E0_0175()
{
    if (skip_test_E0_0175)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3D77);
    WriteRegisterWord(RegisterType::SP, 0xD381);
    WriteRegisterByte(RegisterType::A, 0xC0);
    WriteRegisterByte(RegisterType::B, 0x95);
    WriteRegisterByte(RegisterType::C, 0xDA);
    WriteRegisterByte(RegisterType::D, 0x81);
    WriteRegisterByte(RegisterType::E, 0x34);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x14);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB2, 0x00);
    WriteMemory(0x3D78, 0xB2);
    WriteMemory(0x3D77, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC0);
    CheckRegisterByte(RegisterType::B, 0x95);
    CheckRegisterByte(RegisterType::C, 0xDA);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0x34);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x14);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0x3D79);
    CheckRegisterWord(RegisterType::SP, 0xD381);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3D77, 0xE0);
    CheckMemory(0x3D78, 0xB2);
    CheckMemory(0xFFB2, 0xC0);
}

void test_E0_0176()
{
    if (skip_test_E0_0176)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5057);
    WriteRegisterWord(RegisterType::SP, 0x96DE);
    WriteRegisterByte(RegisterType::A, 0x5A);
    WriteRegisterByte(RegisterType::B, 0x1D);
    WriteRegisterByte(RegisterType::C, 0x12);
    WriteRegisterByte(RegisterType::D, 0x11);
    WriteRegisterByte(RegisterType::E, 0x45);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0xF1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF53, 0x00);
    WriteMemory(0x5058, 0x53);
    WriteMemory(0x5057, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5A);
    CheckRegisterByte(RegisterType::B, 0x1D);
    CheckRegisterByte(RegisterType::C, 0x12);
    CheckRegisterByte(RegisterType::D, 0x11);
    CheckRegisterByte(RegisterType::E, 0x45);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0xF1);
    CheckRegisterWord(RegisterType::PC, 0x5059);
    CheckRegisterWord(RegisterType::SP, 0x96DE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5057, 0xE0);
    CheckMemory(0x5058, 0x53);
    CheckMemory(0xFF53, 0x5A);
}

void test_E0_0177()
{
    if (skip_test_E0_0177)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xED12);
    WriteRegisterWord(RegisterType::SP, 0xD91F);
    WriteRegisterByte(RegisterType::A, 0x99);
    WriteRegisterByte(RegisterType::B, 0xC6);
    WriteRegisterByte(RegisterType::C, 0x75);
    WriteRegisterByte(RegisterType::D, 0x49);
    WriteRegisterByte(RegisterType::E, 0x6D);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0x0B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF27, 0x00);
    WriteMemory(0xED13, 0x27);
    WriteMemory(0xED12, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x99);
    CheckRegisterByte(RegisterType::B, 0xC6);
    CheckRegisterByte(RegisterType::C, 0x75);
    CheckRegisterByte(RegisterType::D, 0x49);
    CheckRegisterByte(RegisterType::E, 0x6D);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0x0B);
    CheckRegisterWord(RegisterType::PC, 0xED14);
    CheckRegisterWord(RegisterType::SP, 0xD91F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xED12, 0xE0);
    CheckMemory(0xED13, 0x27);
    CheckMemory(0xFF27, 0x99);
}

void test_E0_0178()
{
    if (skip_test_E0_0178)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x367D);
    WriteRegisterWord(RegisterType::SP, 0x114A);
    WriteRegisterByte(RegisterType::A, 0x5E);
    WriteRegisterByte(RegisterType::B, 0x78);
    WriteRegisterByte(RegisterType::C, 0x12);
    WriteRegisterByte(RegisterType::D, 0x23);
    WriteRegisterByte(RegisterType::E, 0x50);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x57);
    WriteRegisterByte(RegisterType::L, 0xAB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF00, 0x00);
    WriteMemory(0x367E, 0x00);
    WriteMemory(0x367D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5E);
    CheckRegisterByte(RegisterType::B, 0x78);
    CheckRegisterByte(RegisterType::C, 0x12);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0x50);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x57);
    CheckRegisterByte(RegisterType::L, 0xAB);
    CheckRegisterWord(RegisterType::PC, 0x367F);
    CheckRegisterWord(RegisterType::SP, 0x114A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x367D, 0xE0);
    CheckMemory(0x367E, 0x00);
    CheckMemory(0xFF00, 0x5E);
}

void test_E0_0179()
{
    if (skip_test_E0_0179)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD53);
    WriteRegisterWord(RegisterType::SP, 0xE826);
    WriteRegisterByte(RegisterType::A, 0xBF);
    WriteRegisterByte(RegisterType::B, 0x8A);
    WriteRegisterByte(RegisterType::C, 0xA1);
    WriteRegisterByte(RegisterType::D, 0x48);
    WriteRegisterByte(RegisterType::E, 0x29);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xA8);
    WriteRegisterByte(RegisterType::L, 0xA4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5A, 0x00);
    WriteMemory(0xCD54, 0x5A);
    WriteMemory(0xCD53, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBF);
    CheckRegisterByte(RegisterType::B, 0x8A);
    CheckRegisterByte(RegisterType::C, 0xA1);
    CheckRegisterByte(RegisterType::D, 0x48);
    CheckRegisterByte(RegisterType::E, 0x29);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xA8);
    CheckRegisterByte(RegisterType::L, 0xA4);
    CheckRegisterWord(RegisterType::PC, 0xCD55);
    CheckRegisterWord(RegisterType::SP, 0xE826);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCD53, 0xE0);
    CheckMemory(0xCD54, 0x5A);
    CheckMemory(0xFF5A, 0xBF);
}

void test_E0_017A()
{
    if (skip_test_E0_017A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5890);
    WriteRegisterWord(RegisterType::SP, 0x5F15);
    WriteRegisterByte(RegisterType::A, 0xF0);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0x5D);
    WriteRegisterByte(RegisterType::E, 0x76);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x13);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5A, 0x00);
    WriteMemory(0x5891, 0x5A);
    WriteMemory(0x5890, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF0);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0x5D);
    CheckRegisterByte(RegisterType::E, 0x76);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x13);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0x5892);
    CheckRegisterWord(RegisterType::SP, 0x5F15);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5890, 0xE0);
    CheckMemory(0x5891, 0x5A);
    CheckMemory(0xFF5A, 0xF0);
}

void test_E0_017B()
{
    if (skip_test_E0_017B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2E5C);
    WriteRegisterWord(RegisterType::SP, 0x216F);
    WriteRegisterByte(RegisterType::A, 0x6E);
    WriteRegisterByte(RegisterType::B, 0x03);
    WriteRegisterByte(RegisterType::C, 0x38);
    WriteRegisterByte(RegisterType::D, 0xEF);
    WriteRegisterByte(RegisterType::E, 0xA0);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x81);
    WriteRegisterByte(RegisterType::L, 0x0D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF3, 0x00);
    WriteMemory(0x2E5D, 0xF3);
    WriteMemory(0x2E5C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6E);
    CheckRegisterByte(RegisterType::B, 0x03);
    CheckRegisterByte(RegisterType::C, 0x38);
    CheckRegisterByte(RegisterType::D, 0xEF);
    CheckRegisterByte(RegisterType::E, 0xA0);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x81);
    CheckRegisterByte(RegisterType::L, 0x0D);
    CheckRegisterWord(RegisterType::PC, 0x2E5E);
    CheckRegisterWord(RegisterType::SP, 0x216F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2E5C, 0xE0);
    CheckMemory(0x2E5D, 0xF3);
    CheckMemory(0xFFF3, 0x6E);
}

void test_E0_017C()
{
    if (skip_test_E0_017C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4BEF);
    WriteRegisterWord(RegisterType::SP, 0x40E3);
    WriteRegisterByte(RegisterType::A, 0x00);
    WriteRegisterByte(RegisterType::B, 0x1E);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0xF8);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xB9);
    WriteRegisterByte(RegisterType::L, 0x11);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5A, 0x00);
    WriteMemory(0x4BF0, 0x5A);
    WriteMemory(0x4BEF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x00);
    CheckRegisterByte(RegisterType::B, 0x1E);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0xEE);
    CheckRegisterByte(RegisterType::E, 0xF8);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xB9);
    CheckRegisterByte(RegisterType::L, 0x11);
    CheckRegisterWord(RegisterType::PC, 0x4BF1);
    CheckRegisterWord(RegisterType::SP, 0x40E3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4BEF, 0xE0);
    CheckMemory(0x4BF0, 0x5A);
    CheckMemory(0xFF5A, 0x00);
}

void test_E0_017D()
{
    if (skip_test_E0_017D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5085);
    WriteRegisterWord(RegisterType::SP, 0xBC35);
    WriteRegisterByte(RegisterType::A, 0x80);
    WriteRegisterByte(RegisterType::B, 0xC3);
    WriteRegisterByte(RegisterType::C, 0x3C);
    WriteRegisterByte(RegisterType::D, 0x3D);
    WriteRegisterByte(RegisterType::E, 0xED);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x95);
    WriteRegisterByte(RegisterType::L, 0xC8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF19, 0x00);
    WriteMemory(0x5086, 0x19);
    WriteMemory(0x5085, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x80);
    CheckRegisterByte(RegisterType::B, 0xC3);
    CheckRegisterByte(RegisterType::C, 0x3C);
    CheckRegisterByte(RegisterType::D, 0x3D);
    CheckRegisterByte(RegisterType::E, 0xED);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x95);
    CheckRegisterByte(RegisterType::L, 0xC8);
    CheckRegisterWord(RegisterType::PC, 0x5087);
    CheckRegisterWord(RegisterType::SP, 0xBC35);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5085, 0xE0);
    CheckMemory(0x5086, 0x19);
    CheckMemory(0xFF19, 0x80);
}

void test_E0_017E()
{
    if (skip_test_E0_017E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA8BD);
    WriteRegisterWord(RegisterType::SP, 0xA919);
    WriteRegisterByte(RegisterType::A, 0x5A);
    WriteRegisterByte(RegisterType::B, 0xD0);
    WriteRegisterByte(RegisterType::C, 0x13);
    WriteRegisterByte(RegisterType::D, 0x49);
    WriteRegisterByte(RegisterType::E, 0xF4);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x8E);
    WriteRegisterByte(RegisterType::L, 0x11);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF39, 0x00);
    WriteMemory(0xA8BE, 0x39);
    WriteMemory(0xA8BD, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5A);
    CheckRegisterByte(RegisterType::B, 0xD0);
    CheckRegisterByte(RegisterType::C, 0x13);
    CheckRegisterByte(RegisterType::D, 0x49);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x8E);
    CheckRegisterByte(RegisterType::L, 0x11);
    CheckRegisterWord(RegisterType::PC, 0xA8BF);
    CheckRegisterWord(RegisterType::SP, 0xA919);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA8BD, 0xE0);
    CheckMemory(0xA8BE, 0x39);
    CheckMemory(0xFF39, 0x5A);
}

void test_E0_017F()
{
    if (skip_test_E0_017F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD43D);
    WriteRegisterWord(RegisterType::SP, 0x6671);
    WriteRegisterByte(RegisterType::A, 0x77);
    WriteRegisterByte(RegisterType::B, 0x82);
    WriteRegisterByte(RegisterType::C, 0xF2);
    WriteRegisterByte(RegisterType::D, 0x0D);
    WriteRegisterByte(RegisterType::E, 0x33);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x9C);
    WriteRegisterByte(RegisterType::L, 0xEC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF04, 0x00);
    WriteMemory(0xD43E, 0x04);
    WriteMemory(0xD43D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x77);
    CheckRegisterByte(RegisterType::B, 0x82);
    CheckRegisterByte(RegisterType::C, 0xF2);
    CheckRegisterByte(RegisterType::D, 0x0D);
    CheckRegisterByte(RegisterType::E, 0x33);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x9C);
    CheckRegisterByte(RegisterType::L, 0xEC);
    CheckRegisterWord(RegisterType::PC, 0xD43F);
    CheckRegisterWord(RegisterType::SP, 0x6671);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD43D, 0xE0);
    CheckMemory(0xD43E, 0x04);
    CheckMemory(0xFF04, 0x77);
}

void test_E0_0180()
{
    if (skip_test_E0_0180)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC05C);
    WriteRegisterWord(RegisterType::SP, 0x2565);
    WriteRegisterByte(RegisterType::A, 0x11);
    WriteRegisterByte(RegisterType::B, 0x33);
    WriteRegisterByte(RegisterType::C, 0xA3);
    WriteRegisterByte(RegisterType::D, 0x97);
    WriteRegisterByte(RegisterType::E, 0xBB);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0xDB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF42, 0x00);
    WriteMemory(0xC05D, 0x42);
    WriteMemory(0xC05C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x11);
    CheckRegisterByte(RegisterType::B, 0x33);
    CheckRegisterByte(RegisterType::C, 0xA3);
    CheckRegisterByte(RegisterType::D, 0x97);
    CheckRegisterByte(RegisterType::E, 0xBB);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0xDB);
    CheckRegisterWord(RegisterType::PC, 0xC05E);
    CheckRegisterWord(RegisterType::SP, 0x2565);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC05C, 0xE0);
    CheckMemory(0xC05D, 0x42);
    CheckMemory(0xFF42, 0x11);
}

void test_E0_0181()
{
    if (skip_test_E0_0181)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x87F8);
    WriteRegisterWord(RegisterType::SP, 0xFD83);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0xE6);
    WriteRegisterByte(RegisterType::E, 0xFC);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x51);
    WriteRegisterByte(RegisterType::L, 0x00);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3B, 0x00);
    WriteMemory(0x87F9, 0x3B);
    WriteMemory(0x87F8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0xE6);
    CheckRegisterByte(RegisterType::E, 0xFC);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x51);
    CheckRegisterByte(RegisterType::L, 0x00);
    CheckRegisterWord(RegisterType::PC, 0x87FA);
    CheckRegisterWord(RegisterType::SP, 0xFD83);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x87F8, 0xE0);
    CheckMemory(0x87F9, 0x3B);
    CheckMemory(0xFF3B, 0x72);
}

void test_E0_0182()
{
    if (skip_test_E0_0182)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA207);
    WriteRegisterWord(RegisterType::SP, 0xDF19);
    WriteRegisterByte(RegisterType::A, 0x23);
    WriteRegisterByte(RegisterType::B, 0x82);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0xCD);
    WriteRegisterByte(RegisterType::E, 0x01);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x96);
    WriteRegisterByte(RegisterType::L, 0xFC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF82, 0x00);
    WriteMemory(0xA208, 0x82);
    WriteMemory(0xA207, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x23);
    CheckRegisterByte(RegisterType::B, 0x82);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0xCD);
    CheckRegisterByte(RegisterType::E, 0x01);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x96);
    CheckRegisterByte(RegisterType::L, 0xFC);
    CheckRegisterWord(RegisterType::PC, 0xA209);
    CheckRegisterWord(RegisterType::SP, 0xDF19);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA207, 0xE0);
    CheckMemory(0xA208, 0x82);
    CheckMemory(0xFF82, 0x23);
}

void test_E0_0183()
{
    if (skip_test_E0_0183)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0A51);
    WriteRegisterWord(RegisterType::SP, 0xEB29);
    WriteRegisterByte(RegisterType::A, 0x31);
    WriteRegisterByte(RegisterType::B, 0x9D);
    WriteRegisterByte(RegisterType::C, 0x4C);
    WriteRegisterByte(RegisterType::D, 0x4D);
    WriteRegisterByte(RegisterType::E, 0x0D);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x7E);
    WriteRegisterByte(RegisterType::L, 0xA1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF7A, 0x00);
    WriteMemory(0x0A52, 0x7A);
    WriteMemory(0x0A51, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x31);
    CheckRegisterByte(RegisterType::B, 0x9D);
    CheckRegisterByte(RegisterType::C, 0x4C);
    CheckRegisterByte(RegisterType::D, 0x4D);
    CheckRegisterByte(RegisterType::E, 0x0D);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x7E);
    CheckRegisterByte(RegisterType::L, 0xA1);
    CheckRegisterWord(RegisterType::PC, 0x0A53);
    CheckRegisterWord(RegisterType::SP, 0xEB29);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0A51, 0xE0);
    CheckMemory(0x0A52, 0x7A);
    CheckMemory(0xFF7A, 0x31);
}

void test_E0_0184()
{
    if (skip_test_E0_0184)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1BE7);
    WriteRegisterWord(RegisterType::SP, 0xE438);
    WriteRegisterByte(RegisterType::A, 0x53);
    WriteRegisterByte(RegisterType::B, 0xDB);
    WriteRegisterByte(RegisterType::C, 0x32);
    WriteRegisterByte(RegisterType::D, 0xB1);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x7B);
    WriteRegisterByte(RegisterType::L, 0xF8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFB, 0x00);
    WriteMemory(0x1BE8, 0xFB);
    WriteMemory(0x1BE7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x53);
    CheckRegisterByte(RegisterType::B, 0xDB);
    CheckRegisterByte(RegisterType::C, 0x32);
    CheckRegisterByte(RegisterType::D, 0xB1);
    CheckRegisterByte(RegisterType::E, 0x5E);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x7B);
    CheckRegisterByte(RegisterType::L, 0xF8);
    CheckRegisterWord(RegisterType::PC, 0x1BE9);
    CheckRegisterWord(RegisterType::SP, 0xE438);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1BE7, 0xE0);
    CheckMemory(0x1BE8, 0xFB);
    CheckMemory(0xFFFB, 0x53);
}

void test_E0_0185()
{
    if (skip_test_E0_0185)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFDBA);
    WriteRegisterWord(RegisterType::SP, 0x982A);
    WriteRegisterByte(RegisterType::A, 0x93);
    WriteRegisterByte(RegisterType::B, 0x1C);
    WriteRegisterByte(RegisterType::C, 0x48);
    WriteRegisterByte(RegisterType::D, 0x63);
    WriteRegisterByte(RegisterType::E, 0x55);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x2B);
    WriteRegisterByte(RegisterType::L, 0xFA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEE, 0x00);
    WriteMemory(0xFDBB, 0xEE);
    WriteMemory(0xFDBA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x93);
    CheckRegisterByte(RegisterType::B, 0x1C);
    CheckRegisterByte(RegisterType::C, 0x48);
    CheckRegisterByte(RegisterType::D, 0x63);
    CheckRegisterByte(RegisterType::E, 0x55);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x2B);
    CheckRegisterByte(RegisterType::L, 0xFA);
    CheckRegisterWord(RegisterType::PC, 0xFDBC);
    CheckRegisterWord(RegisterType::SP, 0x982A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFDBA, 0xE0);
    CheckMemory(0xFDBB, 0xEE);
    CheckMemory(0xFFEE, 0x93);
}

void test_E0_0186()
{
    if (skip_test_E0_0186)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0CE6);
    WriteRegisterWord(RegisterType::SP, 0xF401);
    WriteRegisterByte(RegisterType::A, 0x64);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0xC0);
    WriteRegisterByte(RegisterType::D, 0x23);
    WriteRegisterByte(RegisterType::E, 0x1E);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x3C);
    WriteRegisterByte(RegisterType::L, 0x9D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF81, 0x00);
    WriteMemory(0x0CE7, 0x81);
    WriteMemory(0x0CE6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x64);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0xC0);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0x1E);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x3C);
    CheckRegisterByte(RegisterType::L, 0x9D);
    CheckRegisterWord(RegisterType::PC, 0x0CE8);
    CheckRegisterWord(RegisterType::SP, 0xF401);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0CE6, 0xE0);
    CheckMemory(0x0CE7, 0x81);
    CheckMemory(0xFF81, 0x64);
}

void test_E0_0187()
{
    if (skip_test_E0_0187)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9129);
    WriteRegisterWord(RegisterType::SP, 0xE60B);
    WriteRegisterByte(RegisterType::A, 0x1B);
    WriteRegisterByte(RegisterType::B, 0x3E);
    WriteRegisterByte(RegisterType::C, 0x90);
    WriteRegisterByte(RegisterType::D, 0xB9);
    WriteRegisterByte(RegisterType::E, 0x8E);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x71);
    WriteRegisterByte(RegisterType::L, 0x83);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC0, 0x00);
    WriteMemory(0x912A, 0xC0);
    WriteMemory(0x9129, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1B);
    CheckRegisterByte(RegisterType::B, 0x3E);
    CheckRegisterByte(RegisterType::C, 0x90);
    CheckRegisterByte(RegisterType::D, 0xB9);
    CheckRegisterByte(RegisterType::E, 0x8E);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x71);
    CheckRegisterByte(RegisterType::L, 0x83);
    CheckRegisterWord(RegisterType::PC, 0x912B);
    CheckRegisterWord(RegisterType::SP, 0xE60B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9129, 0xE0);
    CheckMemory(0x912A, 0xC0);
    CheckMemory(0xFFC0, 0x1B);
}

void test_E0_0188()
{
    if (skip_test_E0_0188)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC0A4);
    WriteRegisterWord(RegisterType::SP, 0xB246);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0xCE);
    WriteRegisterByte(RegisterType::C, 0xE0);
    WriteRegisterByte(RegisterType::D, 0x49);
    WriteRegisterByte(RegisterType::E, 0x37);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x15);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF51, 0x00);
    WriteMemory(0xC0A5, 0x51);
    WriteMemory(0xC0A4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0xCE);
    CheckRegisterByte(RegisterType::C, 0xE0);
    CheckRegisterByte(RegisterType::D, 0x49);
    CheckRegisterByte(RegisterType::E, 0x37);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x15);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0xC0A6);
    CheckRegisterWord(RegisterType::SP, 0xB246);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC0A4, 0xE0);
    CheckMemory(0xC0A5, 0x51);
    CheckMemory(0xFF51, 0x58);
}

void test_E0_0189()
{
    if (skip_test_E0_0189)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x83EB);
    WriteRegisterWord(RegisterType::SP, 0xFE73);
    WriteRegisterByte(RegisterType::A, 0x26);
    WriteRegisterByte(RegisterType::B, 0x7D);
    WriteRegisterByte(RegisterType::C, 0x8E);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0xC8);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x17);
    WriteRegisterByte(RegisterType::L, 0x57);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF80, 0x00);
    WriteMemory(0x83EC, 0x80);
    WriteMemory(0x83EB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x26);
    CheckRegisterByte(RegisterType::B, 0x7D);
    CheckRegisterByte(RegisterType::C, 0x8E);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0xC8);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x17);
    CheckRegisterByte(RegisterType::L, 0x57);
    CheckRegisterWord(RegisterType::PC, 0x83ED);
    CheckRegisterWord(RegisterType::SP, 0xFE73);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x83EB, 0xE0);
    CheckMemory(0x83EC, 0x80);
    CheckMemory(0xFF80, 0x26);
}

void test_E0_018A()
{
    if (skip_test_E0_018A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDB36);
    WriteRegisterWord(RegisterType::SP, 0x68CE);
    WriteRegisterByte(RegisterType::A, 0x8D);
    WriteRegisterByte(RegisterType::B, 0x64);
    WriteRegisterByte(RegisterType::C, 0xDE);
    WriteRegisterByte(RegisterType::D, 0x5A);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x9B);
    WriteRegisterByte(RegisterType::L, 0xBE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAD, 0x00);
    WriteMemory(0xDB37, 0xAD);
    WriteMemory(0xDB36, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8D);
    CheckRegisterByte(RegisterType::B, 0x64);
    CheckRegisterByte(RegisterType::C, 0xDE);
    CheckRegisterByte(RegisterType::D, 0x5A);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x9B);
    CheckRegisterByte(RegisterType::L, 0xBE);
    CheckRegisterWord(RegisterType::PC, 0xDB38);
    CheckRegisterWord(RegisterType::SP, 0x68CE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDB36, 0xE0);
    CheckMemory(0xDB37, 0xAD);
    CheckMemory(0xFFAD, 0x8D);
}

void test_E0_018B()
{
    if (skip_test_E0_018B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAE43);
    WriteRegisterWord(RegisterType::SP, 0xA8FA);
    WriteRegisterByte(RegisterType::A, 0x59);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0xB8);
    WriteRegisterByte(RegisterType::E, 0xCB);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xB5);
    WriteRegisterByte(RegisterType::L, 0x6C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF56, 0x00);
    WriteMemory(0xAE44, 0x56);
    WriteMemory(0xAE43, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x59);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0xB8);
    CheckRegisterByte(RegisterType::E, 0xCB);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xB5);
    CheckRegisterByte(RegisterType::L, 0x6C);
    CheckRegisterWord(RegisterType::PC, 0xAE45);
    CheckRegisterWord(RegisterType::SP, 0xA8FA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAE43, 0xE0);
    CheckMemory(0xAE44, 0x56);
    CheckMemory(0xFF56, 0x59);
}

void test_E0_018C()
{
    if (skip_test_E0_018C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5143);
    WriteRegisterWord(RegisterType::SP, 0xC277);
    WriteRegisterByte(RegisterType::A, 0x22);
    WriteRegisterByte(RegisterType::B, 0xB1);
    WriteRegisterByte(RegisterType::C, 0xAA);
    WriteRegisterByte(RegisterType::D, 0xAA);
    WriteRegisterByte(RegisterType::E, 0x48);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x43);
    WriteRegisterByte(RegisterType::L, 0x8E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC6, 0x00);
    WriteMemory(0x5144, 0xC6);
    WriteMemory(0x5143, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x22);
    CheckRegisterByte(RegisterType::B, 0xB1);
    CheckRegisterByte(RegisterType::C, 0xAA);
    CheckRegisterByte(RegisterType::D, 0xAA);
    CheckRegisterByte(RegisterType::E, 0x48);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x43);
    CheckRegisterByte(RegisterType::L, 0x8E);
    CheckRegisterWord(RegisterType::PC, 0x5145);
    CheckRegisterWord(RegisterType::SP, 0xC277);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5143, 0xE0);
    CheckMemory(0x5144, 0xC6);
    CheckMemory(0xFFC6, 0x22);
}

void test_E0_018D()
{
    if (skip_test_E0_018D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9492);
    WriteRegisterWord(RegisterType::SP, 0xFF78);
    WriteRegisterByte(RegisterType::A, 0x0B);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0x27);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0x1F);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x53);
    WriteRegisterByte(RegisterType::L, 0x7A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2E, 0x00);
    WriteMemory(0x9493, 0x2E);
    WriteMemory(0x9492, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0B);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0x27);
    CheckRegisterByte(RegisterType::D, 0xAE);
    CheckRegisterByte(RegisterType::E, 0x1F);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x53);
    CheckRegisterByte(RegisterType::L, 0x7A);
    CheckRegisterWord(RegisterType::PC, 0x9494);
    CheckRegisterWord(RegisterType::SP, 0xFF78);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9492, 0xE0);
    CheckMemory(0x9493, 0x2E);
    CheckMemory(0xFF2E, 0x0B);
}

void test_E0_018E()
{
    if (skip_test_E0_018E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBD77);
    WriteRegisterWord(RegisterType::SP, 0xC478);
    WriteRegisterByte(RegisterType::A, 0x7F);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0x24);
    WriteRegisterByte(RegisterType::D, 0xF7);
    WriteRegisterByte(RegisterType::E, 0x1A);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x90);
    WriteRegisterByte(RegisterType::L, 0xAC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF7, 0x00);
    WriteMemory(0xBD78, 0xF7);
    WriteMemory(0xBD77, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7F);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0x24);
    CheckRegisterByte(RegisterType::D, 0xF7);
    CheckRegisterByte(RegisterType::E, 0x1A);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x90);
    CheckRegisterByte(RegisterType::L, 0xAC);
    CheckRegisterWord(RegisterType::PC, 0xBD79);
    CheckRegisterWord(RegisterType::SP, 0xC478);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBD77, 0xE0);
    CheckMemory(0xBD78, 0xF7);
    CheckMemory(0xFFF7, 0x7F);
}

void test_E0_018F()
{
    if (skip_test_E0_018F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD91E);
    WriteRegisterWord(RegisterType::SP, 0x6F68);
    WriteRegisterByte(RegisterType::A, 0xB1);
    WriteRegisterByte(RegisterType::B, 0x38);
    WriteRegisterByte(RegisterType::C, 0x68);
    WriteRegisterByte(RegisterType::D, 0x38);
    WriteRegisterByte(RegisterType::E, 0x1C);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x23);
    WriteRegisterByte(RegisterType::L, 0x01);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFEC, 0x00);
    WriteMemory(0xD91F, 0xEC);
    WriteMemory(0xD91E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB1);
    CheckRegisterByte(RegisterType::B, 0x38);
    CheckRegisterByte(RegisterType::C, 0x68);
    CheckRegisterByte(RegisterType::D, 0x38);
    CheckRegisterByte(RegisterType::E, 0x1C);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x23);
    CheckRegisterByte(RegisterType::L, 0x01);
    CheckRegisterWord(RegisterType::PC, 0xD920);
    CheckRegisterWord(RegisterType::SP, 0x6F68);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD91E, 0xE0);
    CheckMemory(0xD91F, 0xEC);
    CheckMemory(0xFFEC, 0xB1);
}

void test_E0_0190()
{
    if (skip_test_E0_0190)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x98C2);
    WriteRegisterWord(RegisterType::SP, 0x4211);
    WriteRegisterByte(RegisterType::A, 0x0E);
    WriteRegisterByte(RegisterType::B, 0x34);
    WriteRegisterByte(RegisterType::C, 0xEB);
    WriteRegisterByte(RegisterType::D, 0xC7);
    WriteRegisterByte(RegisterType::E, 0x67);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x7E);
    WriteRegisterByte(RegisterType::L, 0xC0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF77, 0x00);
    WriteMemory(0x98C3, 0x77);
    WriteMemory(0x98C2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0E);
    CheckRegisterByte(RegisterType::B, 0x34);
    CheckRegisterByte(RegisterType::C, 0xEB);
    CheckRegisterByte(RegisterType::D, 0xC7);
    CheckRegisterByte(RegisterType::E, 0x67);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x7E);
    CheckRegisterByte(RegisterType::L, 0xC0);
    CheckRegisterWord(RegisterType::PC, 0x98C4);
    CheckRegisterWord(RegisterType::SP, 0x4211);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x98C2, 0xE0);
    CheckMemory(0x98C3, 0x77);
    CheckMemory(0xFF77, 0x0E);
}

void test_E0_0191()
{
    if (skip_test_E0_0191)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAE3E);
    WriteRegisterWord(RegisterType::SP, 0x3532);
    WriteRegisterByte(RegisterType::A, 0xA6);
    WriteRegisterByte(RegisterType::B, 0x69);
    WriteRegisterByte(RegisterType::C, 0xE6);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0x90);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5E, 0x00);
    WriteMemory(0xAE3F, 0x5E);
    WriteMemory(0xAE3E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA6);
    CheckRegisterByte(RegisterType::B, 0x69);
    CheckRegisterByte(RegisterType::C, 0xE6);
    CheckRegisterByte(RegisterType::D, 0xA9);
    CheckRegisterByte(RegisterType::E, 0x03);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0x90);
    CheckRegisterWord(RegisterType::PC, 0xAE40);
    CheckRegisterWord(RegisterType::SP, 0x3532);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAE3E, 0xE0);
    CheckMemory(0xAE3F, 0x5E);
    CheckMemory(0xFF5E, 0xA6);
}

void test_E0_0192()
{
    if (skip_test_E0_0192)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0660);
    WriteRegisterWord(RegisterType::SP, 0x460B);
    WriteRegisterByte(RegisterType::A, 0xED);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0x80);
    WriteRegisterByte(RegisterType::D, 0xDF);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x05);
    WriteRegisterByte(RegisterType::L, 0xD7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB5, 0x00);
    WriteMemory(0x0661, 0xB5);
    WriteMemory(0x0660, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xED);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0x80);
    CheckRegisterByte(RegisterType::D, 0xDF);
    CheckRegisterByte(RegisterType::E, 0x03);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x05);
    CheckRegisterByte(RegisterType::L, 0xD7);
    CheckRegisterWord(RegisterType::PC, 0x0662);
    CheckRegisterWord(RegisterType::SP, 0x460B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0660, 0xE0);
    CheckMemory(0x0661, 0xB5);
    CheckMemory(0xFFB5, 0xED);
}

void test_E0_0193()
{
    if (skip_test_E0_0193)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5E2D);
    WriteRegisterWord(RegisterType::SP, 0x2FC6);
    WriteRegisterByte(RegisterType::A, 0x39);
    WriteRegisterByte(RegisterType::B, 0x80);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0xD7);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x61);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8D, 0x00);
    WriteMemory(0x5E2E, 0x8D);
    WriteMemory(0x5E2D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x39);
    CheckRegisterByte(RegisterType::B, 0x80);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0xD7);
    CheckRegisterByte(RegisterType::E, 0xE5);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x61);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0x5E2F);
    CheckRegisterWord(RegisterType::SP, 0x2FC6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5E2D, 0xE0);
    CheckMemory(0x5E2E, 0x8D);
    CheckMemory(0xFF8D, 0x39);
}

void test_E0_0194()
{
    if (skip_test_E0_0194)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6133);
    WriteRegisterWord(RegisterType::SP, 0x37FB);
    WriteRegisterByte(RegisterType::A, 0x5E);
    WriteRegisterByte(RegisterType::B, 0x43);
    WriteRegisterByte(RegisterType::C, 0x9B);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0x91);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0xEA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4B, 0x00);
    WriteMemory(0x6134, 0x4B);
    WriteMemory(0x6133, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5E);
    CheckRegisterByte(RegisterType::B, 0x43);
    CheckRegisterByte(RegisterType::C, 0x9B);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x91);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0xEA);
    CheckRegisterWord(RegisterType::PC, 0x6135);
    CheckRegisterWord(RegisterType::SP, 0x37FB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6133, 0xE0);
    CheckMemory(0x6134, 0x4B);
    CheckMemory(0xFF4B, 0x5E);
}

void test_E0_0195()
{
    if (skip_test_E0_0195)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9980);
    WriteRegisterWord(RegisterType::SP, 0x9FDD);
    WriteRegisterByte(RegisterType::A, 0x5F);
    WriteRegisterByte(RegisterType::B, 0x77);
    WriteRegisterByte(RegisterType::C, 0x24);
    WriteRegisterByte(RegisterType::D, 0x70);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0x6B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF7D, 0x00);
    WriteMemory(0x9981, 0x7D);
    WriteMemory(0x9980, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5F);
    CheckRegisterByte(RegisterType::B, 0x77);
    CheckRegisterByte(RegisterType::C, 0x24);
    CheckRegisterByte(RegisterType::D, 0x70);
    CheckRegisterByte(RegisterType::E, 0xE5);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0x6B);
    CheckRegisterWord(RegisterType::PC, 0x9982);
    CheckRegisterWord(RegisterType::SP, 0x9FDD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9980, 0xE0);
    CheckMemory(0x9981, 0x7D);
    CheckMemory(0xFF7D, 0x5F);
}

void test_E0_0196()
{
    if (skip_test_E0_0196)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x18B8);
    WriteRegisterWord(RegisterType::SP, 0xA677);
    WriteRegisterByte(RegisterType::A, 0xE7);
    WriteRegisterByte(RegisterType::B, 0xE6);
    WriteRegisterByte(RegisterType::C, 0x38);
    WriteRegisterByte(RegisterType::D, 0x9D);
    WriteRegisterByte(RegisterType::E, 0xC3);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x54);
    WriteRegisterByte(RegisterType::L, 0xAC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4A, 0x00);
    WriteMemory(0x18B9, 0x4A);
    WriteMemory(0x18B8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE7);
    CheckRegisterByte(RegisterType::B, 0xE6);
    CheckRegisterByte(RegisterType::C, 0x38);
    CheckRegisterByte(RegisterType::D, 0x9D);
    CheckRegisterByte(RegisterType::E, 0xC3);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x54);
    CheckRegisterByte(RegisterType::L, 0xAC);
    CheckRegisterWord(RegisterType::PC, 0x18BA);
    CheckRegisterWord(RegisterType::SP, 0xA677);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x18B8, 0xE0);
    CheckMemory(0x18B9, 0x4A);
    CheckMemory(0xFF4A, 0xE7);
}

void test_E0_0197()
{
    if (skip_test_E0_0197)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4A96);
    WriteRegisterWord(RegisterType::SP, 0xB18F);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0x38);
    WriteRegisterByte(RegisterType::C, 0xB9);
    WriteRegisterByte(RegisterType::D, 0x43);
    WriteRegisterByte(RegisterType::E, 0x52);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x9D);
    WriteRegisterByte(RegisterType::L, 0x1E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF55, 0x00);
    WriteMemory(0x4A97, 0x55);
    WriteMemory(0x4A96, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0x38);
    CheckRegisterByte(RegisterType::C, 0xB9);
    CheckRegisterByte(RegisterType::D, 0x43);
    CheckRegisterByte(RegisterType::E, 0x52);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x9D);
    CheckRegisterByte(RegisterType::L, 0x1E);
    CheckRegisterWord(RegisterType::PC, 0x4A98);
    CheckRegisterWord(RegisterType::SP, 0xB18F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4A96, 0xE0);
    CheckMemory(0x4A97, 0x55);
    CheckMemory(0xFF55, 0xD0);
}

void test_E0_0198()
{
    if (skip_test_E0_0198)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBDB0);
    WriteRegisterWord(RegisterType::SP, 0x5286);
    WriteRegisterByte(RegisterType::A, 0x90);
    WriteRegisterByte(RegisterType::B, 0xEF);
    WriteRegisterByte(RegisterType::C, 0x6B);
    WriteRegisterByte(RegisterType::D, 0xD2);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x06);
    WriteRegisterByte(RegisterType::L, 0xF5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF1F, 0x00);
    WriteMemory(0xBDB1, 0x1F);
    WriteMemory(0xBDB0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x90);
    CheckRegisterByte(RegisterType::B, 0xEF);
    CheckRegisterByte(RegisterType::C, 0x6B);
    CheckRegisterByte(RegisterType::D, 0xD2);
    CheckRegisterByte(RegisterType::E, 0x03);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x06);
    CheckRegisterByte(RegisterType::L, 0xF5);
    CheckRegisterWord(RegisterType::PC, 0xBDB2);
    CheckRegisterWord(RegisterType::SP, 0x5286);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBDB0, 0xE0);
    CheckMemory(0xBDB1, 0x1F);
    CheckMemory(0xFF1F, 0x90);
}

void test_E0_0199()
{
    if (skip_test_E0_0199)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1B0B);
    WriteRegisterWord(RegisterType::SP, 0xE615);
    WriteRegisterByte(RegisterType::A, 0x26);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0x96);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0xA7);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xCF);
    WriteRegisterByte(RegisterType::L, 0x28);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEF, 0x00);
    WriteMemory(0x1B0C, 0xEF);
    WriteMemory(0x1B0B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x26);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0x96);
    CheckRegisterByte(RegisterType::D, 0x99);
    CheckRegisterByte(RegisterType::E, 0xA7);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xCF);
    CheckRegisterByte(RegisterType::L, 0x28);
    CheckRegisterWord(RegisterType::PC, 0x1B0D);
    CheckRegisterWord(RegisterType::SP, 0xE615);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1B0B, 0xE0);
    CheckMemory(0x1B0C, 0xEF);
    CheckMemory(0xFFEF, 0x26);
}

void test_E0_019A()
{
    if (skip_test_E0_019A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBD4A);
    WriteRegisterWord(RegisterType::SP, 0x5E86);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0x8C);
    WriteRegisterByte(RegisterType::C, 0xB2);
    WriteRegisterByte(RegisterType::D, 0x08);
    WriteRegisterByte(RegisterType::E, 0x14);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xAF);
    WriteRegisterByte(RegisterType::L, 0x85);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3C, 0x00);
    WriteMemory(0xBD4B, 0x3C);
    WriteMemory(0xBD4A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0x8C);
    CheckRegisterByte(RegisterType::C, 0xB2);
    CheckRegisterByte(RegisterType::D, 0x08);
    CheckRegisterByte(RegisterType::E, 0x14);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xAF);
    CheckRegisterByte(RegisterType::L, 0x85);
    CheckRegisterWord(RegisterType::PC, 0xBD4C);
    CheckRegisterWord(RegisterType::SP, 0x5E86);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBD4A, 0xE0);
    CheckMemory(0xBD4B, 0x3C);
    CheckMemory(0xFF3C, 0x78);
}

void test_E0_019B()
{
    if (skip_test_E0_019B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1EFB);
    WriteRegisterWord(RegisterType::SP, 0xCF26);
    WriteRegisterByte(RegisterType::A, 0xCA);
    WriteRegisterByte(RegisterType::B, 0xDE);
    WriteRegisterByte(RegisterType::C, 0xC0);
    WriteRegisterByte(RegisterType::D, 0x1D);
    WriteRegisterByte(RegisterType::E, 0x34);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x04);
    WriteRegisterByte(RegisterType::L, 0x4D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFDD, 0x00);
    WriteMemory(0x1EFC, 0xDD);
    WriteMemory(0x1EFB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCA);
    CheckRegisterByte(RegisterType::B, 0xDE);
    CheckRegisterByte(RegisterType::C, 0xC0);
    CheckRegisterByte(RegisterType::D, 0x1D);
    CheckRegisterByte(RegisterType::E, 0x34);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x04);
    CheckRegisterByte(RegisterType::L, 0x4D);
    CheckRegisterWord(RegisterType::PC, 0x1EFD);
    CheckRegisterWord(RegisterType::SP, 0xCF26);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1EFB, 0xE0);
    CheckMemory(0x1EFC, 0xDD);
    CheckMemory(0xFFDD, 0xCA);
}

void test_E0_019C()
{
    if (skip_test_E0_019C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1793);
    WriteRegisterWord(RegisterType::SP, 0xA673);
    WriteRegisterByte(RegisterType::A, 0x2C);
    WriteRegisterByte(RegisterType::B, 0xF9);
    WriteRegisterByte(RegisterType::C, 0x64);
    WriteRegisterByte(RegisterType::D, 0x1C);
    WriteRegisterByte(RegisterType::E, 0x31);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x82);
    WriteRegisterByte(RegisterType::L, 0xDD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF03, 0x00);
    WriteMemory(0x1794, 0x03);
    WriteMemory(0x1793, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2C);
    CheckRegisterByte(RegisterType::B, 0xF9);
    CheckRegisterByte(RegisterType::C, 0x64);
    CheckRegisterByte(RegisterType::D, 0x1C);
    CheckRegisterByte(RegisterType::E, 0x31);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x82);
    CheckRegisterByte(RegisterType::L, 0xDD);
    CheckRegisterWord(RegisterType::PC, 0x1795);
    CheckRegisterWord(RegisterType::SP, 0xA673);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1793, 0xE0);
    CheckMemory(0x1794, 0x03);
    CheckMemory(0xFF03, 0x2C);
}

void test_E0_019D()
{
    if (skip_test_E0_019D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6403);
    WriteRegisterWord(RegisterType::SP, 0x78EA);
    WriteRegisterByte(RegisterType::A, 0x98);
    WriteRegisterByte(RegisterType::B, 0x56);
    WriteRegisterByte(RegisterType::C, 0x28);
    WriteRegisterByte(RegisterType::D, 0x6F);
    WriteRegisterByte(RegisterType::E, 0x08);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x2C);
    WriteRegisterByte(RegisterType::L, 0x71);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCB, 0x00);
    WriteMemory(0x6404, 0xCB);
    WriteMemory(0x6403, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x98);
    CheckRegisterByte(RegisterType::B, 0x56);
    CheckRegisterByte(RegisterType::C, 0x28);
    CheckRegisterByte(RegisterType::D, 0x6F);
    CheckRegisterByte(RegisterType::E, 0x08);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x2C);
    CheckRegisterByte(RegisterType::L, 0x71);
    CheckRegisterWord(RegisterType::PC, 0x6405);
    CheckRegisterWord(RegisterType::SP, 0x78EA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6403, 0xE0);
    CheckMemory(0x6404, 0xCB);
    CheckMemory(0xFFCB, 0x98);
}

void test_E0_019E()
{
    if (skip_test_E0_019E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7FD5);
    WriteRegisterWord(RegisterType::SP, 0x4B1E);
    WriteRegisterByte(RegisterType::A, 0x01);
    WriteRegisterByte(RegisterType::B, 0xFA);
    WriteRegisterByte(RegisterType::C, 0xB9);
    WriteRegisterByte(RegisterType::D, 0x7D);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x62);
    WriteRegisterByte(RegisterType::L, 0x22);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF19, 0x00);
    WriteMemory(0x7FD6, 0x19);
    WriteMemory(0x7FD5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x01);
    CheckRegisterByte(RegisterType::B, 0xFA);
    CheckRegisterByte(RegisterType::C, 0xB9);
    CheckRegisterByte(RegisterType::D, 0x7D);
    CheckRegisterByte(RegisterType::E, 0xA5);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x62);
    CheckRegisterByte(RegisterType::L, 0x22);
    CheckRegisterWord(RegisterType::PC, 0x7FD7);
    CheckRegisterWord(RegisterType::SP, 0x4B1E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7FD5, 0xE0);
    CheckMemory(0x7FD6, 0x19);
    CheckMemory(0xFF19, 0x01);
}

void test_E0_019F()
{
    if (skip_test_E0_019F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7FC0);
    WriteRegisterWord(RegisterType::SP, 0x8A3A);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0x2A);
    WriteRegisterByte(RegisterType::C, 0xB7);
    WriteRegisterByte(RegisterType::D, 0x25);
    WriteRegisterByte(RegisterType::E, 0x81);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x13);
    WriteRegisterByte(RegisterType::L, 0xA4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF80, 0x00);
    WriteMemory(0x7FC1, 0x80);
    WriteMemory(0x7FC0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0x2A);
    CheckRegisterByte(RegisterType::C, 0xB7);
    CheckRegisterByte(RegisterType::D, 0x25);
    CheckRegisterByte(RegisterType::E, 0x81);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x13);
    CheckRegisterByte(RegisterType::L, 0xA4);
    CheckRegisterWord(RegisterType::PC, 0x7FC2);
    CheckRegisterWord(RegisterType::SP, 0x8A3A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7FC0, 0xE0);
    CheckMemory(0x7FC1, 0x80);
    CheckMemory(0xFF80, 0xCD);
}

void test_E0_01A0()
{
    if (skip_test_E0_01A0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBEBD);
    WriteRegisterWord(RegisterType::SP, 0x9B51);
    WriteRegisterByte(RegisterType::A, 0x0A);
    WriteRegisterByte(RegisterType::B, 0x8A);
    WriteRegisterByte(RegisterType::C, 0x0A);
    WriteRegisterByte(RegisterType::D, 0xA5);
    WriteRegisterByte(RegisterType::E, 0x94);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x83);
    WriteRegisterByte(RegisterType::L, 0x23);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9D, 0x00);
    WriteMemory(0xBEBE, 0x9D);
    WriteMemory(0xBEBD, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0A);
    CheckRegisterByte(RegisterType::B, 0x8A);
    CheckRegisterByte(RegisterType::C, 0x0A);
    CheckRegisterByte(RegisterType::D, 0xA5);
    CheckRegisterByte(RegisterType::E, 0x94);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x83);
    CheckRegisterByte(RegisterType::L, 0x23);
    CheckRegisterWord(RegisterType::PC, 0xBEBF);
    CheckRegisterWord(RegisterType::SP, 0x9B51);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBEBD, 0xE0);
    CheckMemory(0xBEBE, 0x9D);
    CheckMemory(0xFF9D, 0x0A);
}

void test_E0_01A1()
{
    if (skip_test_E0_01A1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1E00);
    WriteRegisterWord(RegisterType::SP, 0x4B2F);
    WriteRegisterByte(RegisterType::A, 0xF9);
    WriteRegisterByte(RegisterType::B, 0x6D);
    WriteRegisterByte(RegisterType::C, 0xA2);
    WriteRegisterByte(RegisterType::D, 0x28);
    WriteRegisterByte(RegisterType::E, 0x51);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x2A);
    WriteRegisterByte(RegisterType::L, 0x99);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF83, 0x00);
    WriteMemory(0x1E01, 0x83);
    WriteMemory(0x1E00, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF9);
    CheckRegisterByte(RegisterType::B, 0x6D);
    CheckRegisterByte(RegisterType::C, 0xA2);
    CheckRegisterByte(RegisterType::D, 0x28);
    CheckRegisterByte(RegisterType::E, 0x51);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x2A);
    CheckRegisterByte(RegisterType::L, 0x99);
    CheckRegisterWord(RegisterType::PC, 0x1E02);
    CheckRegisterWord(RegisterType::SP, 0x4B2F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1E00, 0xE0);
    CheckMemory(0x1E01, 0x83);
    CheckMemory(0xFF83, 0xF9);
}

void test_E0_01A2()
{
    if (skip_test_E0_01A2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAA21);
    WriteRegisterWord(RegisterType::SP, 0x61AF);
    WriteRegisterByte(RegisterType::A, 0xF0);
    WriteRegisterByte(RegisterType::B, 0x24);
    WriteRegisterByte(RegisterType::C, 0x87);
    WriteRegisterByte(RegisterType::D, 0xF7);
    WriteRegisterByte(RegisterType::E, 0x9E);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0xE7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA8, 0x00);
    WriteMemory(0xAA22, 0xA8);
    WriteMemory(0xAA21, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF0);
    CheckRegisterByte(RegisterType::B, 0x24);
    CheckRegisterByte(RegisterType::C, 0x87);
    CheckRegisterByte(RegisterType::D, 0xF7);
    CheckRegisterByte(RegisterType::E, 0x9E);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0xE7);
    CheckRegisterWord(RegisterType::PC, 0xAA23);
    CheckRegisterWord(RegisterType::SP, 0x61AF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAA21, 0xE0);
    CheckMemory(0xAA22, 0xA8);
    CheckMemory(0xFFA8, 0xF0);
}

void test_E0_01A3()
{
    if (skip_test_E0_01A3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1A8F);
    WriteRegisterWord(RegisterType::SP, 0xE281);
    WriteRegisterByte(RegisterType::A, 0x10);
    WriteRegisterByte(RegisterType::B, 0x9C);
    WriteRegisterByte(RegisterType::C, 0x97);
    WriteRegisterByte(RegisterType::D, 0x3E);
    WriteRegisterByte(RegisterType::E, 0x52);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x29);
    WriteRegisterByte(RegisterType::L, 0xA8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF04, 0x00);
    WriteMemory(0x1A90, 0x04);
    WriteMemory(0x1A8F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x10);
    CheckRegisterByte(RegisterType::B, 0x9C);
    CheckRegisterByte(RegisterType::C, 0x97);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0x52);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x29);
    CheckRegisterByte(RegisterType::L, 0xA8);
    CheckRegisterWord(RegisterType::PC, 0x1A91);
    CheckRegisterWord(RegisterType::SP, 0xE281);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1A8F, 0xE0);
    CheckMemory(0x1A90, 0x04);
    CheckMemory(0xFF04, 0x10);
}

void test_E0_01A4()
{
    if (skip_test_E0_01A4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3D47);
    WriteRegisterWord(RegisterType::SP, 0x2019);
    WriteRegisterByte(RegisterType::A, 0x6A);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0x46);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0x32);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x92);
    WriteRegisterByte(RegisterType::L, 0xE5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCA, 0x00);
    WriteMemory(0x3D48, 0xCA);
    WriteMemory(0x3D47, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6A);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0x46);
    CheckRegisterByte(RegisterType::D, 0x40);
    CheckRegisterByte(RegisterType::E, 0x32);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x92);
    CheckRegisterByte(RegisterType::L, 0xE5);
    CheckRegisterWord(RegisterType::PC, 0x3D49);
    CheckRegisterWord(RegisterType::SP, 0x2019);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3D47, 0xE0);
    CheckMemory(0x3D48, 0xCA);
    CheckMemory(0xFFCA, 0x6A);
}

void test_E0_01A5()
{
    if (skip_test_E0_01A5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA802);
    WriteRegisterWord(RegisterType::SP, 0x7B9C);
    WriteRegisterByte(RegisterType::A, 0xB9);
    WriteRegisterByte(RegisterType::B, 0x75);
    WriteRegisterByte(RegisterType::C, 0x2E);
    WriteRegisterByte(RegisterType::D, 0x2A);
    WriteRegisterByte(RegisterType::E, 0x2D);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xEE);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFEE, 0x00);
    WriteMemory(0xA803, 0xEE);
    WriteMemory(0xA802, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB9);
    CheckRegisterByte(RegisterType::B, 0x75);
    CheckRegisterByte(RegisterType::C, 0x2E);
    CheckRegisterByte(RegisterType::D, 0x2A);
    CheckRegisterByte(RegisterType::E, 0x2D);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xEE);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0xA804);
    CheckRegisterWord(RegisterType::SP, 0x7B9C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA802, 0xE0);
    CheckMemory(0xA803, 0xEE);
    CheckMemory(0xFFEE, 0xB9);
}

void test_E0_01A6()
{
    if (skip_test_E0_01A6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDD8A);
    WriteRegisterWord(RegisterType::SP, 0x9439);
    WriteRegisterByte(RegisterType::A, 0xD5);
    WriteRegisterByte(RegisterType::B, 0x5D);
    WriteRegisterByte(RegisterType::C, 0xB4);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0x5B);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x82);
    WriteRegisterByte(RegisterType::L, 0xFF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF7A, 0x00);
    WriteMemory(0xDD8B, 0x7A);
    WriteMemory(0xDD8A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD5);
    CheckRegisterByte(RegisterType::B, 0x5D);
    CheckRegisterByte(RegisterType::C, 0xB4);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x5B);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x82);
    CheckRegisterByte(RegisterType::L, 0xFF);
    CheckRegisterWord(RegisterType::PC, 0xDD8C);
    CheckRegisterWord(RegisterType::SP, 0x9439);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDD8A, 0xE0);
    CheckMemory(0xDD8B, 0x7A);
    CheckMemory(0xFF7A, 0xD5);
}

void test_E0_01A7()
{
    if (skip_test_E0_01A7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE606);
    WriteRegisterWord(RegisterType::SP, 0xA683);
    WriteRegisterByte(RegisterType::A, 0xC9);
    WriteRegisterByte(RegisterType::B, 0xB7);
    WriteRegisterByte(RegisterType::C, 0xA3);
    WriteRegisterByte(RegisterType::D, 0xF4);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xC2);
    WriteRegisterByte(RegisterType::L, 0xC2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFB, 0x00);
    WriteMemory(0xE607, 0xFB);
    WriteMemory(0xE606, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC9);
    CheckRegisterByte(RegisterType::B, 0xB7);
    CheckRegisterByte(RegisterType::C, 0xA3);
    CheckRegisterByte(RegisterType::D, 0xF4);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xC2);
    CheckRegisterByte(RegisterType::L, 0xC2);
    CheckRegisterWord(RegisterType::PC, 0xE608);
    CheckRegisterWord(RegisterType::SP, 0xA683);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE606, 0xE0);
    CheckMemory(0xE607, 0xFB);
    CheckMemory(0xFFFB, 0xC9);
}

void test_E0_01A8()
{
    if (skip_test_E0_01A8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3832);
    WriteRegisterWord(RegisterType::SP, 0xCF56);
    WriteRegisterByte(RegisterType::A, 0x63);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0x86);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x1A);
    WriteRegisterByte(RegisterType::L, 0xD1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0F, 0x00);
    WriteMemory(0x3833, 0x0F);
    WriteMemory(0x3832, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x63);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0xDE);
    CheckRegisterByte(RegisterType::E, 0x86);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x1A);
    CheckRegisterByte(RegisterType::L, 0xD1);
    CheckRegisterWord(RegisterType::PC, 0x3834);
    CheckRegisterWord(RegisterType::SP, 0xCF56);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3832, 0xE0);
    CheckMemory(0x3833, 0x0F);
    CheckMemory(0xFF0F, 0x63);
}

void test_E0_01A9()
{
    if (skip_test_E0_01A9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB59C);
    WriteRegisterWord(RegisterType::SP, 0xFCE5);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0x6E);
    WriteRegisterByte(RegisterType::C, 0xDD);
    WriteRegisterByte(RegisterType::D, 0xCC);
    WriteRegisterByte(RegisterType::E, 0x2B);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xEA);
    WriteRegisterByte(RegisterType::L, 0xC9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFBD, 0x00);
    WriteMemory(0xB59D, 0xBD);
    WriteMemory(0xB59C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0x6E);
    CheckRegisterByte(RegisterType::C, 0xDD);
    CheckRegisterByte(RegisterType::D, 0xCC);
    CheckRegisterByte(RegisterType::E, 0x2B);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xEA);
    CheckRegisterByte(RegisterType::L, 0xC9);
    CheckRegisterWord(RegisterType::PC, 0xB59E);
    CheckRegisterWord(RegisterType::SP, 0xFCE5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB59C, 0xE0);
    CheckMemory(0xB59D, 0xBD);
    CheckMemory(0xFFBD, 0x44);
}

void test_E0_01AA()
{
    if (skip_test_E0_01AA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x646E);
    WriteRegisterWord(RegisterType::SP, 0xD9CD);
    WriteRegisterByte(RegisterType::A, 0x99);
    WriteRegisterByte(RegisterType::B, 0xF6);
    WriteRegisterByte(RegisterType::C, 0xC4);
    WriteRegisterByte(RegisterType::D, 0xB0);
    WriteRegisterByte(RegisterType::E, 0x24);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x8A);
    WriteRegisterByte(RegisterType::L, 0x31);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF66, 0x00);
    WriteMemory(0x646F, 0x66);
    WriteMemory(0x646E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x99);
    CheckRegisterByte(RegisterType::B, 0xF6);
    CheckRegisterByte(RegisterType::C, 0xC4);
    CheckRegisterByte(RegisterType::D, 0xB0);
    CheckRegisterByte(RegisterType::E, 0x24);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x8A);
    CheckRegisterByte(RegisterType::L, 0x31);
    CheckRegisterWord(RegisterType::PC, 0x6470);
    CheckRegisterWord(RegisterType::SP, 0xD9CD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x646E, 0xE0);
    CheckMemory(0x646F, 0x66);
    CheckMemory(0xFF66, 0x99);
}

void test_E0_01AB()
{
    if (skip_test_E0_01AB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2801);
    WriteRegisterWord(RegisterType::SP, 0xC93F);
    WriteRegisterByte(RegisterType::A, 0x29);
    WriteRegisterByte(RegisterType::B, 0xE4);
    WriteRegisterByte(RegisterType::C, 0xFB);
    WriteRegisterByte(RegisterType::D, 0x14);
    WriteRegisterByte(RegisterType::E, 0x7C);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0x3D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9C, 0x00);
    WriteMemory(0x2802, 0x9C);
    WriteMemory(0x2801, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x29);
    CheckRegisterByte(RegisterType::B, 0xE4);
    CheckRegisterByte(RegisterType::C, 0xFB);
    CheckRegisterByte(RegisterType::D, 0x14);
    CheckRegisterByte(RegisterType::E, 0x7C);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0x3D);
    CheckRegisterWord(RegisterType::PC, 0x2803);
    CheckRegisterWord(RegisterType::SP, 0xC93F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2801, 0xE0);
    CheckMemory(0x2802, 0x9C);
    CheckMemory(0xFF9C, 0x29);
}

void test_E0_01AC()
{
    if (skip_test_E0_01AC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3D0E);
    WriteRegisterWord(RegisterType::SP, 0x1C36);
    WriteRegisterByte(RegisterType::A, 0x90);
    WriteRegisterByte(RegisterType::B, 0xCF);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0x65);
    WriteRegisterByte(RegisterType::E, 0xDB);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x87);
    WriteRegisterByte(RegisterType::L, 0xFD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF9, 0x00);
    WriteMemory(0x3D0F, 0xF9);
    WriteMemory(0x3D0E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x90);
    CheckRegisterByte(RegisterType::B, 0xCF);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0xDB);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x87);
    CheckRegisterByte(RegisterType::L, 0xFD);
    CheckRegisterWord(RegisterType::PC, 0x3D10);
    CheckRegisterWord(RegisterType::SP, 0x1C36);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3D0E, 0xE0);
    CheckMemory(0x3D0F, 0xF9);
    CheckMemory(0xFFF9, 0x90);
}

void test_E0_01AD()
{
    if (skip_test_E0_01AD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x78FC);
    WriteRegisterWord(RegisterType::SP, 0x4CCA);
    WriteRegisterByte(RegisterType::A, 0x03);
    WriteRegisterByte(RegisterType::B, 0xCF);
    WriteRegisterByte(RegisterType::C, 0x3D);
    WriteRegisterByte(RegisterType::D, 0x8C);
    WriteRegisterByte(RegisterType::E, 0x1D);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x95);
    WriteRegisterByte(RegisterType::L, 0xE2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF74, 0x00);
    WriteMemory(0x78FD, 0x74);
    WriteMemory(0x78FC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x03);
    CheckRegisterByte(RegisterType::B, 0xCF);
    CheckRegisterByte(RegisterType::C, 0x3D);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0x1D);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x95);
    CheckRegisterByte(RegisterType::L, 0xE2);
    CheckRegisterWord(RegisterType::PC, 0x78FE);
    CheckRegisterWord(RegisterType::SP, 0x4CCA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x78FC, 0xE0);
    CheckMemory(0x78FD, 0x74);
    CheckMemory(0xFF74, 0x03);
}

void test_E0_01AE()
{
    if (skip_test_E0_01AE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x37D1);
    WriteRegisterWord(RegisterType::SP, 0x2C30);
    WriteRegisterByte(RegisterType::A, 0x0B);
    WriteRegisterByte(RegisterType::B, 0x91);
    WriteRegisterByte(RegisterType::C, 0x3A);
    WriteRegisterByte(RegisterType::D, 0xCD);
    WriteRegisterByte(RegisterType::E, 0x1C);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x92);
    WriteRegisterByte(RegisterType::L, 0x2E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8E, 0x00);
    WriteMemory(0x37D2, 0x8E);
    WriteMemory(0x37D1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0B);
    CheckRegisterByte(RegisterType::B, 0x91);
    CheckRegisterByte(RegisterType::C, 0x3A);
    CheckRegisterByte(RegisterType::D, 0xCD);
    CheckRegisterByte(RegisterType::E, 0x1C);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x92);
    CheckRegisterByte(RegisterType::L, 0x2E);
    CheckRegisterWord(RegisterType::PC, 0x37D3);
    CheckRegisterWord(RegisterType::SP, 0x2C30);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x37D1, 0xE0);
    CheckMemory(0x37D2, 0x8E);
    CheckMemory(0xFF8E, 0x0B);
}

void test_E0_01AF()
{
    if (skip_test_E0_01AF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE326);
    WriteRegisterWord(RegisterType::SP, 0x4767);
    WriteRegisterByte(RegisterType::A, 0xA4);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0x8B);
    WriteRegisterByte(RegisterType::D, 0xDA);
    WriteRegisterByte(RegisterType::E, 0x46);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x52);
    WriteRegisterByte(RegisterType::L, 0x0E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3A, 0x00);
    WriteMemory(0xE327, 0x3A);
    WriteMemory(0xE326, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA4);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0x8B);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0x46);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x52);
    CheckRegisterByte(RegisterType::L, 0x0E);
    CheckRegisterWord(RegisterType::PC, 0xE328);
    CheckRegisterWord(RegisterType::SP, 0x4767);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE326, 0xE0);
    CheckMemory(0xE327, 0x3A);
    CheckMemory(0xFF3A, 0xA4);
}

void test_E0_01B0()
{
    if (skip_test_E0_01B0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFD89);
    WriteRegisterWord(RegisterType::SP, 0xC374);
    WriteRegisterByte(RegisterType::A, 0x4E);
    WriteRegisterByte(RegisterType::B, 0x14);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0x34);
    WriteRegisterByte(RegisterType::E, 0x34);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xDE);
    WriteRegisterByte(RegisterType::L, 0x6E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3B, 0x00);
    WriteMemory(0xFD8A, 0x3B);
    WriteMemory(0xFD89, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4E);
    CheckRegisterByte(RegisterType::B, 0x14);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0x34);
    CheckRegisterByte(RegisterType::E, 0x34);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xDE);
    CheckRegisterByte(RegisterType::L, 0x6E);
    CheckRegisterWord(RegisterType::PC, 0xFD8B);
    CheckRegisterWord(RegisterType::SP, 0xC374);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFD89, 0xE0);
    CheckMemory(0xFD8A, 0x3B);
    CheckMemory(0xFF3B, 0x4E);
}

void test_E0_01B1()
{
    if (skip_test_E0_01B1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2121);
    WriteRegisterWord(RegisterType::SP, 0xA8EB);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0xE8);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0xAC);
    WriteRegisterByte(RegisterType::E, 0xAF);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x49);
    WriteRegisterByte(RegisterType::L, 0x04);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF62, 0x00);
    WriteMemory(0x2122, 0x62);
    WriteMemory(0x2121, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0xE8);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0xAC);
    CheckRegisterByte(RegisterType::E, 0xAF);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x49);
    CheckRegisterByte(RegisterType::L, 0x04);
    CheckRegisterWord(RegisterType::PC, 0x2123);
    CheckRegisterWord(RegisterType::SP, 0xA8EB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2121, 0xE0);
    CheckMemory(0x2122, 0x62);
    CheckMemory(0xFF62, 0x71);
}

void test_E0_01B2()
{
    if (skip_test_E0_01B2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7F1E);
    WriteRegisterWord(RegisterType::SP, 0x1D22);
    WriteRegisterByte(RegisterType::A, 0x63);
    WriteRegisterByte(RegisterType::B, 0x82);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0x7C);
    WriteRegisterByte(RegisterType::E, 0x06);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xAA);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFBF, 0x00);
    WriteMemory(0x7F1F, 0xBF);
    WriteMemory(0x7F1E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x63);
    CheckRegisterByte(RegisterType::B, 0x82);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0x7C);
    CheckRegisterByte(RegisterType::E, 0x06);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xAA);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0x7F20);
    CheckRegisterWord(RegisterType::SP, 0x1D22);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7F1E, 0xE0);
    CheckMemory(0x7F1F, 0xBF);
    CheckMemory(0xFFBF, 0x63);
}

void test_E0_01B3()
{
    if (skip_test_E0_01B3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4E75);
    WriteRegisterWord(RegisterType::SP, 0x5846);
    WriteRegisterByte(RegisterType::A, 0xEC);
    WriteRegisterByte(RegisterType::B, 0xF5);
    WriteRegisterByte(RegisterType::C, 0x8F);
    WriteRegisterByte(RegisterType::D, 0xEC);
    WriteRegisterByte(RegisterType::E, 0xA3);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x79);
    WriteRegisterByte(RegisterType::L, 0x95);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAF, 0x00);
    WriteMemory(0x4E76, 0xAF);
    WriteMemory(0x4E75, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEC);
    CheckRegisterByte(RegisterType::B, 0xF5);
    CheckRegisterByte(RegisterType::C, 0x8F);
    CheckRegisterByte(RegisterType::D, 0xEC);
    CheckRegisterByte(RegisterType::E, 0xA3);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x79);
    CheckRegisterByte(RegisterType::L, 0x95);
    CheckRegisterWord(RegisterType::PC, 0x4E77);
    CheckRegisterWord(RegisterType::SP, 0x5846);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4E75, 0xE0);
    CheckMemory(0x4E76, 0xAF);
    CheckMemory(0xFFAF, 0xEC);
}

void test_E0_01B4()
{
    if (skip_test_E0_01B4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE68B);
    WriteRegisterWord(RegisterType::SP, 0x2DD6);
    WriteRegisterByte(RegisterType::A, 0x7C);
    WriteRegisterByte(RegisterType::B, 0x70);
    WriteRegisterByte(RegisterType::C, 0x13);
    WriteRegisterByte(RegisterType::D, 0x23);
    WriteRegisterByte(RegisterType::E, 0x2B);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xF0);
    WriteRegisterByte(RegisterType::L, 0x2A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD4, 0x00);
    WriteMemory(0xE68C, 0xD4);
    WriteMemory(0xE68B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7C);
    CheckRegisterByte(RegisterType::B, 0x70);
    CheckRegisterByte(RegisterType::C, 0x13);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0x2B);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xF0);
    CheckRegisterByte(RegisterType::L, 0x2A);
    CheckRegisterWord(RegisterType::PC, 0xE68D);
    CheckRegisterWord(RegisterType::SP, 0x2DD6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE68B, 0xE0);
    CheckMemory(0xE68C, 0xD4);
    CheckMemory(0xFFD4, 0x7C);
}

void test_E0_01B5()
{
    if (skip_test_E0_01B5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE58B);
    WriteRegisterWord(RegisterType::SP, 0x6249);
    WriteRegisterByte(RegisterType::A, 0x7F);
    WriteRegisterByte(RegisterType::B, 0x59);
    WriteRegisterByte(RegisterType::C, 0x44);
    WriteRegisterByte(RegisterType::D, 0xDA);
    WriteRegisterByte(RegisterType::E, 0x58);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xBB);
    WriteRegisterByte(RegisterType::L, 0x6C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF3C, 0x00);
    WriteMemory(0xE58C, 0x3C);
    WriteMemory(0xE58B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7F);
    CheckRegisterByte(RegisterType::B, 0x59);
    CheckRegisterByte(RegisterType::C, 0x44);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0x58);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xBB);
    CheckRegisterByte(RegisterType::L, 0x6C);
    CheckRegisterWord(RegisterType::PC, 0xE58D);
    CheckRegisterWord(RegisterType::SP, 0x6249);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE58B, 0xE0);
    CheckMemory(0xE58C, 0x3C);
    CheckMemory(0xFF3C, 0x7F);
}

void test_E0_01B6()
{
    if (skip_test_E0_01B6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFABE);
    WriteRegisterWord(RegisterType::SP, 0x5A3C);
    WriteRegisterByte(RegisterType::A, 0xA7);
    WriteRegisterByte(RegisterType::B, 0x47);
    WriteRegisterByte(RegisterType::C, 0xEF);
    WriteRegisterByte(RegisterType::D, 0x38);
    WriteRegisterByte(RegisterType::E, 0x42);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x0B);
    WriteRegisterByte(RegisterType::L, 0x6E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDC, 0x00);
    WriteMemory(0xFABF, 0xDC);
    WriteMemory(0xFABE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA7);
    CheckRegisterByte(RegisterType::B, 0x47);
    CheckRegisterByte(RegisterType::C, 0xEF);
    CheckRegisterByte(RegisterType::D, 0x38);
    CheckRegisterByte(RegisterType::E, 0x42);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x0B);
    CheckRegisterByte(RegisterType::L, 0x6E);
    CheckRegisterWord(RegisterType::PC, 0xFAC0);
    CheckRegisterWord(RegisterType::SP, 0x5A3C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFABE, 0xE0);
    CheckMemory(0xFABF, 0xDC);
    CheckMemory(0xFFDC, 0xA7);
}

void test_E0_01B7()
{
    if (skip_test_E0_01B7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8225);
    WriteRegisterWord(RegisterType::SP, 0x2A60);
    WriteRegisterByte(RegisterType::A, 0x84);
    WriteRegisterByte(RegisterType::B, 0x33);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0x33);
    WriteRegisterByte(RegisterType::E, 0xD8);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB1, 0x00);
    WriteMemory(0x8226, 0xB1);
    WriteMemory(0x8225, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x84);
    CheckRegisterByte(RegisterType::B, 0x33);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0x33);
    CheckRegisterByte(RegisterType::E, 0xD8);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0x8227);
    CheckRegisterWord(RegisterType::SP, 0x2A60);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8225, 0xE0);
    CheckMemory(0x8226, 0xB1);
    CheckMemory(0xFFB1, 0x84);
}

void test_E0_01B8()
{
    if (skip_test_E0_01B8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7601);
    WriteRegisterWord(RegisterType::SP, 0x1E3A);
    WriteRegisterByte(RegisterType::A, 0xB2);
    WriteRegisterByte(RegisterType::B, 0xDD);
    WriteRegisterByte(RegisterType::C, 0xE9);
    WriteRegisterByte(RegisterType::D, 0xE5);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xF5);
    WriteRegisterByte(RegisterType::L, 0xCB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE3, 0x00);
    WriteMemory(0x7602, 0xE3);
    WriteMemory(0x7601, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB2);
    CheckRegisterByte(RegisterType::B, 0xDD);
    CheckRegisterByte(RegisterType::C, 0xE9);
    CheckRegisterByte(RegisterType::D, 0xE5);
    CheckRegisterByte(RegisterType::E, 0xE0);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xF5);
    CheckRegisterByte(RegisterType::L, 0xCB);
    CheckRegisterWord(RegisterType::PC, 0x7603);
    CheckRegisterWord(RegisterType::SP, 0x1E3A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7601, 0xE0);
    CheckMemory(0x7602, 0xE3);
    CheckMemory(0xFFE3, 0xB2);
}

void test_E0_01B9()
{
    if (skip_test_E0_01B9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x520A);
    WriteRegisterWord(RegisterType::SP, 0xCEED);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0x2E);
    WriteRegisterByte(RegisterType::C, 0x7D);
    WriteRegisterByte(RegisterType::D, 0x94);
    WriteRegisterByte(RegisterType::E, 0x2E);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xFF);
    WriteRegisterByte(RegisterType::L, 0x62);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF72, 0x00);
    WriteMemory(0x520B, 0x72);
    WriteMemory(0x520A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0x2E);
    CheckRegisterByte(RegisterType::C, 0x7D);
    CheckRegisterByte(RegisterType::D, 0x94);
    CheckRegisterByte(RegisterType::E, 0x2E);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xFF);
    CheckRegisterByte(RegisterType::L, 0x62);
    CheckRegisterWord(RegisterType::PC, 0x520C);
    CheckRegisterWord(RegisterType::SP, 0xCEED);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x520A, 0xE0);
    CheckMemory(0x520B, 0x72);
    CheckMemory(0xFF72, 0x92);
}

void test_E0_01BA()
{
    if (skip_test_E0_01BA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCE5A);
    WriteRegisterWord(RegisterType::SP, 0xDEC2);
    WriteRegisterByte(RegisterType::A, 0x6E);
    WriteRegisterByte(RegisterType::B, 0xAD);
    WriteRegisterByte(RegisterType::C, 0xE1);
    WriteRegisterByte(RegisterType::D, 0x64);
    WriteRegisterByte(RegisterType::E, 0x16);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x5E);
    WriteRegisterByte(RegisterType::L, 0x20);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF36, 0x00);
    WriteMemory(0xCE5B, 0x36);
    WriteMemory(0xCE5A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6E);
    CheckRegisterByte(RegisterType::B, 0xAD);
    CheckRegisterByte(RegisterType::C, 0xE1);
    CheckRegisterByte(RegisterType::D, 0x64);
    CheckRegisterByte(RegisterType::E, 0x16);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x5E);
    CheckRegisterByte(RegisterType::L, 0x20);
    CheckRegisterWord(RegisterType::PC, 0xCE5C);
    CheckRegisterWord(RegisterType::SP, 0xDEC2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCE5A, 0xE0);
    CheckMemory(0xCE5B, 0x36);
    CheckMemory(0xFF36, 0x6E);
}

void test_E0_01BB()
{
    if (skip_test_E0_01BB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB6B9);
    WriteRegisterWord(RegisterType::SP, 0x32AB);
    WriteRegisterByte(RegisterType::A, 0xAE);
    WriteRegisterByte(RegisterType::B, 0x1C);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0x7C);
    WriteRegisterByte(RegisterType::E, 0xF2);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xED);
    WriteRegisterByte(RegisterType::L, 0xD1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA9, 0x00);
    WriteMemory(0xB6BA, 0xA9);
    WriteMemory(0xB6B9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAE);
    CheckRegisterByte(RegisterType::B, 0x1C);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0x7C);
    CheckRegisterByte(RegisterType::E, 0xF2);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xED);
    CheckRegisterByte(RegisterType::L, 0xD1);
    CheckRegisterWord(RegisterType::PC, 0xB6BB);
    CheckRegisterWord(RegisterType::SP, 0x32AB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB6B9, 0xE0);
    CheckMemory(0xB6BA, 0xA9);
    CheckMemory(0xFFA9, 0xAE);
}

void test_E0_01BC()
{
    if (skip_test_E0_01BC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBCEC);
    WriteRegisterWord(RegisterType::SP, 0x9BEF);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0x54);
    WriteRegisterByte(RegisterType::C, 0x17);
    WriteRegisterByte(RegisterType::D, 0x12);
    WriteRegisterByte(RegisterType::E, 0x3F);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x83);
    WriteRegisterByte(RegisterType::L, 0x42);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFBB, 0x00);
    WriteMemory(0xBCED, 0xBB);
    WriteMemory(0xBCEC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0x54);
    CheckRegisterByte(RegisterType::C, 0x17);
    CheckRegisterByte(RegisterType::D, 0x12);
    CheckRegisterByte(RegisterType::E, 0x3F);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x83);
    CheckRegisterByte(RegisterType::L, 0x42);
    CheckRegisterWord(RegisterType::PC, 0xBCEE);
    CheckRegisterWord(RegisterType::SP, 0x9BEF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBCEC, 0xE0);
    CheckMemory(0xBCED, 0xBB);
    CheckMemory(0xFFBB, 0xD9);
}

void test_E0_01BD()
{
    if (skip_test_E0_01BD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x00E1);
    WriteRegisterWord(RegisterType::SP, 0x5D62);
    WriteRegisterByte(RegisterType::A, 0xD4);
    WriteRegisterByte(RegisterType::B, 0xE1);
    WriteRegisterByte(RegisterType::C, 0xA0);
    WriteRegisterByte(RegisterType::D, 0x87);
    WriteRegisterByte(RegisterType::E, 0x27);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x02);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC7, 0x00);
    WriteMemory(0x00E2, 0xC7);
    WriteMemory(0x00E1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD4);
    CheckRegisterByte(RegisterType::B, 0xE1);
    CheckRegisterByte(RegisterType::C, 0xA0);
    CheckRegisterByte(RegisterType::D, 0x87);
    CheckRegisterByte(RegisterType::E, 0x27);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x02);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0x00E3);
    CheckRegisterWord(RegisterType::SP, 0x5D62);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x00E1, 0xE0);
    CheckMemory(0x00E2, 0xC7);
    CheckMemory(0xFFC7, 0xD4);
}

void test_E0_01BE()
{
    if (skip_test_E0_01BE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA51E);
    WriteRegisterWord(RegisterType::SP, 0x9FDB);
    WriteRegisterByte(RegisterType::A, 0x08);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0xF2);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xCA);
    WriteRegisterByte(RegisterType::L, 0x5B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF3C, 0x00);
    WriteMemory(0xA51F, 0x3C);
    WriteMemory(0xA51E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x08);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0xF2);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0xEE);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xCA);
    CheckRegisterByte(RegisterType::L, 0x5B);
    CheckRegisterWord(RegisterType::PC, 0xA520);
    CheckRegisterWord(RegisterType::SP, 0x9FDB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA51E, 0xE0);
    CheckMemory(0xA51F, 0x3C);
    CheckMemory(0xFF3C, 0x08);
}

void test_E0_01BF()
{
    if (skip_test_E0_01BF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB8B9);
    WriteRegisterWord(RegisterType::SP, 0xBACF);
    WriteRegisterByte(RegisterType::A, 0x79);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0x5E);
    WriteRegisterByte(RegisterType::D, 0x44);
    WriteRegisterByte(RegisterType::E, 0x22);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xC8);
    WriteRegisterByte(RegisterType::L, 0x28);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDC, 0x00);
    WriteMemory(0xB8BA, 0xDC);
    WriteMemory(0xB8B9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x79);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0x5E);
    CheckRegisterByte(RegisterType::D, 0x44);
    CheckRegisterByte(RegisterType::E, 0x22);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xC8);
    CheckRegisterByte(RegisterType::L, 0x28);
    CheckRegisterWord(RegisterType::PC, 0xB8BB);
    CheckRegisterWord(RegisterType::SP, 0xBACF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB8B9, 0xE0);
    CheckMemory(0xB8BA, 0xDC);
    CheckMemory(0xFFDC, 0x79);
}

void test_E0_01C0()
{
    if (skip_test_E0_01C0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x16F2);
    WriteRegisterWord(RegisterType::SP, 0x167B);
    WriteRegisterByte(RegisterType::A, 0xD2);
    WriteRegisterByte(RegisterType::B, 0xF5);
    WriteRegisterByte(RegisterType::C, 0x10);
    WriteRegisterByte(RegisterType::D, 0xC5);
    WriteRegisterByte(RegisterType::E, 0x93);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xF1);
    WriteRegisterByte(RegisterType::L, 0x31);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF22, 0x00);
    WriteMemory(0x16F3, 0x22);
    WriteMemory(0x16F2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD2);
    CheckRegisterByte(RegisterType::B, 0xF5);
    CheckRegisterByte(RegisterType::C, 0x10);
    CheckRegisterByte(RegisterType::D, 0xC5);
    CheckRegisterByte(RegisterType::E, 0x93);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xF1);
    CheckRegisterByte(RegisterType::L, 0x31);
    CheckRegisterWord(RegisterType::PC, 0x16F4);
    CheckRegisterWord(RegisterType::SP, 0x167B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x16F2, 0xE0);
    CheckMemory(0x16F3, 0x22);
    CheckMemory(0xFF22, 0xD2);
}

void test_E0_01C1()
{
    if (skip_test_E0_01C1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEA01);
    WriteRegisterWord(RegisterType::SP, 0x768F);
    WriteRegisterByte(RegisterType::A, 0x21);
    WriteRegisterByte(RegisterType::B, 0xF6);
    WriteRegisterByte(RegisterType::C, 0x59);
    WriteRegisterByte(RegisterType::D, 0x03);
    WriteRegisterByte(RegisterType::E, 0x8A);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x3D);
    WriteRegisterByte(RegisterType::L, 0x98);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE6, 0x00);
    WriteMemory(0xEA02, 0xE6);
    WriteMemory(0xEA01, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x21);
    CheckRegisterByte(RegisterType::B, 0xF6);
    CheckRegisterByte(RegisterType::C, 0x59);
    CheckRegisterByte(RegisterType::D, 0x03);
    CheckRegisterByte(RegisterType::E, 0x8A);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x3D);
    CheckRegisterByte(RegisterType::L, 0x98);
    CheckRegisterWord(RegisterType::PC, 0xEA03);
    CheckRegisterWord(RegisterType::SP, 0x768F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEA01, 0xE0);
    CheckMemory(0xEA02, 0xE6);
    CheckMemory(0xFFE6, 0x21);
}

void test_E0_01C2()
{
    if (skip_test_E0_01C2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x818D);
    WriteRegisterWord(RegisterType::SP, 0x0388);
    WriteRegisterByte(RegisterType::A, 0xFF);
    WriteRegisterByte(RegisterType::B, 0x10);
    WriteRegisterByte(RegisterType::C, 0xE2);
    WriteRegisterByte(RegisterType::D, 0x8A);
    WriteRegisterByte(RegisterType::E, 0xB8);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x85);
    WriteRegisterByte(RegisterType::L, 0xBC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFEA, 0x00);
    WriteMemory(0x818E, 0xEA);
    WriteMemory(0x818D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFF);
    CheckRegisterByte(RegisterType::B, 0x10);
    CheckRegisterByte(RegisterType::C, 0xE2);
    CheckRegisterByte(RegisterType::D, 0x8A);
    CheckRegisterByte(RegisterType::E, 0xB8);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x85);
    CheckRegisterByte(RegisterType::L, 0xBC);
    CheckRegisterWord(RegisterType::PC, 0x818F);
    CheckRegisterWord(RegisterType::SP, 0x0388);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x818D, 0xE0);
    CheckMemory(0x818E, 0xEA);
    CheckMemory(0xFFEA, 0xFF);
}

void test_E0_01C3()
{
    if (skip_test_E0_01C3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD314);
    WriteRegisterWord(RegisterType::SP, 0x2F36);
    WriteRegisterByte(RegisterType::A, 0xE9);
    WriteRegisterByte(RegisterType::B, 0x52);
    WriteRegisterByte(RegisterType::C, 0xB0);
    WriteRegisterByte(RegisterType::D, 0xEB);
    WriteRegisterByte(RegisterType::E, 0xAB);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x53);
    WriteRegisterByte(RegisterType::L, 0xB6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF1, 0x00);
    WriteMemory(0xD315, 0xF1);
    WriteMemory(0xD314, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE9);
    CheckRegisterByte(RegisterType::B, 0x52);
    CheckRegisterByte(RegisterType::C, 0xB0);
    CheckRegisterByte(RegisterType::D, 0xEB);
    CheckRegisterByte(RegisterType::E, 0xAB);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x53);
    CheckRegisterByte(RegisterType::L, 0xB6);
    CheckRegisterWord(RegisterType::PC, 0xD316);
    CheckRegisterWord(RegisterType::SP, 0x2F36);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD314, 0xE0);
    CheckMemory(0xD315, 0xF1);
    CheckMemory(0xFFF1, 0xE9);
}

void test_E0_01C4()
{
    if (skip_test_E0_01C4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0D40);
    WriteRegisterWord(RegisterType::SP, 0x72BE);
    WriteRegisterByte(RegisterType::A, 0x05);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0x39);
    WriteRegisterByte(RegisterType::E, 0x8F);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xDC);
    WriteRegisterByte(RegisterType::L, 0x66);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDC, 0x00);
    WriteMemory(0x0D41, 0xDC);
    WriteMemory(0x0D40, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x05);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0x39);
    CheckRegisterByte(RegisterType::E, 0x8F);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xDC);
    CheckRegisterByte(RegisterType::L, 0x66);
    CheckRegisterWord(RegisterType::PC, 0x0D42);
    CheckRegisterWord(RegisterType::SP, 0x72BE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0D40, 0xE0);
    CheckMemory(0x0D41, 0xDC);
    CheckMemory(0xFFDC, 0x05);
}

void test_E0_01C5()
{
    if (skip_test_E0_01C5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB7CC);
    WriteRegisterWord(RegisterType::SP, 0x6216);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x0C);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0x60);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x1E);
    WriteRegisterByte(RegisterType::L, 0x61);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD2, 0x00);
    WriteMemory(0xB7CD, 0xD2);
    WriteMemory(0xB7CC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x0C);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0x60);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x1E);
    CheckRegisterByte(RegisterType::L, 0x61);
    CheckRegisterWord(RegisterType::PC, 0xB7CE);
    CheckRegisterWord(RegisterType::SP, 0x6216);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB7CC, 0xE0);
    CheckMemory(0xB7CD, 0xD2);
    CheckMemory(0xFFD2, 0xC2);
}

void test_E0_01C6()
{
    if (skip_test_E0_01C6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE066);
    WriteRegisterWord(RegisterType::SP, 0x1121);
    WriteRegisterByte(RegisterType::A, 0x0B);
    WriteRegisterByte(RegisterType::B, 0xF1);
    WriteRegisterByte(RegisterType::C, 0x5C);
    WriteRegisterByte(RegisterType::D, 0x37);
    WriteRegisterByte(RegisterType::E, 0x9C);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x4A);
    WriteRegisterByte(RegisterType::L, 0xDF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF7A, 0x00);
    WriteMemory(0xE067, 0x7A);
    WriteMemory(0xE066, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0B);
    CheckRegisterByte(RegisterType::B, 0xF1);
    CheckRegisterByte(RegisterType::C, 0x5C);
    CheckRegisterByte(RegisterType::D, 0x37);
    CheckRegisterByte(RegisterType::E, 0x9C);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x4A);
    CheckRegisterByte(RegisterType::L, 0xDF);
    CheckRegisterWord(RegisterType::PC, 0xE068);
    CheckRegisterWord(RegisterType::SP, 0x1121);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE066, 0xE0);
    CheckMemory(0xE067, 0x7A);
    CheckMemory(0xFF7A, 0x0B);
}

void test_E0_01C7()
{
    if (skip_test_E0_01C7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x82E6);
    WriteRegisterWord(RegisterType::SP, 0x5E9B);
    WriteRegisterByte(RegisterType::A, 0x7C);
    WriteRegisterByte(RegisterType::B, 0xDF);
    WriteRegisterByte(RegisterType::C, 0xA7);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x98);
    WriteRegisterByte(RegisterType::L, 0xDD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF39, 0x00);
    WriteMemory(0x82E7, 0x39);
    WriteMemory(0x82E6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7C);
    CheckRegisterByte(RegisterType::B, 0xDF);
    CheckRegisterByte(RegisterType::C, 0xA7);
    CheckRegisterByte(RegisterType::D, 0xA6);
    CheckRegisterByte(RegisterType::E, 0x53);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x98);
    CheckRegisterByte(RegisterType::L, 0xDD);
    CheckRegisterWord(RegisterType::PC, 0x82E8);
    CheckRegisterWord(RegisterType::SP, 0x5E9B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x82E6, 0xE0);
    CheckMemory(0x82E7, 0x39);
    CheckMemory(0xFF39, 0x7C);
}

void test_E0_01C8()
{
    if (skip_test_E0_01C8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x63FB);
    WriteRegisterWord(RegisterType::SP, 0x368B);
    WriteRegisterByte(RegisterType::A, 0x8B);
    WriteRegisterByte(RegisterType::B, 0xC0);
    WriteRegisterByte(RegisterType::C, 0x59);
    WriteRegisterByte(RegisterType::D, 0x1C);
    WriteRegisterByte(RegisterType::E, 0x56);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x23);
    WriteRegisterByte(RegisterType::L, 0x48);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8C, 0x00);
    WriteMemory(0x63FC, 0x8C);
    WriteMemory(0x63FB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8B);
    CheckRegisterByte(RegisterType::B, 0xC0);
    CheckRegisterByte(RegisterType::C, 0x59);
    CheckRegisterByte(RegisterType::D, 0x1C);
    CheckRegisterByte(RegisterType::E, 0x56);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x23);
    CheckRegisterByte(RegisterType::L, 0x48);
    CheckRegisterWord(RegisterType::PC, 0x63FD);
    CheckRegisterWord(RegisterType::SP, 0x368B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x63FB, 0xE0);
    CheckMemory(0x63FC, 0x8C);
    CheckMemory(0xFF8C, 0x8B);
}

void test_E0_01C9()
{
    if (skip_test_E0_01C9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD805);
    WriteRegisterWord(RegisterType::SP, 0xA604);
    WriteRegisterByte(RegisterType::A, 0xEE);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0xAA);
    WriteRegisterByte(RegisterType::D, 0x2C);
    WriteRegisterByte(RegisterType::E, 0x9E);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x5A);
    WriteRegisterByte(RegisterType::L, 0xC9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF78, 0x00);
    WriteMemory(0xD806, 0x78);
    WriteMemory(0xD805, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEE);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0xAA);
    CheckRegisterByte(RegisterType::D, 0x2C);
    CheckRegisterByte(RegisterType::E, 0x9E);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x5A);
    CheckRegisterByte(RegisterType::L, 0xC9);
    CheckRegisterWord(RegisterType::PC, 0xD807);
    CheckRegisterWord(RegisterType::SP, 0xA604);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD805, 0xE0);
    CheckMemory(0xD806, 0x78);
    CheckMemory(0xFF78, 0xEE);
}

void test_E0_01CA()
{
    if (skip_test_E0_01CA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2EA5);
    WriteRegisterWord(RegisterType::SP, 0xC63C);
    WriteRegisterByte(RegisterType::A, 0x7A);
    WriteRegisterByte(RegisterType::B, 0x6C);
    WriteRegisterByte(RegisterType::C, 0x98);
    WriteRegisterByte(RegisterType::D, 0x43);
    WriteRegisterByte(RegisterType::E, 0x1E);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x28);
    WriteRegisterByte(RegisterType::L, 0xE6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF14, 0x00);
    WriteMemory(0x2EA6, 0x14);
    WriteMemory(0x2EA5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7A);
    CheckRegisterByte(RegisterType::B, 0x6C);
    CheckRegisterByte(RegisterType::C, 0x98);
    CheckRegisterByte(RegisterType::D, 0x43);
    CheckRegisterByte(RegisterType::E, 0x1E);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x28);
    CheckRegisterByte(RegisterType::L, 0xE6);
    CheckRegisterWord(RegisterType::PC, 0x2EA7);
    CheckRegisterWord(RegisterType::SP, 0xC63C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2EA5, 0xE0);
    CheckMemory(0x2EA6, 0x14);
    CheckMemory(0xFF14, 0x7A);
}

void test_E0_01CB()
{
    if (skip_test_E0_01CB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9174);
    WriteRegisterWord(RegisterType::SP, 0xF55C);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0xCD);
    WriteRegisterByte(RegisterType::C, 0x64);
    WriteRegisterByte(RegisterType::D, 0xF6);
    WriteRegisterByte(RegisterType::E, 0x48);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xB1);
    WriteRegisterByte(RegisterType::L, 0x68);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5F, 0x00);
    WriteMemory(0x9175, 0x5F);
    WriteMemory(0x9174, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0xCD);
    CheckRegisterByte(RegisterType::C, 0x64);
    CheckRegisterByte(RegisterType::D, 0xF6);
    CheckRegisterByte(RegisterType::E, 0x48);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xB1);
    CheckRegisterByte(RegisterType::L, 0x68);
    CheckRegisterWord(RegisterType::PC, 0x9176);
    CheckRegisterWord(RegisterType::SP, 0xF55C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9174, 0xE0);
    CheckMemory(0x9175, 0x5F);
    CheckMemory(0xFF5F, 0x92);
}

void test_E0_01CC()
{
    if (skip_test_E0_01CC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9A1F);
    WriteRegisterWord(RegisterType::SP, 0x73E9);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0xB5);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0x1C);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x28);
    WriteRegisterByte(RegisterType::L, 0x2C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4B, 0x00);
    WriteMemory(0x9A20, 0x4B);
    WriteMemory(0x9A1F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0xB5);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0x1C);
    CheckRegisterByte(RegisterType::E, 0xC5);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x28);
    CheckRegisterByte(RegisterType::L, 0x2C);
    CheckRegisterWord(RegisterType::PC, 0x9A21);
    CheckRegisterWord(RegisterType::SP, 0x73E9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9A1F, 0xE0);
    CheckMemory(0x9A20, 0x4B);
    CheckMemory(0xFF4B, 0xC7);
}

void test_E0_01CD()
{
    if (skip_test_E0_01CD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x680B);
    WriteRegisterWord(RegisterType::SP, 0xE984);
    WriteRegisterByte(RegisterType::A, 0x81);
    WriteRegisterByte(RegisterType::B, 0x61);
    WriteRegisterByte(RegisterType::C, 0xA1);
    WriteRegisterByte(RegisterType::D, 0xBF);
    WriteRegisterByte(RegisterType::E, 0xD6);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x99);
    WriteRegisterByte(RegisterType::L, 0x6B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3B, 0x00);
    WriteMemory(0x680C, 0x3B);
    WriteMemory(0x680B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x81);
    CheckRegisterByte(RegisterType::B, 0x61);
    CheckRegisterByte(RegisterType::C, 0xA1);
    CheckRegisterByte(RegisterType::D, 0xBF);
    CheckRegisterByte(RegisterType::E, 0xD6);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x99);
    CheckRegisterByte(RegisterType::L, 0x6B);
    CheckRegisterWord(RegisterType::PC, 0x680D);
    CheckRegisterWord(RegisterType::SP, 0xE984);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x680B, 0xE0);
    CheckMemory(0x680C, 0x3B);
    CheckMemory(0xFF3B, 0x81);
}

void test_E0_01CE()
{
    if (skip_test_E0_01CE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2CEE);
    WriteRegisterWord(RegisterType::SP, 0xE860);
    WriteRegisterByte(RegisterType::A, 0x5C);
    WriteRegisterByte(RegisterType::B, 0x1D);
    WriteRegisterByte(RegisterType::C, 0xCB);
    WriteRegisterByte(RegisterType::D, 0xB0);
    WriteRegisterByte(RegisterType::E, 0x22);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x62);
    WriteRegisterByte(RegisterType::L, 0xDA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF19, 0x00);
    WriteMemory(0x2CEF, 0x19);
    WriteMemory(0x2CEE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5C);
    CheckRegisterByte(RegisterType::B, 0x1D);
    CheckRegisterByte(RegisterType::C, 0xCB);
    CheckRegisterByte(RegisterType::D, 0xB0);
    CheckRegisterByte(RegisterType::E, 0x22);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x62);
    CheckRegisterByte(RegisterType::L, 0xDA);
    CheckRegisterWord(RegisterType::PC, 0x2CF0);
    CheckRegisterWord(RegisterType::SP, 0xE860);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2CEE, 0xE0);
    CheckMemory(0x2CEF, 0x19);
    CheckMemory(0xFF19, 0x5C);
}

void test_E0_01CF()
{
    if (skip_test_E0_01CF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCA39);
    WriteRegisterWord(RegisterType::SP, 0x66D6);
    WriteRegisterByte(RegisterType::A, 0xD3);
    WriteRegisterByte(RegisterType::B, 0xE5);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0xD1);
    WriteRegisterByte(RegisterType::E, 0xB2);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xBA);
    WriteRegisterByte(RegisterType::L, 0x4D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFEA, 0x00);
    WriteMemory(0xCA3A, 0xEA);
    WriteMemory(0xCA39, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD3);
    CheckRegisterByte(RegisterType::B, 0xE5);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0xD1);
    CheckRegisterByte(RegisterType::E, 0xB2);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xBA);
    CheckRegisterByte(RegisterType::L, 0x4D);
    CheckRegisterWord(RegisterType::PC, 0xCA3B);
    CheckRegisterWord(RegisterType::SP, 0x66D6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCA39, 0xE0);
    CheckMemory(0xCA3A, 0xEA);
    CheckMemory(0xFFEA, 0xD3);
}

void test_E0_01D0()
{
    if (skip_test_E0_01D0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3BE8);
    WriteRegisterWord(RegisterType::SP, 0x5EC2);
    WriteRegisterByte(RegisterType::A, 0x0C);
    WriteRegisterByte(RegisterType::B, 0x6B);
    WriteRegisterByte(RegisterType::C, 0xCA);
    WriteRegisterByte(RegisterType::D, 0xCF);
    WriteRegisterByte(RegisterType::E, 0xF8);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xDD);
    WriteRegisterByte(RegisterType::L, 0x14);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFFA, 0x00);
    WriteMemory(0x3BE9, 0xFA);
    WriteMemory(0x3BE8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0C);
    CheckRegisterByte(RegisterType::B, 0x6B);
    CheckRegisterByte(RegisterType::C, 0xCA);
    CheckRegisterByte(RegisterType::D, 0xCF);
    CheckRegisterByte(RegisterType::E, 0xF8);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xDD);
    CheckRegisterByte(RegisterType::L, 0x14);
    CheckRegisterWord(RegisterType::PC, 0x3BEA);
    CheckRegisterWord(RegisterType::SP, 0x5EC2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3BE8, 0xE0);
    CheckMemory(0x3BE9, 0xFA);
    CheckMemory(0xFFFA, 0x0C);
}

void test_E0_01D1()
{
    if (skip_test_E0_01D1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6CD9);
    WriteRegisterWord(RegisterType::SP, 0x8F2E);
    WriteRegisterByte(RegisterType::A, 0x2C);
    WriteRegisterByte(RegisterType::B, 0x14);
    WriteRegisterByte(RegisterType::C, 0x56);
    WriteRegisterByte(RegisterType::D, 0xA7);
    WriteRegisterByte(RegisterType::E, 0x09);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x75);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3F, 0x00);
    WriteMemory(0x6CDA, 0x3F);
    WriteMemory(0x6CD9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2C);
    CheckRegisterByte(RegisterType::B, 0x14);
    CheckRegisterByte(RegisterType::C, 0x56);
    CheckRegisterByte(RegisterType::D, 0xA7);
    CheckRegisterByte(RegisterType::E, 0x09);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x75);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0x6CDB);
    CheckRegisterWord(RegisterType::SP, 0x8F2E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6CD9, 0xE0);
    CheckMemory(0x6CDA, 0x3F);
    CheckMemory(0xFF3F, 0x2C);
}

void test_E0_01D2()
{
    if (skip_test_E0_01D2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9F1D);
    WriteRegisterWord(RegisterType::SP, 0xC3D3);
    WriteRegisterByte(RegisterType::A, 0xA6);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0x1C);
    WriteRegisterByte(RegisterType::D, 0x4E);
    WriteRegisterByte(RegisterType::E, 0xA6);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x2E);
    WriteRegisterByte(RegisterType::L, 0x13);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFBB, 0x00);
    WriteMemory(0x9F1E, 0xBB);
    WriteMemory(0x9F1D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA6);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0x1C);
    CheckRegisterByte(RegisterType::D, 0x4E);
    CheckRegisterByte(RegisterType::E, 0xA6);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x2E);
    CheckRegisterByte(RegisterType::L, 0x13);
    CheckRegisterWord(RegisterType::PC, 0x9F1F);
    CheckRegisterWord(RegisterType::SP, 0xC3D3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9F1D, 0xE0);
    CheckMemory(0x9F1E, 0xBB);
    CheckMemory(0xFFBB, 0xA6);
}

void test_E0_01D3()
{
    if (skip_test_E0_01D3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE92C);
    WriteRegisterWord(RegisterType::SP, 0xA24B);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0x05);
    WriteRegisterByte(RegisterType::C, 0x83);
    WriteRegisterByte(RegisterType::D, 0xAC);
    WriteRegisterByte(RegisterType::E, 0x01);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xDD);
    WriteRegisterByte(RegisterType::L, 0x66);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA4, 0x00);
    WriteMemory(0xE92D, 0xA4);
    WriteMemory(0xE92C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0x05);
    CheckRegisterByte(RegisterType::C, 0x83);
    CheckRegisterByte(RegisterType::D, 0xAC);
    CheckRegisterByte(RegisterType::E, 0x01);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xDD);
    CheckRegisterByte(RegisterType::L, 0x66);
    CheckRegisterWord(RegisterType::PC, 0xE92E);
    CheckRegisterWord(RegisterType::SP, 0xA24B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE92C, 0xE0);
    CheckMemory(0xE92D, 0xA4);
    CheckMemory(0xFFA4, 0xBD);
}

void test_E0_01D4()
{
    if (skip_test_E0_01D4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x352C);
    WriteRegisterWord(RegisterType::SP, 0xFCA8);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0x4A);
    WriteRegisterByte(RegisterType::C, 0x4C);
    WriteRegisterByte(RegisterType::D, 0x7D);
    WriteRegisterByte(RegisterType::E, 0x21);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x12);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF43, 0x00);
    WriteMemory(0x352D, 0x43);
    WriteMemory(0x352C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0x4A);
    CheckRegisterByte(RegisterType::C, 0x4C);
    CheckRegisterByte(RegisterType::D, 0x7D);
    CheckRegisterByte(RegisterType::E, 0x21);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x12);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0x352E);
    CheckRegisterWord(RegisterType::SP, 0xFCA8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x352C, 0xE0);
    CheckMemory(0x352D, 0x43);
    CheckMemory(0xFF43, 0x24);
}

void test_E0_01D5()
{
    if (skip_test_E0_01D5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0FC0);
    WriteRegisterWord(RegisterType::SP, 0xFA4A);
    WriteRegisterByte(RegisterType::A, 0xEA);
    WriteRegisterByte(RegisterType::B, 0xBB);
    WriteRegisterByte(RegisterType::C, 0x2F);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0xBF);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xB9);
    WriteRegisterByte(RegisterType::L, 0x69);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAE, 0x00);
    WriteMemory(0x0FC1, 0xAE);
    WriteMemory(0x0FC0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEA);
    CheckRegisterByte(RegisterType::B, 0xBB);
    CheckRegisterByte(RegisterType::C, 0x2F);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0xBF);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xB9);
    CheckRegisterByte(RegisterType::L, 0x69);
    CheckRegisterWord(RegisterType::PC, 0x0FC2);
    CheckRegisterWord(RegisterType::SP, 0xFA4A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0FC0, 0xE0);
    CheckMemory(0x0FC1, 0xAE);
    CheckMemory(0xFFAE, 0xEA);
}

void test_E0_01D6()
{
    if (skip_test_E0_01D6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9897);
    WriteRegisterWord(RegisterType::SP, 0x2D4C);
    WriteRegisterByte(RegisterType::A, 0x12);
    WriteRegisterByte(RegisterType::B, 0xB2);
    WriteRegisterByte(RegisterType::C, 0x65);
    WriteRegisterByte(RegisterType::D, 0x5C);
    WriteRegisterByte(RegisterType::E, 0x15);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x8B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB3, 0x00);
    WriteMemory(0x9898, 0xB3);
    WriteMemory(0x9897, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x12);
    CheckRegisterByte(RegisterType::B, 0xB2);
    CheckRegisterByte(RegisterType::C, 0x65);
    CheckRegisterByte(RegisterType::D, 0x5C);
    CheckRegisterByte(RegisterType::E, 0x15);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x8B);
    CheckRegisterWord(RegisterType::PC, 0x9899);
    CheckRegisterWord(RegisterType::SP, 0x2D4C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9897, 0xE0);
    CheckMemory(0x9898, 0xB3);
    CheckMemory(0xFFB3, 0x12);
}

void test_E0_01D7()
{
    if (skip_test_E0_01D7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6A92);
    WriteRegisterWord(RegisterType::SP, 0xBB2B);
    WriteRegisterByte(RegisterType::A, 0xEE);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0x8D);
    WriteRegisterByte(RegisterType::E, 0xC0);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x6A);
    WriteRegisterByte(RegisterType::L, 0x33);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF80, 0x00);
    WriteMemory(0x6A93, 0x80);
    WriteMemory(0x6A92, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEE);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0x8D);
    CheckRegisterByte(RegisterType::E, 0xC0);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x6A);
    CheckRegisterByte(RegisterType::L, 0x33);
    CheckRegisterWord(RegisterType::PC, 0x6A94);
    CheckRegisterWord(RegisterType::SP, 0xBB2B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6A92, 0xE0);
    CheckMemory(0x6A93, 0x80);
    CheckMemory(0xFF80, 0xEE);
}

void test_E0_01D8()
{
    if (skip_test_E0_01D8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD74B);
    WriteRegisterWord(RegisterType::SP, 0x69D7);
    WriteRegisterByte(RegisterType::A, 0x65);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0x99);
    WriteRegisterByte(RegisterType::D, 0x04);
    WriteRegisterByte(RegisterType::E, 0x07);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x04);
    WriteRegisterByte(RegisterType::L, 0xEC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA7, 0x00);
    WriteMemory(0xD74C, 0xA7);
    WriteMemory(0xD74B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x65);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0x99);
    CheckRegisterByte(RegisterType::D, 0x04);
    CheckRegisterByte(RegisterType::E, 0x07);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x04);
    CheckRegisterByte(RegisterType::L, 0xEC);
    CheckRegisterWord(RegisterType::PC, 0xD74D);
    CheckRegisterWord(RegisterType::SP, 0x69D7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD74B, 0xE0);
    CheckMemory(0xD74C, 0xA7);
    CheckMemory(0xFFA7, 0x65);
}

void test_E0_01D9()
{
    if (skip_test_E0_01D9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC2D8);
    WriteRegisterWord(RegisterType::SP, 0xF944);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0x04);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0x27);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x96);
    WriteRegisterByte(RegisterType::L, 0x7D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDC, 0x00);
    WriteMemory(0xC2D9, 0xDC);
    WriteMemory(0xC2D8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0x04);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0xDE);
    CheckRegisterByte(RegisterType::E, 0x27);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x96);
    CheckRegisterByte(RegisterType::L, 0x7D);
    CheckRegisterWord(RegisterType::PC, 0xC2DA);
    CheckRegisterWord(RegisterType::SP, 0xF944);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC2D8, 0xE0);
    CheckMemory(0xC2D9, 0xDC);
    CheckMemory(0xFFDC, 0x92);
}

void test_E0_01DA()
{
    if (skip_test_E0_01DA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1804);
    WriteRegisterWord(RegisterType::SP, 0x8CB7);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0x0F);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0x5E);
    WriteRegisterByte(RegisterType::E, 0xB9);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x08);
    WriteRegisterByte(RegisterType::L, 0x3C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA1, 0x00);
    WriteMemory(0x1805, 0xA1);
    WriteMemory(0x1804, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0x0F);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0x5E);
    CheckRegisterByte(RegisterType::E, 0xB9);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x08);
    CheckRegisterByte(RegisterType::L, 0x3C);
    CheckRegisterWord(RegisterType::PC, 0x1806);
    CheckRegisterWord(RegisterType::SP, 0x8CB7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1804, 0xE0);
    CheckMemory(0x1805, 0xA1);
    CheckMemory(0xFFA1, 0x9B);
}

void test_E0_01DB()
{
    if (skip_test_E0_01DB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2CE7);
    WriteRegisterWord(RegisterType::SP, 0x272D);
    WriteRegisterByte(RegisterType::A, 0x0D);
    WriteRegisterByte(RegisterType::B, 0xB3);
    WriteRegisterByte(RegisterType::C, 0x36);
    WriteRegisterByte(RegisterType::D, 0x79);
    WriteRegisterByte(RegisterType::E, 0xC0);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xF4);
    WriteRegisterByte(RegisterType::L, 0x01);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD7, 0x00);
    WriteMemory(0x2CE8, 0xD7);
    WriteMemory(0x2CE7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0D);
    CheckRegisterByte(RegisterType::B, 0xB3);
    CheckRegisterByte(RegisterType::C, 0x36);
    CheckRegisterByte(RegisterType::D, 0x79);
    CheckRegisterByte(RegisterType::E, 0xC0);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xF4);
    CheckRegisterByte(RegisterType::L, 0x01);
    CheckRegisterWord(RegisterType::PC, 0x2CE9);
    CheckRegisterWord(RegisterType::SP, 0x272D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2CE7, 0xE0);
    CheckMemory(0x2CE8, 0xD7);
    CheckMemory(0xFFD7, 0x0D);
}

void test_E0_01DC()
{
    if (skip_test_E0_01DC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x894D);
    WriteRegisterWord(RegisterType::SP, 0xB757);
    WriteRegisterByte(RegisterType::A, 0x01);
    WriteRegisterByte(RegisterType::B, 0xBA);
    WriteRegisterByte(RegisterType::C, 0x56);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0x5A);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x13);
    WriteRegisterByte(RegisterType::L, 0x0E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA0, 0x00);
    WriteMemory(0x894E, 0xA0);
    WriteMemory(0x894D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x01);
    CheckRegisterByte(RegisterType::B, 0xBA);
    CheckRegisterByte(RegisterType::C, 0x56);
    CheckRegisterByte(RegisterType::D, 0xD4);
    CheckRegisterByte(RegisterType::E, 0x5A);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x13);
    CheckRegisterByte(RegisterType::L, 0x0E);
    CheckRegisterWord(RegisterType::PC, 0x894F);
    CheckRegisterWord(RegisterType::SP, 0xB757);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x894D, 0xE0);
    CheckMemory(0x894E, 0xA0);
    CheckMemory(0xFFA0, 0x01);
}

void test_E0_01DD()
{
    if (skip_test_E0_01DD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4BB1);
    WriteRegisterWord(RegisterType::SP, 0x0AF0);
    WriteRegisterByte(RegisterType::A, 0xD8);
    WriteRegisterByte(RegisterType::B, 0x9A);
    WriteRegisterByte(RegisterType::C, 0x21);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0xAD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD5, 0x00);
    WriteMemory(0x4BB2, 0xD5);
    WriteMemory(0x4BB1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD8);
    CheckRegisterByte(RegisterType::B, 0x9A);
    CheckRegisterByte(RegisterType::C, 0x21);
    CheckRegisterByte(RegisterType::D, 0x99);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0xAD);
    CheckRegisterWord(RegisterType::PC, 0x4BB3);
    CheckRegisterWord(RegisterType::SP, 0x0AF0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4BB1, 0xE0);
    CheckMemory(0x4BB2, 0xD5);
    CheckMemory(0xFFD5, 0xD8);
}

void test_E0_01DE()
{
    if (skip_test_E0_01DE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFF4A);
    WriteRegisterWord(RegisterType::SP, 0x633D);
    WriteRegisterByte(RegisterType::A, 0x8C);
    WriteRegisterByte(RegisterType::B, 0x58);
    WriteRegisterByte(RegisterType::C, 0x64);
    WriteRegisterByte(RegisterType::D, 0x88);
    WriteRegisterByte(RegisterType::E, 0x8C);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x1B);
    WriteRegisterByte(RegisterType::L, 0xC4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDF, 0x00);
    WriteMemory(0xFF4B, 0xDF);
    WriteMemory(0xFF4A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8C);
    CheckRegisterByte(RegisterType::B, 0x58);
    CheckRegisterByte(RegisterType::C, 0x64);
    CheckRegisterByte(RegisterType::D, 0x88);
    CheckRegisterByte(RegisterType::E, 0x8C);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x1B);
    CheckRegisterByte(RegisterType::L, 0xC4);
    CheckRegisterWord(RegisterType::PC, 0xFF4C);
    CheckRegisterWord(RegisterType::SP, 0x633D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFF4A, 0xE0);
    CheckMemory(0xFF4B, 0xDF);
    CheckMemory(0xFFDF, 0x8C);
}

void test_E0_01DF()
{
    if (skip_test_E0_01DF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8F93);
    WriteRegisterWord(RegisterType::SP, 0xDEF6);
    WriteRegisterByte(RegisterType::A, 0xC3);
    WriteRegisterByte(RegisterType::B, 0x9E);
    WriteRegisterByte(RegisterType::C, 0x63);
    WriteRegisterByte(RegisterType::D, 0x8D);
    WriteRegisterByte(RegisterType::E, 0x89);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xBF);
    WriteRegisterByte(RegisterType::L, 0x41);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFA, 0x00);
    WriteMemory(0x8F94, 0xFA);
    WriteMemory(0x8F93, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC3);
    CheckRegisterByte(RegisterType::B, 0x9E);
    CheckRegisterByte(RegisterType::C, 0x63);
    CheckRegisterByte(RegisterType::D, 0x8D);
    CheckRegisterByte(RegisterType::E, 0x89);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xBF);
    CheckRegisterByte(RegisterType::L, 0x41);
    CheckRegisterWord(RegisterType::PC, 0x8F95);
    CheckRegisterWord(RegisterType::SP, 0xDEF6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8F93, 0xE0);
    CheckMemory(0x8F94, 0xFA);
    CheckMemory(0xFFFA, 0xC3);
}

void test_E0_01E0()
{
    if (skip_test_E0_01E0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB7A7);
    WriteRegisterWord(RegisterType::SP, 0xE684);
    WriteRegisterByte(RegisterType::A, 0x30);
    WriteRegisterByte(RegisterType::B, 0x6E);
    WriteRegisterByte(RegisterType::C, 0x2B);
    WriteRegisterByte(RegisterType::D, 0x0A);
    WriteRegisterByte(RegisterType::E, 0xBC);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0xBD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEE, 0x00);
    WriteMemory(0xB7A8, 0xEE);
    WriteMemory(0xB7A7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x30);
    CheckRegisterByte(RegisterType::B, 0x6E);
    CheckRegisterByte(RegisterType::C, 0x2B);
    CheckRegisterByte(RegisterType::D, 0x0A);
    CheckRegisterByte(RegisterType::E, 0xBC);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0xBD);
    CheckRegisterWord(RegisterType::PC, 0xB7A9);
    CheckRegisterWord(RegisterType::SP, 0xE684);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB7A7, 0xE0);
    CheckMemory(0xB7A8, 0xEE);
    CheckMemory(0xFFEE, 0x30);
}

void test_E0_01E1()
{
    if (skip_test_E0_01E1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8D25);
    WriteRegisterWord(RegisterType::SP, 0x3FCE);
    WriteRegisterByte(RegisterType::A, 0xE7);
    WriteRegisterByte(RegisterType::B, 0xF5);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0x3C);
    WriteRegisterByte(RegisterType::E, 0x0B);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x1D);
    WriteRegisterByte(RegisterType::L, 0x96);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF0E, 0x00);
    WriteMemory(0x8D26, 0x0E);
    WriteMemory(0x8D25, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE7);
    CheckRegisterByte(RegisterType::B, 0xF5);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0x3C);
    CheckRegisterByte(RegisterType::E, 0x0B);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x1D);
    CheckRegisterByte(RegisterType::L, 0x96);
    CheckRegisterWord(RegisterType::PC, 0x8D27);
    CheckRegisterWord(RegisterType::SP, 0x3FCE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8D25, 0xE0);
    CheckMemory(0x8D26, 0x0E);
    CheckMemory(0xFF0E, 0xE7);
}

void test_E0_01E2()
{
    if (skip_test_E0_01E2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2A9C);
    WriteRegisterWord(RegisterType::SP, 0x3301);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0x7E);
    WriteRegisterByte(RegisterType::C, 0xDC);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0xCF);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x00);
    WriteRegisterByte(RegisterType::L, 0x5A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFDC, 0x00);
    WriteMemory(0x2A9D, 0xDC);
    WriteMemory(0x2A9C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0x7E);
    CheckRegisterByte(RegisterType::C, 0xDC);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0xCF);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x00);
    CheckRegisterByte(RegisterType::L, 0x5A);
    CheckRegisterWord(RegisterType::PC, 0x2A9E);
    CheckRegisterWord(RegisterType::SP, 0x3301);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2A9C, 0xE0);
    CheckMemory(0x2A9D, 0xDC);
    CheckMemory(0xFFDC, 0x44);
}

void test_E0_01E3()
{
    if (skip_test_E0_01E3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDD5D);
    WriteRegisterWord(RegisterType::SP, 0x42B6);
    WriteRegisterByte(RegisterType::A, 0x1C);
    WriteRegisterByte(RegisterType::B, 0xDE);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0x32);
    WriteRegisterByte(RegisterType::E, 0x44);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x5A);
    WriteRegisterByte(RegisterType::L, 0x1C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0D, 0x00);
    WriteMemory(0xDD5E, 0x0D);
    WriteMemory(0xDD5D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1C);
    CheckRegisterByte(RegisterType::B, 0xDE);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0x32);
    CheckRegisterByte(RegisterType::E, 0x44);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x5A);
    CheckRegisterByte(RegisterType::L, 0x1C);
    CheckRegisterWord(RegisterType::PC, 0xDD5F);
    CheckRegisterWord(RegisterType::SP, 0x42B6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDD5D, 0xE0);
    CheckMemory(0xDD5E, 0x0D);
    CheckMemory(0xFF0D, 0x1C);
}

void test_E0_01E4()
{
    if (skip_test_E0_01E4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFED0);
    WriteRegisterWord(RegisterType::SP, 0xDB65);
    WriteRegisterByte(RegisterType::A, 0x68);
    WriteRegisterByte(RegisterType::B, 0xCE);
    WriteRegisterByte(RegisterType::C, 0xEC);
    WriteRegisterByte(RegisterType::D, 0x6E);
    WriteRegisterByte(RegisterType::E, 0x45);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x5A);
    WriteRegisterByte(RegisterType::L, 0x12);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF57, 0x00);
    WriteMemory(0xFED1, 0x57);
    WriteMemory(0xFED0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x68);
    CheckRegisterByte(RegisterType::B, 0xCE);
    CheckRegisterByte(RegisterType::C, 0xEC);
    CheckRegisterByte(RegisterType::D, 0x6E);
    CheckRegisterByte(RegisterType::E, 0x45);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x5A);
    CheckRegisterByte(RegisterType::L, 0x12);
    CheckRegisterWord(RegisterType::PC, 0xFED2);
    CheckRegisterWord(RegisterType::SP, 0xDB65);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFED0, 0xE0);
    CheckMemory(0xFED1, 0x57);
    CheckMemory(0xFF57, 0x68);
}

void test_E0_01E5()
{
    if (skip_test_E0_01E5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA8FA);
    WriteRegisterWord(RegisterType::SP, 0x3010);
    WriteRegisterByte(RegisterType::A, 0xEC);
    WriteRegisterByte(RegisterType::B, 0x4F);
    WriteRegisterByte(RegisterType::C, 0xED);
    WriteRegisterByte(RegisterType::D, 0x4E);
    WriteRegisterByte(RegisterType::E, 0xEB);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x35);
    WriteRegisterByte(RegisterType::L, 0x38);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF76, 0x00);
    WriteMemory(0xA8FB, 0x76);
    WriteMemory(0xA8FA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEC);
    CheckRegisterByte(RegisterType::B, 0x4F);
    CheckRegisterByte(RegisterType::C, 0xED);
    CheckRegisterByte(RegisterType::D, 0x4E);
    CheckRegisterByte(RegisterType::E, 0xEB);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x35);
    CheckRegisterByte(RegisterType::L, 0x38);
    CheckRegisterWord(RegisterType::PC, 0xA8FC);
    CheckRegisterWord(RegisterType::SP, 0x3010);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA8FA, 0xE0);
    CheckMemory(0xA8FB, 0x76);
    CheckMemory(0xFF76, 0xEC);
}

void test_E0_01E6()
{
    if (skip_test_E0_01E6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4016);
    WriteRegisterWord(RegisterType::SP, 0xA170);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0xB7);
    WriteRegisterByte(RegisterType::D, 0x66);
    WriteRegisterByte(RegisterType::E, 0x71);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x03);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF95, 0x00);
    WriteMemory(0x4017, 0x95);
    WriteMemory(0x4016, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0xB7);
    CheckRegisterByte(RegisterType::D, 0x66);
    CheckRegisterByte(RegisterType::E, 0x71);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x03);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0x4018);
    CheckRegisterWord(RegisterType::SP, 0xA170);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4016, 0xE0);
    CheckMemory(0x4017, 0x95);
    CheckMemory(0xFF95, 0x58);
}

void test_E0_01E7()
{
    if (skip_test_E0_01E7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEBBB);
    WriteRegisterWord(RegisterType::SP, 0x9054);
    WriteRegisterByte(RegisterType::A, 0x22);
    WriteRegisterByte(RegisterType::B, 0x3E);
    WriteRegisterByte(RegisterType::C, 0x96);
    WriteRegisterByte(RegisterType::D, 0x2D);
    WriteRegisterByte(RegisterType::E, 0x4F);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x34);
    WriteRegisterByte(RegisterType::L, 0x86);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF21, 0x00);
    WriteMemory(0xEBBC, 0x21);
    WriteMemory(0xEBBB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x22);
    CheckRegisterByte(RegisterType::B, 0x3E);
    CheckRegisterByte(RegisterType::C, 0x96);
    CheckRegisterByte(RegisterType::D, 0x2D);
    CheckRegisterByte(RegisterType::E, 0x4F);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x34);
    CheckRegisterByte(RegisterType::L, 0x86);
    CheckRegisterWord(RegisterType::PC, 0xEBBD);
    CheckRegisterWord(RegisterType::SP, 0x9054);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xEBBB, 0xE0);
    CheckMemory(0xEBBC, 0x21);
    CheckMemory(0xFF21, 0x22);
}

void test_E0_01E8()
{
    if (skip_test_E0_01E8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0C7F);
    WriteRegisterWord(RegisterType::SP, 0xB70B);
    WriteRegisterByte(RegisterType::A, 0x4A);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0x53);
    WriteRegisterByte(RegisterType::D, 0x35);
    WriteRegisterByte(RegisterType::E, 0xBE);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x58);
    WriteRegisterByte(RegisterType::L, 0x5A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8E, 0x00);
    WriteMemory(0x0C80, 0x8E);
    WriteMemory(0x0C7F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4A);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0x53);
    CheckRegisterByte(RegisterType::D, 0x35);
    CheckRegisterByte(RegisterType::E, 0xBE);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x58);
    CheckRegisterByte(RegisterType::L, 0x5A);
    CheckRegisterWord(RegisterType::PC, 0x0C81);
    CheckRegisterWord(RegisterType::SP, 0xB70B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0C7F, 0xE0);
    CheckMemory(0x0C80, 0x8E);
    CheckMemory(0xFF8E, 0x4A);
}

void test_E0_01E9()
{
    if (skip_test_E0_01E9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF40B);
    WriteRegisterWord(RegisterType::SP, 0x06AE);
    WriteRegisterByte(RegisterType::A, 0x8B);
    WriteRegisterByte(RegisterType::B, 0x03);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0x68);
    WriteRegisterByte(RegisterType::E, 0x6C);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xF9);
    WriteRegisterByte(RegisterType::L, 0x62);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD5, 0x00);
    WriteMemory(0xF40C, 0xD5);
    WriteMemory(0xF40B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8B);
    CheckRegisterByte(RegisterType::B, 0x03);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0x68);
    CheckRegisterByte(RegisterType::E, 0x6C);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xF9);
    CheckRegisterByte(RegisterType::L, 0x62);
    CheckRegisterWord(RegisterType::PC, 0xF40D);
    CheckRegisterWord(RegisterType::SP, 0x06AE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF40B, 0xE0);
    CheckMemory(0xF40C, 0xD5);
    CheckMemory(0xFFD5, 0x8B);
}

void test_E0_01EA()
{
    if (skip_test_E0_01EA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6782);
    WriteRegisterWord(RegisterType::SP, 0xE1FB);
    WriteRegisterByte(RegisterType::A, 0x57);
    WriteRegisterByte(RegisterType::B, 0x79);
    WriteRegisterByte(RegisterType::C, 0x26);
    WriteRegisterByte(RegisterType::D, 0x9B);
    WriteRegisterByte(RegisterType::E, 0x69);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x56);
    WriteRegisterByte(RegisterType::L, 0xE6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5D, 0x00);
    WriteMemory(0x6783, 0x5D);
    WriteMemory(0x6782, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x57);
    CheckRegisterByte(RegisterType::B, 0x79);
    CheckRegisterByte(RegisterType::C, 0x26);
    CheckRegisterByte(RegisterType::D, 0x9B);
    CheckRegisterByte(RegisterType::E, 0x69);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x56);
    CheckRegisterByte(RegisterType::L, 0xE6);
    CheckRegisterWord(RegisterType::PC, 0x6784);
    CheckRegisterWord(RegisterType::SP, 0xE1FB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6782, 0xE0);
    CheckMemory(0x6783, 0x5D);
    CheckMemory(0xFF5D, 0x57);
}

void test_E0_01EB()
{
    if (skip_test_E0_01EB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x33D5);
    WriteRegisterWord(RegisterType::SP, 0x61A0);
    WriteRegisterByte(RegisterType::A, 0x9E);
    WriteRegisterByte(RegisterType::B, 0xFE);
    WriteRegisterByte(RegisterType::C, 0x1D);
    WriteRegisterByte(RegisterType::D, 0x8F);
    WriteRegisterByte(RegisterType::E, 0xD1);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x15);
    WriteRegisterByte(RegisterType::L, 0xE2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC9, 0x00);
    WriteMemory(0x33D6, 0xC9);
    WriteMemory(0x33D5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9E);
    CheckRegisterByte(RegisterType::B, 0xFE);
    CheckRegisterByte(RegisterType::C, 0x1D);
    CheckRegisterByte(RegisterType::D, 0x8F);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x15);
    CheckRegisterByte(RegisterType::L, 0xE2);
    CheckRegisterWord(RegisterType::PC, 0x33D7);
    CheckRegisterWord(RegisterType::SP, 0x61A0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x33D5, 0xE0);
    CheckMemory(0x33D6, 0xC9);
    CheckMemory(0xFFC9, 0x9E);
}

void test_E0_01EC()
{
    if (skip_test_E0_01EC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5167);
    WriteRegisterWord(RegisterType::SP, 0x121D);
    WriteRegisterByte(RegisterType::A, 0x64);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0xA2);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0xB7);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF8, 0x00);
    WriteMemory(0x5168, 0xF8);
    WriteMemory(0x5167, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x64);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0xA2);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0xB7);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0x5169);
    CheckRegisterWord(RegisterType::SP, 0x121D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5167, 0xE0);
    CheckMemory(0x5168, 0xF8);
    CheckMemory(0xFFF8, 0x64);
}

void test_E0_01ED()
{
    if (skip_test_E0_01ED)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE374);
    WriteRegisterWord(RegisterType::SP, 0x7085);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0x17);
    WriteRegisterByte(RegisterType::C, 0xB6);
    WriteRegisterByte(RegisterType::D, 0xDA);
    WriteRegisterByte(RegisterType::E, 0x2A);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0x2C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE6, 0x00);
    WriteMemory(0xE375, 0xE6);
    WriteMemory(0xE374, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0x17);
    CheckRegisterByte(RegisterType::C, 0xB6);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0x2A);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0x2C);
    CheckRegisterWord(RegisterType::PC, 0xE376);
    CheckRegisterWord(RegisterType::SP, 0x7085);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE374, 0xE0);
    CheckMemory(0xE375, 0xE6);
    CheckMemory(0xFFE6, 0xD9);
}

void test_E0_01EE()
{
    if (skip_test_E0_01EE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2433);
    WriteRegisterWord(RegisterType::SP, 0x3373);
    WriteRegisterByte(RegisterType::A, 0x86);
    WriteRegisterByte(RegisterType::B, 0x2C);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0x37);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x00);
    WriteRegisterByte(RegisterType::L, 0xF8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB7, 0x00);
    WriteMemory(0x2434, 0xB7);
    WriteMemory(0x2433, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x86);
    CheckRegisterByte(RegisterType::B, 0x2C);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0x37);
    CheckRegisterByte(RegisterType::E, 0xF5);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x00);
    CheckRegisterByte(RegisterType::L, 0xF8);
    CheckRegisterWord(RegisterType::PC, 0x2435);
    CheckRegisterWord(RegisterType::SP, 0x3373);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2433, 0xE0);
    CheckMemory(0x2434, 0xB7);
    CheckMemory(0xFFB7, 0x86);
}

void test_E0_01EF()
{
    if (skip_test_E0_01EF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7C32);
    WriteRegisterWord(RegisterType::SP, 0x938C);
    WriteRegisterByte(RegisterType::A, 0x4E);
    WriteRegisterByte(RegisterType::B, 0x8F);
    WriteRegisterByte(RegisterType::C, 0xF9);
    WriteRegisterByte(RegisterType::D, 0xFC);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xFE);
    WriteRegisterByte(RegisterType::L, 0xF0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF79, 0x00);
    WriteMemory(0x7C33, 0x79);
    WriteMemory(0x7C32, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4E);
    CheckRegisterByte(RegisterType::B, 0x8F);
    CheckRegisterByte(RegisterType::C, 0xF9);
    CheckRegisterByte(RegisterType::D, 0xFC);
    CheckRegisterByte(RegisterType::E, 0x59);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xFE);
    CheckRegisterByte(RegisterType::L, 0xF0);
    CheckRegisterWord(RegisterType::PC, 0x7C34);
    CheckRegisterWord(RegisterType::SP, 0x938C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7C32, 0xE0);
    CheckMemory(0x7C33, 0x79);
    CheckMemory(0xFF79, 0x4E);
}

void test_E0_01F0()
{
    if (skip_test_E0_01F0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC4DD);
    WriteRegisterWord(RegisterType::SP, 0xC788);
    WriteRegisterByte(RegisterType::A, 0xF1);
    WriteRegisterByte(RegisterType::B, 0x0D);
    WriteRegisterByte(RegisterType::C, 0x85);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0x50);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x1D);
    WriteRegisterByte(RegisterType::L, 0xE1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCA, 0x00);
    WriteMemory(0xC4DE, 0xCA);
    WriteMemory(0xC4DD, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF1);
    CheckRegisterByte(RegisterType::B, 0x0D);
    CheckRegisterByte(RegisterType::C, 0x85);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0x50);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x1D);
    CheckRegisterByte(RegisterType::L, 0xE1);
    CheckRegisterWord(RegisterType::PC, 0xC4DF);
    CheckRegisterWord(RegisterType::SP, 0xC788);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC4DD, 0xE0);
    CheckMemory(0xC4DE, 0xCA);
    CheckMemory(0xFFCA, 0xF1);
}

void test_E0_01F1()
{
    if (skip_test_E0_01F1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE15E);
    WriteRegisterWord(RegisterType::SP, 0x8E7F);
    WriteRegisterByte(RegisterType::A, 0x79);
    WriteRegisterByte(RegisterType::B, 0xC1);
    WriteRegisterByte(RegisterType::C, 0xDD);
    WriteRegisterByte(RegisterType::D, 0xD6);
    WriteRegisterByte(RegisterType::E, 0x67);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xFC);
    WriteRegisterByte(RegisterType::L, 0x4C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF66, 0x00);
    WriteMemory(0xE15F, 0x66);
    WriteMemory(0xE15E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x79);
    CheckRegisterByte(RegisterType::B, 0xC1);
    CheckRegisterByte(RegisterType::C, 0xDD);
    CheckRegisterByte(RegisterType::D, 0xD6);
    CheckRegisterByte(RegisterType::E, 0x67);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xFC);
    CheckRegisterByte(RegisterType::L, 0x4C);
    CheckRegisterWord(RegisterType::PC, 0xE160);
    CheckRegisterWord(RegisterType::SP, 0x8E7F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE15E, 0xE0);
    CheckMemory(0xE15F, 0x66);
    CheckMemory(0xFF66, 0x79);
}

void test_E0_01F2()
{
    if (skip_test_E0_01F2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1905);
    WriteRegisterWord(RegisterType::SP, 0x3CC2);
    WriteRegisterByte(RegisterType::A, 0xFA);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0x45);
    WriteRegisterByte(RegisterType::E, 0x61);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x0E);
    WriteRegisterByte(RegisterType::L, 0x04);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDA, 0x00);
    WriteMemory(0x1906, 0xDA);
    WriteMemory(0x1905, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFA);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0x45);
    CheckRegisterByte(RegisterType::E, 0x61);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x0E);
    CheckRegisterByte(RegisterType::L, 0x04);
    CheckRegisterWord(RegisterType::PC, 0x1907);
    CheckRegisterWord(RegisterType::SP, 0x3CC2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1905, 0xE0);
    CheckMemory(0x1906, 0xDA);
    CheckMemory(0xFFDA, 0xFA);
}

void test_E0_01F3()
{
    if (skip_test_E0_01F3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x382D);
    WriteRegisterWord(RegisterType::SP, 0x9020);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0x14);
    WriteRegisterByte(RegisterType::C, 0xF2);
    WriteRegisterByte(RegisterType::D, 0x3A);
    WriteRegisterByte(RegisterType::E, 0xA1);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0xBD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF93, 0x00);
    WriteMemory(0x382E, 0x93);
    WriteMemory(0x382D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0x14);
    CheckRegisterByte(RegisterType::C, 0xF2);
    CheckRegisterByte(RegisterType::D, 0x3A);
    CheckRegisterByte(RegisterType::E, 0xA1);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0xBD);
    CheckRegisterWord(RegisterType::PC, 0x382F);
    CheckRegisterWord(RegisterType::SP, 0x9020);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x382D, 0xE0);
    CheckMemory(0x382E, 0x93);
    CheckMemory(0xFF93, 0x78);
}

void test_E0_01F4()
{
    if (skip_test_E0_01F4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6EC9);
    WriteRegisterWord(RegisterType::SP, 0x988B);
    WriteRegisterByte(RegisterType::A, 0xBA);
    WriteRegisterByte(RegisterType::B, 0xDF);
    WriteRegisterByte(RegisterType::C, 0xDD);
    WriteRegisterByte(RegisterType::D, 0xD9);
    WriteRegisterByte(RegisterType::E, 0x66);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x1F);
    WriteRegisterByte(RegisterType::L, 0x86);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD8, 0x00);
    WriteMemory(0x6ECA, 0xD8);
    WriteMemory(0x6EC9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBA);
    CheckRegisterByte(RegisterType::B, 0xDF);
    CheckRegisterByte(RegisterType::C, 0xDD);
    CheckRegisterByte(RegisterType::D, 0xD9);
    CheckRegisterByte(RegisterType::E, 0x66);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x1F);
    CheckRegisterByte(RegisterType::L, 0x86);
    CheckRegisterWord(RegisterType::PC, 0x6ECB);
    CheckRegisterWord(RegisterType::SP, 0x988B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6EC9, 0xE0);
    CheckMemory(0x6ECA, 0xD8);
    CheckMemory(0xFFD8, 0xBA);
}

void test_E0_01F5()
{
    if (skip_test_E0_01F5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0C79);
    WriteRegisterWord(RegisterType::SP, 0xD71A);
    WriteRegisterByte(RegisterType::A, 0x57);
    WriteRegisterByte(RegisterType::B, 0x05);
    WriteRegisterByte(RegisterType::C, 0x50);
    WriteRegisterByte(RegisterType::D, 0x8A);
    WriteRegisterByte(RegisterType::E, 0x78);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0xAC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF44, 0x00);
    WriteMemory(0x0C7A, 0x44);
    WriteMemory(0x0C79, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x57);
    CheckRegisterByte(RegisterType::B, 0x05);
    CheckRegisterByte(RegisterType::C, 0x50);
    CheckRegisterByte(RegisterType::D, 0x8A);
    CheckRegisterByte(RegisterType::E, 0x78);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0xAC);
    CheckRegisterWord(RegisterType::PC, 0x0C7B);
    CheckRegisterWord(RegisterType::SP, 0xD71A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0C79, 0xE0);
    CheckMemory(0x0C7A, 0x44);
    CheckMemory(0xFF44, 0x57);
}

void test_E0_01F6()
{
    if (skip_test_E0_01F6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1707);
    WriteRegisterWord(RegisterType::SP, 0x92D2);
    WriteRegisterByte(RegisterType::A, 0x50);
    WriteRegisterByte(RegisterType::B, 0x73);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0x81);
    WriteRegisterByte(RegisterType::E, 0x57);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x18);
    WriteRegisterByte(RegisterType::L, 0xD9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB8, 0x00);
    WriteMemory(0x1708, 0xB8);
    WriteMemory(0x1707, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x50);
    CheckRegisterByte(RegisterType::B, 0x73);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0x57);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x18);
    CheckRegisterByte(RegisterType::L, 0xD9);
    CheckRegisterWord(RegisterType::PC, 0x1709);
    CheckRegisterWord(RegisterType::SP, 0x92D2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1707, 0xE0);
    CheckMemory(0x1708, 0xB8);
    CheckMemory(0xFFB8, 0x50);
}

void test_E0_01F7()
{
    if (skip_test_E0_01F7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x44C6);
    WriteRegisterWord(RegisterType::SP, 0xD7E8);
    WriteRegisterByte(RegisterType::A, 0x3D);
    WriteRegisterByte(RegisterType::B, 0xE6);
    WriteRegisterByte(RegisterType::C, 0xB7);
    WriteRegisterByte(RegisterType::D, 0x1B);
    WriteRegisterByte(RegisterType::E, 0xA6);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF06, 0x00);
    WriteMemory(0x44C7, 0x06);
    WriteMemory(0x44C6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3D);
    CheckRegisterByte(RegisterType::B, 0xE6);
    CheckRegisterByte(RegisterType::C, 0xB7);
    CheckRegisterByte(RegisterType::D, 0x1B);
    CheckRegisterByte(RegisterType::E, 0xA6);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0x44C8);
    CheckRegisterWord(RegisterType::SP, 0xD7E8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x44C6, 0xE0);
    CheckMemory(0x44C7, 0x06);
    CheckMemory(0xFF06, 0x3D);
}

void test_E0_01F8()
{
    if (skip_test_E0_01F8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3A53);
    WriteRegisterWord(RegisterType::SP, 0xF532);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0xDC);
    WriteRegisterByte(RegisterType::C, 0xD7);
    WriteRegisterByte(RegisterType::D, 0x47);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x55);
    WriteRegisterByte(RegisterType::L, 0x27);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE1, 0x00);
    WriteMemory(0x3A54, 0xE1);
    WriteMemory(0x3A53, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0xDC);
    CheckRegisterByte(RegisterType::C, 0xD7);
    CheckRegisterByte(RegisterType::D, 0x47);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x55);
    CheckRegisterByte(RegisterType::L, 0x27);
    CheckRegisterWord(RegisterType::PC, 0x3A55);
    CheckRegisterWord(RegisterType::SP, 0xF532);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3A53, 0xE0);
    CheckMemory(0x3A54, 0xE1);
    CheckMemory(0xFFE1, 0x32);
}

void test_E0_01F9()
{
    if (skip_test_E0_01F9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x19D5);
    WriteRegisterWord(RegisterType::SP, 0x49D8);
    WriteRegisterByte(RegisterType::A, 0xF1);
    WriteRegisterByte(RegisterType::B, 0x07);
    WriteRegisterByte(RegisterType::C, 0xCA);
    WriteRegisterByte(RegisterType::D, 0x4B);
    WriteRegisterByte(RegisterType::E, 0x9F);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xD3);
    WriteRegisterByte(RegisterType::L, 0x96);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF48, 0x00);
    WriteMemory(0x19D6, 0x48);
    WriteMemory(0x19D5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF1);
    CheckRegisterByte(RegisterType::B, 0x07);
    CheckRegisterByte(RegisterType::C, 0xCA);
    CheckRegisterByte(RegisterType::D, 0x4B);
    CheckRegisterByte(RegisterType::E, 0x9F);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xD3);
    CheckRegisterByte(RegisterType::L, 0x96);
    CheckRegisterWord(RegisterType::PC, 0x19D7);
    CheckRegisterWord(RegisterType::SP, 0x49D8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x19D5, 0xE0);
    CheckMemory(0x19D6, 0x48);
    CheckMemory(0xFF48, 0xF1);
}

void test_E0_01FA()
{
    if (skip_test_E0_01FA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6984);
    WriteRegisterWord(RegisterType::SP, 0x92EB);
    WriteRegisterByte(RegisterType::A, 0x9C);
    WriteRegisterByte(RegisterType::B, 0x1E);
    WriteRegisterByte(RegisterType::C, 0x40);
    WriteRegisterByte(RegisterType::D, 0xD5);
    WriteRegisterByte(RegisterType::E, 0xBC);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x10);
    WriteRegisterByte(RegisterType::L, 0x07);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF54, 0x00);
    WriteMemory(0x6985, 0x54);
    WriteMemory(0x6984, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9C);
    CheckRegisterByte(RegisterType::B, 0x1E);
    CheckRegisterByte(RegisterType::C, 0x40);
    CheckRegisterByte(RegisterType::D, 0xD5);
    CheckRegisterByte(RegisterType::E, 0xBC);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x10);
    CheckRegisterByte(RegisterType::L, 0x07);
    CheckRegisterWord(RegisterType::PC, 0x6986);
    CheckRegisterWord(RegisterType::SP, 0x92EB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6984, 0xE0);
    CheckMemory(0x6985, 0x54);
    CheckMemory(0xFF54, 0x9C);
}

void test_E0_01FB()
{
    if (skip_test_E0_01FB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3B28);
    WriteRegisterWord(RegisterType::SP, 0x711A);
    WriteRegisterByte(RegisterType::A, 0xD3);
    WriteRegisterByte(RegisterType::B, 0xB7);
    WriteRegisterByte(RegisterType::C, 0xDA);
    WriteRegisterByte(RegisterType::D, 0xDA);
    WriteRegisterByte(RegisterType::E, 0x5B);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x43);
    WriteRegisterByte(RegisterType::L, 0x49);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF91, 0x00);
    WriteMemory(0x3B29, 0x91);
    WriteMemory(0x3B28, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD3);
    CheckRegisterByte(RegisterType::B, 0xB7);
    CheckRegisterByte(RegisterType::C, 0xDA);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0x5B);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x43);
    CheckRegisterByte(RegisterType::L, 0x49);
    CheckRegisterWord(RegisterType::PC, 0x3B2A);
    CheckRegisterWord(RegisterType::SP, 0x711A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3B28, 0xE0);
    CheckMemory(0x3B29, 0x91);
    CheckMemory(0xFF91, 0xD3);
}

void test_E0_01FC()
{
    if (skip_test_E0_01FC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3B03);
    WriteRegisterWord(RegisterType::SP, 0x52DC);
    WriteRegisterByte(RegisterType::A, 0x14);
    WriteRegisterByte(RegisterType::B, 0xDB);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0x9C);
    WriteRegisterByte(RegisterType::E, 0xD8);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x81);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF01, 0x00);
    WriteMemory(0x3B04, 0x01);
    WriteMemory(0x3B03, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x14);
    CheckRegisterByte(RegisterType::B, 0xDB);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0x9C);
    CheckRegisterByte(RegisterType::E, 0xD8);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x81);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0x3B05);
    CheckRegisterWord(RegisterType::SP, 0x52DC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3B03, 0xE0);
    CheckMemory(0x3B04, 0x01);
    CheckMemory(0xFF01, 0x14);
}

void test_E0_01FD()
{
    if (skip_test_E0_01FD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9A14);
    WriteRegisterWord(RegisterType::SP, 0xA7C1);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0x49);
    WriteRegisterByte(RegisterType::C, 0x30);
    WriteRegisterByte(RegisterType::D, 0x4A);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xAA);
    WriteRegisterByte(RegisterType::L, 0xA4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD0, 0x00);
    WriteMemory(0x9A15, 0xD0);
    WriteMemory(0x9A14, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0x49);
    CheckRegisterByte(RegisterType::C, 0x30);
    CheckRegisterByte(RegisterType::D, 0x4A);
    CheckRegisterByte(RegisterType::E, 0x5E);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xAA);
    CheckRegisterByte(RegisterType::L, 0xA4);
    CheckRegisterWord(RegisterType::PC, 0x9A16);
    CheckRegisterWord(RegisterType::SP, 0xA7C1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9A14, 0xE0);
    CheckMemory(0x9A15, 0xD0);
    CheckMemory(0xFFD0, 0xD9);
}

void test_E0_01FE()
{
    if (skip_test_E0_01FE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5397);
    WriteRegisterWord(RegisterType::SP, 0x466E);
    WriteRegisterByte(RegisterType::A, 0xC4);
    WriteRegisterByte(RegisterType::B, 0x4E);
    WriteRegisterByte(RegisterType::C, 0x48);
    WriteRegisterByte(RegisterType::D, 0xAA);
    WriteRegisterByte(RegisterType::E, 0x9F);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xA8);
    WriteRegisterByte(RegisterType::L, 0x3F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCE, 0x00);
    WriteMemory(0x5398, 0xCE);
    WriteMemory(0x5397, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC4);
    CheckRegisterByte(RegisterType::B, 0x4E);
    CheckRegisterByte(RegisterType::C, 0x48);
    CheckRegisterByte(RegisterType::D, 0xAA);
    CheckRegisterByte(RegisterType::E, 0x9F);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xA8);
    CheckRegisterByte(RegisterType::L, 0x3F);
    CheckRegisterWord(RegisterType::PC, 0x5399);
    CheckRegisterWord(RegisterType::SP, 0x466E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5397, 0xE0);
    CheckMemory(0x5398, 0xCE);
    CheckMemory(0xFFCE, 0xC4);
}

void test_E0_01FF()
{
    if (skip_test_E0_01FF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBDF8);
    WriteRegisterWord(RegisterType::SP, 0x8C47);
    WriteRegisterByte(RegisterType::A, 0x4A);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0x75);
    WriteRegisterByte(RegisterType::E, 0x72);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x3F);
    WriteRegisterByte(RegisterType::L, 0xC3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0B, 0x00);
    WriteMemory(0xBDF9, 0x0B);
    WriteMemory(0xBDF8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4A);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0x75);
    CheckRegisterByte(RegisterType::E, 0x72);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x3F);
    CheckRegisterByte(RegisterType::L, 0xC3);
    CheckRegisterWord(RegisterType::PC, 0xBDFA);
    CheckRegisterWord(RegisterType::SP, 0x8C47);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBDF8, 0xE0);
    CheckMemory(0xBDF9, 0x0B);
    CheckMemory(0xFF0B, 0x4A);
}

void test_E0_0200()
{
    if (skip_test_E0_0200)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9DF1);
    WriteRegisterWord(RegisterType::SP, 0x78B0);
    WriteRegisterByte(RegisterType::A, 0x4C);
    WriteRegisterByte(RegisterType::B, 0x5C);
    WriteRegisterByte(RegisterType::C, 0x72);
    WriteRegisterByte(RegisterType::D, 0x85);
    WriteRegisterByte(RegisterType::E, 0xE1);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x98);
    WriteRegisterByte(RegisterType::L, 0xCC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF8A, 0x00);
    WriteMemory(0x9DF2, 0x8A);
    WriteMemory(0x9DF1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4C);
    CheckRegisterByte(RegisterType::B, 0x5C);
    CheckRegisterByte(RegisterType::C, 0x72);
    CheckRegisterByte(RegisterType::D, 0x85);
    CheckRegisterByte(RegisterType::E, 0xE1);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x98);
    CheckRegisterByte(RegisterType::L, 0xCC);
    CheckRegisterWord(RegisterType::PC, 0x9DF3);
    CheckRegisterWord(RegisterType::SP, 0x78B0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9DF1, 0xE0);
    CheckMemory(0x9DF2, 0x8A);
    CheckMemory(0xFF8A, 0x4C);
}

void test_E0_0201()
{
    if (skip_test_E0_0201)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF0A7);
    WriteRegisterWord(RegisterType::SP, 0x106C);
    WriteRegisterByte(RegisterType::A, 0x21);
    WriteRegisterByte(RegisterType::B, 0xC2);
    WriteRegisterByte(RegisterType::C, 0xB1);
    WriteRegisterByte(RegisterType::D, 0xFC);
    WriteRegisterByte(RegisterType::E, 0xB4);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0xA6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB7, 0x00);
    WriteMemory(0xF0A8, 0xB7);
    WriteMemory(0xF0A7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x21);
    CheckRegisterByte(RegisterType::B, 0xC2);
    CheckRegisterByte(RegisterType::C, 0xB1);
    CheckRegisterByte(RegisterType::D, 0xFC);
    CheckRegisterByte(RegisterType::E, 0xB4);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0xA6);
    CheckRegisterWord(RegisterType::PC, 0xF0A9);
    CheckRegisterWord(RegisterType::SP, 0x106C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF0A7, 0xE0);
    CheckMemory(0xF0A8, 0xB7);
    CheckMemory(0xFFB7, 0x21);
}

void test_E0_0202()
{
    if (skip_test_E0_0202)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8E57);
    WriteRegisterWord(RegisterType::SP, 0xAF47);
    WriteRegisterByte(RegisterType::A, 0xC6);
    WriteRegisterByte(RegisterType::B, 0x1E);
    WriteRegisterByte(RegisterType::C, 0xA8);
    WriteRegisterByte(RegisterType::D, 0x0A);
    WriteRegisterByte(RegisterType::E, 0x7E);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xBE);
    WriteRegisterByte(RegisterType::L, 0x43);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF10, 0x00);
    WriteMemory(0x8E58, 0x10);
    WriteMemory(0x8E57, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC6);
    CheckRegisterByte(RegisterType::B, 0x1E);
    CheckRegisterByte(RegisterType::C, 0xA8);
    CheckRegisterByte(RegisterType::D, 0x0A);
    CheckRegisterByte(RegisterType::E, 0x7E);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xBE);
    CheckRegisterByte(RegisterType::L, 0x43);
    CheckRegisterWord(RegisterType::PC, 0x8E59);
    CheckRegisterWord(RegisterType::SP, 0xAF47);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8E57, 0xE0);
    CheckMemory(0x8E58, 0x10);
    CheckMemory(0xFF10, 0xC6);
}

void test_E0_0203()
{
    if (skip_test_E0_0203)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE374);
    WriteRegisterWord(RegisterType::SP, 0x05B0);
    WriteRegisterByte(RegisterType::A, 0xFD);
    WriteRegisterByte(RegisterType::B, 0x60);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0xFE);
    WriteRegisterByte(RegisterType::E, 0x28);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xB5);
    WriteRegisterByte(RegisterType::L, 0x74);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE6, 0x00);
    WriteMemory(0xE375, 0xE6);
    WriteMemory(0xE374, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFD);
    CheckRegisterByte(RegisterType::B, 0x60);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0xFE);
    CheckRegisterByte(RegisterType::E, 0x28);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xB5);
    CheckRegisterByte(RegisterType::L, 0x74);
    CheckRegisterWord(RegisterType::PC, 0xE376);
    CheckRegisterWord(RegisterType::SP, 0x05B0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE374, 0xE0);
    CheckMemory(0xE375, 0xE6);
    CheckMemory(0xFFE6, 0xFD);
}

void test_E0_0204()
{
    if (skip_test_E0_0204)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC179);
    WriteRegisterWord(RegisterType::SP, 0x5CFD);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0xF0);
    WriteRegisterByte(RegisterType::C, 0x99);
    WriteRegisterByte(RegisterType::D, 0x0E);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xF9);
    WriteRegisterByte(RegisterType::L, 0x51);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9F, 0x00);
    WriteMemory(0xC17A, 0x9F);
    WriteMemory(0xC179, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0xF0);
    CheckRegisterByte(RegisterType::C, 0x99);
    CheckRegisterByte(RegisterType::D, 0x0E);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xF9);
    CheckRegisterByte(RegisterType::L, 0x51);
    CheckRegisterWord(RegisterType::PC, 0xC17B);
    CheckRegisterWord(RegisterType::SP, 0x5CFD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC179, 0xE0);
    CheckMemory(0xC17A, 0x9F);
    CheckMemory(0xFF9F, 0x9B);
}

void test_E0_0205()
{
    if (skip_test_E0_0205)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD800);
    WriteRegisterWord(RegisterType::SP, 0x55E3);
    WriteRegisterByte(RegisterType::A, 0x01);
    WriteRegisterByte(RegisterType::B, 0x8A);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0xCC);
    WriteRegisterByte(RegisterType::E, 0x6F);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x49);
    WriteRegisterByte(RegisterType::L, 0x23);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF29, 0x00);
    WriteMemory(0xD801, 0x29);
    WriteMemory(0xD800, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x01);
    CheckRegisterByte(RegisterType::B, 0x8A);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0xCC);
    CheckRegisterByte(RegisterType::E, 0x6F);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x49);
    CheckRegisterByte(RegisterType::L, 0x23);
    CheckRegisterWord(RegisterType::PC, 0xD802);
    CheckRegisterWord(RegisterType::SP, 0x55E3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD800, 0xE0);
    CheckMemory(0xD801, 0x29);
    CheckMemory(0xFF29, 0x01);
}

void test_E0_0206()
{
    if (skip_test_E0_0206)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x694E);
    WriteRegisterWord(RegisterType::SP, 0x3B80);
    WriteRegisterByte(RegisterType::A, 0xD3);
    WriteRegisterByte(RegisterType::B, 0x99);
    WriteRegisterByte(RegisterType::C, 0xDD);
    WriteRegisterByte(RegisterType::D, 0xF2);
    WriteRegisterByte(RegisterType::E, 0xE6);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xA6);
    WriteRegisterByte(RegisterType::L, 0x4A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF96, 0x00);
    WriteMemory(0x694F, 0x96);
    WriteMemory(0x694E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD3);
    CheckRegisterByte(RegisterType::B, 0x99);
    CheckRegisterByte(RegisterType::C, 0xDD);
    CheckRegisterByte(RegisterType::D, 0xF2);
    CheckRegisterByte(RegisterType::E, 0xE6);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xA6);
    CheckRegisterByte(RegisterType::L, 0x4A);
    CheckRegisterWord(RegisterType::PC, 0x6950);
    CheckRegisterWord(RegisterType::SP, 0x3B80);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x694E, 0xE0);
    CheckMemory(0x694F, 0x96);
    CheckMemory(0xFF96, 0xD3);
}

void test_E0_0207()
{
    if (skip_test_E0_0207)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xED3E);
    WriteRegisterWord(RegisterType::SP, 0x686D);
    WriteRegisterByte(RegisterType::A, 0x36);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0xFB);
    WriteRegisterByte(RegisterType::D, 0x81);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xD0);
    WriteRegisterByte(RegisterType::L, 0x98);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAE, 0x00);
    WriteMemory(0xED3F, 0xAE);
    WriteMemory(0xED3E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x36);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0xFB);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xD0);
    CheckRegisterByte(RegisterType::L, 0x98);
    CheckRegisterWord(RegisterType::PC, 0xED40);
    CheckRegisterWord(RegisterType::SP, 0x686D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xED3E, 0xE0);
    CheckMemory(0xED3F, 0xAE);
    CheckMemory(0xFFAE, 0x36);
}

void test_E0_0208()
{
    if (skip_test_E0_0208)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7BC8);
    WriteRegisterWord(RegisterType::SP, 0xE49A);
    WriteRegisterByte(RegisterType::A, 0xCB);
    WriteRegisterByte(RegisterType::B, 0x38);
    WriteRegisterByte(RegisterType::C, 0x8B);
    WriteRegisterByte(RegisterType::D, 0xE2);
    WriteRegisterByte(RegisterType::E, 0x25);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x0F);
    WriteRegisterByte(RegisterType::L, 0x69);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF21, 0x00);
    WriteMemory(0x7BC9, 0x21);
    WriteMemory(0x7BC8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCB);
    CheckRegisterByte(RegisterType::B, 0x38);
    CheckRegisterByte(RegisterType::C, 0x8B);
    CheckRegisterByte(RegisterType::D, 0xE2);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x0F);
    CheckRegisterByte(RegisterType::L, 0x69);
    CheckRegisterWord(RegisterType::PC, 0x7BCA);
    CheckRegisterWord(RegisterType::SP, 0xE49A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7BC8, 0xE0);
    CheckMemory(0x7BC9, 0x21);
    CheckMemory(0xFF21, 0xCB);
}

void test_E0_0209()
{
    if (skip_test_E0_0209)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7C15);
    WriteRegisterWord(RegisterType::SP, 0xE65E);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0x90);
    WriteRegisterByte(RegisterType::C, 0xEC);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0x22);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x2E);
    WriteRegisterByte(RegisterType::L, 0x4E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAB, 0x00);
    WriteMemory(0x7C16, 0xAB);
    WriteMemory(0x7C15, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0x90);
    CheckRegisterByte(RegisterType::C, 0xEC);
    CheckRegisterByte(RegisterType::D, 0x40);
    CheckRegisterByte(RegisterType::E, 0x22);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x2E);
    CheckRegisterByte(RegisterType::L, 0x4E);
    CheckRegisterWord(RegisterType::PC, 0x7C17);
    CheckRegisterWord(RegisterType::SP, 0xE65E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7C15, 0xE0);
    CheckMemory(0x7C16, 0xAB);
    CheckMemory(0xFFAB, 0x72);
}

void test_E0_020A()
{
    if (skip_test_E0_020A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA69C);
    WriteRegisterWord(RegisterType::SP, 0x5E5A);
    WriteRegisterByte(RegisterType::A, 0x86);
    WriteRegisterByte(RegisterType::B, 0xE6);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0xC4);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0x5A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF51, 0x00);
    WriteMemory(0xA69D, 0x51);
    WriteMemory(0xA69C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x86);
    CheckRegisterByte(RegisterType::B, 0xE6);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0xC4);
    CheckRegisterByte(RegisterType::E, 0xF5);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0x5A);
    CheckRegisterWord(RegisterType::PC, 0xA69E);
    CheckRegisterWord(RegisterType::SP, 0x5E5A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA69C, 0xE0);
    CheckMemory(0xA69D, 0x51);
    CheckMemory(0xFF51, 0x86);
}

void test_E0_020B()
{
    if (skip_test_E0_020B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0EF4);
    WriteRegisterWord(RegisterType::SP, 0xA263);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0x12);
    WriteRegisterByte(RegisterType::C, 0x28);
    WriteRegisterByte(RegisterType::D, 0x39);
    WriteRegisterByte(RegisterType::E, 0xC0);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xC2);
    WriteRegisterByte(RegisterType::L, 0x52);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEB, 0x00);
    WriteMemory(0x0EF5, 0xEB);
    WriteMemory(0x0EF4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0x12);
    CheckRegisterByte(RegisterType::C, 0x28);
    CheckRegisterByte(RegisterType::D, 0x39);
    CheckRegisterByte(RegisterType::E, 0xC0);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xC2);
    CheckRegisterByte(RegisterType::L, 0x52);
    CheckRegisterWord(RegisterType::PC, 0x0EF6);
    CheckRegisterWord(RegisterType::SP, 0xA263);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0EF4, 0xE0);
    CheckMemory(0x0EF5, 0xEB);
    CheckMemory(0xFFEB, 0x92);
}

void test_E0_020C()
{
    if (skip_test_E0_020C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x72BE);
    WriteRegisterWord(RegisterType::SP, 0x7098);
    WriteRegisterByte(RegisterType::A, 0x99);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0x41);
    WriteRegisterByte(RegisterType::E, 0x38);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x89);
    WriteRegisterByte(RegisterType::L, 0x8B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAC, 0x00);
    WriteMemory(0x72BF, 0xAC);
    WriteMemory(0x72BE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x99);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0x41);
    CheckRegisterByte(RegisterType::E, 0x38);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x89);
    CheckRegisterByte(RegisterType::L, 0x8B);
    CheckRegisterWord(RegisterType::PC, 0x72C0);
    CheckRegisterWord(RegisterType::SP, 0x7098);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x72BE, 0xE0);
    CheckMemory(0x72BF, 0xAC);
    CheckMemory(0xFFAC, 0x99);
}

void test_E0_020D()
{
    if (skip_test_E0_020D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBEEC);
    WriteRegisterWord(RegisterType::SP, 0x7A15);
    WriteRegisterByte(RegisterType::A, 0x49);
    WriteRegisterByte(RegisterType::B, 0x51);
    WriteRegisterByte(RegisterType::C, 0x5F);
    WriteRegisterByte(RegisterType::D, 0xB5);
    WriteRegisterByte(RegisterType::E, 0xFB);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xCF);
    WriteRegisterByte(RegisterType::L, 0xEB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA3, 0x00);
    WriteMemory(0xBEED, 0xA3);
    WriteMemory(0xBEEC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x49);
    CheckRegisterByte(RegisterType::B, 0x51);
    CheckRegisterByte(RegisterType::C, 0x5F);
    CheckRegisterByte(RegisterType::D, 0xB5);
    CheckRegisterByte(RegisterType::E, 0xFB);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xCF);
    CheckRegisterByte(RegisterType::L, 0xEB);
    CheckRegisterWord(RegisterType::PC, 0xBEEE);
    CheckRegisterWord(RegisterType::SP, 0x7A15);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBEEC, 0xE0);
    CheckMemory(0xBEED, 0xA3);
    CheckMemory(0xFFA3, 0x49);
}

void test_E0_020E()
{
    if (skip_test_E0_020E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC57F);
    WriteRegisterWord(RegisterType::SP, 0xBD18);
    WriteRegisterByte(RegisterType::A, 0x38);
    WriteRegisterByte(RegisterType::B, 0x46);
    WriteRegisterByte(RegisterType::C, 0x0F);
    WriteRegisterByte(RegisterType::D, 0x9D);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xE1);
    WriteRegisterByte(RegisterType::L, 0xA2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE0, 0x00);
    WriteMemory(0xC580, 0xE0);
    WriteMemory(0xC57F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x38);
    CheckRegisterByte(RegisterType::B, 0x46);
    CheckRegisterByte(RegisterType::C, 0x0F);
    CheckRegisterByte(RegisterType::D, 0x9D);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xE1);
    CheckRegisterByte(RegisterType::L, 0xA2);
    CheckRegisterWord(RegisterType::PC, 0xC581);
    CheckRegisterWord(RegisterType::SP, 0xBD18);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC57F, 0xE0);
    CheckMemory(0xC580, 0xE0);
    CheckMemory(0xFFE0, 0x38);
}

void test_E0_020F()
{
    if (skip_test_E0_020F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCEDF);
    WriteRegisterWord(RegisterType::SP, 0x2A23);
    WriteRegisterByte(RegisterType::A, 0x18);
    WriteRegisterByte(RegisterType::B, 0x31);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0xBB);
    WriteRegisterByte(RegisterType::E, 0xA9);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x9E);
    WriteRegisterByte(RegisterType::L, 0xC7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD1, 0x00);
    WriteMemory(0xCEE0, 0xD1);
    WriteMemory(0xCEDF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x18);
    CheckRegisterByte(RegisterType::B, 0x31);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0xBB);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x9E);
    CheckRegisterByte(RegisterType::L, 0xC7);
    CheckRegisterWord(RegisterType::PC, 0xCEE1);
    CheckRegisterWord(RegisterType::SP, 0x2A23);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCEDF, 0xE0);
    CheckMemory(0xCEE0, 0xD1);
    CheckMemory(0xFFD1, 0x18);
}

void test_E0_0210()
{
    if (skip_test_E0_0210)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFB80);
    WriteRegisterWord(RegisterType::SP, 0x096C);
    WriteRegisterByte(RegisterType::A, 0x40);
    WriteRegisterByte(RegisterType::B, 0xB2);
    WriteRegisterByte(RegisterType::C, 0x15);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0xD8);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x63);
    WriteRegisterByte(RegisterType::L, 0x5F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF44, 0x00);
    WriteMemory(0xFB81, 0x44);
    WriteMemory(0xFB80, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x40);
    CheckRegisterByte(RegisterType::B, 0xB2);
    CheckRegisterByte(RegisterType::C, 0x15);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0xD8);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x63);
    CheckRegisterByte(RegisterType::L, 0x5F);
    CheckRegisterWord(RegisterType::PC, 0xFB82);
    CheckRegisterWord(RegisterType::SP, 0x096C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFB80, 0xE0);
    CheckMemory(0xFB81, 0x44);
    CheckMemory(0xFF44, 0x40);
}

void test_E0_0211()
{
    if (skip_test_E0_0211)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD6FF);
    WriteRegisterWord(RegisterType::SP, 0xEBE8);
    WriteRegisterByte(RegisterType::A, 0xF4);
    WriteRegisterByte(RegisterType::B, 0xF6);
    WriteRegisterByte(RegisterType::C, 0x66);
    WriteRegisterByte(RegisterType::D, 0x12);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x4F);
    WriteRegisterByte(RegisterType::L, 0x7A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF48, 0x00);
    WriteMemory(0xD700, 0x48);
    WriteMemory(0xD6FF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF4);
    CheckRegisterByte(RegisterType::B, 0xF6);
    CheckRegisterByte(RegisterType::C, 0x66);
    CheckRegisterByte(RegisterType::D, 0x12);
    CheckRegisterByte(RegisterType::E, 0x5E);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x4F);
    CheckRegisterByte(RegisterType::L, 0x7A);
    CheckRegisterWord(RegisterType::PC, 0xD701);
    CheckRegisterWord(RegisterType::SP, 0xEBE8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD6FF, 0xE0);
    CheckMemory(0xD700, 0x48);
    CheckMemory(0xFF48, 0xF4);
}

void test_E0_0212()
{
    if (skip_test_E0_0212)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF82B);
    WriteRegisterWord(RegisterType::SP, 0x64E6);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0x8F);
    WriteRegisterByte(RegisterType::C, 0x22);
    WriteRegisterByte(RegisterType::D, 0x7D);
    WriteRegisterByte(RegisterType::E, 0x3A);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x29);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA2, 0x00);
    WriteMemory(0xF82C, 0xA2);
    WriteMemory(0xF82B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0x8F);
    CheckRegisterByte(RegisterType::C, 0x22);
    CheckRegisterByte(RegisterType::D, 0x7D);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x29);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0xF82D);
    CheckRegisterWord(RegisterType::SP, 0x64E6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF82B, 0xE0);
    CheckMemory(0xF82C, 0xA2);
    CheckMemory(0xFFA2, 0x56);
}

void test_E0_0213()
{
    if (skip_test_E0_0213)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5260);
    WriteRegisterWord(RegisterType::SP, 0xED3B);
    WriteRegisterByte(RegisterType::A, 0x09);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0x4E);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x92);
    WriteRegisterByte(RegisterType::L, 0xC5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD8, 0x00);
    WriteMemory(0x5261, 0xD8);
    WriteMemory(0x5260, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x09);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0xA9);
    CheckRegisterByte(RegisterType::E, 0x4E);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x92);
    CheckRegisterByte(RegisterType::L, 0xC5);
    CheckRegisterWord(RegisterType::PC, 0x5262);
    CheckRegisterWord(RegisterType::SP, 0xED3B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5260, 0xE0);
    CheckMemory(0x5261, 0xD8);
    CheckMemory(0xFFD8, 0x09);
}

void test_E0_0214()
{
    if (skip_test_E0_0214)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD1A6);
    WriteRegisterWord(RegisterType::SP, 0x776A);
    WriteRegisterByte(RegisterType::A, 0xE2);
    WriteRegisterByte(RegisterType::B, 0x01);
    WriteRegisterByte(RegisterType::C, 0x52);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0xD3);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x05);
    WriteRegisterByte(RegisterType::L, 0x65);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB9, 0x00);
    WriteMemory(0xD1A7, 0xB9);
    WriteMemory(0xD1A6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE2);
    CheckRegisterByte(RegisterType::B, 0x01);
    CheckRegisterByte(RegisterType::C, 0x52);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0xD3);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x05);
    CheckRegisterByte(RegisterType::L, 0x65);
    CheckRegisterWord(RegisterType::PC, 0xD1A8);
    CheckRegisterWord(RegisterType::SP, 0x776A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD1A6, 0xE0);
    CheckMemory(0xD1A7, 0xB9);
    CheckMemory(0xFFB9, 0xE2);
}

void test_E0_0215()
{
    if (skip_test_E0_0215)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7A9F);
    WriteRegisterWord(RegisterType::SP, 0x06DF);
    WriteRegisterByte(RegisterType::A, 0x74);
    WriteRegisterByte(RegisterType::B, 0xE6);
    WriteRegisterByte(RegisterType::C, 0x54);
    WriteRegisterByte(RegisterType::D, 0xE2);
    WriteRegisterByte(RegisterType::E, 0x0A);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x23);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF94, 0x00);
    WriteMemory(0x7AA0, 0x94);
    WriteMemory(0x7A9F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x74);
    CheckRegisterByte(RegisterType::B, 0xE6);
    CheckRegisterByte(RegisterType::C, 0x54);
    CheckRegisterByte(RegisterType::D, 0xE2);
    CheckRegisterByte(RegisterType::E, 0x0A);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x23);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0x7AA1);
    CheckRegisterWord(RegisterType::SP, 0x06DF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7A9F, 0xE0);
    CheckMemory(0x7AA0, 0x94);
    CheckMemory(0xFF94, 0x74);
}

void test_E0_0216()
{
    if (skip_test_E0_0216)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x40F6);
    WriteRegisterWord(RegisterType::SP, 0x64AC);
    WriteRegisterByte(RegisterType::A, 0x6D);
    WriteRegisterByte(RegisterType::B, 0x1F);
    WriteRegisterByte(RegisterType::C, 0xF9);
    WriteRegisterByte(RegisterType::D, 0x71);
    WriteRegisterByte(RegisterType::E, 0x85);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0x3F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF2B, 0x00);
    WriteMemory(0x40F7, 0x2B);
    WriteMemory(0x40F6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6D);
    CheckRegisterByte(RegisterType::B, 0x1F);
    CheckRegisterByte(RegisterType::C, 0xF9);
    CheckRegisterByte(RegisterType::D, 0x71);
    CheckRegisterByte(RegisterType::E, 0x85);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0x3F);
    CheckRegisterWord(RegisterType::PC, 0x40F8);
    CheckRegisterWord(RegisterType::SP, 0x64AC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x40F6, 0xE0);
    CheckMemory(0x40F7, 0x2B);
    CheckMemory(0xFF2B, 0x6D);
}

void test_E0_0217()
{
    if (skip_test_E0_0217)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6D6D);
    WriteRegisterWord(RegisterType::SP, 0xAD5C);
    WriteRegisterByte(RegisterType::A, 0x84);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0xC0);
    WriteRegisterByte(RegisterType::D, 0xE3);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0xF0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA5, 0x00);
    WriteMemory(0x6D6E, 0xA5);
    WriteMemory(0x6D6D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x84);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0xC0);
    CheckRegisterByte(RegisterType::D, 0xE3);
    CheckRegisterByte(RegisterType::E, 0x59);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0xF0);
    CheckRegisterWord(RegisterType::PC, 0x6D6F);
    CheckRegisterWord(RegisterType::SP, 0xAD5C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6D6D, 0xE0);
    CheckMemory(0x6D6E, 0xA5);
    CheckMemory(0xFFA5, 0x84);
}

void test_E0_0218()
{
    if (skip_test_E0_0218)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x519D);
    WriteRegisterWord(RegisterType::SP, 0xA5C6);
    WriteRegisterByte(RegisterType::A, 0x39);
    WriteRegisterByte(RegisterType::B, 0x94);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0x64);
    WriteRegisterByte(RegisterType::E, 0x0C);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF23, 0x00);
    WriteMemory(0x519E, 0x23);
    WriteMemory(0x519D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x39);
    CheckRegisterByte(RegisterType::B, 0x94);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0x64);
    CheckRegisterByte(RegisterType::E, 0x0C);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0x519F);
    CheckRegisterWord(RegisterType::SP, 0xA5C6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x519D, 0xE0);
    CheckMemory(0x519E, 0x23);
    CheckMemory(0xFF23, 0x39);
}

void test_E0_0219()
{
    if (skip_test_E0_0219)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEDF1);
    WriteRegisterWord(RegisterType::SP, 0x2948);
    WriteRegisterByte(RegisterType::A, 0xBF);
    WriteRegisterByte(RegisterType::B, 0x42);
    WriteRegisterByte(RegisterType::C, 0xC1);
    WriteRegisterByte(RegisterType::D, 0x7E);
    WriteRegisterByte(RegisterType::E, 0x14);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x92);
    WriteRegisterByte(RegisterType::L, 0x37);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF71, 0x00);
    WriteMemory(0xEDF2, 0x71);
    WriteMemory(0xEDF1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBF);
    CheckRegisterByte(RegisterType::B, 0x42);
    CheckRegisterByte(RegisterType::C, 0xC1);
    CheckRegisterByte(RegisterType::D, 0x7E);
    CheckRegisterByte(RegisterType::E, 0x14);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x92);
    CheckRegisterByte(RegisterType::L, 0x37);
    CheckRegisterWord(RegisterType::PC, 0xEDF3);
    CheckRegisterWord(RegisterType::SP, 0x2948);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEDF1, 0xE0);
    CheckMemory(0xEDF2, 0x71);
    CheckMemory(0xFF71, 0xBF);
}

void test_E0_021A()
{
    if (skip_test_E0_021A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAC38);
    WriteRegisterWord(RegisterType::SP, 0x28ED);
    WriteRegisterByte(RegisterType::A, 0x09);
    WriteRegisterByte(RegisterType::B, 0xCF);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0xFD);
    WriteRegisterByte(RegisterType::E, 0xC6);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x2A);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6D, 0x00);
    WriteMemory(0xAC39, 0x6D);
    WriteMemory(0xAC38, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x09);
    CheckRegisterByte(RegisterType::B, 0xCF);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0xC6);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x2A);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0xAC3A);
    CheckRegisterWord(RegisterType::SP, 0x28ED);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAC38, 0xE0);
    CheckMemory(0xAC39, 0x6D);
    CheckMemory(0xFF6D, 0x09);
}

void test_E0_021B()
{
    if (skip_test_E0_021B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2F98);
    WriteRegisterWord(RegisterType::SP, 0x5428);
    WriteRegisterByte(RegisterType::A, 0xAC);
    WriteRegisterByte(RegisterType::B, 0x35);
    WriteRegisterByte(RegisterType::C, 0x92);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0x2B);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xF4);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF1A, 0x00);
    WriteMemory(0x2F99, 0x1A);
    WriteMemory(0x2F98, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAC);
    CheckRegisterByte(RegisterType::B, 0x35);
    CheckRegisterByte(RegisterType::C, 0x92);
    CheckRegisterByte(RegisterType::D, 0xAB);
    CheckRegisterByte(RegisterType::E, 0x2B);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xF4);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0x2F9A);
    CheckRegisterWord(RegisterType::SP, 0x5428);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2F98, 0xE0);
    CheckMemory(0x2F99, 0x1A);
    CheckMemory(0xFF1A, 0xAC);
}

void test_E0_021C()
{
    if (skip_test_E0_021C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2456);
    WriteRegisterWord(RegisterType::SP, 0x11D7);
    WriteRegisterByte(RegisterType::A, 0x38);
    WriteRegisterByte(RegisterType::B, 0xE4);
    WriteRegisterByte(RegisterType::C, 0xF9);
    WriteRegisterByte(RegisterType::D, 0x8E);
    WriteRegisterByte(RegisterType::E, 0xE9);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0xB5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF0E, 0x00);
    WriteMemory(0x2457, 0x0E);
    WriteMemory(0x2456, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x38);
    CheckRegisterByte(RegisterType::B, 0xE4);
    CheckRegisterByte(RegisterType::C, 0xF9);
    CheckRegisterByte(RegisterType::D, 0x8E);
    CheckRegisterByte(RegisterType::E, 0xE9);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0xB5);
    CheckRegisterWord(RegisterType::PC, 0x2458);
    CheckRegisterWord(RegisterType::SP, 0x11D7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2456, 0xE0);
    CheckMemory(0x2457, 0x0E);
    CheckMemory(0xFF0E, 0x38);
}

void test_E0_021D()
{
    if (skip_test_E0_021D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4B45);
    WriteRegisterWord(RegisterType::SP, 0x062F);
    WriteRegisterByte(RegisterType::A, 0x94);
    WriteRegisterByte(RegisterType::B, 0x19);
    WriteRegisterByte(RegisterType::C, 0x46);
    WriteRegisterByte(RegisterType::D, 0x83);
    WriteRegisterByte(RegisterType::E, 0x02);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x01);
    WriteRegisterByte(RegisterType::L, 0x85);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF13, 0x00);
    WriteMemory(0x4B46, 0x13);
    WriteMemory(0x4B45, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x94);
    CheckRegisterByte(RegisterType::B, 0x19);
    CheckRegisterByte(RegisterType::C, 0x46);
    CheckRegisterByte(RegisterType::D, 0x83);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x01);
    CheckRegisterByte(RegisterType::L, 0x85);
    CheckRegisterWord(RegisterType::PC, 0x4B47);
    CheckRegisterWord(RegisterType::SP, 0x062F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4B45, 0xE0);
    CheckMemory(0x4B46, 0x13);
    CheckMemory(0xFF13, 0x94);
}

void test_E0_021E()
{
    if (skip_test_E0_021E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x885C);
    WriteRegisterWord(RegisterType::SP, 0x23E4);
    WriteRegisterByte(RegisterType::A, 0xE4);
    WriteRegisterByte(RegisterType::B, 0x80);
    WriteRegisterByte(RegisterType::C, 0x68);
    WriteRegisterByte(RegisterType::D, 0x3E);
    WriteRegisterByte(RegisterType::E, 0x3C);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xAE);
    WriteRegisterByte(RegisterType::L, 0xF4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF11, 0x00);
    WriteMemory(0x885D, 0x11);
    WriteMemory(0x885C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE4);
    CheckRegisterByte(RegisterType::B, 0x80);
    CheckRegisterByte(RegisterType::C, 0x68);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0x3C);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xAE);
    CheckRegisterByte(RegisterType::L, 0xF4);
    CheckRegisterWord(RegisterType::PC, 0x885E);
    CheckRegisterWord(RegisterType::SP, 0x23E4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x885C, 0xE0);
    CheckMemory(0x885D, 0x11);
    CheckMemory(0xFF11, 0xE4);
}

void test_E0_021F()
{
    if (skip_test_E0_021F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF4CB);
    WriteRegisterWord(RegisterType::SP, 0x489E);
    WriteRegisterByte(RegisterType::A, 0xCB);
    WriteRegisterByte(RegisterType::B, 0x45);
    WriteRegisterByte(RegisterType::C, 0x17);
    WriteRegisterByte(RegisterType::D, 0x59);
    WriteRegisterByte(RegisterType::E, 0xA2);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x1D);
    WriteRegisterByte(RegisterType::L, 0x55);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF17, 0x00);
    WriteMemory(0xF4CC, 0x17);
    WriteMemory(0xF4CB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCB);
    CheckRegisterByte(RegisterType::B, 0x45);
    CheckRegisterByte(RegisterType::C, 0x17);
    CheckRegisterByte(RegisterType::D, 0x59);
    CheckRegisterByte(RegisterType::E, 0xA2);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x1D);
    CheckRegisterByte(RegisterType::L, 0x55);
    CheckRegisterWord(RegisterType::PC, 0xF4CD);
    CheckRegisterWord(RegisterType::SP, 0x489E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF4CB, 0xE0);
    CheckMemory(0xF4CC, 0x17);
    CheckMemory(0xFF17, 0xCB);
}

void test_E0_0220()
{
    if (skip_test_E0_0220)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x27CA);
    WriteRegisterWord(RegisterType::SP, 0x3ED4);
    WriteRegisterByte(RegisterType::A, 0x2F);
    WriteRegisterByte(RegisterType::B, 0xDC);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0x8D);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x50);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC4, 0x00);
    WriteMemory(0x27CB, 0xC4);
    WriteMemory(0x27CA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2F);
    CheckRegisterByte(RegisterType::B, 0xDC);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0xDE);
    CheckRegisterByte(RegisterType::E, 0x8D);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x50);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0x27CC);
    CheckRegisterWord(RegisterType::SP, 0x3ED4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x27CA, 0xE0);
    CheckMemory(0x27CB, 0xC4);
    CheckMemory(0xFFC4, 0x2F);
}

void test_E0_0221()
{
    if (skip_test_E0_0221)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEF67);
    WriteRegisterWord(RegisterType::SP, 0xBF6E);
    WriteRegisterByte(RegisterType::A, 0x89);
    WriteRegisterByte(RegisterType::B, 0x7C);
    WriteRegisterByte(RegisterType::C, 0x1A);
    WriteRegisterByte(RegisterType::D, 0x23);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x2D);
    WriteRegisterByte(RegisterType::L, 0xA4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA5, 0x00);
    WriteMemory(0xEF68, 0xA5);
    WriteMemory(0xEF67, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x89);
    CheckRegisterByte(RegisterType::B, 0x7C);
    CheckRegisterByte(RegisterType::C, 0x1A);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0xC5);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x2D);
    CheckRegisterByte(RegisterType::L, 0xA4);
    CheckRegisterWord(RegisterType::PC, 0xEF69);
    CheckRegisterWord(RegisterType::SP, 0xBF6E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEF67, 0xE0);
    CheckMemory(0xEF68, 0xA5);
    CheckMemory(0xFFA5, 0x89);
}

void test_E0_0222()
{
    if (skip_test_E0_0222)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDD13);
    WriteRegisterWord(RegisterType::SP, 0x99BC);
    WriteRegisterByte(RegisterType::A, 0xDE);
    WriteRegisterByte(RegisterType::B, 0x9D);
    WriteRegisterByte(RegisterType::C, 0x51);
    WriteRegisterByte(RegisterType::D, 0x4F);
    WriteRegisterByte(RegisterType::E, 0x59);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0xD9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF99, 0x00);
    WriteMemory(0xDD14, 0x99);
    WriteMemory(0xDD13, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDE);
    CheckRegisterByte(RegisterType::B, 0x9D);
    CheckRegisterByte(RegisterType::C, 0x51);
    CheckRegisterByte(RegisterType::D, 0x4F);
    CheckRegisterByte(RegisterType::E, 0x59);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0xD9);
    CheckRegisterWord(RegisterType::PC, 0xDD15);
    CheckRegisterWord(RegisterType::SP, 0x99BC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDD13, 0xE0);
    CheckMemory(0xDD14, 0x99);
    CheckMemory(0xFF99, 0xDE);
}

void test_E0_0223()
{
    if (skip_test_E0_0223)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x21BD);
    WriteRegisterWord(RegisterType::SP, 0x1759);
    WriteRegisterByte(RegisterType::A, 0xBE);
    WriteRegisterByte(RegisterType::B, 0x75);
    WriteRegisterByte(RegisterType::C, 0x29);
    WriteRegisterByte(RegisterType::D, 0xD5);
    WriteRegisterByte(RegisterType::E, 0x45);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x29);
    WriteRegisterByte(RegisterType::L, 0xD0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8A, 0x00);
    WriteMemory(0x21BE, 0x8A);
    WriteMemory(0x21BD, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBE);
    CheckRegisterByte(RegisterType::B, 0x75);
    CheckRegisterByte(RegisterType::C, 0x29);
    CheckRegisterByte(RegisterType::D, 0xD5);
    CheckRegisterByte(RegisterType::E, 0x45);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x29);
    CheckRegisterByte(RegisterType::L, 0xD0);
    CheckRegisterWord(RegisterType::PC, 0x21BF);
    CheckRegisterWord(RegisterType::SP, 0x1759);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x21BD, 0xE0);
    CheckMemory(0x21BE, 0x8A);
    CheckMemory(0xFF8A, 0xBE);
}

void test_E0_0224()
{
    if (skip_test_E0_0224)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x663F);
    WriteRegisterWord(RegisterType::SP, 0x33BD);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0xB9);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0xB5);
    WriteRegisterByte(RegisterType::E, 0x4C);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x09);
    WriteRegisterByte(RegisterType::L, 0xD8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3D, 0x00);
    WriteMemory(0x6640, 0x3D);
    WriteMemory(0x663F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0xB9);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0xB5);
    CheckRegisterByte(RegisterType::E, 0x4C);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x09);
    CheckRegisterByte(RegisterType::L, 0xD8);
    CheckRegisterWord(RegisterType::PC, 0x6641);
    CheckRegisterWord(RegisterType::SP, 0x33BD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x663F, 0xE0);
    CheckMemory(0x6640, 0x3D);
    CheckMemory(0xFF3D, 0x72);
}

void test_E0_0225()
{
    if (skip_test_E0_0225)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1E03);
    WriteRegisterWord(RegisterType::SP, 0xBC6C);
    WriteRegisterByte(RegisterType::A, 0xAB);
    WriteRegisterByte(RegisterType::B, 0xD0);
    WriteRegisterByte(RegisterType::C, 0x26);
    WriteRegisterByte(RegisterType::D, 0x58);
    WriteRegisterByte(RegisterType::E, 0xBF);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x84);
    WriteRegisterByte(RegisterType::L, 0xCF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6F, 0x00);
    WriteMemory(0x1E04, 0x6F);
    WriteMemory(0x1E03, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAB);
    CheckRegisterByte(RegisterType::B, 0xD0);
    CheckRegisterByte(RegisterType::C, 0x26);
    CheckRegisterByte(RegisterType::D, 0x58);
    CheckRegisterByte(RegisterType::E, 0xBF);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x84);
    CheckRegisterByte(RegisterType::L, 0xCF);
    CheckRegisterWord(RegisterType::PC, 0x1E05);
    CheckRegisterWord(RegisterType::SP, 0xBC6C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1E03, 0xE0);
    CheckMemory(0x1E04, 0x6F);
    CheckMemory(0xFF6F, 0xAB);
}

void test_E0_0226()
{
    if (skip_test_E0_0226)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2CEC);
    WriteRegisterWord(RegisterType::SP, 0xC156);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0xAE);
    WriteRegisterByte(RegisterType::C, 0x8B);
    WriteRegisterByte(RegisterType::D, 0xBF);
    WriteRegisterByte(RegisterType::E, 0x81);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x33);
    WriteRegisterByte(RegisterType::L, 0x83);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4C, 0x00);
    WriteMemory(0x2CED, 0x4C);
    WriteMemory(0x2CEC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0xAE);
    CheckRegisterByte(RegisterType::C, 0x8B);
    CheckRegisterByte(RegisterType::D, 0xBF);
    CheckRegisterByte(RegisterType::E, 0x81);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x33);
    CheckRegisterByte(RegisterType::L, 0x83);
    CheckRegisterWord(RegisterType::PC, 0x2CEE);
    CheckRegisterWord(RegisterType::SP, 0xC156);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2CEC, 0xE0);
    CheckMemory(0x2CED, 0x4C);
    CheckMemory(0xFF4C, 0x32);
}

void test_E0_0227()
{
    if (skip_test_E0_0227)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3263);
    WriteRegisterWord(RegisterType::SP, 0x76C3);
    WriteRegisterByte(RegisterType::A, 0xE1);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0x8A);
    WriteRegisterByte(RegisterType::D, 0xCB);
    WriteRegisterByte(RegisterType::E, 0x3C);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x7A);
    WriteRegisterByte(RegisterType::L, 0x34);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA1, 0x00);
    WriteMemory(0x3264, 0xA1);
    WriteMemory(0x3263, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE1);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0x8A);
    CheckRegisterByte(RegisterType::D, 0xCB);
    CheckRegisterByte(RegisterType::E, 0x3C);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x7A);
    CheckRegisterByte(RegisterType::L, 0x34);
    CheckRegisterWord(RegisterType::PC, 0x3265);
    CheckRegisterWord(RegisterType::SP, 0x76C3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3263, 0xE0);
    CheckMemory(0x3264, 0xA1);
    CheckMemory(0xFFA1, 0xE1);
}

void test_E0_0228()
{
    if (skip_test_E0_0228)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF54F);
    WriteRegisterWord(RegisterType::SP, 0x63E5);
    WriteRegisterByte(RegisterType::A, 0x2D);
    WriteRegisterByte(RegisterType::B, 0x73);
    WriteRegisterByte(RegisterType::C, 0x63);
    WriteRegisterByte(RegisterType::D, 0x27);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0xA1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF19, 0x00);
    WriteMemory(0xF550, 0x19);
    WriteMemory(0xF54F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2D);
    CheckRegisterByte(RegisterType::B, 0x73);
    CheckRegisterByte(RegisterType::C, 0x63);
    CheckRegisterByte(RegisterType::D, 0x27);
    CheckRegisterByte(RegisterType::E, 0x30);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0xA1);
    CheckRegisterWord(RegisterType::PC, 0xF551);
    CheckRegisterWord(RegisterType::SP, 0x63E5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF54F, 0xE0);
    CheckMemory(0xF550, 0x19);
    CheckMemory(0xFF19, 0x2D);
}

void test_E0_0229()
{
    if (skip_test_E0_0229)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD64F);
    WriteRegisterWord(RegisterType::SP, 0x7972);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0x93);
    WriteRegisterByte(RegisterType::C, 0xD9);
    WriteRegisterByte(RegisterType::D, 0x37);
    WriteRegisterByte(RegisterType::E, 0x1B);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xEE);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0B, 0x00);
    WriteMemory(0xD650, 0x0B);
    WriteMemory(0xD64F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0x93);
    CheckRegisterByte(RegisterType::C, 0xD9);
    CheckRegisterByte(RegisterType::D, 0x37);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xEE);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0xD651);
    CheckRegisterWord(RegisterType::SP, 0x7972);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD64F, 0xE0);
    CheckMemory(0xD650, 0x0B);
    CheckMemory(0xFF0B, 0xCD);
}

void test_E0_022A()
{
    if (skip_test_E0_022A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3F23);
    WriteRegisterWord(RegisterType::SP, 0x44A1);
    WriteRegisterByte(RegisterType::A, 0xE8);
    WriteRegisterByte(RegisterType::B, 0x46);
    WriteRegisterByte(RegisterType::C, 0xC4);
    WriteRegisterByte(RegisterType::D, 0x95);
    WriteRegisterByte(RegisterType::E, 0x58);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0x9A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF1E, 0x00);
    WriteMemory(0x3F24, 0x1E);
    WriteMemory(0x3F23, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE8);
    CheckRegisterByte(RegisterType::B, 0x46);
    CheckRegisterByte(RegisterType::C, 0xC4);
    CheckRegisterByte(RegisterType::D, 0x95);
    CheckRegisterByte(RegisterType::E, 0x58);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0x9A);
    CheckRegisterWord(RegisterType::PC, 0x3F25);
    CheckRegisterWord(RegisterType::SP, 0x44A1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3F23, 0xE0);
    CheckMemory(0x3F24, 0x1E);
    CheckMemory(0xFF1E, 0xE8);
}

void test_E0_022B()
{
    if (skip_test_E0_022B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD92F);
    WriteRegisterWord(RegisterType::SP, 0x69DD);
    WriteRegisterByte(RegisterType::A, 0xAD);
    WriteRegisterByte(RegisterType::B, 0x4D);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0xBF);
    WriteRegisterByte(RegisterType::E, 0xFC);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xAF);
    WriteRegisterByte(RegisterType::L, 0xB9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF48, 0x00);
    WriteMemory(0xD930, 0x48);
    WriteMemory(0xD92F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAD);
    CheckRegisterByte(RegisterType::B, 0x4D);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0xBF);
    CheckRegisterByte(RegisterType::E, 0xFC);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xAF);
    CheckRegisterByte(RegisterType::L, 0xB9);
    CheckRegisterWord(RegisterType::PC, 0xD931);
    CheckRegisterWord(RegisterType::SP, 0x69DD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD92F, 0xE0);
    CheckMemory(0xD930, 0x48);
    CheckMemory(0xFF48, 0xAD);
}

void test_E0_022C()
{
    if (skip_test_E0_022C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1CED);
    WriteRegisterWord(RegisterType::SP, 0xF8EF);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0x06);
    WriteRegisterByte(RegisterType::C, 0xFF);
    WriteRegisterByte(RegisterType::D, 0x28);
    WriteRegisterByte(RegisterType::E, 0xD1);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0xA1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF72, 0x00);
    WriteMemory(0x1CEE, 0x72);
    WriteMemory(0x1CED, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0x06);
    CheckRegisterByte(RegisterType::C, 0xFF);
    CheckRegisterByte(RegisterType::D, 0x28);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0xA1);
    CheckRegisterWord(RegisterType::PC, 0x1CEF);
    CheckRegisterWord(RegisterType::SP, 0xF8EF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1CED, 0xE0);
    CheckMemory(0x1CEE, 0x72);
    CheckMemory(0xFF72, 0xCD);
}

void test_E0_022D()
{
    if (skip_test_E0_022D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x16C3);
    WriteRegisterWord(RegisterType::SP, 0xD495);
    WriteRegisterByte(RegisterType::A, 0xC4);
    WriteRegisterByte(RegisterType::B, 0x31);
    WriteRegisterByte(RegisterType::C, 0xB0);
    WriteRegisterByte(RegisterType::D, 0x29);
    WriteRegisterByte(RegisterType::E, 0xF4);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x4B);
    WriteRegisterByte(RegisterType::L, 0x0D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9A, 0x00);
    WriteMemory(0x16C4, 0x9A);
    WriteMemory(0x16C3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC4);
    CheckRegisterByte(RegisterType::B, 0x31);
    CheckRegisterByte(RegisterType::C, 0xB0);
    CheckRegisterByte(RegisterType::D, 0x29);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x4B);
    CheckRegisterByte(RegisterType::L, 0x0D);
    CheckRegisterWord(RegisterType::PC, 0x16C5);
    CheckRegisterWord(RegisterType::SP, 0xD495);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x16C3, 0xE0);
    CheckMemory(0x16C4, 0x9A);
    CheckMemory(0xFF9A, 0xC4);
}

void test_E0_022E()
{
    if (skip_test_E0_022E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x06F6);
    WriteRegisterWord(RegisterType::SP, 0xEB4E);
    WriteRegisterByte(RegisterType::A, 0xD7);
    WriteRegisterByte(RegisterType::B, 0x1A);
    WriteRegisterByte(RegisterType::C, 0xB8);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0x4A);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x8E);
    WriteRegisterByte(RegisterType::L, 0xAD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF54, 0x00);
    WriteMemory(0x06F7, 0x54);
    WriteMemory(0x06F6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD7);
    CheckRegisterByte(RegisterType::B, 0x1A);
    CheckRegisterByte(RegisterType::C, 0xB8);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0x4A);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x8E);
    CheckRegisterByte(RegisterType::L, 0xAD);
    CheckRegisterWord(RegisterType::PC, 0x06F8);
    CheckRegisterWord(RegisterType::SP, 0xEB4E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x06F6, 0xE0);
    CheckMemory(0x06F7, 0x54);
    CheckMemory(0xFF54, 0xD7);
}

void test_E0_022F()
{
    if (skip_test_E0_022F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2A78);
    WriteRegisterWord(RegisterType::SP, 0xF4F5);
    WriteRegisterByte(RegisterType::A, 0x03);
    WriteRegisterByte(RegisterType::B, 0x30);
    WriteRegisterByte(RegisterType::C, 0x63);
    WriteRegisterByte(RegisterType::D, 0x1B);
    WriteRegisterByte(RegisterType::E, 0x9C);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xD1);
    WriteRegisterByte(RegisterType::L, 0x78);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD7, 0x00);
    WriteMemory(0x2A79, 0xD7);
    WriteMemory(0x2A78, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x03);
    CheckRegisterByte(RegisterType::B, 0x30);
    CheckRegisterByte(RegisterType::C, 0x63);
    CheckRegisterByte(RegisterType::D, 0x1B);
    CheckRegisterByte(RegisterType::E, 0x9C);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xD1);
    CheckRegisterByte(RegisterType::L, 0x78);
    CheckRegisterWord(RegisterType::PC, 0x2A7A);
    CheckRegisterWord(RegisterType::SP, 0xF4F5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2A78, 0xE0);
    CheckMemory(0x2A79, 0xD7);
    CheckMemory(0xFFD7, 0x03);
}

void test_E0_0230()
{
    if (skip_test_E0_0230)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAB68);
    WriteRegisterWord(RegisterType::SP, 0xCBCA);
    WriteRegisterByte(RegisterType::A, 0x42);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0xD2);
    WriteRegisterByte(RegisterType::D, 0x8F);
    WriteRegisterByte(RegisterType::E, 0x43);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x19);
    WriteRegisterByte(RegisterType::L, 0x28);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4C, 0x00);
    WriteMemory(0xAB69, 0x4C);
    WriteMemory(0xAB68, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x42);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0xD2);
    CheckRegisterByte(RegisterType::D, 0x8F);
    CheckRegisterByte(RegisterType::E, 0x43);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x19);
    CheckRegisterByte(RegisterType::L, 0x28);
    CheckRegisterWord(RegisterType::PC, 0xAB6A);
    CheckRegisterWord(RegisterType::SP, 0xCBCA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAB68, 0xE0);
    CheckMemory(0xAB69, 0x4C);
    CheckMemory(0xFF4C, 0x42);
}

void test_E0_0231()
{
    if (skip_test_E0_0231)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD72C);
    WriteRegisterWord(RegisterType::SP, 0x2F7A);
    WriteRegisterByte(RegisterType::A, 0x0F);
    WriteRegisterByte(RegisterType::B, 0x05);
    WriteRegisterByte(RegisterType::C, 0xE0);
    WriteRegisterByte(RegisterType::D, 0xFC);
    WriteRegisterByte(RegisterType::E, 0x7C);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xE7);
    WriteRegisterByte(RegisterType::L, 0x04);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAB, 0x00);
    WriteMemory(0xD72D, 0xAB);
    WriteMemory(0xD72C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0F);
    CheckRegisterByte(RegisterType::B, 0x05);
    CheckRegisterByte(RegisterType::C, 0xE0);
    CheckRegisterByte(RegisterType::D, 0xFC);
    CheckRegisterByte(RegisterType::E, 0x7C);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xE7);
    CheckRegisterByte(RegisterType::L, 0x04);
    CheckRegisterWord(RegisterType::PC, 0xD72E);
    CheckRegisterWord(RegisterType::SP, 0x2F7A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD72C, 0xE0);
    CheckMemory(0xD72D, 0xAB);
    CheckMemory(0xFFAB, 0x0F);
}

void test_E0_0232()
{
    if (skip_test_E0_0232)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA64D);
    WriteRegisterWord(RegisterType::SP, 0x6779);
    WriteRegisterByte(RegisterType::A, 0x4A);
    WriteRegisterByte(RegisterType::B, 0x70);
    WriteRegisterByte(RegisterType::C, 0xA0);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0x6A);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x53);
    WriteRegisterByte(RegisterType::L, 0xA1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF1A, 0x00);
    WriteMemory(0xA64E, 0x1A);
    WriteMemory(0xA64D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4A);
    CheckRegisterByte(RegisterType::B, 0x70);
    CheckRegisterByte(RegisterType::C, 0xA0);
    CheckRegisterByte(RegisterType::D, 0xD4);
    CheckRegisterByte(RegisterType::E, 0x6A);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x53);
    CheckRegisterByte(RegisterType::L, 0xA1);
    CheckRegisterWord(RegisterType::PC, 0xA64F);
    CheckRegisterWord(RegisterType::SP, 0x6779);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA64D, 0xE0);
    CheckMemory(0xA64E, 0x1A);
    CheckMemory(0xFF1A, 0x4A);
}

void test_E0_0233()
{
    if (skip_test_E0_0233)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFB77);
    WriteRegisterWord(RegisterType::SP, 0x9CA9);
    WriteRegisterByte(RegisterType::A, 0x64);
    WriteRegisterByte(RegisterType::B, 0xE1);
    WriteRegisterByte(RegisterType::C, 0xC7);
    WriteRegisterByte(RegisterType::D, 0x37);
    WriteRegisterByte(RegisterType::E, 0x06);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x16);
    WriteRegisterByte(RegisterType::L, 0xE3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE7, 0x00);
    WriteMemory(0xFB78, 0xE7);
    WriteMemory(0xFB77, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x64);
    CheckRegisterByte(RegisterType::B, 0xE1);
    CheckRegisterByte(RegisterType::C, 0xC7);
    CheckRegisterByte(RegisterType::D, 0x37);
    CheckRegisterByte(RegisterType::E, 0x06);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x16);
    CheckRegisterByte(RegisterType::L, 0xE3);
    CheckRegisterWord(RegisterType::PC, 0xFB79);
    CheckRegisterWord(RegisterType::SP, 0x9CA9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFB77, 0xE0);
    CheckMemory(0xFB78, 0xE7);
    CheckMemory(0xFFE7, 0x64);
}

void test_E0_0234()
{
    if (skip_test_E0_0234)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x78C0);
    WriteRegisterWord(RegisterType::SP, 0x3928);
    WriteRegisterByte(RegisterType::A, 0xFE);
    WriteRegisterByte(RegisterType::B, 0x6E);
    WriteRegisterByte(RegisterType::C, 0x38);
    WriteRegisterByte(RegisterType::D, 0x96);
    WriteRegisterByte(RegisterType::E, 0x1B);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xF3);
    WriteRegisterByte(RegisterType::L, 0xF7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF92, 0x00);
    WriteMemory(0x78C1, 0x92);
    WriteMemory(0x78C0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFE);
    CheckRegisterByte(RegisterType::B, 0x6E);
    CheckRegisterByte(RegisterType::C, 0x38);
    CheckRegisterByte(RegisterType::D, 0x96);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xF3);
    CheckRegisterByte(RegisterType::L, 0xF7);
    CheckRegisterWord(RegisterType::PC, 0x78C2);
    CheckRegisterWord(RegisterType::SP, 0x3928);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x78C0, 0xE0);
    CheckMemory(0x78C1, 0x92);
    CheckMemory(0xFF92, 0xFE);
}

void test_E0_0235()
{
    if (skip_test_E0_0235)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA9B9);
    WriteRegisterWord(RegisterType::SP, 0x8D90);
    WriteRegisterByte(RegisterType::A, 0xA4);
    WriteRegisterByte(RegisterType::B, 0x9C);
    WriteRegisterByte(RegisterType::C, 0x03);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0xAA);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x23);
    WriteRegisterByte(RegisterType::L, 0xA0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9D, 0x00);
    WriteMemory(0xA9BA, 0x9D);
    WriteMemory(0xA9B9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA4);
    CheckRegisterByte(RegisterType::B, 0x9C);
    CheckRegisterByte(RegisterType::C, 0x03);
    CheckRegisterByte(RegisterType::D, 0xAE);
    CheckRegisterByte(RegisterType::E, 0xAA);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x23);
    CheckRegisterByte(RegisterType::L, 0xA0);
    CheckRegisterWord(RegisterType::PC, 0xA9BB);
    CheckRegisterWord(RegisterType::SP, 0x8D90);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA9B9, 0xE0);
    CheckMemory(0xA9BA, 0x9D);
    CheckMemory(0xFF9D, 0xA4);
}

void test_E0_0236()
{
    if (skip_test_E0_0236)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2D84);
    WriteRegisterWord(RegisterType::SP, 0x6D7A);
    WriteRegisterByte(RegisterType::A, 0x93);
    WriteRegisterByte(RegisterType::B, 0x79);
    WriteRegisterByte(RegisterType::C, 0x10);
    WriteRegisterByte(RegisterType::D, 0x29);
    WriteRegisterByte(RegisterType::E, 0x40);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0x54);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0E, 0x00);
    WriteMemory(0x2D85, 0x0E);
    WriteMemory(0x2D84, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x93);
    CheckRegisterByte(RegisterType::B, 0x79);
    CheckRegisterByte(RegisterType::C, 0x10);
    CheckRegisterByte(RegisterType::D, 0x29);
    CheckRegisterByte(RegisterType::E, 0x40);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0x54);
    CheckRegisterWord(RegisterType::PC, 0x2D86);
    CheckRegisterWord(RegisterType::SP, 0x6D7A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2D84, 0xE0);
    CheckMemory(0x2D85, 0x0E);
    CheckMemory(0xFF0E, 0x93);
}

void test_E0_0237()
{
    if (skip_test_E0_0237)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF813);
    WriteRegisterWord(RegisterType::SP, 0xBA8C);
    WriteRegisterByte(RegisterType::A, 0x36);
    WriteRegisterByte(RegisterType::B, 0x2A);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0xC6);
    WriteRegisterByte(RegisterType::E, 0x4E);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x48);
    WriteRegisterByte(RegisterType::L, 0x3D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC3, 0x00);
    WriteMemory(0xF814, 0xC3);
    WriteMemory(0xF813, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x36);
    CheckRegisterByte(RegisterType::B, 0x2A);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0x4E);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x48);
    CheckRegisterByte(RegisterType::L, 0x3D);
    CheckRegisterWord(RegisterType::PC, 0xF815);
    CheckRegisterWord(RegisterType::SP, 0xBA8C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF813, 0xE0);
    CheckMemory(0xF814, 0xC3);
    CheckMemory(0xFFC3, 0x36);
}

void test_E0_0238()
{
    if (skip_test_E0_0238)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF5BE);
    WriteRegisterWord(RegisterType::SP, 0x0444);
    WriteRegisterByte(RegisterType::A, 0xF1);
    WriteRegisterByte(RegisterType::B, 0x41);
    WriteRegisterByte(RegisterType::C, 0x99);
    WriteRegisterByte(RegisterType::D, 0x45);
    WriteRegisterByte(RegisterType::E, 0x2D);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x0B);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF60, 0x00);
    WriteMemory(0xF5BF, 0x60);
    WriteMemory(0xF5BE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF1);
    CheckRegisterByte(RegisterType::B, 0x41);
    CheckRegisterByte(RegisterType::C, 0x99);
    CheckRegisterByte(RegisterType::D, 0x45);
    CheckRegisterByte(RegisterType::E, 0x2D);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x0B);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0xF5C0);
    CheckRegisterWord(RegisterType::SP, 0x0444);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF5BE, 0xE0);
    CheckMemory(0xF5BF, 0x60);
    CheckMemory(0xFF60, 0xF1);
}

void test_E0_0239()
{
    if (skip_test_E0_0239)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4C8E);
    WriteRegisterWord(RegisterType::SP, 0x7C9D);
    WriteRegisterByte(RegisterType::A, 0xEE);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0xAD);
    WriteRegisterByte(RegisterType::D, 0xC5);
    WriteRegisterByte(RegisterType::E, 0xDB);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x78);
    WriteRegisterByte(RegisterType::L, 0x1A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF0, 0x00);
    WriteMemory(0x4C8F, 0xF0);
    WriteMemory(0x4C8E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEE);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0xAD);
    CheckRegisterByte(RegisterType::D, 0xC5);
    CheckRegisterByte(RegisterType::E, 0xDB);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x78);
    CheckRegisterByte(RegisterType::L, 0x1A);
    CheckRegisterWord(RegisterType::PC, 0x4C90);
    CheckRegisterWord(RegisterType::SP, 0x7C9D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4C8E, 0xE0);
    CheckMemory(0x4C8F, 0xF0);
    CheckMemory(0xFFF0, 0xEE);
}

void test_E0_023A()
{
    if (skip_test_E0_023A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x75F8);
    WriteRegisterWord(RegisterType::SP, 0x8A68);
    WriteRegisterByte(RegisterType::A, 0x00);
    WriteRegisterByte(RegisterType::B, 0x25);
    WriteRegisterByte(RegisterType::C, 0x4D);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0xE6);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x1B);
    WriteRegisterByte(RegisterType::L, 0x8C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCB, 0x00);
    WriteMemory(0x75F9, 0xCB);
    WriteMemory(0x75F8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x00);
    CheckRegisterByte(RegisterType::B, 0x25);
    CheckRegisterByte(RegisterType::C, 0x4D);
    CheckRegisterByte(RegisterType::D, 0xD4);
    CheckRegisterByte(RegisterType::E, 0xE6);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x1B);
    CheckRegisterByte(RegisterType::L, 0x8C);
    CheckRegisterWord(RegisterType::PC, 0x75FA);
    CheckRegisterWord(RegisterType::SP, 0x8A68);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x75F8, 0xE0);
    CheckMemory(0x75F9, 0xCB);
    CheckMemory(0xFFCB, 0x00);
}

void test_E0_023B()
{
    if (skip_test_E0_023B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1C56);
    WriteRegisterWord(RegisterType::SP, 0xD860);
    WriteRegisterByte(RegisterType::A, 0xEF);
    WriteRegisterByte(RegisterType::B, 0x6E);
    WriteRegisterByte(RegisterType::C, 0xE3);
    WriteRegisterByte(RegisterType::D, 0x8F);
    WriteRegisterByte(RegisterType::E, 0x09);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x37);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF45, 0x00);
    WriteMemory(0x1C57, 0x45);
    WriteMemory(0x1C56, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEF);
    CheckRegisterByte(RegisterType::B, 0x6E);
    CheckRegisterByte(RegisterType::C, 0xE3);
    CheckRegisterByte(RegisterType::D, 0x8F);
    CheckRegisterByte(RegisterType::E, 0x09);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x37);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0x1C58);
    CheckRegisterWord(RegisterType::SP, 0xD860);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1C56, 0xE0);
    CheckMemory(0x1C57, 0x45);
    CheckMemory(0xFF45, 0xEF);
}

void test_E0_023C()
{
    if (skip_test_E0_023C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5EF4);
    WriteRegisterWord(RegisterType::SP, 0xBC2B);
    WriteRegisterByte(RegisterType::A, 0xF2);
    WriteRegisterByte(RegisterType::B, 0x23);
    WriteRegisterByte(RegisterType::C, 0xC4);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xE7);
    WriteRegisterByte(RegisterType::L, 0x8F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF89, 0x00);
    WriteMemory(0x5EF5, 0x89);
    WriteMemory(0x5EF4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF2);
    CheckRegisterByte(RegisterType::B, 0x23);
    CheckRegisterByte(RegisterType::C, 0xC4);
    CheckRegisterByte(RegisterType::D, 0x40);
    CheckRegisterByte(RegisterType::E, 0xDC);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xE7);
    CheckRegisterByte(RegisterType::L, 0x8F);
    CheckRegisterWord(RegisterType::PC, 0x5EF6);
    CheckRegisterWord(RegisterType::SP, 0xBC2B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5EF4, 0xE0);
    CheckMemory(0x5EF5, 0x89);
    CheckMemory(0xFF89, 0xF2);
}

void test_E0_023D()
{
    if (skip_test_E0_023D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF3C0);
    WriteRegisterWord(RegisterType::SP, 0xD7A1);
    WriteRegisterByte(RegisterType::A, 0xCE);
    WriteRegisterByte(RegisterType::B, 0xA2);
    WriteRegisterByte(RegisterType::C, 0x31);
    WriteRegisterByte(RegisterType::D, 0x48);
    WriteRegisterByte(RegisterType::E, 0x0D);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xAD);
    WriteRegisterByte(RegisterType::L, 0x38);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB5, 0x00);
    WriteMemory(0xF3C1, 0xB5);
    WriteMemory(0xF3C0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCE);
    CheckRegisterByte(RegisterType::B, 0xA2);
    CheckRegisterByte(RegisterType::C, 0x31);
    CheckRegisterByte(RegisterType::D, 0x48);
    CheckRegisterByte(RegisterType::E, 0x0D);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xAD);
    CheckRegisterByte(RegisterType::L, 0x38);
    CheckRegisterWord(RegisterType::PC, 0xF3C2);
    CheckRegisterWord(RegisterType::SP, 0xD7A1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF3C0, 0xE0);
    CheckMemory(0xF3C1, 0xB5);
    CheckMemory(0xFFB5, 0xCE);
}

void test_E0_023E()
{
    if (skip_test_E0_023E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB91B);
    WriteRegisterWord(RegisterType::SP, 0x7E10);
    WriteRegisterByte(RegisterType::A, 0xB5);
    WriteRegisterByte(RegisterType::B, 0xF9);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0xF3);
    WriteRegisterByte(RegisterType::E, 0x40);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x9A);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF17, 0x00);
    WriteMemory(0xB91C, 0x17);
    WriteMemory(0xB91B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB5);
    CheckRegisterByte(RegisterType::B, 0xF9);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0xF3);
    CheckRegisterByte(RegisterType::E, 0x40);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x9A);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0xB91D);
    CheckRegisterWord(RegisterType::SP, 0x7E10);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB91B, 0xE0);
    CheckMemory(0xB91C, 0x17);
    CheckMemory(0xFF17, 0xB5);
}

void test_E0_023F()
{
    if (skip_test_E0_023F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6BFA);
    WriteRegisterWord(RegisterType::SP, 0xA80E);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x56);
    WriteRegisterByte(RegisterType::D, 0x63);
    WriteRegisterByte(RegisterType::E, 0x07);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0x7A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6A, 0x00);
    WriteMemory(0x6BFB, 0x6A);
    WriteMemory(0x6BFA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x56);
    CheckRegisterByte(RegisterType::D, 0x63);
    CheckRegisterByte(RegisterType::E, 0x07);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0x7A);
    CheckRegisterWord(RegisterType::PC, 0x6BFC);
    CheckRegisterWord(RegisterType::SP, 0xA80E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6BFA, 0xE0);
    CheckMemory(0x6BFB, 0x6A);
    CheckMemory(0xFF6A, 0x78);
}

void test_E0_0240()
{
    if (skip_test_E0_0240)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB9F4);
    WriteRegisterWord(RegisterType::SP, 0x6A38);
    WriteRegisterByte(RegisterType::A, 0x84);
    WriteRegisterByte(RegisterType::B, 0x25);
    WriteRegisterByte(RegisterType::C, 0xC4);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0xA0);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x9B);
    WriteRegisterByte(RegisterType::L, 0x4D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF6B, 0x00);
    WriteMemory(0xB9F5, 0x6B);
    WriteMemory(0xB9F4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x84);
    CheckRegisterByte(RegisterType::B, 0x25);
    CheckRegisterByte(RegisterType::C, 0xC4);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0xA0);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x9B);
    CheckRegisterByte(RegisterType::L, 0x4D);
    CheckRegisterWord(RegisterType::PC, 0xB9F6);
    CheckRegisterWord(RegisterType::SP, 0x6A38);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB9F4, 0xE0);
    CheckMemory(0xB9F5, 0x6B);
    CheckMemory(0xFF6B, 0x84);
}

void test_E0_0241()
{
    if (skip_test_E0_0241)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x30AE);
    WriteRegisterWord(RegisterType::SP, 0xD8BC);
    WriteRegisterByte(RegisterType::A, 0x6E);
    WriteRegisterByte(RegisterType::B, 0x8C);
    WriteRegisterByte(RegisterType::C, 0x17);
    WriteRegisterByte(RegisterType::D, 0xDD);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x1B);
    WriteRegisterByte(RegisterType::L, 0x10);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDA, 0x00);
    WriteMemory(0x30AF, 0xDA);
    WriteMemory(0x30AE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6E);
    CheckRegisterByte(RegisterType::B, 0x8C);
    CheckRegisterByte(RegisterType::C, 0x17);
    CheckRegisterByte(RegisterType::D, 0xDD);
    CheckRegisterByte(RegisterType::E, 0xF5);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x1B);
    CheckRegisterByte(RegisterType::L, 0x10);
    CheckRegisterWord(RegisterType::PC, 0x30B0);
    CheckRegisterWord(RegisterType::SP, 0xD8BC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x30AE, 0xE0);
    CheckMemory(0x30AF, 0xDA);
    CheckMemory(0xFFDA, 0x6E);
}

void test_E0_0242()
{
    if (skip_test_E0_0242)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x552C);
    WriteRegisterWord(RegisterType::SP, 0x57F5);
    WriteRegisterByte(RegisterType::A, 0x1F);
    WriteRegisterByte(RegisterType::B, 0xD1);
    WriteRegisterByte(RegisterType::C, 0x55);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0x37);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x58);
    WriteRegisterByte(RegisterType::L, 0x52);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE9, 0x00);
    WriteMemory(0x552D, 0xE9);
    WriteMemory(0x552C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1F);
    CheckRegisterByte(RegisterType::B, 0xD1);
    CheckRegisterByte(RegisterType::C, 0x55);
    CheckRegisterByte(RegisterType::D, 0x76);
    CheckRegisterByte(RegisterType::E, 0x37);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x58);
    CheckRegisterByte(RegisterType::L, 0x52);
    CheckRegisterWord(RegisterType::PC, 0x552E);
    CheckRegisterWord(RegisterType::SP, 0x57F5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x552C, 0xE0);
    CheckMemory(0x552D, 0xE9);
    CheckMemory(0xFFE9, 0x1F);
}

void test_E0_0243()
{
    if (skip_test_E0_0243)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x411E);
    WriteRegisterWord(RegisterType::SP, 0x1602);
    WriteRegisterByte(RegisterType::A, 0x64);
    WriteRegisterByte(RegisterType::B, 0x1A);
    WriteRegisterByte(RegisterType::C, 0xDC);
    WriteRegisterByte(RegisterType::D, 0x19);
    WriteRegisterByte(RegisterType::E, 0x28);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x90);
    WriteRegisterByte(RegisterType::L, 0x06);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF80, 0x00);
    WriteMemory(0x411F, 0x80);
    WriteMemory(0x411E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x64);
    CheckRegisterByte(RegisterType::B, 0x1A);
    CheckRegisterByte(RegisterType::C, 0xDC);
    CheckRegisterByte(RegisterType::D, 0x19);
    CheckRegisterByte(RegisterType::E, 0x28);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x90);
    CheckRegisterByte(RegisterType::L, 0x06);
    CheckRegisterWord(RegisterType::PC, 0x4120);
    CheckRegisterWord(RegisterType::SP, 0x1602);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x411E, 0xE0);
    CheckMemory(0x411F, 0x80);
    CheckMemory(0xFF80, 0x64);
}

void test_E0_0244()
{
    if (skip_test_E0_0244)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD700);
    WriteRegisterWord(RegisterType::SP, 0xAC12);
    WriteRegisterByte(RegisterType::A, 0x4B);
    WriteRegisterByte(RegisterType::B, 0xDB);
    WriteRegisterByte(RegisterType::C, 0xA1);
    WriteRegisterByte(RegisterType::D, 0xEC);
    WriteRegisterByte(RegisterType::E, 0x4A);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x13);
    WriteRegisterByte(RegisterType::L, 0x84);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCF, 0x00);
    WriteMemory(0xD701, 0xCF);
    WriteMemory(0xD700, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4B);
    CheckRegisterByte(RegisterType::B, 0xDB);
    CheckRegisterByte(RegisterType::C, 0xA1);
    CheckRegisterByte(RegisterType::D, 0xEC);
    CheckRegisterByte(RegisterType::E, 0x4A);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x13);
    CheckRegisterByte(RegisterType::L, 0x84);
    CheckRegisterWord(RegisterType::PC, 0xD702);
    CheckRegisterWord(RegisterType::SP, 0xAC12);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD700, 0xE0);
    CheckMemory(0xD701, 0xCF);
    CheckMemory(0xFFCF, 0x4B);
}

void test_E0_0245()
{
    if (skip_test_E0_0245)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4534);
    WriteRegisterWord(RegisterType::SP, 0x01EC);
    WriteRegisterByte(RegisterType::A, 0xFB);
    WriteRegisterByte(RegisterType::B, 0x2F);
    WriteRegisterByte(RegisterType::C, 0x4C);
    WriteRegisterByte(RegisterType::D, 0x3B);
    WriteRegisterByte(RegisterType::E, 0x88);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0xA2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5B, 0x00);
    WriteMemory(0x4535, 0x5B);
    WriteMemory(0x4534, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFB);
    CheckRegisterByte(RegisterType::B, 0x2F);
    CheckRegisterByte(RegisterType::C, 0x4C);
    CheckRegisterByte(RegisterType::D, 0x3B);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0xA2);
    CheckRegisterWord(RegisterType::PC, 0x4536);
    CheckRegisterWord(RegisterType::SP, 0x01EC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4534, 0xE0);
    CheckMemory(0x4535, 0x5B);
    CheckMemory(0xFF5B, 0xFB);
}

void test_E0_0246()
{
    if (skip_test_E0_0246)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5F26);
    WriteRegisterWord(RegisterType::SP, 0xDB06);
    WriteRegisterByte(RegisterType::A, 0xA3);
    WriteRegisterByte(RegisterType::B, 0x07);
    WriteRegisterByte(RegisterType::C, 0x9C);
    WriteRegisterByte(RegisterType::D, 0x9D);
    WriteRegisterByte(RegisterType::E, 0x81);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x06);
    WriteRegisterByte(RegisterType::L, 0xFC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB2, 0x00);
    WriteMemory(0x5F27, 0xB2);
    WriteMemory(0x5F26, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA3);
    CheckRegisterByte(RegisterType::B, 0x07);
    CheckRegisterByte(RegisterType::C, 0x9C);
    CheckRegisterByte(RegisterType::D, 0x9D);
    CheckRegisterByte(RegisterType::E, 0x81);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x06);
    CheckRegisterByte(RegisterType::L, 0xFC);
    CheckRegisterWord(RegisterType::PC, 0x5F28);
    CheckRegisterWord(RegisterType::SP, 0xDB06);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5F26, 0xE0);
    CheckMemory(0x5F27, 0xB2);
    CheckMemory(0xFFB2, 0xA3);
}

void test_E0_0247()
{
    if (skip_test_E0_0247)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA25F);
    WriteRegisterWord(RegisterType::SP, 0x7C93);
    WriteRegisterByte(RegisterType::A, 0x3C);
    WriteRegisterByte(RegisterType::B, 0x0B);
    WriteRegisterByte(RegisterType::C, 0xE7);
    WriteRegisterByte(RegisterType::D, 0x37);
    WriteRegisterByte(RegisterType::E, 0x9E);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x89);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCB, 0x00);
    WriteMemory(0xA260, 0xCB);
    WriteMemory(0xA25F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3C);
    CheckRegisterByte(RegisterType::B, 0x0B);
    CheckRegisterByte(RegisterType::C, 0xE7);
    CheckRegisterByte(RegisterType::D, 0x37);
    CheckRegisterByte(RegisterType::E, 0x9E);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x89);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0xA261);
    CheckRegisterWord(RegisterType::SP, 0x7C93);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA25F, 0xE0);
    CheckMemory(0xA260, 0xCB);
    CheckMemory(0xFFCB, 0x3C);
}

void test_E0_0248()
{
    if (skip_test_E0_0248)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9D10);
    WriteRegisterWord(RegisterType::SP, 0xD871);
    WriteRegisterByte(RegisterType::A, 0x65);
    WriteRegisterByte(RegisterType::B, 0xFF);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0x5F);
    WriteRegisterByte(RegisterType::E, 0x49);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xCE);
    WriteRegisterByte(RegisterType::L, 0x8D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF97, 0x00);
    WriteMemory(0x9D11, 0x97);
    WriteMemory(0x9D10, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x65);
    CheckRegisterByte(RegisterType::B, 0xFF);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0x5F);
    CheckRegisterByte(RegisterType::E, 0x49);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xCE);
    CheckRegisterByte(RegisterType::L, 0x8D);
    CheckRegisterWord(RegisterType::PC, 0x9D12);
    CheckRegisterWord(RegisterType::SP, 0xD871);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9D10, 0xE0);
    CheckMemory(0x9D11, 0x97);
    CheckMemory(0xFF97, 0x65);
}

void test_E0_0249()
{
    if (skip_test_E0_0249)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDD6D);
    WriteRegisterWord(RegisterType::SP, 0x6759);
    WriteRegisterByte(RegisterType::A, 0xA5);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0x17);
    WriteRegisterByte(RegisterType::D, 0x62);
    WriteRegisterByte(RegisterType::E, 0xB8);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xE1);
    WriteRegisterByte(RegisterType::L, 0x9B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5A, 0x00);
    WriteMemory(0xDD6E, 0x5A);
    WriteMemory(0xDD6D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA5);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0x17);
    CheckRegisterByte(RegisterType::D, 0x62);
    CheckRegisterByte(RegisterType::E, 0xB8);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xE1);
    CheckRegisterByte(RegisterType::L, 0x9B);
    CheckRegisterWord(RegisterType::PC, 0xDD6F);
    CheckRegisterWord(RegisterType::SP, 0x6759);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDD6D, 0xE0);
    CheckMemory(0xDD6E, 0x5A);
    CheckMemory(0xFF5A, 0xA5);
}

void test_E0_024A()
{
    if (skip_test_E0_024A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6C34);
    WriteRegisterWord(RegisterType::SP, 0x396B);
    WriteRegisterByte(RegisterType::A, 0x4E);
    WriteRegisterByte(RegisterType::B, 0xF9);
    WriteRegisterByte(RegisterType::C, 0x60);
    WriteRegisterByte(RegisterType::D, 0x98);
    WriteRegisterByte(RegisterType::E, 0x0B);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0x57);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF06, 0x00);
    WriteMemory(0x6C35, 0x06);
    WriteMemory(0x6C34, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4E);
    CheckRegisterByte(RegisterType::B, 0xF9);
    CheckRegisterByte(RegisterType::C, 0x60);
    CheckRegisterByte(RegisterType::D, 0x98);
    CheckRegisterByte(RegisterType::E, 0x0B);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0x57);
    CheckRegisterWord(RegisterType::PC, 0x6C36);
    CheckRegisterWord(RegisterType::SP, 0x396B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6C34, 0xE0);
    CheckMemory(0x6C35, 0x06);
    CheckMemory(0xFF06, 0x4E);
}

void test_E0_024B()
{
    if (skip_test_E0_024B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4DE6);
    WriteRegisterWord(RegisterType::SP, 0xAA8C);
    WriteRegisterByte(RegisterType::A, 0x4D);
    WriteRegisterByte(RegisterType::B, 0x9E);
    WriteRegisterByte(RegisterType::C, 0x2D);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x17);
    WriteRegisterByte(RegisterType::L, 0x1B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF78, 0x00);
    WriteMemory(0x4DE7, 0x78);
    WriteMemory(0x4DE6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4D);
    CheckRegisterByte(RegisterType::B, 0x9E);
    CheckRegisterByte(RegisterType::C, 0x2D);
    CheckRegisterByte(RegisterType::D, 0xAB);
    CheckRegisterByte(RegisterType::E, 0xDC);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x17);
    CheckRegisterByte(RegisterType::L, 0x1B);
    CheckRegisterWord(RegisterType::PC, 0x4DE8);
    CheckRegisterWord(RegisterType::SP, 0xAA8C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4DE6, 0xE0);
    CheckMemory(0x4DE7, 0x78);
    CheckMemory(0xFF78, 0x4D);
}

void test_E0_024C()
{
    if (skip_test_E0_024C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2145);
    WriteRegisterWord(RegisterType::SP, 0x4E4F);
    WriteRegisterByte(RegisterType::A, 0xEA);
    WriteRegisterByte(RegisterType::B, 0x6F);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0x6B);
    WriteRegisterByte(RegisterType::E, 0x02);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xF8);
    WriteRegisterByte(RegisterType::L, 0x1C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF07, 0x00);
    WriteMemory(0x2146, 0x07);
    WriteMemory(0x2145, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEA);
    CheckRegisterByte(RegisterType::B, 0x6F);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0x6B);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xF8);
    CheckRegisterByte(RegisterType::L, 0x1C);
    CheckRegisterWord(RegisterType::PC, 0x2147);
    CheckRegisterWord(RegisterType::SP, 0x4E4F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2145, 0xE0);
    CheckMemory(0x2146, 0x07);
    CheckMemory(0xFF07, 0xEA);
}

void test_E0_024D()
{
    if (skip_test_E0_024D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3CD5);
    WriteRegisterWord(RegisterType::SP, 0x01B1);
    WriteRegisterByte(RegisterType::A, 0x50);
    WriteRegisterByte(RegisterType::B, 0xBA);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0x6F);
    WriteRegisterByte(RegisterType::E, 0xD8);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xE3);
    WriteRegisterByte(RegisterType::L, 0x41);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF75, 0x00);
    WriteMemory(0x3CD6, 0x75);
    WriteMemory(0x3CD5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x50);
    CheckRegisterByte(RegisterType::B, 0xBA);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0x6F);
    CheckRegisterByte(RegisterType::E, 0xD8);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xE3);
    CheckRegisterByte(RegisterType::L, 0x41);
    CheckRegisterWord(RegisterType::PC, 0x3CD7);
    CheckRegisterWord(RegisterType::SP, 0x01B1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3CD5, 0xE0);
    CheckMemory(0x3CD6, 0x75);
    CheckMemory(0xFF75, 0x50);
}

void test_E0_024E()
{
    if (skip_test_E0_024E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6E1E);
    WriteRegisterWord(RegisterType::SP, 0x3798);
    WriteRegisterByte(RegisterType::A, 0x2C);
    WriteRegisterByte(RegisterType::B, 0x7C);
    WriteRegisterByte(RegisterType::C, 0xAF);
    WriteRegisterByte(RegisterType::D, 0x35);
    WriteRegisterByte(RegisterType::E, 0x57);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x38);
    WriteRegisterByte(RegisterType::L, 0x15);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC0, 0x00);
    WriteMemory(0x6E1F, 0xC0);
    WriteMemory(0x6E1E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2C);
    CheckRegisterByte(RegisterType::B, 0x7C);
    CheckRegisterByte(RegisterType::C, 0xAF);
    CheckRegisterByte(RegisterType::D, 0x35);
    CheckRegisterByte(RegisterType::E, 0x57);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x38);
    CheckRegisterByte(RegisterType::L, 0x15);
    CheckRegisterWord(RegisterType::PC, 0x6E20);
    CheckRegisterWord(RegisterType::SP, 0x3798);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6E1E, 0xE0);
    CheckMemory(0x6E1F, 0xC0);
    CheckMemory(0xFFC0, 0x2C);
}

void test_E0_024F()
{
    if (skip_test_E0_024F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC42A);
    WriteRegisterWord(RegisterType::SP, 0x12E2);
    WriteRegisterByte(RegisterType::A, 0xD8);
    WriteRegisterByte(RegisterType::B, 0xF3);
    WriteRegisterByte(RegisterType::C, 0x42);
    WriteRegisterByte(RegisterType::D, 0x50);
    WriteRegisterByte(RegisterType::E, 0xD8);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0xB4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF97, 0x00);
    WriteMemory(0xC42B, 0x97);
    WriteMemory(0xC42A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD8);
    CheckRegisterByte(RegisterType::B, 0xF3);
    CheckRegisterByte(RegisterType::C, 0x42);
    CheckRegisterByte(RegisterType::D, 0x50);
    CheckRegisterByte(RegisterType::E, 0xD8);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0xB4);
    CheckRegisterWord(RegisterType::PC, 0xC42C);
    CheckRegisterWord(RegisterType::SP, 0x12E2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC42A, 0xE0);
    CheckMemory(0xC42B, 0x97);
    CheckMemory(0xFF97, 0xD8);
}

void test_E0_0250()
{
    if (skip_test_E0_0250)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA841);
    WriteRegisterWord(RegisterType::SP, 0x0CB5);
    WriteRegisterByte(RegisterType::A, 0x12);
    WriteRegisterByte(RegisterType::B, 0x8F);
    WriteRegisterByte(RegisterType::C, 0x99);
    WriteRegisterByte(RegisterType::D, 0x95);
    WriteRegisterByte(RegisterType::E, 0xE6);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xCA);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFBA, 0x00);
    WriteMemory(0xA842, 0xBA);
    WriteMemory(0xA841, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x12);
    CheckRegisterByte(RegisterType::B, 0x8F);
    CheckRegisterByte(RegisterType::C, 0x99);
    CheckRegisterByte(RegisterType::D, 0x95);
    CheckRegisterByte(RegisterType::E, 0xE6);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xCA);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0xA843);
    CheckRegisterWord(RegisterType::SP, 0x0CB5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA841, 0xE0);
    CheckMemory(0xA842, 0xBA);
    CheckMemory(0xFFBA, 0x12);
}

void test_E0_0251()
{
    if (skip_test_E0_0251)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC4AE);
    WriteRegisterWord(RegisterType::SP, 0x0622);
    WriteRegisterByte(RegisterType::A, 0x1F);
    WriteRegisterByte(RegisterType::B, 0x33);
    WriteRegisterByte(RegisterType::C, 0xDE);
    WriteRegisterByte(RegisterType::D, 0xB7);
    WriteRegisterByte(RegisterType::E, 0x33);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0x20);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF01, 0x00);
    WriteMemory(0xC4AF, 0x01);
    WriteMemory(0xC4AE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1F);
    CheckRegisterByte(RegisterType::B, 0x33);
    CheckRegisterByte(RegisterType::C, 0xDE);
    CheckRegisterByte(RegisterType::D, 0xB7);
    CheckRegisterByte(RegisterType::E, 0x33);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0x20);
    CheckRegisterWord(RegisterType::PC, 0xC4B0);
    CheckRegisterWord(RegisterType::SP, 0x0622);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC4AE, 0xE0);
    CheckMemory(0xC4AF, 0x01);
    CheckMemory(0xFF01, 0x1F);
}

void test_E0_0252()
{
    if (skip_test_E0_0252)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB3C8);
    WriteRegisterWord(RegisterType::SP, 0x8FDF);
    WriteRegisterByte(RegisterType::A, 0x82);
    WriteRegisterByte(RegisterType::B, 0x83);
    WriteRegisterByte(RegisterType::C, 0x05);
    WriteRegisterByte(RegisterType::D, 0x08);
    WriteRegisterByte(RegisterType::E, 0x9A);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x08);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF88, 0x00);
    WriteMemory(0xB3C9, 0x88);
    WriteMemory(0xB3C8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x82);
    CheckRegisterByte(RegisterType::B, 0x83);
    CheckRegisterByte(RegisterType::C, 0x05);
    CheckRegisterByte(RegisterType::D, 0x08);
    CheckRegisterByte(RegisterType::E, 0x9A);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x08);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0xB3CA);
    CheckRegisterWord(RegisterType::SP, 0x8FDF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB3C8, 0xE0);
    CheckMemory(0xB3C9, 0x88);
    CheckMemory(0xFF88, 0x82);
}

void test_E0_0253()
{
    if (skip_test_E0_0253)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8C4B);
    WriteRegisterWord(RegisterType::SP, 0x082F);
    WriteRegisterByte(RegisterType::A, 0x00);
    WriteRegisterByte(RegisterType::B, 0x71);
    WriteRegisterByte(RegisterType::C, 0x12);
    WriteRegisterByte(RegisterType::D, 0xC0);
    WriteRegisterByte(RegisterType::E, 0xA1);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0xFA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF80, 0x00);
    WriteMemory(0x8C4C, 0x80);
    WriteMemory(0x8C4B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x00);
    CheckRegisterByte(RegisterType::B, 0x71);
    CheckRegisterByte(RegisterType::C, 0x12);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0xA1);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0xFA);
    CheckRegisterWord(RegisterType::PC, 0x8C4D);
    CheckRegisterWord(RegisterType::SP, 0x082F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8C4B, 0xE0);
    CheckMemory(0x8C4C, 0x80);
    CheckMemory(0xFF80, 0x00);
}

void test_E0_0254()
{
    if (skip_test_E0_0254)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x937C);
    WriteRegisterWord(RegisterType::SP, 0x8347);
    WriteRegisterByte(RegisterType::A, 0xBA);
    WriteRegisterByte(RegisterType::B, 0xA9);
    WriteRegisterByte(RegisterType::C, 0x41);
    WriteRegisterByte(RegisterType::D, 0xD5);
    WriteRegisterByte(RegisterType::E, 0x41);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x52);
    WriteRegisterByte(RegisterType::L, 0xB9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEC, 0x00);
    WriteMemory(0x937D, 0xEC);
    WriteMemory(0x937C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBA);
    CheckRegisterByte(RegisterType::B, 0xA9);
    CheckRegisterByte(RegisterType::C, 0x41);
    CheckRegisterByte(RegisterType::D, 0xD5);
    CheckRegisterByte(RegisterType::E, 0x41);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x52);
    CheckRegisterByte(RegisterType::L, 0xB9);
    CheckRegisterWord(RegisterType::PC, 0x937E);
    CheckRegisterWord(RegisterType::SP, 0x8347);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x937C, 0xE0);
    CheckMemory(0x937D, 0xEC);
    CheckMemory(0xFFEC, 0xBA);
}

void test_E0_0255()
{
    if (skip_test_E0_0255)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x339B);
    WriteRegisterWord(RegisterType::SP, 0xE4A7);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0xA7);
    WriteRegisterByte(RegisterType::C, 0x9B);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0x01);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xF3);
    WriteRegisterByte(RegisterType::L, 0x45);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC0, 0x00);
    WriteMemory(0x339C, 0xC0);
    WriteMemory(0x339B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0xA7);
    CheckRegisterByte(RegisterType::C, 0x9B);
    CheckRegisterByte(RegisterType::D, 0x74);
    CheckRegisterByte(RegisterType::E, 0x01);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xF3);
    CheckRegisterByte(RegisterType::L, 0x45);
    CheckRegisterWord(RegisterType::PC, 0x339D);
    CheckRegisterWord(RegisterType::SP, 0xE4A7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x339B, 0xE0);
    CheckMemory(0x339C, 0xC0);
    CheckMemory(0xFFC0, 0x56);
}

void test_E0_0256()
{
    if (skip_test_E0_0256)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAE1A);
    WriteRegisterWord(RegisterType::SP, 0xBB11);
    WriteRegisterByte(RegisterType::A, 0x5E);
    WriteRegisterByte(RegisterType::B, 0x9E);
    WriteRegisterByte(RegisterType::C, 0xE2);
    WriteRegisterByte(RegisterType::D, 0x43);
    WriteRegisterByte(RegisterType::E, 0x90);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x0B);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAA, 0x00);
    WriteMemory(0xAE1B, 0xAA);
    WriteMemory(0xAE1A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5E);
    CheckRegisterByte(RegisterType::B, 0x9E);
    CheckRegisterByte(RegisterType::C, 0xE2);
    CheckRegisterByte(RegisterType::D, 0x43);
    CheckRegisterByte(RegisterType::E, 0x90);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x0B);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0xAE1C);
    CheckRegisterWord(RegisterType::SP, 0xBB11);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAE1A, 0xE0);
    CheckMemory(0xAE1B, 0xAA);
    CheckMemory(0xFFAA, 0x5E);
}

void test_E0_0257()
{
    if (skip_test_E0_0257)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF772);
    WriteRegisterWord(RegisterType::SP, 0x4148);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0x83);
    WriteRegisterByte(RegisterType::C, 0x04);
    WriteRegisterByte(RegisterType::D, 0xCC);
    WriteRegisterByte(RegisterType::E, 0xEF);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xDA);
    WriteRegisterByte(RegisterType::L, 0xC4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF72, 0x00);
    WriteMemory(0xF773, 0x72);
    WriteMemory(0xF772, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0x83);
    CheckRegisterByte(RegisterType::C, 0x04);
    CheckRegisterByte(RegisterType::D, 0xCC);
    CheckRegisterByte(RegisterType::E, 0xEF);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xDA);
    CheckRegisterByte(RegisterType::L, 0xC4);
    CheckRegisterWord(RegisterType::PC, 0xF774);
    CheckRegisterWord(RegisterType::SP, 0x4148);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF772, 0xE0);
    CheckMemory(0xF773, 0x72);
    CheckMemory(0xFF72, 0x32);
}

void test_E0_0258()
{
    if (skip_test_E0_0258)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0AE5);
    WriteRegisterWord(RegisterType::SP, 0xC884);
    WriteRegisterByte(RegisterType::A, 0x48);
    WriteRegisterByte(RegisterType::B, 0x9B);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0xCA);
    WriteRegisterByte(RegisterType::E, 0x06);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x13);
    WriteRegisterByte(RegisterType::L, 0x7F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF68, 0x00);
    WriteMemory(0x0AE6, 0x68);
    WriteMemory(0x0AE5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x48);
    CheckRegisterByte(RegisterType::B, 0x9B);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0xCA);
    CheckRegisterByte(RegisterType::E, 0x06);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x13);
    CheckRegisterByte(RegisterType::L, 0x7F);
    CheckRegisterWord(RegisterType::PC, 0x0AE7);
    CheckRegisterWord(RegisterType::SP, 0xC884);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0AE5, 0xE0);
    CheckMemory(0x0AE6, 0x68);
    CheckMemory(0xFF68, 0x48);
}

void test_E0_0259()
{
    if (skip_test_E0_0259)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8A16);
    WriteRegisterWord(RegisterType::SP, 0x40A1);
    WriteRegisterByte(RegisterType::A, 0x4A);
    WriteRegisterByte(RegisterType::B, 0x59);
    WriteRegisterByte(RegisterType::C, 0x4E);
    WriteRegisterByte(RegisterType::D, 0x41);
    WriteRegisterByte(RegisterType::E, 0x8E);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x47);
    WriteRegisterByte(RegisterType::L, 0xD7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF78, 0x00);
    WriteMemory(0x8A17, 0x78);
    WriteMemory(0x8A16, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4A);
    CheckRegisterByte(RegisterType::B, 0x59);
    CheckRegisterByte(RegisterType::C, 0x4E);
    CheckRegisterByte(RegisterType::D, 0x41);
    CheckRegisterByte(RegisterType::E, 0x8E);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x47);
    CheckRegisterByte(RegisterType::L, 0xD7);
    CheckRegisterWord(RegisterType::PC, 0x8A18);
    CheckRegisterWord(RegisterType::SP, 0x40A1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8A16, 0xE0);
    CheckMemory(0x8A17, 0x78);
    CheckMemory(0xFF78, 0x4A);
}

void test_E0_025A()
{
    if (skip_test_E0_025A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFD7E);
    WriteRegisterWord(RegisterType::SP, 0x2FDD);
    WriteRegisterByte(RegisterType::A, 0xAE);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x5F);
    WriteRegisterByte(RegisterType::D, 0x54);
    WriteRegisterByte(RegisterType::E, 0x8D);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xCD);
    WriteRegisterByte(RegisterType::L, 0x0A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF10, 0x00);
    WriteMemory(0xFD7F, 0x10);
    WriteMemory(0xFD7E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAE);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x5F);
    CheckRegisterByte(RegisterType::D, 0x54);
    CheckRegisterByte(RegisterType::E, 0x8D);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xCD);
    CheckRegisterByte(RegisterType::L, 0x0A);
    CheckRegisterWord(RegisterType::PC, 0xFD80);
    CheckRegisterWord(RegisterType::SP, 0x2FDD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFD7E, 0xE0);
    CheckMemory(0xFD7F, 0x10);
    CheckMemory(0xFF10, 0xAE);
}

void test_E0_025B()
{
    if (skip_test_E0_025B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x371B);
    WriteRegisterWord(RegisterType::SP, 0x9906);
    WriteRegisterByte(RegisterType::A, 0xE2);
    WriteRegisterByte(RegisterType::B, 0xF4);
    WriteRegisterByte(RegisterType::C, 0x4E);
    WriteRegisterByte(RegisterType::D, 0xAB);
    WriteRegisterByte(RegisterType::E, 0x79);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xC5);
    WriteRegisterByte(RegisterType::L, 0x1D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF5, 0x00);
    WriteMemory(0x371C, 0xF5);
    WriteMemory(0x371B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE2);
    CheckRegisterByte(RegisterType::B, 0xF4);
    CheckRegisterByte(RegisterType::C, 0x4E);
    CheckRegisterByte(RegisterType::D, 0xAB);
    CheckRegisterByte(RegisterType::E, 0x79);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xC5);
    CheckRegisterByte(RegisterType::L, 0x1D);
    CheckRegisterWord(RegisterType::PC, 0x371D);
    CheckRegisterWord(RegisterType::SP, 0x9906);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x371B, 0xE0);
    CheckMemory(0x371C, 0xF5);
    CheckMemory(0xFFF5, 0xE2);
}

void test_E0_025C()
{
    if (skip_test_E0_025C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x91F6);
    WriteRegisterWord(RegisterType::SP, 0xE02A);
    WriteRegisterByte(RegisterType::A, 0xEB);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0xDA);
    WriteRegisterByte(RegisterType::D, 0x49);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xD1);
    WriteRegisterByte(RegisterType::L, 0x99);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF1C, 0x00);
    WriteMemory(0x91F7, 0x1C);
    WriteMemory(0x91F6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEB);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0xDA);
    CheckRegisterByte(RegisterType::D, 0x49);
    CheckRegisterByte(RegisterType::E, 0xF5);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xD1);
    CheckRegisterByte(RegisterType::L, 0x99);
    CheckRegisterWord(RegisterType::PC, 0x91F8);
    CheckRegisterWord(RegisterType::SP, 0xE02A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x91F6, 0xE0);
    CheckMemory(0x91F7, 0x1C);
    CheckMemory(0xFF1C, 0xEB);
}

void test_E0_025D()
{
    if (skip_test_E0_025D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA239);
    WriteRegisterWord(RegisterType::SP, 0x83E8);
    WriteRegisterByte(RegisterType::A, 0x0F);
    WriteRegisterByte(RegisterType::B, 0xF7);
    WriteRegisterByte(RegisterType::C, 0xEF);
    WriteRegisterByte(RegisterType::D, 0xA3);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0x32);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA6, 0x00);
    WriteMemory(0xA23A, 0xA6);
    WriteMemory(0xA239, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0F);
    CheckRegisterByte(RegisterType::B, 0xF7);
    CheckRegisterByte(RegisterType::C, 0xEF);
    CheckRegisterByte(RegisterType::D, 0xA3);
    CheckRegisterByte(RegisterType::E, 0x0F);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0x32);
    CheckRegisterWord(RegisterType::PC, 0xA23B);
    CheckRegisterWord(RegisterType::SP, 0x83E8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA239, 0xE0);
    CheckMemory(0xA23A, 0xA6);
    CheckMemory(0xFFA6, 0x0F);
}

void test_E0_025E()
{
    if (skip_test_E0_025E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC3CC);
    WriteRegisterWord(RegisterType::SP, 0xBF4D);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0x86);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0x9F);
    WriteRegisterByte(RegisterType::E, 0x16);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0xB4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9E, 0x00);
    WriteMemory(0xC3CD, 0x9E);
    WriteMemory(0xC3CC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0x86);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0x16);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0xB4);
    CheckRegisterWord(RegisterType::PC, 0xC3CE);
    CheckRegisterWord(RegisterType::SP, 0xBF4D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC3CC, 0xE0);
    CheckMemory(0xC3CD, 0x9E);
    CheckMemory(0xFF9E, 0xD0);
}

void test_E0_025F()
{
    if (skip_test_E0_025F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAB70);
    WriteRegisterWord(RegisterType::SP, 0xA053);
    WriteRegisterByte(RegisterType::A, 0x45);
    WriteRegisterByte(RegisterType::B, 0x93);
    WriteRegisterByte(RegisterType::C, 0xBD);
    WriteRegisterByte(RegisterType::D, 0x79);
    WriteRegisterByte(RegisterType::E, 0x33);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0x7E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB2, 0x00);
    WriteMemory(0xAB71, 0xB2);
    WriteMemory(0xAB70, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x45);
    CheckRegisterByte(RegisterType::B, 0x93);
    CheckRegisterByte(RegisterType::C, 0xBD);
    CheckRegisterByte(RegisterType::D, 0x79);
    CheckRegisterByte(RegisterType::E, 0x33);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0x7E);
    CheckRegisterWord(RegisterType::PC, 0xAB72);
    CheckRegisterWord(RegisterType::SP, 0xA053);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAB70, 0xE0);
    CheckMemory(0xAB71, 0xB2);
    CheckMemory(0xFFB2, 0x45);
}

void test_E0_0260()
{
    if (skip_test_E0_0260)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD38C);
    WriteRegisterWord(RegisterType::SP, 0x361F);
    WriteRegisterByte(RegisterType::A, 0xA5);
    WriteRegisterByte(RegisterType::B, 0x37);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0xF0);
    WriteRegisterByte(RegisterType::E, 0x0E);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x6B);
    WriteRegisterByte(RegisterType::L, 0x25);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF39, 0x00);
    WriteMemory(0xD38D, 0x39);
    WriteMemory(0xD38C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA5);
    CheckRegisterByte(RegisterType::B, 0x37);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0xF0);
    CheckRegisterByte(RegisterType::E, 0x0E);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x6B);
    CheckRegisterByte(RegisterType::L, 0x25);
    CheckRegisterWord(RegisterType::PC, 0xD38E);
    CheckRegisterWord(RegisterType::SP, 0x361F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD38C, 0xE0);
    CheckMemory(0xD38D, 0x39);
    CheckMemory(0xFF39, 0xA5);
}

void test_E0_0261()
{
    if (skip_test_E0_0261)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDF10);
    WriteRegisterWord(RegisterType::SP, 0x862F);
    WriteRegisterByte(RegisterType::A, 0xCE);
    WriteRegisterByte(RegisterType::B, 0x1D);
    WriteRegisterByte(RegisterType::C, 0x75);
    WriteRegisterByte(RegisterType::D, 0xC8);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x3C);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD6, 0x00);
    WriteMemory(0xDF11, 0xD6);
    WriteMemory(0xDF10, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCE);
    CheckRegisterByte(RegisterType::B, 0x1D);
    CheckRegisterByte(RegisterType::C, 0x75);
    CheckRegisterByte(RegisterType::D, 0xC8);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x3C);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0xDF12);
    CheckRegisterWord(RegisterType::SP, 0x862F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDF10, 0xE0);
    CheckMemory(0xDF11, 0xD6);
    CheckMemory(0xFFD6, 0xCE);
}

void test_E0_0262()
{
    if (skip_test_E0_0262)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAE2F);
    WriteRegisterWord(RegisterType::SP, 0xAE8A);
    WriteRegisterByte(RegisterType::A, 0xDC);
    WriteRegisterByte(RegisterType::B, 0x92);
    WriteRegisterByte(RegisterType::C, 0xD0);
    WriteRegisterByte(RegisterType::D, 0xC0);
    WriteRegisterByte(RegisterType::E, 0x63);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF98, 0x00);
    WriteMemory(0xAE30, 0x98);
    WriteMemory(0xAE2F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDC);
    CheckRegisterByte(RegisterType::B, 0x92);
    CheckRegisterByte(RegisterType::C, 0xD0);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0x63);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0xAE31);
    CheckRegisterWord(RegisterType::SP, 0xAE8A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAE2F, 0xE0);
    CheckMemory(0xAE30, 0x98);
    CheckMemory(0xFF98, 0xDC);
}

void test_E0_0263()
{
    if (skip_test_E0_0263)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC720);
    WriteRegisterWord(RegisterType::SP, 0x91B1);
    WriteRegisterByte(RegisterType::A, 0xC0);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0x45);
    WriteRegisterByte(RegisterType::D, 0x50);
    WriteRegisterByte(RegisterType::E, 0x81);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x75);
    WriteRegisterByte(RegisterType::L, 0x9C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF30, 0x00);
    WriteMemory(0xC721, 0x30);
    WriteMemory(0xC720, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC0);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0x45);
    CheckRegisterByte(RegisterType::D, 0x50);
    CheckRegisterByte(RegisterType::E, 0x81);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x75);
    CheckRegisterByte(RegisterType::L, 0x9C);
    CheckRegisterWord(RegisterType::PC, 0xC722);
    CheckRegisterWord(RegisterType::SP, 0x91B1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC720, 0xE0);
    CheckMemory(0xC721, 0x30);
    CheckMemory(0xFF30, 0xC0);
}

void test_E0_0264()
{
    if (skip_test_E0_0264)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC319);
    WriteRegisterWord(RegisterType::SP, 0x2473);
    WriteRegisterByte(RegisterType::A, 0x0A);
    WriteRegisterByte(RegisterType::B, 0xFB);
    WriteRegisterByte(RegisterType::C, 0x0A);
    WriteRegisterByte(RegisterType::D, 0x09);
    WriteRegisterByte(RegisterType::E, 0x14);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xC4);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3F, 0x00);
    WriteMemory(0xC31A, 0x3F);
    WriteMemory(0xC319, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0A);
    CheckRegisterByte(RegisterType::B, 0xFB);
    CheckRegisterByte(RegisterType::C, 0x0A);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0x14);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xC4);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0xC31B);
    CheckRegisterWord(RegisterType::SP, 0x2473);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC319, 0xE0);
    CheckMemory(0xC31A, 0x3F);
    CheckMemory(0xFF3F, 0x0A);
}

void test_E0_0265()
{
    if (skip_test_E0_0265)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4DE8);
    WriteRegisterWord(RegisterType::SP, 0xA6E4);
    WriteRegisterByte(RegisterType::A, 0x4A);
    WriteRegisterByte(RegisterType::B, 0xB1);
    WriteRegisterByte(RegisterType::C, 0xA9);
    WriteRegisterByte(RegisterType::D, 0x21);
    WriteRegisterByte(RegisterType::E, 0xE1);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x32);
    WriteRegisterByte(RegisterType::L, 0x51);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDA, 0x00);
    WriteMemory(0x4DE9, 0xDA);
    WriteMemory(0x4DE8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4A);
    CheckRegisterByte(RegisterType::B, 0xB1);
    CheckRegisterByte(RegisterType::C, 0xA9);
    CheckRegisterByte(RegisterType::D, 0x21);
    CheckRegisterByte(RegisterType::E, 0xE1);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x32);
    CheckRegisterByte(RegisterType::L, 0x51);
    CheckRegisterWord(RegisterType::PC, 0x4DEA);
    CheckRegisterWord(RegisterType::SP, 0xA6E4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4DE8, 0xE0);
    CheckMemory(0x4DE9, 0xDA);
    CheckMemory(0xFFDA, 0x4A);
}

void test_E0_0266()
{
    if (skip_test_E0_0266)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC241);
    WriteRegisterWord(RegisterType::SP, 0x81C5);
    WriteRegisterByte(RegisterType::A, 0x7B);
    WriteRegisterByte(RegisterType::B, 0xF7);
    WriteRegisterByte(RegisterType::C, 0x8F);
    WriteRegisterByte(RegisterType::D, 0x2E);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x0E);
    WriteRegisterByte(RegisterType::L, 0x6D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAB, 0x00);
    WriteMemory(0xC242, 0xAB);
    WriteMemory(0xC241, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7B);
    CheckRegisterByte(RegisterType::B, 0xF7);
    CheckRegisterByte(RegisterType::C, 0x8F);
    CheckRegisterByte(RegisterType::D, 0x2E);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x0E);
    CheckRegisterByte(RegisterType::L, 0x6D);
    CheckRegisterWord(RegisterType::PC, 0xC243);
    CheckRegisterWord(RegisterType::SP, 0x81C5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC241, 0xE0);
    CheckMemory(0xC242, 0xAB);
    CheckMemory(0xFFAB, 0x7B);
}

void test_E0_0267()
{
    if (skip_test_E0_0267)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAED2);
    WriteRegisterWord(RegisterType::SP, 0x5331);
    WriteRegisterByte(RegisterType::A, 0x61);
    WriteRegisterByte(RegisterType::B, 0x1D);
    WriteRegisterByte(RegisterType::C, 0xF2);
    WriteRegisterByte(RegisterType::D, 0x00);
    WriteRegisterByte(RegisterType::E, 0xC0);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xE2);
    WriteRegisterByte(RegisterType::L, 0x93);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF13, 0x00);
    WriteMemory(0xAED3, 0x13);
    WriteMemory(0xAED2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x61);
    CheckRegisterByte(RegisterType::B, 0x1D);
    CheckRegisterByte(RegisterType::C, 0xF2);
    CheckRegisterByte(RegisterType::D, 0x00);
    CheckRegisterByte(RegisterType::E, 0xC0);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xE2);
    CheckRegisterByte(RegisterType::L, 0x93);
    CheckRegisterWord(RegisterType::PC, 0xAED4);
    CheckRegisterWord(RegisterType::SP, 0x5331);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xAED2, 0xE0);
    CheckMemory(0xAED3, 0x13);
    CheckMemory(0xFF13, 0x61);
}

void test_E0_0268()
{
    if (skip_test_E0_0268)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6ED1);
    WriteRegisterWord(RegisterType::SP, 0xBFAB);
    WriteRegisterByte(RegisterType::A, 0xA7);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0xF1);
    WriteRegisterByte(RegisterType::D, 0x69);
    WriteRegisterByte(RegisterType::E, 0xDB);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x8E);
    WriteRegisterByte(RegisterType::L, 0x01);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF64, 0x00);
    WriteMemory(0x6ED2, 0x64);
    WriteMemory(0x6ED1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA7);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0xF1);
    CheckRegisterByte(RegisterType::D, 0x69);
    CheckRegisterByte(RegisterType::E, 0xDB);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x8E);
    CheckRegisterByte(RegisterType::L, 0x01);
    CheckRegisterWord(RegisterType::PC, 0x6ED3);
    CheckRegisterWord(RegisterType::SP, 0xBFAB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6ED1, 0xE0);
    CheckMemory(0x6ED2, 0x64);
    CheckMemory(0xFF64, 0xA7);
}

void test_E0_0269()
{
    if (skip_test_E0_0269)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x426A);
    WriteRegisterWord(RegisterType::SP, 0xE071);
    WriteRegisterByte(RegisterType::A, 0xBD);
    WriteRegisterByte(RegisterType::B, 0x5A);
    WriteRegisterByte(RegisterType::C, 0x6D);
    WriteRegisterByte(RegisterType::D, 0x86);
    WriteRegisterByte(RegisterType::E, 0x01);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xA1);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF46, 0x00);
    WriteMemory(0x426B, 0x46);
    WriteMemory(0x426A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBD);
    CheckRegisterByte(RegisterType::B, 0x5A);
    CheckRegisterByte(RegisterType::C, 0x6D);
    CheckRegisterByte(RegisterType::D, 0x86);
    CheckRegisterByte(RegisterType::E, 0x01);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xA1);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0x426C);
    CheckRegisterWord(RegisterType::SP, 0xE071);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x426A, 0xE0);
    CheckMemory(0x426B, 0x46);
    CheckMemory(0xFF46, 0xBD);
}

void test_E0_026A()
{
    if (skip_test_E0_026A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDFBB);
    WriteRegisterWord(RegisterType::SP, 0x5176);
    WriteRegisterByte(RegisterType::A, 0x83);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0x6B);
    WriteRegisterByte(RegisterType::D, 0x7E);
    WriteRegisterByte(RegisterType::E, 0x4B);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0x59);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA5, 0x00);
    WriteMemory(0xDFBC, 0xA5);
    WriteMemory(0xDFBB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x83);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0x6B);
    CheckRegisterByte(RegisterType::D, 0x7E);
    CheckRegisterByte(RegisterType::E, 0x4B);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0x59);
    CheckRegisterWord(RegisterType::PC, 0xDFBD);
    CheckRegisterWord(RegisterType::SP, 0x5176);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDFBB, 0xE0);
    CheckMemory(0xDFBC, 0xA5);
    CheckMemory(0xFFA5, 0x83);
}

void test_E0_026B()
{
    if (skip_test_E0_026B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFC8B);
    WriteRegisterWord(RegisterType::SP, 0x1B9F);
    WriteRegisterByte(RegisterType::A, 0xED);
    WriteRegisterByte(RegisterType::B, 0x43);
    WriteRegisterByte(RegisterType::C, 0x30);
    WriteRegisterByte(RegisterType::D, 0x5F);
    WriteRegisterByte(RegisterType::E, 0x5B);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xE3);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB6, 0x00);
    WriteMemory(0xFC8C, 0xB6);
    WriteMemory(0xFC8B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xED);
    CheckRegisterByte(RegisterType::B, 0x43);
    CheckRegisterByte(RegisterType::C, 0x30);
    CheckRegisterByte(RegisterType::D, 0x5F);
    CheckRegisterByte(RegisterType::E, 0x5B);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xE3);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0xFC8D);
    CheckRegisterWord(RegisterType::SP, 0x1B9F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFC8B, 0xE0);
    CheckMemory(0xFC8C, 0xB6);
    CheckMemory(0xFFB6, 0xED);
}

void test_E0_026C()
{
    if (skip_test_E0_026C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA9F6);
    WriteRegisterWord(RegisterType::SP, 0x2E69);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0x54);
    WriteRegisterByte(RegisterType::D, 0x44);
    WriteRegisterByte(RegisterType::E, 0xAE);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x68);
    WriteRegisterByte(RegisterType::L, 0x87);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF52, 0x00);
    WriteMemory(0xA9F7, 0x52);
    WriteMemory(0xA9F6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0x54);
    CheckRegisterByte(RegisterType::D, 0x44);
    CheckRegisterByte(RegisterType::E, 0xAE);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x68);
    CheckRegisterByte(RegisterType::L, 0x87);
    CheckRegisterWord(RegisterType::PC, 0xA9F8);
    CheckRegisterWord(RegisterType::SP, 0x2E69);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA9F6, 0xE0);
    CheckMemory(0xA9F7, 0x52);
    CheckMemory(0xFF52, 0x71);
}

void test_E0_026D()
{
    if (skip_test_E0_026D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBBF2);
    WriteRegisterWord(RegisterType::SP, 0xEA22);
    WriteRegisterByte(RegisterType::A, 0xEF);
    WriteRegisterByte(RegisterType::B, 0x53);
    WriteRegisterByte(RegisterType::C, 0xE1);
    WriteRegisterByte(RegisterType::D, 0xF4);
    WriteRegisterByte(RegisterType::E, 0x9B);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x7F);
    WriteRegisterByte(RegisterType::L, 0x59);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC9, 0x00);
    WriteMemory(0xBBF3, 0xC9);
    WriteMemory(0xBBF2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEF);
    CheckRegisterByte(RegisterType::B, 0x53);
    CheckRegisterByte(RegisterType::C, 0xE1);
    CheckRegisterByte(RegisterType::D, 0xF4);
    CheckRegisterByte(RegisterType::E, 0x9B);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x7F);
    CheckRegisterByte(RegisterType::L, 0x59);
    CheckRegisterWord(RegisterType::PC, 0xBBF4);
    CheckRegisterWord(RegisterType::SP, 0xEA22);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBBF2, 0xE0);
    CheckMemory(0xBBF3, 0xC9);
    CheckMemory(0xFFC9, 0xEF);
}

void test_E0_026E()
{
    if (skip_test_E0_026E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x054D);
    WriteRegisterWord(RegisterType::SP, 0x3C2C);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0xC1);
    WriteRegisterByte(RegisterType::C, 0x73);
    WriteRegisterByte(RegisterType::D, 0x0C);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0x63);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF68, 0x00);
    WriteMemory(0x054E, 0x68);
    WriteMemory(0x054D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0xC1);
    CheckRegisterByte(RegisterType::C, 0x73);
    CheckRegisterByte(RegisterType::D, 0x0C);
    CheckRegisterByte(RegisterType::E, 0x30);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0x63);
    CheckRegisterWord(RegisterType::PC, 0x054F);
    CheckRegisterWord(RegisterType::SP, 0x3C2C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x054D, 0xE0);
    CheckMemory(0x054E, 0x68);
    CheckMemory(0xFF68, 0x24);
}

void test_E0_026F()
{
    if (skip_test_E0_026F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE960);
    WriteRegisterWord(RegisterType::SP, 0xE08B);
    WriteRegisterByte(RegisterType::A, 0xF1);
    WriteRegisterByte(RegisterType::B, 0x1F);
    WriteRegisterByte(RegisterType::C, 0xE7);
    WriteRegisterByte(RegisterType::D, 0x25);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0x8F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9A, 0x00);
    WriteMemory(0xE961, 0x9A);
    WriteMemory(0xE960, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF1);
    CheckRegisterByte(RegisterType::B, 0x1F);
    CheckRegisterByte(RegisterType::C, 0xE7);
    CheckRegisterByte(RegisterType::D, 0x25);
    CheckRegisterByte(RegisterType::E, 0xE7);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0x8F);
    CheckRegisterWord(RegisterType::PC, 0xE962);
    CheckRegisterWord(RegisterType::SP, 0xE08B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE960, 0xE0);
    CheckMemory(0xE961, 0x9A);
    CheckMemory(0xFF9A, 0xF1);
}

void test_E0_0270()
{
    if (skip_test_E0_0270)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF51D);
    WriteRegisterWord(RegisterType::SP, 0xC9A0);
    WriteRegisterByte(RegisterType::A, 0x4D);
    WriteRegisterByte(RegisterType::B, 0x21);
    WriteRegisterByte(RegisterType::C, 0x11);
    WriteRegisterByte(RegisterType::D, 0x12);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x26);
    WriteRegisterByte(RegisterType::L, 0xA7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAF, 0x00);
    WriteMemory(0xF51E, 0xAF);
    WriteMemory(0xF51D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4D);
    CheckRegisterByte(RegisterType::B, 0x21);
    CheckRegisterByte(RegisterType::C, 0x11);
    CheckRegisterByte(RegisterType::D, 0x12);
    CheckRegisterByte(RegisterType::E, 0x95);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x26);
    CheckRegisterByte(RegisterType::L, 0xA7);
    CheckRegisterWord(RegisterType::PC, 0xF51F);
    CheckRegisterWord(RegisterType::SP, 0xC9A0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF51D, 0xE0);
    CheckMemory(0xF51E, 0xAF);
    CheckMemory(0xFFAF, 0x4D);
}

void test_E0_0271()
{
    if (skip_test_E0_0271)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5F50);
    WriteRegisterWord(RegisterType::SP, 0x9B4A);
    WriteRegisterByte(RegisterType::A, 0xA0);
    WriteRegisterByte(RegisterType::B, 0x35);
    WriteRegisterByte(RegisterType::C, 0x7D);
    WriteRegisterByte(RegisterType::D, 0xAD);
    WriteRegisterByte(RegisterType::E, 0xF3);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xAA);
    WriteRegisterByte(RegisterType::L, 0xB2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5E, 0x00);
    WriteMemory(0x5F51, 0x5E);
    WriteMemory(0x5F50, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA0);
    CheckRegisterByte(RegisterType::B, 0x35);
    CheckRegisterByte(RegisterType::C, 0x7D);
    CheckRegisterByte(RegisterType::D, 0xAD);
    CheckRegisterByte(RegisterType::E, 0xF3);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xAA);
    CheckRegisterByte(RegisterType::L, 0xB2);
    CheckRegisterWord(RegisterType::PC, 0x5F52);
    CheckRegisterWord(RegisterType::SP, 0x9B4A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5F50, 0xE0);
    CheckMemory(0x5F51, 0x5E);
    CheckMemory(0xFF5E, 0xA0);
}

void test_E0_0272()
{
    if (skip_test_E0_0272)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1B94);
    WriteRegisterWord(RegisterType::SP, 0xE5A8);
    WriteRegisterByte(RegisterType::A, 0xFC);
    WriteRegisterByte(RegisterType::B, 0x7B);
    WriteRegisterByte(RegisterType::C, 0xAA);
    WriteRegisterByte(RegisterType::D, 0xA0);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xA6);
    WriteRegisterByte(RegisterType::L, 0x5F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2A, 0x00);
    WriteMemory(0x1B95, 0x2A);
    WriteMemory(0x1B94, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFC);
    CheckRegisterByte(RegisterType::B, 0x7B);
    CheckRegisterByte(RegisterType::C, 0xAA);
    CheckRegisterByte(RegisterType::D, 0xA0);
    CheckRegisterByte(RegisterType::E, 0xC7);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xA6);
    CheckRegisterByte(RegisterType::L, 0x5F);
    CheckRegisterWord(RegisterType::PC, 0x1B96);
    CheckRegisterWord(RegisterType::SP, 0xE5A8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1B94, 0xE0);
    CheckMemory(0x1B95, 0x2A);
    CheckMemory(0xFF2A, 0xFC);
}

void test_E0_0273()
{
    if (skip_test_E0_0273)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD86D);
    WriteRegisterWord(RegisterType::SP, 0x8432);
    WriteRegisterByte(RegisterType::A, 0x7C);
    WriteRegisterByte(RegisterType::B, 0x08);
    WriteRegisterByte(RegisterType::C, 0xC3);
    WriteRegisterByte(RegisterType::D, 0xE7);
    WriteRegisterByte(RegisterType::E, 0x18);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x65);
    WriteRegisterByte(RegisterType::L, 0x72);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFB, 0x00);
    WriteMemory(0xD86E, 0xFB);
    WriteMemory(0xD86D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7C);
    CheckRegisterByte(RegisterType::B, 0x08);
    CheckRegisterByte(RegisterType::C, 0xC3);
    CheckRegisterByte(RegisterType::D, 0xE7);
    CheckRegisterByte(RegisterType::E, 0x18);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x65);
    CheckRegisterByte(RegisterType::L, 0x72);
    CheckRegisterWord(RegisterType::PC, 0xD86F);
    CheckRegisterWord(RegisterType::SP, 0x8432);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD86D, 0xE0);
    CheckMemory(0xD86E, 0xFB);
    CheckMemory(0xFFFB, 0x7C);
}

void test_E0_0274()
{
    if (skip_test_E0_0274)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x145F);
    WriteRegisterWord(RegisterType::SP, 0xAB4F);
    WriteRegisterByte(RegisterType::A, 0xE3);
    WriteRegisterByte(RegisterType::B, 0x50);
    WriteRegisterByte(RegisterType::C, 0xE0);
    WriteRegisterByte(RegisterType::D, 0x56);
    WriteRegisterByte(RegisterType::E, 0x01);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x9D);
    WriteRegisterByte(RegisterType::L, 0xBD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF34, 0x00);
    WriteMemory(0x1460, 0x34);
    WriteMemory(0x145F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE3);
    CheckRegisterByte(RegisterType::B, 0x50);
    CheckRegisterByte(RegisterType::C, 0xE0);
    CheckRegisterByte(RegisterType::D, 0x56);
    CheckRegisterByte(RegisterType::E, 0x01);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x9D);
    CheckRegisterByte(RegisterType::L, 0xBD);
    CheckRegisterWord(RegisterType::PC, 0x1461);
    CheckRegisterWord(RegisterType::SP, 0xAB4F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x145F, 0xE0);
    CheckMemory(0x1460, 0x34);
    CheckMemory(0xFF34, 0xE3);
}

void test_E0_0275()
{
    if (skip_test_E0_0275)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8505);
    WriteRegisterWord(RegisterType::SP, 0x5533);
    WriteRegisterByte(RegisterType::A, 0x4B);
    WriteRegisterByte(RegisterType::B, 0x2C);
    WriteRegisterByte(RegisterType::C, 0xF0);
    WriteRegisterByte(RegisterType::D, 0x6B);
    WriteRegisterByte(RegisterType::E, 0x70);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xBC);
    WriteRegisterByte(RegisterType::L, 0x40);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFBE, 0x00);
    WriteMemory(0x8506, 0xBE);
    WriteMemory(0x8505, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4B);
    CheckRegisterByte(RegisterType::B, 0x2C);
    CheckRegisterByte(RegisterType::C, 0xF0);
    CheckRegisterByte(RegisterType::D, 0x6B);
    CheckRegisterByte(RegisterType::E, 0x70);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xBC);
    CheckRegisterByte(RegisterType::L, 0x40);
    CheckRegisterWord(RegisterType::PC, 0x8507);
    CheckRegisterWord(RegisterType::SP, 0x5533);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8505, 0xE0);
    CheckMemory(0x8506, 0xBE);
    CheckMemory(0xFFBE, 0x4B);
}

void test_E0_0276()
{
    if (skip_test_E0_0276)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0BFD);
    WriteRegisterWord(RegisterType::SP, 0xBF5B);
    WriteRegisterByte(RegisterType::A, 0x1E);
    WriteRegisterByte(RegisterType::B, 0xFF);
    WriteRegisterByte(RegisterType::C, 0xDD);
    WriteRegisterByte(RegisterType::D, 0xD2);
    WriteRegisterByte(RegisterType::E, 0x9E);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x19);
    WriteRegisterByte(RegisterType::L, 0x4F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD3, 0x00);
    WriteMemory(0x0BFE, 0xD3);
    WriteMemory(0x0BFD, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1E);
    CheckRegisterByte(RegisterType::B, 0xFF);
    CheckRegisterByte(RegisterType::C, 0xDD);
    CheckRegisterByte(RegisterType::D, 0xD2);
    CheckRegisterByte(RegisterType::E, 0x9E);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x19);
    CheckRegisterByte(RegisterType::L, 0x4F);
    CheckRegisterWord(RegisterType::PC, 0x0BFF);
    CheckRegisterWord(RegisterType::SP, 0xBF5B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0BFD, 0xE0);
    CheckMemory(0x0BFE, 0xD3);
    CheckMemory(0xFFD3, 0x1E);
}

void test_E0_0277()
{
    if (skip_test_E0_0277)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5962);
    WriteRegisterWord(RegisterType::SP, 0xCA2F);
    WriteRegisterByte(RegisterType::A, 0x38);
    WriteRegisterByte(RegisterType::B, 0xA8);
    WriteRegisterByte(RegisterType::C, 0x32);
    WriteRegisterByte(RegisterType::D, 0xE3);
    WriteRegisterByte(RegisterType::E, 0xDF);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xBA);
    WriteRegisterByte(RegisterType::L, 0x5A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9F, 0x00);
    WriteMemory(0x5963, 0x9F);
    WriteMemory(0x5962, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x38);
    CheckRegisterByte(RegisterType::B, 0xA8);
    CheckRegisterByte(RegisterType::C, 0x32);
    CheckRegisterByte(RegisterType::D, 0xE3);
    CheckRegisterByte(RegisterType::E, 0xDF);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xBA);
    CheckRegisterByte(RegisterType::L, 0x5A);
    CheckRegisterWord(RegisterType::PC, 0x5964);
    CheckRegisterWord(RegisterType::SP, 0xCA2F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5962, 0xE0);
    CheckMemory(0x5963, 0x9F);
    CheckMemory(0xFF9F, 0x38);
}

void test_E0_0278()
{
    if (skip_test_E0_0278)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9C50);
    WriteRegisterWord(RegisterType::SP, 0x0A92);
    WriteRegisterByte(RegisterType::A, 0xBE);
    WriteRegisterByte(RegisterType::B, 0x19);
    WriteRegisterByte(RegisterType::C, 0xBF);
    WriteRegisterByte(RegisterType::D, 0xBD);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x10);
    WriteRegisterByte(RegisterType::L, 0x99);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF51, 0x00);
    WriteMemory(0x9C51, 0x51);
    WriteMemory(0x9C50, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBE);
    CheckRegisterByte(RegisterType::B, 0x19);
    CheckRegisterByte(RegisterType::C, 0xBF);
    CheckRegisterByte(RegisterType::D, 0xBD);
    CheckRegisterByte(RegisterType::E, 0x83);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x10);
    CheckRegisterByte(RegisterType::L, 0x99);
    CheckRegisterWord(RegisterType::PC, 0x9C52);
    CheckRegisterWord(RegisterType::SP, 0x0A92);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9C50, 0xE0);
    CheckMemory(0x9C51, 0x51);
    CheckMemory(0xFF51, 0xBE);
}

void test_E0_0279()
{
    if (skip_test_E0_0279)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF802);
    WriteRegisterWord(RegisterType::SP, 0xE32F);
    WriteRegisterByte(RegisterType::A, 0x8B);
    WriteRegisterByte(RegisterType::B, 0x7B);
    WriteRegisterByte(RegisterType::C, 0x43);
    WriteRegisterByte(RegisterType::D, 0xE2);
    WriteRegisterByte(RegisterType::E, 0x40);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x12);
    WriteRegisterByte(RegisterType::L, 0xE4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF80, 0x00);
    WriteMemory(0xF803, 0x80);
    WriteMemory(0xF802, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8B);
    CheckRegisterByte(RegisterType::B, 0x7B);
    CheckRegisterByte(RegisterType::C, 0x43);
    CheckRegisterByte(RegisterType::D, 0xE2);
    CheckRegisterByte(RegisterType::E, 0x40);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x12);
    CheckRegisterByte(RegisterType::L, 0xE4);
    CheckRegisterWord(RegisterType::PC, 0xF804);
    CheckRegisterWord(RegisterType::SP, 0xE32F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF802, 0xE0);
    CheckMemory(0xF803, 0x80);
    CheckMemory(0xFF80, 0x8B);
}

void test_E0_027A()
{
    if (skip_test_E0_027A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD37F);
    WriteRegisterWord(RegisterType::SP, 0x2680);
    WriteRegisterByte(RegisterType::A, 0xB5);
    WriteRegisterByte(RegisterType::B, 0x2C);
    WriteRegisterByte(RegisterType::C, 0x2E);
    WriteRegisterByte(RegisterType::D, 0x60);
    WriteRegisterByte(RegisterType::E, 0x3B);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0x1F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA9, 0x00);
    WriteMemory(0xD380, 0xA9);
    WriteMemory(0xD37F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB5);
    CheckRegisterByte(RegisterType::B, 0x2C);
    CheckRegisterByte(RegisterType::C, 0x2E);
    CheckRegisterByte(RegisterType::D, 0x60);
    CheckRegisterByte(RegisterType::E, 0x3B);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0x1F);
    CheckRegisterWord(RegisterType::PC, 0xD381);
    CheckRegisterWord(RegisterType::SP, 0x2680);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD37F, 0xE0);
    CheckMemory(0xD380, 0xA9);
    CheckMemory(0xFFA9, 0xB5);
}

void test_E0_027B()
{
    if (skip_test_E0_027B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF7B4);
    WriteRegisterWord(RegisterType::SP, 0x67D5);
    WriteRegisterByte(RegisterType::A, 0x68);
    WriteRegisterByte(RegisterType::B, 0xAF);
    WriteRegisterByte(RegisterType::C, 0xC7);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0xA8);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0x16);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF3D, 0x00);
    WriteMemory(0xF7B5, 0x3D);
    WriteMemory(0xF7B4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x68);
    CheckRegisterByte(RegisterType::B, 0xAF);
    CheckRegisterByte(RegisterType::C, 0xC7);
    CheckRegisterByte(RegisterType::D, 0xA9);
    CheckRegisterByte(RegisterType::E, 0xA8);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0x16);
    CheckRegisterWord(RegisterType::PC, 0xF7B6);
    CheckRegisterWord(RegisterType::SP, 0x67D5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF7B4, 0xE0);
    CheckMemory(0xF7B5, 0x3D);
    CheckMemory(0xFF3D, 0x68);
}

void test_E0_027C()
{
    if (skip_test_E0_027C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE46B);
    WriteRegisterWord(RegisterType::SP, 0xD0AF);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0x79);
    WriteRegisterByte(RegisterType::D, 0x65);
    WriteRegisterByte(RegisterType::E, 0x9B);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x5C);
    WriteRegisterByte(RegisterType::L, 0x49);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF71, 0x00);
    WriteMemory(0xE46C, 0x71);
    WriteMemory(0xE46B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0x79);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0x9B);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x5C);
    CheckRegisterByte(RegisterType::L, 0x49);
    CheckRegisterWord(RegisterType::PC, 0xE46D);
    CheckRegisterWord(RegisterType::SP, 0xD0AF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE46B, 0xE0);
    CheckMemory(0xE46C, 0x71);
    CheckMemory(0xFF71, 0xC2);
}

void test_E0_027D()
{
    if (skip_test_E0_027D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD1EE);
    WriteRegisterWord(RegisterType::SP, 0x9ABE);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0xD0);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x6D);
    WriteRegisterByte(RegisterType::L, 0x39);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF86, 0x00);
    WriteMemory(0xD1EF, 0x86);
    WriteMemory(0xD1EE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0x40);
    CheckRegisterByte(RegisterType::E, 0xD0);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x6D);
    CheckRegisterByte(RegisterType::L, 0x39);
    CheckRegisterWord(RegisterType::PC, 0xD1F0);
    CheckRegisterWord(RegisterType::SP, 0x9ABE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD1EE, 0xE0);
    CheckMemory(0xD1EF, 0x86);
    CheckMemory(0xFF86, 0x69);
}

void test_E0_027E()
{
    if (skip_test_E0_027E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA8FE);
    WriteRegisterWord(RegisterType::SP, 0xA94C);
    WriteRegisterByte(RegisterType::A, 0x39);
    WriteRegisterByte(RegisterType::B, 0x6D);
    WriteRegisterByte(RegisterType::C, 0x32);
    WriteRegisterByte(RegisterType::D, 0x2C);
    WriteRegisterByte(RegisterType::E, 0x69);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x4D);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF68, 0x00);
    WriteMemory(0xA8FF, 0x68);
    WriteMemory(0xA8FE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x39);
    CheckRegisterByte(RegisterType::B, 0x6D);
    CheckRegisterByte(RegisterType::C, 0x32);
    CheckRegisterByte(RegisterType::D, 0x2C);
    CheckRegisterByte(RegisterType::E, 0x69);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x4D);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0xA900);
    CheckRegisterWord(RegisterType::SP, 0xA94C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA8FE, 0xE0);
    CheckMemory(0xA8FF, 0x68);
    CheckMemory(0xFF68, 0x39);
}

void test_E0_027F()
{
    if (skip_test_E0_027F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x28FE);
    WriteRegisterWord(RegisterType::SP, 0x1C4E);
    WriteRegisterByte(RegisterType::A, 0x76);
    WriteRegisterByte(RegisterType::B, 0xC5);
    WriteRegisterByte(RegisterType::C, 0x1E);
    WriteRegisterByte(RegisterType::D, 0xD2);
    WriteRegisterByte(RegisterType::E, 0xDD);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x0F);
    WriteRegisterByte(RegisterType::L, 0xCC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD7, 0x00);
    WriteMemory(0x28FF, 0xD7);
    WriteMemory(0x28FE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x76);
    CheckRegisterByte(RegisterType::B, 0xC5);
    CheckRegisterByte(RegisterType::C, 0x1E);
    CheckRegisterByte(RegisterType::D, 0xD2);
    CheckRegisterByte(RegisterType::E, 0xDD);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x0F);
    CheckRegisterByte(RegisterType::L, 0xCC);
    CheckRegisterWord(RegisterType::PC, 0x2900);
    CheckRegisterWord(RegisterType::SP, 0x1C4E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x28FE, 0xE0);
    CheckMemory(0x28FF, 0xD7);
    CheckMemory(0xFFD7, 0x76);
}

void test_E0_0280()
{
    if (skip_test_E0_0280)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2E45);
    WriteRegisterWord(RegisterType::SP, 0xC564);
    WriteRegisterByte(RegisterType::A, 0xA0);
    WriteRegisterByte(RegisterType::B, 0xA7);
    WriteRegisterByte(RegisterType::C, 0xF9);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0x42);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xE1);
    WriteRegisterByte(RegisterType::L, 0x02);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4A, 0x00);
    WriteMemory(0x2E46, 0x4A);
    WriteMemory(0x2E45, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA0);
    CheckRegisterByte(RegisterType::B, 0xA7);
    CheckRegisterByte(RegisterType::C, 0xF9);
    CheckRegisterByte(RegisterType::D, 0xDE);
    CheckRegisterByte(RegisterType::E, 0x42);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xE1);
    CheckRegisterByte(RegisterType::L, 0x02);
    CheckRegisterWord(RegisterType::PC, 0x2E47);
    CheckRegisterWord(RegisterType::SP, 0xC564);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2E45, 0xE0);
    CheckMemory(0x2E46, 0x4A);
    CheckMemory(0xFF4A, 0xA0);
}

void test_E0_0281()
{
    if (skip_test_E0_0281)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x743E);
    WriteRegisterWord(RegisterType::SP, 0x15C4);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0x61);
    WriteRegisterByte(RegisterType::C, 0xC9);
    WriteRegisterByte(RegisterType::D, 0x11);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xE7);
    WriteRegisterByte(RegisterType::L, 0x03);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA2, 0x00);
    WriteMemory(0x743F, 0xA2);
    WriteMemory(0x743E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0x61);
    CheckRegisterByte(RegisterType::C, 0xC9);
    CheckRegisterByte(RegisterType::D, 0x11);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xE7);
    CheckRegisterByte(RegisterType::L, 0x03);
    CheckRegisterWord(RegisterType::PC, 0x7440);
    CheckRegisterWord(RegisterType::SP, 0x15C4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x743E, 0xE0);
    CheckMemory(0x743F, 0xA2);
    CheckMemory(0xFFA2, 0x56);
}

void test_E0_0282()
{
    if (skip_test_E0_0282)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7AE9);
    WriteRegisterWord(RegisterType::SP, 0x1F35);
    WriteRegisterByte(RegisterType::A, 0xB4);
    WriteRegisterByte(RegisterType::B, 0x2B);
    WriteRegisterByte(RegisterType::C, 0x64);
    WriteRegisterByte(RegisterType::D, 0x9F);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x24);
    WriteRegisterByte(RegisterType::L, 0xC2);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6F, 0x00);
    WriteMemory(0x7AEA, 0x6F);
    WriteMemory(0x7AE9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB4);
    CheckRegisterByte(RegisterType::B, 0x2B);
    CheckRegisterByte(RegisterType::C, 0x64);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0xE0);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x24);
    CheckRegisterByte(RegisterType::L, 0xC2);
    CheckRegisterWord(RegisterType::PC, 0x7AEB);
    CheckRegisterWord(RegisterType::SP, 0x1F35);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7AE9, 0xE0);
    CheckMemory(0x7AEA, 0x6F);
    CheckMemory(0xFF6F, 0xB4);
}

void test_E0_0283()
{
    if (skip_test_E0_0283)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x81E1);
    WriteRegisterWord(RegisterType::SP, 0x4F2B);
    WriteRegisterByte(RegisterType::A, 0x91);
    WriteRegisterByte(RegisterType::B, 0x88);
    WriteRegisterByte(RegisterType::C, 0xAD);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0xB5);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xE5);
    WriteRegisterByte(RegisterType::L, 0x98);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA3, 0x00);
    WriteMemory(0x81E2, 0xA3);
    WriteMemory(0x81E1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x91);
    CheckRegisterByte(RegisterType::B, 0x88);
    CheckRegisterByte(RegisterType::C, 0xAD);
    CheckRegisterByte(RegisterType::D, 0xA6);
    CheckRegisterByte(RegisterType::E, 0xB5);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xE5);
    CheckRegisterByte(RegisterType::L, 0x98);
    CheckRegisterWord(RegisterType::PC, 0x81E3);
    CheckRegisterWord(RegisterType::SP, 0x4F2B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x81E1, 0xE0);
    CheckMemory(0x81E2, 0xA3);
    CheckMemory(0xFFA3, 0x91);
}

void test_E0_0284()
{
    if (skip_test_E0_0284)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC23F);
    WriteRegisterWord(RegisterType::SP, 0x53E6);
    WriteRegisterByte(RegisterType::A, 0x28);
    WriteRegisterByte(RegisterType::B, 0x33);
    WriteRegisterByte(RegisterType::C, 0x6B);
    WriteRegisterByte(RegisterType::D, 0x26);
    WriteRegisterByte(RegisterType::E, 0xCD);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xDC);
    WriteRegisterByte(RegisterType::L, 0xE7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8D, 0x00);
    WriteMemory(0xC240, 0x8D);
    WriteMemory(0xC23F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x28);
    CheckRegisterByte(RegisterType::B, 0x33);
    CheckRegisterByte(RegisterType::C, 0x6B);
    CheckRegisterByte(RegisterType::D, 0x26);
    CheckRegisterByte(RegisterType::E, 0xCD);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xDC);
    CheckRegisterByte(RegisterType::L, 0xE7);
    CheckRegisterWord(RegisterType::PC, 0xC241);
    CheckRegisterWord(RegisterType::SP, 0x53E6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC23F, 0xE0);
    CheckMemory(0xC240, 0x8D);
    CheckMemory(0xFF8D, 0x28);
}

void test_E0_0285()
{
    if (skip_test_E0_0285)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1B03);
    WriteRegisterWord(RegisterType::SP, 0x3EB6);
    WriteRegisterByte(RegisterType::A, 0x38);
    WriteRegisterByte(RegisterType::B, 0xF3);
    WriteRegisterByte(RegisterType::C, 0x7A);
    WriteRegisterByte(RegisterType::D, 0x09);
    WriteRegisterByte(RegisterType::E, 0xB5);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x79);
    WriteRegisterByte(RegisterType::L, 0x7D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2F, 0x00);
    WriteMemory(0x1B04, 0x2F);
    WriteMemory(0x1B03, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x38);
    CheckRegisterByte(RegisterType::B, 0xF3);
    CheckRegisterByte(RegisterType::C, 0x7A);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0xB5);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x79);
    CheckRegisterByte(RegisterType::L, 0x7D);
    CheckRegisterWord(RegisterType::PC, 0x1B05);
    CheckRegisterWord(RegisterType::SP, 0x3EB6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1B03, 0xE0);
    CheckMemory(0x1B04, 0x2F);
    CheckMemory(0xFF2F, 0x38);
}

void test_E0_0286()
{
    if (skip_test_E0_0286)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x897F);
    WriteRegisterWord(RegisterType::SP, 0x7FD5);
    WriteRegisterByte(RegisterType::A, 0x75);
    WriteRegisterByte(RegisterType::B, 0x36);
    WriteRegisterByte(RegisterType::C, 0x97);
    WriteRegisterByte(RegisterType::D, 0x59);
    WriteRegisterByte(RegisterType::E, 0xAC);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x29);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8A, 0x00);
    WriteMemory(0x8980, 0x8A);
    WriteMemory(0x897F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x75);
    CheckRegisterByte(RegisterType::B, 0x36);
    CheckRegisterByte(RegisterType::C, 0x97);
    CheckRegisterByte(RegisterType::D, 0x59);
    CheckRegisterByte(RegisterType::E, 0xAC);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x29);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0x8981);
    CheckRegisterWord(RegisterType::SP, 0x7FD5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x897F, 0xE0);
    CheckMemory(0x8980, 0x8A);
    CheckMemory(0xFF8A, 0x75);
}

void test_E0_0287()
{
    if (skip_test_E0_0287)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC555);
    WriteRegisterWord(RegisterType::SP, 0xD7E6);
    WriteRegisterByte(RegisterType::A, 0x79);
    WriteRegisterByte(RegisterType::B, 0xE4);
    WriteRegisterByte(RegisterType::C, 0x02);
    WriteRegisterByte(RegisterType::D, 0xE8);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x7F);
    WriteRegisterByte(RegisterType::L, 0x34);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE8, 0x00);
    WriteMemory(0xC556, 0xE8);
    WriteMemory(0xC555, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x79);
    CheckRegisterByte(RegisterType::B, 0xE4);
    CheckRegisterByte(RegisterType::C, 0x02);
    CheckRegisterByte(RegisterType::D, 0xE8);
    CheckRegisterByte(RegisterType::E, 0xE7);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x7F);
    CheckRegisterByte(RegisterType::L, 0x34);
    CheckRegisterWord(RegisterType::PC, 0xC557);
    CheckRegisterWord(RegisterType::SP, 0xD7E6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC555, 0xE0);
    CheckMemory(0xC556, 0xE8);
    CheckMemory(0xFFE8, 0x79);
}

void test_E0_0288()
{
    if (skip_test_E0_0288)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9A9D);
    WriteRegisterWord(RegisterType::SP, 0x3370);
    WriteRegisterByte(RegisterType::A, 0x63);
    WriteRegisterByte(RegisterType::B, 0xBA);
    WriteRegisterByte(RegisterType::C, 0x2C);
    WriteRegisterByte(RegisterType::D, 0x69);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xAF);
    WriteRegisterByte(RegisterType::L, 0x9B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF73, 0x00);
    WriteMemory(0x9A9E, 0x73);
    WriteMemory(0x9A9D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x63);
    CheckRegisterByte(RegisterType::B, 0xBA);
    CheckRegisterByte(RegisterType::C, 0x2C);
    CheckRegisterByte(RegisterType::D, 0x69);
    CheckRegisterByte(RegisterType::E, 0xC7);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xAF);
    CheckRegisterByte(RegisterType::L, 0x9B);
    CheckRegisterWord(RegisterType::PC, 0x9A9F);
    CheckRegisterWord(RegisterType::SP, 0x3370);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9A9D, 0xE0);
    CheckMemory(0x9A9E, 0x73);
    CheckMemory(0xFF73, 0x63);
}

void test_E0_0289()
{
    if (skip_test_E0_0289)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x19C2);
    WriteRegisterWord(RegisterType::SP, 0x490D);
    WriteRegisterByte(RegisterType::A, 0xAC);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0x97);
    WriteRegisterByte(RegisterType::D, 0xB7);
    WriteRegisterByte(RegisterType::E, 0x51);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x62);
    WriteRegisterByte(RegisterType::L, 0xC7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDE, 0x00);
    WriteMemory(0x19C3, 0xDE);
    WriteMemory(0x19C2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAC);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0x97);
    CheckRegisterByte(RegisterType::D, 0xB7);
    CheckRegisterByte(RegisterType::E, 0x51);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x62);
    CheckRegisterByte(RegisterType::L, 0xC7);
    CheckRegisterWord(RegisterType::PC, 0x19C4);
    CheckRegisterWord(RegisterType::SP, 0x490D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x19C2, 0xE0);
    CheckMemory(0x19C3, 0xDE);
    CheckMemory(0xFFDE, 0xAC);
}

void test_E0_028A()
{
    if (skip_test_E0_028A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF8A3);
    WriteRegisterWord(RegisterType::SP, 0x30D5);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0x52);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0xBB);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xA3);
    WriteRegisterByte(RegisterType::L, 0x39);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF43, 0x00);
    WriteMemory(0xF8A4, 0x43);
    WriteMemory(0xF8A3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0x52);
    CheckRegisterByte(RegisterType::D, 0xAE);
    CheckRegisterByte(RegisterType::E, 0xBB);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xA3);
    CheckRegisterByte(RegisterType::L, 0x39);
    CheckRegisterWord(RegisterType::PC, 0xF8A5);
    CheckRegisterWord(RegisterType::SP, 0x30D5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF8A3, 0xE0);
    CheckMemory(0xF8A4, 0x43);
    CheckMemory(0xFF43, 0x24);
}

void test_E0_028B()
{
    if (skip_test_E0_028B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0EB7);
    WriteRegisterWord(RegisterType::SP, 0xADFD);
    WriteRegisterByte(RegisterType::A, 0x73);
    WriteRegisterByte(RegisterType::B, 0x33);
    WriteRegisterByte(RegisterType::C, 0x69);
    WriteRegisterByte(RegisterType::D, 0x80);
    WriteRegisterByte(RegisterType::E, 0xA1);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xD8);
    WriteRegisterByte(RegisterType::L, 0xD3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3A, 0x00);
    WriteMemory(0x0EB8, 0x3A);
    WriteMemory(0x0EB7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x73);
    CheckRegisterByte(RegisterType::B, 0x33);
    CheckRegisterByte(RegisterType::C, 0x69);
    CheckRegisterByte(RegisterType::D, 0x80);
    CheckRegisterByte(RegisterType::E, 0xA1);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xD8);
    CheckRegisterByte(RegisterType::L, 0xD3);
    CheckRegisterWord(RegisterType::PC, 0x0EB9);
    CheckRegisterWord(RegisterType::SP, 0xADFD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0EB7, 0xE0);
    CheckMemory(0x0EB8, 0x3A);
    CheckMemory(0xFF3A, 0x73);
}

void test_E0_028C()
{
    if (skip_test_E0_028C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEBF0);
    WriteRegisterWord(RegisterType::SP, 0xA925);
    WriteRegisterByte(RegisterType::A, 0x4E);
    WriteRegisterByte(RegisterType::B, 0x6A);
    WriteRegisterByte(RegisterType::C, 0xAF);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0x3E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0C, 0x00);
    WriteMemory(0xEBF1, 0x0C);
    WriteMemory(0xEBF0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4E);
    CheckRegisterByte(RegisterType::B, 0x6A);
    CheckRegisterByte(RegisterType::C, 0xAF);
    CheckRegisterByte(RegisterType::D, 0xA6);
    CheckRegisterByte(RegisterType::E, 0xA5);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0x3E);
    CheckRegisterWord(RegisterType::PC, 0xEBF2);
    CheckRegisterWord(RegisterType::SP, 0xA925);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEBF0, 0xE0);
    CheckMemory(0xEBF1, 0x0C);
    CheckMemory(0xFF0C, 0x4E);
}

void test_E0_028D()
{
    if (skip_test_E0_028D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5689);
    WriteRegisterWord(RegisterType::SP, 0x82ED);
    WriteRegisterByte(RegisterType::A, 0x3A);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0xFA);
    WriteRegisterByte(RegisterType::E, 0xBB);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xF8);
    WriteRegisterByte(RegisterType::L, 0xB2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB4, 0x00);
    WriteMemory(0x568A, 0xB4);
    WriteMemory(0x5689, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3A);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0xFA);
    CheckRegisterByte(RegisterType::E, 0xBB);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xF8);
    CheckRegisterByte(RegisterType::L, 0xB2);
    CheckRegisterWord(RegisterType::PC, 0x568B);
    CheckRegisterWord(RegisterType::SP, 0x82ED);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5689, 0xE0);
    CheckMemory(0x568A, 0xB4);
    CheckMemory(0xFFB4, 0x3A);
}

void test_E0_028E()
{
    if (skip_test_E0_028E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x63C0);
    WriteRegisterWord(RegisterType::SP, 0xC2A7);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0x26);
    WriteRegisterByte(RegisterType::C, 0x3B);
    WriteRegisterByte(RegisterType::D, 0x4C);
    WriteRegisterByte(RegisterType::E, 0x29);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xE8);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF13, 0x00);
    WriteMemory(0x63C1, 0x13);
    WriteMemory(0x63C0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0x26);
    CheckRegisterByte(RegisterType::C, 0x3B);
    CheckRegisterByte(RegisterType::D, 0x4C);
    CheckRegisterByte(RegisterType::E, 0x29);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xE8);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0x63C2);
    CheckRegisterWord(RegisterType::SP, 0xC2A7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x63C0, 0xE0);
    CheckMemory(0x63C1, 0x13);
    CheckMemory(0xFF13, 0x92);
}

void test_E0_028F()
{
    if (skip_test_E0_028F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9C0F);
    WriteRegisterWord(RegisterType::SP, 0xF1AF);
    WriteRegisterByte(RegisterType::A, 0xE4);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0x92);
    WriteRegisterByte(RegisterType::D, 0x58);
    WriteRegisterByte(RegisterType::E, 0xEC);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x1C);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8B, 0x00);
    WriteMemory(0x9C10, 0x8B);
    WriteMemory(0x9C0F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE4);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0x92);
    CheckRegisterByte(RegisterType::D, 0x58);
    CheckRegisterByte(RegisterType::E, 0xEC);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x1C);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0x9C11);
    CheckRegisterWord(RegisterType::SP, 0xF1AF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9C0F, 0xE0);
    CheckMemory(0x9C10, 0x8B);
    CheckMemory(0xFF8B, 0xE4);
}

void test_E0_0290()
{
    if (skip_test_E0_0290)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEEF1);
    WriteRegisterWord(RegisterType::SP, 0xD212);
    WriteRegisterByte(RegisterType::A, 0x3E);
    WriteRegisterByte(RegisterType::B, 0x81);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0x3A);
    WriteRegisterByte(RegisterType::E, 0x58);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x77);
    WriteRegisterByte(RegisterType::L, 0x0C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF93, 0x00);
    WriteMemory(0xEEF2, 0x93);
    WriteMemory(0xEEF1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3E);
    CheckRegisterByte(RegisterType::B, 0x81);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0x3A);
    CheckRegisterByte(RegisterType::E, 0x58);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x77);
    CheckRegisterByte(RegisterType::L, 0x0C);
    CheckRegisterWord(RegisterType::PC, 0xEEF3);
    CheckRegisterWord(RegisterType::SP, 0xD212);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xEEF1, 0xE0);
    CheckMemory(0xEEF2, 0x93);
    CheckMemory(0xFF93, 0x3E);
}

void test_E0_0291()
{
    if (skip_test_E0_0291)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1A1B);
    WriteRegisterWord(RegisterType::SP, 0x1815);
    WriteRegisterByte(RegisterType::A, 0x7B);
    WriteRegisterByte(RegisterType::B, 0x00);
    WriteRegisterByte(RegisterType::C, 0x46);
    WriteRegisterByte(RegisterType::D, 0x8E);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x96);
    WriteRegisterByte(RegisterType::L, 0x83);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF40, 0x00);
    WriteMemory(0x1A1C, 0x40);
    WriteMemory(0x1A1B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7B);
    CheckRegisterByte(RegisterType::B, 0x00);
    CheckRegisterByte(RegisterType::C, 0x46);
    CheckRegisterByte(RegisterType::D, 0x8E);
    CheckRegisterByte(RegisterType::E, 0x0F);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x96);
    CheckRegisterByte(RegisterType::L, 0x83);
    CheckRegisterWord(RegisterType::PC, 0x1A1D);
    CheckRegisterWord(RegisterType::SP, 0x1815);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1A1B, 0xE0);
    CheckMemory(0x1A1C, 0x40);
    CheckMemory(0xFF40, 0x7B);
}

void test_E0_0292()
{
    if (skip_test_E0_0292)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x413A);
    WriteRegisterWord(RegisterType::SP, 0xB41C);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0x65);
    WriteRegisterByte(RegisterType::D, 0xC0);
    WriteRegisterByte(RegisterType::E, 0x43);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x6B);
    WriteRegisterByte(RegisterType::L, 0xD5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF08, 0x00);
    WriteMemory(0x413B, 0x08);
    WriteMemory(0x413A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0x65);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0x43);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x6B);
    CheckRegisterByte(RegisterType::L, 0xD5);
    CheckRegisterWord(RegisterType::PC, 0x413C);
    CheckRegisterWord(RegisterType::SP, 0xB41C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x413A, 0xE0);
    CheckMemory(0x413B, 0x08);
    CheckMemory(0xFF08, 0x69);
}

void test_E0_0293()
{
    if (skip_test_E0_0293)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6F00);
    WriteRegisterWord(RegisterType::SP, 0xC52B);
    WriteRegisterByte(RegisterType::A, 0x36);
    WriteRegisterByte(RegisterType::B, 0xB7);
    WriteRegisterByte(RegisterType::C, 0x83);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0x62);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x36);
    WriteRegisterByte(RegisterType::L, 0x7B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFFC, 0x00);
    WriteMemory(0x6F01, 0xFC);
    WriteMemory(0x6F00, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x36);
    CheckRegisterByte(RegisterType::B, 0xB7);
    CheckRegisterByte(RegisterType::C, 0x83);
    CheckRegisterByte(RegisterType::D, 0xCE);
    CheckRegisterByte(RegisterType::E, 0x62);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x36);
    CheckRegisterByte(RegisterType::L, 0x7B);
    CheckRegisterWord(RegisterType::PC, 0x6F02);
    CheckRegisterWord(RegisterType::SP, 0xC52B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6F00, 0xE0);
    CheckMemory(0x6F01, 0xFC);
    CheckMemory(0xFFFC, 0x36);
}

void test_E0_0294()
{
    if (skip_test_E0_0294)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF02B);
    WriteRegisterWord(RegisterType::SP, 0x8402);
    WriteRegisterByte(RegisterType::A, 0xF6);
    WriteRegisterByte(RegisterType::B, 0xD6);
    WriteRegisterByte(RegisterType::C, 0xE3);
    WriteRegisterByte(RegisterType::D, 0x6B);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x38);
    WriteRegisterByte(RegisterType::L, 0x8F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF89, 0x00);
    WriteMemory(0xF02C, 0x89);
    WriteMemory(0xF02B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF6);
    CheckRegisterByte(RegisterType::B, 0xD6);
    CheckRegisterByte(RegisterType::C, 0xE3);
    CheckRegisterByte(RegisterType::D, 0x6B);
    CheckRegisterByte(RegisterType::E, 0x83);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x38);
    CheckRegisterByte(RegisterType::L, 0x8F);
    CheckRegisterWord(RegisterType::PC, 0xF02D);
    CheckRegisterWord(RegisterType::SP, 0x8402);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF02B, 0xE0);
    CheckMemory(0xF02C, 0x89);
    CheckMemory(0xFF89, 0xF6);
}

void test_E0_0295()
{
    if (skip_test_E0_0295)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1860);
    WriteRegisterWord(RegisterType::SP, 0xD8DA);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0x45);
    WriteRegisterByte(RegisterType::C, 0x86);
    WriteRegisterByte(RegisterType::D, 0x86);
    WriteRegisterByte(RegisterType::E, 0x66);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xC4);
    WriteRegisterByte(RegisterType::L, 0x94);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4A, 0x00);
    WriteMemory(0x1861, 0x4A);
    WriteMemory(0x1860, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0x45);
    CheckRegisterByte(RegisterType::C, 0x86);
    CheckRegisterByte(RegisterType::D, 0x86);
    CheckRegisterByte(RegisterType::E, 0x66);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xC4);
    CheckRegisterByte(RegisterType::L, 0x94);
    CheckRegisterWord(RegisterType::PC, 0x1862);
    CheckRegisterWord(RegisterType::SP, 0xD8DA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1860, 0xE0);
    CheckMemory(0x1861, 0x4A);
    CheckMemory(0xFF4A, 0x24);
}

void test_E0_0296()
{
    if (skip_test_E0_0296)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9C97);
    WriteRegisterWord(RegisterType::SP, 0xDD0D);
    WriteRegisterByte(RegisterType::A, 0x84);
    WriteRegisterByte(RegisterType::B, 0x51);
    WriteRegisterByte(RegisterType::C, 0xB2);
    WriteRegisterByte(RegisterType::D, 0xD9);
    WriteRegisterByte(RegisterType::E, 0x85);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x56);
    WriteRegisterByte(RegisterType::L, 0xF2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA1, 0x00);
    WriteMemory(0x9C98, 0xA1);
    WriteMemory(0x9C97, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x84);
    CheckRegisterByte(RegisterType::B, 0x51);
    CheckRegisterByte(RegisterType::C, 0xB2);
    CheckRegisterByte(RegisterType::D, 0xD9);
    CheckRegisterByte(RegisterType::E, 0x85);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x56);
    CheckRegisterByte(RegisterType::L, 0xF2);
    CheckRegisterWord(RegisterType::PC, 0x9C99);
    CheckRegisterWord(RegisterType::SP, 0xDD0D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9C97, 0xE0);
    CheckMemory(0x9C98, 0xA1);
    CheckMemory(0xFFA1, 0x84);
}

void test_E0_0297()
{
    if (skip_test_E0_0297)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1ACB);
    WriteRegisterWord(RegisterType::SP, 0xD971);
    WriteRegisterByte(RegisterType::A, 0xAB);
    WriteRegisterByte(RegisterType::B, 0xD9);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0xA2);
    WriteRegisterByte(RegisterType::E, 0x88);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xAA);
    WriteRegisterByte(RegisterType::L, 0x78);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF35, 0x00);
    WriteMemory(0x1ACC, 0x35);
    WriteMemory(0x1ACB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAB);
    CheckRegisterByte(RegisterType::B, 0xD9);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0xA2);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xAA);
    CheckRegisterByte(RegisterType::L, 0x78);
    CheckRegisterWord(RegisterType::PC, 0x1ACD);
    CheckRegisterWord(RegisterType::SP, 0xD971);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1ACB, 0xE0);
    CheckMemory(0x1ACC, 0x35);
    CheckMemory(0xFF35, 0xAB);
}

void test_E0_0298()
{
    if (skip_test_E0_0298)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC17B);
    WriteRegisterWord(RegisterType::SP, 0x2664);
    WriteRegisterByte(RegisterType::A, 0xDE);
    WriteRegisterByte(RegisterType::B, 0x8D);
    WriteRegisterByte(RegisterType::C, 0xF3);
    WriteRegisterByte(RegisterType::D, 0xF7);
    WriteRegisterByte(RegisterType::E, 0x88);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x15);
    WriteRegisterByte(RegisterType::L, 0x3C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE6, 0x00);
    WriteMemory(0xC17C, 0xE6);
    WriteMemory(0xC17B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDE);
    CheckRegisterByte(RegisterType::B, 0x8D);
    CheckRegisterByte(RegisterType::C, 0xF3);
    CheckRegisterByte(RegisterType::D, 0xF7);
    CheckRegisterByte(RegisterType::E, 0x88);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x15);
    CheckRegisterByte(RegisterType::L, 0x3C);
    CheckRegisterWord(RegisterType::PC, 0xC17D);
    CheckRegisterWord(RegisterType::SP, 0x2664);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC17B, 0xE0);
    CheckMemory(0xC17C, 0xE6);
    CheckMemory(0xFFE6, 0xDE);
}

void test_E0_0299()
{
    if (skip_test_E0_0299)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9946);
    WriteRegisterWord(RegisterType::SP, 0x2857);
    WriteRegisterByte(RegisterType::A, 0xA8);
    WriteRegisterByte(RegisterType::B, 0xAC);
    WriteRegisterByte(RegisterType::C, 0xC0);
    WriteRegisterByte(RegisterType::D, 0xEF);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xB0);
    WriteRegisterByte(RegisterType::L, 0x4E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB8, 0x00);
    WriteMemory(0x9947, 0xB8);
    WriteMemory(0x9946, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA8);
    CheckRegisterByte(RegisterType::B, 0xAC);
    CheckRegisterByte(RegisterType::C, 0xC0);
    CheckRegisterByte(RegisterType::D, 0xEF);
    CheckRegisterByte(RegisterType::E, 0x30);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xB0);
    CheckRegisterByte(RegisterType::L, 0x4E);
    CheckRegisterWord(RegisterType::PC, 0x9948);
    CheckRegisterWord(RegisterType::SP, 0x2857);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9946, 0xE0);
    CheckMemory(0x9947, 0xB8);
    CheckMemory(0xFFB8, 0xA8);
}

void test_E0_029A()
{
    if (skip_test_E0_029A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA0A8);
    WriteRegisterWord(RegisterType::SP, 0xE7C9);
    WriteRegisterByte(RegisterType::A, 0x81);
    WriteRegisterByte(RegisterType::B, 0x10);
    WriteRegisterByte(RegisterType::C, 0xEF);
    WriteRegisterByte(RegisterType::D, 0xDA);
    WriteRegisterByte(RegisterType::E, 0xA8);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x78);
    WriteRegisterByte(RegisterType::L, 0xCA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEA, 0x00);
    WriteMemory(0xA0A9, 0xEA);
    WriteMemory(0xA0A8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x81);
    CheckRegisterByte(RegisterType::B, 0x10);
    CheckRegisterByte(RegisterType::C, 0xEF);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0xA8);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x78);
    CheckRegisterByte(RegisterType::L, 0xCA);
    CheckRegisterWord(RegisterType::PC, 0xA0AA);
    CheckRegisterWord(RegisterType::SP, 0xE7C9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA0A8, 0xE0);
    CheckMemory(0xA0A9, 0xEA);
    CheckMemory(0xFFEA, 0x81);
}

void test_E0_029B()
{
    if (skip_test_E0_029B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3A4A);
    WriteRegisterWord(RegisterType::SP, 0x3DA9);
    WriteRegisterByte(RegisterType::A, 0xA7);
    WriteRegisterByte(RegisterType::B, 0x32);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0x8C);
    WriteRegisterByte(RegisterType::E, 0x08);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x89);
    WriteRegisterByte(RegisterType::L, 0x48);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF04, 0x00);
    WriteMemory(0x3A4B, 0x04);
    WriteMemory(0x3A4A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA7);
    CheckRegisterByte(RegisterType::B, 0x32);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0x08);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x89);
    CheckRegisterByte(RegisterType::L, 0x48);
    CheckRegisterWord(RegisterType::PC, 0x3A4C);
    CheckRegisterWord(RegisterType::SP, 0x3DA9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3A4A, 0xE0);
    CheckMemory(0x3A4B, 0x04);
    CheckMemory(0xFF04, 0xA7);
}

void test_E0_029C()
{
    if (skip_test_E0_029C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFC62);
    WriteRegisterWord(RegisterType::SP, 0x7E0B);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0x42);
    WriteRegisterByte(RegisterType::C, 0x80);
    WriteRegisterByte(RegisterType::D, 0xCF);
    WriteRegisterByte(RegisterType::E, 0x7C);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xA8);
    WriteRegisterByte(RegisterType::L, 0xC9);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF05, 0x00);
    WriteMemory(0xFC63, 0x05);
    WriteMemory(0xFC62, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0x42);
    CheckRegisterByte(RegisterType::C, 0x80);
    CheckRegisterByte(RegisterType::D, 0xCF);
    CheckRegisterByte(RegisterType::E, 0x7C);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xA8);
    CheckRegisterByte(RegisterType::L, 0xC9);
    CheckRegisterWord(RegisterType::PC, 0xFC64);
    CheckRegisterWord(RegisterType::SP, 0x7E0B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFC62, 0xE0);
    CheckMemory(0xFC63, 0x05);
    CheckMemory(0xFF05, 0x56);
}

void test_E0_029D()
{
    if (skip_test_E0_029D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA38D);
    WriteRegisterWord(RegisterType::SP, 0xC850);
    WriteRegisterByte(RegisterType::A, 0x59);
    WriteRegisterByte(RegisterType::B, 0xA0);
    WriteRegisterByte(RegisterType::C, 0xBF);
    WriteRegisterByte(RegisterType::D, 0xD3);
    WriteRegisterByte(RegisterType::E, 0x93);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xD3);
    WriteRegisterByte(RegisterType::L, 0x1A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF27, 0x00);
    WriteMemory(0xA38E, 0x27);
    WriteMemory(0xA38D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x59);
    CheckRegisterByte(RegisterType::B, 0xA0);
    CheckRegisterByte(RegisterType::C, 0xBF);
    CheckRegisterByte(RegisterType::D, 0xD3);
    CheckRegisterByte(RegisterType::E, 0x93);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xD3);
    CheckRegisterByte(RegisterType::L, 0x1A);
    CheckRegisterWord(RegisterType::PC, 0xA38F);
    CheckRegisterWord(RegisterType::SP, 0xC850);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA38D, 0xE0);
    CheckMemory(0xA38E, 0x27);
    CheckMemory(0xFF27, 0x59);
}

void test_E0_029E()
{
    if (skip_test_E0_029E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEFBE);
    WriteRegisterWord(RegisterType::SP, 0x9CFD);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0x8A);
    WriteRegisterByte(RegisterType::C, 0x51);
    WriteRegisterByte(RegisterType::D, 0x84);
    WriteRegisterByte(RegisterType::E, 0x6D);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xDD);
    WriteRegisterByte(RegisterType::L, 0x01);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA5, 0x00);
    WriteMemory(0xEFBF, 0xA5);
    WriteMemory(0xEFBE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0x8A);
    CheckRegisterByte(RegisterType::C, 0x51);
    CheckRegisterByte(RegisterType::D, 0x84);
    CheckRegisterByte(RegisterType::E, 0x6D);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xDD);
    CheckRegisterByte(RegisterType::L, 0x01);
    CheckRegisterWord(RegisterType::PC, 0xEFC0);
    CheckRegisterWord(RegisterType::SP, 0x9CFD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xEFBE, 0xE0);
    CheckMemory(0xEFBF, 0xA5);
    CheckMemory(0xFFA5, 0xC7);
}

void test_E0_029F()
{
    if (skip_test_E0_029F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x88B8);
    WriteRegisterWord(RegisterType::SP, 0x9ED1);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0x7E);
    WriteRegisterByte(RegisterType::C, 0x6B);
    WriteRegisterByte(RegisterType::D, 0xC4);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xB3);
    WriteRegisterByte(RegisterType::L, 0x47);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF69, 0x00);
    WriteMemory(0x88B9, 0x69);
    WriteMemory(0x88B8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0x7E);
    CheckRegisterByte(RegisterType::C, 0x6B);
    CheckRegisterByte(RegisterType::D, 0xC4);
    CheckRegisterByte(RegisterType::E, 0xDC);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xB3);
    CheckRegisterByte(RegisterType::L, 0x47);
    CheckRegisterWord(RegisterType::PC, 0x88BA);
    CheckRegisterWord(RegisterType::SP, 0x9ED1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x88B8, 0xE0);
    CheckMemory(0x88B9, 0x69);
    CheckMemory(0xFF69, 0xD1);
}

void test_E0_02A0()
{
    if (skip_test_E0_02A0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD136);
    WriteRegisterWord(RegisterType::SP, 0x85AB);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0xEA);
    WriteRegisterByte(RegisterType::C, 0xE5);
    WriteRegisterByte(RegisterType::D, 0x0B);
    WriteRegisterByte(RegisterType::E, 0x7B);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x51);
    WriteRegisterByte(RegisterType::L, 0xB8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC9, 0x00);
    WriteMemory(0xD137, 0xC9);
    WriteMemory(0xD136, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0xEA);
    CheckRegisterByte(RegisterType::C, 0xE5);
    CheckRegisterByte(RegisterType::D, 0x0B);
    CheckRegisterByte(RegisterType::E, 0x7B);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x51);
    CheckRegisterByte(RegisterType::L, 0xB8);
    CheckRegisterWord(RegisterType::PC, 0xD138);
    CheckRegisterWord(RegisterType::SP, 0x85AB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD136, 0xE0);
    CheckMemory(0xD137, 0xC9);
    CheckMemory(0xFFC9, 0x44);
}

void test_E0_02A1()
{
    if (skip_test_E0_02A1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x597A);
    WriteRegisterWord(RegisterType::SP, 0xE382);
    WriteRegisterByte(RegisterType::A, 0x4D);
    WriteRegisterByte(RegisterType::B, 0x56);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0xD5);
    WriteRegisterByte(RegisterType::E, 0x66);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0xB6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF55, 0x00);
    WriteMemory(0x597B, 0x55);
    WriteMemory(0x597A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4D);
    CheckRegisterByte(RegisterType::B, 0x56);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0xD5);
    CheckRegisterByte(RegisterType::E, 0x66);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0xB6);
    CheckRegisterWord(RegisterType::PC, 0x597C);
    CheckRegisterWord(RegisterType::SP, 0xE382);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x597A, 0xE0);
    CheckMemory(0x597B, 0x55);
    CheckMemory(0xFF55, 0x4D);
}

void test_E0_02A2()
{
    if (skip_test_E0_02A2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB106);
    WriteRegisterWord(RegisterType::SP, 0xEC01);
    WriteRegisterByte(RegisterType::A, 0x7A);
    WriteRegisterByte(RegisterType::B, 0x8A);
    WriteRegisterByte(RegisterType::C, 0xA3);
    WriteRegisterByte(RegisterType::D, 0x8E);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x6F);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA5, 0x00);
    WriteMemory(0xB107, 0xA5);
    WriteMemory(0xB106, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7A);
    CheckRegisterByte(RegisterType::B, 0x8A);
    CheckRegisterByte(RegisterType::C, 0xA3);
    CheckRegisterByte(RegisterType::D, 0x8E);
    CheckRegisterByte(RegisterType::E, 0x83);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x6F);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0xB108);
    CheckRegisterWord(RegisterType::SP, 0xEC01);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB106, 0xE0);
    CheckMemory(0xB107, 0xA5);
    CheckMemory(0xFFA5, 0x7A);
}

void test_E0_02A3()
{
    if (skip_test_E0_02A3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA757);
    WriteRegisterWord(RegisterType::SP, 0x8B35);
    WriteRegisterByte(RegisterType::A, 0x40);
    WriteRegisterByte(RegisterType::B, 0x6C);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0x02);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x19);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF9, 0x00);
    WriteMemory(0xA758, 0xF9);
    WriteMemory(0xA757, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x40);
    CheckRegisterByte(RegisterType::B, 0x6C);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0xF5);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x19);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0xA759);
    CheckRegisterWord(RegisterType::SP, 0x8B35);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA757, 0xE0);
    CheckMemory(0xA758, 0xF9);
    CheckMemory(0xFFF9, 0x40);
}

void test_E0_02A4()
{
    if (skip_test_E0_02A4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDCD4);
    WriteRegisterWord(RegisterType::SP, 0xDADF);
    WriteRegisterByte(RegisterType::A, 0x85);
    WriteRegisterByte(RegisterType::B, 0xAC);
    WriteRegisterByte(RegisterType::C, 0xFD);
    WriteRegisterByte(RegisterType::D, 0xFF);
    WriteRegisterByte(RegisterType::E, 0x77);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0xB8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF37, 0x00);
    WriteMemory(0xDCD5, 0x37);
    WriteMemory(0xDCD4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x85);
    CheckRegisterByte(RegisterType::B, 0xAC);
    CheckRegisterByte(RegisterType::C, 0xFD);
    CheckRegisterByte(RegisterType::D, 0xFF);
    CheckRegisterByte(RegisterType::E, 0x77);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0xB8);
    CheckRegisterWord(RegisterType::PC, 0xDCD6);
    CheckRegisterWord(RegisterType::SP, 0xDADF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDCD4, 0xE0);
    CheckMemory(0xDCD5, 0x37);
    CheckMemory(0xFF37, 0x85);
}

void test_E0_02A5()
{
    if (skip_test_E0_02A5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCA83);
    WriteRegisterWord(RegisterType::SP, 0xF91B);
    WriteRegisterByte(RegisterType::A, 0x2D);
    WriteRegisterByte(RegisterType::B, 0xFD);
    WriteRegisterByte(RegisterType::C, 0x54);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0x1A);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xAE);
    WriteRegisterByte(RegisterType::L, 0xAC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF22, 0x00);
    WriteMemory(0xCA84, 0x22);
    WriteMemory(0xCA83, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2D);
    CheckRegisterByte(RegisterType::B, 0xFD);
    CheckRegisterByte(RegisterType::C, 0x54);
    CheckRegisterByte(RegisterType::D, 0xD4);
    CheckRegisterByte(RegisterType::E, 0x1A);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xAE);
    CheckRegisterByte(RegisterType::L, 0xAC);
    CheckRegisterWord(RegisterType::PC, 0xCA85);
    CheckRegisterWord(RegisterType::SP, 0xF91B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCA83, 0xE0);
    CheckMemory(0xCA84, 0x22);
    CheckMemory(0xFF22, 0x2D);
}

void test_E0_02A6()
{
    if (skip_test_E0_02A6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF25C);
    WriteRegisterWord(RegisterType::SP, 0xDA4A);
    WriteRegisterByte(RegisterType::A, 0xEF);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0x9F);
    WriteRegisterByte(RegisterType::E, 0x50);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x0A);
    WriteRegisterByte(RegisterType::L, 0x8B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA7, 0x00);
    WriteMemory(0xF25D, 0xA7);
    WriteMemory(0xF25C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEF);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0x50);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x0A);
    CheckRegisterByte(RegisterType::L, 0x8B);
    CheckRegisterWord(RegisterType::PC, 0xF25E);
    CheckRegisterWord(RegisterType::SP, 0xDA4A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF25C, 0xE0);
    CheckMemory(0xF25D, 0xA7);
    CheckMemory(0xFFA7, 0xEF);
}

void test_E0_02A7()
{
    if (skip_test_E0_02A7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x55EF);
    WriteRegisterWord(RegisterType::SP, 0xA94F);
    WriteRegisterByte(RegisterType::A, 0x06);
    WriteRegisterByte(RegisterType::B, 0x12);
    WriteRegisterByte(RegisterType::C, 0xA2);
    WriteRegisterByte(RegisterType::D, 0x23);
    WriteRegisterByte(RegisterType::E, 0xD9);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xB5);
    WriteRegisterByte(RegisterType::L, 0x57);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF47, 0x00);
    WriteMemory(0x55F0, 0x47);
    WriteMemory(0x55EF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x06);
    CheckRegisterByte(RegisterType::B, 0x12);
    CheckRegisterByte(RegisterType::C, 0xA2);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0xD9);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xB5);
    CheckRegisterByte(RegisterType::L, 0x57);
    CheckRegisterWord(RegisterType::PC, 0x55F1);
    CheckRegisterWord(RegisterType::SP, 0xA94F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x55EF, 0xE0);
    CheckMemory(0x55F0, 0x47);
    CheckMemory(0xFF47, 0x06);
}

void test_E0_02A8()
{
    if (skip_test_E0_02A8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7364);
    WriteRegisterWord(RegisterType::SP, 0xE273);
    WriteRegisterByte(RegisterType::A, 0xA2);
    WriteRegisterByte(RegisterType::B, 0x13);
    WriteRegisterByte(RegisterType::C, 0x3D);
    WriteRegisterByte(RegisterType::D, 0x07);
    WriteRegisterByte(RegisterType::E, 0x3A);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x8C);
    WriteRegisterByte(RegisterType::L, 0x88);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB5, 0x00);
    WriteMemory(0x7365, 0xB5);
    WriteMemory(0x7364, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA2);
    CheckRegisterByte(RegisterType::B, 0x13);
    CheckRegisterByte(RegisterType::C, 0x3D);
    CheckRegisterByte(RegisterType::D, 0x07);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x8C);
    CheckRegisterByte(RegisterType::L, 0x88);
    CheckRegisterWord(RegisterType::PC, 0x7366);
    CheckRegisterWord(RegisterType::SP, 0xE273);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7364, 0xE0);
    CheckMemory(0x7365, 0xB5);
    CheckMemory(0xFFB5, 0xA2);
}

void test_E0_02A9()
{
    if (skip_test_E0_02A9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC2FB);
    WriteRegisterWord(RegisterType::SP, 0x390F);
    WriteRegisterByte(RegisterType::A, 0x76);
    WriteRegisterByte(RegisterType::B, 0x54);
    WriteRegisterByte(RegisterType::C, 0xF9);
    WriteRegisterByte(RegisterType::D, 0x36);
    WriteRegisterByte(RegisterType::E, 0x47);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x47);
    WriteRegisterByte(RegisterType::L, 0x4F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB2, 0x00);
    WriteMemory(0xC2FC, 0xB2);
    WriteMemory(0xC2FB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x76);
    CheckRegisterByte(RegisterType::B, 0x54);
    CheckRegisterByte(RegisterType::C, 0xF9);
    CheckRegisterByte(RegisterType::D, 0x36);
    CheckRegisterByte(RegisterType::E, 0x47);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x47);
    CheckRegisterByte(RegisterType::L, 0x4F);
    CheckRegisterWord(RegisterType::PC, 0xC2FD);
    CheckRegisterWord(RegisterType::SP, 0x390F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC2FB, 0xE0);
    CheckMemory(0xC2FC, 0xB2);
    CheckMemory(0xFFB2, 0x76);
}

void test_E0_02AA()
{
    if (skip_test_E0_02AA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCD30);
    WriteRegisterWord(RegisterType::SP, 0x06DA);
    WriteRegisterByte(RegisterType::A, 0x54);
    WriteRegisterByte(RegisterType::B, 0xC9);
    WriteRegisterByte(RegisterType::C, 0x61);
    WriteRegisterByte(RegisterType::D, 0x47);
    WriteRegisterByte(RegisterType::E, 0x18);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x54);
    WriteRegisterByte(RegisterType::L, 0x10);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF32, 0x00);
    WriteMemory(0xCD31, 0x32);
    WriteMemory(0xCD30, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x54);
    CheckRegisterByte(RegisterType::B, 0xC9);
    CheckRegisterByte(RegisterType::C, 0x61);
    CheckRegisterByte(RegisterType::D, 0x47);
    CheckRegisterByte(RegisterType::E, 0x18);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x54);
    CheckRegisterByte(RegisterType::L, 0x10);
    CheckRegisterWord(RegisterType::PC, 0xCD32);
    CheckRegisterWord(RegisterType::SP, 0x06DA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCD30, 0xE0);
    CheckMemory(0xCD31, 0x32);
    CheckMemory(0xFF32, 0x54);
}

void test_E0_02AB()
{
    if (skip_test_E0_02AB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFB2C);
    WriteRegisterWord(RegisterType::SP, 0x6887);
    WriteRegisterByte(RegisterType::A, 0x1F);
    WriteRegisterByte(RegisterType::B, 0x01);
    WriteRegisterByte(RegisterType::C, 0x77);
    WriteRegisterByte(RegisterType::D, 0x79);
    WriteRegisterByte(RegisterType::E, 0xF4);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x87);
    WriteRegisterByte(RegisterType::L, 0x39);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF55, 0x00);
    WriteMemory(0xFB2D, 0x55);
    WriteMemory(0xFB2C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1F);
    CheckRegisterByte(RegisterType::B, 0x01);
    CheckRegisterByte(RegisterType::C, 0x77);
    CheckRegisterByte(RegisterType::D, 0x79);
    CheckRegisterByte(RegisterType::E, 0xF4);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x87);
    CheckRegisterByte(RegisterType::L, 0x39);
    CheckRegisterWord(RegisterType::PC, 0xFB2E);
    CheckRegisterWord(RegisterType::SP, 0x6887);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFB2C, 0xE0);
    CheckMemory(0xFB2D, 0x55);
    CheckMemory(0xFF55, 0x1F);
}

void test_E0_02AC()
{
    if (skip_test_E0_02AC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0CBE);
    WriteRegisterWord(RegisterType::SP, 0x03DB);
    WriteRegisterByte(RegisterType::A, 0x71);
    WriteRegisterByte(RegisterType::B, 0x4C);
    WriteRegisterByte(RegisterType::C, 0xB0);
    WriteRegisterByte(RegisterType::D, 0x76);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xA8);
    WriteRegisterByte(RegisterType::L, 0xBB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF83, 0x00);
    WriteMemory(0x0CBF, 0x83);
    WriteMemory(0x0CBE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x71);
    CheckRegisterByte(RegisterType::B, 0x4C);
    CheckRegisterByte(RegisterType::C, 0xB0);
    CheckRegisterByte(RegisterType::D, 0x76);
    CheckRegisterByte(RegisterType::E, 0xF5);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xA8);
    CheckRegisterByte(RegisterType::L, 0xBB);
    CheckRegisterWord(RegisterType::PC, 0x0CC0);
    CheckRegisterWord(RegisterType::SP, 0x03DB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0CBE, 0xE0);
    CheckMemory(0x0CBF, 0x83);
    CheckMemory(0xFF83, 0x71);
}

void test_E0_02AD()
{
    if (skip_test_E0_02AD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCF0C);
    WriteRegisterWord(RegisterType::SP, 0x3558);
    WriteRegisterByte(RegisterType::A, 0x9D);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0x8D);
    WriteRegisterByte(RegisterType::D, 0x69);
    WriteRegisterByte(RegisterType::E, 0xCC);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x51);
    WriteRegisterByte(RegisterType::L, 0x6E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF63, 0x00);
    WriteMemory(0xCF0D, 0x63);
    WriteMemory(0xCF0C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9D);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0x8D);
    CheckRegisterByte(RegisterType::D, 0x69);
    CheckRegisterByte(RegisterType::E, 0xCC);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x51);
    CheckRegisterByte(RegisterType::L, 0x6E);
    CheckRegisterWord(RegisterType::PC, 0xCF0E);
    CheckRegisterWord(RegisterType::SP, 0x3558);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xCF0C, 0xE0);
    CheckMemory(0xCF0D, 0x63);
    CheckMemory(0xFF63, 0x9D);
}

void test_E0_02AE()
{
    if (skip_test_E0_02AE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8A1B);
    WriteRegisterWord(RegisterType::SP, 0xC497);
    WriteRegisterByte(RegisterType::A, 0xB1);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0x0D);
    WriteRegisterByte(RegisterType::D, 0x42);
    WriteRegisterByte(RegisterType::E, 0x1B);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xB8);
    WriteRegisterByte(RegisterType::L, 0x1F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCB, 0x00);
    WriteMemory(0x8A1C, 0xCB);
    WriteMemory(0x8A1B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB1);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0x0D);
    CheckRegisterByte(RegisterType::D, 0x42);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xB8);
    CheckRegisterByte(RegisterType::L, 0x1F);
    CheckRegisterWord(RegisterType::PC, 0x8A1D);
    CheckRegisterWord(RegisterType::SP, 0xC497);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8A1B, 0xE0);
    CheckMemory(0x8A1C, 0xCB);
    CheckMemory(0xFFCB, 0xB1);
}

void test_E0_02AF()
{
    if (skip_test_E0_02AF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA1B2);
    WriteRegisterWord(RegisterType::SP, 0x3CD4);
    WriteRegisterByte(RegisterType::A, 0x4C);
    WriteRegisterByte(RegisterType::B, 0xA8);
    WriteRegisterByte(RegisterType::C, 0xA8);
    WriteRegisterByte(RegisterType::D, 0x6E);
    WriteRegisterByte(RegisterType::E, 0x8C);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x67);
    WriteRegisterByte(RegisterType::L, 0x22);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF8A, 0x00);
    WriteMemory(0xA1B3, 0x8A);
    WriteMemory(0xA1B2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4C);
    CheckRegisterByte(RegisterType::B, 0xA8);
    CheckRegisterByte(RegisterType::C, 0xA8);
    CheckRegisterByte(RegisterType::D, 0x6E);
    CheckRegisterByte(RegisterType::E, 0x8C);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x67);
    CheckRegisterByte(RegisterType::L, 0x22);
    CheckRegisterWord(RegisterType::PC, 0xA1B4);
    CheckRegisterWord(RegisterType::SP, 0x3CD4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA1B2, 0xE0);
    CheckMemory(0xA1B3, 0x8A);
    CheckMemory(0xFF8A, 0x4C);
}

void test_E0_02B0()
{
    if (skip_test_E0_02B0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9626);
    WriteRegisterWord(RegisterType::SP, 0x69FE);
    WriteRegisterByte(RegisterType::A, 0xD3);
    WriteRegisterByte(RegisterType::B, 0x25);
    WriteRegisterByte(RegisterType::C, 0x42);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x4D);
    WriteRegisterByte(RegisterType::L, 0x90);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF7D, 0x00);
    WriteMemory(0x9627, 0x7D);
    WriteMemory(0x9626, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD3);
    CheckRegisterByte(RegisterType::B, 0x25);
    CheckRegisterByte(RegisterType::C, 0x42);
    CheckRegisterByte(RegisterType::D, 0xA6);
    CheckRegisterByte(RegisterType::E, 0xE5);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x4D);
    CheckRegisterByte(RegisterType::L, 0x90);
    CheckRegisterWord(RegisterType::PC, 0x9628);
    CheckRegisterWord(RegisterType::SP, 0x69FE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9626, 0xE0);
    CheckMemory(0x9627, 0x7D);
    CheckMemory(0xFF7D, 0xD3);
}

void test_E0_02B1()
{
    if (skip_test_E0_02B1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA789);
    WriteRegisterWord(RegisterType::SP, 0x2454);
    WriteRegisterByte(RegisterType::A, 0x38);
    WriteRegisterByte(RegisterType::B, 0xC1);
    WriteRegisterByte(RegisterType::C, 0x32);
    WriteRegisterByte(RegisterType::D, 0x6C);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xCB);
    WriteRegisterByte(RegisterType::L, 0xF3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF3E, 0x00);
    WriteMemory(0xA78A, 0x3E);
    WriteMemory(0xA789, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x38);
    CheckRegisterByte(RegisterType::B, 0xC1);
    CheckRegisterByte(RegisterType::C, 0x32);
    CheckRegisterByte(RegisterType::D, 0x6C);
    CheckRegisterByte(RegisterType::E, 0x30);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xCB);
    CheckRegisterByte(RegisterType::L, 0xF3);
    CheckRegisterWord(RegisterType::PC, 0xA78B);
    CheckRegisterWord(RegisterType::SP, 0x2454);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA789, 0xE0);
    CheckMemory(0xA78A, 0x3E);
    CheckMemory(0xFF3E, 0x38);
}

void test_E0_02B2()
{
    if (skip_test_E0_02B2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1F91);
    WriteRegisterWord(RegisterType::SP, 0x5F22);
    WriteRegisterByte(RegisterType::A, 0x4C);
    WriteRegisterByte(RegisterType::B, 0x99);
    WriteRegisterByte(RegisterType::C, 0x2B);
    WriteRegisterByte(RegisterType::D, 0xDA);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xED);
    WriteRegisterByte(RegisterType::L, 0x2A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD9, 0x00);
    WriteMemory(0x1F92, 0xD9);
    WriteMemory(0x1F91, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4C);
    CheckRegisterByte(RegisterType::B, 0x99);
    CheckRegisterByte(RegisterType::C, 0x2B);
    CheckRegisterByte(RegisterType::D, 0xDA);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xED);
    CheckRegisterByte(RegisterType::L, 0x2A);
    CheckRegisterWord(RegisterType::PC, 0x1F93);
    CheckRegisterWord(RegisterType::SP, 0x5F22);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1F91, 0xE0);
    CheckMemory(0x1F92, 0xD9);
    CheckMemory(0xFFD9, 0x4C);
}

void test_E0_02B3()
{
    if (skip_test_E0_02B3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4797);
    WriteRegisterWord(RegisterType::SP, 0xC7BD);
    WriteRegisterByte(RegisterType::A, 0xD7);
    WriteRegisterByte(RegisterType::B, 0x3A);
    WriteRegisterByte(RegisterType::C, 0xEB);
    WriteRegisterByte(RegisterType::D, 0xCA);
    WriteRegisterByte(RegisterType::E, 0x5F);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x7E);
    WriteRegisterByte(RegisterType::L, 0x38);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF81, 0x00);
    WriteMemory(0x4798, 0x81);
    WriteMemory(0x4797, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD7);
    CheckRegisterByte(RegisterType::B, 0x3A);
    CheckRegisterByte(RegisterType::C, 0xEB);
    CheckRegisterByte(RegisterType::D, 0xCA);
    CheckRegisterByte(RegisterType::E, 0x5F);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x7E);
    CheckRegisterByte(RegisterType::L, 0x38);
    CheckRegisterWord(RegisterType::PC, 0x4799);
    CheckRegisterWord(RegisterType::SP, 0xC7BD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4797, 0xE0);
    CheckMemory(0x4798, 0x81);
    CheckMemory(0xFF81, 0xD7);
}

void test_E0_02B4()
{
    if (skip_test_E0_02B4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x63D5);
    WriteRegisterWord(RegisterType::SP, 0xA284);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0x53);
    WriteRegisterByte(RegisterType::C, 0x62);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0x4B);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0x8C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3F, 0x00);
    WriteMemory(0x63D6, 0x3F);
    WriteMemory(0x63D5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0x53);
    CheckRegisterByte(RegisterType::C, 0x62);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0x4B);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0x8C);
    CheckRegisterWord(RegisterType::PC, 0x63D7);
    CheckRegisterWord(RegisterType::SP, 0xA284);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x63D5, 0xE0);
    CheckMemory(0x63D6, 0x3F);
    CheckMemory(0xFF3F, 0xD9);
}

void test_E0_02B5()
{
    if (skip_test_E0_02B5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1D91);
    WriteRegisterWord(RegisterType::SP, 0x92E1);
    WriteRegisterByte(RegisterType::A, 0xA2);
    WriteRegisterByte(RegisterType::B, 0x51);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0x02);
    WriteRegisterByte(RegisterType::E, 0x08);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xE9);
    WriteRegisterByte(RegisterType::L, 0x3C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB5, 0x00);
    WriteMemory(0x1D92, 0xB5);
    WriteMemory(0x1D91, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA2);
    CheckRegisterByte(RegisterType::B, 0x51);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0x08);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xE9);
    CheckRegisterByte(RegisterType::L, 0x3C);
    CheckRegisterWord(RegisterType::PC, 0x1D93);
    CheckRegisterWord(RegisterType::SP, 0x92E1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1D91, 0xE0);
    CheckMemory(0x1D92, 0xB5);
    CheckMemory(0xFFB5, 0xA2);
}

void test_E0_02B6()
{
    if (skip_test_E0_02B6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xACB6);
    WriteRegisterWord(RegisterType::SP, 0x6978);
    WriteRegisterByte(RegisterType::A, 0xFD);
    WriteRegisterByte(RegisterType::B, 0x4B);
    WriteRegisterByte(RegisterType::C, 0xCE);
    WriteRegisterByte(RegisterType::D, 0x66);
    WriteRegisterByte(RegisterType::E, 0x8E);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x27);
    WriteRegisterByte(RegisterType::L, 0xA4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF77, 0x00);
    WriteMemory(0xACB7, 0x77);
    WriteMemory(0xACB6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFD);
    CheckRegisterByte(RegisterType::B, 0x4B);
    CheckRegisterByte(RegisterType::C, 0xCE);
    CheckRegisterByte(RegisterType::D, 0x66);
    CheckRegisterByte(RegisterType::E, 0x8E);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x27);
    CheckRegisterByte(RegisterType::L, 0xA4);
    CheckRegisterWord(RegisterType::PC, 0xACB8);
    CheckRegisterWord(RegisterType::SP, 0x6978);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xACB6, 0xE0);
    CheckMemory(0xACB7, 0x77);
    CheckMemory(0xFF77, 0xFD);
}

void test_E0_02B7()
{
    if (skip_test_E0_02B7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x62FD);
    WriteRegisterWord(RegisterType::SP, 0x880C);
    WriteRegisterByte(RegisterType::A, 0xAB);
    WriteRegisterByte(RegisterType::B, 0x51);
    WriteRegisterByte(RegisterType::C, 0x89);
    WriteRegisterByte(RegisterType::D, 0x5C);
    WriteRegisterByte(RegisterType::E, 0x1D);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x6D);
    WriteRegisterByte(RegisterType::L, 0x12);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4F, 0x00);
    WriteMemory(0x62FE, 0x4F);
    WriteMemory(0x62FD, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAB);
    CheckRegisterByte(RegisterType::B, 0x51);
    CheckRegisterByte(RegisterType::C, 0x89);
    CheckRegisterByte(RegisterType::D, 0x5C);
    CheckRegisterByte(RegisterType::E, 0x1D);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x6D);
    CheckRegisterByte(RegisterType::L, 0x12);
    CheckRegisterWord(RegisterType::PC, 0x62FF);
    CheckRegisterWord(RegisterType::SP, 0x880C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x62FD, 0xE0);
    CheckMemory(0x62FE, 0x4F);
    CheckMemory(0xFF4F, 0xAB);
}

void test_E0_02B8()
{
    if (skip_test_E0_02B8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6556);
    WriteRegisterWord(RegisterType::SP, 0x1D5C);
    WriteRegisterByte(RegisterType::A, 0x12);
    WriteRegisterByte(RegisterType::B, 0x8E);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0x25);
    WriteRegisterByte(RegisterType::E, 0x6C);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xB9);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD0, 0x00);
    WriteMemory(0x6557, 0xD0);
    WriteMemory(0x6556, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x12);
    CheckRegisterByte(RegisterType::B, 0x8E);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0x25);
    CheckRegisterByte(RegisterType::E, 0x6C);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xB9);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0x6558);
    CheckRegisterWord(RegisterType::SP, 0x1D5C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6556, 0xE0);
    CheckMemory(0x6557, 0xD0);
    CheckMemory(0xFFD0, 0x12);
}

void test_E0_02B9()
{
    if (skip_test_E0_02B9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6EB7);
    WriteRegisterWord(RegisterType::SP, 0xF2C0);
    WriteRegisterByte(RegisterType::A, 0x26);
    WriteRegisterByte(RegisterType::B, 0x15);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xD6);
    WriteRegisterByte(RegisterType::L, 0xF8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFEB, 0x00);
    WriteMemory(0x6EB8, 0xEB);
    WriteMemory(0x6EB7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x26);
    CheckRegisterByte(RegisterType::B, 0x15);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0x74);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xD6);
    CheckRegisterByte(RegisterType::L, 0xF8);
    CheckRegisterWord(RegisterType::PC, 0x6EB9);
    CheckRegisterWord(RegisterType::SP, 0xF2C0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6EB7, 0xE0);
    CheckMemory(0x6EB8, 0xEB);
    CheckMemory(0xFFEB, 0x26);
}

void test_E0_02BA()
{
    if (skip_test_E0_02BA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDE6C);
    WriteRegisterWord(RegisterType::SP, 0xFC61);
    WriteRegisterByte(RegisterType::A, 0xE4);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x31);
    WriteRegisterByte(RegisterType::D, 0x1C);
    WriteRegisterByte(RegisterType::E, 0xC6);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x7D);
    WriteRegisterByte(RegisterType::L, 0x3D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDB, 0x00);
    WriteMemory(0xDE6D, 0xDB);
    WriteMemory(0xDE6C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE4);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x31);
    CheckRegisterByte(RegisterType::D, 0x1C);
    CheckRegisterByte(RegisterType::E, 0xC6);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x7D);
    CheckRegisterByte(RegisterType::L, 0x3D);
    CheckRegisterWord(RegisterType::PC, 0xDE6E);
    CheckRegisterWord(RegisterType::SP, 0xFC61);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDE6C, 0xE0);
    CheckMemory(0xDE6D, 0xDB);
    CheckMemory(0xFFDB, 0xE4);
}

void test_E0_02BB()
{
    if (skip_test_E0_02BB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0711);
    WriteRegisterWord(RegisterType::SP, 0x793C);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0x5A);
    WriteRegisterByte(RegisterType::C, 0x0D);
    WriteRegisterByte(RegisterType::D, 0x5B);
    WriteRegisterByte(RegisterType::E, 0xFC);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xB7);
    WriteRegisterByte(RegisterType::L, 0xB9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4E, 0x00);
    WriteMemory(0x0712, 0x4E);
    WriteMemory(0x0711, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0x5A);
    CheckRegisterByte(RegisterType::C, 0x0D);
    CheckRegisterByte(RegisterType::D, 0x5B);
    CheckRegisterByte(RegisterType::E, 0xFC);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xB7);
    CheckRegisterByte(RegisterType::L, 0xB9);
    CheckRegisterWord(RegisterType::PC, 0x0713);
    CheckRegisterWord(RegisterType::SP, 0x793C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0711, 0xE0);
    CheckMemory(0x0712, 0x4E);
    CheckMemory(0xFF4E, 0x92);
}

void test_E0_02BC()
{
    if (skip_test_E0_02BC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD584);
    WriteRegisterWord(RegisterType::SP, 0xF747);
    WriteRegisterByte(RegisterType::A, 0x03);
    WriteRegisterByte(RegisterType::B, 0xD5);
    WriteRegisterByte(RegisterType::C, 0x87);
    WriteRegisterByte(RegisterType::D, 0xC1);
    WriteRegisterByte(RegisterType::E, 0xFC);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x81);
    WriteRegisterByte(RegisterType::L, 0xB4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB5, 0x00);
    WriteMemory(0xD585, 0xB5);
    WriteMemory(0xD584, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x03);
    CheckRegisterByte(RegisterType::B, 0xD5);
    CheckRegisterByte(RegisterType::C, 0x87);
    CheckRegisterByte(RegisterType::D, 0xC1);
    CheckRegisterByte(RegisterType::E, 0xFC);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x81);
    CheckRegisterByte(RegisterType::L, 0xB4);
    CheckRegisterWord(RegisterType::PC, 0xD586);
    CheckRegisterWord(RegisterType::SP, 0xF747);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD584, 0xE0);
    CheckMemory(0xD585, 0xB5);
    CheckMemory(0xFFB5, 0x03);
}

void test_E0_02BD()
{
    if (skip_test_E0_02BD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE9F9);
    WriteRegisterWord(RegisterType::SP, 0xA7BC);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0xA0);
    WriteRegisterByte(RegisterType::C, 0x1A);
    WriteRegisterByte(RegisterType::D, 0x23);
    WriteRegisterByte(RegisterType::E, 0x2A);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x9F);
    WriteRegisterByte(RegisterType::L, 0x59);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE0, 0x00);
    WriteMemory(0xE9FA, 0xE0);
    WriteMemory(0xE9F9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0xA0);
    CheckRegisterByte(RegisterType::C, 0x1A);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0x2A);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x9F);
    CheckRegisterByte(RegisterType::L, 0x59);
    CheckRegisterWord(RegisterType::PC, 0xE9FB);
    CheckRegisterWord(RegisterType::SP, 0xA7BC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE9F9, 0xE0);
    CheckMemory(0xE9FA, 0xE0);
    CheckMemory(0xFFE0, 0x9B);
}

void test_E0_02BE()
{
    if (skip_test_E0_02BE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1BEF);
    WriteRegisterWord(RegisterType::SP, 0x6F36);
    WriteRegisterByte(RegisterType::A, 0x46);
    WriteRegisterByte(RegisterType::B, 0xE9);
    WriteRegisterByte(RegisterType::C, 0x0F);
    WriteRegisterByte(RegisterType::D, 0x36);
    WriteRegisterByte(RegisterType::E, 0xCD);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xDD);
    WriteRegisterByte(RegisterType::L, 0x63);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF91, 0x00);
    WriteMemory(0x1BF0, 0x91);
    WriteMemory(0x1BEF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x46);
    CheckRegisterByte(RegisterType::B, 0xE9);
    CheckRegisterByte(RegisterType::C, 0x0F);
    CheckRegisterByte(RegisterType::D, 0x36);
    CheckRegisterByte(RegisterType::E, 0xCD);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xDD);
    CheckRegisterByte(RegisterType::L, 0x63);
    CheckRegisterWord(RegisterType::PC, 0x1BF1);
    CheckRegisterWord(RegisterType::SP, 0x6F36);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1BEF, 0xE0);
    CheckMemory(0x1BF0, 0x91);
    CheckMemory(0xFF91, 0x46);
}

void test_E0_02BF()
{
    if (skip_test_E0_02BF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB578);
    WriteRegisterWord(RegisterType::SP, 0x368F);
    WriteRegisterByte(RegisterType::A, 0x22);
    WriteRegisterByte(RegisterType::B, 0x58);
    WriteRegisterByte(RegisterType::C, 0xD8);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0xB9);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x9C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF76, 0x00);
    WriteMemory(0xB579, 0x76);
    WriteMemory(0xB578, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x22);
    CheckRegisterByte(RegisterType::B, 0x58);
    CheckRegisterByte(RegisterType::C, 0xD8);
    CheckRegisterByte(RegisterType::D, 0xCE);
    CheckRegisterByte(RegisterType::E, 0xB9);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x9C);
    CheckRegisterWord(RegisterType::PC, 0xB57A);
    CheckRegisterWord(RegisterType::SP, 0x368F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB578, 0xE0);
    CheckMemory(0xB579, 0x76);
    CheckMemory(0xFF76, 0x22);
}

void test_E0_02C0()
{
    if (skip_test_E0_02C0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1A05);
    WriteRegisterWord(RegisterType::SP, 0x8A95);
    WriteRegisterByte(RegisterType::A, 0x59);
    WriteRegisterByte(RegisterType::B, 0x37);
    WriteRegisterByte(RegisterType::C, 0xB3);
    WriteRegisterByte(RegisterType::D, 0xFC);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x9E);
    WriteRegisterByte(RegisterType::L, 0x48);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF3F, 0x00);
    WriteMemory(0x1A06, 0x3F);
    WriteMemory(0x1A05, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x59);
    CheckRegisterByte(RegisterType::B, 0x37);
    CheckRegisterByte(RegisterType::C, 0xB3);
    CheckRegisterByte(RegisterType::D, 0xFC);
    CheckRegisterByte(RegisterType::E, 0xA5);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x9E);
    CheckRegisterByte(RegisterType::L, 0x48);
    CheckRegisterWord(RegisterType::PC, 0x1A07);
    CheckRegisterWord(RegisterType::SP, 0x8A95);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1A05, 0xE0);
    CheckMemory(0x1A06, 0x3F);
    CheckMemory(0xFF3F, 0x59);
}

void test_E0_02C1()
{
    if (skip_test_E0_02C1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4114);
    WriteRegisterWord(RegisterType::SP, 0xAAE8);
    WriteRegisterByte(RegisterType::A, 0xDE);
    WriteRegisterByte(RegisterType::B, 0x8B);
    WriteRegisterByte(RegisterType::C, 0x3D);
    WriteRegisterByte(RegisterType::D, 0xCF);
    WriteRegisterByte(RegisterType::E, 0x6E);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xE4);
    WriteRegisterByte(RegisterType::L, 0x75);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFA, 0x00);
    WriteMemory(0x4115, 0xFA);
    WriteMemory(0x4114, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDE);
    CheckRegisterByte(RegisterType::B, 0x8B);
    CheckRegisterByte(RegisterType::C, 0x3D);
    CheckRegisterByte(RegisterType::D, 0xCF);
    CheckRegisterByte(RegisterType::E, 0x6E);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xE4);
    CheckRegisterByte(RegisterType::L, 0x75);
    CheckRegisterWord(RegisterType::PC, 0x4116);
    CheckRegisterWord(RegisterType::SP, 0xAAE8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4114, 0xE0);
    CheckMemory(0x4115, 0xFA);
    CheckMemory(0xFFFA, 0xDE);
}

void test_E0_02C2()
{
    if (skip_test_E0_02C2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x36E8);
    WriteRegisterWord(RegisterType::SP, 0x66D1);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0x85);
    WriteRegisterByte(RegisterType::C, 0x78);
    WriteRegisterByte(RegisterType::D, 0x51);
    WriteRegisterByte(RegisterType::E, 0xD2);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x1B);
    WriteRegisterByte(RegisterType::L, 0xF1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF9, 0x00);
    WriteMemory(0x36E9, 0xF9);
    WriteMemory(0x36E8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0x85);
    CheckRegisterByte(RegisterType::C, 0x78);
    CheckRegisterByte(RegisterType::D, 0x51);
    CheckRegisterByte(RegisterType::E, 0xD2);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x1B);
    CheckRegisterByte(RegisterType::L, 0xF1);
    CheckRegisterWord(RegisterType::PC, 0x36EA);
    CheckRegisterWord(RegisterType::SP, 0x66D1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x36E8, 0xE0);
    CheckMemory(0x36E9, 0xF9);
    CheckMemory(0xFFF9, 0x92);
}

void test_E0_02C3()
{
    if (skip_test_E0_02C3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x950E);
    WriteRegisterWord(RegisterType::SP, 0x71F6);
    WriteRegisterByte(RegisterType::A, 0x39);
    WriteRegisterByte(RegisterType::B, 0x2B);
    WriteRegisterByte(RegisterType::C, 0xB2);
    WriteRegisterByte(RegisterType::D, 0x0C);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x42);
    WriteRegisterByte(RegisterType::L, 0x79);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCA, 0x00);
    WriteMemory(0x950F, 0xCA);
    WriteMemory(0x950E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x39);
    CheckRegisterByte(RegisterType::B, 0x2B);
    CheckRegisterByte(RegisterType::C, 0xB2);
    CheckRegisterByte(RegisterType::D, 0x0C);
    CheckRegisterByte(RegisterType::E, 0xC5);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x42);
    CheckRegisterByte(RegisterType::L, 0x79);
    CheckRegisterWord(RegisterType::PC, 0x9510);
    CheckRegisterWord(RegisterType::SP, 0x71F6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x950E, 0xE0);
    CheckMemory(0x950F, 0xCA);
    CheckMemory(0xFFCA, 0x39);
}

void test_E0_02C4()
{
    if (skip_test_E0_02C4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x558B);
    WriteRegisterWord(RegisterType::SP, 0x8734);
    WriteRegisterByte(RegisterType::A, 0xBA);
    WriteRegisterByte(RegisterType::B, 0x90);
    WriteRegisterByte(RegisterType::C, 0x12);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0xE8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4F, 0x00);
    WriteMemory(0x558C, 0x4F);
    WriteMemory(0x558B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBA);
    CheckRegisterByte(RegisterType::B, 0x90);
    CheckRegisterByte(RegisterType::C, 0x12);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0x53);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0xE8);
    CheckRegisterWord(RegisterType::PC, 0x558D);
    CheckRegisterWord(RegisterType::SP, 0x8734);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x558B, 0xE0);
    CheckMemory(0x558C, 0x4F);
    CheckMemory(0xFF4F, 0xBA);
}

void test_E0_02C5()
{
    if (skip_test_E0_02C5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFC6C);
    WriteRegisterWord(RegisterType::SP, 0x2FBB);
    WriteRegisterByte(RegisterType::A, 0x82);
    WriteRegisterByte(RegisterType::B, 0xA5);
    WriteRegisterByte(RegisterType::C, 0x3C);
    WriteRegisterByte(RegisterType::D, 0xB7);
    WriteRegisterByte(RegisterType::E, 0x3A);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9B, 0x00);
    WriteMemory(0xFC6D, 0x9B);
    WriteMemory(0xFC6C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x82);
    CheckRegisterByte(RegisterType::B, 0xA5);
    CheckRegisterByte(RegisterType::C, 0x3C);
    CheckRegisterByte(RegisterType::D, 0xB7);
    CheckRegisterByte(RegisterType::E, 0x3A);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0xFC6E);
    CheckRegisterWord(RegisterType::SP, 0x2FBB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFC6C, 0xE0);
    CheckMemory(0xFC6D, 0x9B);
    CheckMemory(0xFF9B, 0x82);
}

void test_E0_02C6()
{
    if (skip_test_E0_02C6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x820D);
    WriteRegisterWord(RegisterType::SP, 0xA14A);
    WriteRegisterByte(RegisterType::A, 0xB7);
    WriteRegisterByte(RegisterType::B, 0x5A);
    WriteRegisterByte(RegisterType::C, 0x9E);
    WriteRegisterByte(RegisterType::D, 0x09);
    WriteRegisterByte(RegisterType::E, 0x38);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xEC);
    WriteRegisterByte(RegisterType::L, 0xA6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFC, 0x00);
    WriteMemory(0x820E, 0xFC);
    WriteMemory(0x820D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB7);
    CheckRegisterByte(RegisterType::B, 0x5A);
    CheckRegisterByte(RegisterType::C, 0x9E);
    CheckRegisterByte(RegisterType::D, 0x09);
    CheckRegisterByte(RegisterType::E, 0x38);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xEC);
    CheckRegisterByte(RegisterType::L, 0xA6);
    CheckRegisterWord(RegisterType::PC, 0x820F);
    CheckRegisterWord(RegisterType::SP, 0xA14A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x820D, 0xE0);
    CheckMemory(0x820E, 0xFC);
    CheckMemory(0xFFFC, 0xB7);
}

void test_E0_02C7()
{
    if (skip_test_E0_02C7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x51CA);
    WriteRegisterWord(RegisterType::SP, 0xC87B);
    WriteRegisterByte(RegisterType::A, 0x2A);
    WriteRegisterByte(RegisterType::B, 0xE1);
    WriteRegisterByte(RegisterType::C, 0xE4);
    WriteRegisterByte(RegisterType::D, 0x7E);
    WriteRegisterByte(RegisterType::E, 0x2E);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x2F);
    WriteRegisterByte(RegisterType::L, 0x68);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF31, 0x00);
    WriteMemory(0x51CB, 0x31);
    WriteMemory(0x51CA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2A);
    CheckRegisterByte(RegisterType::B, 0xE1);
    CheckRegisterByte(RegisterType::C, 0xE4);
    CheckRegisterByte(RegisterType::D, 0x7E);
    CheckRegisterByte(RegisterType::E, 0x2E);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x2F);
    CheckRegisterByte(RegisterType::L, 0x68);
    CheckRegisterWord(RegisterType::PC, 0x51CC);
    CheckRegisterWord(RegisterType::SP, 0xC87B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x51CA, 0xE0);
    CheckMemory(0x51CB, 0x31);
    CheckMemory(0xFF31, 0x2A);
}

void test_E0_02C8()
{
    if (skip_test_E0_02C8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDF40);
    WriteRegisterWord(RegisterType::SP, 0x6CA8);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0x06);
    WriteRegisterByte(RegisterType::C, 0x0A);
    WriteRegisterByte(RegisterType::D, 0xDD);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xAE);
    WriteRegisterByte(RegisterType::L, 0xB8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF14, 0x00);
    WriteMemory(0xDF41, 0x14);
    WriteMemory(0xDF40, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0x06);
    CheckRegisterByte(RegisterType::C, 0x0A);
    CheckRegisterByte(RegisterType::D, 0xDD);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xAE);
    CheckRegisterByte(RegisterType::L, 0xB8);
    CheckRegisterWord(RegisterType::PC, 0xDF42);
    CheckRegisterWord(RegisterType::SP, 0x6CA8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDF40, 0xE0);
    CheckMemory(0xDF41, 0x14);
    CheckMemory(0xFF14, 0xCC);
}

void test_E0_02C9()
{
    if (skip_test_E0_02C9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA16E);
    WriteRegisterWord(RegisterType::SP, 0xCCD2);
    WriteRegisterByte(RegisterType::A, 0x70);
    WriteRegisterByte(RegisterType::B, 0x11);
    WriteRegisterByte(RegisterType::C, 0x0B);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0x2D);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x2F);
    WriteRegisterByte(RegisterType::L, 0x8A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF07, 0x00);
    WriteMemory(0xA16F, 0x07);
    WriteMemory(0xA16E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x70);
    CheckRegisterByte(RegisterType::B, 0x11);
    CheckRegisterByte(RegisterType::C, 0x0B);
    CheckRegisterByte(RegisterType::D, 0xCE);
    CheckRegisterByte(RegisterType::E, 0x2D);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x2F);
    CheckRegisterByte(RegisterType::L, 0x8A);
    CheckRegisterWord(RegisterType::PC, 0xA170);
    CheckRegisterWord(RegisterType::SP, 0xCCD2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA16E, 0xE0);
    CheckMemory(0xA16F, 0x07);
    CheckMemory(0xFF07, 0x70);
}

void test_E0_02CA()
{
    if (skip_test_E0_02CA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x12D2);
    WriteRegisterWord(RegisterType::SP, 0x8DC7);
    WriteRegisterByte(RegisterType::A, 0xA9);
    WriteRegisterByte(RegisterType::B, 0x51);
    WriteRegisterByte(RegisterType::C, 0x17);
    WriteRegisterByte(RegisterType::D, 0xFF);
    WriteRegisterByte(RegisterType::E, 0xCF);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x1E);
    WriteRegisterByte(RegisterType::L, 0x5B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF89, 0x00);
    WriteMemory(0x12D3, 0x89);
    WriteMemory(0x12D2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA9);
    CheckRegisterByte(RegisterType::B, 0x51);
    CheckRegisterByte(RegisterType::C, 0x17);
    CheckRegisterByte(RegisterType::D, 0xFF);
    CheckRegisterByte(RegisterType::E, 0xCF);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x1E);
    CheckRegisterByte(RegisterType::L, 0x5B);
    CheckRegisterWord(RegisterType::PC, 0x12D4);
    CheckRegisterWord(RegisterType::SP, 0x8DC7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x12D2, 0xE0);
    CheckMemory(0x12D3, 0x89);
    CheckMemory(0xFF89, 0xA9);
}

void test_E0_02CB()
{
    if (skip_test_E0_02CB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC363);
    WriteRegisterWord(RegisterType::SP, 0x9E7E);
    WriteRegisterByte(RegisterType::A, 0xFF);
    WriteRegisterByte(RegisterType::B, 0x46);
    WriteRegisterByte(RegisterType::C, 0x30);
    WriteRegisterByte(RegisterType::D, 0x18);
    WriteRegisterByte(RegisterType::E, 0x4F);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x67);
    WriteRegisterByte(RegisterType::L, 0xD7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF7C, 0x00);
    WriteMemory(0xC364, 0x7C);
    WriteMemory(0xC363, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFF);
    CheckRegisterByte(RegisterType::B, 0x46);
    CheckRegisterByte(RegisterType::C, 0x30);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0x4F);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x67);
    CheckRegisterByte(RegisterType::L, 0xD7);
    CheckRegisterWord(RegisterType::PC, 0xC365);
    CheckRegisterWord(RegisterType::SP, 0x9E7E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC363, 0xE0);
    CheckMemory(0xC364, 0x7C);
    CheckMemory(0xFF7C, 0xFF);
}

void test_E0_02CC()
{
    if (skip_test_E0_02CC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x03E4);
    WriteRegisterWord(RegisterType::SP, 0xF7D1);
    WriteRegisterByte(RegisterType::A, 0xA0);
    WriteRegisterByte(RegisterType::B, 0x9F);
    WriteRegisterByte(RegisterType::C, 0x4A);
    WriteRegisterByte(RegisterType::D, 0x21);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x5C);
    WriteRegisterByte(RegisterType::L, 0x26);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF7D, 0x00);
    WriteMemory(0x03E5, 0x7D);
    WriteMemory(0x03E4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA0);
    CheckRegisterByte(RegisterType::B, 0x9F);
    CheckRegisterByte(RegisterType::C, 0x4A);
    CheckRegisterByte(RegisterType::D, 0x21);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x5C);
    CheckRegisterByte(RegisterType::L, 0x26);
    CheckRegisterWord(RegisterType::PC, 0x03E6);
    CheckRegisterWord(RegisterType::SP, 0xF7D1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x03E4, 0xE0);
    CheckMemory(0x03E5, 0x7D);
    CheckMemory(0xFF7D, 0xA0);
}

void test_E0_02CD()
{
    if (skip_test_E0_02CD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4A02);
    WriteRegisterWord(RegisterType::SP, 0x970D);
    WriteRegisterByte(RegisterType::A, 0xDC);
    WriteRegisterByte(RegisterType::B, 0xE4);
    WriteRegisterByte(RegisterType::C, 0x90);
    WriteRegisterByte(RegisterType::D, 0x12);
    WriteRegisterByte(RegisterType::E, 0x75);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0xB2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5B, 0x00);
    WriteMemory(0x4A03, 0x5B);
    WriteMemory(0x4A02, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDC);
    CheckRegisterByte(RegisterType::B, 0xE4);
    CheckRegisterByte(RegisterType::C, 0x90);
    CheckRegisterByte(RegisterType::D, 0x12);
    CheckRegisterByte(RegisterType::E, 0x75);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0xB2);
    CheckRegisterWord(RegisterType::PC, 0x4A04);
    CheckRegisterWord(RegisterType::SP, 0x970D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4A02, 0xE0);
    CheckMemory(0x4A03, 0x5B);
    CheckMemory(0xFF5B, 0xDC);
}

void test_E0_02CE()
{
    if (skip_test_E0_02CE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2B05);
    WriteRegisterWord(RegisterType::SP, 0xDD93);
    WriteRegisterByte(RegisterType::A, 0x46);
    WriteRegisterByte(RegisterType::B, 0x75);
    WriteRegisterByte(RegisterType::C, 0x90);
    WriteRegisterByte(RegisterType::D, 0xCE);
    WriteRegisterByte(RegisterType::E, 0x5D);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x2A);
    WriteRegisterByte(RegisterType::L, 0x4F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF01, 0x00);
    WriteMemory(0x2B06, 0x01);
    WriteMemory(0x2B05, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x46);
    CheckRegisterByte(RegisterType::B, 0x75);
    CheckRegisterByte(RegisterType::C, 0x90);
    CheckRegisterByte(RegisterType::D, 0xCE);
    CheckRegisterByte(RegisterType::E, 0x5D);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x2A);
    CheckRegisterByte(RegisterType::L, 0x4F);
    CheckRegisterWord(RegisterType::PC, 0x2B07);
    CheckRegisterWord(RegisterType::SP, 0xDD93);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2B05, 0xE0);
    CheckMemory(0x2B06, 0x01);
    CheckMemory(0xFF01, 0x46);
}

void test_E0_02CF()
{
    if (skip_test_E0_02CF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8A2D);
    WriteRegisterWord(RegisterType::SP, 0xAE4C);
    WriteRegisterByte(RegisterType::A, 0x55);
    WriteRegisterByte(RegisterType::B, 0x90);
    WriteRegisterByte(RegisterType::C, 0x6B);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0xE1);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xDA);
    WriteRegisterByte(RegisterType::L, 0x6C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD3, 0x00);
    WriteMemory(0x8A2E, 0xD3);
    WriteMemory(0x8A2D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x55);
    CheckRegisterByte(RegisterType::B, 0x90);
    CheckRegisterByte(RegisterType::C, 0x6B);
    CheckRegisterByte(RegisterType::D, 0xA6);
    CheckRegisterByte(RegisterType::E, 0xE1);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xDA);
    CheckRegisterByte(RegisterType::L, 0x6C);
    CheckRegisterWord(RegisterType::PC, 0x8A2F);
    CheckRegisterWord(RegisterType::SP, 0xAE4C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8A2D, 0xE0);
    CheckMemory(0x8A2E, 0xD3);
    CheckMemory(0xFFD3, 0x55);
}

void test_E0_02D0()
{
    if (skip_test_E0_02D0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC4A4);
    WriteRegisterWord(RegisterType::SP, 0x1E47);
    WriteRegisterByte(RegisterType::A, 0xE9);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0xA9);
    WriteRegisterByte(RegisterType::D, 0xB3);
    WriteRegisterByte(RegisterType::E, 0x52);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xEC);
    WriteRegisterByte(RegisterType::L, 0x9C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF76, 0x00);
    WriteMemory(0xC4A5, 0x76);
    WriteMemory(0xC4A4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE9);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0xA9);
    CheckRegisterByte(RegisterType::D, 0xB3);
    CheckRegisterByte(RegisterType::E, 0x52);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xEC);
    CheckRegisterByte(RegisterType::L, 0x9C);
    CheckRegisterWord(RegisterType::PC, 0xC4A6);
    CheckRegisterWord(RegisterType::SP, 0x1E47);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC4A4, 0xE0);
    CheckMemory(0xC4A5, 0x76);
    CheckMemory(0xFF76, 0xE9);
}

void test_E0_02D1()
{
    if (skip_test_E0_02D1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4999);
    WriteRegisterWord(RegisterType::SP, 0x751B);
    WriteRegisterByte(RegisterType::A, 0x5B);
    WriteRegisterByte(RegisterType::B, 0x61);
    WriteRegisterByte(RegisterType::C, 0x4A);
    WriteRegisterByte(RegisterType::D, 0x7F);
    WriteRegisterByte(RegisterType::E, 0x8F);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xE2);
    WriteRegisterByte(RegisterType::L, 0x7A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA0, 0x00);
    WriteMemory(0x499A, 0xA0);
    WriteMemory(0x4999, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5B);
    CheckRegisterByte(RegisterType::B, 0x61);
    CheckRegisterByte(RegisterType::C, 0x4A);
    CheckRegisterByte(RegisterType::D, 0x7F);
    CheckRegisterByte(RegisterType::E, 0x8F);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xE2);
    CheckRegisterByte(RegisterType::L, 0x7A);
    CheckRegisterWord(RegisterType::PC, 0x499B);
    CheckRegisterWord(RegisterType::SP, 0x751B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4999, 0xE0);
    CheckMemory(0x499A, 0xA0);
    CheckMemory(0xFFA0, 0x5B);
}

void test_E0_02D2()
{
    if (skip_test_E0_02D2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE25E);
    WriteRegisterWord(RegisterType::SP, 0x3E51);
    WriteRegisterByte(RegisterType::A, 0xB1);
    WriteRegisterByte(RegisterType::B, 0xFB);
    WriteRegisterByte(RegisterType::C, 0x0F);
    WriteRegisterByte(RegisterType::D, 0xC8);
    WriteRegisterByte(RegisterType::E, 0x02);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x0F);
    WriteRegisterByte(RegisterType::L, 0xC5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFBC, 0x00);
    WriteMemory(0xE25F, 0xBC);
    WriteMemory(0xE25E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB1);
    CheckRegisterByte(RegisterType::B, 0xFB);
    CheckRegisterByte(RegisterType::C, 0x0F);
    CheckRegisterByte(RegisterType::D, 0xC8);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x0F);
    CheckRegisterByte(RegisterType::L, 0xC5);
    CheckRegisterWord(RegisterType::PC, 0xE260);
    CheckRegisterWord(RegisterType::SP, 0x3E51);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE25E, 0xE0);
    CheckMemory(0xE25F, 0xBC);
    CheckMemory(0xFFBC, 0xB1);
}

void test_E0_02D3()
{
    if (skip_test_E0_02D3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x695D);
    WriteRegisterWord(RegisterType::SP, 0xFFAC);
    WriteRegisterByte(RegisterType::A, 0x53);
    WriteRegisterByte(RegisterType::B, 0xC2);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0x06);
    WriteRegisterByte(RegisterType::E, 0xA9);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x7C);
    WriteRegisterByte(RegisterType::L, 0x06);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF54, 0x00);
    WriteMemory(0x695E, 0x54);
    WriteMemory(0x695D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x53);
    CheckRegisterByte(RegisterType::B, 0xC2);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0x06);
    CheckRegisterByte(RegisterType::E, 0xA9);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x7C);
    CheckRegisterByte(RegisterType::L, 0x06);
    CheckRegisterWord(RegisterType::PC, 0x695F);
    CheckRegisterWord(RegisterType::SP, 0xFFAC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x695D, 0xE0);
    CheckMemory(0x695E, 0x54);
    CheckMemory(0xFF54, 0x53);
}

void test_E0_02D4()
{
    if (skip_test_E0_02D4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF48C);
    WriteRegisterWord(RegisterType::SP, 0x4975);
    WriteRegisterByte(RegisterType::A, 0xFA);
    WriteRegisterByte(RegisterType::B, 0xC3);
    WriteRegisterByte(RegisterType::C, 0x46);
    WriteRegisterByte(RegisterType::D, 0x1B);
    WriteRegisterByte(RegisterType::E, 0x47);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x6A);
    WriteRegisterByte(RegisterType::L, 0x98);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4E, 0x00);
    WriteMemory(0xF48D, 0x4E);
    WriteMemory(0xF48C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFA);
    CheckRegisterByte(RegisterType::B, 0xC3);
    CheckRegisterByte(RegisterType::C, 0x46);
    CheckRegisterByte(RegisterType::D, 0x1B);
    CheckRegisterByte(RegisterType::E, 0x47);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x6A);
    CheckRegisterByte(RegisterType::L, 0x98);
    CheckRegisterWord(RegisterType::PC, 0xF48E);
    CheckRegisterWord(RegisterType::SP, 0x4975);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF48C, 0xE0);
    CheckMemory(0xF48D, 0x4E);
    CheckMemory(0xFF4E, 0xFA);
}

void test_E0_02D5()
{
    if (skip_test_E0_02D5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF134);
    WriteRegisterWord(RegisterType::SP, 0x6975);
    WriteRegisterByte(RegisterType::A, 0x6F);
    WriteRegisterByte(RegisterType::B, 0x6B);
    WriteRegisterByte(RegisterType::C, 0x2E);
    WriteRegisterByte(RegisterType::D, 0x44);
    WriteRegisterByte(RegisterType::E, 0x2D);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA3, 0x00);
    WriteMemory(0xF135, 0xA3);
    WriteMemory(0xF134, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6F);
    CheckRegisterByte(RegisterType::B, 0x6B);
    CheckRegisterByte(RegisterType::C, 0x2E);
    CheckRegisterByte(RegisterType::D, 0x44);
    CheckRegisterByte(RegisterType::E, 0x2D);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0xF136);
    CheckRegisterWord(RegisterType::SP, 0x6975);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF134, 0xE0);
    CheckMemory(0xF135, 0xA3);
    CheckMemory(0xFFA3, 0x6F);
}

void test_E0_02D6()
{
    if (skip_test_E0_02D6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x662F);
    WriteRegisterWord(RegisterType::SP, 0xB860);
    WriteRegisterByte(RegisterType::A, 0x70);
    WriteRegisterByte(RegisterType::B, 0xCA);
    WriteRegisterByte(RegisterType::C, 0x77);
    WriteRegisterByte(RegisterType::D, 0xF7);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xD4);
    WriteRegisterByte(RegisterType::L, 0x77);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCE, 0x00);
    WriteMemory(0x6630, 0xCE);
    WriteMemory(0x662F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x70);
    CheckRegisterByte(RegisterType::B, 0xCA);
    CheckRegisterByte(RegisterType::C, 0x77);
    CheckRegisterByte(RegisterType::D, 0xF7);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xD4);
    CheckRegisterByte(RegisterType::L, 0x77);
    CheckRegisterWord(RegisterType::PC, 0x6631);
    CheckRegisterWord(RegisterType::SP, 0xB860);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x662F, 0xE0);
    CheckMemory(0x6630, 0xCE);
    CheckMemory(0xFFCE, 0x70);
}

void test_E0_02D7()
{
    if (skip_test_E0_02D7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0613);
    WriteRegisterWord(RegisterType::SP, 0x9802);
    WriteRegisterByte(RegisterType::A, 0xA8);
    WriteRegisterByte(RegisterType::B, 0x20);
    WriteRegisterByte(RegisterType::C, 0xFD);
    WriteRegisterByte(RegisterType::D, 0xFE);
    WriteRegisterByte(RegisterType::E, 0xCD);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x50);
    WriteRegisterByte(RegisterType::L, 0xAB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF33, 0x00);
    WriteMemory(0x0614, 0x33);
    WriteMemory(0x0613, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA8);
    CheckRegisterByte(RegisterType::B, 0x20);
    CheckRegisterByte(RegisterType::C, 0xFD);
    CheckRegisterByte(RegisterType::D, 0xFE);
    CheckRegisterByte(RegisterType::E, 0xCD);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x50);
    CheckRegisterByte(RegisterType::L, 0xAB);
    CheckRegisterWord(RegisterType::PC, 0x0615);
    CheckRegisterWord(RegisterType::SP, 0x9802);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0613, 0xE0);
    CheckMemory(0x0614, 0x33);
    CheckMemory(0xFF33, 0xA8);
}

void test_E0_02D8()
{
    if (skip_test_E0_02D8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD7AF);
    WriteRegisterWord(RegisterType::SP, 0x9BC1);
    WriteRegisterByte(RegisterType::A, 0x15);
    WriteRegisterByte(RegisterType::B, 0xE7);
    WriteRegisterByte(RegisterType::C, 0x48);
    WriteRegisterByte(RegisterType::D, 0xAC);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xB9);
    WriteRegisterByte(RegisterType::L, 0x2F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF40, 0x00);
    WriteMemory(0xD7B0, 0x40);
    WriteMemory(0xD7AF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x15);
    CheckRegisterByte(RegisterType::B, 0xE7);
    CheckRegisterByte(RegisterType::C, 0x48);
    CheckRegisterByte(RegisterType::D, 0xAC);
    CheckRegisterByte(RegisterType::E, 0xA5);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xB9);
    CheckRegisterByte(RegisterType::L, 0x2F);
    CheckRegisterWord(RegisterType::PC, 0xD7B1);
    CheckRegisterWord(RegisterType::SP, 0x9BC1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD7AF, 0xE0);
    CheckMemory(0xD7B0, 0x40);
    CheckMemory(0xFF40, 0x15);
}

void test_E0_02D9()
{
    if (skip_test_E0_02D9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3797);
    WriteRegisterWord(RegisterType::SP, 0x91C3);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0x89);
    WriteRegisterByte(RegisterType::C, 0x50);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0xFD);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x56);
    WriteRegisterByte(RegisterType::L, 0x32);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEA, 0x00);
    WriteMemory(0x3798, 0xEA);
    WriteMemory(0x3797, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0x89);
    CheckRegisterByte(RegisterType::C, 0x50);
    CheckRegisterByte(RegisterType::D, 0x74);
    CheckRegisterByte(RegisterType::E, 0xFD);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x56);
    CheckRegisterByte(RegisterType::L, 0x32);
    CheckRegisterWord(RegisterType::PC, 0x3799);
    CheckRegisterWord(RegisterType::SP, 0x91C3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3797, 0xE0);
    CheckMemory(0x3798, 0xEA);
    CheckMemory(0xFFEA, 0xD9);
}

void test_E0_02DA()
{
    if (skip_test_E0_02DA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x918D);
    WriteRegisterWord(RegisterType::SP, 0xA9A1);
    WriteRegisterByte(RegisterType::A, 0x5E);
    WriteRegisterByte(RegisterType::B, 0x42);
    WriteRegisterByte(RegisterType::C, 0xAF);
    WriteRegisterByte(RegisterType::D, 0x5D);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xFB);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF57, 0x00);
    WriteMemory(0x918E, 0x57);
    WriteMemory(0x918D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5E);
    CheckRegisterByte(RegisterType::B, 0x42);
    CheckRegisterByte(RegisterType::C, 0xAF);
    CheckRegisterByte(RegisterType::D, 0x5D);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xFB);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0x918F);
    CheckRegisterWord(RegisterType::SP, 0xA9A1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x918D, 0xE0);
    CheckMemory(0x918E, 0x57);
    CheckMemory(0xFF57, 0x5E);
}

void test_E0_02DB()
{
    if (skip_test_E0_02DB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6B13);
    WriteRegisterWord(RegisterType::SP, 0x6E19);
    WriteRegisterByte(RegisterType::A, 0x89);
    WriteRegisterByte(RegisterType::B, 0x49);
    WriteRegisterByte(RegisterType::C, 0x8F);
    WriteRegisterByte(RegisterType::D, 0x1C);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0xFD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF27, 0x00);
    WriteMemory(0x6B14, 0x27);
    WriteMemory(0x6B13, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x89);
    CheckRegisterByte(RegisterType::B, 0x49);
    CheckRegisterByte(RegisterType::C, 0x8F);
    CheckRegisterByte(RegisterType::D, 0x1C);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0xFD);
    CheckRegisterWord(RegisterType::PC, 0x6B15);
    CheckRegisterWord(RegisterType::SP, 0x6E19);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6B13, 0xE0);
    CheckMemory(0x6B14, 0x27);
    CheckMemory(0xFF27, 0x89);
}

void test_E0_02DC()
{
    if (skip_test_E0_02DC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x413A);
    WriteRegisterWord(RegisterType::SP, 0xC247);
    WriteRegisterByte(RegisterType::A, 0x8B);
    WriteRegisterByte(RegisterType::B, 0x79);
    WriteRegisterByte(RegisterType::C, 0xF1);
    WriteRegisterByte(RegisterType::D, 0x0D);
    WriteRegisterByte(RegisterType::E, 0x5C);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x02);
    WriteRegisterByte(RegisterType::L, 0xE1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF08, 0x00);
    WriteMemory(0x413B, 0x08);
    WriteMemory(0x413A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8B);
    CheckRegisterByte(RegisterType::B, 0x79);
    CheckRegisterByte(RegisterType::C, 0xF1);
    CheckRegisterByte(RegisterType::D, 0x0D);
    CheckRegisterByte(RegisterType::E, 0x5C);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x02);
    CheckRegisterByte(RegisterType::L, 0xE1);
    CheckRegisterWord(RegisterType::PC, 0x413C);
    CheckRegisterWord(RegisterType::SP, 0xC247);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x413A, 0xE0);
    CheckMemory(0x413B, 0x08);
    CheckMemory(0xFF08, 0x8B);
}

void test_E0_02DD()
{
    if (skip_test_E0_02DD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1229);
    WriteRegisterWord(RegisterType::SP, 0xBFD0);
    WriteRegisterByte(RegisterType::A, 0x19);
    WriteRegisterByte(RegisterType::B, 0x1A);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0xF8);
    WriteRegisterByte(RegisterType::E, 0x58);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xB5);
    WriteRegisterByte(RegisterType::L, 0x46);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF26, 0x00);
    WriteMemory(0x122A, 0x26);
    WriteMemory(0x1229, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x19);
    CheckRegisterByte(RegisterType::B, 0x1A);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0xF8);
    CheckRegisterByte(RegisterType::E, 0x58);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xB5);
    CheckRegisterByte(RegisterType::L, 0x46);
    CheckRegisterWord(RegisterType::PC, 0x122B);
    CheckRegisterWord(RegisterType::SP, 0xBFD0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1229, 0xE0);
    CheckMemory(0x122A, 0x26);
    CheckMemory(0xFF26, 0x19);
}

void test_E0_02DE()
{
    if (skip_test_E0_02DE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9EDA);
    WriteRegisterWord(RegisterType::SP, 0xCAB6);
    WriteRegisterByte(RegisterType::A, 0x79);
    WriteRegisterByte(RegisterType::B, 0x30);
    WriteRegisterByte(RegisterType::C, 0x39);
    WriteRegisterByte(RegisterType::D, 0x77);
    WriteRegisterByte(RegisterType::E, 0x8D);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0xC0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF14, 0x00);
    WriteMemory(0x9EDB, 0x14);
    WriteMemory(0x9EDA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x79);
    CheckRegisterByte(RegisterType::B, 0x30);
    CheckRegisterByte(RegisterType::C, 0x39);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0x8D);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0xC0);
    CheckRegisterWord(RegisterType::PC, 0x9EDC);
    CheckRegisterWord(RegisterType::SP, 0xCAB6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9EDA, 0xE0);
    CheckMemory(0x9EDB, 0x14);
    CheckMemory(0xFF14, 0x79);
}

void test_E0_02DF()
{
    if (skip_test_E0_02DF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA9D3);
    WriteRegisterWord(RegisterType::SP, 0xC4EF);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0xDC);
    WriteRegisterByte(RegisterType::C, 0xCE);
    WriteRegisterByte(RegisterType::D, 0xEA);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x74);
    WriteRegisterByte(RegisterType::L, 0x41);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF69, 0x00);
    WriteMemory(0xA9D4, 0x69);
    WriteMemory(0xA9D3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0xDC);
    CheckRegisterByte(RegisterType::C, 0xCE);
    CheckRegisterByte(RegisterType::D, 0xEA);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x74);
    CheckRegisterByte(RegisterType::L, 0x41);
    CheckRegisterWord(RegisterType::PC, 0xA9D5);
    CheckRegisterWord(RegisterType::SP, 0xC4EF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA9D3, 0xE0);
    CheckMemory(0xA9D4, 0x69);
    CheckMemory(0xFF69, 0xCD);
}

void test_E0_02E0()
{
    if (skip_test_E0_02E0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x29EC);
    WriteRegisterWord(RegisterType::SP, 0x9D21);
    WriteRegisterByte(RegisterType::A, 0xEB);
    WriteRegisterByte(RegisterType::B, 0x61);
    WriteRegisterByte(RegisterType::C, 0x41);
    WriteRegisterByte(RegisterType::D, 0x30);
    WriteRegisterByte(RegisterType::E, 0x24);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xEB);
    WriteRegisterByte(RegisterType::L, 0xD3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF90, 0x00);
    WriteMemory(0x29ED, 0x90);
    WriteMemory(0x29EC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEB);
    CheckRegisterByte(RegisterType::B, 0x61);
    CheckRegisterByte(RegisterType::C, 0x41);
    CheckRegisterByte(RegisterType::D, 0x30);
    CheckRegisterByte(RegisterType::E, 0x24);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xEB);
    CheckRegisterByte(RegisterType::L, 0xD3);
    CheckRegisterWord(RegisterType::PC, 0x29EE);
    CheckRegisterWord(RegisterType::SP, 0x9D21);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x29EC, 0xE0);
    CheckMemory(0x29ED, 0x90);
    CheckMemory(0xFF90, 0xEB);
}

void test_E0_02E1()
{
    if (skip_test_E0_02E1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5B76);
    WriteRegisterWord(RegisterType::SP, 0xAB27);
    WriteRegisterByte(RegisterType::A, 0x83);
    WriteRegisterByte(RegisterType::B, 0x2F);
    WriteRegisterByte(RegisterType::C, 0x9A);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0x1C);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x85);
    WriteRegisterByte(RegisterType::L, 0x55);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF23, 0x00);
    WriteMemory(0x5B77, 0x23);
    WriteMemory(0x5B76, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x83);
    CheckRegisterByte(RegisterType::B, 0x2F);
    CheckRegisterByte(RegisterType::C, 0x9A);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0x1C);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x85);
    CheckRegisterByte(RegisterType::L, 0x55);
    CheckRegisterWord(RegisterType::PC, 0x5B78);
    CheckRegisterWord(RegisterType::SP, 0xAB27);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5B76, 0xE0);
    CheckMemory(0x5B77, 0x23);
    CheckMemory(0xFF23, 0x83);
}

void test_E0_02E2()
{
    if (skip_test_E0_02E2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5DF4);
    WriteRegisterWord(RegisterType::SP, 0x3345);
    WriteRegisterByte(RegisterType::A, 0xED);
    WriteRegisterByte(RegisterType::B, 0x6A);
    WriteRegisterByte(RegisterType::C, 0x8C);
    WriteRegisterByte(RegisterType::D, 0x4A);
    WriteRegisterByte(RegisterType::E, 0x02);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0x9F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9A, 0x00);
    WriteMemory(0x5DF5, 0x9A);
    WriteMemory(0x5DF4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xED);
    CheckRegisterByte(RegisterType::B, 0x6A);
    CheckRegisterByte(RegisterType::C, 0x8C);
    CheckRegisterByte(RegisterType::D, 0x4A);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0x9F);
    CheckRegisterWord(RegisterType::PC, 0x5DF6);
    CheckRegisterWord(RegisterType::SP, 0x3345);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5DF4, 0xE0);
    CheckMemory(0x5DF5, 0x9A);
    CheckMemory(0xFF9A, 0xED);
}

void test_E0_02E3()
{
    if (skip_test_E0_02E3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE7D5);
    WriteRegisterWord(RegisterType::SP, 0x291A);
    WriteRegisterByte(RegisterType::A, 0x23);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0xE5);
    WriteRegisterByte(RegisterType::D, 0x57);
    WriteRegisterByte(RegisterType::E, 0x13);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x0B);
    WriteRegisterByte(RegisterType::L, 0x3F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF61, 0x00);
    WriteMemory(0xE7D6, 0x61);
    WriteMemory(0xE7D5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x23);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0xE5);
    CheckRegisterByte(RegisterType::D, 0x57);
    CheckRegisterByte(RegisterType::E, 0x13);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x0B);
    CheckRegisterByte(RegisterType::L, 0x3F);
    CheckRegisterWord(RegisterType::PC, 0xE7D7);
    CheckRegisterWord(RegisterType::SP, 0x291A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE7D5, 0xE0);
    CheckMemory(0xE7D6, 0x61);
    CheckMemory(0xFF61, 0x23);
}

void test_E0_02E4()
{
    if (skip_test_E0_02E4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA576);
    WriteRegisterWord(RegisterType::SP, 0xD100);
    WriteRegisterByte(RegisterType::A, 0xF3);
    WriteRegisterByte(RegisterType::B, 0xD5);
    WriteRegisterByte(RegisterType::C, 0x26);
    WriteRegisterByte(RegisterType::D, 0x99);
    WriteRegisterByte(RegisterType::E, 0x72);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x2F);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFFB, 0x00);
    WriteMemory(0xA577, 0xFB);
    WriteMemory(0xA576, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF3);
    CheckRegisterByte(RegisterType::B, 0xD5);
    CheckRegisterByte(RegisterType::C, 0x26);
    CheckRegisterByte(RegisterType::D, 0x99);
    CheckRegisterByte(RegisterType::E, 0x72);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x2F);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0xA578);
    CheckRegisterWord(RegisterType::SP, 0xD100);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA576, 0xE0);
    CheckMemory(0xA577, 0xFB);
    CheckMemory(0xFFFB, 0xF3);
}

void test_E0_02E5()
{
    if (skip_test_E0_02E5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x41AA);
    WriteRegisterWord(RegisterType::SP, 0xA58C);
    WriteRegisterByte(RegisterType::A, 0x33);
    WriteRegisterByte(RegisterType::B, 0x5E);
    WriteRegisterByte(RegisterType::C, 0x3C);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0xEF);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xE1);
    WriteRegisterByte(RegisterType::L, 0x9D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF6C, 0x00);
    WriteMemory(0x41AB, 0x6C);
    WriteMemory(0x41AA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x33);
    CheckRegisterByte(RegisterType::B, 0x5E);
    CheckRegisterByte(RegisterType::C, 0x3C);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0xEF);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xE1);
    CheckRegisterByte(RegisterType::L, 0x9D);
    CheckRegisterWord(RegisterType::PC, 0x41AC);
    CheckRegisterWord(RegisterType::SP, 0xA58C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x41AA, 0xE0);
    CheckMemory(0x41AB, 0x6C);
    CheckMemory(0xFF6C, 0x33);
}

void test_E0_02E6()
{
    if (skip_test_E0_02E6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x21BB);
    WriteRegisterWord(RegisterType::SP, 0x6DBD);
    WriteRegisterByte(RegisterType::A, 0xEA);
    WriteRegisterByte(RegisterType::B, 0x08);
    WriteRegisterByte(RegisterType::C, 0x58);
    WriteRegisterByte(RegisterType::D, 0x16);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x26);
    WriteRegisterByte(RegisterType::L, 0x75);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE2, 0x00);
    WriteMemory(0x21BC, 0xE2);
    WriteMemory(0x21BB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEA);
    CheckRegisterByte(RegisterType::B, 0x08);
    CheckRegisterByte(RegisterType::C, 0x58);
    CheckRegisterByte(RegisterType::D, 0x16);
    CheckRegisterByte(RegisterType::E, 0x03);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x26);
    CheckRegisterByte(RegisterType::L, 0x75);
    CheckRegisterWord(RegisterType::PC, 0x21BD);
    CheckRegisterWord(RegisterType::SP, 0x6DBD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x21BB, 0xE0);
    CheckMemory(0x21BC, 0xE2);
    CheckMemory(0xFFE2, 0xEA);
}

void test_E0_02E7()
{
    if (skip_test_E0_02E7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFD28);
    WriteRegisterWord(RegisterType::SP, 0x61B4);
    WriteRegisterByte(RegisterType::A, 0x66);
    WriteRegisterByte(RegisterType::B, 0x68);
    WriteRegisterByte(RegisterType::C, 0x8B);
    WriteRegisterByte(RegisterType::D, 0x4A);
    WriteRegisterByte(RegisterType::E, 0xC6);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xD7);
    WriteRegisterByte(RegisterType::L, 0x2C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF93, 0x00);
    WriteMemory(0xFD29, 0x93);
    WriteMemory(0xFD28, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x66);
    CheckRegisterByte(RegisterType::B, 0x68);
    CheckRegisterByte(RegisterType::C, 0x8B);
    CheckRegisterByte(RegisterType::D, 0x4A);
    CheckRegisterByte(RegisterType::E, 0xC6);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xD7);
    CheckRegisterByte(RegisterType::L, 0x2C);
    CheckRegisterWord(RegisterType::PC, 0xFD2A);
    CheckRegisterWord(RegisterType::SP, 0x61B4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFD28, 0xE0);
    CheckMemory(0xFD29, 0x93);
    CheckMemory(0xFF93, 0x66);
}

void test_E0_02E8()
{
    if (skip_test_E0_02E8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x00D3);
    WriteRegisterWord(RegisterType::SP, 0xDB3E);
    WriteRegisterByte(RegisterType::A, 0x30);
    WriteRegisterByte(RegisterType::B, 0x58);
    WriteRegisterByte(RegisterType::C, 0x90);
    WriteRegisterByte(RegisterType::D, 0xF2);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFDA, 0x00);
    WriteMemory(0x00D4, 0xDA);
    WriteMemory(0x00D3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x30);
    CheckRegisterByte(RegisterType::B, 0x58);
    CheckRegisterByte(RegisterType::C, 0x90);
    CheckRegisterByte(RegisterType::D, 0xF2);
    CheckRegisterByte(RegisterType::E, 0x03);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0x00D5);
    CheckRegisterWord(RegisterType::SP, 0xDB3E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x00D3, 0xE0);
    CheckMemory(0x00D4, 0xDA);
    CheckMemory(0xFFDA, 0x30);
}

void test_E0_02E9()
{
    if (skip_test_E0_02E9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3DAA);
    WriteRegisterWord(RegisterType::SP, 0xE9DA);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0x3F);
    WriteRegisterByte(RegisterType::C, 0x7A);
    WriteRegisterByte(RegisterType::D, 0x55);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xAA);
    WriteRegisterByte(RegisterType::L, 0xFF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF35, 0x00);
    WriteMemory(0x3DAB, 0x35);
    WriteMemory(0x3DAA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0x3F);
    CheckRegisterByte(RegisterType::C, 0x7A);
    CheckRegisterByte(RegisterType::D, 0x55);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xAA);
    CheckRegisterByte(RegisterType::L, 0xFF);
    CheckRegisterWord(RegisterType::PC, 0x3DAC);
    CheckRegisterWord(RegisterType::SP, 0xE9DA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3DAA, 0xE0);
    CheckMemory(0x3DAB, 0x35);
    CheckMemory(0xFF35, 0xCC);
}

void test_E0_02EA()
{
    if (skip_test_E0_02EA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x747C);
    WriteRegisterWord(RegisterType::SP, 0x816B);
    WriteRegisterByte(RegisterType::A, 0xFE);
    WriteRegisterByte(RegisterType::B, 0x56);
    WriteRegisterByte(RegisterType::C, 0x45);
    WriteRegisterByte(RegisterType::D, 0x66);
    WriteRegisterByte(RegisterType::E, 0xAE);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x07);
    WriteRegisterByte(RegisterType::L, 0x3D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF93, 0x00);
    WriteMemory(0x747D, 0x93);
    WriteMemory(0x747C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFE);
    CheckRegisterByte(RegisterType::B, 0x56);
    CheckRegisterByte(RegisterType::C, 0x45);
    CheckRegisterByte(RegisterType::D, 0x66);
    CheckRegisterByte(RegisterType::E, 0xAE);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x07);
    CheckRegisterByte(RegisterType::L, 0x3D);
    CheckRegisterWord(RegisterType::PC, 0x747E);
    CheckRegisterWord(RegisterType::SP, 0x816B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x747C, 0xE0);
    CheckMemory(0x747D, 0x93);
    CheckMemory(0xFF93, 0xFE);
}

void test_E0_02EB()
{
    if (skip_test_E0_02EB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF8DC);
    WriteRegisterWord(RegisterType::SP, 0x9A86);
    WriteRegisterByte(RegisterType::A, 0xCA);
    WriteRegisterByte(RegisterType::B, 0x0F);
    WriteRegisterByte(RegisterType::C, 0x15);
    WriteRegisterByte(RegisterType::D, 0xD1);
    WriteRegisterByte(RegisterType::E, 0xBF);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x4E);
    WriteRegisterByte(RegisterType::L, 0x6B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9A, 0x00);
    WriteMemory(0xF8DD, 0x9A);
    WriteMemory(0xF8DC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCA);
    CheckRegisterByte(RegisterType::B, 0x0F);
    CheckRegisterByte(RegisterType::C, 0x15);
    CheckRegisterByte(RegisterType::D, 0xD1);
    CheckRegisterByte(RegisterType::E, 0xBF);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x4E);
    CheckRegisterByte(RegisterType::L, 0x6B);
    CheckRegisterWord(RegisterType::PC, 0xF8DE);
    CheckRegisterWord(RegisterType::SP, 0x9A86);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF8DC, 0xE0);
    CheckMemory(0xF8DD, 0x9A);
    CheckMemory(0xFF9A, 0xCA);
}

void test_E0_02EC()
{
    if (skip_test_E0_02EC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD9FB);
    WriteRegisterWord(RegisterType::SP, 0xC51B);
    WriteRegisterByte(RegisterType::A, 0x5E);
    WriteRegisterByte(RegisterType::B, 0x6F);
    WriteRegisterByte(RegisterType::C, 0x8E);
    WriteRegisterByte(RegisterType::D, 0x19);
    WriteRegisterByte(RegisterType::E, 0xBE);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0x55);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF54, 0x00);
    WriteMemory(0xD9FC, 0x54);
    WriteMemory(0xD9FB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5E);
    CheckRegisterByte(RegisterType::B, 0x6F);
    CheckRegisterByte(RegisterType::C, 0x8E);
    CheckRegisterByte(RegisterType::D, 0x19);
    CheckRegisterByte(RegisterType::E, 0xBE);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0x55);
    CheckRegisterWord(RegisterType::PC, 0xD9FD);
    CheckRegisterWord(RegisterType::SP, 0xC51B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD9FB, 0xE0);
    CheckMemory(0xD9FC, 0x54);
    CheckMemory(0xFF54, 0x5E);
}

void test_E0_02ED()
{
    if (skip_test_E0_02ED)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3278);
    WriteRegisterWord(RegisterType::SP, 0x200F);
    WriteRegisterByte(RegisterType::A, 0x2F);
    WriteRegisterByte(RegisterType::B, 0x73);
    WriteRegisterByte(RegisterType::C, 0x05);
    WriteRegisterByte(RegisterType::D, 0x4B);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x9F);
    WriteRegisterByte(RegisterType::L, 0x86);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF40, 0x00);
    WriteMemory(0x3279, 0x40);
    WriteMemory(0x3278, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2F);
    CheckRegisterByte(RegisterType::B, 0x73);
    CheckRegisterByte(RegisterType::C, 0x05);
    CheckRegisterByte(RegisterType::D, 0x4B);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x9F);
    CheckRegisterByte(RegisterType::L, 0x86);
    CheckRegisterWord(RegisterType::PC, 0x327A);
    CheckRegisterWord(RegisterType::SP, 0x200F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3278, 0xE0);
    CheckMemory(0x3279, 0x40);
    CheckMemory(0xFF40, 0x2F);
}

void test_E0_02EE()
{
    if (skip_test_E0_02EE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB5F5);
    WriteRegisterWord(RegisterType::SP, 0xC617);
    WriteRegisterByte(RegisterType::A, 0x51);
    WriteRegisterByte(RegisterType::B, 0xE5);
    WriteRegisterByte(RegisterType::C, 0xD3);
    WriteRegisterByte(RegisterType::D, 0x36);
    WriteRegisterByte(RegisterType::E, 0xC8);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0x89);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD5, 0x00);
    WriteMemory(0xB5F6, 0xD5);
    WriteMemory(0xB5F5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x51);
    CheckRegisterByte(RegisterType::B, 0xE5);
    CheckRegisterByte(RegisterType::C, 0xD3);
    CheckRegisterByte(RegisterType::D, 0x36);
    CheckRegisterByte(RegisterType::E, 0xC8);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0x89);
    CheckRegisterWord(RegisterType::PC, 0xB5F7);
    CheckRegisterWord(RegisterType::SP, 0xC617);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB5F5, 0xE0);
    CheckMemory(0xB5F6, 0xD5);
    CheckMemory(0xFFD5, 0x51);
}

void test_E0_02EF()
{
    if (skip_test_E0_02EF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8C7A);
    WriteRegisterWord(RegisterType::SP, 0xC0B4);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0x81);
    WriteRegisterByte(RegisterType::D, 0x77);
    WriteRegisterByte(RegisterType::E, 0x65);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x87);
    WriteRegisterByte(RegisterType::L, 0x83);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF70, 0x00);
    WriteMemory(0x8C7B, 0x70);
    WriteMemory(0x8C7A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0x81);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0x65);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x87);
    CheckRegisterByte(RegisterType::L, 0x83);
    CheckRegisterWord(RegisterType::PC, 0x8C7C);
    CheckRegisterWord(RegisterType::SP, 0xC0B4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8C7A, 0xE0);
    CheckMemory(0x8C7B, 0x70);
    CheckMemory(0xFF70, 0xC2);
}

void test_E0_02F0()
{
    if (skip_test_E0_02F0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5034);
    WriteRegisterWord(RegisterType::SP, 0x182B);
    WriteRegisterByte(RegisterType::A, 0x74);
    WriteRegisterByte(RegisterType::B, 0x56);
    WriteRegisterByte(RegisterType::C, 0x27);
    WriteRegisterByte(RegisterType::D, 0x58);
    WriteRegisterByte(RegisterType::E, 0x16);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xE7);
    WriteRegisterByte(RegisterType::L, 0xA7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD3, 0x00);
    WriteMemory(0x5035, 0xD3);
    WriteMemory(0x5034, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x74);
    CheckRegisterByte(RegisterType::B, 0x56);
    CheckRegisterByte(RegisterType::C, 0x27);
    CheckRegisterByte(RegisterType::D, 0x58);
    CheckRegisterByte(RegisterType::E, 0x16);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xE7);
    CheckRegisterByte(RegisterType::L, 0xA7);
    CheckRegisterWord(RegisterType::PC, 0x5036);
    CheckRegisterWord(RegisterType::SP, 0x182B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5034, 0xE0);
    CheckMemory(0x5035, 0xD3);
    CheckMemory(0xFFD3, 0x74);
}

void test_E0_02F1()
{
    if (skip_test_E0_02F1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC448);
    WriteRegisterWord(RegisterType::SP, 0xD712);
    WriteRegisterByte(RegisterType::A, 0xF3);
    WriteRegisterByte(RegisterType::B, 0x18);
    WriteRegisterByte(RegisterType::C, 0xF1);
    WriteRegisterByte(RegisterType::D, 0x96);
    WriteRegisterByte(RegisterType::E, 0x11);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0x17);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCC, 0x00);
    WriteMemory(0xC449, 0xCC);
    WriteMemory(0xC448, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF3);
    CheckRegisterByte(RegisterType::B, 0x18);
    CheckRegisterByte(RegisterType::C, 0xF1);
    CheckRegisterByte(RegisterType::D, 0x96);
    CheckRegisterByte(RegisterType::E, 0x11);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0x17);
    CheckRegisterWord(RegisterType::PC, 0xC44A);
    CheckRegisterWord(RegisterType::SP, 0xD712);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC448, 0xE0);
    CheckMemory(0xC449, 0xCC);
    CheckMemory(0xFFCC, 0xF3);
}

void test_E0_02F2()
{
    if (skip_test_E0_02F2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA5A4);
    WriteRegisterWord(RegisterType::SP, 0x01AE);
    WriteRegisterByte(RegisterType::A, 0x85);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x98);
    WriteRegisterByte(RegisterType::D, 0xE5);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xA3);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF73, 0x00);
    WriteMemory(0xA5A5, 0x73);
    WriteMemory(0xA5A4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x85);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x98);
    CheckRegisterByte(RegisterType::D, 0xE5);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xA3);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0xA5A6);
    CheckRegisterWord(RegisterType::SP, 0x01AE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA5A4, 0xE0);
    CheckMemory(0xA5A5, 0x73);
    CheckMemory(0xFF73, 0x85);
}

void test_E0_02F3()
{
    if (skip_test_E0_02F3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5587);
    WriteRegisterWord(RegisterType::SP, 0xD7B5);
    WriteRegisterByte(RegisterType::A, 0x74);
    WriteRegisterByte(RegisterType::B, 0x4C);
    WriteRegisterByte(RegisterType::C, 0x5E);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0xFC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFFD, 0x00);
    WriteMemory(0x5588, 0xFD);
    WriteMemory(0x5587, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x74);
    CheckRegisterByte(RegisterType::B, 0x4C);
    CheckRegisterByte(RegisterType::C, 0x5E);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0x74);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0xFC);
    CheckRegisterWord(RegisterType::PC, 0x5589);
    CheckRegisterWord(RegisterType::SP, 0xD7B5);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5587, 0xE0);
    CheckMemory(0x5588, 0xFD);
    CheckMemory(0xFFFD, 0x74);
}

void test_E0_02F4()
{
    if (skip_test_E0_02F4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEB41);
    WriteRegisterWord(RegisterType::SP, 0x9787);
    WriteRegisterByte(RegisterType::A, 0xFD);
    WriteRegisterByte(RegisterType::B, 0xD2);
    WriteRegisterByte(RegisterType::C, 0x2C);
    WriteRegisterByte(RegisterType::D, 0x2E);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xC7);
    WriteRegisterByte(RegisterType::L, 0xE6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF8, 0x00);
    WriteMemory(0xEB42, 0xF8);
    WriteMemory(0xEB41, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFD);
    CheckRegisterByte(RegisterType::B, 0xD2);
    CheckRegisterByte(RegisterType::C, 0x2C);
    CheckRegisterByte(RegisterType::D, 0x2E);
    CheckRegisterByte(RegisterType::E, 0xEE);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xC7);
    CheckRegisterByte(RegisterType::L, 0xE6);
    CheckRegisterWord(RegisterType::PC, 0xEB43);
    CheckRegisterWord(RegisterType::SP, 0x9787);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEB41, 0xE0);
    CheckMemory(0xEB42, 0xF8);
    CheckMemory(0xFFF8, 0xFD);
}

void test_E0_02F5()
{
    if (skip_test_E0_02F5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC5AA);
    WriteRegisterWord(RegisterType::SP, 0x5131);
    WriteRegisterByte(RegisterType::A, 0x8B);
    WriteRegisterByte(RegisterType::B, 0xA6);
    WriteRegisterByte(RegisterType::C, 0x74);
    WriteRegisterByte(RegisterType::D, 0x16);
    WriteRegisterByte(RegisterType::E, 0xA7);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xF0);
    WriteRegisterByte(RegisterType::L, 0x1F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC6, 0x00);
    WriteMemory(0xC5AB, 0xC6);
    WriteMemory(0xC5AA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8B);
    CheckRegisterByte(RegisterType::B, 0xA6);
    CheckRegisterByte(RegisterType::C, 0x74);
    CheckRegisterByte(RegisterType::D, 0x16);
    CheckRegisterByte(RegisterType::E, 0xA7);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xF0);
    CheckRegisterByte(RegisterType::L, 0x1F);
    CheckRegisterWord(RegisterType::PC, 0xC5AC);
    CheckRegisterWord(RegisterType::SP, 0x5131);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC5AA, 0xE0);
    CheckMemory(0xC5AB, 0xC6);
    CheckMemory(0xFFC6, 0x8B);
}

void test_E0_02F6()
{
    if (skip_test_E0_02F6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x09BB);
    WriteRegisterWord(RegisterType::SP, 0xD232);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0x8F);
    WriteRegisterByte(RegisterType::C, 0x15);
    WriteRegisterByte(RegisterType::D, 0x80);
    WriteRegisterByte(RegisterType::E, 0x04);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x44);
    WriteRegisterByte(RegisterType::L, 0xCE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF90, 0x00);
    WriteMemory(0x09BC, 0x90);
    WriteMemory(0x09BB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0x8F);
    CheckRegisterByte(RegisterType::C, 0x15);
    CheckRegisterByte(RegisterType::D, 0x80);
    CheckRegisterByte(RegisterType::E, 0x04);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x44);
    CheckRegisterByte(RegisterType::L, 0xCE);
    CheckRegisterWord(RegisterType::PC, 0x09BD);
    CheckRegisterWord(RegisterType::SP, 0xD232);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x09BB, 0xE0);
    CheckMemory(0x09BC, 0x90);
    CheckMemory(0xFF90, 0xA1);
}

void test_E0_02F7()
{
    if (skip_test_E0_02F7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9E90);
    WriteRegisterWord(RegisterType::SP, 0xB3F3);
    WriteRegisterByte(RegisterType::A, 0x3C);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0x8A);
    WriteRegisterByte(RegisterType::E, 0xBD);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xB3);
    WriteRegisterByte(RegisterType::L, 0xB0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF31, 0x00);
    WriteMemory(0x9E91, 0x31);
    WriteMemory(0x9E90, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3C);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0x8A);
    CheckRegisterByte(RegisterType::E, 0xBD);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xB3);
    CheckRegisterByte(RegisterType::L, 0xB0);
    CheckRegisterWord(RegisterType::PC, 0x9E92);
    CheckRegisterWord(RegisterType::SP, 0xB3F3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9E90, 0xE0);
    CheckMemory(0x9E91, 0x31);
    CheckMemory(0xFF31, 0x3C);
}

void test_E0_02F8()
{
    if (skip_test_E0_02F8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x63B6);
    WriteRegisterWord(RegisterType::SP, 0x7408);
    WriteRegisterByte(RegisterType::A, 0xF2);
    WriteRegisterByte(RegisterType::B, 0xDC);
    WriteRegisterByte(RegisterType::C, 0x66);
    WriteRegisterByte(RegisterType::D, 0x93);
    WriteRegisterByte(RegisterType::E, 0x41);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xB1);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF38, 0x00);
    WriteMemory(0x63B7, 0x38);
    WriteMemory(0x63B6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF2);
    CheckRegisterByte(RegisterType::B, 0xDC);
    CheckRegisterByte(RegisterType::C, 0x66);
    CheckRegisterByte(RegisterType::D, 0x93);
    CheckRegisterByte(RegisterType::E, 0x41);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xB1);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0x63B8);
    CheckRegisterWord(RegisterType::SP, 0x7408);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x63B6, 0xE0);
    CheckMemory(0x63B7, 0x38);
    CheckMemory(0xFF38, 0xF2);
}

void test_E0_02F9()
{
    if (skip_test_E0_02F9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5E67);
    WriteRegisterWord(RegisterType::SP, 0x9E04);
    WriteRegisterByte(RegisterType::A, 0x58);
    WriteRegisterByte(RegisterType::B, 0xC0);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0x67);
    WriteRegisterByte(RegisterType::E, 0x18);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xE3);
    WriteRegisterByte(RegisterType::L, 0x96);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE7, 0x00);
    WriteMemory(0x5E68, 0xE7);
    WriteMemory(0x5E67, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x58);
    CheckRegisterByte(RegisterType::B, 0xC0);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0x67);
    CheckRegisterByte(RegisterType::E, 0x18);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xE3);
    CheckRegisterByte(RegisterType::L, 0x96);
    CheckRegisterWord(RegisterType::PC, 0x5E69);
    CheckRegisterWord(RegisterType::SP, 0x9E04);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5E67, 0xE0);
    CheckMemory(0x5E68, 0xE7);
    CheckMemory(0xFFE7, 0x58);
}

void test_E0_02FA()
{
    if (skip_test_E0_02FA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE865);
    WriteRegisterWord(RegisterType::SP, 0xC9D8);
    WriteRegisterByte(RegisterType::A, 0x2F);
    WriteRegisterByte(RegisterType::B, 0x93);
    WriteRegisterByte(RegisterType::C, 0x61);
    WriteRegisterByte(RegisterType::D, 0x93);
    WriteRegisterByte(RegisterType::E, 0x2C);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xF3);
    WriteRegisterByte(RegisterType::L, 0x91);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2B, 0x00);
    WriteMemory(0xE866, 0x2B);
    WriteMemory(0xE865, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2F);
    CheckRegisterByte(RegisterType::B, 0x93);
    CheckRegisterByte(RegisterType::C, 0x61);
    CheckRegisterByte(RegisterType::D, 0x93);
    CheckRegisterByte(RegisterType::E, 0x2C);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xF3);
    CheckRegisterByte(RegisterType::L, 0x91);
    CheckRegisterWord(RegisterType::PC, 0xE867);
    CheckRegisterWord(RegisterType::SP, 0xC9D8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE865, 0xE0);
    CheckMemory(0xE866, 0x2B);
    CheckMemory(0xFF2B, 0x2F);
}

void test_E0_02FB()
{
    if (skip_test_E0_02FB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x43A2);
    WriteRegisterWord(RegisterType::SP, 0x4CC6);
    WriteRegisterByte(RegisterType::A, 0x18);
    WriteRegisterByte(RegisterType::B, 0xD0);
    WriteRegisterByte(RegisterType::C, 0xBD);
    WriteRegisterByte(RegisterType::D, 0xFE);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x88);
    WriteRegisterByte(RegisterType::L, 0x0B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF69, 0x00);
    WriteMemory(0x43A3, 0x69);
    WriteMemory(0x43A2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x18);
    CheckRegisterByte(RegisterType::B, 0xD0);
    CheckRegisterByte(RegisterType::C, 0xBD);
    CheckRegisterByte(RegisterType::D, 0xFE);
    CheckRegisterByte(RegisterType::E, 0xC5);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x88);
    CheckRegisterByte(RegisterType::L, 0x0B);
    CheckRegisterWord(RegisterType::PC, 0x43A4);
    CheckRegisterWord(RegisterType::SP, 0x4CC6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x43A2, 0xE0);
    CheckMemory(0x43A3, 0x69);
    CheckMemory(0xFF69, 0x18);
}

void test_E0_02FC()
{
    if (skip_test_E0_02FC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7796);
    WriteRegisterWord(RegisterType::SP, 0xCB82);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0xBA);
    WriteRegisterByte(RegisterType::C, 0x2E);
    WriteRegisterByte(RegisterType::D, 0x3F);
    WriteRegisterByte(RegisterType::E, 0xFF);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xA6);
    WriteRegisterByte(RegisterType::L, 0x61);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF31, 0x00);
    WriteMemory(0x7797, 0x31);
    WriteMemory(0x7796, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0xBA);
    CheckRegisterByte(RegisterType::C, 0x2E);
    CheckRegisterByte(RegisterType::D, 0x3F);
    CheckRegisterByte(RegisterType::E, 0xFF);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xA6);
    CheckRegisterByte(RegisterType::L, 0x61);
    CheckRegisterWord(RegisterType::PC, 0x7798);
    CheckRegisterWord(RegisterType::SP, 0xCB82);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7796, 0xE0);
    CheckMemory(0x7797, 0x31);
    CheckMemory(0xFF31, 0x72);
}

void test_E0_02FD()
{
    if (skip_test_E0_02FD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x38E3);
    WriteRegisterWord(RegisterType::SP, 0xD983);
    WriteRegisterByte(RegisterType::A, 0xD9);
    WriteRegisterByte(RegisterType::B, 0x00);
    WriteRegisterByte(RegisterType::C, 0x98);
    WriteRegisterByte(RegisterType::D, 0xC6);
    WriteRegisterByte(RegisterType::E, 0x44);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xB5);
    WriteRegisterByte(RegisterType::L, 0x82);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF1B, 0x00);
    WriteMemory(0x38E4, 0x1B);
    WriteMemory(0x38E3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD9);
    CheckRegisterByte(RegisterType::B, 0x00);
    CheckRegisterByte(RegisterType::C, 0x98);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0x44);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xB5);
    CheckRegisterByte(RegisterType::L, 0x82);
    CheckRegisterWord(RegisterType::PC, 0x38E5);
    CheckRegisterWord(RegisterType::SP, 0xD983);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x38E3, 0xE0);
    CheckMemory(0x38E4, 0x1B);
    CheckMemory(0xFF1B, 0xD9);
}

void test_E0_02FE()
{
    if (skip_test_E0_02FE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x521C);
    WriteRegisterWord(RegisterType::SP, 0x3206);
    WriteRegisterByte(RegisterType::A, 0x8B);
    WriteRegisterByte(RegisterType::B, 0x22);
    WriteRegisterByte(RegisterType::C, 0x6B);
    WriteRegisterByte(RegisterType::D, 0x10);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x22);
    WriteRegisterByte(RegisterType::L, 0xA5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0C, 0x00);
    WriteMemory(0x521D, 0x0C);
    WriteMemory(0x521C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8B);
    CheckRegisterByte(RegisterType::B, 0x22);
    CheckRegisterByte(RegisterType::C, 0x6B);
    CheckRegisterByte(RegisterType::D, 0x10);
    CheckRegisterByte(RegisterType::E, 0x0F);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x22);
    CheckRegisterByte(RegisterType::L, 0xA5);
    CheckRegisterWord(RegisterType::PC, 0x521E);
    CheckRegisterWord(RegisterType::SP, 0x3206);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x521C, 0xE0);
    CheckMemory(0x521D, 0x0C);
    CheckMemory(0xFF0C, 0x8B);
}

void test_E0_02FF()
{
    if (skip_test_E0_02FF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x42CC);
    WriteRegisterWord(RegisterType::SP, 0x45C2);
    WriteRegisterByte(RegisterType::A, 0xB9);
    WriteRegisterByte(RegisterType::B, 0x82);
    WriteRegisterByte(RegisterType::C, 0xBF);
    WriteRegisterByte(RegisterType::D, 0x3E);
    WriteRegisterByte(RegisterType::E, 0xDC);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x23);
    WriteRegisterByte(RegisterType::L, 0xFF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8C, 0x00);
    WriteMemory(0x42CD, 0x8C);
    WriteMemory(0x42CC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB9);
    CheckRegisterByte(RegisterType::B, 0x82);
    CheckRegisterByte(RegisterType::C, 0xBF);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0xDC);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x23);
    CheckRegisterByte(RegisterType::L, 0xFF);
    CheckRegisterWord(RegisterType::PC, 0x42CE);
    CheckRegisterWord(RegisterType::SP, 0x45C2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x42CC, 0xE0);
    CheckMemory(0x42CD, 0x8C);
    CheckMemory(0xFF8C, 0xB9);
}

void test_E0_0300()
{
    if (skip_test_E0_0300)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x109F);
    WriteRegisterWord(RegisterType::SP, 0xF8E0);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0x6B);
    WriteRegisterByte(RegisterType::C, 0x5B);
    WriteRegisterByte(RegisterType::D, 0xED);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x32);
    WriteRegisterByte(RegisterType::L, 0x31);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF7C, 0x00);
    WriteMemory(0x10A0, 0x7C);
    WriteMemory(0x109F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0x6B);
    CheckRegisterByte(RegisterType::C, 0x5B);
    CheckRegisterByte(RegisterType::D, 0xED);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x32);
    CheckRegisterByte(RegisterType::L, 0x31);
    CheckRegisterWord(RegisterType::PC, 0x10A1);
    CheckRegisterWord(RegisterType::SP, 0xF8E0);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x109F, 0xE0);
    CheckMemory(0x10A0, 0x7C);
    CheckMemory(0xFF7C, 0xBB);
}

void test_E0_0301()
{
    if (skip_test_E0_0301)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE695);
    WriteRegisterWord(RegisterType::SP, 0xBF02);
    WriteRegisterByte(RegisterType::A, 0x91);
    WriteRegisterByte(RegisterType::B, 0x87);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0x2B);
    WriteRegisterByte(RegisterType::E, 0x39);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xDC);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF76, 0x00);
    WriteMemory(0xE696, 0x76);
    WriteMemory(0xE695, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x91);
    CheckRegisterByte(RegisterType::B, 0x87);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0x2B);
    CheckRegisterByte(RegisterType::E, 0x39);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xDC);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0xE697);
    CheckRegisterWord(RegisterType::SP, 0xBF02);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE695, 0xE0);
    CheckMemory(0xE696, 0x76);
    CheckMemory(0xFF76, 0x91);
}

void test_E0_0302()
{
    if (skip_test_E0_0302)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD87B);
    WriteRegisterWord(RegisterType::SP, 0x7946);
    WriteRegisterByte(RegisterType::A, 0x65);
    WriteRegisterByte(RegisterType::B, 0x9E);
    WriteRegisterByte(RegisterType::C, 0xA0);
    WriteRegisterByte(RegisterType::D, 0x28);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x31);
    WriteRegisterByte(RegisterType::L, 0xAB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF52, 0x00);
    WriteMemory(0xD87C, 0x52);
    WriteMemory(0xD87B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x65);
    CheckRegisterByte(RegisterType::B, 0x9E);
    CheckRegisterByte(RegisterType::C, 0xA0);
    CheckRegisterByte(RegisterType::D, 0x28);
    CheckRegisterByte(RegisterType::E, 0xEE);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x31);
    CheckRegisterByte(RegisterType::L, 0xAB);
    CheckRegisterWord(RegisterType::PC, 0xD87D);
    CheckRegisterWord(RegisterType::SP, 0x7946);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD87B, 0xE0);
    CheckMemory(0xD87C, 0x52);
    CheckMemory(0xFF52, 0x65);
}

void test_E0_0303()
{
    if (skip_test_E0_0303)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC0A5);
    WriteRegisterWord(RegisterType::SP, 0x44D8);
    WriteRegisterByte(RegisterType::A, 0xB8);
    WriteRegisterByte(RegisterType::B, 0x24);
    WriteRegisterByte(RegisterType::C, 0x24);
    WriteRegisterByte(RegisterType::D, 0x18);
    WriteRegisterByte(RegisterType::E, 0x54);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xE0);
    WriteRegisterByte(RegisterType::L, 0x9E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF69, 0x00);
    WriteMemory(0xC0A6, 0x69);
    WriteMemory(0xC0A5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB8);
    CheckRegisterByte(RegisterType::B, 0x24);
    CheckRegisterByte(RegisterType::C, 0x24);
    CheckRegisterByte(RegisterType::D, 0x18);
    CheckRegisterByte(RegisterType::E, 0x54);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xE0);
    CheckRegisterByte(RegisterType::L, 0x9E);
    CheckRegisterWord(RegisterType::PC, 0xC0A7);
    CheckRegisterWord(RegisterType::SP, 0x44D8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC0A5, 0xE0);
    CheckMemory(0xC0A6, 0x69);
    CheckMemory(0xFF69, 0xB8);
}

void test_E0_0304()
{
    if (skip_test_E0_0304)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x446E);
    WriteRegisterWord(RegisterType::SP, 0x1798);
    WriteRegisterByte(RegisterType::A, 0x87);
    WriteRegisterByte(RegisterType::B, 0x49);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0x83);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x5E);
    WriteRegisterByte(RegisterType::L, 0x1F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF80, 0x00);
    WriteMemory(0x446F, 0x80);
    WriteMemory(0x446E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x87);
    CheckRegisterByte(RegisterType::B, 0x49);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0x83);
    CheckRegisterByte(RegisterType::E, 0x95);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x5E);
    CheckRegisterByte(RegisterType::L, 0x1F);
    CheckRegisterWord(RegisterType::PC, 0x4470);
    CheckRegisterWord(RegisterType::SP, 0x1798);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x446E, 0xE0);
    CheckMemory(0x446F, 0x80);
    CheckMemory(0xFF80, 0x87);
}

void test_E0_0305()
{
    if (skip_test_E0_0305)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6133);
    WriteRegisterWord(RegisterType::SP, 0x98B8);
    WriteRegisterByte(RegisterType::A, 0x02);
    WriteRegisterByte(RegisterType::B, 0x1B);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0xB3);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x05);
    WriteRegisterByte(RegisterType::L, 0x35);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4B, 0x00);
    WriteMemory(0x6134, 0x4B);
    WriteMemory(0x6133, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x02);
    CheckRegisterByte(RegisterType::B, 0x1B);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0xB3);
    CheckRegisterByte(RegisterType::E, 0xE5);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x05);
    CheckRegisterByte(RegisterType::L, 0x35);
    CheckRegisterWord(RegisterType::PC, 0x6135);
    CheckRegisterWord(RegisterType::SP, 0x98B8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6133, 0xE0);
    CheckMemory(0x6134, 0x4B);
    CheckMemory(0xFF4B, 0x02);
}

void test_E0_0306()
{
    if (skip_test_E0_0306)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x73F1);
    WriteRegisterWord(RegisterType::SP, 0xE18F);
    WriteRegisterByte(RegisterType::A, 0x30);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0xFA);
    WriteRegisterByte(RegisterType::D, 0xC7);
    WriteRegisterByte(RegisterType::E, 0x4D);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xE9);
    WriteRegisterByte(RegisterType::L, 0xEB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF74, 0x00);
    WriteMemory(0x73F2, 0x74);
    WriteMemory(0x73F1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x30);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0xFA);
    CheckRegisterByte(RegisterType::D, 0xC7);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xE9);
    CheckRegisterByte(RegisterType::L, 0xEB);
    CheckRegisterWord(RegisterType::PC, 0x73F3);
    CheckRegisterWord(RegisterType::SP, 0xE18F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x73F1, 0xE0);
    CheckMemory(0x73F2, 0x74);
    CheckMemory(0xFF74, 0x30);
}

void test_E0_0307()
{
    if (skip_test_E0_0307)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xED5C);
    WriteRegisterWord(RegisterType::SP, 0xF1DA);
    WriteRegisterByte(RegisterType::A, 0x2D);
    WriteRegisterByte(RegisterType::B, 0xB3);
    WriteRegisterByte(RegisterType::C, 0x36);
    WriteRegisterByte(RegisterType::D, 0xB5);
    WriteRegisterByte(RegisterType::E, 0x35);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x2E);
    WriteRegisterByte(RegisterType::L, 0xD6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC3, 0x00);
    WriteMemory(0xED5D, 0xC3);
    WriteMemory(0xED5C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2D);
    CheckRegisterByte(RegisterType::B, 0xB3);
    CheckRegisterByte(RegisterType::C, 0x36);
    CheckRegisterByte(RegisterType::D, 0xB5);
    CheckRegisterByte(RegisterType::E, 0x35);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x2E);
    CheckRegisterByte(RegisterType::L, 0xD6);
    CheckRegisterWord(RegisterType::PC, 0xED5E);
    CheckRegisterWord(RegisterType::SP, 0xF1DA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xED5C, 0xE0);
    CheckMemory(0xED5D, 0xC3);
    CheckMemory(0xFFC3, 0x2D);
}

void test_E0_0308()
{
    if (skip_test_E0_0308)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4B71);
    WriteRegisterWord(RegisterType::SP, 0x9BED);
    WriteRegisterByte(RegisterType::A, 0xDA);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0xCD);
    WriteRegisterByte(RegisterType::D, 0xD3);
    WriteRegisterByte(RegisterType::E, 0x40);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x27);
    WriteRegisterByte(RegisterType::L, 0xE8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF18, 0x00);
    WriteMemory(0x4B72, 0x18);
    WriteMemory(0x4B71, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDA);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0xCD);
    CheckRegisterByte(RegisterType::D, 0xD3);
    CheckRegisterByte(RegisterType::E, 0x40);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x27);
    CheckRegisterByte(RegisterType::L, 0xE8);
    CheckRegisterWord(RegisterType::PC, 0x4B73);
    CheckRegisterWord(RegisterType::SP, 0x9BED);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4B71, 0xE0);
    CheckMemory(0x4B72, 0x18);
    CheckMemory(0xFF18, 0xDA);
}

void test_E0_0309()
{
    if (skip_test_E0_0309)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA698);
    WriteRegisterWord(RegisterType::SP, 0xE827);
    WriteRegisterByte(RegisterType::A, 0x9A);
    WriteRegisterByte(RegisterType::B, 0xA4);
    WriteRegisterByte(RegisterType::C, 0xD9);
    WriteRegisterByte(RegisterType::D, 0x28);
    WriteRegisterByte(RegisterType::E, 0x2E);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x6F);
    WriteRegisterByte(RegisterType::L, 0x9A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFBB, 0x00);
    WriteMemory(0xA699, 0xBB);
    WriteMemory(0xA698, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9A);
    CheckRegisterByte(RegisterType::B, 0xA4);
    CheckRegisterByte(RegisterType::C, 0xD9);
    CheckRegisterByte(RegisterType::D, 0x28);
    CheckRegisterByte(RegisterType::E, 0x2E);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x6F);
    CheckRegisterByte(RegisterType::L, 0x9A);
    CheckRegisterWord(RegisterType::PC, 0xA69A);
    CheckRegisterWord(RegisterType::SP, 0xE827);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA698, 0xE0);
    CheckMemory(0xA699, 0xBB);
    CheckMemory(0xFFBB, 0x9A);
}

void test_E0_030A()
{
    if (skip_test_E0_030A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB909);
    WriteRegisterWord(RegisterType::SP, 0xF170);
    WriteRegisterByte(RegisterType::A, 0x45);
    WriteRegisterByte(RegisterType::B, 0x9F);
    WriteRegisterByte(RegisterType::C, 0xA4);
    WriteRegisterByte(RegisterType::D, 0x59);
    WriteRegisterByte(RegisterType::E, 0xA3);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x0E);
    WriteRegisterByte(RegisterType::L, 0xE1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF05, 0x00);
    WriteMemory(0xB90A, 0x05);
    WriteMemory(0xB909, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x45);
    CheckRegisterByte(RegisterType::B, 0x9F);
    CheckRegisterByte(RegisterType::C, 0xA4);
    CheckRegisterByte(RegisterType::D, 0x59);
    CheckRegisterByte(RegisterType::E, 0xA3);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x0E);
    CheckRegisterByte(RegisterType::L, 0xE1);
    CheckRegisterWord(RegisterType::PC, 0xB90B);
    CheckRegisterWord(RegisterType::SP, 0xF170);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB909, 0xE0);
    CheckMemory(0xB90A, 0x05);
    CheckMemory(0xFF05, 0x45);
}

void test_E0_030B()
{
    if (skip_test_E0_030B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x87D6);
    WriteRegisterWord(RegisterType::SP, 0x717A);
    WriteRegisterByte(RegisterType::A, 0x8D);
    WriteRegisterByte(RegisterType::B, 0xC8);
    WriteRegisterByte(RegisterType::C, 0xC1);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0xB3);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0x20);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4A, 0x00);
    WriteMemory(0x87D7, 0x4A);
    WriteMemory(0x87D6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8D);
    CheckRegisterByte(RegisterType::B, 0xC8);
    CheckRegisterByte(RegisterType::C, 0xC1);
    CheckRegisterByte(RegisterType::D, 0xEE);
    CheckRegisterByte(RegisterType::E, 0xB3);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0x20);
    CheckRegisterWord(RegisterType::PC, 0x87D8);
    CheckRegisterWord(RegisterType::SP, 0x717A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x87D6, 0xE0);
    CheckMemory(0x87D7, 0x4A);
    CheckMemory(0xFF4A, 0x8D);
}

void test_E0_030C()
{
    if (skip_test_E0_030C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x65ED);
    WriteRegisterWord(RegisterType::SP, 0x6E71);
    WriteRegisterByte(RegisterType::A, 0xCF);
    WriteRegisterByte(RegisterType::B, 0xFD);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0xD7);
    WriteRegisterByte(RegisterType::E, 0x3E);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x60);
    WriteRegisterByte(RegisterType::L, 0x5A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF6F, 0x00);
    WriteMemory(0x65EE, 0x6F);
    WriteMemory(0x65ED, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCF);
    CheckRegisterByte(RegisterType::B, 0xFD);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0xD7);
    CheckRegisterByte(RegisterType::E, 0x3E);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x60);
    CheckRegisterByte(RegisterType::L, 0x5A);
    CheckRegisterWord(RegisterType::PC, 0x65EF);
    CheckRegisterWord(RegisterType::SP, 0x6E71);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x65ED, 0xE0);
    CheckMemory(0x65EE, 0x6F);
    CheckMemory(0xFF6F, 0xCF);
}

void test_E0_030D()
{
    if (skip_test_E0_030D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0F6F);
    WriteRegisterWord(RegisterType::SP, 0xA47D);
    WriteRegisterByte(RegisterType::A, 0x64);
    WriteRegisterByte(RegisterType::B, 0x71);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0x7C);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xD2);
    WriteRegisterByte(RegisterType::L, 0xDD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0C, 0x00);
    WriteMemory(0x0F70, 0x0C);
    WriteMemory(0x0F6F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x64);
    CheckRegisterByte(RegisterType::B, 0x71);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0xAE);
    CheckRegisterByte(RegisterType::E, 0x7C);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xD2);
    CheckRegisterByte(RegisterType::L, 0xDD);
    CheckRegisterWord(RegisterType::PC, 0x0F71);
    CheckRegisterWord(RegisterType::SP, 0xA47D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0F6F, 0xE0);
    CheckMemory(0x0F70, 0x0C);
    CheckMemory(0xFF0C, 0x64);
}

void test_E0_030E()
{
    if (skip_test_E0_030E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7CFA);
    WriteRegisterWord(RegisterType::SP, 0x302C);
    WriteRegisterByte(RegisterType::A, 0x53);
    WriteRegisterByte(RegisterType::B, 0x52);
    WriteRegisterByte(RegisterType::C, 0x11);
    WriteRegisterByte(RegisterType::D, 0x8C);
    WriteRegisterByte(RegisterType::E, 0xB4);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xC9);
    WriteRegisterByte(RegisterType::L, 0x68);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF07, 0x00);
    WriteMemory(0x7CFB, 0x07);
    WriteMemory(0x7CFA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x53);
    CheckRegisterByte(RegisterType::B, 0x52);
    CheckRegisterByte(RegisterType::C, 0x11);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0xB4);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xC9);
    CheckRegisterByte(RegisterType::L, 0x68);
    CheckRegisterWord(RegisterType::PC, 0x7CFC);
    CheckRegisterWord(RegisterType::SP, 0x302C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7CFA, 0xE0);
    CheckMemory(0x7CFB, 0x07);
    CheckMemory(0xFF07, 0x53);
}

void test_E0_030F()
{
    if (skip_test_E0_030F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCF56);
    WriteRegisterWord(RegisterType::SP, 0x2498);
    WriteRegisterByte(RegisterType::A, 0x98);
    WriteRegisterByte(RegisterType::B, 0x3F);
    WriteRegisterByte(RegisterType::C, 0xEC);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0x1E);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x4B);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF85, 0x00);
    WriteMemory(0xCF57, 0x85);
    WriteMemory(0xCF56, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x98);
    CheckRegisterByte(RegisterType::B, 0x3F);
    CheckRegisterByte(RegisterType::C, 0xEC);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x1E);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x4B);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0xCF58);
    CheckRegisterWord(RegisterType::SP, 0x2498);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCF56, 0xE0);
    CheckMemory(0xCF57, 0x85);
    CheckMemory(0xFF85, 0x98);
}

void test_E0_0310()
{
    if (skip_test_E0_0310)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9690);
    WriteRegisterWord(RegisterType::SP, 0xC680);
    WriteRegisterByte(RegisterType::A, 0xCF);
    WriteRegisterByte(RegisterType::B, 0x66);
    WriteRegisterByte(RegisterType::C, 0x5E);
    WriteRegisterByte(RegisterType::D, 0x14);
    WriteRegisterByte(RegisterType::E, 0x2E);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xF9);
    WriteRegisterByte(RegisterType::L, 0x62);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF8D, 0x00);
    WriteMemory(0x9691, 0x8D);
    WriteMemory(0x9690, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCF);
    CheckRegisterByte(RegisterType::B, 0x66);
    CheckRegisterByte(RegisterType::C, 0x5E);
    CheckRegisterByte(RegisterType::D, 0x14);
    CheckRegisterByte(RegisterType::E, 0x2E);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xF9);
    CheckRegisterByte(RegisterType::L, 0x62);
    CheckRegisterWord(RegisterType::PC, 0x9692);
    CheckRegisterWord(RegisterType::SP, 0xC680);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9690, 0xE0);
    CheckMemory(0x9691, 0x8D);
    CheckMemory(0xFF8D, 0xCF);
}

void test_E0_0311()
{
    if (skip_test_E0_0311)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x02D0);
    WriteRegisterWord(RegisterType::SP, 0x0EC4);
    WriteRegisterByte(RegisterType::A, 0x6C);
    WriteRegisterByte(RegisterType::B, 0x45);
    WriteRegisterByte(RegisterType::C, 0x69);
    WriteRegisterByte(RegisterType::D, 0xC9);
    WriteRegisterByte(RegisterType::E, 0x77);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x54);
    WriteRegisterByte(RegisterType::L, 0x7E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAF, 0x00);
    WriteMemory(0x02D1, 0xAF);
    WriteMemory(0x02D0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6C);
    CheckRegisterByte(RegisterType::B, 0x45);
    CheckRegisterByte(RegisterType::C, 0x69);
    CheckRegisterByte(RegisterType::D, 0xC9);
    CheckRegisterByte(RegisterType::E, 0x77);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x54);
    CheckRegisterByte(RegisterType::L, 0x7E);
    CheckRegisterWord(RegisterType::PC, 0x02D2);
    CheckRegisterWord(RegisterType::SP, 0x0EC4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x02D0, 0xE0);
    CheckMemory(0x02D1, 0xAF);
    CheckMemory(0xFFAF, 0x6C);
}

void test_E0_0312()
{
    if (skip_test_E0_0312)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8AEE);
    WriteRegisterWord(RegisterType::SP, 0x7FEA);
    WriteRegisterByte(RegisterType::A, 0x9E);
    WriteRegisterByte(RegisterType::B, 0xFF);
    WriteRegisterByte(RegisterType::C, 0xF7);
    WriteRegisterByte(RegisterType::D, 0xA1);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x81);
    WriteRegisterByte(RegisterType::L, 0x29);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE3, 0x00);
    WriteMemory(0x8AEF, 0xE3);
    WriteMemory(0x8AEE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9E);
    CheckRegisterByte(RegisterType::B, 0xFF);
    CheckRegisterByte(RegisterType::C, 0xF7);
    CheckRegisterByte(RegisterType::D, 0xA1);
    CheckRegisterByte(RegisterType::E, 0xA5);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x81);
    CheckRegisterByte(RegisterType::L, 0x29);
    CheckRegisterWord(RegisterType::PC, 0x8AF0);
    CheckRegisterWord(RegisterType::SP, 0x7FEA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x8AEE, 0xE0);
    CheckMemory(0x8AEF, 0xE3);
    CheckMemory(0xFFE3, 0x9E);
}

void test_E0_0313()
{
    if (skip_test_E0_0313)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE4F3);
    WriteRegisterWord(RegisterType::SP, 0x3DA6);
    WriteRegisterByte(RegisterType::A, 0x23);
    WriteRegisterByte(RegisterType::B, 0xF7);
    WriteRegisterByte(RegisterType::C, 0xEC);
    WriteRegisterByte(RegisterType::D, 0xC4);
    WriteRegisterByte(RegisterType::E, 0x37);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x17);
    WriteRegisterByte(RegisterType::L, 0xA7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF1F, 0x00);
    WriteMemory(0xE4F4, 0x1F);
    WriteMemory(0xE4F3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x23);
    CheckRegisterByte(RegisterType::B, 0xF7);
    CheckRegisterByte(RegisterType::C, 0xEC);
    CheckRegisterByte(RegisterType::D, 0xC4);
    CheckRegisterByte(RegisterType::E, 0x37);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x17);
    CheckRegisterByte(RegisterType::L, 0xA7);
    CheckRegisterWord(RegisterType::PC, 0xE4F5);
    CheckRegisterWord(RegisterType::SP, 0x3DA6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE4F3, 0xE0);
    CheckMemory(0xE4F4, 0x1F);
    CheckMemory(0xFF1F, 0x23);
}

void test_E0_0314()
{
    if (skip_test_E0_0314)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEF6C);
    WriteRegisterWord(RegisterType::SP, 0x972A);
    WriteRegisterByte(RegisterType::A, 0x73);
    WriteRegisterByte(RegisterType::B, 0x17);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0x65);
    WriteRegisterByte(RegisterType::E, 0x53);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xE7);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF71, 0x00);
    WriteMemory(0xEF6D, 0x71);
    WriteMemory(0xEF6C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x73);
    CheckRegisterByte(RegisterType::B, 0x17);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0x53);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xE7);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0xEF6E);
    CheckRegisterWord(RegisterType::SP, 0x972A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEF6C, 0xE0);
    CheckMemory(0xEF6D, 0x71);
    CheckMemory(0xFF71, 0x73);
}

void test_E0_0315()
{
    if (skip_test_E0_0315)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x77C0);
    WriteRegisterWord(RegisterType::SP, 0x28C3);
    WriteRegisterByte(RegisterType::A, 0x0A);
    WriteRegisterByte(RegisterType::B, 0xF8);
    WriteRegisterByte(RegisterType::C, 0x6B);
    WriteRegisterByte(RegisterType::D, 0x81);
    WriteRegisterByte(RegisterType::E, 0x6A);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x9F);
    WriteRegisterByte(RegisterType::L, 0x4B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF97, 0x00);
    WriteMemory(0x77C1, 0x97);
    WriteMemory(0x77C0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0A);
    CheckRegisterByte(RegisterType::B, 0xF8);
    CheckRegisterByte(RegisterType::C, 0x6B);
    CheckRegisterByte(RegisterType::D, 0x81);
    CheckRegisterByte(RegisterType::E, 0x6A);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x9F);
    CheckRegisterByte(RegisterType::L, 0x4B);
    CheckRegisterWord(RegisterType::PC, 0x77C2);
    CheckRegisterWord(RegisterType::SP, 0x28C3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x77C0, 0xE0);
    CheckMemory(0x77C1, 0x97);
    CheckMemory(0xFF97, 0x0A);
}

void test_E0_0316()
{
    if (skip_test_E0_0316)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE7A3);
    WriteRegisterWord(RegisterType::SP, 0x8A44);
    WriteRegisterByte(RegisterType::A, 0xB5);
    WriteRegisterByte(RegisterType::B, 0x30);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0x8D);
    WriteRegisterByte(RegisterType::E, 0x8F);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2E, 0x00);
    WriteMemory(0xE7A4, 0x2E);
    WriteMemory(0xE7A3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB5);
    CheckRegisterByte(RegisterType::B, 0x30);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0x8D);
    CheckRegisterByte(RegisterType::E, 0x8F);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0xE7A5);
    CheckRegisterWord(RegisterType::SP, 0x8A44);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE7A3, 0xE0);
    CheckMemory(0xE7A4, 0x2E);
    CheckMemory(0xFF2E, 0xB5);
}

void test_E0_0317()
{
    if (skip_test_E0_0317)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA770);
    WriteRegisterWord(RegisterType::SP, 0xC927);
    WriteRegisterByte(RegisterType::A, 0xB5);
    WriteRegisterByte(RegisterType::B, 0x8F);
    WriteRegisterByte(RegisterType::C, 0x68);
    WriteRegisterByte(RegisterType::D, 0x32);
    WriteRegisterByte(RegisterType::E, 0xC1);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x5D);
    WriteRegisterByte(RegisterType::L, 0xD9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFFC, 0x00);
    WriteMemory(0xA771, 0xFC);
    WriteMemory(0xA770, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB5);
    CheckRegisterByte(RegisterType::B, 0x8F);
    CheckRegisterByte(RegisterType::C, 0x68);
    CheckRegisterByte(RegisterType::D, 0x32);
    CheckRegisterByte(RegisterType::E, 0xC1);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x5D);
    CheckRegisterByte(RegisterType::L, 0xD9);
    CheckRegisterWord(RegisterType::PC, 0xA772);
    CheckRegisterWord(RegisterType::SP, 0xC927);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA770, 0xE0);
    CheckMemory(0xA771, 0xFC);
    CheckMemory(0xFFFC, 0xB5);
}

void test_E0_0318()
{
    if (skip_test_E0_0318)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA0B0);
    WriteRegisterWord(RegisterType::SP, 0xF2AD);
    WriteRegisterByte(RegisterType::A, 0x14);
    WriteRegisterByte(RegisterType::B, 0xAE);
    WriteRegisterByte(RegisterType::C, 0xF2);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x9D);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF8A, 0x00);
    WriteMemory(0xA0B1, 0x8A);
    WriteMemory(0xA0B0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x14);
    CheckRegisterByte(RegisterType::B, 0xAE);
    CheckRegisterByte(RegisterType::C, 0xF2);
    CheckRegisterByte(RegisterType::D, 0xAE);
    CheckRegisterByte(RegisterType::E, 0x30);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x9D);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0xA0B2);
    CheckRegisterWord(RegisterType::SP, 0xF2AD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA0B0, 0xE0);
    CheckMemory(0xA0B1, 0x8A);
    CheckMemory(0xFF8A, 0x14);
}

void test_E0_0319()
{
    if (skip_test_E0_0319)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDB7A);
    WriteRegisterWord(RegisterType::SP, 0x4EEE);
    WriteRegisterByte(RegisterType::A, 0x02);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0x2D);
    WriteRegisterByte(RegisterType::E, 0x57);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x79);
    WriteRegisterByte(RegisterType::L, 0x70);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFE0, 0x00);
    WriteMemory(0xDB7B, 0xE0);
    WriteMemory(0xDB7A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x02);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0x2D);
    CheckRegisterByte(RegisterType::E, 0x57);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x79);
    CheckRegisterByte(RegisterType::L, 0x70);
    CheckRegisterWord(RegisterType::PC, 0xDB7C);
    CheckRegisterWord(RegisterType::SP, 0x4EEE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDB7A, 0xE0);
    CheckMemory(0xDB7B, 0xE0);
    CheckMemory(0xFFE0, 0x02);
}

void test_E0_031A()
{
    if (skip_test_E0_031A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0E5A);
    WriteRegisterWord(RegisterType::SP, 0xD451);
    WriteRegisterByte(RegisterType::A, 0xA6);
    WriteRegisterByte(RegisterType::B, 0x2A);
    WriteRegisterByte(RegisterType::C, 0xA9);
    WriteRegisterByte(RegisterType::D, 0x62);
    WriteRegisterByte(RegisterType::E, 0xF2);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x97);
    WriteRegisterByte(RegisterType::L, 0x80);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF1B, 0x00);
    WriteMemory(0x0E5B, 0x1B);
    WriteMemory(0x0E5A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA6);
    CheckRegisterByte(RegisterType::B, 0x2A);
    CheckRegisterByte(RegisterType::C, 0xA9);
    CheckRegisterByte(RegisterType::D, 0x62);
    CheckRegisterByte(RegisterType::E, 0xF2);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x97);
    CheckRegisterByte(RegisterType::L, 0x80);
    CheckRegisterWord(RegisterType::PC, 0x0E5C);
    CheckRegisterWord(RegisterType::SP, 0xD451);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0E5A, 0xE0);
    CheckMemory(0x0E5B, 0x1B);
    CheckMemory(0xFF1B, 0xA6);
}

void test_E0_031B()
{
    if (skip_test_E0_031B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1D5A);
    WriteRegisterWord(RegisterType::SP, 0xD18E);
    WriteRegisterByte(RegisterType::A, 0x59);
    WriteRegisterByte(RegisterType::B, 0xBF);
    WriteRegisterByte(RegisterType::C, 0xC5);
    WriteRegisterByte(RegisterType::D, 0xE6);
    WriteRegisterByte(RegisterType::E, 0xDB);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x5A);
    WriteRegisterByte(RegisterType::L, 0x0F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF15, 0x00);
    WriteMemory(0x1D5B, 0x15);
    WriteMemory(0x1D5A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x59);
    CheckRegisterByte(RegisterType::B, 0xBF);
    CheckRegisterByte(RegisterType::C, 0xC5);
    CheckRegisterByte(RegisterType::D, 0xE6);
    CheckRegisterByte(RegisterType::E, 0xDB);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x5A);
    CheckRegisterByte(RegisterType::L, 0x0F);
    CheckRegisterWord(RegisterType::PC, 0x1D5C);
    CheckRegisterWord(RegisterType::SP, 0xD18E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1D5A, 0xE0);
    CheckMemory(0x1D5B, 0x15);
    CheckMemory(0xFF15, 0x59);
}

void test_E0_031C()
{
    if (skip_test_E0_031C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7DF7);
    WriteRegisterWord(RegisterType::SP, 0xD2D5);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0x0B);
    WriteRegisterByte(RegisterType::C, 0xAA);
    WriteRegisterByte(RegisterType::D, 0x94);
    WriteRegisterByte(RegisterType::E, 0x16);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x6D);
    WriteRegisterByte(RegisterType::L, 0xF2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF53, 0x00);
    WriteMemory(0x7DF8, 0x53);
    WriteMemory(0x7DF7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0x0B);
    CheckRegisterByte(RegisterType::C, 0xAA);
    CheckRegisterByte(RegisterType::D, 0x94);
    CheckRegisterByte(RegisterType::E, 0x16);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x6D);
    CheckRegisterByte(RegisterType::L, 0xF2);
    CheckRegisterWord(RegisterType::PC, 0x7DF9);
    CheckRegisterWord(RegisterType::SP, 0xD2D5);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7DF7, 0xE0);
    CheckMemory(0x7DF8, 0x53);
    CheckMemory(0xFF53, 0x32);
}

void test_E0_031D()
{
    if (skip_test_E0_031D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA4B1);
    WriteRegisterWord(RegisterType::SP, 0x70B4);
    WriteRegisterByte(RegisterType::A, 0x40);
    WriteRegisterByte(RegisterType::B, 0x0E);
    WriteRegisterByte(RegisterType::C, 0xF5);
    WriteRegisterByte(RegisterType::D, 0x43);
    WriteRegisterByte(RegisterType::E, 0xEF);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x3B);
    WriteRegisterByte(RegisterType::L, 0x1C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF22, 0x00);
    WriteMemory(0xA4B2, 0x22);
    WriteMemory(0xA4B1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x40);
    CheckRegisterByte(RegisterType::B, 0x0E);
    CheckRegisterByte(RegisterType::C, 0xF5);
    CheckRegisterByte(RegisterType::D, 0x43);
    CheckRegisterByte(RegisterType::E, 0xEF);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x3B);
    CheckRegisterByte(RegisterType::L, 0x1C);
    CheckRegisterWord(RegisterType::PC, 0xA4B3);
    CheckRegisterWord(RegisterType::SP, 0x70B4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA4B1, 0xE0);
    CheckMemory(0xA4B2, 0x22);
    CheckMemory(0xFF22, 0x40);
}

void test_E0_031E()
{
    if (skip_test_E0_031E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3FED);
    WriteRegisterWord(RegisterType::SP, 0x90E8);
    WriteRegisterByte(RegisterType::A, 0xAF);
    WriteRegisterByte(RegisterType::B, 0x00);
    WriteRegisterByte(RegisterType::C, 0x3C);
    WriteRegisterByte(RegisterType::D, 0x35);
    WriteRegisterByte(RegisterType::E, 0x5F);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x88);
    WriteRegisterByte(RegisterType::L, 0x8D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC0, 0x00);
    WriteMemory(0x3FEE, 0xC0);
    WriteMemory(0x3FED, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAF);
    CheckRegisterByte(RegisterType::B, 0x00);
    CheckRegisterByte(RegisterType::C, 0x3C);
    CheckRegisterByte(RegisterType::D, 0x35);
    CheckRegisterByte(RegisterType::E, 0x5F);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x88);
    CheckRegisterByte(RegisterType::L, 0x8D);
    CheckRegisterWord(RegisterType::PC, 0x3FEF);
    CheckRegisterWord(RegisterType::SP, 0x90E8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3FED, 0xE0);
    CheckMemory(0x3FEE, 0xC0);
    CheckMemory(0xFFC0, 0xAF);
}

void test_E0_031F()
{
    if (skip_test_E0_031F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCE66);
    WriteRegisterWord(RegisterType::SP, 0xE628);
    WriteRegisterByte(RegisterType::A, 0xF2);
    WriteRegisterByte(RegisterType::B, 0x87);
    WriteRegisterByte(RegisterType::C, 0x59);
    WriteRegisterByte(RegisterType::D, 0x30);
    WriteRegisterByte(RegisterType::E, 0xC6);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x7A);
    WriteRegisterByte(RegisterType::L, 0x12);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAD, 0x00);
    WriteMemory(0xCE67, 0xAD);
    WriteMemory(0xCE66, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF2);
    CheckRegisterByte(RegisterType::B, 0x87);
    CheckRegisterByte(RegisterType::C, 0x59);
    CheckRegisterByte(RegisterType::D, 0x30);
    CheckRegisterByte(RegisterType::E, 0xC6);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x7A);
    CheckRegisterByte(RegisterType::L, 0x12);
    CheckRegisterWord(RegisterType::PC, 0xCE68);
    CheckRegisterWord(RegisterType::SP, 0xE628);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCE66, 0xE0);
    CheckMemory(0xCE67, 0xAD);
    CheckMemory(0xFFAD, 0xF2);
}

void test_E0_0320()
{
    if (skip_test_E0_0320)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5D37);
    WriteRegisterWord(RegisterType::SP, 0x0147);
    WriteRegisterByte(RegisterType::A, 0xB6);
    WriteRegisterByte(RegisterType::B, 0x19);
    WriteRegisterByte(RegisterType::C, 0xE8);
    WriteRegisterByte(RegisterType::D, 0x62);
    WriteRegisterByte(RegisterType::E, 0x8D);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x41);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFDE, 0x00);
    WriteMemory(0x5D38, 0xDE);
    WriteMemory(0x5D37, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB6);
    CheckRegisterByte(RegisterType::B, 0x19);
    CheckRegisterByte(RegisterType::C, 0xE8);
    CheckRegisterByte(RegisterType::D, 0x62);
    CheckRegisterByte(RegisterType::E, 0x8D);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x41);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0x5D39);
    CheckRegisterWord(RegisterType::SP, 0x0147);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5D37, 0xE0);
    CheckMemory(0x5D38, 0xDE);
    CheckMemory(0xFFDE, 0xB6);
}

void test_E0_0321()
{
    if (skip_test_E0_0321)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7972);
    WriteRegisterWord(RegisterType::SP, 0x3B22);
    WriteRegisterByte(RegisterType::A, 0xFD);
    WriteRegisterByte(RegisterType::B, 0x97);
    WriteRegisterByte(RegisterType::C, 0x67);
    WriteRegisterByte(RegisterType::D, 0x4E);
    WriteRegisterByte(RegisterType::E, 0x9D);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x7E);
    WriteRegisterByte(RegisterType::L, 0xCF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA1, 0x00);
    WriteMemory(0x7973, 0xA1);
    WriteMemory(0x7972, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFD);
    CheckRegisterByte(RegisterType::B, 0x97);
    CheckRegisterByte(RegisterType::C, 0x67);
    CheckRegisterByte(RegisterType::D, 0x4E);
    CheckRegisterByte(RegisterType::E, 0x9D);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x7E);
    CheckRegisterByte(RegisterType::L, 0xCF);
    CheckRegisterWord(RegisterType::PC, 0x7974);
    CheckRegisterWord(RegisterType::SP, 0x3B22);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7972, 0xE0);
    CheckMemory(0x7973, 0xA1);
    CheckMemory(0xFFA1, 0xFD);
}

void test_E0_0322()
{
    if (skip_test_E0_0322)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD073);
    WriteRegisterWord(RegisterType::SP, 0xFBC7);
    WriteRegisterByte(RegisterType::A, 0xCE);
    WriteRegisterByte(RegisterType::B, 0x00);
    WriteRegisterByte(RegisterType::C, 0x65);
    WriteRegisterByte(RegisterType::D, 0xAA);
    WriteRegisterByte(RegisterType::E, 0x28);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xB9);
    WriteRegisterByte(RegisterType::L, 0x52);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9E, 0x00);
    WriteMemory(0xD074, 0x9E);
    WriteMemory(0xD073, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCE);
    CheckRegisterByte(RegisterType::B, 0x00);
    CheckRegisterByte(RegisterType::C, 0x65);
    CheckRegisterByte(RegisterType::D, 0xAA);
    CheckRegisterByte(RegisterType::E, 0x28);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xB9);
    CheckRegisterByte(RegisterType::L, 0x52);
    CheckRegisterWord(RegisterType::PC, 0xD075);
    CheckRegisterWord(RegisterType::SP, 0xFBC7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD073, 0xE0);
    CheckMemory(0xD074, 0x9E);
    CheckMemory(0xFF9E, 0xCE);
}

void test_E0_0323()
{
    if (skip_test_E0_0323)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF8DD);
    WriteRegisterWord(RegisterType::SP, 0x7685);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0xBF);
    WriteRegisterByte(RegisterType::C, 0x05);
    WriteRegisterByte(RegisterType::D, 0x22);
    WriteRegisterByte(RegisterType::E, 0x6F);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x40);
    WriteRegisterByte(RegisterType::L, 0x8C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFED, 0x00);
    WriteMemory(0xF8DE, 0xED);
    WriteMemory(0xF8DD, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0xBF);
    CheckRegisterByte(RegisterType::C, 0x05);
    CheckRegisterByte(RegisterType::D, 0x22);
    CheckRegisterByte(RegisterType::E, 0x6F);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x40);
    CheckRegisterByte(RegisterType::L, 0x8C);
    CheckRegisterWord(RegisterType::PC, 0xF8DF);
    CheckRegisterWord(RegisterType::SP, 0x7685);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF8DD, 0xE0);
    CheckMemory(0xF8DE, 0xED);
    CheckMemory(0xFFED, 0x44);
}

void test_E0_0324()
{
    if (skip_test_E0_0324)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x76C4);
    WriteRegisterWord(RegisterType::SP, 0xE5F7);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0x13);
    WriteRegisterByte(RegisterType::C, 0x8D);
    WriteRegisterByte(RegisterType::D, 0xA1);
    WriteRegisterByte(RegisterType::E, 0x69);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x0D);
    WriteRegisterByte(RegisterType::L, 0xC0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD6, 0x00);
    WriteMemory(0x76C5, 0xD6);
    WriteMemory(0x76C4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0x13);
    CheckRegisterByte(RegisterType::C, 0x8D);
    CheckRegisterByte(RegisterType::D, 0xA1);
    CheckRegisterByte(RegisterType::E, 0x69);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x0D);
    CheckRegisterByte(RegisterType::L, 0xC0);
    CheckRegisterWord(RegisterType::PC, 0x76C6);
    CheckRegisterWord(RegisterType::SP, 0xE5F7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x76C4, 0xE0);
    CheckMemory(0x76C5, 0xD6);
    CheckMemory(0xFFD6, 0xCD);
}

void test_E0_0325()
{
    if (skip_test_E0_0325)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x867C);
    WriteRegisterWord(RegisterType::SP, 0xB452);
    WriteRegisterByte(RegisterType::A, 0xB0);
    WriteRegisterByte(RegisterType::B, 0xA5);
    WriteRegisterByte(RegisterType::C, 0xCC);
    WriteRegisterByte(RegisterType::D, 0x72);
    WriteRegisterByte(RegisterType::E, 0x72);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0x12);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9A, 0x00);
    WriteMemory(0x867D, 0x9A);
    WriteMemory(0x867C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB0);
    CheckRegisterByte(RegisterType::B, 0xA5);
    CheckRegisterByte(RegisterType::C, 0xCC);
    CheckRegisterByte(RegisterType::D, 0x72);
    CheckRegisterByte(RegisterType::E, 0x72);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0x12);
    CheckRegisterWord(RegisterType::PC, 0x867E);
    CheckRegisterWord(RegisterType::SP, 0xB452);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x867C, 0xE0);
    CheckMemory(0x867D, 0x9A);
    CheckMemory(0xFF9A, 0xB0);
}

void test_E0_0326()
{
    if (skip_test_E0_0326)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x47D3);
    WriteRegisterWord(RegisterType::SP, 0x4315);
    WriteRegisterByte(RegisterType::A, 0x15);
    WriteRegisterByte(RegisterType::B, 0x43);
    WriteRegisterByte(RegisterType::C, 0x89);
    WriteRegisterByte(RegisterType::D, 0xC2);
    WriteRegisterByte(RegisterType::E, 0xC7);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x4C);
    WriteRegisterByte(RegisterType::L, 0xD6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC1, 0x00);
    WriteMemory(0x47D4, 0xC1);
    WriteMemory(0x47D3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x15);
    CheckRegisterByte(RegisterType::B, 0x43);
    CheckRegisterByte(RegisterType::C, 0x89);
    CheckRegisterByte(RegisterType::D, 0xC2);
    CheckRegisterByte(RegisterType::E, 0xC7);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x4C);
    CheckRegisterByte(RegisterType::L, 0xD6);
    CheckRegisterWord(RegisterType::PC, 0x47D5);
    CheckRegisterWord(RegisterType::SP, 0x4315);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x47D3, 0xE0);
    CheckMemory(0x47D4, 0xC1);
    CheckMemory(0xFFC1, 0x15);
}

void test_E0_0327()
{
    if (skip_test_E0_0327)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x06C3);
    WriteRegisterWord(RegisterType::SP, 0x9C13);
    WriteRegisterByte(RegisterType::A, 0xF1);
    WriteRegisterByte(RegisterType::B, 0xB9);
    WriteRegisterByte(RegisterType::C, 0xA8);
    WriteRegisterByte(RegisterType::D, 0x15);
    WriteRegisterByte(RegisterType::E, 0x0F);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x23);
    WriteRegisterByte(RegisterType::L, 0x27);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB8, 0x00);
    WriteMemory(0x06C4, 0xB8);
    WriteMemory(0x06C3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF1);
    CheckRegisterByte(RegisterType::B, 0xB9);
    CheckRegisterByte(RegisterType::C, 0xA8);
    CheckRegisterByte(RegisterType::D, 0x15);
    CheckRegisterByte(RegisterType::E, 0x0F);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x23);
    CheckRegisterByte(RegisterType::L, 0x27);
    CheckRegisterWord(RegisterType::PC, 0x06C5);
    CheckRegisterWord(RegisterType::SP, 0x9C13);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x06C3, 0xE0);
    CheckMemory(0x06C4, 0xB8);
    CheckMemory(0xFFB8, 0xF1);
}

void test_E0_0328()
{
    if (skip_test_E0_0328)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5F51);
    WriteRegisterWord(RegisterType::SP, 0x44C8);
    WriteRegisterByte(RegisterType::A, 0x2E);
    WriteRegisterByte(RegisterType::B, 0x07);
    WriteRegisterByte(RegisterType::C, 0xD3);
    WriteRegisterByte(RegisterType::D, 0x6F);
    WriteRegisterByte(RegisterType::E, 0x8E);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0xA9);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFBB, 0x00);
    WriteMemory(0x5F52, 0xBB);
    WriteMemory(0x5F51, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2E);
    CheckRegisterByte(RegisterType::B, 0x07);
    CheckRegisterByte(RegisterType::C, 0xD3);
    CheckRegisterByte(RegisterType::D, 0x6F);
    CheckRegisterByte(RegisterType::E, 0x8E);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0xA9);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0x5F53);
    CheckRegisterWord(RegisterType::SP, 0x44C8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5F51, 0xE0);
    CheckMemory(0x5F52, 0xBB);
    CheckMemory(0xFFBB, 0x2E);
}

void test_E0_0329()
{
    if (skip_test_E0_0329)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x70E6);
    WriteRegisterWord(RegisterType::SP, 0x5EF1);
    WriteRegisterByte(RegisterType::A, 0x21);
    WriteRegisterByte(RegisterType::B, 0xF7);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0xB3);
    WriteRegisterByte(RegisterType::E, 0x9C);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x8D);
    WriteRegisterByte(RegisterType::L, 0x33);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB2, 0x00);
    WriteMemory(0x70E7, 0xB2);
    WriteMemory(0x70E6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x21);
    CheckRegisterByte(RegisterType::B, 0xF7);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0xB3);
    CheckRegisterByte(RegisterType::E, 0x9C);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x8D);
    CheckRegisterByte(RegisterType::L, 0x33);
    CheckRegisterWord(RegisterType::PC, 0x70E8);
    CheckRegisterWord(RegisterType::SP, 0x5EF1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x70E6, 0xE0);
    CheckMemory(0x70E7, 0xB2);
    CheckMemory(0xFFB2, 0x21);
}

void test_E0_032A()
{
    if (skip_test_E0_032A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9912);
    WriteRegisterWord(RegisterType::SP, 0xF7CA);
    WriteRegisterByte(RegisterType::A, 0xE7);
    WriteRegisterByte(RegisterType::B, 0xFA);
    WriteRegisterByte(RegisterType::C, 0xF0);
    WriteRegisterByte(RegisterType::D, 0xE0);
    WriteRegisterByte(RegisterType::E, 0x46);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xC0);
    WriteRegisterByte(RegisterType::L, 0x37);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF21, 0x00);
    WriteMemory(0x9913, 0x21);
    WriteMemory(0x9912, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE7);
    CheckRegisterByte(RegisterType::B, 0xFA);
    CheckRegisterByte(RegisterType::C, 0xF0);
    CheckRegisterByte(RegisterType::D, 0xE0);
    CheckRegisterByte(RegisterType::E, 0x46);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xC0);
    CheckRegisterByte(RegisterType::L, 0x37);
    CheckRegisterWord(RegisterType::PC, 0x9914);
    CheckRegisterWord(RegisterType::SP, 0xF7CA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9912, 0xE0);
    CheckMemory(0x9913, 0x21);
    CheckMemory(0xFF21, 0xE7);
}

void test_E0_032B()
{
    if (skip_test_E0_032B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9B24);
    WriteRegisterWord(RegisterType::SP, 0x84D9);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0x22);
    WriteRegisterByte(RegisterType::C, 0xF3);
    WriteRegisterByte(RegisterType::D, 0x83);
    WriteRegisterByte(RegisterType::E, 0x96);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x4E);
    WriteRegisterByte(RegisterType::L, 0x34);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF7F, 0x00);
    WriteMemory(0x9B25, 0x7F);
    WriteMemory(0x9B24, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0x22);
    CheckRegisterByte(RegisterType::C, 0xF3);
    CheckRegisterByte(RegisterType::D, 0x83);
    CheckRegisterByte(RegisterType::E, 0x96);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x4E);
    CheckRegisterByte(RegisterType::L, 0x34);
    CheckRegisterWord(RegisterType::PC, 0x9B26);
    CheckRegisterWord(RegisterType::SP, 0x84D9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x9B24, 0xE0);
    CheckMemory(0x9B25, 0x7F);
    CheckMemory(0xFF7F, 0xA1);
}

void test_E0_032C()
{
    if (skip_test_E0_032C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x20C6);
    WriteRegisterWord(RegisterType::SP, 0xD35C);
    WriteRegisterByte(RegisterType::A, 0xD2);
    WriteRegisterByte(RegisterType::B, 0x25);
    WriteRegisterByte(RegisterType::C, 0xDF);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0xDB);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0x2B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF21, 0x00);
    WriteMemory(0x20C7, 0x21);
    WriteMemory(0x20C6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD2);
    CheckRegisterByte(RegisterType::B, 0x25);
    CheckRegisterByte(RegisterType::C, 0xDF);
    CheckRegisterByte(RegisterType::D, 0xA6);
    CheckRegisterByte(RegisterType::E, 0xDB);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0x2B);
    CheckRegisterWord(RegisterType::PC, 0x20C8);
    CheckRegisterWord(RegisterType::SP, 0xD35C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x20C6, 0xE0);
    CheckMemory(0x20C7, 0x21);
    CheckMemory(0xFF21, 0xD2);
}

void test_E0_032D()
{
    if (skip_test_E0_032D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x03CE);
    WriteRegisterWord(RegisterType::SP, 0x7928);
    WriteRegisterByte(RegisterType::A, 0x2C);
    WriteRegisterByte(RegisterType::B, 0xEC);
    WriteRegisterByte(RegisterType::C, 0x51);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0x55);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x1B);
    WriteRegisterByte(RegisterType::L, 0x2C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF45, 0x00);
    WriteMemory(0x03CF, 0x45);
    WriteMemory(0x03CE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2C);
    CheckRegisterByte(RegisterType::B, 0xEC);
    CheckRegisterByte(RegisterType::C, 0x51);
    CheckRegisterByte(RegisterType::D, 0xDE);
    CheckRegisterByte(RegisterType::E, 0x55);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x1B);
    CheckRegisterByte(RegisterType::L, 0x2C);
    CheckRegisterWord(RegisterType::PC, 0x03D0);
    CheckRegisterWord(RegisterType::SP, 0x7928);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x03CE, 0xE0);
    CheckMemory(0x03CF, 0x45);
    CheckMemory(0xFF45, 0x2C);
}

void test_E0_032E()
{
    if (skip_test_E0_032E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3501);
    WriteRegisterWord(RegisterType::SP, 0xDC70);
    WriteRegisterByte(RegisterType::A, 0xA8);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0xBA);
    WriteRegisterByte(RegisterType::D, 0x0E);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xBE);
    WriteRegisterByte(RegisterType::L, 0xC8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF03, 0x00);
    WriteMemory(0x3502, 0x03);
    WriteMemory(0x3501, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA8);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0xBA);
    CheckRegisterByte(RegisterType::D, 0x0E);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xBE);
    CheckRegisterByte(RegisterType::L, 0xC8);
    CheckRegisterWord(RegisterType::PC, 0x3503);
    CheckRegisterWord(RegisterType::SP, 0xDC70);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3501, 0xE0);
    CheckMemory(0x3502, 0x03);
    CheckMemory(0xFF03, 0xA8);
}

void test_E0_032F()
{
    if (skip_test_E0_032F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB2A5);
    WriteRegisterWord(RegisterType::SP, 0xE52E);
    WriteRegisterByte(RegisterType::A, 0x3B);
    WriteRegisterByte(RegisterType::B, 0x04);
    WriteRegisterByte(RegisterType::C, 0x47);
    WriteRegisterByte(RegisterType::D, 0xC8);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x2A);
    WriteRegisterByte(RegisterType::L, 0xAB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF62, 0x00);
    WriteMemory(0xB2A6, 0x62);
    WriteMemory(0xB2A5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3B);
    CheckRegisterByte(RegisterType::B, 0x04);
    CheckRegisterByte(RegisterType::C, 0x47);
    CheckRegisterByte(RegisterType::D, 0xC8);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x2A);
    CheckRegisterByte(RegisterType::L, 0xAB);
    CheckRegisterWord(RegisterType::PC, 0xB2A7);
    CheckRegisterWord(RegisterType::SP, 0xE52E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB2A5, 0xE0);
    CheckMemory(0xB2A6, 0x62);
    CheckMemory(0xFF62, 0x3B);
}

void test_E0_0330()
{
    if (skip_test_E0_0330)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAE8C);
    WriteRegisterWord(RegisterType::SP, 0x25BC);
    WriteRegisterByte(RegisterType::A, 0x0F);
    WriteRegisterByte(RegisterType::B, 0xD3);
    WriteRegisterByte(RegisterType::C, 0x49);
    WriteRegisterByte(RegisterType::D, 0x17);
    WriteRegisterByte(RegisterType::E, 0x6A);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0xE4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAA, 0x00);
    WriteMemory(0xAE8D, 0xAA);
    WriteMemory(0xAE8C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0F);
    CheckRegisterByte(RegisterType::B, 0xD3);
    CheckRegisterByte(RegisterType::C, 0x49);
    CheckRegisterByte(RegisterType::D, 0x17);
    CheckRegisterByte(RegisterType::E, 0x6A);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0xE4);
    CheckRegisterWord(RegisterType::PC, 0xAE8E);
    CheckRegisterWord(RegisterType::SP, 0x25BC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAE8C, 0xE0);
    CheckMemory(0xAE8D, 0xAA);
    CheckMemory(0xFFAA, 0x0F);
}

void test_E0_0331()
{
    if (skip_test_E0_0331)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9807);
    WriteRegisterWord(RegisterType::SP, 0x8FAA);
    WriteRegisterByte(RegisterType::A, 0x1A);
    WriteRegisterByte(RegisterType::B, 0xF5);
    WriteRegisterByte(RegisterType::C, 0x73);
    WriteRegisterByte(RegisterType::D, 0x67);
    WriteRegisterByte(RegisterType::E, 0x27);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x6F);
    WriteRegisterByte(RegisterType::L, 0x03);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF46, 0x00);
    WriteMemory(0x9808, 0x46);
    WriteMemory(0x9807, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1A);
    CheckRegisterByte(RegisterType::B, 0xF5);
    CheckRegisterByte(RegisterType::C, 0x73);
    CheckRegisterByte(RegisterType::D, 0x67);
    CheckRegisterByte(RegisterType::E, 0x27);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x6F);
    CheckRegisterByte(RegisterType::L, 0x03);
    CheckRegisterWord(RegisterType::PC, 0x9809);
    CheckRegisterWord(RegisterType::SP, 0x8FAA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9807, 0xE0);
    CheckMemory(0x9808, 0x46);
    CheckMemory(0xFF46, 0x1A);
}

void test_E0_0332()
{
    if (skip_test_E0_0332)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x547B);
    WriteRegisterWord(RegisterType::SP, 0xDD97);
    WriteRegisterByte(RegisterType::A, 0xA9);
    WriteRegisterByte(RegisterType::B, 0xE8);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0x7C);
    WriteRegisterByte(RegisterType::E, 0x02);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x9B);
    WriteRegisterByte(RegisterType::L, 0xFA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF76, 0x00);
    WriteMemory(0x547C, 0x76);
    WriteMemory(0x547B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA9);
    CheckRegisterByte(RegisterType::B, 0xE8);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0x7C);
    CheckRegisterByte(RegisterType::E, 0x02);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x9B);
    CheckRegisterByte(RegisterType::L, 0xFA);
    CheckRegisterWord(RegisterType::PC, 0x547D);
    CheckRegisterWord(RegisterType::SP, 0xDD97);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x547B, 0xE0);
    CheckMemory(0x547C, 0x76);
    CheckMemory(0xFF76, 0xA9);
}

void test_E0_0333()
{
    if (skip_test_E0_0333)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE791);
    WriteRegisterWord(RegisterType::SP, 0x12EE);
    WriteRegisterByte(RegisterType::A, 0xAD);
    WriteRegisterByte(RegisterType::B, 0x17);
    WriteRegisterByte(RegisterType::C, 0x20);
    WriteRegisterByte(RegisterType::D, 0x91);
    WriteRegisterByte(RegisterType::E, 0xE9);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x04);
    WriteRegisterByte(RegisterType::L, 0x50);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF73, 0x00);
    WriteMemory(0xE792, 0x73);
    WriteMemory(0xE791, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAD);
    CheckRegisterByte(RegisterType::B, 0x17);
    CheckRegisterByte(RegisterType::C, 0x20);
    CheckRegisterByte(RegisterType::D, 0x91);
    CheckRegisterByte(RegisterType::E, 0xE9);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x04);
    CheckRegisterByte(RegisterType::L, 0x50);
    CheckRegisterWord(RegisterType::PC, 0xE793);
    CheckRegisterWord(RegisterType::SP, 0x12EE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE791, 0xE0);
    CheckMemory(0xE792, 0x73);
    CheckMemory(0xFF73, 0xAD);
}

void test_E0_0334()
{
    if (skip_test_E0_0334)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x57C7);
    WriteRegisterWord(RegisterType::SP, 0xE4E2);
    WriteRegisterByte(RegisterType::A, 0xC9);
    WriteRegisterByte(RegisterType::B, 0xC1);
    WriteRegisterByte(RegisterType::C, 0x92);
    WriteRegisterByte(RegisterType::D, 0xC1);
    WriteRegisterByte(RegisterType::E, 0xA5);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x15);
    WriteRegisterByte(RegisterType::L, 0x27);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA1, 0x00);
    WriteMemory(0x57C8, 0xA1);
    WriteMemory(0x57C7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC9);
    CheckRegisterByte(RegisterType::B, 0xC1);
    CheckRegisterByte(RegisterType::C, 0x92);
    CheckRegisterByte(RegisterType::D, 0xC1);
    CheckRegisterByte(RegisterType::E, 0xA5);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x15);
    CheckRegisterByte(RegisterType::L, 0x27);
    CheckRegisterWord(RegisterType::PC, 0x57C9);
    CheckRegisterWord(RegisterType::SP, 0xE4E2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x57C7, 0xE0);
    CheckMemory(0x57C8, 0xA1);
    CheckMemory(0xFFA1, 0xC9);
}

void test_E0_0335()
{
    if (skip_test_E0_0335)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF310);
    WriteRegisterWord(RegisterType::SP, 0xFB31);
    WriteRegisterByte(RegisterType::A, 0xA8);
    WriteRegisterByte(RegisterType::B, 0xA8);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0x67);
    WriteRegisterByte(RegisterType::E, 0xCF);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x65);
    WriteRegisterByte(RegisterType::L, 0x93);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCC, 0x00);
    WriteMemory(0xF311, 0xCC);
    WriteMemory(0xF310, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA8);
    CheckRegisterByte(RegisterType::B, 0xA8);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0x67);
    CheckRegisterByte(RegisterType::E, 0xCF);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x65);
    CheckRegisterByte(RegisterType::L, 0x93);
    CheckRegisterWord(RegisterType::PC, 0xF312);
    CheckRegisterWord(RegisterType::SP, 0xFB31);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF310, 0xE0);
    CheckMemory(0xF311, 0xCC);
    CheckMemory(0xFFCC, 0xA8);
}

void test_E0_0336()
{
    if (skip_test_E0_0336)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x350C);
    WriteRegisterWord(RegisterType::SP, 0x8680);
    WriteRegisterByte(RegisterType::A, 0xA3);
    WriteRegisterByte(RegisterType::B, 0x47);
    WriteRegisterByte(RegisterType::C, 0x08);
    WriteRegisterByte(RegisterType::D, 0xF0);
    WriteRegisterByte(RegisterType::E, 0x4D);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xED);
    WriteRegisterByte(RegisterType::L, 0x3B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF1E, 0x00);
    WriteMemory(0x350D, 0x1E);
    WriteMemory(0x350C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA3);
    CheckRegisterByte(RegisterType::B, 0x47);
    CheckRegisterByte(RegisterType::C, 0x08);
    CheckRegisterByte(RegisterType::D, 0xF0);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xED);
    CheckRegisterByte(RegisterType::L, 0x3B);
    CheckRegisterWord(RegisterType::PC, 0x350E);
    CheckRegisterWord(RegisterType::SP, 0x8680);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x350C, 0xE0);
    CheckMemory(0x350D, 0x1E);
    CheckMemory(0xFF1E, 0xA3);
}

void test_E0_0337()
{
    if (skip_test_E0_0337)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7ABC);
    WriteRegisterWord(RegisterType::SP, 0x6ED9);
    WriteRegisterByte(RegisterType::A, 0x02);
    WriteRegisterByte(RegisterType::B, 0xAE);
    WriteRegisterByte(RegisterType::C, 0xBE);
    WriteRegisterByte(RegisterType::D, 0xC4);
    WriteRegisterByte(RegisterType::E, 0x9D);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x24);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA0, 0x00);
    WriteMemory(0x7ABD, 0xA0);
    WriteMemory(0x7ABC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x02);
    CheckRegisterByte(RegisterType::B, 0xAE);
    CheckRegisterByte(RegisterType::C, 0xBE);
    CheckRegisterByte(RegisterType::D, 0xC4);
    CheckRegisterByte(RegisterType::E, 0x9D);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x24);
    CheckRegisterWord(RegisterType::PC, 0x7ABE);
    CheckRegisterWord(RegisterType::SP, 0x6ED9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7ABC, 0xE0);
    CheckMemory(0x7ABD, 0xA0);
    CheckMemory(0xFFA0, 0x02);
}

void test_E0_0338()
{
    if (skip_test_E0_0338)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x90D3);
    WriteRegisterWord(RegisterType::SP, 0x68EA);
    WriteRegisterByte(RegisterType::A, 0xC5);
    WriteRegisterByte(RegisterType::B, 0xE5);
    WriteRegisterByte(RegisterType::C, 0x80);
    WriteRegisterByte(RegisterType::D, 0xBB);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x2E);
    WriteRegisterByte(RegisterType::L, 0x8A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF58, 0x00);
    WriteMemory(0x90D4, 0x58);
    WriteMemory(0x90D3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC5);
    CheckRegisterByte(RegisterType::B, 0xE5);
    CheckRegisterByte(RegisterType::C, 0x80);
    CheckRegisterByte(RegisterType::D, 0xBB);
    CheckRegisterByte(RegisterType::E, 0x83);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x2E);
    CheckRegisterByte(RegisterType::L, 0x8A);
    CheckRegisterWord(RegisterType::PC, 0x90D5);
    CheckRegisterWord(RegisterType::SP, 0x68EA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x90D3, 0xE0);
    CheckMemory(0x90D4, 0x58);
    CheckMemory(0xFF58, 0xC5);
}

void test_E0_0339()
{
    if (skip_test_E0_0339)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA328);
    WriteRegisterWord(RegisterType::SP, 0xF3F4);
    WriteRegisterByte(RegisterType::A, 0x30);
    WriteRegisterByte(RegisterType::B, 0x9A);
    WriteRegisterByte(RegisterType::C, 0x2C);
    WriteRegisterByte(RegisterType::D, 0x5E);
    WriteRegisterByte(RegisterType::E, 0xAE);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xA3);
    WriteRegisterByte(RegisterType::L, 0x52);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFA6, 0x00);
    WriteMemory(0xA329, 0xA6);
    WriteMemory(0xA328, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x30);
    CheckRegisterByte(RegisterType::B, 0x9A);
    CheckRegisterByte(RegisterType::C, 0x2C);
    CheckRegisterByte(RegisterType::D, 0x5E);
    CheckRegisterByte(RegisterType::E, 0xAE);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xA3);
    CheckRegisterByte(RegisterType::L, 0x52);
    CheckRegisterWord(RegisterType::PC, 0xA32A);
    CheckRegisterWord(RegisterType::SP, 0xF3F4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA328, 0xE0);
    CheckMemory(0xA329, 0xA6);
    CheckMemory(0xFFA6, 0x30);
}

void test_E0_033A()
{
    if (skip_test_E0_033A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE0CD);
    WriteRegisterWord(RegisterType::SP, 0x10DC);
    WriteRegisterByte(RegisterType::A, 0xF4);
    WriteRegisterByte(RegisterType::B, 0xFF);
    WriteRegisterByte(RegisterType::C, 0xEA);
    WriteRegisterByte(RegisterType::D, 0x42);
    WriteRegisterByte(RegisterType::E, 0xCE);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x48);
    WriteRegisterByte(RegisterType::L, 0x5A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF7C, 0x00);
    WriteMemory(0xE0CE, 0x7C);
    WriteMemory(0xE0CD, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF4);
    CheckRegisterByte(RegisterType::B, 0xFF);
    CheckRegisterByte(RegisterType::C, 0xEA);
    CheckRegisterByte(RegisterType::D, 0x42);
    CheckRegisterByte(RegisterType::E, 0xCE);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x48);
    CheckRegisterByte(RegisterType::L, 0x5A);
    CheckRegisterWord(RegisterType::PC, 0xE0CF);
    CheckRegisterWord(RegisterType::SP, 0x10DC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE0CD, 0xE0);
    CheckMemory(0xE0CE, 0x7C);
    CheckMemory(0xFF7C, 0xF4);
}

void test_E0_033B()
{
    if (skip_test_E0_033B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0E21);
    WriteRegisterWord(RegisterType::SP, 0xADE7);
    WriteRegisterByte(RegisterType::A, 0x8A);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x3D);
    WriteRegisterByte(RegisterType::D, 0xE4);
    WriteRegisterByte(RegisterType::E, 0x92);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x14);
    WriteRegisterByte(RegisterType::L, 0x22);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF37, 0x00);
    WriteMemory(0x0E22, 0x37);
    WriteMemory(0x0E21, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8A);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x3D);
    CheckRegisterByte(RegisterType::D, 0xE4);
    CheckRegisterByte(RegisterType::E, 0x92);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x14);
    CheckRegisterByte(RegisterType::L, 0x22);
    CheckRegisterWord(RegisterType::PC, 0x0E23);
    CheckRegisterWord(RegisterType::SP, 0xADE7);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0E21, 0xE0);
    CheckMemory(0x0E22, 0x37);
    CheckMemory(0xFF37, 0x8A);
}

void test_E0_033C()
{
    if (skip_test_E0_033C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x43CF);
    WriteRegisterWord(RegisterType::SP, 0xC3AF);
    WriteRegisterByte(RegisterType::A, 0xE7);
    WriteRegisterByte(RegisterType::B, 0x46);
    WriteRegisterByte(RegisterType::C, 0xC9);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0x70);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x76);
    WriteRegisterByte(RegisterType::L, 0xE4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF18, 0x00);
    WriteMemory(0x43D0, 0x18);
    WriteMemory(0x43CF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE7);
    CheckRegisterByte(RegisterType::B, 0x46);
    CheckRegisterByte(RegisterType::C, 0xC9);
    CheckRegisterByte(RegisterType::D, 0x74);
    CheckRegisterByte(RegisterType::E, 0x70);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x76);
    CheckRegisterByte(RegisterType::L, 0xE4);
    CheckRegisterWord(RegisterType::PC, 0x43D1);
    CheckRegisterWord(RegisterType::SP, 0xC3AF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x43CF, 0xE0);
    CheckMemory(0x43D0, 0x18);
    CheckMemory(0xFF18, 0xE7);
}

void test_E0_033D()
{
    if (skip_test_E0_033D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2372);
    WriteRegisterWord(RegisterType::SP, 0xC329);
    WriteRegisterByte(RegisterType::A, 0x02);
    WriteRegisterByte(RegisterType::B, 0xE3);
    WriteRegisterByte(RegisterType::C, 0x3F);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x79);
    WriteRegisterByte(RegisterType::L, 0xBB);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF9F, 0x00);
    WriteMemory(0x2373, 0x9F);
    WriteMemory(0x2372, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x02);
    CheckRegisterByte(RegisterType::B, 0xE3);
    CheckRegisterByte(RegisterType::C, 0x3F);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0x74);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x79);
    CheckRegisterByte(RegisterType::L, 0xBB);
    CheckRegisterWord(RegisterType::PC, 0x2374);
    CheckRegisterWord(RegisterType::SP, 0xC329);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2372, 0xE0);
    CheckMemory(0x2373, 0x9F);
    CheckMemory(0xFF9F, 0x02);
}

void test_E0_033E()
{
    if (skip_test_E0_033E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5F9F);
    WriteRegisterWord(RegisterType::SP, 0xC83F);
    WriteRegisterByte(RegisterType::A, 0xC1);
    WriteRegisterByte(RegisterType::B, 0x7D);
    WriteRegisterByte(RegisterType::C, 0x32);
    WriteRegisterByte(RegisterType::D, 0xF7);
    WriteRegisterByte(RegisterType::E, 0x76);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x4C);
    WriteRegisterByte(RegisterType::L, 0xE1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFEA, 0x00);
    WriteMemory(0x5FA0, 0xEA);
    WriteMemory(0x5F9F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC1);
    CheckRegisterByte(RegisterType::B, 0x7D);
    CheckRegisterByte(RegisterType::C, 0x32);
    CheckRegisterByte(RegisterType::D, 0xF7);
    CheckRegisterByte(RegisterType::E, 0x76);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x4C);
    CheckRegisterByte(RegisterType::L, 0xE1);
    CheckRegisterWord(RegisterType::PC, 0x5FA1);
    CheckRegisterWord(RegisterType::SP, 0xC83F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5F9F, 0xE0);
    CheckMemory(0x5FA0, 0xEA);
    CheckMemory(0xFFEA, 0xC1);
}

void test_E0_033F()
{
    if (skip_test_E0_033F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6726);
    WriteRegisterWord(RegisterType::SP, 0xAF61);
    WriteRegisterByte(RegisterType::A, 0x41);
    WriteRegisterByte(RegisterType::B, 0x68);
    WriteRegisterByte(RegisterType::C, 0x53);
    WriteRegisterByte(RegisterType::D, 0xF5);
    WriteRegisterByte(RegisterType::E, 0x08);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0x77);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF4C, 0x00);
    WriteMemory(0x6727, 0x4C);
    WriteMemory(0x6726, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x41);
    CheckRegisterByte(RegisterType::B, 0x68);
    CheckRegisterByte(RegisterType::C, 0x53);
    CheckRegisterByte(RegisterType::D, 0xF5);
    CheckRegisterByte(RegisterType::E, 0x08);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0x77);
    CheckRegisterWord(RegisterType::PC, 0x6728);
    CheckRegisterWord(RegisterType::SP, 0xAF61);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6726, 0xE0);
    CheckMemory(0x6727, 0x4C);
    CheckMemory(0xFF4C, 0x41);
}

void test_E0_0340()
{
    if (skip_test_E0_0340)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9673);
    WriteRegisterWord(RegisterType::SP, 0xE755);
    WriteRegisterByte(RegisterType::A, 0x05);
    WriteRegisterByte(RegisterType::B, 0x32);
    WriteRegisterByte(RegisterType::C, 0xE9);
    WriteRegisterByte(RegisterType::D, 0xB3);
    WriteRegisterByte(RegisterType::E, 0x30);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x20);
    WriteRegisterByte(RegisterType::L, 0x05);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCE, 0x00);
    WriteMemory(0x9674, 0xCE);
    WriteMemory(0x9673, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x05);
    CheckRegisterByte(RegisterType::B, 0x32);
    CheckRegisterByte(RegisterType::C, 0xE9);
    CheckRegisterByte(RegisterType::D, 0xB3);
    CheckRegisterByte(RegisterType::E, 0x30);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x20);
    CheckRegisterByte(RegisterType::L, 0x05);
    CheckRegisterWord(RegisterType::PC, 0x9675);
    CheckRegisterWord(RegisterType::SP, 0xE755);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9673, 0xE0);
    CheckMemory(0x9674, 0xCE);
    CheckMemory(0xFFCE, 0x05);
}

void test_E0_0341()
{
    if (skip_test_E0_0341)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1B1E);
    WriteRegisterWord(RegisterType::SP, 0x4977);
    WriteRegisterByte(RegisterType::A, 0xD7);
    WriteRegisterByte(RegisterType::B, 0x1C);
    WriteRegisterByte(RegisterType::C, 0x8A);
    WriteRegisterByte(RegisterType::D, 0x2A);
    WriteRegisterByte(RegisterType::E, 0x28);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xEC);
    WriteRegisterByte(RegisterType::L, 0xB7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF7, 0x00);
    WriteMemory(0x1B1F, 0xF7);
    WriteMemory(0x1B1E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD7);
    CheckRegisterByte(RegisterType::B, 0x1C);
    CheckRegisterByte(RegisterType::C, 0x8A);
    CheckRegisterByte(RegisterType::D, 0x2A);
    CheckRegisterByte(RegisterType::E, 0x28);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xEC);
    CheckRegisterByte(RegisterType::L, 0xB7);
    CheckRegisterWord(RegisterType::PC, 0x1B20);
    CheckRegisterWord(RegisterType::SP, 0x4977);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1B1E, 0xE0);
    CheckMemory(0x1B1F, 0xF7);
    CheckMemory(0xFFF7, 0xD7);
}

void test_E0_0342()
{
    if (skip_test_E0_0342)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFECE);
    WriteRegisterWord(RegisterType::SP, 0x3359);
    WriteRegisterByte(RegisterType::A, 0x32);
    WriteRegisterByte(RegisterType::B, 0x00);
    WriteRegisterByte(RegisterType::C, 0x05);
    WriteRegisterByte(RegisterType::D, 0xAA);
    WriteRegisterByte(RegisterType::E, 0xCC);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x0A);
    WriteRegisterByte(RegisterType::L, 0x55);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF1, 0x00);
    WriteMemory(0xFECF, 0xF1);
    WriteMemory(0xFECE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x32);
    CheckRegisterByte(RegisterType::B, 0x00);
    CheckRegisterByte(RegisterType::C, 0x05);
    CheckRegisterByte(RegisterType::D, 0xAA);
    CheckRegisterByte(RegisterType::E, 0xCC);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x0A);
    CheckRegisterByte(RegisterType::L, 0x55);
    CheckRegisterWord(RegisterType::PC, 0xFED0);
    CheckRegisterWord(RegisterType::SP, 0x3359);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFECE, 0xE0);
    CheckMemory(0xFECF, 0xF1);
    CheckMemory(0xFFF1, 0x32);
}

void test_E0_0343()
{
    if (skip_test_E0_0343)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x168D);
    WriteRegisterWord(RegisterType::SP, 0x50D6);
    WriteRegisterByte(RegisterType::A, 0x9F);
    WriteRegisterByte(RegisterType::B, 0x71);
    WriteRegisterByte(RegisterType::C, 0x00);
    WriteRegisterByte(RegisterType::D, 0x2B);
    WriteRegisterByte(RegisterType::E, 0x57);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x22);
    WriteRegisterByte(RegisterType::L, 0xBA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF00, 0x00);
    WriteMemory(0x168E, 0x00);
    WriteMemory(0x168D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9F);
    CheckRegisterByte(RegisterType::B, 0x71);
    CheckRegisterByte(RegisterType::C, 0x00);
    CheckRegisterByte(RegisterType::D, 0x2B);
    CheckRegisterByte(RegisterType::E, 0x57);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x22);
    CheckRegisterByte(RegisterType::L, 0xBA);
    CheckRegisterWord(RegisterType::PC, 0x168F);
    CheckRegisterWord(RegisterType::SP, 0x50D6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x168D, 0xE0);
    CheckMemory(0x168E, 0x00);
    CheckMemory(0xFF00, 0x9F);
}

void test_E0_0344()
{
    if (skip_test_E0_0344)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x24FA);
    WriteRegisterWord(RegisterType::SP, 0xDFEC);
    WriteRegisterByte(RegisterType::A, 0x16);
    WriteRegisterByte(RegisterType::B, 0x7C);
    WriteRegisterByte(RegisterType::C, 0xE7);
    WriteRegisterByte(RegisterType::D, 0xBF);
    WriteRegisterByte(RegisterType::E, 0x2B);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xD8);
    WriteRegisterByte(RegisterType::L, 0x4B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF0E, 0x00);
    WriteMemory(0x24FB, 0x0E);
    WriteMemory(0x24FA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x16);
    CheckRegisterByte(RegisterType::B, 0x7C);
    CheckRegisterByte(RegisterType::C, 0xE7);
    CheckRegisterByte(RegisterType::D, 0xBF);
    CheckRegisterByte(RegisterType::E, 0x2B);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xD8);
    CheckRegisterByte(RegisterType::L, 0x4B);
    CheckRegisterWord(RegisterType::PC, 0x24FC);
    CheckRegisterWord(RegisterType::SP, 0xDFEC);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x24FA, 0xE0);
    CheckMemory(0x24FB, 0x0E);
    CheckMemory(0xFF0E, 0x16);
}

void test_E0_0345()
{
    if (skip_test_E0_0345)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE11E);
    WriteRegisterWord(RegisterType::SP, 0xFEEF);
    WriteRegisterByte(RegisterType::A, 0x7F);
    WriteRegisterByte(RegisterType::B, 0x93);
    WriteRegisterByte(RegisterType::C, 0x4A);
    WriteRegisterByte(RegisterType::D, 0x05);
    WriteRegisterByte(RegisterType::E, 0x7A);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x60);
    WriteRegisterByte(RegisterType::L, 0x2A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF3C, 0x00);
    WriteMemory(0xE11F, 0x3C);
    WriteMemory(0xE11E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7F);
    CheckRegisterByte(RegisterType::B, 0x93);
    CheckRegisterByte(RegisterType::C, 0x4A);
    CheckRegisterByte(RegisterType::D, 0x05);
    CheckRegisterByte(RegisterType::E, 0x7A);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x60);
    CheckRegisterByte(RegisterType::L, 0x2A);
    CheckRegisterWord(RegisterType::PC, 0xE120);
    CheckRegisterWord(RegisterType::SP, 0xFEEF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE11E, 0xE0);
    CheckMemory(0xE11F, 0x3C);
    CheckMemory(0xFF3C, 0x7F);
}

void test_E0_0346()
{
    if (skip_test_E0_0346)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x595F);
    WriteRegisterWord(RegisterType::SP, 0x65D2);
    WriteRegisterByte(RegisterType::A, 0x10);
    WriteRegisterByte(RegisterType::B, 0xF6);
    WriteRegisterByte(RegisterType::C, 0xE8);
    WriteRegisterByte(RegisterType::D, 0x85);
    WriteRegisterByte(RegisterType::E, 0x26);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0xFE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF27, 0x00);
    WriteMemory(0x5960, 0x27);
    WriteMemory(0x595F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x10);
    CheckRegisterByte(RegisterType::B, 0xF6);
    CheckRegisterByte(RegisterType::C, 0xE8);
    CheckRegisterByte(RegisterType::D, 0x85);
    CheckRegisterByte(RegisterType::E, 0x26);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0xFE);
    CheckRegisterWord(RegisterType::PC, 0x5961);
    CheckRegisterWord(RegisterType::SP, 0x65D2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x595F, 0xE0);
    CheckMemory(0x5960, 0x27);
    CheckMemory(0xFF27, 0x10);
}

void test_E0_0347()
{
    if (skip_test_E0_0347)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9E4F);
    WriteRegisterWord(RegisterType::SP, 0x007C);
    WriteRegisterByte(RegisterType::A, 0x64);
    WriteRegisterByte(RegisterType::B, 0x1B);
    WriteRegisterByte(RegisterType::C, 0x8C);
    WriteRegisterByte(RegisterType::D, 0x1D);
    WriteRegisterByte(RegisterType::E, 0x15);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x0D);
    WriteRegisterByte(RegisterType::L, 0x5F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB9, 0x00);
    WriteMemory(0x9E50, 0xB9);
    WriteMemory(0x9E4F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x64);
    CheckRegisterByte(RegisterType::B, 0x1B);
    CheckRegisterByte(RegisterType::C, 0x8C);
    CheckRegisterByte(RegisterType::D, 0x1D);
    CheckRegisterByte(RegisterType::E, 0x15);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x0D);
    CheckRegisterByte(RegisterType::L, 0x5F);
    CheckRegisterWord(RegisterType::PC, 0x9E51);
    CheckRegisterWord(RegisterType::SP, 0x007C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9E4F, 0xE0);
    CheckMemory(0x9E50, 0xB9);
    CheckMemory(0xFFB9, 0x64);
}

void test_E0_0348()
{
    if (skip_test_E0_0348)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF9E8);
    WriteRegisterWord(RegisterType::SP, 0x4EFA);
    WriteRegisterByte(RegisterType::A, 0x1B);
    WriteRegisterByte(RegisterType::B, 0xFD);
    WriteRegisterByte(RegisterType::C, 0x67);
    WriteRegisterByte(RegisterType::D, 0xDE);
    WriteRegisterByte(RegisterType::E, 0xAC);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x86);
    WriteRegisterByte(RegisterType::L, 0x53);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF23, 0x00);
    WriteMemory(0xF9E9, 0x23);
    WriteMemory(0xF9E8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1B);
    CheckRegisterByte(RegisterType::B, 0xFD);
    CheckRegisterByte(RegisterType::C, 0x67);
    CheckRegisterByte(RegisterType::D, 0xDE);
    CheckRegisterByte(RegisterType::E, 0xAC);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x86);
    CheckRegisterByte(RegisterType::L, 0x53);
    CheckRegisterWord(RegisterType::PC, 0xF9EA);
    CheckRegisterWord(RegisterType::SP, 0x4EFA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF9E8, 0xE0);
    CheckMemory(0xF9E9, 0x23);
    CheckMemory(0xFF23, 0x1B);
}

void test_E0_0349()
{
    if (skip_test_E0_0349)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2EE5);
    WriteRegisterWord(RegisterType::SP, 0xEFCD);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0x3D);
    WriteRegisterByte(RegisterType::C, 0xD4);
    WriteRegisterByte(RegisterType::D, 0x93);
    WriteRegisterByte(RegisterType::E, 0xB2);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x05);
    WriteRegisterByte(RegisterType::L, 0x0A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFF, 0x00);
    WriteMemory(0x2EE6, 0xFF);
    WriteMemory(0x2EE5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0x3D);
    CheckRegisterByte(RegisterType::C, 0xD4);
    CheckRegisterByte(RegisterType::D, 0x93);
    CheckRegisterByte(RegisterType::E, 0xB2);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x05);
    CheckRegisterByte(RegisterType::L, 0x0A);
    CheckRegisterWord(RegisterType::PC, 0x2EE7);
    CheckRegisterWord(RegisterType::SP, 0xEFCD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2EE5, 0xE0);
    CheckMemory(0x2EE6, 0xFF);
    CheckMemory(0xFFFF, 0xD0);
}

void test_E0_034A()
{
    if (skip_test_E0_034A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1D8C);
    WriteRegisterWord(RegisterType::SP, 0xBB7B);
    WriteRegisterByte(RegisterType::A, 0xCF);
    WriteRegisterByte(RegisterType::B, 0x61);
    WriteRegisterByte(RegisterType::C, 0x30);
    WriteRegisterByte(RegisterType::D, 0xB4);
    WriteRegisterByte(RegisterType::E, 0xBD);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xAE);
    WriteRegisterByte(RegisterType::L, 0x25);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAF, 0x00);
    WriteMemory(0x1D8D, 0xAF);
    WriteMemory(0x1D8C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCF);
    CheckRegisterByte(RegisterType::B, 0x61);
    CheckRegisterByte(RegisterType::C, 0x30);
    CheckRegisterByte(RegisterType::D, 0xB4);
    CheckRegisterByte(RegisterType::E, 0xBD);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xAE);
    CheckRegisterByte(RegisterType::L, 0x25);
    CheckRegisterWord(RegisterType::PC, 0x1D8E);
    CheckRegisterWord(RegisterType::SP, 0xBB7B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1D8C, 0xE0);
    CheckMemory(0x1D8D, 0xAF);
    CheckMemory(0xFFAF, 0xCF);
}

void test_E0_034B()
{
    if (skip_test_E0_034B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0214);
    WriteRegisterWord(RegisterType::SP, 0x8E32);
    WriteRegisterByte(RegisterType::A, 0x1A);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0x77);
    WriteRegisterByte(RegisterType::D, 0x50);
    WriteRegisterByte(RegisterType::E, 0xDA);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x52);
    WriteRegisterByte(RegisterType::L, 0x59);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFBE, 0x00);
    WriteMemory(0x0215, 0xBE);
    WriteMemory(0x0214, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1A);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0x77);
    CheckRegisterByte(RegisterType::D, 0x50);
    CheckRegisterByte(RegisterType::E, 0xDA);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x52);
    CheckRegisterByte(RegisterType::L, 0x59);
    CheckRegisterWord(RegisterType::PC, 0x0216);
    CheckRegisterWord(RegisterType::SP, 0x8E32);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0214, 0xE0);
    CheckMemory(0x0215, 0xBE);
    CheckMemory(0xFFBE, 0x1A);
}

void test_E0_034C()
{
    if (skip_test_E0_034C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7CCB);
    WriteRegisterWord(RegisterType::SP, 0x750A);
    WriteRegisterByte(RegisterType::A, 0xFE);
    WriteRegisterByte(RegisterType::B, 0x53);
    WriteRegisterByte(RegisterType::C, 0xE6);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0xB4);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0xCD);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAA, 0x00);
    WriteMemory(0x7CCC, 0xAA);
    WriteMemory(0x7CCB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFE);
    CheckRegisterByte(RegisterType::B, 0x53);
    CheckRegisterByte(RegisterType::C, 0xE6);
    CheckRegisterByte(RegisterType::D, 0xD4);
    CheckRegisterByte(RegisterType::E, 0xB4);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0xCD);
    CheckRegisterWord(RegisterType::PC, 0x7CCD);
    CheckRegisterWord(RegisterType::SP, 0x750A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7CCB, 0xE0);
    CheckMemory(0x7CCC, 0xAA);
    CheckMemory(0xFFAA, 0xFE);
}

void test_E0_034D()
{
    if (skip_test_E0_034D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6253);
    WriteRegisterWord(RegisterType::SP, 0x07A9);
    WriteRegisterByte(RegisterType::A, 0x6C);
    WriteRegisterByte(RegisterType::B, 0xD4);
    WriteRegisterByte(RegisterType::C, 0x6C);
    WriteRegisterByte(RegisterType::D, 0x57);
    WriteRegisterByte(RegisterType::E, 0x66);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0x3A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCA, 0x00);
    WriteMemory(0x6254, 0xCA);
    WriteMemory(0x6253, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6C);
    CheckRegisterByte(RegisterType::B, 0xD4);
    CheckRegisterByte(RegisterType::C, 0x6C);
    CheckRegisterByte(RegisterType::D, 0x57);
    CheckRegisterByte(RegisterType::E, 0x66);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0x3A);
    CheckRegisterWord(RegisterType::PC, 0x6255);
    CheckRegisterWord(RegisterType::SP, 0x07A9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6253, 0xE0);
    CheckMemory(0x6254, 0xCA);
    CheckMemory(0xFFCA, 0x6C);
}

void test_E0_034E()
{
    if (skip_test_E0_034E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5ADA);
    WriteRegisterWord(RegisterType::SP, 0xA393);
    WriteRegisterByte(RegisterType::A, 0x81);
    WriteRegisterByte(RegisterType::B, 0xCF);
    WriteRegisterByte(RegisterType::C, 0xF2);
    WriteRegisterByte(RegisterType::D, 0x2C);
    WriteRegisterByte(RegisterType::E, 0xE4);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x09);
    WriteRegisterByte(RegisterType::L, 0x28);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA3, 0x00);
    WriteMemory(0x5ADB, 0xA3);
    WriteMemory(0x5ADA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x81);
    CheckRegisterByte(RegisterType::B, 0xCF);
    CheckRegisterByte(RegisterType::C, 0xF2);
    CheckRegisterByte(RegisterType::D, 0x2C);
    CheckRegisterByte(RegisterType::E, 0xE4);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x09);
    CheckRegisterByte(RegisterType::L, 0x28);
    CheckRegisterWord(RegisterType::PC, 0x5ADC);
    CheckRegisterWord(RegisterType::SP, 0xA393);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5ADA, 0xE0);
    CheckMemory(0x5ADB, 0xA3);
    CheckMemory(0xFFA3, 0x81);
}

void test_E0_034F()
{
    if (skip_test_E0_034F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6439);
    WriteRegisterWord(RegisterType::SP, 0x2CB7);
    WriteRegisterByte(RegisterType::A, 0x9E);
    WriteRegisterByte(RegisterType::B, 0x3F);
    WriteRegisterByte(RegisterType::C, 0xB6);
    WriteRegisterByte(RegisterType::D, 0x69);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x0C);
    WriteRegisterByte(RegisterType::L, 0x11);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF58, 0x00);
    WriteMemory(0x643A, 0x58);
    WriteMemory(0x6439, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9E);
    CheckRegisterByte(RegisterType::B, 0x3F);
    CheckRegisterByte(RegisterType::C, 0xB6);
    CheckRegisterByte(RegisterType::D, 0x69);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x0C);
    CheckRegisterByte(RegisterType::L, 0x11);
    CheckRegisterWord(RegisterType::PC, 0x643B);
    CheckRegisterWord(RegisterType::SP, 0x2CB7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6439, 0xE0);
    CheckMemory(0x643A, 0x58);
    CheckMemory(0xFF58, 0x9E);
}

void test_E0_0350()
{
    if (skip_test_E0_0350)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4CCC);
    WriteRegisterWord(RegisterType::SP, 0x8ABF);
    WriteRegisterByte(RegisterType::A, 0x1D);
    WriteRegisterByte(RegisterType::B, 0x0A);
    WriteRegisterByte(RegisterType::C, 0xCD);
    WriteRegisterByte(RegisterType::D, 0x78);
    WriteRegisterByte(RegisterType::E, 0xAF);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xD4);
    WriteRegisterByte(RegisterType::L, 0x2C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF51, 0x00);
    WriteMemory(0x4CCD, 0x51);
    WriteMemory(0x4CCC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1D);
    CheckRegisterByte(RegisterType::B, 0x0A);
    CheckRegisterByte(RegisterType::C, 0xCD);
    CheckRegisterByte(RegisterType::D, 0x78);
    CheckRegisterByte(RegisterType::E, 0xAF);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xD4);
    CheckRegisterByte(RegisterType::L, 0x2C);
    CheckRegisterWord(RegisterType::PC, 0x4CCE);
    CheckRegisterWord(RegisterType::SP, 0x8ABF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x4CCC, 0xE0);
    CheckMemory(0x4CCD, 0x51);
    CheckMemory(0xFF51, 0x1D);
}

void test_E0_0351()
{
    if (skip_test_E0_0351)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5277);
    WriteRegisterWord(RegisterType::SP, 0xBA0A);
    WriteRegisterByte(RegisterType::A, 0x03);
    WriteRegisterByte(RegisterType::B, 0xC7);
    WriteRegisterByte(RegisterType::C, 0xD6);
    WriteRegisterByte(RegisterType::D, 0xA9);
    WriteRegisterByte(RegisterType::E, 0x87);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x4D);
    WriteRegisterByte(RegisterType::L, 0x7F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEB, 0x00);
    WriteMemory(0x5278, 0xEB);
    WriteMemory(0x5277, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x03);
    CheckRegisterByte(RegisterType::B, 0xC7);
    CheckRegisterByte(RegisterType::C, 0xD6);
    CheckRegisterByte(RegisterType::D, 0xA9);
    CheckRegisterByte(RegisterType::E, 0x87);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x4D);
    CheckRegisterByte(RegisterType::L, 0x7F);
    CheckRegisterWord(RegisterType::PC, 0x5279);
    CheckRegisterWord(RegisterType::SP, 0xBA0A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5277, 0xE0);
    CheckMemory(0x5278, 0xEB);
    CheckMemory(0xFFEB, 0x03);
}

void test_E0_0352()
{
    if (skip_test_E0_0352)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2659);
    WriteRegisterWord(RegisterType::SP, 0x9DCE);
    WriteRegisterByte(RegisterType::A, 0xD7);
    WriteRegisterByte(RegisterType::B, 0x8B);
    WriteRegisterByte(RegisterType::C, 0xA9);
    WriteRegisterByte(RegisterType::D, 0x02);
    WriteRegisterByte(RegisterType::E, 0x17);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xEA);
    WriteRegisterByte(RegisterType::L, 0x64);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDA, 0x00);
    WriteMemory(0x265A, 0xDA);
    WriteMemory(0x2659, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD7);
    CheckRegisterByte(RegisterType::B, 0x8B);
    CheckRegisterByte(RegisterType::C, 0xA9);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0x17);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xEA);
    CheckRegisterByte(RegisterType::L, 0x64);
    CheckRegisterWord(RegisterType::PC, 0x265B);
    CheckRegisterWord(RegisterType::SP, 0x9DCE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2659, 0xE0);
    CheckMemory(0x265A, 0xDA);
    CheckMemory(0xFFDA, 0xD7);
}

void test_E0_0353()
{
    if (skip_test_E0_0353)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBDC7);
    WriteRegisterWord(RegisterType::SP, 0x13CD);
    WriteRegisterByte(RegisterType::A, 0xC0);
    WriteRegisterByte(RegisterType::B, 0x76);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0x46);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x8D);
    WriteRegisterByte(RegisterType::L, 0x51);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB6, 0x00);
    WriteMemory(0xBDC8, 0xB6);
    WriteMemory(0xBDC7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC0);
    CheckRegisterByte(RegisterType::B, 0x76);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0x46);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x8D);
    CheckRegisterByte(RegisterType::L, 0x51);
    CheckRegisterWord(RegisterType::PC, 0xBDC9);
    CheckRegisterWord(RegisterType::SP, 0x13CD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xBDC7, 0xE0);
    CheckMemory(0xBDC8, 0xB6);
    CheckMemory(0xFFB6, 0xC0);
}

void test_E0_0354()
{
    if (skip_test_E0_0354)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x48B6);
    WriteRegisterWord(RegisterType::SP, 0x1EAF);
    WriteRegisterByte(RegisterType::A, 0x68);
    WriteRegisterByte(RegisterType::B, 0x7A);
    WriteRegisterByte(RegisterType::C, 0xD9);
    WriteRegisterByte(RegisterType::D, 0xBD);
    WriteRegisterByte(RegisterType::E, 0x77);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xF9);
    WriteRegisterByte(RegisterType::L, 0xB0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF00, 0x00);
    WriteMemory(0x48B7, 0x00);
    WriteMemory(0x48B6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x68);
    CheckRegisterByte(RegisterType::B, 0x7A);
    CheckRegisterByte(RegisterType::C, 0xD9);
    CheckRegisterByte(RegisterType::D, 0xBD);
    CheckRegisterByte(RegisterType::E, 0x77);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xF9);
    CheckRegisterByte(RegisterType::L, 0xB0);
    CheckRegisterWord(RegisterType::PC, 0x48B8);
    CheckRegisterWord(RegisterType::SP, 0x1EAF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x48B6, 0xE0);
    CheckMemory(0x48B7, 0x00);
    CheckMemory(0xFF00, 0x68);
}

void test_E0_0355()
{
    if (skip_test_E0_0355)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC319);
    WriteRegisterWord(RegisterType::SP, 0xD49C);
    WriteRegisterByte(RegisterType::A, 0x7D);
    WriteRegisterByte(RegisterType::B, 0xA8);
    WriteRegisterByte(RegisterType::C, 0x5A);
    WriteRegisterByte(RegisterType::D, 0x75);
    WriteRegisterByte(RegisterType::E, 0xD3);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0xD9);
    WriteRegisterByte(RegisterType::L, 0xF4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3F, 0x00);
    WriteMemory(0xC31A, 0x3F);
    WriteMemory(0xC319, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7D);
    CheckRegisterByte(RegisterType::B, 0xA8);
    CheckRegisterByte(RegisterType::C, 0x5A);
    CheckRegisterByte(RegisterType::D, 0x75);
    CheckRegisterByte(RegisterType::E, 0xD3);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0xD9);
    CheckRegisterByte(RegisterType::L, 0xF4);
    CheckRegisterWord(RegisterType::PC, 0xC31B);
    CheckRegisterWord(RegisterType::SP, 0xD49C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC319, 0xE0);
    CheckMemory(0xC31A, 0x3F);
    CheckMemory(0xFF3F, 0x7D);
}

void test_E0_0356()
{
    if (skip_test_E0_0356)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0B7F);
    WriteRegisterWord(RegisterType::SP, 0xAE0D);
    WriteRegisterByte(RegisterType::A, 0x15);
    WriteRegisterByte(RegisterType::B, 0xFA);
    WriteRegisterByte(RegisterType::C, 0x63);
    WriteRegisterByte(RegisterType::D, 0xAC);
    WriteRegisterByte(RegisterType::E, 0x89);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x43);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB1, 0x00);
    WriteMemory(0x0B80, 0xB1);
    WriteMemory(0x0B7F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x15);
    CheckRegisterByte(RegisterType::B, 0xFA);
    CheckRegisterByte(RegisterType::C, 0x63);
    CheckRegisterByte(RegisterType::D, 0xAC);
    CheckRegisterByte(RegisterType::E, 0x89);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x43);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0x0B81);
    CheckRegisterWord(RegisterType::SP, 0xAE0D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0B7F, 0xE0);
    CheckMemory(0x0B80, 0xB1);
    CheckMemory(0xFFB1, 0x15);
}

void test_E0_0357()
{
    if (skip_test_E0_0357)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xACEE);
    WriteRegisterWord(RegisterType::SP, 0x7854);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0x08);
    WriteRegisterByte(RegisterType::C, 0xC4);
    WriteRegisterByte(RegisterType::D, 0x32);
    WriteRegisterByte(RegisterType::E, 0xB1);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x3D);
    WriteRegisterByte(RegisterType::L, 0x52);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF52, 0x00);
    WriteMemory(0xACEF, 0x52);
    WriteMemory(0xACEE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0x08);
    CheckRegisterByte(RegisterType::C, 0xC4);
    CheckRegisterByte(RegisterType::D, 0x32);
    CheckRegisterByte(RegisterType::E, 0xB1);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x3D);
    CheckRegisterByte(RegisterType::L, 0x52);
    CheckRegisterWord(RegisterType::PC, 0xACF0);
    CheckRegisterWord(RegisterType::SP, 0x7854);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xACEE, 0xE0);
    CheckMemory(0xACEF, 0x52);
    CheckMemory(0xFF52, 0x78);
}

void test_E0_0358()
{
    if (skip_test_E0_0358)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1F59);
    WriteRegisterWord(RegisterType::SP, 0xB5B0);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x3E);
    WriteRegisterByte(RegisterType::C, 0xE9);
    WriteRegisterByte(RegisterType::D, 0xAE);
    WriteRegisterByte(RegisterType::E, 0x49);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x85);
    WriteRegisterByte(RegisterType::L, 0x6B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF11, 0x00);
    WriteMemory(0x1F5A, 0x11);
    WriteMemory(0x1F59, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x3E);
    CheckRegisterByte(RegisterType::C, 0xE9);
    CheckRegisterByte(RegisterType::D, 0xAE);
    CheckRegisterByte(RegisterType::E, 0x49);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x85);
    CheckRegisterByte(RegisterType::L, 0x6B);
    CheckRegisterWord(RegisterType::PC, 0x1F5B);
    CheckRegisterWord(RegisterType::SP, 0xB5B0);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1F59, 0xE0);
    CheckMemory(0x1F5A, 0x11);
    CheckMemory(0xFF11, 0xC2);
}

void test_E0_0359()
{
    if (skip_test_E0_0359)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB7A5);
    WriteRegisterWord(RegisterType::SP, 0x8260);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0xF9);
    WriteRegisterByte(RegisterType::C, 0x95);
    WriteRegisterByte(RegisterType::D, 0x68);
    WriteRegisterByte(RegisterType::E, 0x35);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xF4);
    WriteRegisterByte(RegisterType::L, 0x19);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFEC, 0x00);
    WriteMemory(0xB7A6, 0xEC);
    WriteMemory(0xB7A5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0xF9);
    CheckRegisterByte(RegisterType::C, 0x95);
    CheckRegisterByte(RegisterType::D, 0x68);
    CheckRegisterByte(RegisterType::E, 0x35);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xF4);
    CheckRegisterByte(RegisterType::L, 0x19);
    CheckRegisterWord(RegisterType::PC, 0xB7A7);
    CheckRegisterWord(RegisterType::SP, 0x8260);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB7A5, 0xE0);
    CheckMemory(0xB7A6, 0xEC);
    CheckMemory(0xFFEC, 0x9B);
}

void test_E0_035A()
{
    if (skip_test_E0_035A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x29C7);
    WriteRegisterWord(RegisterType::SP, 0xDC64);
    WriteRegisterByte(RegisterType::A, 0x48);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0xEB);
    WriteRegisterByte(RegisterType::D, 0xC9);
    WriteRegisterByte(RegisterType::E, 0x9D);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x26);
    WriteRegisterByte(RegisterType::L, 0x92);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC0, 0x00);
    WriteMemory(0x29C8, 0xC0);
    WriteMemory(0x29C7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x48);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0xEB);
    CheckRegisterByte(RegisterType::D, 0xC9);
    CheckRegisterByte(RegisterType::E, 0x9D);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x26);
    CheckRegisterByte(RegisterType::L, 0x92);
    CheckRegisterWord(RegisterType::PC, 0x29C9);
    CheckRegisterWord(RegisterType::SP, 0xDC64);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x29C7, 0xE0);
    CheckMemory(0x29C8, 0xC0);
    CheckMemory(0xFFC0, 0x48);
}

void test_E0_035B()
{
    if (skip_test_E0_035B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7823);
    WriteRegisterWord(RegisterType::SP, 0xE2C3);
    WriteRegisterByte(RegisterType::A, 0x4F);
    WriteRegisterByte(RegisterType::B, 0x21);
    WriteRegisterByte(RegisterType::C, 0x1C);
    WriteRegisterByte(RegisterType::D, 0xBF);
    WriteRegisterByte(RegisterType::E, 0x12);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0x77);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF23, 0x00);
    WriteMemory(0x7824, 0x23);
    WriteMemory(0x7823, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4F);
    CheckRegisterByte(RegisterType::B, 0x21);
    CheckRegisterByte(RegisterType::C, 0x1C);
    CheckRegisterByte(RegisterType::D, 0xBF);
    CheckRegisterByte(RegisterType::E, 0x12);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0x77);
    CheckRegisterWord(RegisterType::PC, 0x7825);
    CheckRegisterWord(RegisterType::SP, 0xE2C3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7823, 0xE0);
    CheckMemory(0x7824, 0x23);
    CheckMemory(0xFF23, 0x4F);
}

void test_E0_035C()
{
    if (skip_test_E0_035C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x22CF);
    WriteRegisterWord(RegisterType::SP, 0x299E);
    WriteRegisterByte(RegisterType::A, 0x74);
    WriteRegisterByte(RegisterType::B, 0x1B);
    WriteRegisterByte(RegisterType::C, 0x93);
    WriteRegisterByte(RegisterType::D, 0x73);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xDF);
    WriteRegisterByte(RegisterType::L, 0x6D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF8F, 0x00);
    WriteMemory(0x22D0, 0x8F);
    WriteMemory(0x22CF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x74);
    CheckRegisterByte(RegisterType::B, 0x1B);
    CheckRegisterByte(RegisterType::C, 0x93);
    CheckRegisterByte(RegisterType::D, 0x73);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xDF);
    CheckRegisterByte(RegisterType::L, 0x6D);
    CheckRegisterWord(RegisterType::PC, 0x22D1);
    CheckRegisterWord(RegisterType::SP, 0x299E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x22CF, 0xE0);
    CheckMemory(0x22D0, 0x8F);
    CheckMemory(0xFF8F, 0x74);
}

void test_E0_035D()
{
    if (skip_test_E0_035D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDC49);
    WriteRegisterWord(RegisterType::SP, 0x9CCF);
    WriteRegisterByte(RegisterType::A, 0xD5);
    WriteRegisterByte(RegisterType::B, 0x99);
    WriteRegisterByte(RegisterType::C, 0x43);
    WriteRegisterByte(RegisterType::D, 0x9F);
    WriteRegisterByte(RegisterType::E, 0xF8);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0xEF);
    WriteRegisterByte(RegisterType::L, 0xAA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF35, 0x00);
    WriteMemory(0xDC4A, 0x35);
    WriteMemory(0xDC49, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD5);
    CheckRegisterByte(RegisterType::B, 0x99);
    CheckRegisterByte(RegisterType::C, 0x43);
    CheckRegisterByte(RegisterType::D, 0x9F);
    CheckRegisterByte(RegisterType::E, 0xF8);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0xEF);
    CheckRegisterByte(RegisterType::L, 0xAA);
    CheckRegisterWord(RegisterType::PC, 0xDC4B);
    CheckRegisterWord(RegisterType::SP, 0x9CCF);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDC49, 0xE0);
    CheckMemory(0xDC4A, 0x35);
    CheckMemory(0xFF35, 0xD5);
}

void test_E0_035E()
{
    if (skip_test_E0_035E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDC28);
    WriteRegisterWord(RegisterType::SP, 0xDD12);
    WriteRegisterByte(RegisterType::A, 0xF5);
    WriteRegisterByte(RegisterType::B, 0x1F);
    WriteRegisterByte(RegisterType::C, 0xE5);
    WriteRegisterByte(RegisterType::D, 0x38);
    WriteRegisterByte(RegisterType::E, 0x42);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x19);
    WriteRegisterByte(RegisterType::L, 0x59);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF88, 0x00);
    WriteMemory(0xDC29, 0x88);
    WriteMemory(0xDC28, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF5);
    CheckRegisterByte(RegisterType::B, 0x1F);
    CheckRegisterByte(RegisterType::C, 0xE5);
    CheckRegisterByte(RegisterType::D, 0x38);
    CheckRegisterByte(RegisterType::E, 0x42);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x19);
    CheckRegisterByte(RegisterType::L, 0x59);
    CheckRegisterWord(RegisterType::PC, 0xDC2A);
    CheckRegisterWord(RegisterType::SP, 0xDD12);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDC28, 0xE0);
    CheckMemory(0xDC29, 0x88);
    CheckMemory(0xFF88, 0xF5);
}

void test_E0_035F()
{
    if (skip_test_E0_035F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE9E2);
    WriteRegisterWord(RegisterType::SP, 0xCA5C);
    WriteRegisterByte(RegisterType::A, 0xA0);
    WriteRegisterByte(RegisterType::B, 0x2B);
    WriteRegisterByte(RegisterType::C, 0xAA);
    WriteRegisterByte(RegisterType::D, 0x74);
    WriteRegisterByte(RegisterType::E, 0xF5);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xDB);
    WriteRegisterByte(RegisterType::L, 0x8A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF3B, 0x00);
    WriteMemory(0xE9E3, 0x3B);
    WriteMemory(0xE9E2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA0);
    CheckRegisterByte(RegisterType::B, 0x2B);
    CheckRegisterByte(RegisterType::C, 0xAA);
    CheckRegisterByte(RegisterType::D, 0x74);
    CheckRegisterByte(RegisterType::E, 0xF5);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xDB);
    CheckRegisterByte(RegisterType::L, 0x8A);
    CheckRegisterWord(RegisterType::PC, 0xE9E4);
    CheckRegisterWord(RegisterType::SP, 0xCA5C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE9E2, 0xE0);
    CheckMemory(0xE9E3, 0x3B);
    CheckMemory(0xFF3B, 0xA0);
}

void test_E0_0360()
{
    if (skip_test_E0_0360)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE877);
    WriteRegisterWord(RegisterType::SP, 0xFF16);
    WriteRegisterByte(RegisterType::A, 0x19);
    WriteRegisterByte(RegisterType::B, 0x1B);
    WriteRegisterByte(RegisterType::C, 0x8B);
    WriteRegisterByte(RegisterType::D, 0xC1);
    WriteRegisterByte(RegisterType::E, 0x77);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x09);
    WriteRegisterByte(RegisterType::L, 0x20);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF6E, 0x00);
    WriteMemory(0xE878, 0x6E);
    WriteMemory(0xE877, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x19);
    CheckRegisterByte(RegisterType::B, 0x1B);
    CheckRegisterByte(RegisterType::C, 0x8B);
    CheckRegisterByte(RegisterType::D, 0xC1);
    CheckRegisterByte(RegisterType::E, 0x77);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x09);
    CheckRegisterByte(RegisterType::L, 0x20);
    CheckRegisterWord(RegisterType::PC, 0xE879);
    CheckRegisterWord(RegisterType::SP, 0xFF16);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE877, 0xE0);
    CheckMemory(0xE878, 0x6E);
    CheckMemory(0xFF6E, 0x19);
}

void test_E0_0361()
{
    if (skip_test_E0_0361)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8591);
    WriteRegisterWord(RegisterType::SP, 0xF42E);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0x67);
    WriteRegisterByte(RegisterType::C, 0xC9);
    WriteRegisterByte(RegisterType::D, 0xC7);
    WriteRegisterByte(RegisterType::E, 0xB7);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xB6);
    WriteRegisterByte(RegisterType::L, 0x29);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF24, 0x00);
    WriteMemory(0x8592, 0x24);
    WriteMemory(0x8591, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0x67);
    CheckRegisterByte(RegisterType::C, 0xC9);
    CheckRegisterByte(RegisterType::D, 0xC7);
    CheckRegisterByte(RegisterType::E, 0xB7);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xB6);
    CheckRegisterByte(RegisterType::L, 0x29);
    CheckRegisterWord(RegisterType::PC, 0x8593);
    CheckRegisterWord(RegisterType::SP, 0xF42E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8591, 0xE0);
    CheckMemory(0x8592, 0x24);
    CheckMemory(0xFF24, 0x92);
}

void test_E0_0362()
{
    if (skip_test_E0_0362)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC975);
    WriteRegisterWord(RegisterType::SP, 0xAB7A);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0x9A);
    WriteRegisterByte(RegisterType::C, 0xE6);
    WriteRegisterByte(RegisterType::D, 0x22);
    WriteRegisterByte(RegisterType::E, 0xD1);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xF3);
    WriteRegisterByte(RegisterType::L, 0xB4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5F, 0x00);
    WriteMemory(0xC976, 0x5F);
    WriteMemory(0xC975, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0x9A);
    CheckRegisterByte(RegisterType::C, 0xE6);
    CheckRegisterByte(RegisterType::D, 0x22);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xF3);
    CheckRegisterByte(RegisterType::L, 0xB4);
    CheckRegisterWord(RegisterType::PC, 0xC977);
    CheckRegisterWord(RegisterType::SP, 0xAB7A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC975, 0xE0);
    CheckMemory(0xC976, 0x5F);
    CheckMemory(0xFF5F, 0xCD);
}

void test_E0_0363()
{
    if (skip_test_E0_0363)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2FCC);
    WriteRegisterWord(RegisterType::SP, 0x432E);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0xF7);
    WriteRegisterByte(RegisterType::C, 0x8E);
    WriteRegisterByte(RegisterType::D, 0x44);
    WriteRegisterByte(RegisterType::E, 0xBD);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x3E);
    WriteRegisterByte(RegisterType::L, 0x4A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF8D, 0x00);
    WriteMemory(0x2FCD, 0x8D);
    WriteMemory(0x2FCC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0xF7);
    CheckRegisterByte(RegisterType::C, 0x8E);
    CheckRegisterByte(RegisterType::D, 0x44);
    CheckRegisterByte(RegisterType::E, 0xBD);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x3E);
    CheckRegisterByte(RegisterType::L, 0x4A);
    CheckRegisterWord(RegisterType::PC, 0x2FCE);
    CheckRegisterWord(RegisterType::SP, 0x432E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2FCC, 0xE0);
    CheckMemory(0x2FCD, 0x8D);
    CheckMemory(0xFF8D, 0x78);
}

void test_E0_0364()
{
    if (skip_test_E0_0364)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x456B);
    WriteRegisterWord(RegisterType::SP, 0x99E2);
    WriteRegisterByte(RegisterType::A, 0x66);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0x80);
    WriteRegisterByte(RegisterType::D, 0x39);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xC8);
    WriteRegisterByte(RegisterType::L, 0xC3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF48, 0x00);
    WriteMemory(0x456C, 0x48);
    WriteMemory(0x456B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x66);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0x80);
    CheckRegisterByte(RegisterType::D, 0x39);
    CheckRegisterByte(RegisterType::E, 0xEE);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xC8);
    CheckRegisterByte(RegisterType::L, 0xC3);
    CheckRegisterWord(RegisterType::PC, 0x456D);
    CheckRegisterWord(RegisterType::SP, 0x99E2);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x456B, 0xE0);
    CheckMemory(0x456C, 0x48);
    CheckMemory(0xFF48, 0x66);
}

void test_E0_0365()
{
    if (skip_test_E0_0365)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x67CB);
    WriteRegisterWord(RegisterType::SP, 0xAE4E);
    WriteRegisterByte(RegisterType::A, 0xDF);
    WriteRegisterByte(RegisterType::B, 0x80);
    WriteRegisterByte(RegisterType::C, 0x22);
    WriteRegisterByte(RegisterType::D, 0x9E);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x1D);
    WriteRegisterByte(RegisterType::L, 0x17);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4F, 0x00);
    WriteMemory(0x67CC, 0x4F);
    WriteMemory(0x67CB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDF);
    CheckRegisterByte(RegisterType::B, 0x80);
    CheckRegisterByte(RegisterType::C, 0x22);
    CheckRegisterByte(RegisterType::D, 0x9E);
    CheckRegisterByte(RegisterType::E, 0x95);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x1D);
    CheckRegisterByte(RegisterType::L, 0x17);
    CheckRegisterWord(RegisterType::PC, 0x67CD);
    CheckRegisterWord(RegisterType::SP, 0xAE4E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x67CB, 0xE0);
    CheckMemory(0x67CC, 0x4F);
    CheckMemory(0xFF4F, 0xDF);
}

void test_E0_0366()
{
    if (skip_test_E0_0366)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7D42);
    WriteRegisterWord(RegisterType::SP, 0x9F0C);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0xF5);
    WriteRegisterByte(RegisterType::C, 0x97);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0x69);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x58);
    WriteRegisterByte(RegisterType::L, 0xEA);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF3, 0x00);
    WriteMemory(0x7D43, 0xF3);
    WriteMemory(0x7D42, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0xF5);
    CheckRegisterByte(RegisterType::C, 0x97);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0x69);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x58);
    CheckRegisterByte(RegisterType::L, 0xEA);
    CheckRegisterWord(RegisterType::PC, 0x7D44);
    CheckRegisterWord(RegisterType::SP, 0x9F0C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7D42, 0xE0);
    CheckMemory(0x7D43, 0xF3);
    CheckMemory(0xFFF3, 0x69);
}

void test_E0_0367()
{
    if (skip_test_E0_0367)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3A20);
    WriteRegisterWord(RegisterType::SP, 0xA0E4);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0xD0);
    WriteRegisterByte(RegisterType::C, 0x0F);
    WriteRegisterByte(RegisterType::D, 0x7C);
    WriteRegisterByte(RegisterType::E, 0x68);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x75);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC8, 0x00);
    WriteMemory(0x3A21, 0xC8);
    WriteMemory(0x3A20, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0xD0);
    CheckRegisterByte(RegisterType::C, 0x0F);
    CheckRegisterByte(RegisterType::D, 0x7C);
    CheckRegisterByte(RegisterType::E, 0x68);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x75);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0x3A22);
    CheckRegisterWord(RegisterType::SP, 0xA0E4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3A20, 0xE0);
    CheckMemory(0x3A21, 0xC8);
    CheckMemory(0xFFC8, 0xD0);
}

void test_E0_0368()
{
    if (skip_test_E0_0368)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x04EA);
    WriteRegisterWord(RegisterType::SP, 0x76EB);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0x44);
    WriteRegisterByte(RegisterType::C, 0x9F);
    WriteRegisterByte(RegisterType::D, 0x34);
    WriteRegisterByte(RegisterType::E, 0xEA);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x78);
    WriteRegisterByte(RegisterType::L, 0xBD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF68, 0x00);
    WriteMemory(0x04EB, 0x68);
    WriteMemory(0x04EA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0x44);
    CheckRegisterByte(RegisterType::C, 0x9F);
    CheckRegisterByte(RegisterType::D, 0x34);
    CheckRegisterByte(RegisterType::E, 0xEA);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x78);
    CheckRegisterByte(RegisterType::L, 0xBD);
    CheckRegisterWord(RegisterType::PC, 0x04EC);
    CheckRegisterWord(RegisterType::SP, 0x76EB);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x04EA, 0xE0);
    CheckMemory(0x04EB, 0x68);
    CheckMemory(0xFF68, 0x95);
}

void test_E0_0369()
{
    if (skip_test_E0_0369)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x273F);
    WriteRegisterWord(RegisterType::SP, 0x085B);
    WriteRegisterByte(RegisterType::A, 0x0D);
    WriteRegisterByte(RegisterType::B, 0xD9);
    WriteRegisterByte(RegisterType::C, 0x22);
    WriteRegisterByte(RegisterType::D, 0x35);
    WriteRegisterByte(RegisterType::E, 0x23);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x25);
    WriteRegisterByte(RegisterType::L, 0x13);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF63, 0x00);
    WriteMemory(0x2740, 0x63);
    WriteMemory(0x273F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0D);
    CheckRegisterByte(RegisterType::B, 0xD9);
    CheckRegisterByte(RegisterType::C, 0x22);
    CheckRegisterByte(RegisterType::D, 0x35);
    CheckRegisterByte(RegisterType::E, 0x23);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x25);
    CheckRegisterByte(RegisterType::L, 0x13);
    CheckRegisterWord(RegisterType::PC, 0x2741);
    CheckRegisterWord(RegisterType::SP, 0x085B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x273F, 0xE0);
    CheckMemory(0x2740, 0x63);
    CheckMemory(0xFF63, 0x0D);
}

void test_E0_036A()
{
    if (skip_test_E0_036A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD48B);
    WriteRegisterWord(RegisterType::SP, 0x8A77);
    WriteRegisterByte(RegisterType::A, 0x81);
    WriteRegisterByte(RegisterType::B, 0xC4);
    WriteRegisterByte(RegisterType::C, 0x3E);
    WriteRegisterByte(RegisterType::D, 0xA0);
    WriteRegisterByte(RegisterType::E, 0x82);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x95);
    WriteRegisterByte(RegisterType::L, 0xE0);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE8, 0x00);
    WriteMemory(0xD48C, 0xE8);
    WriteMemory(0xD48B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x81);
    CheckRegisterByte(RegisterType::B, 0xC4);
    CheckRegisterByte(RegisterType::C, 0x3E);
    CheckRegisterByte(RegisterType::D, 0xA0);
    CheckRegisterByte(RegisterType::E, 0x82);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x95);
    CheckRegisterByte(RegisterType::L, 0xE0);
    CheckRegisterWord(RegisterType::PC, 0xD48D);
    CheckRegisterWord(RegisterType::SP, 0x8A77);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD48B, 0xE0);
    CheckMemory(0xD48C, 0xE8);
    CheckMemory(0xFFE8, 0x81);
}

void test_E0_036B()
{
    if (skip_test_E0_036B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEA13);
    WriteRegisterWord(RegisterType::SP, 0x28B3);
    WriteRegisterByte(RegisterType::A, 0x7B);
    WriteRegisterByte(RegisterType::B, 0x7A);
    WriteRegisterByte(RegisterType::C, 0x8A);
    WriteRegisterByte(RegisterType::D, 0x20);
    WriteRegisterByte(RegisterType::E, 0x84);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xD1);
    WriteRegisterByte(RegisterType::L, 0x3F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF43, 0x00);
    WriteMemory(0xEA14, 0x43);
    WriteMemory(0xEA13, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7B);
    CheckRegisterByte(RegisterType::B, 0x7A);
    CheckRegisterByte(RegisterType::C, 0x8A);
    CheckRegisterByte(RegisterType::D, 0x20);
    CheckRegisterByte(RegisterType::E, 0x84);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xD1);
    CheckRegisterByte(RegisterType::L, 0x3F);
    CheckRegisterWord(RegisterType::PC, 0xEA15);
    CheckRegisterWord(RegisterType::SP, 0x28B3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xEA13, 0xE0);
    CheckMemory(0xEA14, 0x43);
    CheckMemory(0xFF43, 0x7B);
}

void test_E0_036C()
{
    if (skip_test_E0_036C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x36B9);
    WriteRegisterWord(RegisterType::SP, 0x9AC9);
    WriteRegisterByte(RegisterType::A, 0x1F);
    WriteRegisterByte(RegisterType::B, 0x2C);
    WriteRegisterByte(RegisterType::C, 0xCF);
    WriteRegisterByte(RegisterType::D, 0x7C);
    WriteRegisterByte(RegisterType::E, 0xBC);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0xF7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF01, 0x00);
    WriteMemory(0x36BA, 0x01);
    WriteMemory(0x36B9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1F);
    CheckRegisterByte(RegisterType::B, 0x2C);
    CheckRegisterByte(RegisterType::C, 0xCF);
    CheckRegisterByte(RegisterType::D, 0x7C);
    CheckRegisterByte(RegisterType::E, 0xBC);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0xF7);
    CheckRegisterWord(RegisterType::PC, 0x36BB);
    CheckRegisterWord(RegisterType::SP, 0x9AC9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x36B9, 0xE0);
    CheckMemory(0x36BA, 0x01);
    CheckMemory(0xFF01, 0x1F);
}

void test_E0_036D()
{
    if (skip_test_E0_036D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD18B);
    WriteRegisterWord(RegisterType::SP, 0xE33E);
    WriteRegisterByte(RegisterType::A, 0x8B);
    WriteRegisterByte(RegisterType::B, 0x0B);
    WriteRegisterByte(RegisterType::C, 0xA3);
    WriteRegisterByte(RegisterType::D, 0xAA);
    WriteRegisterByte(RegisterType::E, 0x3B);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xA7);
    WriteRegisterByte(RegisterType::L, 0x6B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFB9, 0x00);
    WriteMemory(0xD18C, 0xB9);
    WriteMemory(0xD18B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8B);
    CheckRegisterByte(RegisterType::B, 0x0B);
    CheckRegisterByte(RegisterType::C, 0xA3);
    CheckRegisterByte(RegisterType::D, 0xAA);
    CheckRegisterByte(RegisterType::E, 0x3B);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xA7);
    CheckRegisterByte(RegisterType::L, 0x6B);
    CheckRegisterWord(RegisterType::PC, 0xD18D);
    CheckRegisterWord(RegisterType::SP, 0xE33E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD18B, 0xE0);
    CheckMemory(0xD18C, 0xB9);
    CheckMemory(0xFFB9, 0x8B);
}

void test_E0_036E()
{
    if (skip_test_E0_036E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7D3C);
    WriteRegisterWord(RegisterType::SP, 0x014F);
    WriteRegisterByte(RegisterType::A, 0x1E);
    WriteRegisterByte(RegisterType::B, 0x6F);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0x32);
    WriteRegisterByte(RegisterType::E, 0xAE);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x55);
    WriteRegisterByte(RegisterType::L, 0xF3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF52, 0x00);
    WriteMemory(0x7D3D, 0x52);
    WriteMemory(0x7D3C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1E);
    CheckRegisterByte(RegisterType::B, 0x6F);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0x32);
    CheckRegisterByte(RegisterType::E, 0xAE);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x55);
    CheckRegisterByte(RegisterType::L, 0xF3);
    CheckRegisterWord(RegisterType::PC, 0x7D3E);
    CheckRegisterWord(RegisterType::SP, 0x014F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7D3C, 0xE0);
    CheckMemory(0x7D3D, 0x52);
    CheckMemory(0xFF52, 0x1E);
}

void test_E0_036F()
{
    if (skip_test_E0_036F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6BE5);
    WriteRegisterWord(RegisterType::SP, 0xC24E);
    WriteRegisterByte(RegisterType::A, 0xF6);
    WriteRegisterByte(RegisterType::B, 0xC7);
    WriteRegisterByte(RegisterType::C, 0x0E);
    WriteRegisterByte(RegisterType::D, 0x2E);
    WriteRegisterByte(RegisterType::E, 0x25);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x4F);
    WriteRegisterByte(RegisterType::L, 0x8D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF66, 0x00);
    WriteMemory(0x6BE6, 0x66);
    WriteMemory(0x6BE5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF6);
    CheckRegisterByte(RegisterType::B, 0xC7);
    CheckRegisterByte(RegisterType::C, 0x0E);
    CheckRegisterByte(RegisterType::D, 0x2E);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x4F);
    CheckRegisterByte(RegisterType::L, 0x8D);
    CheckRegisterWord(RegisterType::PC, 0x6BE7);
    CheckRegisterWord(RegisterType::SP, 0xC24E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6BE5, 0xE0);
    CheckMemory(0x6BE6, 0x66);
    CheckMemory(0xFF66, 0xF6);
}

void test_E0_0370()
{
    if (skip_test_E0_0370)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3FB3);
    WriteRegisterWord(RegisterType::SP, 0x6F62);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x07);
    WriteRegisterByte(RegisterType::D, 0x42);
    WriteRegisterByte(RegisterType::E, 0x97);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x84);
    WriteRegisterByte(RegisterType::L, 0x9C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF5F, 0x00);
    WriteMemory(0x3FB4, 0x5F);
    WriteMemory(0x3FB3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x07);
    CheckRegisterByte(RegisterType::D, 0x42);
    CheckRegisterByte(RegisterType::E, 0x97);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x84);
    CheckRegisterByte(RegisterType::L, 0x9C);
    CheckRegisterWord(RegisterType::PC, 0x3FB5);
    CheckRegisterWord(RegisterType::SP, 0x6F62);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3FB3, 0xE0);
    CheckMemory(0x3FB4, 0x5F);
    CheckMemory(0xFF5F, 0x95);
}

void test_E0_0371()
{
    if (skip_test_E0_0371)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC2E7);
    WriteRegisterWord(RegisterType::SP, 0xFC2E);
    WriteRegisterByte(RegisterType::A, 0xF8);
    WriteRegisterByte(RegisterType::B, 0x3D);
    WriteRegisterByte(RegisterType::C, 0x17);
    WriteRegisterByte(RegisterType::D, 0x7D);
    WriteRegisterByte(RegisterType::E, 0x13);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x28);
    WriteRegisterByte(RegisterType::L, 0x27);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF62, 0x00);
    WriteMemory(0xC2E8, 0x62);
    WriteMemory(0xC2E7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF8);
    CheckRegisterByte(RegisterType::B, 0x3D);
    CheckRegisterByte(RegisterType::C, 0x17);
    CheckRegisterByte(RegisterType::D, 0x7D);
    CheckRegisterByte(RegisterType::E, 0x13);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x28);
    CheckRegisterByte(RegisterType::L, 0x27);
    CheckRegisterWord(RegisterType::PC, 0xC2E9);
    CheckRegisterWord(RegisterType::SP, 0xFC2E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC2E7, 0xE0);
    CheckMemory(0xC2E8, 0x62);
    CheckMemory(0xFF62, 0xF8);
}

void test_E0_0372()
{
    if (skip_test_E0_0372)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0988);
    WriteRegisterWord(RegisterType::SP, 0xFDB2);
    WriteRegisterByte(RegisterType::A, 0x4F);
    WriteRegisterByte(RegisterType::B, 0x4E);
    WriteRegisterByte(RegisterType::C, 0x2A);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0xC9);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0x2E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD9, 0x00);
    WriteMemory(0x0989, 0xD9);
    WriteMemory(0x0988, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x4F);
    CheckRegisterByte(RegisterType::B, 0x4E);
    CheckRegisterByte(RegisterType::C, 0x2A);
    CheckRegisterByte(RegisterType::D, 0xD4);
    CheckRegisterByte(RegisterType::E, 0xC9);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0x2E);
    CheckRegisterWord(RegisterType::PC, 0x098A);
    CheckRegisterWord(RegisterType::SP, 0xFDB2);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0988, 0xE0);
    CheckMemory(0x0989, 0xD9);
    CheckMemory(0xFFD9, 0x4F);
}

void test_E0_0373()
{
    if (skip_test_E0_0373)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x10D5);
    WriteRegisterWord(RegisterType::SP, 0x78F4);
    WriteRegisterByte(RegisterType::A, 0x43);
    WriteRegisterByte(RegisterType::B, 0xBF);
    WriteRegisterByte(RegisterType::C, 0x33);
    WriteRegisterByte(RegisterType::D, 0x2F);
    WriteRegisterByte(RegisterType::E, 0x34);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xD1);
    WriteRegisterByte(RegisterType::L, 0x42);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF48, 0x00);
    WriteMemory(0x10D6, 0x48);
    WriteMemory(0x10D5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x43);
    CheckRegisterByte(RegisterType::B, 0xBF);
    CheckRegisterByte(RegisterType::C, 0x33);
    CheckRegisterByte(RegisterType::D, 0x2F);
    CheckRegisterByte(RegisterType::E, 0x34);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xD1);
    CheckRegisterByte(RegisterType::L, 0x42);
    CheckRegisterWord(RegisterType::PC, 0x10D7);
    CheckRegisterWord(RegisterType::SP, 0x78F4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x10D5, 0xE0);
    CheckMemory(0x10D6, 0x48);
    CheckMemory(0xFF48, 0x43);
}

void test_E0_0374()
{
    if (skip_test_E0_0374)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5AE5);
    WriteRegisterWord(RegisterType::SP, 0x0272);
    WriteRegisterByte(RegisterType::A, 0x0C);
    WriteRegisterByte(RegisterType::B, 0x61);
    WriteRegisterByte(RegisterType::C, 0xD0);
    WriteRegisterByte(RegisterType::D, 0x66);
    WriteRegisterByte(RegisterType::E, 0xBC);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xFF);
    WriteRegisterByte(RegisterType::L, 0xE9);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF05, 0x00);
    WriteMemory(0x5AE6, 0x05);
    WriteMemory(0x5AE5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0C);
    CheckRegisterByte(RegisterType::B, 0x61);
    CheckRegisterByte(RegisterType::C, 0xD0);
    CheckRegisterByte(RegisterType::D, 0x66);
    CheckRegisterByte(RegisterType::E, 0xBC);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xFF);
    CheckRegisterByte(RegisterType::L, 0xE9);
    CheckRegisterWord(RegisterType::PC, 0x5AE7);
    CheckRegisterWord(RegisterType::SP, 0x0272);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5AE5, 0xE0);
    CheckMemory(0x5AE6, 0x05);
    CheckMemory(0xFF05, 0x0C);
}

void test_E0_0375()
{
    if (skip_test_E0_0375)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x340D);
    WriteRegisterWord(RegisterType::SP, 0xB415);
    WriteRegisterByte(RegisterType::A, 0xB7);
    WriteRegisterByte(RegisterType::B, 0xB9);
    WriteRegisterByte(RegisterType::C, 0x1F);
    WriteRegisterByte(RegisterType::D, 0x54);
    WriteRegisterByte(RegisterType::E, 0xD1);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x5D);
    WriteRegisterByte(RegisterType::L, 0x5A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF31, 0x00);
    WriteMemory(0x340E, 0x31);
    WriteMemory(0x340D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB7);
    CheckRegisterByte(RegisterType::B, 0xB9);
    CheckRegisterByte(RegisterType::C, 0x1F);
    CheckRegisterByte(RegisterType::D, 0x54);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x5D);
    CheckRegisterByte(RegisterType::L, 0x5A);
    CheckRegisterWord(RegisterType::PC, 0x340F);
    CheckRegisterWord(RegisterType::SP, 0xB415);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x340D, 0xE0);
    CheckMemory(0x340E, 0x31);
    CheckMemory(0xFF31, 0xB7);
}

void test_E0_0376()
{
    if (skip_test_E0_0376)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x51DE);
    WriteRegisterWord(RegisterType::SP, 0x05FE);
    WriteRegisterByte(RegisterType::A, 0xE0);
    WriteRegisterByte(RegisterType::B, 0xF3);
    WriteRegisterByte(RegisterType::C, 0x54);
    WriteRegisterByte(RegisterType::D, 0x3B);
    WriteRegisterByte(RegisterType::E, 0x5A);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xC5);
    WriteRegisterByte(RegisterType::L, 0x62);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCE, 0x00);
    WriteMemory(0x51DF, 0xCE);
    WriteMemory(0x51DE, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE0);
    CheckRegisterByte(RegisterType::B, 0xF3);
    CheckRegisterByte(RegisterType::C, 0x54);
    CheckRegisterByte(RegisterType::D, 0x3B);
    CheckRegisterByte(RegisterType::E, 0x5A);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xC5);
    CheckRegisterByte(RegisterType::L, 0x62);
    CheckRegisterWord(RegisterType::PC, 0x51E0);
    CheckRegisterWord(RegisterType::SP, 0x05FE);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x51DE, 0xE0);
    CheckMemory(0x51DF, 0xCE);
    CheckMemory(0xFFCE, 0xE0);
}

void test_E0_0377()
{
    if (skip_test_E0_0377)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFFE7);
    WriteRegisterWord(RegisterType::SP, 0xB08C);
    WriteRegisterByte(RegisterType::A, 0x23);
    WriteRegisterByte(RegisterType::B, 0xAE);
    WriteRegisterByte(RegisterType::C, 0x79);
    WriteRegisterByte(RegisterType::D, 0xFC);
    WriteRegisterByte(RegisterType::E, 0xC5);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x7B);
    WriteRegisterByte(RegisterType::L, 0x7A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFE8, 0x25);
    WriteMemory(0xFFE7, 0xE0);
    WriteMemory(0xFF25, 0x00);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x23);
    CheckRegisterByte(RegisterType::B, 0xAE);
    CheckRegisterByte(RegisterType::C, 0x79);
    CheckRegisterByte(RegisterType::D, 0xFC);
    CheckRegisterByte(RegisterType::E, 0xC5);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x7B);
    CheckRegisterByte(RegisterType::L, 0x7A);
    CheckRegisterWord(RegisterType::PC, 0xFFE9);
    CheckRegisterWord(RegisterType::SP, 0xB08C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFF25, 0x23);
    CheckMemory(0xFFE7, 0xE0);
    CheckMemory(0xFFE8, 0x25);
}

void test_E0_0378()
{
    if (skip_test_E0_0378)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0FF4);
    WriteRegisterWord(RegisterType::SP, 0x97C7);
    WriteRegisterByte(RegisterType::A, 0x1B);
    WriteRegisterByte(RegisterType::B, 0xEE);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0xA6);
    WriteRegisterByte(RegisterType::E, 0x0D);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x42);
    WriteRegisterByte(RegisterType::L, 0xC7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF5, 0x00);
    WriteMemory(0x0FF5, 0xF5);
    WriteMemory(0x0FF4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1B);
    CheckRegisterByte(RegisterType::B, 0xEE);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0xA6);
    CheckRegisterByte(RegisterType::E, 0x0D);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x42);
    CheckRegisterByte(RegisterType::L, 0xC7);
    CheckRegisterWord(RegisterType::PC, 0x0FF6);
    CheckRegisterWord(RegisterType::SP, 0x97C7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x0FF4, 0xE0);
    CheckMemory(0x0FF5, 0xF5);
    CheckMemory(0xFFF5, 0x1B);
}

void test_E0_0379()
{
    if (skip_test_E0_0379)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEC4D);
    WriteRegisterWord(RegisterType::SP, 0xA6E8);
    WriteRegisterByte(RegisterType::A, 0x8E);
    WriteRegisterByte(RegisterType::B, 0x04);
    WriteRegisterByte(RegisterType::C, 0x0C);
    WriteRegisterByte(RegisterType::D, 0x84);
    WriteRegisterByte(RegisterType::E, 0x73);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x2F);
    WriteRegisterByte(RegisterType::L, 0x00);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFDF, 0x00);
    WriteMemory(0xEC4E, 0xDF);
    WriteMemory(0xEC4D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8E);
    CheckRegisterByte(RegisterType::B, 0x04);
    CheckRegisterByte(RegisterType::C, 0x0C);
    CheckRegisterByte(RegisterType::D, 0x84);
    CheckRegisterByte(RegisterType::E, 0x73);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x2F);
    CheckRegisterByte(RegisterType::L, 0x00);
    CheckRegisterWord(RegisterType::PC, 0xEC4F);
    CheckRegisterWord(RegisterType::SP, 0xA6E8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEC4D, 0xE0);
    CheckMemory(0xEC4E, 0xDF);
    CheckMemory(0xFFDF, 0x8E);
}

void test_E0_037A()
{
    if (skip_test_E0_037A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDA97);
    WriteRegisterWord(RegisterType::SP, 0xF627);
    WriteRegisterByte(RegisterType::A, 0x2E);
    WriteRegisterByte(RegisterType::B, 0x43);
    WriteRegisterByte(RegisterType::C, 0xD2);
    WriteRegisterByte(RegisterType::D, 0x3D);
    WriteRegisterByte(RegisterType::E, 0x4D);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xFA);
    WriteRegisterByte(RegisterType::L, 0x2E);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF16, 0x00);
    WriteMemory(0xDA98, 0x16);
    WriteMemory(0xDA97, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2E);
    CheckRegisterByte(RegisterType::B, 0x43);
    CheckRegisterByte(RegisterType::C, 0xD2);
    CheckRegisterByte(RegisterType::D, 0x3D);
    CheckRegisterByte(RegisterType::E, 0x4D);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xFA);
    CheckRegisterByte(RegisterType::L, 0x2E);
    CheckRegisterWord(RegisterType::PC, 0xDA99);
    CheckRegisterWord(RegisterType::SP, 0xF627);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDA97, 0xE0);
    CheckMemory(0xDA98, 0x16);
    CheckMemory(0xFF16, 0x2E);
}

void test_E0_037B()
{
    if (skip_test_E0_037B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA1C3);
    WriteRegisterWord(RegisterType::SP, 0x08B9);
    WriteRegisterByte(RegisterType::A, 0xA3);
    WriteRegisterByte(RegisterType::B, 0xE0);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0x1B);
    WriteRegisterByte(RegisterType::E, 0xD3);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x84);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFBE, 0x00);
    WriteMemory(0xA1C4, 0xBE);
    WriteMemory(0xA1C3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA3);
    CheckRegisterByte(RegisterType::B, 0xE0);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0x1B);
    CheckRegisterByte(RegisterType::E, 0xD3);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x84);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0xA1C5);
    CheckRegisterWord(RegisterType::SP, 0x08B9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA1C3, 0xE0);
    CheckMemory(0xA1C4, 0xBE);
    CheckMemory(0xFFBE, 0xA3);
}

void test_E0_037C()
{
    if (skip_test_E0_037C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA2E9);
    WriteRegisterWord(RegisterType::SP, 0xF480);
    WriteRegisterByte(RegisterType::A, 0x2E);
    WriteRegisterByte(RegisterType::B, 0x96);
    WriteRegisterByte(RegisterType::C, 0x62);
    WriteRegisterByte(RegisterType::D, 0x3C);
    WriteRegisterByte(RegisterType::E, 0xBF);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0x07);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF37, 0x00);
    WriteMemory(0xA2EA, 0x37);
    WriteMemory(0xA2E9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2E);
    CheckRegisterByte(RegisterType::B, 0x96);
    CheckRegisterByte(RegisterType::C, 0x62);
    CheckRegisterByte(RegisterType::D, 0x3C);
    CheckRegisterByte(RegisterType::E, 0xBF);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0x07);
    CheckRegisterWord(RegisterType::PC, 0xA2EB);
    CheckRegisterWord(RegisterType::SP, 0xF480);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA2E9, 0xE0);
    CheckMemory(0xA2EA, 0x37);
    CheckMemory(0xFF37, 0x2E);
}

void test_E0_037D()
{
    if (skip_test_E0_037D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB5E7);
    WriteRegisterWord(RegisterType::SP, 0xD883);
    WriteRegisterByte(RegisterType::A, 0xA6);
    WriteRegisterByte(RegisterType::B, 0xD3);
    WriteRegisterByte(RegisterType::C, 0x52);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0x5E);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xF6);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF27, 0x00);
    WriteMemory(0xB5E8, 0x27);
    WriteMemory(0xB5E7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA6);
    CheckRegisterByte(RegisterType::B, 0xD3);
    CheckRegisterByte(RegisterType::C, 0x52);
    CheckRegisterByte(RegisterType::D, 0x7B);
    CheckRegisterByte(RegisterType::E, 0x5E);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xF6);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0xB5E9);
    CheckRegisterWord(RegisterType::SP, 0xD883);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB5E7, 0xE0);
    CheckMemory(0xB5E8, 0x27);
    CheckMemory(0xFF27, 0xA6);
}

void test_E0_037E()
{
    if (skip_test_E0_037E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x36D1);
    WriteRegisterWord(RegisterType::SP, 0x8CC6);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0x0C);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0x52);
    WriteRegisterByte(RegisterType::E, 0x68);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xCE);
    WriteRegisterByte(RegisterType::L, 0xD4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9F, 0x00);
    WriteMemory(0x36D2, 0x9F);
    WriteMemory(0x36D1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0x0C);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0x52);
    CheckRegisterByte(RegisterType::E, 0x68);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xCE);
    CheckRegisterByte(RegisterType::L, 0xD4);
    CheckRegisterWord(RegisterType::PC, 0x36D3);
    CheckRegisterWord(RegisterType::SP, 0x8CC6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x36D1, 0xE0);
    CheckMemory(0x36D2, 0x9F);
    CheckMemory(0xFF9F, 0x44);
}

void test_E0_037F()
{
    if (skip_test_E0_037F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3BEA);
    WriteRegisterWord(RegisterType::SP, 0xFE90);
    WriteRegisterByte(RegisterType::A, 0xC8);
    WriteRegisterByte(RegisterType::B, 0x78);
    WriteRegisterByte(RegisterType::C, 0x84);
    WriteRegisterByte(RegisterType::D, 0xBB);
    WriteRegisterByte(RegisterType::E, 0xEA);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xCA);
    WriteRegisterByte(RegisterType::L, 0x3F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3D, 0x00);
    WriteMemory(0x3BEB, 0x3D);
    WriteMemory(0x3BEA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC8);
    CheckRegisterByte(RegisterType::B, 0x78);
    CheckRegisterByte(RegisterType::C, 0x84);
    CheckRegisterByte(RegisterType::D, 0xBB);
    CheckRegisterByte(RegisterType::E, 0xEA);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xCA);
    CheckRegisterByte(RegisterType::L, 0x3F);
    CheckRegisterWord(RegisterType::PC, 0x3BEC);
    CheckRegisterWord(RegisterType::SP, 0xFE90);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3BEA, 0xE0);
    CheckMemory(0x3BEB, 0x3D);
    CheckMemory(0xFF3D, 0xC8);
}

void test_E0_0380()
{
    if (skip_test_E0_0380)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC60D);
    WriteRegisterWord(RegisterType::SP, 0x450F);
    WriteRegisterByte(RegisterType::A, 0x21);
    WriteRegisterByte(RegisterType::B, 0x5E);
    WriteRegisterByte(RegisterType::C, 0xDB);
    WriteRegisterByte(RegisterType::D, 0xB7);
    WriteRegisterByte(RegisterType::E, 0x43);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x67);
    WriteRegisterByte(RegisterType::L, 0xAC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF95, 0x00);
    WriteMemory(0xC60E, 0x95);
    WriteMemory(0xC60D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x21);
    CheckRegisterByte(RegisterType::B, 0x5E);
    CheckRegisterByte(RegisterType::C, 0xDB);
    CheckRegisterByte(RegisterType::D, 0xB7);
    CheckRegisterByte(RegisterType::E, 0x43);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x67);
    CheckRegisterByte(RegisterType::L, 0xAC);
    CheckRegisterWord(RegisterType::PC, 0xC60F);
    CheckRegisterWord(RegisterType::SP, 0x450F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC60D, 0xE0);
    CheckMemory(0xC60E, 0x95);
    CheckMemory(0xFF95, 0x21);
}

void test_E0_0381()
{
    if (skip_test_E0_0381)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1547);
    WriteRegisterWord(RegisterType::SP, 0x1C62);
    WriteRegisterByte(RegisterType::A, 0xEF);
    WriteRegisterByte(RegisterType::B, 0x73);
    WriteRegisterByte(RegisterType::C, 0x66);
    WriteRegisterByte(RegisterType::D, 0xD6);
    WriteRegisterByte(RegisterType::E, 0x0E);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x2D);
    WriteRegisterByte(RegisterType::L, 0x89);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF39, 0x00);
    WriteMemory(0x1548, 0x39);
    WriteMemory(0x1547, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEF);
    CheckRegisterByte(RegisterType::B, 0x73);
    CheckRegisterByte(RegisterType::C, 0x66);
    CheckRegisterByte(RegisterType::D, 0xD6);
    CheckRegisterByte(RegisterType::E, 0x0E);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x2D);
    CheckRegisterByte(RegisterType::L, 0x89);
    CheckRegisterWord(RegisterType::PC, 0x1549);
    CheckRegisterWord(RegisterType::SP, 0x1C62);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x1547, 0xE0);
    CheckMemory(0x1548, 0x39);
    CheckMemory(0xFF39, 0xEF);
}

void test_E0_0382()
{
    if (skip_test_E0_0382)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2DCB);
    WriteRegisterWord(RegisterType::SP, 0x657A);
    WriteRegisterByte(RegisterType::A, 0x60);
    WriteRegisterByte(RegisterType::B, 0x87);
    WriteRegisterByte(RegisterType::C, 0x11);
    WriteRegisterByte(RegisterType::D, 0x16);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0xEA);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFEF, 0x00);
    WriteMemory(0x2DCC, 0xEF);
    WriteMemory(0x2DCB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x60);
    CheckRegisterByte(RegisterType::B, 0x87);
    CheckRegisterByte(RegisterType::C, 0x11);
    CheckRegisterByte(RegisterType::D, 0x16);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0xEA);
    CheckRegisterWord(RegisterType::PC, 0x2DCD);
    CheckRegisterWord(RegisterType::SP, 0x657A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2DCB, 0xE0);
    CheckMemory(0x2DCC, 0xEF);
    CheckMemory(0xFFEF, 0x60);
}

void test_E0_0383()
{
    if (skip_test_E0_0383)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB463);
    WriteRegisterWord(RegisterType::SP, 0x79AD);
    WriteRegisterByte(RegisterType::A, 0x39);
    WriteRegisterByte(RegisterType::B, 0xA8);
    WriteRegisterByte(RegisterType::C, 0x79);
    WriteRegisterByte(RegisterType::D, 0x3E);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x55);
    WriteRegisterByte(RegisterType::L, 0x7A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC0, 0x00);
    WriteMemory(0xB464, 0xC0);
    WriteMemory(0xB463, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x39);
    CheckRegisterByte(RegisterType::B, 0xA8);
    CheckRegisterByte(RegisterType::C, 0x79);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x55);
    CheckRegisterByte(RegisterType::L, 0x7A);
    CheckRegisterWord(RegisterType::PC, 0xB465);
    CheckRegisterWord(RegisterType::SP, 0x79AD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB463, 0xE0);
    CheckMemory(0xB464, 0xC0);
    CheckMemory(0xFFC0, 0x39);
}

void test_E0_0384()
{
    if (skip_test_E0_0384)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3FFF);
    WriteRegisterWord(RegisterType::SP, 0xE0DF);
    WriteRegisterByte(RegisterType::A, 0x1B);
    WriteRegisterByte(RegisterType::B, 0x64);
    WriteRegisterByte(RegisterType::C, 0xE9);
    WriteRegisterByte(RegisterType::D, 0x83);
    WriteRegisterByte(RegisterType::E, 0xF9);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x23);
    WriteRegisterByte(RegisterType::L, 0xD7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB8, 0x00);
    WriteMemory(0x4000, 0xB8);
    WriteMemory(0x3FFF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1B);
    CheckRegisterByte(RegisterType::B, 0x64);
    CheckRegisterByte(RegisterType::C, 0xE9);
    CheckRegisterByte(RegisterType::D, 0x83);
    CheckRegisterByte(RegisterType::E, 0xF9);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x23);
    CheckRegisterByte(RegisterType::L, 0xD7);
    CheckRegisterWord(RegisterType::PC, 0x4001);
    CheckRegisterWord(RegisterType::SP, 0xE0DF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3FFF, 0xE0);
    CheckMemory(0x4000, 0xB8);
    CheckMemory(0xFFB8, 0x1B);
}

void test_E0_0385()
{
    if (skip_test_E0_0385)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB21A);
    WriteRegisterWord(RegisterType::SP, 0x09CB);
    WriteRegisterByte(RegisterType::A, 0x81);
    WriteRegisterByte(RegisterType::B, 0x53);
    WriteRegisterByte(RegisterType::C, 0x6D);
    WriteRegisterByte(RegisterType::D, 0x1F);
    WriteRegisterByte(RegisterType::E, 0xCF);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x02);
    WriteRegisterByte(RegisterType::L, 0x31);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF23, 0x00);
    WriteMemory(0xB21B, 0x23);
    WriteMemory(0xB21A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x81);
    CheckRegisterByte(RegisterType::B, 0x53);
    CheckRegisterByte(RegisterType::C, 0x6D);
    CheckRegisterByte(RegisterType::D, 0x1F);
    CheckRegisterByte(RegisterType::E, 0xCF);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x02);
    CheckRegisterByte(RegisterType::L, 0x31);
    CheckRegisterWord(RegisterType::PC, 0xB21C);
    CheckRegisterWord(RegisterType::SP, 0x09CB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB21A, 0xE0);
    CheckMemory(0xB21B, 0x23);
    CheckMemory(0xFF23, 0x81);
}

void test_E0_0386()
{
    if (skip_test_E0_0386)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE030);
    WriteRegisterWord(RegisterType::SP, 0x92AD);
    WriteRegisterByte(RegisterType::A, 0x6F);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0x73);
    WriteRegisterByte(RegisterType::D, 0x02);
    WriteRegisterByte(RegisterType::E, 0x32);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x6B);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF03, 0x00);
    WriteMemory(0xE031, 0x03);
    WriteMemory(0xE030, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6F);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0x73);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0x32);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x6B);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0xE032);
    CheckRegisterWord(RegisterType::SP, 0x92AD);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xE030, 0xE0);
    CheckMemory(0xE031, 0x03);
    CheckMemory(0xFF03, 0x6F);
}

void test_E0_0387()
{
    if (skip_test_E0_0387)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x96A4);
    WriteRegisterWord(RegisterType::SP, 0xDA96);
    WriteRegisterByte(RegisterType::A, 0xFA);
    WriteRegisterByte(RegisterType::B, 0x99);
    WriteRegisterByte(RegisterType::C, 0x77);
    WriteRegisterByte(RegisterType::D, 0x07);
    WriteRegisterByte(RegisterType::E, 0xDA);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x03);
    WriteRegisterByte(RegisterType::L, 0x32);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF22, 0x00);
    WriteMemory(0x96A5, 0x22);
    WriteMemory(0x96A4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xFA);
    CheckRegisterByte(RegisterType::B, 0x99);
    CheckRegisterByte(RegisterType::C, 0x77);
    CheckRegisterByte(RegisterType::D, 0x07);
    CheckRegisterByte(RegisterType::E, 0xDA);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x03);
    CheckRegisterByte(RegisterType::L, 0x32);
    CheckRegisterWord(RegisterType::PC, 0x96A6);
    CheckRegisterWord(RegisterType::SP, 0xDA96);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x96A4, 0xE0);
    CheckMemory(0x96A5, 0x22);
    CheckMemory(0xFF22, 0xFA);
}

void test_E0_0388()
{
    if (skip_test_E0_0388)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC876);
    WriteRegisterWord(RegisterType::SP, 0x5FAF);
    WriteRegisterByte(RegisterType::A, 0xB8);
    WriteRegisterByte(RegisterType::B, 0x65);
    WriteRegisterByte(RegisterType::C, 0x9E);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0x47);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x55);
    WriteRegisterByte(RegisterType::L, 0x87);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF1B, 0x00);
    WriteMemory(0xC877, 0x1B);
    WriteMemory(0xC876, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB8);
    CheckRegisterByte(RegisterType::B, 0x65);
    CheckRegisterByte(RegisterType::C, 0x9E);
    CheckRegisterByte(RegisterType::D, 0x7B);
    CheckRegisterByte(RegisterType::E, 0x47);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x55);
    CheckRegisterByte(RegisterType::L, 0x87);
    CheckRegisterWord(RegisterType::PC, 0xC878);
    CheckRegisterWord(RegisterType::SP, 0x5FAF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC876, 0xE0);
    CheckMemory(0xC877, 0x1B);
    CheckMemory(0xFF1B, 0xB8);
}

void test_E0_0389()
{
    if (skip_test_E0_0389)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2BBA);
    WriteRegisterWord(RegisterType::SP, 0xE442);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0x57);
    WriteRegisterByte(RegisterType::C, 0x62);
    WriteRegisterByte(RegisterType::D, 0x1B);
    WriteRegisterByte(RegisterType::E, 0x3D);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x76);
    WriteRegisterByte(RegisterType::L, 0xB0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF23, 0x00);
    WriteMemory(0x2BBB, 0x23);
    WriteMemory(0x2BBA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0x57);
    CheckRegisterByte(RegisterType::C, 0x62);
    CheckRegisterByte(RegisterType::D, 0x1B);
    CheckRegisterByte(RegisterType::E, 0x3D);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x76);
    CheckRegisterByte(RegisterType::L, 0xB0);
    CheckRegisterWord(RegisterType::PC, 0x2BBC);
    CheckRegisterWord(RegisterType::SP, 0xE442);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2BBA, 0xE0);
    CheckMemory(0x2BBB, 0x23);
    CheckMemory(0xFF23, 0x72);
}

void test_E0_038A()
{
    if (skip_test_E0_038A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3F34);
    WriteRegisterWord(RegisterType::SP, 0x54D1);
    WriteRegisterByte(RegisterType::A, 0x20);
    WriteRegisterByte(RegisterType::B, 0xD2);
    WriteRegisterByte(RegisterType::C, 0xB9);
    WriteRegisterByte(RegisterType::D, 0xBE);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x52);
    WriteRegisterByte(RegisterType::L, 0xC8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC2, 0x00);
    WriteMemory(0x3F35, 0xC2);
    WriteMemory(0x3F34, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x20);
    CheckRegisterByte(RegisterType::B, 0xD2);
    CheckRegisterByte(RegisterType::C, 0xB9);
    CheckRegisterByte(RegisterType::D, 0xBE);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x52);
    CheckRegisterByte(RegisterType::L, 0xC8);
    CheckRegisterWord(RegisterType::PC, 0x3F36);
    CheckRegisterWord(RegisterType::SP, 0x54D1);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3F34, 0xE0);
    CheckMemory(0x3F35, 0xC2);
    CheckMemory(0xFFC2, 0x20);
}

void test_E0_038B()
{
    if (skip_test_E0_038B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0925);
    WriteRegisterWord(RegisterType::SP, 0xFCFC);
    WriteRegisterByte(RegisterType::A, 0x02);
    WriteRegisterByte(RegisterType::B, 0x1A);
    WriteRegisterByte(RegisterType::C, 0x01);
    WriteRegisterByte(RegisterType::D, 0x59);
    WriteRegisterByte(RegisterType::E, 0x17);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x11);
    WriteRegisterByte(RegisterType::L, 0xF4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF1B, 0x00);
    WriteMemory(0x0926, 0x1B);
    WriteMemory(0x0925, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x02);
    CheckRegisterByte(RegisterType::B, 0x1A);
    CheckRegisterByte(RegisterType::C, 0x01);
    CheckRegisterByte(RegisterType::D, 0x59);
    CheckRegisterByte(RegisterType::E, 0x17);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x11);
    CheckRegisterByte(RegisterType::L, 0xF4);
    CheckRegisterWord(RegisterType::PC, 0x0927);
    CheckRegisterWord(RegisterType::SP, 0xFCFC);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0925, 0xE0);
    CheckMemory(0x0926, 0x1B);
    CheckMemory(0xFF1B, 0x02);
}

void test_E0_038C()
{
    if (skip_test_E0_038C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFDF3);
    WriteRegisterWord(RegisterType::SP, 0x9839);
    WriteRegisterByte(RegisterType::A, 0x33);
    WriteRegisterByte(RegisterType::B, 0x39);
    WriteRegisterByte(RegisterType::C, 0x4C);
    WriteRegisterByte(RegisterType::D, 0x91);
    WriteRegisterByte(RegisterType::E, 0xAE);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x64);
    WriteRegisterByte(RegisterType::L, 0x69);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC0, 0x00);
    WriteMemory(0xFDF4, 0xC0);
    WriteMemory(0xFDF3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x33);
    CheckRegisterByte(RegisterType::B, 0x39);
    CheckRegisterByte(RegisterType::C, 0x4C);
    CheckRegisterByte(RegisterType::D, 0x91);
    CheckRegisterByte(RegisterType::E, 0xAE);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x64);
    CheckRegisterByte(RegisterType::L, 0x69);
    CheckRegisterWord(RegisterType::PC, 0xFDF5);
    CheckRegisterWord(RegisterType::SP, 0x9839);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFDF3, 0xE0);
    CheckMemory(0xFDF4, 0xC0);
    CheckMemory(0xFFC0, 0x33);
}

void test_E0_038D()
{
    if (skip_test_E0_038D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF168);
    WriteRegisterWord(RegisterType::SP, 0x3DA7);
    WriteRegisterByte(RegisterType::A, 0x95);
    WriteRegisterByte(RegisterType::B, 0x78);
    WriteRegisterByte(RegisterType::C, 0x15);
    WriteRegisterByte(RegisterType::D, 0x75);
    WriteRegisterByte(RegisterType::E, 0x95);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x9C);
    WriteRegisterByte(RegisterType::L, 0x2A);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFBD, 0x00);
    WriteMemory(0xF169, 0xBD);
    WriteMemory(0xF168, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x95);
    CheckRegisterByte(RegisterType::B, 0x78);
    CheckRegisterByte(RegisterType::C, 0x15);
    CheckRegisterByte(RegisterType::D, 0x75);
    CheckRegisterByte(RegisterType::E, 0x95);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x9C);
    CheckRegisterByte(RegisterType::L, 0x2A);
    CheckRegisterWord(RegisterType::PC, 0xF16A);
    CheckRegisterWord(RegisterType::SP, 0x3DA7);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF168, 0xE0);
    CheckMemory(0xF169, 0xBD);
    CheckMemory(0xFFBD, 0x95);
}

void test_E0_038E()
{
    if (skip_test_E0_038E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7EB0);
    WriteRegisterWord(RegisterType::SP, 0xC4A3);
    WriteRegisterByte(RegisterType::A, 0x92);
    WriteRegisterByte(RegisterType::B, 0x26);
    WriteRegisterByte(RegisterType::C, 0x9E);
    WriteRegisterByte(RegisterType::D, 0xD6);
    WriteRegisterByte(RegisterType::E, 0x03);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x6B);
    WriteRegisterByte(RegisterType::L, 0xFD);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC3, 0x00);
    WriteMemory(0x7EB1, 0xC3);
    WriteMemory(0x7EB0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x92);
    CheckRegisterByte(RegisterType::B, 0x26);
    CheckRegisterByte(RegisterType::C, 0x9E);
    CheckRegisterByte(RegisterType::D, 0xD6);
    CheckRegisterByte(RegisterType::E, 0x03);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x6B);
    CheckRegisterByte(RegisterType::L, 0xFD);
    CheckRegisterWord(RegisterType::PC, 0x7EB2);
    CheckRegisterWord(RegisterType::SP, 0xC4A3);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x7EB0, 0xE0);
    CheckMemory(0x7EB1, 0xC3);
    CheckMemory(0xFFC3, 0x92);
}

void test_E0_038F()
{
    if (skip_test_E0_038F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1459);
    WriteRegisterWord(RegisterType::SP, 0x5623);
    WriteRegisterByte(RegisterType::A, 0xB6);
    WriteRegisterByte(RegisterType::B, 0x41);
    WriteRegisterByte(RegisterType::C, 0xB8);
    WriteRegisterByte(RegisterType::D, 0x5B);
    WriteRegisterByte(RegisterType::E, 0xA1);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x47);
    WriteRegisterByte(RegisterType::L, 0x39);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF1A, 0x00);
    WriteMemory(0x145A, 0x1A);
    WriteMemory(0x1459, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB6);
    CheckRegisterByte(RegisterType::B, 0x41);
    CheckRegisterByte(RegisterType::C, 0xB8);
    CheckRegisterByte(RegisterType::D, 0x5B);
    CheckRegisterByte(RegisterType::E, 0xA1);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x47);
    CheckRegisterByte(RegisterType::L, 0x39);
    CheckRegisterWord(RegisterType::PC, 0x145B);
    CheckRegisterWord(RegisterType::SP, 0x5623);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1459, 0xE0);
    CheckMemory(0x145A, 0x1A);
    CheckMemory(0xFF1A, 0xB6);
}

void test_E0_0390()
{
    if (skip_test_E0_0390)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3DDC);
    WriteRegisterWord(RegisterType::SP, 0xFE7A);
    WriteRegisterByte(RegisterType::A, 0xF0);
    WriteRegisterByte(RegisterType::B, 0x4F);
    WriteRegisterByte(RegisterType::C, 0x4B);
    WriteRegisterByte(RegisterType::D, 0xD7);
    WriteRegisterByte(RegisterType::E, 0xE5);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xF5);
    WriteRegisterByte(RegisterType::L, 0x0A);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF80, 0x00);
    WriteMemory(0x3DDD, 0x80);
    WriteMemory(0x3DDC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF0);
    CheckRegisterByte(RegisterType::B, 0x4F);
    CheckRegisterByte(RegisterType::C, 0x4B);
    CheckRegisterByte(RegisterType::D, 0xD7);
    CheckRegisterByte(RegisterType::E, 0xE5);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xF5);
    CheckRegisterByte(RegisterType::L, 0x0A);
    CheckRegisterWord(RegisterType::PC, 0x3DDE);
    CheckRegisterWord(RegisterType::SP, 0xFE7A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x3DDC, 0xE0);
    CheckMemory(0x3DDD, 0x80);
    CheckMemory(0xFF80, 0xF0);
}

void test_E0_0391()
{
    if (skip_test_E0_0391)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x74B8);
    WriteRegisterWord(RegisterType::SP, 0x673F);
    WriteRegisterByte(RegisterType::A, 0xEC);
    WriteRegisterByte(RegisterType::B, 0x19);
    WriteRegisterByte(RegisterType::C, 0xF6);
    WriteRegisterByte(RegisterType::D, 0xFD);
    WriteRegisterByte(RegisterType::E, 0x4F);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xAA);
    WriteRegisterByte(RegisterType::L, 0x83);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF07, 0x00);
    WriteMemory(0x74B9, 0x07);
    WriteMemory(0x74B8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEC);
    CheckRegisterByte(RegisterType::B, 0x19);
    CheckRegisterByte(RegisterType::C, 0xF6);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0x4F);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xAA);
    CheckRegisterByte(RegisterType::L, 0x83);
    CheckRegisterWord(RegisterType::PC, 0x74BA);
    CheckRegisterWord(RegisterType::SP, 0x673F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x74B8, 0xE0);
    CheckMemory(0x74B9, 0x07);
    CheckMemory(0xFF07, 0xEC);
}

void test_E0_0392()
{
    if (skip_test_E0_0392)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB4AA);
    WriteRegisterWord(RegisterType::SP, 0x6A5F);
    WriteRegisterByte(RegisterType::A, 0x56);
    WriteRegisterByte(RegisterType::B, 0x64);
    WriteRegisterByte(RegisterType::C, 0xCC);
    WriteRegisterByte(RegisterType::D, 0xBE);
    WriteRegisterByte(RegisterType::E, 0xEC);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0x5D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF83, 0x00);
    WriteMemory(0xB4AB, 0x83);
    WriteMemory(0xB4AA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x56);
    CheckRegisterByte(RegisterType::B, 0x64);
    CheckRegisterByte(RegisterType::C, 0xCC);
    CheckRegisterByte(RegisterType::D, 0xBE);
    CheckRegisterByte(RegisterType::E, 0xEC);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0x5D);
    CheckRegisterWord(RegisterType::PC, 0xB4AC);
    CheckRegisterWord(RegisterType::SP, 0x6A5F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB4AA, 0xE0);
    CheckMemory(0xB4AB, 0x83);
    CheckMemory(0xFF83, 0x56);
}

void test_E0_0393()
{
    if (skip_test_E0_0393)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDFC9);
    WriteRegisterWord(RegisterType::SP, 0xB0A8);
    WriteRegisterByte(RegisterType::A, 0x61);
    WriteRegisterByte(RegisterType::B, 0xBA);
    WriteRegisterByte(RegisterType::C, 0xEB);
    WriteRegisterByte(RegisterType::D, 0x6B);
    WriteRegisterByte(RegisterType::E, 0xA1);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x97);
    WriteRegisterByte(RegisterType::L, 0x95);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF47, 0x00);
    WriteMemory(0xDFCA, 0x47);
    WriteMemory(0xDFC9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x61);
    CheckRegisterByte(RegisterType::B, 0xBA);
    CheckRegisterByte(RegisterType::C, 0xEB);
    CheckRegisterByte(RegisterType::D, 0x6B);
    CheckRegisterByte(RegisterType::E, 0xA1);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x97);
    CheckRegisterByte(RegisterType::L, 0x95);
    CheckRegisterWord(RegisterType::PC, 0xDFCB);
    CheckRegisterWord(RegisterType::SP, 0xB0A8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xDFC9, 0xE0);
    CheckMemory(0xDFCA, 0x47);
    CheckMemory(0xFF47, 0x61);
}

void test_E0_0394()
{
    if (skip_test_E0_0394)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6E42);
    WriteRegisterWord(RegisterType::SP, 0x9AA6);
    WriteRegisterByte(RegisterType::A, 0x7C);
    WriteRegisterByte(RegisterType::B, 0x17);
    WriteRegisterByte(RegisterType::C, 0x6E);
    WriteRegisterByte(RegisterType::D, 0x7B);
    WriteRegisterByte(RegisterType::E, 0x42);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x55);
    WriteRegisterByte(RegisterType::L, 0x5F);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF81, 0x00);
    WriteMemory(0x6E43, 0x81);
    WriteMemory(0x6E42, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7C);
    CheckRegisterByte(RegisterType::B, 0x17);
    CheckRegisterByte(RegisterType::C, 0x6E);
    CheckRegisterByte(RegisterType::D, 0x7B);
    CheckRegisterByte(RegisterType::E, 0x42);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x55);
    CheckRegisterByte(RegisterType::L, 0x5F);
    CheckRegisterWord(RegisterType::PC, 0x6E44);
    CheckRegisterWord(RegisterType::SP, 0x9AA6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6E42, 0xE0);
    CheckMemory(0x6E43, 0x81);
    CheckMemory(0xFF81, 0x7C);
}

void test_E0_0395()
{
    if (skip_test_E0_0395)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5818);
    WriteRegisterWord(RegisterType::SP, 0x2F9D);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0x03);
    WriteRegisterByte(RegisterType::C, 0xBB);
    WriteRegisterByte(RegisterType::D, 0x67);
    WriteRegisterByte(RegisterType::E, 0xA8);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x30);
    WriteRegisterByte(RegisterType::L, 0x35);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF50, 0x00);
    WriteMemory(0x5819, 0x50);
    WriteMemory(0x5818, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0x03);
    CheckRegisterByte(RegisterType::C, 0xBB);
    CheckRegisterByte(RegisterType::D, 0x67);
    CheckRegisterByte(RegisterType::E, 0xA8);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x30);
    CheckRegisterByte(RegisterType::L, 0x35);
    CheckRegisterWord(RegisterType::PC, 0x581A);
    CheckRegisterWord(RegisterType::SP, 0x2F9D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5818, 0xE0);
    CheckMemory(0x5819, 0x50);
    CheckMemory(0xFF50, 0xD1);
}

void test_E0_0396()
{
    if (skip_test_E0_0396)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBACD);
    WriteRegisterWord(RegisterType::SP, 0x78E9);
    WriteRegisterByte(RegisterType::A, 0xAA);
    WriteRegisterByte(RegisterType::B, 0xED);
    WriteRegisterByte(RegisterType::C, 0x83);
    WriteRegisterByte(RegisterType::D, 0xA1);
    WriteRegisterByte(RegisterType::E, 0x08);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x93);
    WriteRegisterByte(RegisterType::L, 0x7C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFA4, 0x00);
    WriteMemory(0xBACE, 0xA4);
    WriteMemory(0xBACD, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAA);
    CheckRegisterByte(RegisterType::B, 0xED);
    CheckRegisterByte(RegisterType::C, 0x83);
    CheckRegisterByte(RegisterType::D, 0xA1);
    CheckRegisterByte(RegisterType::E, 0x08);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x93);
    CheckRegisterByte(RegisterType::L, 0x7C);
    CheckRegisterWord(RegisterType::PC, 0xBACF);
    CheckRegisterWord(RegisterType::SP, 0x78E9);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBACD, 0xE0);
    CheckMemory(0xBACE, 0xA4);
    CheckMemory(0xFFA4, 0xAA);
}

void test_E0_0397()
{
    if (skip_test_E0_0397)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB7BB);
    WriteRegisterWord(RegisterType::SP, 0xAD70);
    WriteRegisterByte(RegisterType::A, 0x1E);
    WriteRegisterByte(RegisterType::B, 0xAF);
    WriteRegisterByte(RegisterType::C, 0xA6);
    WriteRegisterByte(RegisterType::D, 0x10);
    WriteRegisterByte(RegisterType::E, 0x8E);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x58);
    WriteRegisterByte(RegisterType::L, 0x60);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB9, 0x00);
    WriteMemory(0xB7BC, 0xB9);
    WriteMemory(0xB7BB, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1E);
    CheckRegisterByte(RegisterType::B, 0xAF);
    CheckRegisterByte(RegisterType::C, 0xA6);
    CheckRegisterByte(RegisterType::D, 0x10);
    CheckRegisterByte(RegisterType::E, 0x8E);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x58);
    CheckRegisterByte(RegisterType::L, 0x60);
    CheckRegisterWord(RegisterType::PC, 0xB7BD);
    CheckRegisterWord(RegisterType::SP, 0xAD70);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB7BB, 0xE0);
    CheckMemory(0xB7BC, 0xB9);
    CheckMemory(0xFFB9, 0x1E);
}

void test_E0_0398()
{
    if (skip_test_E0_0398)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBEA9);
    WriteRegisterWord(RegisterType::SP, 0x0CA4);
    WriteRegisterByte(RegisterType::A, 0xDF);
    WriteRegisterByte(RegisterType::B, 0x81);
    WriteRegisterByte(RegisterType::C, 0x5C);
    WriteRegisterByte(RegisterType::D, 0xCD);
    WriteRegisterByte(RegisterType::E, 0x10);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x5D);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF1E, 0x00);
    WriteMemory(0xBEAA, 0x1E);
    WriteMemory(0xBEA9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDF);
    CheckRegisterByte(RegisterType::B, 0x81);
    CheckRegisterByte(RegisterType::C, 0x5C);
    CheckRegisterByte(RegisterType::D, 0xCD);
    CheckRegisterByte(RegisterType::E, 0x10);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x5D);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0xBEAB);
    CheckRegisterWord(RegisterType::SP, 0x0CA4);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBEA9, 0xE0);
    CheckMemory(0xBEAA, 0x1E);
    CheckMemory(0xFF1E, 0xDF);
}

void test_E0_0399()
{
    if (skip_test_E0_0399)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC23D);
    WriteRegisterWord(RegisterType::SP, 0xC29E);
    WriteRegisterByte(RegisterType::A, 0xB9);
    WriteRegisterByte(RegisterType::B, 0x02);
    WriteRegisterByte(RegisterType::C, 0x66);
    WriteRegisterByte(RegisterType::D, 0x7F);
    WriteRegisterByte(RegisterType::E, 0x00);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x49);
    WriteRegisterByte(RegisterType::L, 0xFB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFF4, 0x00);
    WriteMemory(0xC23E, 0xF4);
    WriteMemory(0xC23D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB9);
    CheckRegisterByte(RegisterType::B, 0x02);
    CheckRegisterByte(RegisterType::C, 0x66);
    CheckRegisterByte(RegisterType::D, 0x7F);
    CheckRegisterByte(RegisterType::E, 0x00);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x49);
    CheckRegisterByte(RegisterType::L, 0xFB);
    CheckRegisterWord(RegisterType::PC, 0xC23F);
    CheckRegisterWord(RegisterType::SP, 0xC29E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC23D, 0xE0);
    CheckMemory(0xC23E, 0xF4);
    CheckMemory(0xFFF4, 0xB9);
}

void test_E0_039A()
{
    if (skip_test_E0_039A)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD3C0);
    WriteRegisterWord(RegisterType::SP, 0x727B);
    WriteRegisterByte(RegisterType::A, 0xD1);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0x0C);
    WriteRegisterByte(RegisterType::E, 0x69);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x5F);
    WriteRegisterByte(RegisterType::L, 0x66);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD0, 0x00);
    WriteMemory(0xD3C1, 0xD0);
    WriteMemory(0xD3C0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD1);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0x0C);
    CheckRegisterByte(RegisterType::E, 0x69);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x5F);
    CheckRegisterByte(RegisterType::L, 0x66);
    CheckRegisterWord(RegisterType::PC, 0xD3C2);
    CheckRegisterWord(RegisterType::SP, 0x727B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD3C0, 0xE0);
    CheckMemory(0xD3C1, 0xD0);
    CheckMemory(0xFFD0, 0xD1);
}

void test_E0_039B()
{
    if (skip_test_E0_039B)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC190);
    WriteRegisterWord(RegisterType::SP, 0x0014);
    WriteRegisterByte(RegisterType::A, 0x5D);
    WriteRegisterByte(RegisterType::B, 0xDA);
    WriteRegisterByte(RegisterType::C, 0xA2);
    WriteRegisterByte(RegisterType::D, 0x70);
    WriteRegisterByte(RegisterType::E, 0x91);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xF8);
    WriteRegisterByte(RegisterType::L, 0xD2);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF40, 0x00);
    WriteMemory(0xC191, 0x40);
    WriteMemory(0xC190, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5D);
    CheckRegisterByte(RegisterType::B, 0xDA);
    CheckRegisterByte(RegisterType::C, 0xA2);
    CheckRegisterByte(RegisterType::D, 0x70);
    CheckRegisterByte(RegisterType::E, 0x91);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xF8);
    CheckRegisterByte(RegisterType::L, 0xD2);
    CheckRegisterWord(RegisterType::PC, 0xC192);
    CheckRegisterWord(RegisterType::SP, 0x0014);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC190, 0xE0);
    CheckMemory(0xC191, 0x40);
    CheckMemory(0xFF40, 0x5D);
}

void test_E0_039C()
{
    if (skip_test_E0_039C)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x977E);
    WriteRegisterWord(RegisterType::SP, 0x7439);
    WriteRegisterByte(RegisterType::A, 0xEA);
    WriteRegisterByte(RegisterType::B, 0xD1);
    WriteRegisterByte(RegisterType::C, 0x42);
    WriteRegisterByte(RegisterType::D, 0xF8);
    WriteRegisterByte(RegisterType::E, 0xB0);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0x39);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFCD, 0x00);
    WriteMemory(0x977F, 0xCD);
    WriteMemory(0x977E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xEA);
    CheckRegisterByte(RegisterType::B, 0xD1);
    CheckRegisterByte(RegisterType::C, 0x42);
    CheckRegisterByte(RegisterType::D, 0xF8);
    CheckRegisterByte(RegisterType::E, 0xB0);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0x39);
    CheckRegisterWord(RegisterType::PC, 0x9780);
    CheckRegisterWord(RegisterType::SP, 0x7439);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x977E, 0xE0);
    CheckMemory(0x977F, 0xCD);
    CheckMemory(0xFFCD, 0xEA);
}

void test_E0_039D()
{
    if (skip_test_E0_039D)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBD40);
    WriteRegisterWord(RegisterType::SP, 0x978A);
    WriteRegisterByte(RegisterType::A, 0x69);
    WriteRegisterByte(RegisterType::B, 0x69);
    WriteRegisterByte(RegisterType::C, 0x23);
    WriteRegisterByte(RegisterType::D, 0x8C);
    WriteRegisterByte(RegisterType::E, 0x87);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x24);
    WriteRegisterByte(RegisterType::L, 0x03);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9E, 0x00);
    WriteMemory(0xBD41, 0x9E);
    WriteMemory(0xBD40, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x69);
    CheckRegisterByte(RegisterType::B, 0x69);
    CheckRegisterByte(RegisterType::C, 0x23);
    CheckRegisterByte(RegisterType::D, 0x8C);
    CheckRegisterByte(RegisterType::E, 0x87);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x24);
    CheckRegisterByte(RegisterType::L, 0x03);
    CheckRegisterWord(RegisterType::PC, 0xBD42);
    CheckRegisterWord(RegisterType::SP, 0x978A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBD40, 0xE0);
    CheckMemory(0xBD41, 0x9E);
    CheckMemory(0xFF9E, 0x69);
}

void test_E0_039E()
{
    if (skip_test_E0_039E)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0B58);
    WriteRegisterWord(RegisterType::SP, 0x528A);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0xC2);
    WriteRegisterByte(RegisterType::C, 0x01);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0xBB);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x28);
    WriteRegisterByte(RegisterType::L, 0xE6);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF03, 0x00);
    WriteMemory(0x0B59, 0x03);
    WriteMemory(0x0B58, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0xC2);
    CheckRegisterByte(RegisterType::C, 0x01);
    CheckRegisterByte(RegisterType::D, 0x40);
    CheckRegisterByte(RegisterType::E, 0xBB);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x28);
    CheckRegisterByte(RegisterType::L, 0xE6);
    CheckRegisterWord(RegisterType::PC, 0x0B5A);
    CheckRegisterWord(RegisterType::SP, 0x528A);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0B58, 0xE0);
    CheckMemory(0x0B59, 0x03);
    CheckMemory(0xFF03, 0xD0);
}

void test_E0_039F()
{
    if (skip_test_E0_039F)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5A4B);
    WriteRegisterWord(RegisterType::SP, 0xCE01);
    WriteRegisterByte(RegisterType::A, 0x00);
    WriteRegisterByte(RegisterType::B, 0xD7);
    WriteRegisterByte(RegisterType::C, 0xD6);
    WriteRegisterByte(RegisterType::D, 0x4A);
    WriteRegisterByte(RegisterType::E, 0x56);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xE1);
    WriteRegisterByte(RegisterType::L, 0x4C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF1A, 0x00);
    WriteMemory(0x5A4C, 0x1A);
    WriteMemory(0x5A4B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x00);
    CheckRegisterByte(RegisterType::B, 0xD7);
    CheckRegisterByte(RegisterType::C, 0xD6);
    CheckRegisterByte(RegisterType::D, 0x4A);
    CheckRegisterByte(RegisterType::E, 0x56);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xE1);
    CheckRegisterByte(RegisterType::L, 0x4C);
    CheckRegisterWord(RegisterType::PC, 0x5A4D);
    CheckRegisterWord(RegisterType::SP, 0xCE01);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5A4B, 0xE0);
    CheckMemory(0x5A4C, 0x1A);
    CheckMemory(0xFF1A, 0x00);
}

void test_E0_03A0()
{
    if (skip_test_E0_03A0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7E97);
    WriteRegisterWord(RegisterType::SP, 0x325F);
    WriteRegisterByte(RegisterType::A, 0xED);
    WriteRegisterByte(RegisterType::B, 0x03);
    WriteRegisterByte(RegisterType::C, 0x9B);
    WriteRegisterByte(RegisterType::D, 0x6D);
    WriteRegisterByte(RegisterType::E, 0xAF);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xAB);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4D, 0x00);
    WriteMemory(0x7E98, 0x4D);
    WriteMemory(0x7E97, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xED);
    CheckRegisterByte(RegisterType::B, 0x03);
    CheckRegisterByte(RegisterType::C, 0x9B);
    CheckRegisterByte(RegisterType::D, 0x6D);
    CheckRegisterByte(RegisterType::E, 0xAF);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xAB);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0x7E99);
    CheckRegisterWord(RegisterType::SP, 0x325F);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7E97, 0xE0);
    CheckMemory(0x7E98, 0x4D);
    CheckMemory(0xFF4D, 0xED);
}

void test_E0_03A1()
{
    if (skip_test_E0_03A1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x18E9);
    WriteRegisterWord(RegisterType::SP, 0xBF36);
    WriteRegisterByte(RegisterType::A, 0xE0);
    WriteRegisterByte(RegisterType::B, 0x74);
    WriteRegisterByte(RegisterType::C, 0xAD);
    WriteRegisterByte(RegisterType::D, 0xAF);
    WriteRegisterByte(RegisterType::E, 0x71);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0xCC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF1F, 0x00);
    WriteMemory(0x18EA, 0x1F);
    WriteMemory(0x18E9, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE0);
    CheckRegisterByte(RegisterType::B, 0x74);
    CheckRegisterByte(RegisterType::C, 0xAD);
    CheckRegisterByte(RegisterType::D, 0xAF);
    CheckRegisterByte(RegisterType::E, 0x71);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0xCC);
    CheckRegisterWord(RegisterType::PC, 0x18EB);
    CheckRegisterWord(RegisterType::SP, 0xBF36);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x18E9, 0xE0);
    CheckMemory(0x18EA, 0x1F);
    CheckMemory(0xFF1F, 0xE0);
}

void test_E0_03A2()
{
    if (skip_test_E0_03A2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6B92);
    WriteRegisterWord(RegisterType::SP, 0xE08D);
    WriteRegisterByte(RegisterType::A, 0x2B);
    WriteRegisterByte(RegisterType::B, 0xAD);
    WriteRegisterByte(RegisterType::C, 0x40);
    WriteRegisterByte(RegisterType::D, 0x7E);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xE7);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF3E, 0x00);
    WriteMemory(0x6B93, 0x3E);
    WriteMemory(0x6B92, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2B);
    CheckRegisterByte(RegisterType::B, 0xAD);
    CheckRegisterByte(RegisterType::C, 0x40);
    CheckRegisterByte(RegisterType::D, 0x7E);
    CheckRegisterByte(RegisterType::E, 0x83);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xE7);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0x6B94);
    CheckRegisterWord(RegisterType::SP, 0xE08D);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6B92, 0xE0);
    CheckMemory(0x6B93, 0x3E);
    CheckMemory(0xFF3E, 0x2B);
}

void test_E0_03A3()
{
    if (skip_test_E0_03A3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFEC4);
    WriteRegisterWord(RegisterType::SP, 0x6E8D);
    WriteRegisterByte(RegisterType::A, 0x8A);
    WriteRegisterByte(RegisterType::B, 0xCB);
    WriteRegisterByte(RegisterType::C, 0x86);
    WriteRegisterByte(RegisterType::D, 0x39);
    WriteRegisterByte(RegisterType::E, 0x35);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xFD);
    WriteRegisterByte(RegisterType::L, 0x44);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF64, 0x00);
    WriteMemory(0xFEC5, 0x64);
    WriteMemory(0xFEC4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8A);
    CheckRegisterByte(RegisterType::B, 0xCB);
    CheckRegisterByte(RegisterType::C, 0x86);
    CheckRegisterByte(RegisterType::D, 0x39);
    CheckRegisterByte(RegisterType::E, 0x35);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xFD);
    CheckRegisterByte(RegisterType::L, 0x44);
    CheckRegisterWord(RegisterType::PC, 0xFEC6);
    CheckRegisterWord(RegisterType::SP, 0x6E8D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xFEC4, 0xE0);
    CheckMemory(0xFEC5, 0x64);
    CheckMemory(0xFF64, 0x8A);
}

void test_E0_03A4()
{
    if (skip_test_E0_03A4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x89C0);
    WriteRegisterWord(RegisterType::SP, 0x38A6);
    WriteRegisterByte(RegisterType::A, 0x1A);
    WriteRegisterByte(RegisterType::B, 0x96);
    WriteRegisterByte(RegisterType::C, 0x25);
    WriteRegisterByte(RegisterType::D, 0x84);
    WriteRegisterByte(RegisterType::E, 0xF2);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x3F);
    WriteRegisterByte(RegisterType::L, 0xBE);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF80, 0x00);
    WriteMemory(0x89C1, 0x80);
    WriteMemory(0x89C0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x1A);
    CheckRegisterByte(RegisterType::B, 0x96);
    CheckRegisterByte(RegisterType::C, 0x25);
    CheckRegisterByte(RegisterType::D, 0x84);
    CheckRegisterByte(RegisterType::E, 0xF2);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x3F);
    CheckRegisterByte(RegisterType::L, 0xBE);
    CheckRegisterWord(RegisterType::PC, 0x89C2);
    CheckRegisterWord(RegisterType::SP, 0x38A6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x89C0, 0xE0);
    CheckMemory(0x89C1, 0x80);
    CheckMemory(0xFF80, 0x1A);
}

void test_E0_03A5()
{
    if (skip_test_E0_03A5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA1DA);
    WriteRegisterWord(RegisterType::SP, 0x18D8);
    WriteRegisterByte(RegisterType::A, 0x52);
    WriteRegisterByte(RegisterType::B, 0xDA);
    WriteRegisterByte(RegisterType::C, 0x13);
    WriteRegisterByte(RegisterType::D, 0xB8);
    WriteRegisterByte(RegisterType::E, 0xF0);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xC0);
    WriteRegisterByte(RegisterType::L, 0xF6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF41, 0x00);
    WriteMemory(0xA1DB, 0x41);
    WriteMemory(0xA1DA, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x52);
    CheckRegisterByte(RegisterType::B, 0xDA);
    CheckRegisterByte(RegisterType::C, 0x13);
    CheckRegisterByte(RegisterType::D, 0xB8);
    CheckRegisterByte(RegisterType::E, 0xF0);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xC0);
    CheckRegisterByte(RegisterType::L, 0xF6);
    CheckRegisterWord(RegisterType::PC, 0xA1DC);
    CheckRegisterWord(RegisterType::SP, 0x18D8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA1DA, 0xE0);
    CheckMemory(0xA1DB, 0x41);
    CheckMemory(0xFF41, 0x52);
}

void test_E0_03A6()
{
    if (skip_test_E0_03A6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE237);
    WriteRegisterWord(RegisterType::SP, 0xA375);
    WriteRegisterByte(RegisterType::A, 0x37);
    WriteRegisterByte(RegisterType::B, 0xBC);
    WriteRegisterByte(RegisterType::C, 0x85);
    WriteRegisterByte(RegisterType::D, 0xDB);
    WriteRegisterByte(RegisterType::E, 0x00);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xE1);
    WriteRegisterByte(RegisterType::L, 0x87);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF84, 0x00);
    WriteMemory(0xE238, 0x84);
    WriteMemory(0xE237, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x37);
    CheckRegisterByte(RegisterType::B, 0xBC);
    CheckRegisterByte(RegisterType::C, 0x85);
    CheckRegisterByte(RegisterType::D, 0xDB);
    CheckRegisterByte(RegisterType::E, 0x00);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xE1);
    CheckRegisterByte(RegisterType::L, 0x87);
    CheckRegisterWord(RegisterType::PC, 0xE239);
    CheckRegisterWord(RegisterType::SP, 0xA375);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE237, 0xE0);
    CheckMemory(0xE238, 0x84);
    CheckMemory(0xFF84, 0x37);
}

void test_E0_03A7()
{
    if (skip_test_E0_03A7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCB91);
    WriteRegisterWord(RegisterType::SP, 0x20F9);
    WriteRegisterByte(RegisterType::A, 0x73);
    WriteRegisterByte(RegisterType::B, 0xA1);
    WriteRegisterByte(RegisterType::C, 0x69);
    WriteRegisterByte(RegisterType::D, 0xC7);
    WriteRegisterByte(RegisterType::E, 0x56);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xD5);
    WriteRegisterByte(RegisterType::L, 0xB1);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9A, 0x00);
    WriteMemory(0xCB92, 0x9A);
    WriteMemory(0xCB91, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x73);
    CheckRegisterByte(RegisterType::B, 0xA1);
    CheckRegisterByte(RegisterType::C, 0x69);
    CheckRegisterByte(RegisterType::D, 0xC7);
    CheckRegisterByte(RegisterType::E, 0x56);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xD5);
    CheckRegisterByte(RegisterType::L, 0xB1);
    CheckRegisterWord(RegisterType::PC, 0xCB93);
    CheckRegisterWord(RegisterType::SP, 0x20F9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCB91, 0xE0);
    CheckMemory(0xCB92, 0x9A);
    CheckMemory(0xFF9A, 0x73);
}

void test_E0_03A8()
{
    if (skip_test_E0_03A8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x70F2);
    WriteRegisterWord(RegisterType::SP, 0xF58B);
    WriteRegisterByte(RegisterType::A, 0x2B);
    WriteRegisterByte(RegisterType::B, 0x8A);
    WriteRegisterByte(RegisterType::C, 0x1C);
    WriteRegisterByte(RegisterType::D, 0x73);
    WriteRegisterByte(RegisterType::E, 0xA7);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x82);
    WriteRegisterByte(RegisterType::L, 0x88);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC9, 0x00);
    WriteMemory(0x70F3, 0xC9);
    WriteMemory(0x70F2, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2B);
    CheckRegisterByte(RegisterType::B, 0x8A);
    CheckRegisterByte(RegisterType::C, 0x1C);
    CheckRegisterByte(RegisterType::D, 0x73);
    CheckRegisterByte(RegisterType::E, 0xA7);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x82);
    CheckRegisterByte(RegisterType::L, 0x88);
    CheckRegisterWord(RegisterType::PC, 0x70F4);
    CheckRegisterWord(RegisterType::SP, 0xF58B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x70F2, 0xE0);
    CheckMemory(0x70F3, 0xC9);
    CheckMemory(0xFFC9, 0x2B);
}

void test_E0_03A9()
{
    if (skip_test_E0_03A9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA77A);
    WriteRegisterWord(RegisterType::SP, 0xB42B);
    WriteRegisterByte(RegisterType::A, 0x08);
    WriteRegisterByte(RegisterType::B, 0x18);
    WriteRegisterByte(RegisterType::C, 0xED);
    WriteRegisterByte(RegisterType::D, 0xBE);
    WriteRegisterByte(RegisterType::E, 0xD1);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x2C);
    WriteRegisterByte(RegisterType::L, 0x10);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF2E, 0x00);
    WriteMemory(0xA77B, 0x2E);
    WriteMemory(0xA77A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x08);
    CheckRegisterByte(RegisterType::B, 0x18);
    CheckRegisterByte(RegisterType::C, 0xED);
    CheckRegisterByte(RegisterType::D, 0xBE);
    CheckRegisterByte(RegisterType::E, 0xD1);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x2C);
    CheckRegisterByte(RegisterType::L, 0x10);
    CheckRegisterWord(RegisterType::PC, 0xA77C);
    CheckRegisterWord(RegisterType::SP, 0xB42B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA77A, 0xE0);
    CheckMemory(0xA77B, 0x2E);
    CheckMemory(0xFF2E, 0x08);
}

void test_E0_03AA()
{
    if (skip_test_E0_03AA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD696);
    WriteRegisterWord(RegisterType::SP, 0x0935);
    WriteRegisterByte(RegisterType::A, 0xD3);
    WriteRegisterByte(RegisterType::B, 0x8E);
    WriteRegisterByte(RegisterType::C, 0x4A);
    WriteRegisterByte(RegisterType::D, 0x1E);
    WriteRegisterByte(RegisterType::E, 0xFD);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x66);
    WriteRegisterByte(RegisterType::L, 0xEF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF08, 0x00);
    WriteMemory(0xD697, 0x08);
    WriteMemory(0xD696, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD3);
    CheckRegisterByte(RegisterType::B, 0x8E);
    CheckRegisterByte(RegisterType::C, 0x4A);
    CheckRegisterByte(RegisterType::D, 0x1E);
    CheckRegisterByte(RegisterType::E, 0xFD);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x66);
    CheckRegisterByte(RegisterType::L, 0xEF);
    CheckRegisterWord(RegisterType::PC, 0xD698);
    CheckRegisterWord(RegisterType::SP, 0x0935);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD696, 0xE0);
    CheckMemory(0xD697, 0x08);
    CheckMemory(0xFF08, 0xD3);
}

void test_E0_03AB()
{
    if (skip_test_E0_03AB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7BC3);
    WriteRegisterWord(RegisterType::SP, 0x9727);
    WriteRegisterByte(RegisterType::A, 0x76);
    WriteRegisterByte(RegisterType::B, 0x22);
    WriteRegisterByte(RegisterType::C, 0x3F);
    WriteRegisterByte(RegisterType::D, 0x59);
    WriteRegisterByte(RegisterType::E, 0xB5);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x83);
    WriteRegisterByte(RegisterType::L, 0xF7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF66, 0x00);
    WriteMemory(0x7BC4, 0x66);
    WriteMemory(0x7BC3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x76);
    CheckRegisterByte(RegisterType::B, 0x22);
    CheckRegisterByte(RegisterType::C, 0x3F);
    CheckRegisterByte(RegisterType::D, 0x59);
    CheckRegisterByte(RegisterType::E, 0xB5);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x83);
    CheckRegisterByte(RegisterType::L, 0xF7);
    CheckRegisterWord(RegisterType::PC, 0x7BC5);
    CheckRegisterWord(RegisterType::SP, 0x9727);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7BC3, 0xE0);
    CheckMemory(0x7BC4, 0x66);
    CheckMemory(0xFF66, 0x76);
}

void test_E0_03AC()
{
    if (skip_test_E0_03AC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0EF6);
    WriteRegisterWord(RegisterType::SP, 0xAC63);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0x7B);
    WriteRegisterByte(RegisterType::C, 0x41);
    WriteRegisterByte(RegisterType::D, 0x02);
    WriteRegisterByte(RegisterType::E, 0xBF);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x33);
    WriteRegisterByte(RegisterType::L, 0xE7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF2B, 0x00);
    WriteMemory(0x0EF7, 0x2B);
    WriteMemory(0x0EF6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0x7B);
    CheckRegisterByte(RegisterType::C, 0x41);
    CheckRegisterByte(RegisterType::D, 0x02);
    CheckRegisterByte(RegisterType::E, 0xBF);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x33);
    CheckRegisterByte(RegisterType::L, 0xE7);
    CheckRegisterWord(RegisterType::PC, 0x0EF8);
    CheckRegisterWord(RegisterType::SP, 0xAC63);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0EF6, 0xE0);
    CheckMemory(0x0EF7, 0x2B);
    CheckMemory(0xFF2B, 0x9B);
}

void test_E0_03AD()
{
    if (skip_test_E0_03AD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF36A);
    WriteRegisterWord(RegisterType::SP, 0x2C43);
    WriteRegisterByte(RegisterType::A, 0x8C);
    WriteRegisterByte(RegisterType::B, 0x1A);
    WriteRegisterByte(RegisterType::C, 0x4E);
    WriteRegisterByte(RegisterType::D, 0x2B);
    WriteRegisterByte(RegisterType::E, 0x1E);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x8A);
    WriteRegisterByte(RegisterType::L, 0x56);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF1F, 0x00);
    WriteMemory(0xF36B, 0x1F);
    WriteMemory(0xF36A, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8C);
    CheckRegisterByte(RegisterType::B, 0x1A);
    CheckRegisterByte(RegisterType::C, 0x4E);
    CheckRegisterByte(RegisterType::D, 0x2B);
    CheckRegisterByte(RegisterType::E, 0x1E);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x8A);
    CheckRegisterByte(RegisterType::L, 0x56);
    CheckRegisterWord(RegisterType::PC, 0xF36C);
    CheckRegisterWord(RegisterType::SP, 0x2C43);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF36A, 0xE0);
    CheckMemory(0xF36B, 0x1F);
    CheckMemory(0xFF1F, 0x8C);
}

void test_E0_03AE()
{
    if (skip_test_E0_03AE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD40B);
    WriteRegisterWord(RegisterType::SP, 0x5BDA);
    WriteRegisterByte(RegisterType::A, 0x49);
    WriteRegisterByte(RegisterType::B, 0xB6);
    WriteRegisterByte(RegisterType::C, 0x72);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0x60);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x97);
    WriteRegisterByte(RegisterType::L, 0xDB);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF28, 0x00);
    WriteMemory(0xD40C, 0x28);
    WriteMemory(0xD40B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x49);
    CheckRegisterByte(RegisterType::B, 0xB6);
    CheckRegisterByte(RegisterType::C, 0x72);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0x60);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x97);
    CheckRegisterByte(RegisterType::L, 0xDB);
    CheckRegisterWord(RegisterType::PC, 0xD40D);
    CheckRegisterWord(RegisterType::SP, 0x5BDA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD40B, 0xE0);
    CheckMemory(0xD40C, 0x28);
    CheckMemory(0xFF28, 0x49);
}

void test_E0_03AF()
{
    if (skip_test_E0_03AF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC43C);
    WriteRegisterWord(RegisterType::SP, 0xCF66);
    WriteRegisterByte(RegisterType::A, 0x72);
    WriteRegisterByte(RegisterType::B, 0x42);
    WriteRegisterByte(RegisterType::C, 0x59);
    WriteRegisterByte(RegisterType::D, 0xE7);
    WriteRegisterByte(RegisterType::E, 0x8C);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xA2);
    WriteRegisterByte(RegisterType::L, 0x02);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF07, 0x00);
    WriteMemory(0xC43D, 0x07);
    WriteMemory(0xC43C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x72);
    CheckRegisterByte(RegisterType::B, 0x42);
    CheckRegisterByte(RegisterType::C, 0x59);
    CheckRegisterByte(RegisterType::D, 0xE7);
    CheckRegisterByte(RegisterType::E, 0x8C);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xA2);
    CheckRegisterByte(RegisterType::L, 0x02);
    CheckRegisterWord(RegisterType::PC, 0xC43E);
    CheckRegisterWord(RegisterType::SP, 0xCF66);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC43C, 0xE0);
    CheckMemory(0xC43D, 0x07);
    CheckMemory(0xFF07, 0x72);
}

void test_E0_03B0()
{
    if (skip_test_E0_03B0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB2BF);
    WriteRegisterWord(RegisterType::SP, 0xA9D8);
    WriteRegisterByte(RegisterType::A, 0xC9);
    WriteRegisterByte(RegisterType::B, 0x96);
    WriteRegisterByte(RegisterType::C, 0x8B);
    WriteRegisterByte(RegisterType::D, 0xBD);
    WriteRegisterByte(RegisterType::E, 0x40);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0xBF);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF90, 0x00);
    WriteMemory(0xB2C0, 0x90);
    WriteMemory(0xB2BF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC9);
    CheckRegisterByte(RegisterType::B, 0x96);
    CheckRegisterByte(RegisterType::C, 0x8B);
    CheckRegisterByte(RegisterType::D, 0xBD);
    CheckRegisterByte(RegisterType::E, 0x40);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0xBF);
    CheckRegisterWord(RegisterType::PC, 0xB2C1);
    CheckRegisterWord(RegisterType::SP, 0xA9D8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB2BF, 0xE0);
    CheckMemory(0xB2C0, 0x90);
    CheckMemory(0xFF90, 0xC9);
}

void test_E0_03B1()
{
    if (skip_test_E0_03B1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2DC3);
    WriteRegisterWord(RegisterType::SP, 0x69B6);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0xE7);
    WriteRegisterByte(RegisterType::C, 0x4C);
    WriteRegisterByte(RegisterType::D, 0x1D);
    WriteRegisterByte(RegisterType::E, 0xAF);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xA0);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF9E, 0x00);
    WriteMemory(0x2DC4, 0x9E);
    WriteMemory(0x2DC3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0xE7);
    CheckRegisterByte(RegisterType::C, 0x4C);
    CheckRegisterByte(RegisterType::D, 0x1D);
    CheckRegisterByte(RegisterType::E, 0xAF);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xA0);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0x2DC5);
    CheckRegisterWord(RegisterType::SP, 0x69B6);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x2DC3, 0xE0);
    CheckMemory(0x2DC4, 0x9E);
    CheckMemory(0xFF9E, 0x9B);
}

void test_E0_03B2()
{
    if (skip_test_E0_03B2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDFCC);
    WriteRegisterWord(RegisterType::SP, 0xBB59);
    WriteRegisterByte(RegisterType::A, 0x60);
    WriteRegisterByte(RegisterType::B, 0x40);
    WriteRegisterByte(RegisterType::C, 0xEC);
    WriteRegisterByte(RegisterType::D, 0x7C);
    WriteRegisterByte(RegisterType::E, 0x8A);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0x8C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF4, 0x00);
    WriteMemory(0xDFCD, 0xF4);
    WriteMemory(0xDFCC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x60);
    CheckRegisterByte(RegisterType::B, 0x40);
    CheckRegisterByte(RegisterType::C, 0xEC);
    CheckRegisterByte(RegisterType::D, 0x7C);
    CheckRegisterByte(RegisterType::E, 0x8A);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0x8C);
    CheckRegisterWord(RegisterType::PC, 0xDFCE);
    CheckRegisterWord(RegisterType::SP, 0xBB59);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDFCC, 0xE0);
    CheckMemory(0xDFCD, 0xF4);
    CheckMemory(0xFFF4, 0x60);
}

void test_E0_03B3()
{
    if (skip_test_E0_03B3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x1D0B);
    WriteRegisterWord(RegisterType::SP, 0x93E9);
    WriteRegisterByte(RegisterType::A, 0x04);
    WriteRegisterByte(RegisterType::B, 0xB1);
    WriteRegisterByte(RegisterType::C, 0x46);
    WriteRegisterByte(RegisterType::D, 0x3A);
    WriteRegisterByte(RegisterType::E, 0x18);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0xA6);
    WriteRegisterByte(RegisterType::L, 0x0B);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFED, 0x00);
    WriteMemory(0x1D0C, 0xED);
    WriteMemory(0x1D0B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x04);
    CheckRegisterByte(RegisterType::B, 0xB1);
    CheckRegisterByte(RegisterType::C, 0x46);
    CheckRegisterByte(RegisterType::D, 0x3A);
    CheckRegisterByte(RegisterType::E, 0x18);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0xA6);
    CheckRegisterByte(RegisterType::L, 0x0B);
    CheckRegisterWord(RegisterType::PC, 0x1D0D);
    CheckRegisterWord(RegisterType::SP, 0x93E9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x1D0B, 0xE0);
    CheckMemory(0x1D0C, 0xED);
    CheckMemory(0xFFED, 0x04);
}

void test_E0_03B4()
{
    if (skip_test_E0_03B4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x3E51);
    WriteRegisterWord(RegisterType::SP, 0xE64B);
    WriteRegisterByte(RegisterType::A, 0xE5);
    WriteRegisterByte(RegisterType::B, 0x7F);
    WriteRegisterByte(RegisterType::C, 0xF7);
    WriteRegisterByte(RegisterType::D, 0xC3);
    WriteRegisterByte(RegisterType::E, 0x32);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x24);
    WriteRegisterByte(RegisterType::L, 0xB5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF8E, 0x00);
    WriteMemory(0x3E52, 0x8E);
    WriteMemory(0x3E51, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE5);
    CheckRegisterByte(RegisterType::B, 0x7F);
    CheckRegisterByte(RegisterType::C, 0xF7);
    CheckRegisterByte(RegisterType::D, 0xC3);
    CheckRegisterByte(RegisterType::E, 0x32);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x24);
    CheckRegisterByte(RegisterType::L, 0xB5);
    CheckRegisterWord(RegisterType::PC, 0x3E53);
    CheckRegisterWord(RegisterType::SP, 0xE64B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x3E51, 0xE0);
    CheckMemory(0x3E52, 0x8E);
    CheckMemory(0xFF8E, 0xE5);
}

void test_E0_03B5()
{
    if (skip_test_E0_03B5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5106);
    WriteRegisterWord(RegisterType::SP, 0x86C8);
    WriteRegisterByte(RegisterType::A, 0xE2);
    WriteRegisterByte(RegisterType::B, 0xAD);
    WriteRegisterByte(RegisterType::C, 0xA9);
    WriteRegisterByte(RegisterType::D, 0x0B);
    WriteRegisterByte(RegisterType::E, 0xCF);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0x81);
    WriteRegisterByte(RegisterType::L, 0xC7);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF68, 0x00);
    WriteMemory(0x5107, 0x68);
    WriteMemory(0x5106, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xE2);
    CheckRegisterByte(RegisterType::B, 0xAD);
    CheckRegisterByte(RegisterType::C, 0xA9);
    CheckRegisterByte(RegisterType::D, 0x0B);
    CheckRegisterByte(RegisterType::E, 0xCF);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0x81);
    CheckRegisterByte(RegisterType::L, 0xC7);
    CheckRegisterWord(RegisterType::PC, 0x5108);
    CheckRegisterWord(RegisterType::SP, 0x86C8);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5106, 0xE0);
    CheckMemory(0x5107, 0x68);
    CheckMemory(0xFF68, 0xE2);
}

void test_E0_03B6()
{
    if (skip_test_E0_03B6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x004D);
    WriteRegisterWord(RegisterType::SP, 0xE3CD);
    WriteRegisterByte(RegisterType::A, 0x50);
    WriteRegisterByte(RegisterType::B, 0xE2);
    WriteRegisterByte(RegisterType::C, 0x21);
    WriteRegisterByte(RegisterType::D, 0x85);
    WriteRegisterByte(RegisterType::E, 0xEE);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xA5);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF5E, 0x00);
    WriteMemory(0x004E, 0x5E);
    WriteMemory(0x004D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x50);
    CheckRegisterByte(RegisterType::B, 0xE2);
    CheckRegisterByte(RegisterType::C, 0x21);
    CheckRegisterByte(RegisterType::D, 0x85);
    CheckRegisterByte(RegisterType::E, 0xEE);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xA5);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0x004F);
    CheckRegisterWord(RegisterType::SP, 0xE3CD);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x004D, 0xE0);
    CheckMemory(0x004E, 0x5E);
    CheckMemory(0xFF5E, 0x50);
}

void test_E0_03B7()
{
    if (skip_test_E0_03B7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC249);
    WriteRegisterWord(RegisterType::SP, 0xD937);
    WriteRegisterByte(RegisterType::A, 0x86);
    WriteRegisterByte(RegisterType::B, 0x48);
    WriteRegisterByte(RegisterType::C, 0x71);
    WriteRegisterByte(RegisterType::D, 0x9A);
    WriteRegisterByte(RegisterType::E, 0xE1);
    WriteRegisterFlag(0xF0);
    WriteRegisterByte(RegisterType::H, 0x4B);
    WriteRegisterByte(RegisterType::L, 0x6F);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF7B, 0x00);
    WriteMemory(0xC24A, 0x7B);
    WriteMemory(0xC249, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x86);
    CheckRegisterByte(RegisterType::B, 0x48);
    CheckRegisterByte(RegisterType::C, 0x71);
    CheckRegisterByte(RegisterType::D, 0x9A);
    CheckRegisterByte(RegisterType::E, 0xE1);
    CheckRegisterFlag(0xF0);
    CheckRegisterByte(RegisterType::H, 0x4B);
    CheckRegisterByte(RegisterType::L, 0x6F);
    CheckRegisterWord(RegisterType::PC, 0xC24B);
    CheckRegisterWord(RegisterType::SP, 0xD937);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xC249, 0xE0);
    CheckMemory(0xC24A, 0x7B);
    CheckMemory(0xFF7B, 0x86);
}

void test_E0_03B8()
{
    if (skip_test_E0_03B8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xE62C);
    WriteRegisterWord(RegisterType::SP, 0xF11B);
    WriteRegisterByte(RegisterType::A, 0x12);
    WriteRegisterByte(RegisterType::B, 0xBE);
    WriteRegisterByte(RegisterType::C, 0x94);
    WriteRegisterByte(RegisterType::D, 0xCD);
    WriteRegisterByte(RegisterType::E, 0xFF);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x39);
    WriteRegisterByte(RegisterType::L, 0xCC);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2C, 0x00);
    WriteMemory(0xE62D, 0x2C);
    WriteMemory(0xE62C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x12);
    CheckRegisterByte(RegisterType::B, 0xBE);
    CheckRegisterByte(RegisterType::C, 0x94);
    CheckRegisterByte(RegisterType::D, 0xCD);
    CheckRegisterByte(RegisterType::E, 0xFF);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x39);
    CheckRegisterByte(RegisterType::L, 0xCC);
    CheckRegisterWord(RegisterType::PC, 0xE62E);
    CheckRegisterWord(RegisterType::SP, 0xF11B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xE62C, 0xE0);
    CheckMemory(0xE62D, 0x2C);
    CheckMemory(0xFF2C, 0x12);
}

void test_E0_03B9()
{
    if (skip_test_E0_03B9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC393);
    WriteRegisterWord(RegisterType::SP, 0xC08F);
    WriteRegisterByte(RegisterType::A, 0x5B);
    WriteRegisterByte(RegisterType::B, 0xE4);
    WriteRegisterByte(RegisterType::C, 0x00);
    WriteRegisterByte(RegisterType::D, 0xB6);
    WriteRegisterByte(RegisterType::E, 0xE2);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xAB);
    WriteRegisterByte(RegisterType::L, 0xB5);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAD, 0x00);
    WriteMemory(0xC394, 0xAD);
    WriteMemory(0xC393, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x5B);
    CheckRegisterByte(RegisterType::B, 0xE4);
    CheckRegisterByte(RegisterType::C, 0x00);
    CheckRegisterByte(RegisterType::D, 0xB6);
    CheckRegisterByte(RegisterType::E, 0xE2);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xAB);
    CheckRegisterByte(RegisterType::L, 0xB5);
    CheckRegisterWord(RegisterType::PC, 0xC395);
    CheckRegisterWord(RegisterType::SP, 0xC08F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC393, 0xE0);
    CheckMemory(0xC394, 0xAD);
    CheckMemory(0xFFAD, 0x5B);
}

void test_E0_03BA()
{
    if (skip_test_E0_03BA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x0241);
    WriteRegisterWord(RegisterType::SP, 0xFBA4);
    WriteRegisterByte(RegisterType::A, 0x3E);
    WriteRegisterByte(RegisterType::B, 0xDE);
    WriteRegisterByte(RegisterType::C, 0x77);
    WriteRegisterByte(RegisterType::D, 0x3E);
    WriteRegisterByte(RegisterType::E, 0xC4);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0xAF);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAD, 0x00);
    WriteMemory(0x0242, 0xAD);
    WriteMemory(0x0241, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x3E);
    CheckRegisterByte(RegisterType::B, 0xDE);
    CheckRegisterByte(RegisterType::C, 0x77);
    CheckRegisterByte(RegisterType::D, 0x3E);
    CheckRegisterByte(RegisterType::E, 0xC4);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0xAF);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0x0243);
    CheckRegisterWord(RegisterType::SP, 0xFBA4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x0241, 0xE0);
    CheckMemory(0x0242, 0xAD);
    CheckMemory(0xFFAD, 0x3E);
}

void test_E0_03BB()
{
    if (skip_test_E0_03BB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD084);
    WriteRegisterWord(RegisterType::SP, 0x0B5C);
    WriteRegisterByte(RegisterType::A, 0xF2);
    WriteRegisterByte(RegisterType::B, 0x7A);
    WriteRegisterByte(RegisterType::C, 0x5D);
    WriteRegisterByte(RegisterType::D, 0x1A);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xCF);
    WriteRegisterByte(RegisterType::L, 0xF8);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF36, 0x00);
    WriteMemory(0xD085, 0x36);
    WriteMemory(0xD084, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xF2);
    CheckRegisterByte(RegisterType::B, 0x7A);
    CheckRegisterByte(RegisterType::C, 0x5D);
    CheckRegisterByte(RegisterType::D, 0x1A);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xCF);
    CheckRegisterByte(RegisterType::L, 0xF8);
    CheckRegisterWord(RegisterType::PC, 0xD086);
    CheckRegisterWord(RegisterType::SP, 0x0B5C);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD084, 0xE0);
    CheckMemory(0xD085, 0x36);
    CheckMemory(0xFF36, 0xF2);
}

void test_E0_03BC()
{
    if (skip_test_E0_03BC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x24E0);
    WriteRegisterWord(RegisterType::SP, 0xF6D4);
    WriteRegisterByte(RegisterType::A, 0x53);
    WriteRegisterByte(RegisterType::B, 0x58);
    WriteRegisterByte(RegisterType::C, 0x3D);
    WriteRegisterByte(RegisterType::D, 0x1D);
    WriteRegisterByte(RegisterType::E, 0xE7);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x02);
    WriteRegisterByte(RegisterType::L, 0x76);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF30, 0x00);
    WriteMemory(0x24E1, 0x30);
    WriteMemory(0x24E0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x53);
    CheckRegisterByte(RegisterType::B, 0x58);
    CheckRegisterByte(RegisterType::C, 0x3D);
    CheckRegisterByte(RegisterType::D, 0x1D);
    CheckRegisterByte(RegisterType::E, 0xE7);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x02);
    CheckRegisterByte(RegisterType::L, 0x76);
    CheckRegisterWord(RegisterType::PC, 0x24E2);
    CheckRegisterWord(RegisterType::SP, 0xF6D4);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x24E0, 0xE0);
    CheckMemory(0x24E1, 0x30);
    CheckMemory(0xFF30, 0x53);
}

void test_E0_03BD()
{
    if (skip_test_E0_03BD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x939D);
    WriteRegisterWord(RegisterType::SP, 0xC1AE);
    WriteRegisterByte(RegisterType::A, 0x7D);
    WriteRegisterByte(RegisterType::B, 0xBB);
    WriteRegisterByte(RegisterType::C, 0x6A);
    WriteRegisterByte(RegisterType::D, 0x64);
    WriteRegisterByte(RegisterType::E, 0x48);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xAD);
    WriteRegisterByte(RegisterType::L, 0xD6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF92, 0x00);
    WriteMemory(0x939E, 0x92);
    WriteMemory(0x939D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7D);
    CheckRegisterByte(RegisterType::B, 0xBB);
    CheckRegisterByte(RegisterType::C, 0x6A);
    CheckRegisterByte(RegisterType::D, 0x64);
    CheckRegisterByte(RegisterType::E, 0x48);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xAD);
    CheckRegisterByte(RegisterType::L, 0xD6);
    CheckRegisterWord(RegisterType::PC, 0x939F);
    CheckRegisterWord(RegisterType::SP, 0xC1AE);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x939D, 0xE0);
    CheckMemory(0x939E, 0x92);
    CheckMemory(0xFF92, 0x7D);
}

void test_E0_03BE()
{
    if (skip_test_E0_03BE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5BF3);
    WriteRegisterWord(RegisterType::SP, 0x6F23);
    WriteRegisterByte(RegisterType::A, 0xD6);
    WriteRegisterByte(RegisterType::B, 0x63);
    WriteRegisterByte(RegisterType::C, 0xEC);
    WriteRegisterByte(RegisterType::D, 0x9D);
    WriteRegisterByte(RegisterType::E, 0x6E);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x8B);
    WriteRegisterByte(RegisterType::L, 0xDE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF89, 0x00);
    WriteMemory(0x5BF4, 0x89);
    WriteMemory(0x5BF3, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD6);
    CheckRegisterByte(RegisterType::B, 0x63);
    CheckRegisterByte(RegisterType::C, 0xEC);
    CheckRegisterByte(RegisterType::D, 0x9D);
    CheckRegisterByte(RegisterType::E, 0x6E);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x8B);
    CheckRegisterByte(RegisterType::L, 0xDE);
    CheckRegisterWord(RegisterType::PC, 0x5BF5);
    CheckRegisterWord(RegisterType::SP, 0x6F23);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x5BF3, 0xE0);
    CheckMemory(0x5BF4, 0x89);
    CheckMemory(0xFF89, 0xD6);
}

void test_E0_03BF()
{
    if (skip_test_E0_03BF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDBB6);
    WriteRegisterWord(RegisterType::SP, 0x53DB);
    WriteRegisterByte(RegisterType::A, 0xB1);
    WriteRegisterByte(RegisterType::B, 0xE6);
    WriteRegisterByte(RegisterType::C, 0xFF);
    WriteRegisterByte(RegisterType::D, 0xF3);
    WriteRegisterByte(RegisterType::E, 0xFA);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0xA0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF35, 0x00);
    WriteMemory(0xDBB7, 0x35);
    WriteMemory(0xDBB6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB1);
    CheckRegisterByte(RegisterType::B, 0xE6);
    CheckRegisterByte(RegisterType::C, 0xFF);
    CheckRegisterByte(RegisterType::D, 0xF3);
    CheckRegisterByte(RegisterType::E, 0xFA);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0xA0);
    CheckRegisterWord(RegisterType::PC, 0xDBB8);
    CheckRegisterWord(RegisterType::SP, 0x53DB);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDBB6, 0xE0);
    CheckMemory(0xDBB7, 0x35);
    CheckMemory(0xFF35, 0xB1);
}

void test_E0_03C0()
{
    if (skip_test_E0_03C0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x31CC);
    WriteRegisterWord(RegisterType::SP, 0x3209);
    WriteRegisterByte(RegisterType::A, 0x6D);
    WriteRegisterByte(RegisterType::B, 0x6F);
    WriteRegisterByte(RegisterType::C, 0x73);
    WriteRegisterByte(RegisterType::D, 0xFD);
    WriteRegisterByte(RegisterType::E, 0x25);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x98);
    WriteRegisterByte(RegisterType::L, 0x66);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF83, 0x00);
    WriteMemory(0x31CD, 0x83);
    WriteMemory(0x31CC, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6D);
    CheckRegisterByte(RegisterType::B, 0x6F);
    CheckRegisterByte(RegisterType::C, 0x73);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0x25);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x98);
    CheckRegisterByte(RegisterType::L, 0x66);
    CheckRegisterWord(RegisterType::PC, 0x31CE);
    CheckRegisterWord(RegisterType::SP, 0x3209);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x31CC, 0xE0);
    CheckMemory(0x31CD, 0x83);
    CheckMemory(0xFF83, 0x6D);
}

void test_E0_03C1()
{
    if (skip_test_E0_03C1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEEAF);
    WriteRegisterWord(RegisterType::SP, 0x7CE1);
    WriteRegisterByte(RegisterType::A, 0xA7);
    WriteRegisterByte(RegisterType::B, 0xE5);
    WriteRegisterByte(RegisterType::C, 0x3F);
    WriteRegisterByte(RegisterType::D, 0x10);
    WriteRegisterByte(RegisterType::E, 0x74);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x41);
    WriteRegisterByte(RegisterType::L, 0x23);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFFE, 0x00);
    WriteMemory(0xEEB0, 0xFE);
    WriteMemory(0xEEAF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA7);
    CheckRegisterByte(RegisterType::B, 0xE5);
    CheckRegisterByte(RegisterType::C, 0x3F);
    CheckRegisterByte(RegisterType::D, 0x10);
    CheckRegisterByte(RegisterType::E, 0x74);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x41);
    CheckRegisterByte(RegisterType::L, 0x23);
    CheckRegisterWord(RegisterType::PC, 0xEEB1);
    CheckRegisterWord(RegisterType::SP, 0x7CE1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xEEAF, 0xE0);
    CheckMemory(0xEEB0, 0xFE);
    CheckMemory(0xFFFE, 0xA7);
}

void test_E0_03C2()
{
    if (skip_test_E0_03C2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6307);
    WriteRegisterWord(RegisterType::SP, 0x9D9E);
    WriteRegisterByte(RegisterType::A, 0x31);
    WriteRegisterByte(RegisterType::B, 0x80);
    WriteRegisterByte(RegisterType::C, 0x8F);
    WriteRegisterByte(RegisterType::D, 0x65);
    WriteRegisterByte(RegisterType::E, 0xD9);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xFE);
    WriteRegisterByte(RegisterType::L, 0x5B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF80, 0x00);
    WriteMemory(0x6308, 0x80);
    WriteMemory(0x6307, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x31);
    CheckRegisterByte(RegisterType::B, 0x80);
    CheckRegisterByte(RegisterType::C, 0x8F);
    CheckRegisterByte(RegisterType::D, 0x65);
    CheckRegisterByte(RegisterType::E, 0xD9);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xFE);
    CheckRegisterByte(RegisterType::L, 0x5B);
    CheckRegisterWord(RegisterType::PC, 0x6309);
    CheckRegisterWord(RegisterType::SP, 0x9D9E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x6307, 0xE0);
    CheckMemory(0x6308, 0x80);
    CheckMemory(0xFF80, 0x31);
}

void test_E0_03C3()
{
    if (skip_test_E0_03C3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF161);
    WriteRegisterWord(RegisterType::SP, 0x4B13);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0x68);
    WriteRegisterByte(RegisterType::C, 0x73);
    WriteRegisterByte(RegisterType::D, 0x08);
    WriteRegisterByte(RegisterType::E, 0xC4);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0xEA);
    WriteRegisterByte(RegisterType::L, 0xF8);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD4, 0x00);
    WriteMemory(0xF162, 0xD4);
    WriteMemory(0xF161, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0x68);
    CheckRegisterByte(RegisterType::C, 0x73);
    CheckRegisterByte(RegisterType::D, 0x08);
    CheckRegisterByte(RegisterType::E, 0xC4);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0xEA);
    CheckRegisterByte(RegisterType::L, 0xF8);
    CheckRegisterWord(RegisterType::PC, 0xF163);
    CheckRegisterWord(RegisterType::SP, 0x4B13);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xF161, 0xE0);
    CheckMemory(0xF162, 0xD4);
    CheckMemory(0xFFD4, 0xA1);
}

void test_E0_03C4()
{
    if (skip_test_E0_03C4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x9E01);
    WriteRegisterWord(RegisterType::SP, 0x8339);
    WriteRegisterByte(RegisterType::A, 0xA0);
    WriteRegisterByte(RegisterType::B, 0x72);
    WriteRegisterByte(RegisterType::C, 0x64);
    WriteRegisterByte(RegisterType::D, 0x77);
    WriteRegisterByte(RegisterType::E, 0x69);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x6B);
    WriteRegisterByte(RegisterType::L, 0x4D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF52, 0x00);
    WriteMemory(0x9E02, 0x52);
    WriteMemory(0x9E01, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA0);
    CheckRegisterByte(RegisterType::B, 0x72);
    CheckRegisterByte(RegisterType::C, 0x64);
    CheckRegisterByte(RegisterType::D, 0x77);
    CheckRegisterByte(RegisterType::E, 0x69);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x6B);
    CheckRegisterByte(RegisterType::L, 0x4D);
    CheckRegisterWord(RegisterType::PC, 0x9E03);
    CheckRegisterWord(RegisterType::SP, 0x8339);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x9E01, 0xE0);
    CheckMemory(0x9E02, 0x52);
    CheckMemory(0xFF52, 0xA0);
}

void test_E0_03C5()
{
    if (skip_test_E0_03C5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC205);
    WriteRegisterWord(RegisterType::SP, 0xEF25);
    WriteRegisterByte(RegisterType::A, 0x79);
    WriteRegisterByte(RegisterType::B, 0x30);
    WriteRegisterByte(RegisterType::C, 0xEA);
    WriteRegisterByte(RegisterType::D, 0xB0);
    WriteRegisterByte(RegisterType::E, 0xBA);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xA1);
    WriteRegisterByte(RegisterType::L, 0x30);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF2, 0x00);
    WriteMemory(0xC206, 0xF2);
    WriteMemory(0xC205, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x79);
    CheckRegisterByte(RegisterType::B, 0x30);
    CheckRegisterByte(RegisterType::C, 0xEA);
    CheckRegisterByte(RegisterType::D, 0xB0);
    CheckRegisterByte(RegisterType::E, 0xBA);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xA1);
    CheckRegisterByte(RegisterType::L, 0x30);
    CheckRegisterWord(RegisterType::PC, 0xC207);
    CheckRegisterWord(RegisterType::SP, 0xEF25);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC205, 0xE0);
    CheckMemory(0xC206, 0xF2);
    CheckMemory(0xFFF2, 0x79);
}

void test_E0_03C6()
{
    if (skip_test_E0_03C6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x2185);
    WriteRegisterWord(RegisterType::SP, 0xF868);
    WriteRegisterByte(RegisterType::A, 0xAF);
    WriteRegisterByte(RegisterType::B, 0x41);
    WriteRegisterByte(RegisterType::C, 0x80);
    WriteRegisterByte(RegisterType::D, 0x69);
    WriteRegisterByte(RegisterType::E, 0x07);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0xA4);
    WriteRegisterByte(RegisterType::L, 0xC0);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF2C, 0x00);
    WriteMemory(0x2186, 0x2C);
    WriteMemory(0x2185, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xAF);
    CheckRegisterByte(RegisterType::B, 0x41);
    CheckRegisterByte(RegisterType::C, 0x80);
    CheckRegisterByte(RegisterType::D, 0x69);
    CheckRegisterByte(RegisterType::E, 0x07);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0xA4);
    CheckRegisterByte(RegisterType::L, 0xC0);
    CheckRegisterWord(RegisterType::PC, 0x2187);
    CheckRegisterWord(RegisterType::SP, 0xF868);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x2185, 0xE0);
    CheckMemory(0x2186, 0x2C);
    CheckMemory(0xFF2C, 0xAF);
}

void test_E0_03C7()
{
    if (skip_test_E0_03C7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x4B35);
    WriteRegisterWord(RegisterType::SP, 0x5846);
    WriteRegisterByte(RegisterType::A, 0x8D);
    WriteRegisterByte(RegisterType::B, 0x08);
    WriteRegisterByte(RegisterType::C, 0x7F);
    WriteRegisterByte(RegisterType::D, 0x23);
    WriteRegisterByte(RegisterType::E, 0x50);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x37);
    WriteRegisterByte(RegisterType::L, 0xED);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFFC, 0x00);
    WriteMemory(0x4B36, 0xFC);
    WriteMemory(0x4B35, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x8D);
    CheckRegisterByte(RegisterType::B, 0x08);
    CheckRegisterByte(RegisterType::C, 0x7F);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0x50);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x37);
    CheckRegisterByte(RegisterType::L, 0xED);
    CheckRegisterWord(RegisterType::PC, 0x4B37);
    CheckRegisterWord(RegisterType::SP, 0x5846);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x4B35, 0xE0);
    CheckMemory(0x4B36, 0xFC);
    CheckMemory(0xFFFC, 0x8D);
}

void test_E0_03C8()
{
    if (skip_test_E0_03C8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFA0B);
    WriteRegisterWord(RegisterType::SP, 0xD603);
    WriteRegisterByte(RegisterType::A, 0x0A);
    WriteRegisterByte(RegisterType::B, 0x10);
    WriteRegisterByte(RegisterType::C, 0xFE);
    WriteRegisterByte(RegisterType::D, 0xEF);
    WriteRegisterByte(RegisterType::E, 0xCE);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0x47);
    WriteRegisterByte(RegisterType::L, 0x86);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF66, 0x00);
    WriteMemory(0xFA0C, 0x66);
    WriteMemory(0xFA0B, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x0A);
    CheckRegisterByte(RegisterType::B, 0x10);
    CheckRegisterByte(RegisterType::C, 0xFE);
    CheckRegisterByte(RegisterType::D, 0xEF);
    CheckRegisterByte(RegisterType::E, 0xCE);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0x47);
    CheckRegisterByte(RegisterType::L, 0x86);
    CheckRegisterWord(RegisterType::PC, 0xFA0D);
    CheckRegisterWord(RegisterType::SP, 0xD603);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFA0B, 0xE0);
    CheckMemory(0xFA0C, 0x66);
    CheckMemory(0xFF66, 0x0A);
}

void test_E0_03C9()
{
    if (skip_test_E0_03C9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x75C1);
    WriteRegisterWord(RegisterType::SP, 0xA1EA);
    WriteRegisterByte(RegisterType::A, 0xB9);
    WriteRegisterByte(RegisterType::B, 0x25);
    WriteRegisterByte(RegisterType::C, 0x3A);
    WriteRegisterByte(RegisterType::D, 0x40);
    WriteRegisterByte(RegisterType::E, 0x38);
    WriteRegisterFlag(0xD0);
    WriteRegisterByte(RegisterType::H, 0x88);
    WriteRegisterByte(RegisterType::L, 0xA3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF7B, 0x00);
    WriteMemory(0x75C2, 0x7B);
    WriteMemory(0x75C1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB9);
    CheckRegisterByte(RegisterType::B, 0x25);
    CheckRegisterByte(RegisterType::C, 0x3A);
    CheckRegisterByte(RegisterType::D, 0x40);
    CheckRegisterByte(RegisterType::E, 0x38);
    CheckRegisterFlag(0xD0);
    CheckRegisterByte(RegisterType::H, 0x88);
    CheckRegisterByte(RegisterType::L, 0xA3);
    CheckRegisterWord(RegisterType::PC, 0x75C3);
    CheckRegisterWord(RegisterType::SP, 0xA1EA);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x75C1, 0xE0);
    CheckMemory(0x75C2, 0x7B);
    CheckMemory(0xFF7B, 0xB9);
}

void test_E0_03CA()
{
    if (skip_test_E0_03CA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xC545);
    WriteRegisterWord(RegisterType::SP, 0xF206);
    WriteRegisterByte(RegisterType::A, 0x17);
    WriteRegisterByte(RegisterType::B, 0x84);
    WriteRegisterByte(RegisterType::C, 0x54);
    WriteRegisterByte(RegisterType::D, 0x26);
    WriteRegisterByte(RegisterType::E, 0x83);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x5B);
    WriteRegisterByte(RegisterType::L, 0x21);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF26, 0x00);
    WriteMemory(0xC546, 0x26);
    WriteMemory(0xC545, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x17);
    CheckRegisterByte(RegisterType::B, 0x84);
    CheckRegisterByte(RegisterType::C, 0x54);
    CheckRegisterByte(RegisterType::D, 0x26);
    CheckRegisterByte(RegisterType::E, 0x83);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x5B);
    CheckRegisterByte(RegisterType::L, 0x21);
    CheckRegisterWord(RegisterType::PC, 0xC547);
    CheckRegisterWord(RegisterType::SP, 0xF206);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xC545, 0xE0);
    CheckMemory(0xC546, 0x26);
    CheckMemory(0xFF26, 0x17);
}

void test_E0_03CB()
{
    if (skip_test_E0_03CB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD017);
    WriteRegisterWord(RegisterType::SP, 0xAA41);
    WriteRegisterByte(RegisterType::A, 0x19);
    WriteRegisterByte(RegisterType::B, 0xA8);
    WriteRegisterByte(RegisterType::C, 0x8D);
    WriteRegisterByte(RegisterType::D, 0xC6);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0xD3);
    WriteRegisterByte(RegisterType::L, 0xE4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF40, 0x00);
    WriteMemory(0xD018, 0x40);
    WriteMemory(0xD017, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x19);
    CheckRegisterByte(RegisterType::B, 0xA8);
    CheckRegisterByte(RegisterType::C, 0x8D);
    CheckRegisterByte(RegisterType::D, 0xC6);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0xD3);
    CheckRegisterByte(RegisterType::L, 0xE4);
    CheckRegisterWord(RegisterType::PC, 0xD019);
    CheckRegisterWord(RegisterType::SP, 0xAA41);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xD017, 0xE0);
    CheckMemory(0xD018, 0x40);
    CheckMemory(0xFF40, 0x19);
}

void test_E0_03CC()
{
    if (skip_test_E0_03CC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xDCF0);
    WriteRegisterWord(RegisterType::SP, 0x5AD1);
    WriteRegisterByte(RegisterType::A, 0x44);
    WriteRegisterByte(RegisterType::B, 0x26);
    WriteRegisterByte(RegisterType::C, 0xD0);
    WriteRegisterByte(RegisterType::D, 0xEE);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xF9);
    WriteRegisterByte(RegisterType::L, 0xE4);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF03, 0x00);
    WriteMemory(0xDCF1, 0x03);
    WriteMemory(0xDCF0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x44);
    CheckRegisterByte(RegisterType::B, 0x26);
    CheckRegisterByte(RegisterType::C, 0xD0);
    CheckRegisterByte(RegisterType::D, 0xEE);
    CheckRegisterByte(RegisterType::E, 0xE0);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xF9);
    CheckRegisterByte(RegisterType::L, 0xE4);
    CheckRegisterWord(RegisterType::PC, 0xDCF2);
    CheckRegisterWord(RegisterType::SP, 0x5AD1);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xDCF0, 0xE0);
    CheckMemory(0xDCF1, 0x03);
    CheckMemory(0xFF03, 0x44);
}

void test_E0_03CD()
{
    if (skip_test_E0_03CD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x25E5);
    WriteRegisterWord(RegisterType::SP, 0xDF3C);
    WriteRegisterByte(RegisterType::A, 0x6B);
    WriteRegisterByte(RegisterType::B, 0xFD);
    WriteRegisterByte(RegisterType::C, 0x12);
    WriteRegisterByte(RegisterType::D, 0x7A);
    WriteRegisterByte(RegisterType::E, 0x6C);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0xA5);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF14, 0x00);
    WriteMemory(0x25E6, 0x14);
    WriteMemory(0x25E5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6B);
    CheckRegisterByte(RegisterType::B, 0xFD);
    CheckRegisterByte(RegisterType::C, 0x12);
    CheckRegisterByte(RegisterType::D, 0x7A);
    CheckRegisterByte(RegisterType::E, 0x6C);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0xA5);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0x25E7);
    CheckRegisterWord(RegisterType::SP, 0xDF3C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x25E5, 0xE0);
    CheckMemory(0x25E6, 0x14);
    CheckMemory(0xFF14, 0x6B);
}

void test_E0_03CE()
{
    if (skip_test_E0_03CE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x936F);
    WriteRegisterWord(RegisterType::SP, 0xB089);
    WriteRegisterByte(RegisterType::A, 0x24);
    WriteRegisterByte(RegisterType::B, 0x27);
    WriteRegisterByte(RegisterType::C, 0xB5);
    WriteRegisterByte(RegisterType::D, 0x6A);
    WriteRegisterByte(RegisterType::E, 0xBD);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x7E);
    WriteRegisterByte(RegisterType::L, 0x6C);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAE, 0x00);
    WriteMemory(0x9370, 0xAE);
    WriteMemory(0x936F, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x24);
    CheckRegisterByte(RegisterType::B, 0x27);
    CheckRegisterByte(RegisterType::C, 0xB5);
    CheckRegisterByte(RegisterType::D, 0x6A);
    CheckRegisterByte(RegisterType::E, 0xBD);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x7E);
    CheckRegisterByte(RegisterType::L, 0x6C);
    CheckRegisterWord(RegisterType::PC, 0x9371);
    CheckRegisterWord(RegisterType::SP, 0xB089);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x936F, 0xE0);
    CheckMemory(0x9370, 0xAE);
    CheckMemory(0xFFAE, 0x24);
}

void test_E0_03CF()
{
    if (skip_test_E0_03CF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xAFD7);
    WriteRegisterWord(RegisterType::SP, 0x9703);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0x3D);
    WriteRegisterByte(RegisterType::C, 0x09);
    WriteRegisterByte(RegisterType::D, 0xE8);
    WriteRegisterByte(RegisterType::E, 0xE8);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0xD8);
    WriteRegisterByte(RegisterType::L, 0xD1);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFC4, 0x00);
    WriteMemory(0xAFD8, 0xC4);
    WriteMemory(0xAFD7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0x3D);
    CheckRegisterByte(RegisterType::C, 0x09);
    CheckRegisterByte(RegisterType::D, 0xE8);
    CheckRegisterByte(RegisterType::E, 0xE8);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0xD8);
    CheckRegisterByte(RegisterType::L, 0xD1);
    CheckRegisterWord(RegisterType::PC, 0xAFD9);
    CheckRegisterWord(RegisterType::SP, 0x9703);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xAFD7, 0xE0);
    CheckMemory(0xAFD8, 0xC4);
    CheckMemory(0xFFC4, 0xCC);
}

void test_E0_03D0()
{
    if (skip_test_E0_03D0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xD28C);
    WriteRegisterWord(RegisterType::SP, 0xA506);
    WriteRegisterByte(RegisterType::A, 0x46);
    WriteRegisterByte(RegisterType::B, 0xA5);
    WriteRegisterByte(RegisterType::C, 0xC5);
    WriteRegisterByte(RegisterType::D, 0x35);
    WriteRegisterByte(RegisterType::E, 0x9B);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x80);
    WriteRegisterByte(RegisterType::L, 0x59);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF72, 0x00);
    WriteMemory(0xD28D, 0x72);
    WriteMemory(0xD28C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x46);
    CheckRegisterByte(RegisterType::B, 0xA5);
    CheckRegisterByte(RegisterType::C, 0xC5);
    CheckRegisterByte(RegisterType::D, 0x35);
    CheckRegisterByte(RegisterType::E, 0x9B);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x80);
    CheckRegisterByte(RegisterType::L, 0x59);
    CheckRegisterWord(RegisterType::PC, 0xD28E);
    CheckRegisterWord(RegisterType::SP, 0xA506);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xD28C, 0xE0);
    CheckMemory(0xD28D, 0x72);
    CheckMemory(0xFF72, 0x46);
}

void test_E0_03D1()
{
    if (skip_test_E0_03D1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xEB88);
    WriteRegisterWord(RegisterType::SP, 0x14CA);
    WriteRegisterByte(RegisterType::A, 0x03);
    WriteRegisterByte(RegisterType::B, 0x1C);
    WriteRegisterByte(RegisterType::C, 0x98);
    WriteRegisterByte(RegisterType::D, 0xEB);
    WriteRegisterByte(RegisterType::E, 0x42);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0x71);
    WriteRegisterByte(RegisterType::L, 0xEE);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFF2, 0x00);
    WriteMemory(0xEB89, 0xF2);
    WriteMemory(0xEB88, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x03);
    CheckRegisterByte(RegisterType::B, 0x1C);
    CheckRegisterByte(RegisterType::C, 0x98);
    CheckRegisterByte(RegisterType::D, 0xEB);
    CheckRegisterByte(RegisterType::E, 0x42);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0x71);
    CheckRegisterByte(RegisterType::L, 0xEE);
    CheckRegisterWord(RegisterType::PC, 0xEB8A);
    CheckRegisterWord(RegisterType::SP, 0x14CA);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xEB88, 0xE0);
    CheckMemory(0xEB89, 0xF2);
    CheckMemory(0xFFF2, 0x03);
}

void test_E0_03D2()
{
    if (skip_test_E0_03D2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x053D);
    WriteRegisterWord(RegisterType::SP, 0x6AD3);
    WriteRegisterByte(RegisterType::A, 0xB0);
    WriteRegisterByte(RegisterType::B, 0xA1);
    WriteRegisterByte(RegisterType::C, 0xBC);
    WriteRegisterByte(RegisterType::D, 0x5E);
    WriteRegisterByte(RegisterType::E, 0x60);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0x59);
    WriteRegisterByte(RegisterType::L, 0x37);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF31, 0x00);
    WriteMemory(0x053E, 0x31);
    WriteMemory(0x053D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xB0);
    CheckRegisterByte(RegisterType::B, 0xA1);
    CheckRegisterByte(RegisterType::C, 0xBC);
    CheckRegisterByte(RegisterType::D, 0x5E);
    CheckRegisterByte(RegisterType::E, 0x60);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0x59);
    CheckRegisterByte(RegisterType::L, 0x37);
    CheckRegisterWord(RegisterType::PC, 0x053F);
    CheckRegisterWord(RegisterType::SP, 0x6AD3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x053D, 0xE0);
    CheckMemory(0x053E, 0x31);
    CheckMemory(0xFF31, 0xB0);
}

void test_E0_03D3()
{
    if (skip_test_E0_03D3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBC08);
    WriteRegisterWord(RegisterType::SP, 0x737B);
    WriteRegisterByte(RegisterType::A, 0xCC);
    WriteRegisterByte(RegisterType::B, 0x5F);
    WriteRegisterByte(RegisterType::C, 0x88);
    WriteRegisterByte(RegisterType::D, 0x48);
    WriteRegisterByte(RegisterType::E, 0x48);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x19);
    WriteRegisterByte(RegisterType::L, 0xD7);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFAC, 0x00);
    WriteMemory(0xBC09, 0xAC);
    WriteMemory(0xBC08, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCC);
    CheckRegisterByte(RegisterType::B, 0x5F);
    CheckRegisterByte(RegisterType::C, 0x88);
    CheckRegisterByte(RegisterType::D, 0x48);
    CheckRegisterByte(RegisterType::E, 0x48);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x19);
    CheckRegisterByte(RegisterType::L, 0xD7);
    CheckRegisterWord(RegisterType::PC, 0xBC0A);
    CheckRegisterWord(RegisterType::SP, 0x737B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBC08, 0xE0);
    CheckMemory(0xBC09, 0xAC);
    CheckMemory(0xFFAC, 0xCC);
}

void test_E0_03D4()
{
    if (skip_test_E0_03D4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x93F6);
    WriteRegisterWord(RegisterType::SP, 0xAE9F);
    WriteRegisterByte(RegisterType::A, 0x6A);
    WriteRegisterByte(RegisterType::B, 0xC3);
    WriteRegisterByte(RegisterType::C, 0x40);
    WriteRegisterByte(RegisterType::D, 0x89);
    WriteRegisterByte(RegisterType::E, 0x05);
    WriteRegisterFlag(0xE0);
    WriteRegisterByte(RegisterType::H, 0x68);
    WriteRegisterByte(RegisterType::L, 0xAC);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFAC, 0x00);
    WriteMemory(0x93F7, 0xAC);
    WriteMemory(0x93F6, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x6A);
    CheckRegisterByte(RegisterType::B, 0xC3);
    CheckRegisterByte(RegisterType::C, 0x40);
    CheckRegisterByte(RegisterType::D, 0x89);
    CheckRegisterByte(RegisterType::E, 0x05);
    CheckRegisterFlag(0xE0);
    CheckRegisterByte(RegisterType::H, 0x68);
    CheckRegisterByte(RegisterType::L, 0xAC);
    CheckRegisterWord(RegisterType::PC, 0x93F8);
    CheckRegisterWord(RegisterType::SP, 0xAE9F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x93F6, 0xE0);
    CheckMemory(0x93F7, 0xAC);
    CheckMemory(0xFFAC, 0x6A);
}

void test_E0_03D5()
{
    if (skip_test_E0_03D5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5B4E);
    WriteRegisterWord(RegisterType::SP, 0xF876);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0xAD);
    WriteRegisterByte(RegisterType::C, 0xCF);
    WriteRegisterByte(RegisterType::D, 0xD3);
    WriteRegisterByte(RegisterType::E, 0x4F);
    WriteRegisterFlag(0x70);
    WriteRegisterByte(RegisterType::H, 0x48);
    WriteRegisterByte(RegisterType::L, 0x18);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFD3, 0x00);
    WriteMemory(0x5B4F, 0xD3);
    WriteMemory(0x5B4E, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0xAD);
    CheckRegisterByte(RegisterType::C, 0xCF);
    CheckRegisterByte(RegisterType::D, 0xD3);
    CheckRegisterByte(RegisterType::E, 0x4F);
    CheckRegisterFlag(0x70);
    CheckRegisterByte(RegisterType::H, 0x48);
    CheckRegisterByte(RegisterType::L, 0x18);
    CheckRegisterWord(RegisterType::PC, 0x5B50);
    CheckRegisterWord(RegisterType::SP, 0xF876);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5B4E, 0xE0);
    CheckMemory(0x5B4F, 0xD3);
    CheckMemory(0xFFD3, 0xD0);
}

void test_E0_03D6()
{
    if (skip_test_E0_03D6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x7A09);
    WriteRegisterWord(RegisterType::SP, 0xE791);
    WriteRegisterByte(RegisterType::A, 0xBB);
    WriteRegisterByte(RegisterType::B, 0xAA);
    WriteRegisterByte(RegisterType::C, 0x6C);
    WriteRegisterByte(RegisterType::D, 0xD1);
    WriteRegisterByte(RegisterType::E, 0xCE);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xEB);
    WriteRegisterByte(RegisterType::L, 0x48);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF0E, 0x00);
    WriteMemory(0x7A0A, 0x0E);
    WriteMemory(0x7A09, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xBB);
    CheckRegisterByte(RegisterType::B, 0xAA);
    CheckRegisterByte(RegisterType::C, 0x6C);
    CheckRegisterByte(RegisterType::D, 0xD1);
    CheckRegisterByte(RegisterType::E, 0xCE);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xEB);
    CheckRegisterByte(RegisterType::L, 0x48);
    CheckRegisterWord(RegisterType::PC, 0x7A0B);
    CheckRegisterWord(RegisterType::SP, 0xE791);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x7A09, 0xE0);
    CheckMemory(0x7A0A, 0x0E);
    CheckMemory(0xFF0E, 0xBB);
}

void test_E0_03D7()
{
    if (skip_test_E0_03D7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x92C7);
    WriteRegisterWord(RegisterType::SP, 0xCE65);
    WriteRegisterByte(RegisterType::A, 0xD2);
    WriteRegisterByte(RegisterType::B, 0x60);
    WriteRegisterByte(RegisterType::C, 0x1D);
    WriteRegisterByte(RegisterType::D, 0xD6);
    WriteRegisterByte(RegisterType::E, 0x3D);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x3B);
    WriteRegisterByte(RegisterType::L, 0x50);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF43, 0x00);
    WriteMemory(0x92C8, 0x43);
    WriteMemory(0x92C7, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD2);
    CheckRegisterByte(RegisterType::B, 0x60);
    CheckRegisterByte(RegisterType::C, 0x1D);
    CheckRegisterByte(RegisterType::D, 0xD6);
    CheckRegisterByte(RegisterType::E, 0x3D);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x3B);
    CheckRegisterByte(RegisterType::L, 0x50);
    CheckRegisterWord(RegisterType::PC, 0x92C9);
    CheckRegisterWord(RegisterType::SP, 0xCE65);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x92C7, 0xE0);
    CheckMemory(0x92C8, 0x43);
    CheckMemory(0xFF43, 0xD2);
}

void test_E0_03D8()
{
    if (skip_test_E0_03D8)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x983D);
    WriteRegisterWord(RegisterType::SP, 0x150A);
    WriteRegisterByte(RegisterType::A, 0x9B);
    WriteRegisterByte(RegisterType::B, 0x01);
    WriteRegisterByte(RegisterType::C, 0xB7);
    WriteRegisterByte(RegisterType::D, 0xD4);
    WriteRegisterByte(RegisterType::E, 0xB9);
    WriteRegisterFlag(0x80);
    WriteRegisterByte(RegisterType::H, 0xD8);
    WriteRegisterByte(RegisterType::L, 0x96);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFD8, 0x00);
    WriteMemory(0x983E, 0xD8);
    WriteMemory(0x983D, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x9B);
    CheckRegisterByte(RegisterType::B, 0x01);
    CheckRegisterByte(RegisterType::C, 0xB7);
    CheckRegisterByte(RegisterType::D, 0xD4);
    CheckRegisterByte(RegisterType::E, 0xB9);
    CheckRegisterFlag(0x80);
    CheckRegisterByte(RegisterType::H, 0xD8);
    CheckRegisterByte(RegisterType::L, 0x96);
    CheckRegisterWord(RegisterType::PC, 0x983F);
    CheckRegisterWord(RegisterType::SP, 0x150A);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x983D, 0xE0);
    CheckMemory(0x983E, 0xD8);
    CheckMemory(0xFFD8, 0x9B);
}

void test_E0_03D9()
{
    if (skip_test_E0_03D9)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x48E8);
    WriteRegisterWord(RegisterType::SP, 0x2C4F);
    WriteRegisterByte(RegisterType::A, 0xD0);
    WriteRegisterByte(RegisterType::B, 0xDE);
    WriteRegisterByte(RegisterType::C, 0x85);
    WriteRegisterByte(RegisterType::D, 0xFD);
    WriteRegisterByte(RegisterType::E, 0xFD);
    WriteRegisterFlag(0x50);
    WriteRegisterByte(RegisterType::H, 0x9F);
    WriteRegisterByte(RegisterType::L, 0xB4);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF2C, 0x00);
    WriteMemory(0x48E9, 0x2C);
    WriteMemory(0x48E8, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xD0);
    CheckRegisterByte(RegisterType::B, 0xDE);
    CheckRegisterByte(RegisterType::C, 0x85);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0xFD);
    CheckRegisterFlag(0x50);
    CheckRegisterByte(RegisterType::H, 0x9F);
    CheckRegisterByte(RegisterType::L, 0xB4);
    CheckRegisterWord(RegisterType::PC, 0x48EA);
    CheckRegisterWord(RegisterType::SP, 0x2C4F);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x48E8, 0xE0);
    CheckMemory(0x48E9, 0x2C);
    CheckMemory(0xFF2C, 0xD0);
}

void test_E0_03DA()
{
    if (skip_test_E0_03DA)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5593);
    WriteRegisterWord(RegisterType::SP, 0x8D2B);
    WriteRegisterByte(RegisterType::A, 0xDB);
    WriteRegisterByte(RegisterType::B, 0x5E);
    WriteRegisterByte(RegisterType::C, 0xA9);
    WriteRegisterByte(RegisterType::D, 0x41);
    WriteRegisterByte(RegisterType::E, 0x1B);
    WriteRegisterFlag(0x30);
    WriteRegisterByte(RegisterType::H, 0x1F);
    WriteRegisterByte(RegisterType::L, 0x7D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC0, 0x00);
    WriteMemory(0x5594, 0xC0);
    WriteMemory(0x5593, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xDB);
    CheckRegisterByte(RegisterType::B, 0x5E);
    CheckRegisterByte(RegisterType::C, 0xA9);
    CheckRegisterByte(RegisterType::D, 0x41);
    CheckRegisterByte(RegisterType::E, 0x1B);
    CheckRegisterFlag(0x30);
    CheckRegisterByte(RegisterType::H, 0x1F);
    CheckRegisterByte(RegisterType::L, 0x7D);
    CheckRegisterWord(RegisterType::PC, 0x5595);
    CheckRegisterWord(RegisterType::SP, 0x8D2B);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5593, 0xE0);
    CheckMemory(0x5594, 0xC0);
    CheckMemory(0xFFC0, 0xDB);
}

void test_E0_03DB()
{
    if (skip_test_E0_03DB)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB30C);
    WriteRegisterWord(RegisterType::SP, 0x5EE9);
    WriteRegisterByte(RegisterType::A, 0xC7);
    WriteRegisterByte(RegisterType::B, 0xD1);
    WriteRegisterByte(RegisterType::C, 0x85);
    WriteRegisterByte(RegisterType::D, 0x80);
    WriteRegisterByte(RegisterType::E, 0xF2);
    WriteRegisterFlag(0x20);
    WriteRegisterByte(RegisterType::H, 0x21);
    WriteRegisterByte(RegisterType::L, 0xE5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC8, 0x00);
    WriteMemory(0xB30D, 0xC8);
    WriteMemory(0xB30C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC7);
    CheckRegisterByte(RegisterType::B, 0xD1);
    CheckRegisterByte(RegisterType::C, 0x85);
    CheckRegisterByte(RegisterType::D, 0x80);
    CheckRegisterByte(RegisterType::E, 0xF2);
    CheckRegisterFlag(0x20);
    CheckRegisterByte(RegisterType::H, 0x21);
    CheckRegisterByte(RegisterType::L, 0xE5);
    CheckRegisterWord(RegisterType::PC, 0xB30E);
    CheckRegisterWord(RegisterType::SP, 0x5EE9);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xB30C, 0xE0);
    CheckMemory(0xB30D, 0xC8);
    CheckMemory(0xFFC8, 0xC7);
}

void test_E0_03DC()
{
    if (skip_test_E0_03DC)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA419);
    WriteRegisterWord(RegisterType::SP, 0x3B23);
    WriteRegisterByte(RegisterType::A, 0x2C);
    WriteRegisterByte(RegisterType::B, 0xE4);
    WriteRegisterByte(RegisterType::C, 0x46);
    WriteRegisterByte(RegisterType::D, 0xC0);
    WriteRegisterByte(RegisterType::E, 0x7F);
    WriteRegisterFlag(0x90);
    WriteRegisterByte(RegisterType::H, 0xDC);
    WriteRegisterByte(RegisterType::L, 0x8D);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFC0, 0x00);
    WriteMemory(0xA41A, 0xC0);
    WriteMemory(0xA419, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x2C);
    CheckRegisterByte(RegisterType::B, 0xE4);
    CheckRegisterByte(RegisterType::C, 0x46);
    CheckRegisterByte(RegisterType::D, 0xC0);
    CheckRegisterByte(RegisterType::E, 0x7F);
    CheckRegisterFlag(0x90);
    CheckRegisterByte(RegisterType::H, 0xDC);
    CheckRegisterByte(RegisterType::L, 0x8D);
    CheckRegisterWord(RegisterType::PC, 0xA41B);
    CheckRegisterWord(RegisterType::SP, 0x3B23);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xA419, 0xE0);
    CheckMemory(0xA41A, 0xC0);
    CheckMemory(0xFFC0, 0x2C);
}

void test_E0_03DD()
{
    if (skip_test_E0_03DD)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xA755);
    WriteRegisterWord(RegisterType::SP, 0x3474);
    WriteRegisterByte(RegisterType::A, 0xCD);
    WriteRegisterByte(RegisterType::B, 0x03);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0xFD);
    WriteRegisterByte(RegisterType::E, 0x72);
    WriteRegisterFlag(0xB0);
    WriteRegisterByte(RegisterType::H, 0x46);
    WriteRegisterByte(RegisterType::L, 0x4D);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFFB4, 0x00);
    WriteMemory(0xA756, 0xB4);
    WriteMemory(0xA755, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCD);
    CheckRegisterByte(RegisterType::B, 0x03);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0xFD);
    CheckRegisterByte(RegisterType::E, 0x72);
    CheckRegisterFlag(0xB0);
    CheckRegisterByte(RegisterType::H, 0x46);
    CheckRegisterByte(RegisterType::L, 0x4D);
    CheckRegisterWord(RegisterType::PC, 0xA757);
    CheckRegisterWord(RegisterType::SP, 0x3474);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xA755, 0xE0);
    CheckMemory(0xA756, 0xB4);
    CheckMemory(0xFFB4, 0xCD);
}

void test_E0_03DE()
{
    if (skip_test_E0_03DE)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x14B5);
    WriteRegisterWord(RegisterType::SP, 0xA9EF);
    WriteRegisterByte(RegisterType::A, 0xCA);
    WriteRegisterByte(RegisterType::B, 0xCE);
    WriteRegisterByte(RegisterType::C, 0x37);
    WriteRegisterByte(RegisterType::D, 0x26);
    WriteRegisterByte(RegisterType::E, 0x60);
    WriteRegisterFlag(0xC0);
    WriteRegisterByte(RegisterType::H, 0x3B);
    WriteRegisterByte(RegisterType::L, 0x12);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF05, 0x00);
    WriteMemory(0x14B6, 0x05);
    WriteMemory(0x14B5, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xCA);
    CheckRegisterByte(RegisterType::B, 0xCE);
    CheckRegisterByte(RegisterType::C, 0x37);
    CheckRegisterByte(RegisterType::D, 0x26);
    CheckRegisterByte(RegisterType::E, 0x60);
    CheckRegisterFlag(0xC0);
    CheckRegisterByte(RegisterType::H, 0x3B);
    CheckRegisterByte(RegisterType::L, 0x12);
    CheckRegisterWord(RegisterType::PC, 0x14B7);
    CheckRegisterWord(RegisterType::SP, 0xA9EF);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x14B5, 0xE0);
    CheckMemory(0x14B6, 0x05);
    CheckMemory(0xFF05, 0xCA);
}

void test_E0_03DF()
{
    if (skip_test_E0_03DF)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xCBEF);
    WriteRegisterWord(RegisterType::SP, 0xDAF3);
    WriteRegisterByte(RegisterType::A, 0x68);
    WriteRegisterByte(RegisterType::B, 0x1B);
    WriteRegisterByte(RegisterType::C, 0xCB);
    WriteRegisterByte(RegisterType::D, 0x4B);
    WriteRegisterByte(RegisterType::E, 0x68);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0xCC);
    WriteRegisterByte(RegisterType::L, 0xC5);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF32, 0x00);
    WriteMemory(0xCBF0, 0x32);
    WriteMemory(0xCBEF, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x68);
    CheckRegisterByte(RegisterType::B, 0x1B);
    CheckRegisterByte(RegisterType::C, 0xCB);
    CheckRegisterByte(RegisterType::D, 0x4B);
    CheckRegisterByte(RegisterType::E, 0x68);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0xCC);
    CheckRegisterByte(RegisterType::L, 0xC5);
    CheckRegisterWord(RegisterType::PC, 0xCBF1);
    CheckRegisterWord(RegisterType::SP, 0xDAF3);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xCBEF, 0xE0);
    CheckMemory(0xCBF0, 0x32);
    CheckMemory(0xFF32, 0x68);
}

void test_E0_03E0()
{
    if (skip_test_E0_03E0)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x934C);
    WriteRegisterWord(RegisterType::SP, 0xEA6B);
    WriteRegisterByte(RegisterType::A, 0x7A);
    WriteRegisterByte(RegisterType::B, 0x2B);
    WriteRegisterByte(RegisterType::C, 0x21);
    WriteRegisterByte(RegisterType::D, 0x36);
    WriteRegisterByte(RegisterType::E, 0xB2);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xC6);
    WriteRegisterByte(RegisterType::L, 0x7B);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF09, 0x00);
    WriteMemory(0x934D, 0x09);
    WriteMemory(0x934C, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x7A);
    CheckRegisterByte(RegisterType::B, 0x2B);
    CheckRegisterByte(RegisterType::C, 0x21);
    CheckRegisterByte(RegisterType::D, 0x36);
    CheckRegisterByte(RegisterType::E, 0xB2);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xC6);
    CheckRegisterByte(RegisterType::L, 0x7B);
    CheckRegisterWord(RegisterType::PC, 0x934E);
    CheckRegisterWord(RegisterType::SP, 0xEA6B);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x934C, 0xE0);
    CheckMemory(0x934D, 0x09);
    CheckMemory(0xFF09, 0x7A);
}

void test_E0_03E1()
{
    if (skip_test_E0_03E1)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x8629);
    WriteRegisterWord(RegisterType::SP, 0xC65E);
    WriteRegisterByte(RegisterType::A, 0x78);
    WriteRegisterByte(RegisterType::B, 0x59);
    WriteRegisterByte(RegisterType::C, 0x30);
    WriteRegisterByte(RegisterType::D, 0x23);
    WriteRegisterByte(RegisterType::E, 0xFF);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x6E);
    WriteRegisterByte(RegisterType::L, 0x11);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF4B, 0x00);
    WriteMemory(0x862A, 0x4B);
    WriteMemory(0x8629, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x78);
    CheckRegisterByte(RegisterType::B, 0x59);
    CheckRegisterByte(RegisterType::C, 0x30);
    CheckRegisterByte(RegisterType::D, 0x23);
    CheckRegisterByte(RegisterType::E, 0xFF);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x6E);
    CheckRegisterByte(RegisterType::L, 0x11);
    CheckRegisterWord(RegisterType::PC, 0x862B);
    CheckRegisterWord(RegisterType::SP, 0xC65E);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0x8629, 0xE0);
    CheckMemory(0x862A, 0x4B);
    CheckMemory(0xFF4B, 0x78);
}

void test_E0_03E2()
{
    if (skip_test_E0_03E2)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x5ED1);
    WriteRegisterWord(RegisterType::SP, 0xC6D6);
    WriteRegisterByte(RegisterType::A, 0x22);
    WriteRegisterByte(RegisterType::B, 0xC2);
    WriteRegisterByte(RegisterType::C, 0x16);
    WriteRegisterByte(RegisterType::D, 0xD7);
    WriteRegisterByte(RegisterType::E, 0xE9);
    WriteRegisterFlag(0x10);
    WriteRegisterByte(RegisterType::H, 0xE7);
    WriteRegisterByte(RegisterType::L, 0x1C);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFFCD, 0x00);
    WriteMemory(0x5ED2, 0xCD);
    WriteMemory(0x5ED1, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x22);
    CheckRegisterByte(RegisterType::B, 0xC2);
    CheckRegisterByte(RegisterType::C, 0x16);
    CheckRegisterByte(RegisterType::D, 0xD7);
    CheckRegisterByte(RegisterType::E, 0xE9);
    CheckRegisterFlag(0x10);
    CheckRegisterByte(RegisterType::H, 0xE7);
    CheckRegisterByte(RegisterType::L, 0x1C);
    CheckRegisterWord(RegisterType::PC, 0x5ED3);
    CheckRegisterWord(RegisterType::SP, 0xC6D6);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x5ED1, 0xE0);
    CheckMemory(0x5ED2, 0xCD);
    CheckMemory(0xFFCD, 0x22);
}

void test_E0_03E3()
{
    if (skip_test_E0_03E3)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xBCC4);
    WriteRegisterWord(RegisterType::SP, 0x874D);
    WriteRegisterByte(RegisterType::A, 0xA1);
    WriteRegisterByte(RegisterType::B, 0x6D);
    WriteRegisterByte(RegisterType::C, 0x89);
    WriteRegisterByte(RegisterType::D, 0x96);
    WriteRegisterByte(RegisterType::E, 0xE0);
    WriteRegisterFlag(0x40);
    WriteRegisterByte(RegisterType::H, 0x99);
    WriteRegisterByte(RegisterType::L, 0xA6);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF30, 0x00);
    WriteMemory(0xBCC5, 0x30);
    WriteMemory(0xBCC4, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xA1);
    CheckRegisterByte(RegisterType::B, 0x6D);
    CheckRegisterByte(RegisterType::C, 0x89);
    CheckRegisterByte(RegisterType::D, 0x96);
    CheckRegisterByte(RegisterType::E, 0xE0);
    CheckRegisterFlag(0x40);
    CheckRegisterByte(RegisterType::H, 0x99);
    CheckRegisterByte(RegisterType::L, 0xA6);
    CheckRegisterWord(RegisterType::PC, 0xBCC6);
    CheckRegisterWord(RegisterType::SP, 0x874D);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xBCC4, 0xE0);
    CheckMemory(0xBCC5, 0x30);
    CheckMemory(0xFF30, 0xA1);
}

void test_E0_03E4()
{
    if (skip_test_E0_03E4)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xF891);
    WriteRegisterWord(RegisterType::SP, 0x6C98);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0x69);
    WriteRegisterByte(RegisterType::C, 0xF8);
    WriteRegisterByte(RegisterType::D, 0xA5);
    WriteRegisterByte(RegisterType::E, 0xBA);
    WriteRegisterFlag(0xA0);
    WriteRegisterByte(RegisterType::H, 0x4C);
    WriteRegisterByte(RegisterType::L, 0xB3);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF04, 0x00);
    WriteMemory(0xF892, 0x04);
    WriteMemory(0xF891, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0x69);
    CheckRegisterByte(RegisterType::C, 0xF8);
    CheckRegisterByte(RegisterType::D, 0xA5);
    CheckRegisterByte(RegisterType::E, 0xBA);
    CheckRegisterFlag(0xA0);
    CheckRegisterByte(RegisterType::H, 0x4C);
    CheckRegisterByte(RegisterType::L, 0xB3);
    CheckRegisterWord(RegisterType::PC, 0xF893);
    CheckRegisterWord(RegisterType::SP, 0x6C98);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xF891, 0xE0);
    CheckMemory(0xF892, 0x04);
    CheckMemory(0xFF04, 0xC2);
}

void test_E0_03E5()
{
    if (skip_test_E0_03E5)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0x6940);
    WriteRegisterWord(RegisterType::SP, 0xEE6E);
    WriteRegisterByte(RegisterType::A, 0xC2);
    WriteRegisterByte(RegisterType::B, 0xB0);
    WriteRegisterByte(RegisterType::C, 0xAE);
    WriteRegisterByte(RegisterType::D, 0x2B);
    WriteRegisterByte(RegisterType::E, 0x60);
    WriteRegisterFlag(0x60);
    WriteRegisterByte(RegisterType::H, 0xFB);
    WriteRegisterByte(RegisterType::L, 0x09);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x00);
    WriteMemory(0xFF12, 0x00);
    WriteMemory(0x6941, 0x12);
    WriteMemory(0x6940, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0xC2);
    CheckRegisterByte(RegisterType::B, 0xB0);
    CheckRegisterByte(RegisterType::C, 0xAE);
    CheckRegisterByte(RegisterType::D, 0x2B);
    CheckRegisterByte(RegisterType::E, 0x60);
    CheckRegisterFlag(0x60);
    CheckRegisterByte(RegisterType::H, 0xFB);
    CheckRegisterByte(RegisterType::L, 0x09);
    CheckRegisterWord(RegisterType::PC, 0x6942);
    CheckRegisterWord(RegisterType::SP, 0xEE6E);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0x6940, 0xE0);
    CheckMemory(0x6941, 0x12);
    CheckMemory(0xFF12, 0xC2);
}

void test_E0_03E6()
{
    if (skip_test_E0_03E6)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xB4F0);
    WriteRegisterWord(RegisterType::SP, 0x7EB8);
    WriteRegisterByte(RegisterType::A, 0x03);
    WriteRegisterByte(RegisterType::B, 0x73);
    WriteRegisterByte(RegisterType::C, 0xBA);
    WriteRegisterByte(RegisterType::D, 0x03);
    WriteRegisterByte(RegisterType::E, 0x54);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0x02);
    WriteRegisterByte(RegisterType::L, 0x6E);
    mmap.DisableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF50, 0x00);
    WriteMemory(0xB4F1, 0x50);
    WriteMemory(0xB4F0, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x03);
    CheckRegisterByte(RegisterType::B, 0x73);
    CheckRegisterByte(RegisterType::C, 0xBA);
    CheckRegisterByte(RegisterType::D, 0x03);
    CheckRegisterByte(RegisterType::E, 0x54);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0x02);
    CheckRegisterByte(RegisterType::L, 0x6E);
    CheckRegisterWord(RegisterType::PC, 0xB4F2);
    CheckRegisterWord(RegisterType::SP, 0x7EB8);
    TEST_ASSERT(!mmap.IMEEnabled());
    CheckMemory(0xB4F0, 0xE0);
    CheckMemory(0xB4F1, 0x50);
    CheckMemory(0xFF50, 0x03);
}

void test_E0_03E7()
{
    if (skip_test_E0_03E7)
    {
        TEST_SKIP("Skipping");
        return;
    }
    mmap.Reset();
    auto mmapResult = mmap.Initialize(MinRomBankCount, MinVramBankCount, 1, MinWramBankCount);
    TEST_ASSERT_(mmapResult.IsSuccess(), "%s", mmapResult.GetStatusDescription());

    // Initial state

    WriteRegisterWord(RegisterType::PC, 0xFD30);
    WriteRegisterWord(RegisterType::SP, 0x9A3C);
    WriteRegisterByte(RegisterType::A, 0x89);
    WriteRegisterByte(RegisterType::B, 0xC0);
    WriteRegisterByte(RegisterType::C, 0xB0);
    WriteRegisterByte(RegisterType::D, 0xB7);
    WriteRegisterByte(RegisterType::E, 0x24);
    WriteRegisterFlag(0x00);
    WriteRegisterByte(RegisterType::H, 0xEB);
    WriteRegisterByte(RegisterType::L, 0x58);
    mmap.EnableIME();
    WriteRegisterByte(RegisterType::IE, 0x01);
    WriteMemory(0xFF3B, 0x00);
    WriteMemory(0xFD31, 0x3B);
    WriteMemory(0xFD30, 0xE0);

    // Execute single step
    {
         auto resultByte = mmap.ReadByte(mmap.ReadPC());
         TEST_ASSERT_(resultByte.IsSuccess(), "%s", resultByte.GetStatusDescription());
         auto ticks = instruction::InstructionRegistryNoPrefix::Execute(static_cast<const Byte&>(resultByte), mmap);
         TEST_ASSERT(ticks == instruction::InstructionRegistryNoPrefix::Ticks[static_cast<const Byte&>(resultByte)]);
         TEST_ASSERT(ticks == 12);
    }

    // Final state
            
    CheckRegisterByte(RegisterType::A, 0x89);
    CheckRegisterByte(RegisterType::B, 0xC0);
    CheckRegisterByte(RegisterType::C, 0xB0);
    CheckRegisterByte(RegisterType::D, 0xB7);
    CheckRegisterByte(RegisterType::E, 0x24);
    CheckRegisterFlag(0x00);
    CheckRegisterByte(RegisterType::H, 0xEB);
    CheckRegisterByte(RegisterType::L, 0x58);
    CheckRegisterWord(RegisterType::PC, 0xFD32);
    CheckRegisterWord(RegisterType::SP, 0x9A3C);
    TEST_ASSERT(mmap.IMEEnabled());
    CheckMemory(0xFD30, 0xE0);
    CheckMemory(0xFD31, 0x3B);
    CheckMemory(0xFF3B, 0x89);
}
